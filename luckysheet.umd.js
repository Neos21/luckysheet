var luckysheet=(()=>{var Pm=Object.create,lo=Object.defineProperty,Nm=Object.defineProperties,Em=Object.getOwnPropertyDescriptor,Lm=Object.getOwnPropertyDescriptors,Om=Object.getOwnPropertyNames,Vc=Object.getOwnPropertySymbols,Bm=Object.getPrototypeOf,qc=Object.prototype.hasOwnProperty,Hm=Object.prototype.propertyIsEnumerable;var jc=(e,n,t)=>n in e?lo(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,We=(e,n)=>{for(var t in n||(n={}))qc.call(n,t)&&jc(e,t,n[t]);if(Vc)for(var t of Vc(n))Hm.call(n,t)&&jc(e,t,n[t]);return e},Wc=(e,n)=>Nm(e,Lm(n)),Vm=e=>lo(e,"__esModule",{value:!0});var Me=(e,n)=>()=>(e&&(n=e(e=0)),n),wl=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),qm=(e,n)=>{for(var t in n)lo(e,t,{get:n[t],enumerable:!0})},jm=(e,n,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of Om(n))!qc.call(e,l)&&l!=="default"&&lo(e,l,{get:()=>n[l],enumerable:!(t=Em(n,l))||t.enumerable});return e},El=e=>jm(Vm(lo(e!=null?Pm(Bm(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var Wm,de,xl=Me(()=>{Wm={autoFormatw:!1,accuracy:void 0,total:0,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,userInfo:!1,myFolderUrl:null,functionButton:null,showConfigWindowResize:!0,enableAddRow:!0,addRowCount:100,enableAddBackTop:!0,enablePage:!0,pageInfo:null,editMode:!1,beforeCreateDom:null,workbookCreateBefore:null,workbookCreateAfter:null,remoteFunction:null,fireMousedown:null,plugins:[],forceCalculation:!1,defaultColWidth:73,defaultRowHeight:19,defaultTextColor:"#000",defaultCellColor:"#fff"},de=Wm});var Um,f,Ke=Me(()=>{Um={container:null,loadingObj:{},luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfundo:[],jfredo:[],lang:"ja",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],defaultFontSize:10,currentSheetView:"viewNormal",cooperativeEdit:{usernameTimeout:{},changeCollaborationSize:[],allDataColumnlen:[],merge_range:{},checkoutData:[]},asyncLoad:["core"],defaultCell:{bg:null,bl:0,ct:{fa:"General",t:"n"},fc:"rgb(51, 51, 51)",ff:0,fs:11,ht:1,it:0,vt:1,m:"",v:""}},f=Um});function me(e){return e==null||e.toString().replace(/\s/g,"")==""}function B(e){return!(e==null||e.toString().replace(/\s/g,"")===""||typeof e=="boolean"||isNaN(e))}function H(e){let n=!1;for(let t in De)if(e==De[t]){n=!0;break}return n}function Tn(e){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(e)}function he(){return!!de.editMode}function Al(){return!!f.allowEdit}function Dt(e,n,t,l,o){let a=!1;for(let s in f.config.merge){let u=e.merge[s];if(n<u.r){if(t>=u.r&&t<u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}else if(t>=u.r&&t==u.r+u.rs-1){if(l>u.c&&l<u.c+u.cs-1){a=!0;break}else if(o>u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}else if(t>u.r+u.rs-1){if(l>u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}}else if(n==u.r){if(t<u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}else if(t>=u.r+u.rs-1){if(l>u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}}else if(n<=u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}}return a}function qa(e){return Math.ceil(e.charCodeAt().toString(2).length/8)}var De,Nt=Me(()=>{xl();Ke();De={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"}});function Gm(e){return Math.floor(e)===e}function Uc(e){let n={times:1,num:0};if(Gm(e))return n.num=e,n;let t=e+"",l=t.indexOf("."),o=t.substr(l+1).length,a=Math.pow(10,o),s=parseInt(e*a+.5,10);return n.times=a,n.num=s,n}function ro(e,n,t){let l=Uc(e),o=Uc(n),a=l.num,s=o.num,u=l.times,h=o.times,d=u>h?u:h,m=null;switch(t){case"add":return u===h?m=a+s:u>h?m=a+s*(u/h):m=a*(h/u)+s,m/d;case"subtract":return u===h?m=a-s:u>h?m=a-s*(u/h):m=a*(h/u)-s,m/d;case"multiply":return m=a*s/(u*h),m;case"divide":return m=(()=>{let p=a/s,v=h/u;return ro(p,v,"multiply")})()}}function Ym(e,n){if(n||(n=2),!B(e))return e;let t=e.toFixed(n),l=t.indexOf("."),o=t.substring(0,l),a=t.substring(l+1,t.length);if(a)for(let s=a.length-1;s!=0&&!(a.charAt(s)!="0"&&s==a.length-1);s--)a=a.substring(0,s);return Number(o+"."+a)}var Gc=Me(()=>{Nt();Number.prototype.add=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return ro(this,n,"add")};Number.prototype.subtract=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return ro(this,n,"subtract")};Number.prototype.multiply=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return ro(this,n,"multiply")};Number.prototype.divide=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return ro(this,n,"divide")};Number.prototype.tofixed=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return Ym(this,n)}});var Yc,Xc=Me(()=>{Yc={container:"sheet",loading:{},column:20,row:50,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,data:[{name:"Sheet"}],title:"Neo's Luckysheet Demo",userInfo:!1,myFolderUrl:"https://neos21.net/",config:{},fullscreenmode:!0,devicePixelRatio:window.devicePixelRatio,allowEdit:!0,loadUrl:"",loadSheetUrl:"",gridKey:"",updateUrl:"",updateImageUrl:"",allowUpdate:!1,functionButton:"",showConfigWindowResize:!0,enableAddRow:!0,enableAddBackTop:!0,autoFormatw:!1,accuracy:void 0,pageInfo:{queryExps:"",reportId:"",fields:"",mobile:"",frezon:"",currentPage:"",totalPage:10,pageUrl:""},editMode:!1,beforeCreateDom:null,fireMousedown:null,lang:"ja",plugins:[],forceCalculation:!1,rowHeaderWidth:46,columnHeaderHeight:20,defaultColWidth:73,defaultRowHeight:19,defaultFontSize:10,limitSheetNameLength:!0,defaultSheetNameMaxLength:31,sheetFormulaBar:!0,showtoolbarConfig:{},showsheetbarConfig:{},showstatisticBarConfig:{},cellRightClickConfig:{},sheetRightClickConfig:{},imageUpdateMethodConfig:{}}});var Kc,Zc=Me(()=>{Kc={functionlist:{SUMIF:{d:"Returns a conditional sum across a range.",a:"A conditional sum across a range.",p:[{name:"range",detail:"The range which is tested against `criterion`."},{name:"criterion",detail:"The pattern or test to apply to `range`."},{name:"sum_range",detail:"The range to be summed, if different from `range`."}]},TAN:{d:"Returns the tangent of an angle provided in radians.",a:"Tangent of an angle provided in radians.",p:[{name:"angle",detail:"The angle to find the tangent of, in radians."}]},TANH:{d:"Returns the hyperbolic tangent of any real number.",a:"Hyperbolic tangent of any real number.",p:[{name:"value",detail:"Any real value to calculate the hyperbolic tangent of."}]},CEILING:{d:"Rounds a number up to the nearest integer multiple of specified significance `factor`.",a:"Rounds number up to nearest multiple of a factor.",p:[{name:"value",detail:"The value to round up to the nearest integer multiple of `factor`."},{name:"factor",detail:"The number to whose multiples `value` will be rounded."}]},ATAN:{d:"Returns the inverse tangent of a value, in radians.",a:"Inverse tangent of a value, in radians.",p:[{name:"value",detail:"The value for which to calculate the inverse tangent."}]},ASINH:{d:"Returns the inverse hyperbolic sine of a number.",a:"Inverse hyperbolic sine of a number.",p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic sine."}]},ABS:{d:"Returns the absolute value of a number.",a:"Absolute value of a number.",p:[{name:"value",detail:"The number of which to return the absolute value."}]},ACOS:{d:"Returns the inverse cosine of a value, in radians.",a:"Inverse cosine of a value, in radians.",p:[{name:"value",detail:"The value for which to calculate the inverse cosine. Must be between `-1` and `1`, inclusive."}]},ACOSH:{d:"Returns the inverse hyperbolic cosine of a number.",a:"Inverse hyperbolic cosine of a number.",p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic cosine. Must be greater than or equal to `1`."}]},MULTINOMIAL:{d:"Returns the factorial of the sum of values divided by the product of the values factorials.",a:"Multinomial distribution function.",p:[{name:"value1",detail:"The first value or range to consider."},{name:"value2",detail:"Additional values or ranges to consider."}]},ATANH:{d:"Returns the inverse hyperbolic tangent of a number.",a:"Inverse hyperbolic tangent of a number.",p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic tangent. Must be between -1 and 1, exclusive."}]},ATAN2:{d:"Returns the angle between the x-axis and a line segment from the origin (0,0) to specified coordinate pair (`x`,`y`), in radians.",a:"Arctangent of a value.",p:[{name:"x",detail:"The x coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis."},{name:"y",detail:"The y coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis."}]},COUNTBLANK:{d:"Returns the number of empty values in a list of values and ranges.",a:"Number of empty values.",p:[{name:"value1",detail:"The first value or range in which to count the number of blanks."}]},COSH:{d:"Returns the hyperbolic cosine of any real number.",a:"Hyperbolic cosine of any real number.",p:[{name:"value",detail:"Any real value to calculate the hyperbolic cosine of."}]},INT:{d:"Rounds a number down to the nearest integer that is less than or equal to it.",a:"Rounds number down to nearest integer.",p:[{name:"value",detail:"The value to round down to the nearest integer."}]},ISEVEN:{d:"Checks whether the provided value is even.",a:"Whether the provided value is even.",p:[{name:"value",detail:"The value to be verified as even."}]},ISODD:{d:"Checks whether the provided value is odd.",a:"Whether the provided value is odd.",p:[{name:"value",detail:"The value to be verified as odd."}]},LCM:{d:"Returns the least common multiple of one or more integers.",a:"Least common multiple of one or more integers.",p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the least common multiple."},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the least common multiple."}]},LN:{d:"Returns the logarithm of a number, base e (Euler's number).",a:"The logarithm of a number, base e (euler's number).",p:[{name:"value",detail:"The value for which to calculate the logarithm, base e."}]},LOG:{d:"Returns the logarithm of a number with respect to a base.",a:"The logarithm of a number with respect to a base.",p:[{name:"value",detail:"The value for which to calculate the logarithm."},{name:"base",detail:"The base to use for calculation of the logarithm."}]},LOG10:{d:"Returns the logarithm of a number, base 10.",a:"The logarithm of a number, base 10.",p:[{name:"value",detail:"The value for which to calculate the logarithm, base 10."}]},MOD:{d:"Returns the result of the modulo operator, the remainder after a division operation.",a:"Modulo (remainder) operator.",p:[{name:"dividend",detail:"The number to be divided to find the remainder."},{name:"divisor",detail:"The number to divide by."}]},MROUND:{d:"Rounds one number to the nearest integer multiple of another.",a:"Rounds a number to the nearest integer multiple.",p:[{name:"value",detail:"The number to round to the nearest integer multiple of another."},{name:"factor",detail:"The number to whose multiples `value` will be rounded."}]},ODD:{d:"Rounds a number up to the nearest odd integer.",a:"Rounds a number up to the nearest odd integer.",p:[{name:"value",detail:"The value to round to the next greatest odd number."}]},SUMSQ:{d:"Returns the sum of the squares of a series of numbers and/or cells.",a:"Sum of squares.",p:[{name:"value1",detail:"The first number or range whose squares to add together."},{name:"value2",detail:"Additional numbers or ranges whose squares to add to the square(s) of `value1`."}]},COMBIN:{d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects.",a:"Number of combinations from a set of objects.",p:[{name:"n",detail:"The size of the pool of objects to choose from."},{name:"k",detail:"The number of objects to choose."}]},SUM:{d:"Returns the sum of a series of numbers and/or cells.",a:"Sum of a series of numbers and/or cells.",p:[{name:"value1",detail:"The first number or range to add together."},{name:"value2",detail:"Additional numbers or ranges to add to `value1`."}]},SUBTOTAL:{d:"Returns a subtotal for a vertical range of cells using a specified aggregation function.",a:"Subtotal for a range using a specific function.",p:[{name:"function_code",detail:"The function to use in subtotal aggregation."},{name:"range1",detail:"The first range over which to calculate a subtotal."},{name:"range2",detail:"Additional ranges over which to calculate subtotals."}]},ASIN:{d:"Returns the inverse sine of a value, in radians.",a:"Inverse sine of a value, in radians.",p:[{name:"value",detail:"The value for which to calculate the inverse sine. Must be between `-1` and `1`, inclusive."}]},COUNTIF:{d:"Returns a conditional count across a range.",a:"A conditional count across a range.",p:[{name:"range",detail:"The range that is tested against `criterion`."},{name:"criterion",detail:"The pattern or test to apply to `range`."}]},RADIANS:{d:"Converts an angle value in degrees to radians.",a:"Converts an angle value in degrees to radians.",p:[{name:"angle",detail:"The angle to convert from degrees to radians."}]},RAND:{d:"Returns a random number between 0 inclusive and 1 exclusive.",a:"A random number between 0 inclusive and 1 exclusive.",p:[]},COUNTUNIQUE:{d:"Counts the number of unique values in a list of specified values and ranges.",a:"Counts number of unique values in a range.",p:[{name:"value1",detail:"The first value or range to consider for uniqueness."},{name:"value2",detail:"Additional values or ranges to consider for uniqueness."}]},DEGREES:{d:"Converts an angle value in radians to degrees.",a:"Converts an angle value in radians to degrees.",p:[{name:"angle",detail:"The angle to convert from radians to degrees."}]},ERFC:{d:"Returns the complementary Gauss error function of a value.",a:"Complementary gauss error function of a value.",p:[{name:"z",detail:"The number for which to calculate the complementary Gauss error function."}]},EVEN:{d:"Rounds a number up to the nearest even integer.",a:"Rounds a number up to the nearest even integer.",p:[{name:"value",detail:"The value to round to the next greatest even number."}]},EXP:{d:"Returns Euler's number, e (~2.718) raised to a power.",a:"Euler's number, e (~2.718) raised to a power.",p:[{name:"exponent",detail:"The exponent to raise e to."}]},FACT:{d:"Returns the factorial of a number.",a:"Factorial of a number.",p:[{name:"value",detail:"The number or reference to a number whose factorial will be calculated and returned."}]},FACTDOUBLE:{d:"Returns the 'double factorial' of a number.",a:"'double factorial' of a number.",p:[{name:"value",detail:"The number or reference to a number whose double factorial will be calculated and returned."}]},PI:{d:"Returns the value of Pi to 14 decimal places.",a:"The number pi.",p:[]},FLOOR:{d:"Rounds a number down to the nearest integer multiple of specified significance `factor`.",a:"Rounds number down to nearest multiple of a factor.",p:[{name:"value",detail:"The value to round down to the nearest integer multiple of `factor`."},{name:"factor",detail:"The number to whose multiples `value` will be rounded."}]},GCD:{d:"Returns the greatest common divisor of one or more integers.",a:"Greatest common divisor of one or more integers.",p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the greatest common divisor."},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the greatest common divisor."}]},RANDBETWEEN:{d:"Returns a uniformly random integer between two values, inclusive.",a:"Random integer between two values, inclusive.",p:[{name:"low",detail:"The low end of the random range."},{name:"high",detail:"The high end of the random range."}]},ROUND:{d:"Rounds a number to a certain number of decimal places according to standard rules.",a:"Rounds a number according to standard rules.",p:[{name:"value",detail:"The value to round to `places` number of places."},{name:"places",detail:"The number of decimal places to which to round."}]},ROUNDDOWN:{d:"Rounds a number to a certain number of decimal places, always rounding down to the next valid increment.",a:"Rounds down a number.",p:[{name:"value",detail:"The value to round to `places` number of places, always rounding down."},{name:"places",detail:"The number of decimal places to which to round."}]},ROUNDUP:{d:"Rounds a number to a certain number of decimal places, always rounding up to the next valid increment.",a:"Rounds up a number.",p:[{name:"value",detail:"The value to round to `places` number of places, always rounding up."},{name:"places",detail:"The number of decimal places to which to round."}]},SERIESSUM:{d:"Given parameters `x`, `n`, `m`, and `a`, returns the power series sum a",a:"Sum of a power series.",p:[{name:"x",detail:"The input to the power series. Varies depending on the type of approximation, may be angle, exponent, or some other value."},{name:"n",detail:"The initial power to which to raise `x` in the power series."},{name:"m",detail:"The additive increment by which to increase `x`."},{name:"a",detail:"The array or range containing the coefficients of the power series."}]},SIGN:{d:"Given an input number, returns `-1` if it is negative, `1` if positive, and `0` if it is zero.",a:"Sign of a provided number (+/-/0).",p:[{name:"value",detail:"The value whose sign will be evaluated."}]},SIN:{d:"Returns the sine of an angle provided in radians.",a:"Sine of an angle provided in radians.",p:[{name:"angle",detail:"The angle to find the sine of, in radians."}]},SINH:{d:"Returns the hyperbolic sine of any real number.",a:"Hyperbolic sine of any real number.",p:[{name:"value",detail:"Any real value to calculate the hyperbolic sine of."}]},SQRT:{d:"Returns the positive square root of a positive number.",a:"Positive square root of a positive number.",p:[{name:"value",detail:"The number for which to calculate the positive square root."}]},SQRTPI:{d:"Returns the positive square root of the product of Pi and the given positive number.",a:"Square root of the product of pi and number.",p:[{name:"value",detail:"The number which will be multiplied by Pi and have the product's square root returned"}]},GAMMALN:{d:"Returns the logarithm of a specified Gamma function, base e (Euler's number).",a:"Logarithm of gamma function.",p:[{name:"value",detail:"The input to the Gamma function. The natural logarithm of Gamma(`value`) will be returned."}]},COS:{d:"Returns the cosine of an angle provided in radians.",a:"Cosine of an angle provided in radians.",p:[{name:"angle",detail:"The angle to find the cosine of, in radians."}]},TRUNC:{d:"Truncates a number to a certain number of significant digits by omitting less significant digits.",a:"Truncates a number.",p:[{name:"value",detail:"The value to be truncated."},{name:"places",detail:"The number of significant digits to the right of the decimal point to retain."}]},QUOTIENT:{d:"Returns one number divided by another.",a:"One number divided by another.",p:[{name:"dividend",detail:"The number to be divided."},{name:"divisor",detail:"The number to divide by."}]},POWER:{d:"Returns a number raised to a power.",a:"A number raised to a power.",p:[{name:"base",detail:"The number to raise to the `exponent` power."},{name:"exponent",detail:"The exponent to raise `base` to."}]},SUMIFS:{d:"Returns the sum of a range depending on multiple criteria.",a:"Sums a range depending on multiple criteria.",p:[{name:"sum_range",detail:"The range to sum."},{name:"criteria_range1",detail:"The range to check against criterion1."},{name:"criterion1",detail:"The pattern or test to apply to criteria_range1."},{name:"criteria_range2",detail:"Additional ranges to check."}]},COUNTIFS:{d:"Returns the count of a range depending on multiple criteria.",a:"Count values depending on multiple criteria.",p:[{name:"criteria_range1",detail:"The range to check against `criterion1`."},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`."},{name:"criteria_range2",detail:"Additional ranges to check."}]},PRODUCT:{d:"Returns the result of multiplying a series of numbers together.",a:"Result of multiplying a series of numbers together.",p:[{name:"factor1",detail:"The first number or range to calculate for the product."},{name:"factor2",detail:"More numbers or ranges to calculate for the product."}]},HARMEAN:{d:"Calculates the harmonic mean of a dataset.",a:"The harmonic mean of a dataset.",p:[{name:"value1",detail:"The first value or range of the population."},{name:"value2",detail:"Additional values or ranges to include in the population."}]},HYPGEOMDIST:{d:"Calculates the probability of drawing a certain number of successes in a certain number of tries given a population of a certain size containing a certain number of successes, without replacement of draws.",a:"Hypergeometric distribution probability.",p:[{name:"num_successes",detail:"The desired number of successes."},{name:"num_draws",detail:"The number of permitted draws."},{name:"successes_in_pop",detail:"The total number of successes in the population."},{name:"pop_size",detail:"The total size of the population"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If cumulative is TRUE(), HYPGEOM.DIST returns the cumulative distribution function;

if FALSE(), it returns the probability density function.`}]},INTERCEPT:{d:"Calculates the y-value at which the line resulting from linear regression of a dataset will intersect the y-axis (x=0).",a:"Y-intercept of line derived via linear regression.",p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},KURT:{d:"Calculates the kurtosis of a dataset, which describes the shape, and in particular the 'peakedness' of that dataset.",a:"Kurtosis of a dataset.",p:[{name:"value1",detail:"The first value or range of the dataset."},{name:"value2",detail:"Additional values or ranges to include in the dataset."}]},LARGE:{d:"Returns the nth largest element from a data set, where n is user-defined.",a:"Nth largest element from a data set.",p:[{name:"data",detail:"Array or range containing the dataset to consider."},{name:"n",detail:"The rank from largest to smallest of the element to return."}]},STDEVA:{d:"Calculates the standard deviation based on a sample, setting text to the value `0`.",a:"Standard deviation of sample (text as 0).",p:[{name:"value1",detail:"The first value or range of the sample."},{name:"value2",detail:"Additional values or ranges to include in the sample."}]},STDEVP:{d:"Calculates the standard deviation based on an entire population.",a:"Standard deviation of an entire population.",p:[{name:"value1",detail:"The first value or range of the population."},{name:"value2",detail:"Additional values or ranges to include in the population."}]},GEOMEAN:{d:"Calculates the geometric mean of a dataset.",a:"The geometric mean of a dataset.",p:[{name:"value1",detail:"The first value or range of the population."},{name:"value2",detail:"Additional values or ranges to include in the population."}]},RANK_EQ:{d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the top rank of the entries will be returned.",a:"Top rank of a specified value in a dataset.",p:[{name:"value",detail:"The value whose rank will be determined."},{name:"data",detail:"The array or range containing the dataset to consider."},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE)."}]},RANK_AVG:{d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the average rank of the entries will be returned.",a:"Average rank of a specified value in a dataset.",p:[{name:"value",detail:"The value whose rank will be determined."},{name:"data",detail:"The array or range containing the dataset to consider."},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE)."}]},PERCENTRANK_EXC:{d:"Returns the percentage rank (percentile) from 0 to 1 exclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 exclusive.",p:[{name:"data",detail:"The array or range containing the dataset to consider."},{name:"value",detail:"The value whose percentage rank will be determined."},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3."}]},PERCENTRANK_INC:{d:"Returns the percentage rank (percentile) from 0 to 1 inclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 inclusive.",p:[{name:"data",detail:"The array or range containing the dataset to consider."},{name:"value",detail:"The value whose percentage rank will be determined."},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3."}]},FORECAST:{d:"Calculates the expected y-value for a specified x based on a linear regression of a dataset.",a:"Expected y-value based of linear regression.",p:[{name:"x",detail:"The value on the x-axis to forecast."},{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},FISHERINV:{d:"Returns the inverse Fisher transformation of a specified value.",a:"Inverse fisher transformation of a specified value.",p:[{name:"value",detail:"The value for which to calculate the inverse Fisher transformation."}]},FISHER:{d:"Returns the Fisher transformation of a specified value.",a:"Fisher transformation of a specified value.",p:[{name:"value",detail:"The value for which to calculate the Fisher transformation."}]},MODE_SNGL:{d:"Returns the most commonly occurring value in a dataset.",a:"Most commonly occurring value in a dataset.",p:[{name:"value1",detail:"The first value or range to consider when calculating mode."},{name:"value2",detail:"Additional values or ranges to consider when calculating mode."}]},WEIBULL_DIST:{d:"Returns the value of the Weibull distribution function (or Weibull cumulative distribution function) for a specified shape and scale.",a:"Weibull distribution function.",p:[{name:"x",detail:"The input to the Weibull distribution function."},{name:"shape",detail:"The shape parameter of the Weibull distribution function."},{name:"scale",detail:"The scale parameter of the Weibull distribution function."},{name:"cumulative",detail:"Whether to use the cumulative distribution function."}]},COUNT:{d:"Returns the number of numeric values in a dataset.",a:"The number of numeric values in dataset.",p:[{name:"value1",detail:"The first value or range to consider when counting."},{name:"value2",detail:"Additional values or ranges to consider when counting."}]},COUNTA:{d:"Returns the number of values in a dataset.",a:"The number of values in a dataset.",p:[{name:"value1",detail:"The first value or range to consider when counting."},{name:"value2",detail:"Additional values or ranges to consider when counting."}]},AVEDEV:{d:"Calculates the average of the magnitudes of deviations of data from a dataset's mean.",a:"Average magnitude of deviations from mean.",p:[{name:"value1",detail:"The first value or range of the sample."},{name:"value2",detail:"Additional values or ranges to include in the sample."}]},AVERAGE:{d:"Returns the numerical average value in a dataset, ignoring text.",a:"Numerical average value in a dataset, ignoring text.",p:[{name:"value1",detail:"The first value or range to consider when calculating the average value."},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value."}]},AVERAGEA:{d:"Returns the numerical average value in a dataset.",a:"Numerical average value in a dataset.",p:[{name:"value1",detail:"The first value or range to consider when calculating the average value."},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value."}]},BINOM_DIST:{d:"Calculates the probability of drawing a certain number of successes (or a maximum number of successes) in a certain number of tries given a population of a certain size containing a certain number of successes, with replacement of draws.",a:"Binomial distribution probability.",p:[{name:"num_successes",detail:"The number of successes for which to calculate the probability in `num_trials` trials."},{name:"num_trials",detail:"The number of independent trials."},{name:"prob_success",detail:"The probability of success in any given trial."},{name:"cumulative",detail:"Whether to use the binomial cumulative distribution."}]},BINOM_INV:{d:"Calculates the smallest value for which the cumulative binomial distribution is greater than or equal to a specified criteria.",a:"Inverse cumulative binomial distribution function.",p:[{name:"num_trials",detail:"The number of independent trials."},{name:"prob_success",detail:"The probability of success in any given trial."},{name:"target_prob",detail:"The desired threshold probability."}]},CONFIDENCE_NORM:{d:"Calculates the width of half the confidence interval for a normal distribution.",a:"Confidence interval for a normal distribution.",p:[{name:"alpha",detail:"One minus the desired confidence level. E.g. `0.1` for `0.9`, or 90%, confidence."},{name:"standard_deviation",detail:"The standard deviation of the population."},{name:"pop_size",detail:"The size of the population."}]},CORREL:{d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},COVARIANCE_P:{d:"Calculates the covariance of a dataset.",a:"The covariance of a dataset.",p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},COVARIANCE_S:{d:"Calculates the sample covariance of a dataset.",a:"The sample covariance of a dataset.",p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},DEVSQ:{d:"Calculates the sum of squares of deviations based on a sample.",a:"The sum of squares of deviations based on a sample.",p:[{name:"value1",detail:"The first value or range of the sample."},{name:"value2",detail:"Additional values or ranges to include in the sample."}]},EXPON_DIST:{d:"Returns the value of the exponential distribution function with a specified lambda at a specified value.",a:"Exponential distribution function.",p:[{name:"x",detail:"The input to the exponential distribution function."},{name:"lambda",detail:"The lambda to specify the exponential distribution function."},{name:"cumulative",detail:"Whether to use the exponential cumulative distribution."}]},AVERAGEIF:{d:"Returns the average of a range depending on criteria.",a:"Average of values depending on criteria.",p:[{name:"criteria_range",detail:"The range to check against `criterion`."},{name:"criterion",detail:"The pattern or test to apply to `criteria_range`."},{name:"average_range",detail:"The range to average. If not included, `criteria_range` is used for the average instead."}]},AVERAGEIFS:{d:"Returns the average of a range depending on multiple criteria.",a:"Average of values depending on multiple criteria.",p:[{name:"average_range",detail:"The range to average."},{name:"criteria_range1",detail:"The range to check against `criterion1`."},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`."},{name:"criteria_range2",detail:"Additional ranges to check."}]},PERMUT:{d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects, considering order.",a:"Number of permutations from a number of objects.",p:[{name:"n",detail:"The size of the pool of objects to choose from."},{name:"k",detail:"The number of objects to choose."}]},TRIMMEAN:{d:"Calculates the mean of a dataset excluding some proportion of data from the high and low ends of the dataset.",a:"Mean of a dataset excluding high/low ends.",p:[{name:"data",detail:"Array or range containing the dataset to consider."},{name:"exclude_proportion",detail:"The proportion of the dataset to exclude, from the extremities of the set."}]},PERCENTILE_EXC:{d:"Returns the value at a given percentile of a dataset exclusive of 0 and 1.",a:"Value at a given percentile of a dataset exclusive of 0 and 1.",p:[{name:"data",detail:"The array or range containing the dataset to consider."},{name:"percentile",detail:"The percentile, exclusive of 0 and 1, whose value within 'data' will be calculated and returned."}]},PERCENTILE_INC:{d:"Returns the value at a given percentile of a dataset.",a:"Value at a given percentile of a dataset.",p:[{name:"data",detail:"The array or range containing the dataset to consider."},{name:"percentile",detail:"The percentile whose value within `data` will be calculated and returned.`"}]},PEARSON:{d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},NORM_S_INV:{d:"Returns the value of the inverse standard normal distribution function for a specified value.",a:"Inverse standard normal distribution function.",p:[{name:"x",detail:"The input to the inverse standard normal distribution function."}]},NORM_S_DIST:{d:"Returns the value of the standard normal cumulative distribution function for a specified value.",a:"Standard normal cumulative distribution function.",p:[{name:"x",detail:"The input to the standard normal cumulative distribution function."},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`}]},NORM_INV:{d:"Returns the value of the inverse normal distribution function for a specified value, mean, and standard deviation.",a:"Inverse normal distribution function.",p:[{name:"x",detail:"The input to the inverse normal distribution function."},{name:"mean",detail:"The mean (mu) of the normal distribution function."},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function."}]},NORM_DIST:{d:"Returns the value of the normal distribution function (or normal cumulative distribution function) for a specified value, mean, and standard deviation.",a:"Normal distribution function.",p:[{name:"x",detail:"The input to the normal distribution function."},{name:"mean",detail:"The mean (mu) of the normal distribution function."},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function."},{name:"cumulative",detail:"Whether to use the normal cumulative distribution function rather than the distribution function."}]},NEGBINOM_DIST:{d:"Calculates the probability of drawing a certain number of failures before a certain number of successes given a probability of success in independent trials.",a:"Negative binomial distribution probability.",p:[{name:"num_failures",detail:"The number of failures to model."},{name:"num_successes",detail:"The number of successes to model."},{name:"prob_success",detail:"The probability of success in any given trial."},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`}]},MINA:{d:"Returns the minimum numeric value in a dataset.",a:"Minimum numeric value in a dataset.",p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value."},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value."}]},MIN:{d:"Returns the minimum value in a numeric dataset.",a:"Minimum value in a numeric dataset.",p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value."},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value."}]},MEDIAN:{d:"Returns the median value in a numeric dataset.",a:"Median value in a numeric dataset.",p:[{name:"value1",detail:"The first value or range to consider when calculating the median value."},{name:"value2",detail:"Additional values or ranges to consider when calculating the median value."}]},MAXA:{d:"Returns the maximum numeric value in a dataset.",a:"Maximum numeric value in a dataset.",p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value."},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value."}]},MAX:{d:"Returns the maximum value in a numeric dataset.",a:"Maximum value in a numeric dataset.",p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value."},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value."}]},LOGNORM_INV:{d:"Returns the value of the inverse log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Inverse log-normal cumulative distribution function.",p:[{name:"x",detail:"The input to the inverse log-normal cumulative distribution function."},{name:"mean",detail:"The mean (mu) of the inverse log-normal cumulative distribution function."},{name:"standard_deviation",detail:"The standard deviation (sigma) of the inverse log-normal cumulative distribution function."}]},LOGNORM_DIST:{d:"Returns the value of the log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Log-normal cumulative distribution probability.",p:[{name:"x",detail:"The input to the log-normal cumulative distribution function."},{name:"mean",detail:"The mean (mu) of the log-normal cumulative distribution function."},{name:"standard_deviation",detail:"The standard deviation (sigma) of the log-normal cumulative distribution function."},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`}]},Z_TEST:{d:"Returns the one-tailed p-value of a Z-test with standard distribution.",a:"One-tailed p-value of a z-test.",p:[{name:"data",detail:"The array or range containing the dataset to consider."},{name:"value",detail:"The test statistic to use in the Z-test."},{name:"standard_deviation",detail:"The standard deviation to assume for the Z-test. If this is not provided, the standard deviation of the data will be used."}]},PROB:{d:"Given a set of values and corresponding probabilities, calculates the probability that a value chosen at random falls between two limits.",a:"Probability values lie in a range.",p:[{name:"data",detail:"Array or range containing the dataset to consider."},{name:"probabilities",detail:"Array or range containing probabilities corresponding to `data`."},{name:"low_limit",detail:"The lower bound on the value range for which to calculate the probability."},{name:"high_limit",detail:"The upper bound on the value range for which to calculate the probability."}]},QUARTILE_EXC:{d:"Returns a value nearest to a specified quartile of a dataset exclusive of 0 and 4.",a:"Value nearest to a specific quartile of a dataset exclusive of 0 and 4.",p:[{name:"data",detail:"The array or range containing the dataset to consider."},{name:"quartile_number",detail:"Which quartile to return."}]},QUARTILE_INC:{d:"Returns a value nearest to a specified quartile of a dataset.",a:"Value nearest to a specific quartile of a dataset.",p:[{name:"data",detail:"The array or range containing the dataset to consider."},{name:"quartile_number",detail:"Which quartile value to return."}]},POISSON_DIST:{d:"Returns the value of the Poisson distribution function (or Poisson cumulative distribution function) for a specified value and mean.",a:"Poisson distribution function.",p:[{name:"x",detail:"The input to the Poisson distribution function."},{name:"mean",detail:"The mean (mu) of the Poisson distribution function."},{name:"cumulative",detail:"Whether to use the Poisson cumulative distribution function rather than the distribution function."}]},RSQ:{d:"Calculates the square of r, the Pearson product-moment correlation coefficient of a dataset.",a:"Square of the correlation coefficient.",p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},T_DIST:{d:"Calculates the left tail probability for a Student's t-distribution with a given input (x).",a:"The left-tailed Student's t-distribution",p:[{name:"x",detail:"The input to the t-distribution function."},{name:"degrees_freedom",detail:"The number of degrees of freedom."},{name:"cumulative",detail:"If cumulative is TRUE, T.DIST returns the cumulative distribution function; if FALSE, it returns the probability density function."}]},T_DIST_2T:{d:"Calculates the probability for two tailed Student's t-distribution with a given input (x).",a:"The two tailed Student's t-distribution",p:[{name:"x",detail:"The input to the t-distribution function."},{name:"degrees_freedom",detail:"The number of degrees of freedom."}]},T_DIST_RT:{d:"Calculates the right tail probability for a Student's t-distribution with a given input (x).",a:"The right-tailed Student's t-distribution",p:[{name:"x",detail:"The input to the t-distribution function."},{name:"degrees_freedom",detail:"The number of degrees of freedom."}]},T_INV:{d:"Calculates the negative inverse of the one-tailed TDIST function.",a:"T.INV",p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution."},{name:"degrees_freedom",detail:"The number of degrees of freedom."}]},T_INV_2T:{d:"Calculates the inverse of the two-tailed TDIST function.",a:"T.INV.2T",p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution."},{name:"degrees_freedom",detail:"The number of degrees of freedom."}]},T_TEST:{d:"t-test. Returns the probability associated with Student's t-test. Determines whether two samples are likely to have come from the same two underlying populations that have the same mean.",a:"Returns the probability associated with t-test.",p:[{name:"range1",detail:"The first sample of data or group of cells to consider for the t-test."},{name:"range2",detail:"The second sample of data or group of cells to consider for the t-test."},{name:"tails",detail:"Specifies the number of distribution tails."},{name:"type",detail:"Specifies the type of t-test."}]},F_DIST:{d:"Calculates the left-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution (left-tailed).",p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function."},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom."},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom."},{name:"cumulative",detail:"Logical value that determines the form of the function."}]},F_DIST_RT:{d:"Calculates the right-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution.",p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function."},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom."},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom."}]},VAR_P:{d:"Calculates the variance based on an entire population.",a:"Variance of entire population.",p:[{name:"value1",detail:"The first value or range of the population."},{name:"value2",detail:"Additional values or ranges to include in the population."}]},VAR_S:{d:"Calculates the variance based on a sample.",a:"Variance.",p:[{name:"value1",detail:"The first value or range of the sample."},{name:"value2",detail:"Additional values or ranges to include in the sample."}]},VARA:{d:"Calculates the variance based on a sample, setting text to the value `0`.",a:"Variance of sample (text as 0).",p:[{name:"value1",detail:"The first value or range of the sample."},{name:"value2",detail:"Additional values or ranges to include in the sample."}]},VARPA:{d:"Calculates the variance based on an entire population, setting text to the value `0`.",a:"Variance of entire population (text as 0).",p:[{name:"value1",detail:"The first value or range of the population."},{name:"value2",detail:"Additional values or ranges to include in the population."}]},STEYX:{d:"Calculates the standard error of the predicted y-value for each x in the regression of a dataset.",a:"Standard error of predicted y-values in regression.",p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},STANDARDIZE:{d:"Calculates the normalized equivalent of a random variable given mean and standard deviation of the distribution.",a:"Normalized equivalent of a random variable.",p:[{name:"value",detail:"The value of the random variable to normalize."},{name:"mean",detail:"The mean of the distribution."},{name:"standard_deviation",detail:"The standard deviation of the distribution."}]},SMALL:{d:"Returns the nth smallest element from a data set, where n is user-defined.",a:"Nth smallest element in a data set.",p:[{name:"data",detail:"The array or range containing the dataset to consider."},{name:"n",detail:"The rank from smallest to largest of the element to return."}]},SLOPE:{d:"Calculates the slope of the line resulting from linear regression of a dataset.",a:"Slope of line from linear regression of data.",p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data."},{name:"data_x",detail:"The range representing the array or matrix of independent data."}]},SKEW:{d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean.",a:"Skewness of a dataset.",p:[{name:"value1",detail:"The first value or range of the dataset."},{name:"value2",detail:"Additional values or ranges to include in the dataset."}]},SKEW_P:{d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean. This assumes the dataset is for the population.",a:"Skewness of a population's dataset.",p:[{name:"value1",detail:"The first value or range of the dataset."},{name:"value2",detail:"Additional values or ranges to include in the dataset."}]},VLOOKUP:{d:"Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.",a:"Vertical lookup.",p:[{name:"search_key",detail:"The value to search for. For example, `42`, `'Cats'`, or `I24`."},{name:"range",detail:"The range to consider for the search. The first column in the range is searched for the key specified in `search_key`."},{name:"index",detail:"The column index of the value to be returned, where the first column in `range` is numbered 1."},{name:"is_sorted",detail:"Indicates whether the column to be searched (the first column of the specified range) is sorted, in which case the closest match for `search_key` will be returned."}]},HLOOKUP:{d:"Horizontal lookup. Searches across the first row of a range for a key and returns the value of a specified cell in the column found.",a:"Horizontal lookup",p:[{name:"search_key",detail:"The value to search for. For example, `42`, `'Cats'`, or `I24`."},{name:"range",detail:"The range to consider for the search. The first row in the range is searched for the key specified in `search_key`."},{name:"index",detail:"The row index of the value to be returned, where the first row in `range` is numbered 1."},{name:"is_sorted",detail:"Indicates whether the row to be searched (the first row of the specified range) is sorted."}]},LOOKUP:{d:"Looks through a sorted row or column for a key and returns the value of the cell in a result range located in the same position as the search row or column.",a:"Look up a value.",p:[{name:"search_key",detail:"The value to search for in the row or column. For example, `42`, `'Cats'`, or `I24`."},{name:"search_range|search_result_array",detail:"One method of using this function is to provide a single sorted row or column `search_range` to look through for the `search_key` with a second argument `result_range`. The other way is to combine these two arguments into one `search_result_array` where the first row or column is searched and a value is returned from the last row or column in the array. If `search_key` is not found, a non-exact match may be returned."},{name:"result_range",detail:"The range from which to return a result. The value returned corresponds to the location where `search_key` is found in `search_range`. This range must be only a single row or column and should not be used if using the `search_result_array` method."}]},ADDRESS:{d:"Returns a cell reference as a string.",a:"Cell reference as a string.",p:[{name:"row",detail:"The row number of the cell reference"},{name:"column",detail:"The column number (not name) of the cell reference. `A` is column number `1`."},{name:"absolute_relative_mode",detail:"An indicator of whether the reference is row/column absolute. `1` is row and column absolute (e.g. $A$1), `2` is row absolute and column relative (e.g. A$1), `3` is row relative and column absolute (e.g. $A1), and `4` is row and column relative (e.g. A1)."},{name:"use_a1_notation",detail:"A boolean indicating whether to use `A1` style notation (TRUE) or `R1C1` style notation (FALSE)."},{name:"sheet",detail:"Text indicating the name of the sheet into which the address points."}]},INDIRECT:{d:"Returns a cell reference specified by a string.",a:"A cell reference specified by a string.",p:[{name:"cell_reference_as_string",detail:"A cell reference, written as a string with surrounding quotation marks."},{name:"is_A1_notation",detail:"Indicates if the cell reference is in A1 notation (TRUE) or R1C1 notation (FALSE)."}]},ROW:{d:"Returns the row number of a specified cell.",a:"Row number of a specified cell.",p:[{name:"cell_reference",detail:"The cell whose row number will be returned."}]},ROWS:{d:"Returns the number of rows in a specified array or range.",a:"Number of rows in a specified array or range.",p:[{name:"range",detail:"The range whose row count will be returned."}]},COLUMN:{d:"Returns the column number of a specified cell, with `A=1`.",a:"Column number of a specified cell.",p:[{name:"cell_reference",detail:"The cell whose column number will be returned. Column `A` corresponds to `1`."}]},COLUMNS:{d:"Returns the number of columns in a specified array or range.",a:"Number of columns in a specified array or range.",p:[{name:"range",detail:"The range whose column count will be returned."}]},OFFSET:{d:"Returns a range reference shifted a specified number of rows and columns from a starting cell reference.",a:"A range reference offset relative to a cell.",p:[{name:"cell_reference",detail:"The starting point from which to count the offset rows and columns."},{name:"offset_rows",detail:"The number of rows to offset by."},{name:"offset_columns",detail:"The number of columns to offset by."},{name:"height",detail:"The height of the range to return starting at the offset target."},{name:"width",detail:"The width of the range to return starting at the offset target."}]},MATCH:{d:"Returns the relative position of an item in a range that matches a specified value.",a:"Position of item in range that matches value.",p:[{name:"search_key",detail:"The value to search for. For example, `42`, `'Cats'`, or `I24`."},{name:"range",detail:"The one-dimensional array to be searched."},{name:"search_type",detail:"The search method. `1` (default) finds the largest value less than or equal to `search_key` when `range` is sorted in ascending order. `0` finds the exact value when `range` is unsorted. `-1` finds the smallest value greater than or equal to `search_key` when `range` is sorted in descending order."}]},INDEX:{d:"Returns the content of a cell, specified by row and column offset.",a:"Content of cell specified by row and column offset.",p:[{name:"reference",detail:"The array of cells to be offset into."},{name:"row",detail:"The number of offset rows."},{name:"column",detail:"The number of offset columns."}]},GETPIVOTDATA:{d:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",a:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",p:[{name:"value_name",detail:"The name of the value in the pivot table for which you want to get data."},{name:"any_pivot_table_cell",detail:"Any reference to a cell in the desired pivot table (top corner recommended)."},{name:"original_column",detail:"The name of the column in the original data set (not the pivot table)."},{name:"pivot_item",detail:"The name of the row or column shown in the pivot table corresponding to *original_column* that you want to retrieve."}]},CHOOSE:{d:"Returns an element from a list of choices based on index.",a:"An element from a list of choices based on index.",p:[{name:"index",detail:"Which choice (of the up to 30 provided) to return."},{name:"choice1",detail:"A potential value to return. Required. May be a reference to a cell or an individual value."},{name:"choice2",detail:"Additional values among which to choose."}]},HYPERLINK:{d:"Creates a hyperlink inside a cell.",a:"Creates a hyperlink inside a cell.",p:[{name:"url",detail:"The full URL of the link location enclosed in quotation marks, or a reference to a cell containing such a URL."},{name:"link_label",detail:"The text to display in the cell as the link, enclosed in quotation marks, or a reference to a cell containing such a label."}]},TIME:{d:"Converts a provided hour, minute, and second into a time.",a:"Converts hour/minute/second into a time.",p:[{name:"hour",detail:"The hour component of the time."},{name:"minute",detail:"The minute component of the time."},{name:"second",detail:"The second component of the time."}]},TIMEVALUE:{d:"Returns the fraction of a 24-hour day the time represents.",a:"Converts a time string into its serial number representation.",p:[{name:"time_string",detail:"The string that holds the time representation."}]},EOMONTH:{d:"Returns a date on the last day of a month that falls a specified number of months before or after another date.",a:"Last day of a month before or after a date.",p:[{name:"start_date",detail:"The date from which to calculate the result."},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to consider."}]},EDATE:{d:"Returns a date a specified number of months before or after another date.",a:"Date a number of months before/after another date.",p:[{name:"start_date",detail:"The date from which to calculate the result."},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to calculate."}]},SECOND:{d:"Returns the second component of a specific time, in numeric format.",a:"Second component of a specific time.",p:[{name:"time",detail:"The time from which to calculate the second component"}]},MINUTE:{d:"Returns the minute component of a specific time, in numeric format.",a:"Minute component of a specific time.",p:[{name:"time",detail:"The time from which to calculate the minute component."}]},HOUR:{d:"Returns the hour component of a specific time, in numeric format.",a:"Hour component of a specific time.",p:[{name:"time",detail:"The time from which to calculate the hour component."}]},NOW:{d:"Returns the current date and time as a date value.",a:"Current date and time as a date value.",p:[]},NETWORKDAYS:{d:"Returns the number of net working days between two provided days.",a:"Net working days between two provided days.",p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days."},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days."},{name:"holidays",detail:"A range or array constant containing the date serial numbers to consider holidays."}]},NETWORKDAYS_INTL:{d:"Returns the number of net working days between two provided days excluding specified weekend days and holidays.",a:"Net working days between two dates (specifying weekends).",p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days."},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days."},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends."},{name:"holidays",detail:"A range or array constant containing the dates to consider as holidays."}]},ISOWEEKNUM:{d:"Returns a number representing the ISO week of the year where the provided date falls.",a:"ISO week number of the year.",p:[{name:"date",detail:"The date for which to determine the ISO week number. Must be a reference to a cell containing a date, a function returning a date type, or a number."}]},WEEKNUM:{d:"Returns a number representing the week of the year where the provided date falls.",a:"Week number of the year.",p:[{name:"date",detail:"The date for which to determine the week number. Must be a reference to a cell containing a date, a function returning a date type, or a number."},{name:"type",detail:"A number representing the day that a week starts on. Sunday = 1."}]},WEEKDAY:{d:"Returns a number representing the day of the week of the date provided.",a:"Day of the week of the date provided (as number).",p:[{name:"date",detail:"The date for which to determine the day of the week. Must be a reference to a cell containing a date, a function returning a date type, or a number."},{name:"type",detail:"A number indicating which numbering system to use to represent weekdays. By default, counts starting with Sunday = 1."}]},DAY:{d:"Returns the day of the month that a specific date falls on, in numeric format.",a:"Day of the month that a specific date falls on.",p:[{name:"date",detail:"The date from which to extract the day."}]},DAYS:{d:"Returns the number of days between two dates.",a:"Number of days between two dates.",p:[{name:"end_date",detail:"The end of the date range."},{name:"start_date",detail:"The start of the date range."}]},DAYS360:{d:"Returns the difference between two days based on the 360 day year used in some financial interest calculations.",a:"Days between two dates on a 360-day year.",p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number."},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number."},{name:"method",detail:"An indicator of what day count method to use."}]},DATE:{d:"Converts a provided year, month, and day into a date.",a:"Converts year/month/day into a date.",p:[{name:"year",detail:"The year component of the date."},{name:"month",detail:"The month component of the date."},{name:"day",detail:"The day component of the date."}]},DATEVALUE:{d:"Converts a provided date string in a known format to a date value.",a:"Converts a date string to a date value.",p:[{name:"date_string",detail:"The string representing the date."}]},DATEDIF:{d:"Calculates the number of days, months, or years between two dates.",a:"Date Difference.",p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number."},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number."},{name:"unit",detail:"A string abbreviation for unit of time. For example, 'M' for month. Accepted values are 'Y','M','D','MD','YM','YD'."}]},WORKDAY:{d:"Calculates the date after a number of working days from a specified start date.",a:"Number of working days from start date.",p:[{name:"start_date",detail:"The date from which to begin counting."},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards."},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays."}]},WORKDAY_INTL:{d:"Calculates the date after a specified number of workdays excluding specified weekend days and holidays.",a:"Date after a number of workdays (specifying weekends).",p:[{name:"start_date",detail:"The date from which to begin counting."},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards."},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends."},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays."}]},YEAR:{d:"Returns the year specified by a given date.",a:"Year specified by a given date.",p:[{name:"date",detail:"The date from which to extract the year."}]},YEARFRAC:{d:"Returns the number of years, including fractional years, between two dates using a specified day count convention.",a:"Exact number of years between two dates.",p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number."},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},TODAY:{d:"Returns the current date as a date value.",a:"Current date as a date value.",p:[]},MONTH:{d:"Returns the month of the year a specific date falls in, in numeric format.",a:"Month of the year a specific date falls in.",p:[{name:"date",detail:"The date from which to extract the month."}]},EFFECT:{d:"Calculates the annual effective interest rate given the nominal rate and number of compounding periods per year.",a:"Annual effective interest rate.",p:[{name:"nominal_rate",detail:"The nominal interest rate per year."},{name:"periods_per_year",detail:"The number of compounding periods per year."}]},DOLLAR:{d:"Formats a number into the currency specific to your spreadsheet locale.",a:"Formats a number as currency specific to your spreadsheet locale.",p:[{name:"number",detail:"The value to be formatted."},{name:"number_of_places",detail:"The number of decimal places to display."}]},DOLLARDE:{d:"Converts a price quotation given as a decimal fraction into a decimal value.",a:"Converts a decimal fraction to decimal value.",p:[{name:"fractional_price",detail:"The price quotation given using fractional decimal conventions."},{name:"unit",detail:"The units of the fraction, e.g. `8` for 1/8ths or `32` for 1/32nds."}]},DOLLARFR:{d:"Converts a price quotation given as a decimal value into a decimal fraction.",a:"Converts a decimal value to decimal fraction.",p:[{name:"decimal_price",detail:"The price quotation given as a decimal value."},{name:"unit",detail:"The units of the desired fraction, e.g. `8` for 1/8ths or `32` for 1/32nds."}]},DB:{d:"Calculates the depreciation of an asset for a specified period using the arithmetic declining balance method.",a:"Depreciation via declining balance method.",p:[{name:"cost",detail:"The initial cost of the asset."},{name:"salvage",detail:"The value of the asset at the end of depreciation."},{name:"life",detail:"The number of periods over which the asset is depreciated."},{name:"period",detail:"The single period within `life` for which to calculate depreciation."},{name:"month",detail:"The number of months in the first year of depreciation."}]},DDB:{d:"Calculates the depreciation of an asset for a specified period using the double-declining balance method.",a:"Depreciation via double-declining balance method.",p:[{name:"cost",detail:"The initial cost of the asset."},{name:"salvage",detail:"The value of the asset at the end of depreciation."},{name:"life",detail:"The number of periods over which the asset is depreciated."},{name:"period",detail:"The single period within `life` for which to calculate depreciation."},{name:"factor",detail:"The factor by which depreciation decreases."}]},RATE:{d:"Calculates the interest rate of an annuity investment based on constant-amount periodic payments and the assumption of a constant interest rate.",a:"Interest rate of an annuity investment.",p:[{name:"number_of_periods",detail:"The number of payments to be made."},{name:"payment_per_period",detail:"The amount per period to be paid."},{name:"present_value",detail:"The current value of the annuity."},{name:"future_value",detail:"The future value remaining after the final payment has been made."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."},{name:"rate_guess",detail:"An estimate for what the interest rate will be."}]},CUMPRINC:{d:"Calculates the cumulative principal paid over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative principal paid over a set of periods.",p:[{name:"rate",detail:"The interest rate."},{name:"number_of_periods",detail:"The number of payments to be made."},{name:"present_value",detail:"The current value of the annuity."},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation."},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."}]},COUPNUM:{d:"Calculates the number of coupons, or interest payments, between the settlement date and the maturity date of the investment.",a:"Number of coupons between settlement and maturity.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},SYD:{d:"Calculates the depreciation of an asset for a specified period using the sum of years digits method.",a:"Depreciation via sum of years digits method.",p:[{name:"cost",detail:"The initial cost of the asset."},{name:"salvage",detail:"The value of the asset at the end of depreciation."},{name:"life",detail:"The number of periods over which the asset is depreciated."},{name:"period",detail:"The single period within `life` for which to calculate depreciation."}]},TBILLEQ:{d:"Calculates the equivalent annualized rate of return of a US Treasury Bill based on discount rate.",a:"Equivalent rate of return for a Treasury bill.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"discount",detail:"The discount rate of the bill at time of purchase."}]},TBILLYIELD:{d:"Calculates the yield of a US Treasury Bill based on price.",a:"The yield of a us treasury bill based on price.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"price",detail:"The price at which the security is bought per 100 face value."}]},TBILLPRICE:{d:"Calculates the price of a US Treasury Bill based on discount rate.",a:"Price of US treasury bill.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"discount",detail:"The discount rate of the bill at time of purchase."}]},PV:{d:"Calculates the present value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Present value of an annuity investment.",p:[{name:"rate",detail:"The interest rate."},{name:"number_of_periods",detail:"The number of payments to be made."},{name:"payment_amount",detail:"The amount per period to be paid."},{name:"future_value",detail:"The future value remaining after the final payment has been made."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."}]},ACCRINT:{d:"Calculates the accrued interest of a security that has periodic payments.",a:"Accrued interest of security with periodic payments.",p:[{name:"issue",detail:"The date the security was initially issued."},{name:"first_payment",detail:"The first date interest will be paid."},{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"rate",detail:"The annualized rate of interest."},{name:"redemption",detail:"The redemption amount per 100 face value, or par."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."},{name:"calc_method",detail:`[Optional-defaults to TRUE()] - A logical value that specifies the method used to calculate the total accrued interest when the settlement date is later than the first interest accrual date. 

If the value is TRUE, the total accrued interest from the issue date to the settlement date is returned. 

If the value is FALSE, return the accrued interest from the first interest accrual date to the settlement date.`}]},ACCRINTM:{d:"Calculates the accrued interest of a security that pays interest at maturity.",a:"Accrued interest of security paying at maturity.",p:[{name:"issue",detail:"The date the security was initially issued."},{name:"maturity",detail:"The maturity date of the security."},{name:"rate",detail:"The annualized rate of interest."},{name:"redemption",detail:"The redemption amount per 100 face value, or par."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},COUPDAYBS:{d:"Calculates the number of days from the first coupon, or interest payment, until settlement.",a:"Number of days from first coupon to settlement.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},COUPDAYS:{d:"Calculates the number of days in the coupon, or interest payment, period that contains the specified settlement date.",a:"Days in coupon period containing settlement date.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},COUPDAYSNC:{d:"Calculates the number of days from the settlement date until the next coupon, or interest payment.",a:"Days from settlement until next coupon.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},COUPNCD:{d:"Calculates next coupon, or interest payment, date after the settlement date.",a:"Next coupon date after the settlement date.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},COUPPCD:{d:"Calculates last coupon, or interest payment, date before the settlement date.",a:"Last coupon date before settlement date.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},FV:{d:"Calculates the future value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Future value of an annuity investment.",p:[{name:"rate",detail:"The interest rate."},{name:"number_of_periods",detail:"The number of payments to be made."},{name:"payment_amount",detail:"The amount per period to be paid."},{name:"present_value",detail:"The current value of the annuity."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."}]},FVSCHEDULE:{d:"Calculates the future value of some principal based on a specified series of potentially varying interest rates.",a:"Future value of principal from series of rates.",p:[{name:"principal",detail:"The amount of initial capital or value to compound against."},{name:"rate_schedule",detail:"A series of interest rates to compound against the `principal`."}]},YIELD:{d:"Calculates the annual yield of a security paying periodic interest, such as a US Treasury Bond, based on price.",a:"Annual yield of a security paying periodic interest.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"rate",detail:"The annualized rate of interest."},{name:"price",detail:"The price at which the security is bought per 100 face value."},{name:"redemption",detail:"The redemption amount per 100 face value, or par."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},YIELDDISC:{d:"Calculates the annual yield of a discount (non-interest-bearing) security, based on price.",a:"Annual yield of a discount security.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"price",detail:"The price at which the security is bought per 100 face value."},{name:"redemption",detail:"The redemption amount per 100 face value, or par."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},NOMINAL:{d:"Calculates the annual nominal interest rate given the effective rate and number of compounding periods per year.",a:"Annual nominal interest rate.",p:[{name:"effective_rate",detail:"The effective interest rate per year."},{name:"periods_per_year",detail:"The number of compounding periods per year."}]},XIRR:{d:"Calculates the internal rate of return of an investment based on a specified series of potentially irregularly spaced cash flows.",a:"Internal rate of return given non-periodic cashflows.",p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment."},{name:"cashflow_dates",detail:"An array or range with dates corresponding to the cash flows in `cashflow_amounts`."},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be."}]},MIRR:{d:"Calculates the modified internal rate of return on an investment based on a series of periodic cash flows and the difference between the interest rate paid on financing versus the return received on reinvested income.",a:"Modified internal rate of return.",p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment."},{name:"financing_rate",detail:"The interest rate paid on funds invested."},{name:"reinvestment_return_rate",detail:"The return (as a percentage) earned on reinvestment of income received from the investment."}]},IRR:{d:"Calculates the internal rate of return on an investment based on a series of periodic cash flows.",a:"Internal rate of return given periodic cashflows.",p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment."},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be."}]},NPV:{d:"Calculates the net present value of an investment based on a series of periodic cash flows and a discount rate.",a:"The net present value of an investment based on a series of periodic cash flows and a discount rate.",p:[{name:"discount",detail:"The discount rate of the investment over one period."},{name:"cashflow1",detail:"The first future cash flow."},{name:"cashflow2",detail:"Additional future cash flows."}]},XNPV:{d:"Calculates the net present value of an investment based on a specified series of potentially irregularly spaced cash flows and a discount rate.",a:"Net present value given non-periodic cashflows.",p:[{name:"discount",detail:"The discount rate of the investment over one period."},{name:"cashflow_amounts",detail:"A range of cells containing the income or payments associated with the investment."},{name:"cashflow_dates",detail:"A range of cells with dates corresponding to the cash flows in `cashflow_amounts`."}]},CUMIPMT:{d:"Calculates the cumulative interest over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative interest paid over a set of periods.",p:[{name:"rate",detail:"The interest rate."},{name:"number_of_periods",detail:"The number of payments to be made."},{name:"present_value",detail:"The current value of the annuity."},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation."},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."}]},PMT:{d:"Calculates the periodic payment for an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Periodic payment for an annuity investment.",p:[{name:"rate",detail:"The interest rate."},{name:"number_of_periods",detail:"The number of payments to be made."},{name:"present_value",detail:"The current value of the annuity."},{name:"future_value",detail:"The future value remaining after the final payment has been made."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."}]},IPMT:{d:"Calculates the payment on interest for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on interest for an investment.",p:[{name:"rate",detail:"The interest rate."},{name:"period",detail:"The amortization period, in terms of number of periods."},{name:"number_of_periods",detail:"The number of payments to be made."},{name:"present_value",detail:"The current value of the annuity."},{name:"future_value",detail:"The future value remaining after the final payment has been made."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."}]},PPMT:{d:"Calculates the payment on the principal of an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on the principal of an investment.",p:[{name:"rate",detail:"The interest rate."},{name:"period",detail:"The amortization period, in terms of number of periods."},{name:"number_of_periods",detail:"The number of payments to be made."},{name:"present_value",detail:"The current value of the annuity."},{name:"future_value",detail:"The future value remaining after the final payment has been made."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."}]},INTRATE:{d:"Calculates the effective interest rate generated when an investment is purchased at one price and sold at another with no interest or dividends generated by the investment itself.",a:"Calculates effective interest rate.",p:[{name:"buy_date",detail:"The date of purchase of the investment."},{name:"sell_date",detail:"The date of sale of the investment."},{name:"buy_price",detail:"The price at which the investment was purchased."},{name:"sell_price",detail:"The price at which the investment was sold."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},PRICE:{d:"Calculates the price of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Price of a security paying periodic interest.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"rate",detail:"The annualized rate of interest."},{name:"yield",detail:"The expected annual yield of the security."},{name:"redemption",detail:"The redemption amount per 100 face value, or par."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},PRICEDISC:{d:"Calculates the price of a discount (non-interest-bearing) security, based on expected yield.",a:"Price of a discount security.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"discount",detail:"The discount rate of the security at time of purchase."},{name:"redemption",detail:"The redemption amount per 100 face value, or par."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},PRICEMAT:{d:"Calculates the price of a security paying interest at maturity, based on expected yield.",a:"Price of security paying interest at maturity.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"issue",detail:"The date the security was initially issued."},{name:"rate",detail:"The annualized rate of interest."},{name:"yield",detail:"The expected annual yield of the security."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},RECEIVED:{d:"Calculates the amount received at maturity for an investment in fixed-income securities purchased on a given date.",a:"Amount received at maturity for a security.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"investment",detail:"The amount invested (irrespective of face value of each security)."},{name:"discount",detail:"The discount rate of the security invested in."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},DISC:{d:"Calculates the discount rate of a security based on price.",a:"The discount rate of a security based on price.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"price",detail:"The price at which the security is bought per 100 face value."},{name:"redemption",detail:"The redemption amount per 100 face value, or par."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},NPER:{d:"Calculates the number of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Number of payment periods for an investment.",p:[{name:"rate",detail:"The interest rate."},{name:"payment_amount",detail:"The amount of each payment made."},{name:"present_value",detail:"The current value of the annuity."},{name:"future_value",detail:"The future value remaining after the final payment has been made."},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period."}]},SLN:{d:"Calculates the depreciation of an asset for one period using the straight-line method.",a:"Depreciation of asset using the straight-line method.",p:[{name:"cost",detail:"The initial cost of the asset."},{name:"salvage",detail:"The value of the asset at the end of depreciation."},{name:"life",detail:"The number of periods over which the asset is depreciated."}]},DURATION:{d:"Calculates the number of compounding periods required for an investment of a specified present value appreciating at a given rate to reach a target value.",a:"Number of periods for an investment to reach a value.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"rate",detail:"The annualized rate of interest."},{name:"yield",detail:"The expected annual yield of the security."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},MDURATION:{d:"Calculates the modified Macaulay duration of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Modified Macaulay duration.",p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer."},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value."},{name:"rate",detail:"The annualized rate of interest."},{name:"yield",detail:"The expected annual yield of the security."},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4)."},{name:"day_count_convention",detail:"An indicator of what day count method to use."}]},BIN2DEC:{d:"Converts a signed binary number to decimal format.",a:"Converts a signed binary number to decimal format.",p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to decimal, provided as a string."}]},BIN2HEX:{d:"Converts a signed binary number to signed hexadecimal format.",a:"Converts a binary number to hexadecimal.",p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed hexademical, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},BIN2OCT:{d:"Converts a signed binary number to signed octal format.",a:"Converts a binary number to octal.",p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed octal, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},DEC2BIN:{d:"Converts a decimal number to signed binary format.",a:"Converts a decimal number to signed binary format.",p:[{name:"decimal_number",detail:"The decimal value to be converted to signed binary, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},DEC2HEX:{d:"Converts a decimal number to signed hexadecimal format.",a:"Converts a decimal number to hexadecimal.",p:[{name:"decimal_number",detail:"The decimal value to be converted to signed hexadecimal, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},DEC2OCT:{d:"Converts a decimal number to signed octal format.",a:"Converts a decimal number to signed octal format.",p:[{name:"decimal_number",detail:"The decimal value to be converted to signed octal, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},HEX2BIN:{d:"Converts a signed hexadecimal number to signed binary format.",a:"Converts a hexadecimal number to binary.",p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed binary, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},HEX2DEC:{d:"Converts a signed hexadecimal number to decimal format.",a:"Converts a hexadecimal number to decimal.",p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to decimal, provided as a string."}]},HEX2OCT:{d:"Converts a signed hexadecimal number to signed octal format.",a:"Converts a hexadecimal number to octal.",p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed octal, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},OCT2BIN:{d:"Converts a signed octal number to signed binary format.",a:"Converts an octal number to binary.",p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed binary, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},OCT2DEC:{d:"Converts a signed octal number to decimal format.",a:"Converts a signed octal number to decimal format.",p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to decimal, provided as a string."}]},OCT2HEX:{d:"Converts a signed octal number to signed hexadecimal format.",a:"Converts an octal number to hexadecimal.",p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed hexadecimal, provided as a string."},{name:"significant_digits",detail:"The number of significant digits to ensure in the result."}]},COMPLEX:{d:"Creates a complex number given real and imaginary coefficients.",a:"Creates a complex number.",p:[{name:"real_part",detail:"The real coefficient."},{name:"imaginary_part",detail:"The imaginary coefficient."},{name:"suffix",detail:"The suffix for the imaginary coefficient, can only be 'i' or 'j'. If omitted, 'i' will be used."}]},IMREAL:{d:"Returns the real coefficient of a complex number.",a:"The real coefficient of a complex number.",p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format."}]},IMAGINARY:{d:"Returns the imaginary coefficient of a complex number.",a:"The imaginary coefficient of a complex number.",p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format."}]},IMCONJUGATE:{d:"Returns the complex conjugate of a number.",a:"The complex conjugate of a number.",p:[{name:"number",detail:"The complex number to calculate the conjugate for."}]},IMABS:{d:"Returns absolute value (or modulus) of a complex number.",a:"The absolute value of a complex number.",p:[{name:"number",detail:"The complex number to calculate the absolute value of."}]},DELTA:{d:"Compare two numeric values, returning 1 if they're equal.",a:"Compare two numeric values.",p:[{name:"number1",detail:"The first number to compare."},{name:"number2",detail:"The second number to compare."}]},IMSUM:{d:"Returns the sum of a series of complex numbers.",a:"Sum of a series of complex numbers.",p:[{name:"value1",detail:"The first complex number or range to add together."},{name:"value2",detail:"Additional complex numbers or ranges to add to `value1`."}]},IMSUB:{d:"Returns the difference between two complex numbers.",a:"The difference between two complex numbers.",p:[{name:"first_number",detail:"The complex number to subtract second_number from."},{name:"second_number",detail:"The complex number to subtract from first_number."}]},IMPRODUCT:{d:"Returns the result of multiplying a series of complex numbers together.",a:"Result of multiplying a series of complex numbers together.",p:[{name:"factor1",detail:"The first number or range to calculate for the product."},{name:"factor2",detail:"Additional complex numbers or ranges to calculate for the product."}]},IMDIV:{d:"Returns one complex number divided by another.",a:"One complex number divided by another.",p:[{name:"dividend",detail:"The complex number to be divided."},{name:"divisor",detail:"The complex number to divide by."}]},NOT:{d:"Returns the opposite of a logical value - `NOT(TRUE)` returns `FALSE`; `NOT(FALSE)` returns `TRUE`.",a:"Returns opposite of provided logical value.",p:[{name:"logical_expression",detail:"An expression or reference to a cell holding an expression that represents some logical value."}]},TRUE:{d:"Returns the logical value `TRUE`.",a:"Logical value `true`.",p:[]},FALSE:{d:"Returns the logical value `FALSE`.",a:"Logical value `false`.",p:[]},AND:{d:"Returns true if all of the provided arguments are logically true, and false if any of the provided arguments are logically false.",a:"Logical `and` operator.",p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value."},{name:"logical_expression2",detail:"More expressions that represent logical values."}]},IFERROR:{d:"Returns the first argument if it is not an error value, otherwise returns the second argument if present, or a blank if the second argument is absent.",a:"Value if it is not an error, otherwise 2nd argument.",p:[{name:"value",detail:"The value to return if `value` itself is not an error."},{name:"value_if_error",detail:"The value the function returns if `value` is an error."}]},IF:{d:"Returns one value if a logical expression is `TRUE` and another if it is `FALSE`.",a:"Returns value depending on logical expression.",p:[{name:"logical_expression",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`."},{name:"value_if_true",detail:"The value the function returns if `logical_expression` is `TRUE`."},{name:"value_if_false",detail:"The value the function returns if `logical_expression` is `FALSE`."}]},OR:{d:"Returns true if any of the provided arguments are logically true, and false if all of the provided arguments are logically false.",a:"Logical `or` operator.",p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value."},{name:"logical_expression2",detail:"More expressions that evaluate to logical values."}]},NE:{d:"Returns `TRUE` if two specified values are not equal and `FALSE` otherwise. Equivalent to the `!=` operator.",a:"Not equal.",p:[{name:"value1",detail:"The first value."},{name:"value2",detail:"The value to test against `value1` for inequality."}]},EQ:{d:"Returns `TRUE` if two specified values are equal and `FALSE` otherwise. Equivalent to the `==` operator.",a:"Equal.",p:[{name:"value1",detail:"The first value."},{name:"value2",detail:"The value to test against `value1` for equality."}]},GT:{d:"Returns `TRUE` if the first argument is strictly greater than the second, and `FALSE` otherwise. Equivalent to the `>` operator.",a:"Strictly greater than.",p:[{name:"value1",detail:"The value to test as being greater than `value2`."},{name:"value2",detail:"The second value."}]},GTE:{d:"Returns `TRUE` if the first argument is greater than or equal to the second, and `FALSE` otherwise. Equivalent to the `>=` operator.",a:"Greater than or equal to.",p:[{name:"value1",detail:"The value to test as being greater than or equal to `value2`."},{name:"value2",detail:"The second value."}]},LT:{d:"Returns `TRUE` if the first argument is strictly less than the second, and `FALSE` otherwise. Equivalent to the `<` operator.",a:"Less than.",p:[{name:"value1",detail:"The value to test as being less than `value2`."},{name:"value2",detail:"The second value."}]},LTE:{d:"Returns `TRUE` if the first argument is less than or equal to the second, and `FALSE` otherwise. Equivalent to the `<=` operator.",a:"Less than or equal to.",p:[{name:"value1",detail:"The value to test as being less than or equal to `value2`."},{name:"value2",detail:"The second value."}]},ADD:{d:"Returns the sum of two numbers. Equivalent to the `+` operator.",a:"Sum of two numbers",p:[{name:"value1",detail:"The first addend."},{name:"value2",detail:"The second addend."}]},MINUS:{d:"Returns the difference of two numbers. Equivalent to the `-` operator.",a:"Difference of two numbers",p:[{name:"value1",detail:"The minuend, or number to be subtracted from."},{name:"value2",detail:"The subtrahend, or number to subtract from `value1`."}]},MULTIPLY:{d:"Returns the product of two numbers. Equivalent to the `*` operator.",a:"Product of two numbers",p:[{name:"factor1",detail:"The first multiplicand."},{name:"factor2",detail:"The second multiplicand."}]},DIVIDE:{d:"Returns one number divided by another. Equivalent to the `/` operator.",a:"One number divided by another",p:[{name:"dividend",detail:"The number to be divided."},{name:"divisor",detail:"The number to divide by."}]},CONCAT:{d:"Returns the concatenation of two values. Equivalent to the `&` operator.",a:"Concatenation of two values",p:[{name:"value1",detail:"The value to which `value2` will be appended."},{name:"value2",detail:"The value to append to `value1`."}]},UNARY_PERCENT:{d:"Returns a value interpreted as a percentage; that is, `UNARY_PERCENT(100)` equals `1`.",a:"Value interpreted as a percentage.",p:[{name:"percentage",detail:"The value to interpret as a percentage."}]},CONCATENATE:{d:"Appends strings to one another.",a:"Appends strings to one another.",p:[{name:"string1",detail:"The initial string."},{name:"string2",detail:"More strings to append in sequence."}]},CODE:{d:"Returns the numeric Unicode map value of the first character in the string provided.",a:"Numeric unicode map value of character.",p:[{name:"string",detail:"The string whose first character's Unicode map value will be returned."}]},CHAR:{d:"Convert a number into a character according to the current Unicode table.",a:"Gets character associated with number.",p:[{name:"table_number",detail:"The number of the character to look up from the current Unicode table in decimal format."}]},ARABIC:{d:"Computes the value of a Roman numeral.",a:"Computes the value of a roman numeral.",p:[{name:"roman_numeral",detail:"The Roman numeral to format, whose value must be between 1 and 3999, inclusive."}]},ROMAN:{d:"Formats a number in Roman numerals.",a:"Formats a number in Roman numerals.",p:[{name:"number",detail:"The number to format, between 1 and 3999, inclusive."}]},REGEXEXTRACT:{d:"Extracts matching substrings according to a regular expression.",a:"Extracts matching substrings with regular expression.",p:[{name:"text",detail:"The input text."},{name:"regular_expression",detail:"The first part of `text` that matches this expression will be returned."}]},REGEXMATCH:{d:"Whether a piece of text matches a regular expression.",a:"Whether a piece of text matches regular expression.",p:[{name:"text",detail:"The text to be tested against the regular expression."},{name:"regular_expression",detail:"The regular expression to test the text against."}]},REGEXREPLACE:{d:"Replaces part of a text string with a different text string using regular expressions.",a:"Replaces text with regular expressions.",p:[{name:"text",detail:"The text, a part of which will be replaced."},{name:"regular_expression",detail:"The regular expression.  All matching instances in `text` will be replaced."},{name:"replacement",detail:"The text which will be inserted into the original text."}]},T:{d:"Returns string arguments as text, or the empty string if the value is not text.",a:"String arguments as text.",p:[{name:"value",detail:"The argument to be converted to text."}]},FIXED:{d:"Formats a number with a fixed number of decimal places.",a:"Formats number with fixed number of decimal places.",p:[{name:"number",detail:"The number to format."},{name:"number_of_places",detail:"The number of decimal places to display in the result."},{name:"suppress_separator",detail:"Whether or not to suppress the thousands separator used in some locales (e.g. `1,000` becomes `1000`). Separators will be present if this value is 0 or omitted, and absent otherwise."}]},FIND:{d:"Returns the position at which a string is first found within text where the capitalization of letters matters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, case-sensitive.",p:[{name:"search_for",detail:"The string to look for within `text_to_search`."},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`."},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search."}]},FINDB:{d:"Returns the position at which a string is first found within text counting each double-character as 2.",a:"Position at which a string is first found within text (binary).",p:[{name:"search_for",detail:"The string to look for within `text_to_search`."},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`."},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search."}]},JOIN:{d:"Concatenates the elements of one or more one-dimensional arrays using a specified delimiter.",a:"Concatenates elements of arrays with delimiter.",p:[{name:"delimiter",detail:"The character or string to place between each concatenated value."},{name:"value_or_array1",detail:"The value or values to be appended using `delimiter`."},{name:"value_or_array2",detail:"More values to be appended using `delimiter`."}]},LEFT:{d:"Returns a substring from the beginning of a specified string.",a:"Substring from beginning of specified string.",p:[{name:"string",detail:"The string from which the left portion will be returned."},{name:"number_of_characters",detail:"The number of characters to return from the left side of `string`."}]},RIGHT:{d:"Returns a substring from the end of a specified string.",a:"A substring from the end of a specified string.",p:[{name:"string",detail:"The string from which the right portion will be returned."},{name:"number_of_characters",detail:"The number of characters to return from the right side of `string`."}]},MID:{d:"Returns a segment of a string.",a:"A segment of a string.",p:[{name:"string",detail:"The string to extract a segment from."},{name:"starting_at",detail:"The index from the left of `string` from which to begin extracting. The first character in `string` has the index 1."},{name:"extract_length",detail:"The length of the segment to extract."}]},LEN:{d:"Returns the length of a string.",a:"Length of a string.",p:[{name:"text",detail:"The string whose length will be returned."}]},LENB:{d:"Returns the length of a string in bytes.",a:"Length of a string in bytes.",p:[{name:"text",detail:"The string whose length will be returned."}]},LOWER:{d:"Converts a specified string to lowercase.",a:"Converts a specified string to lowercase.",p:[{name:"text",detail:"The string to convert to lowercase."}]},UPPER:{d:"Converts a specified string to uppercase.",a:"Converts a specified string to uppercase.",p:[{name:"text",detail:"The string to convert to uppercase."}]},EXACT:{d:"Tests whether two strings are identical.",a:"Tests whether two strings are identical.",p:[{name:"string1",detail:"The first string to compare"},{name:"string2",detail:"The second string to compare"}]},REPLACE:{d:"Replaces part of a text string with a different text string.",a:"Replaces part of a text string with different text.",p:[{name:"text",detail:"The text, a part of which will be replaced."},{name:"position",detail:"The position where the replacement will begin (starting from 1)."},{name:"length",detail:"The number of characters in the text to be replaced."},{name:"new_text",detail:"The text which will be inserted into the original text."}]},REPT:{d:"Returns specified text repeated a number of times.",a:"Specified text repeated a number of times.",p:[{name:"text_to_repeat",detail:"The character or string to repeat."},{name:"number_of_repetitions",detail:"The number of times `text_to_repeat` should appear in the value returned."}]},SEARCH:{d:"Returns the position at which a string is first found within text and ignores capitalization of letters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, ignoring case.",p:[{name:"search_for",detail:"The string to look for within `text_to_search`."},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`."},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search."}]},SUBSTITUTE:{d:"Replaces existing text with new text in a string.",a:"Replaces existing text with new text in a string.",p:[{name:"text_to_search",detail:"The text within which to search and replace."},{name:"search_for",detail:"The string to search for within `text_to_search`."},{name:"replace_with",detail:"The string that will replace `search_for`."},{name:"occurrence_number",detail:"The instance of `search_for` within `text_to_search` to replace with `replace_with`. By default, all occurrences of `search_for` are replaced; however, if `occurrence_number` is specified, only the indicated instance of `search_for` is replaced."}]},CLEAN:{d:"Returns the text with the non-printable ASCII characters removed.",a:"Removes non-printable characters from a piece of text.",p:[{name:"text",detail:"The text whose non-printable characters are to be removed."}]},TEXT:{d:"Converts a number into text according to a specified format.",a:"Formats a number into text.",p:[{name:"number",detail:"The number, date, or time to format."},{name:"format",detail:"The pattern by which to format the number, enclosed in quotation marks."}]},TRIM:{d:"Removes leading, trailing, and repeated spaces in text.",a:"Removes space characters.",p:[{name:"text",detail:"The text or reference to a cell containing text to be trimmed."}]},VALUE:{d:"Converts a string in any of the date, time or number formats that Google Sheets understands into a number.",a:"Converts a date/time/number string into a number.",p:[{name:"text",detail:"The string containing the value to be converted."}]},PROPER:{d:"Capitalizes each word in a specified string.",a:"Capitalizes each word in a specified string.",p:[{name:"text_to_capitalize",detail:"The text which will be returned with the first letter of each word in uppercase and all other letters in lowercase."}]},CONVERT:{d:"Converts a numeric value to a different unit of measure.",a:"Unit conversion for numbers.",p:[{name:"value",detail:"The numeric value in `start_unit` to convert to `end_unit`."},{name:"start_unit",detail:"The starting unit, the unit currently assigned to `value`."},{name:"end_unit",detail:"The unit of measure into which to convert the argument, `value`."}]},SUMX2MY2:{d:"Calculates the sum of the differences of the squares of values in two arrays.",a:"Sum of the differences of squares.",p:[{name:"array_x",detail:"The array or range of values whose squares will be reduced by the squares of corresponding entries in `array_y` and added together."},{name:"array_y",detail:"The array or range of values whose squares will be subtracted from the squares of corresponding entries in `array_x` and added together."}]},SUMX2PY2:{d:"Calculates the sum of the sums of the squares of values in two arrays.",a:"Sum of the sums of squares.",p:[{name:"array_x",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_y` and added together."},{name:"array_y",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_x` and added together."}]},SUMXMY2:{d:"Calculates the sum of the squares of differences of values in two arrays.",a:"Sum of the squares of differences.",p:[{name:"array_x",detail:"The array or range of values that will be reduced by corresponding entries in `array_y`, squared, and added together."},{name:"array_y",detail:"The array or range of values that will be subtracted from corresponding entries in `array_x`, the result squared, and all such results added together."}]},TRANSPOSE:{d:"Transposes the rows and columns of an array or range of cells.",a:"Transposes the rows and columns of an array.",p:[{name:"array_or_range",detail:"The array or range whose rows and columns will be swapped."}]},TREND:{d:"Given partial data about a linear trend, fits an ideal linear trend using the least squares method and/or predicts further values.",a:"Fits points to linear trend derived via least-squares.",p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend."},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`."},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit."},{name:"b",detail:"Given a general linear form of `y = m*x+b` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin."}]},FREQUENCY:{d:"Calculates the frequency distribution of a one-column array into specified classes.",a:"The frequency distribution of array.",p:[{name:"data",detail:"The array or range containing the values to be counted."},{name:"classes",detail:"The array or range containing the set of classes."}]},GROWTH:{d:"Given partial data about an exponential growth trend, fits an ideal exponential growth trend and/or predicts further values.",a:"Fits points to exponential growth trend.",p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve."},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`."},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit."},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`."}]},LINEST:{d:"Given partial data about a linear trend, calculates various parameters about the ideal linear trend using the least-squares method.",a:"Best-fit linear trend via least-squares.",p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend."},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`."},{name:"calculate_b",detail:"Given a linear form of `y = m*x+b`, calculates the y-intercept (`b`) if `TRUE`. Otherwise, forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin."},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the linear coefficients and the y-intercept (default)."}]},LOGEST:{d:"Given partial data about an exponential growth curve, calculates various parameters about the best fit ideal exponential growth curve.",a:"Best-fit exponential growth curve.",p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve."},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`."},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`."},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the calculated coefficient and exponents."}]},MDETERM:{d:"Returns the matrix determinant of a square matrix specified as an array or range.",a:"Matrix determinant of a square matrix.",p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose determinant will be calculated."}]},MINVERSE:{d:"Returns the multiplicative inverse of a square matrix specified as an array or range.",a:"Multiplicative inverse of square matrix.",p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose multiplicative inverse will be calculated."}]},MMULT:{d:"Calculates the matrix product of two matrices specified as arrays or ranges.",a:"The matrix product of two matrices.",p:[{name:"matrix1",detail:"The first matrix in the matrix multiplication operation, represented as an array or range."},{name:"matrix2",detail:"The second matrix in the matrix multiplication operation, represented as an array or range."}]},SUMPRODUCT:{d:"Calculates the sum of the products of corresponding entries in two equal-sized arrays or ranges.",a:"Sum of products of elements in two arrays.",p:[{name:"array1",detail:"The first array or range whose entries will be multiplied with corresponding entries in the second such array or range."},{name:"array2",detail:"The second array or range whose entries will be multiplied with corresponding entries in the first such array or range."}]},ISFORMULA:{d:"Checks whether a value is a formula.",a:"Whether a value is a formula.",p:[{name:"cell",detail:"The cell to be verified as containing a formula."}]},CELL:{d:"Returns the requested information about the specified cell.",a:"Gets information about a cell.",p:[{name:"info_type",detail:"The type of information requested (see article for available types)"},{name:"reference",detail:"The reference to the cell."}]},NA:{d:"Returns the 'value not available' error, `#N/A`.",a:"The `#N/A` error.",p:[]},ERROR_TYPE:{d:"Returns a number corresponding to the error value in a different cell.",a:"Error value of cell (as number).",p:[{name:"reference",detail:"The cell to find the error number for although you can also provide the error value directly."}]},ISBLANK:{d:"Checks whether the referenced cell is empty.",a:"Whether the referenced cell is empty.",p:[{name:"value",detail:"Reference to the cell that will be checked for emptiness."}]},ISERR:{d:"Checks whether a value is an error other than `#N/A`.",a:"Whether a value is an error other than `#n/a`.",p:[{name:"value",detail:"The value to be verified as an error type other than `#N/A`."}]},ISERROR:{d:"Checks whether a value is an error.",a:"Whether a value is an error.",p:[{name:"value",detail:"The value to be verified as an error type."}]},ISLOGICAL:{d:"Checks whether a value is `TRUE` or `FALSE`.",a:"Whether a value is `true` or `false`.",p:[{name:"value",detail:"The value to be verified as a logical `TRUE` or `FALSE`."}]},ISNA:{d:"Checks whether a value is the error `#N/A`.",a:"Whether a value is the error `#n/a`.",p:[{name:"value",detail:"The value to be compared with the error value `#N/A`."}]},ISNONTEXT:{d:"Checks whether a value is non-textual.",a:"Whether a value is non-textual.",p:[{name:"value",detail:"The value to be checked."}]},ISNUMBER:{d:"Checks whether a value is a number.",a:"Whether a value is a number.",p:[{name:"value",detail:"The value to be verified as a number."}]},ISREF:{d:"Checks whether a value is a valid cell reference.",a:"Whether a value is a valid cell reference.",p:[{name:"value",detail:"The value to be verified as a cell reference."}]},ISTEXT:{d:"Checks whether a value is text.",a:"Whether a value is text.",p:[{name:"value",detail:"The value to be verified as text."}]},TYPE:{d:"Returns a number associated with the type of data passed into the function.",a:"Get the type of a value.",p:[{name:"value",detail:"The value whose type is to be determined."}]},N:{d:"Returns the argument provided as a number. Text is converted to 0 and errors are returned as-is.",a:"Argument provided as a number.",p:[{name:"value",detail:"The argument to be converted to a number."}]},TO_DATE:{d:"Converts a provided number to a date.",a:"Converts a provided number to a date.",p:[{name:"value",detail:"The argument or reference to a cell to be converted to a date."}]},TO_PURE_NUMBER:{d:"Converts a provided date/time, percentage, currency or other formatted numeric value to a pure number without formatting.",a:"Converts any numeric value to a pure number.",p:[{name:"value",detail:"The argument or reference to a cell to be converted to a pure number."}]},TO_TEXT:{d:"Converts a provided numeric value to a text value.",a:"Converts a provided numeric value to a text value.",p:[{name:"value",detail:"The argument or reference to a cell to be converted to text."}]},TO_DOLLARS:{d:"Converts a provided number to a dollar value.",a:"Converts a provided number to a dollar value.",p:[{name:"value",detail:"The argument or reference to a cell to be converted to a dollar value."}]},TO_PERCENT:{d:"Converts a provided number to a percentage.",a:"Converts a provided number to a percentage.",p:[{name:"value",detail:"The argument or reference to a cell to be converted to a percentage."}]},DGET:{d:"Returns a single value from a database table-like array or range using a SQL-like query.",a:"Single value from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DMAX:{d:"Returns the maximum value selected from a database table-like array or range using a SQL-like query.",a:"Maximum of values from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DMIN:{d:"Returns the minimum value selected from a database table-like array or range using a SQL-like query.",a:"Minimum of values from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DAVERAGE:{d:"Returns the average of a set of values selected from a database table-like array or range using a SQL-like query.",a:"Average of a set of values from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DCOUNT:{d:"Counts numeric values selected from a database table-like array or range using a SQL-like query.",a:"Counts values from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DCOUNTA:{d:"Counts values, including text, selected from a database table-like array or range using a SQL-like query.",a:"Counts values and text from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DPRODUCT:{d:"Returns the product of values selected from a database table-like array or range using a SQL-like query.",a:"Product of values from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DSTDEV:{d:"Returns the standard deviation of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of population sample from table.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DSTDEVP:{d:"Returns the standard deviation of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of entire population from table.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DSUM:{d:"Returns the sum of values selected from a database table-like array or range using a SQL-like query.",a:"Sum of values from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DVAR:{d:"Returns the variance of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Variance of population sample from table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},DVARP:{d:"Returns the variance of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Variance of a population from a table-like range.",p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values."},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on."},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating."}]},AGE_BY_IDCARD:{d:"Calculate the age based on the Chinese ID number. Support 15 or 18",a:"Get age based on ID number.",p:[{name:"ID number",detail:"15-digit or 18-digit ID number or range."},{name:"Deadline",detail:"The deadline or range of age calculation. The default is the current day."}]},SEX_BY_IDCARD:{d:"Calculate gender based on Chinese ID number. Support 15 or 18",a:"Get gender based on ID number.",p:[{name:"ID number",detail:"15-digit or 18-digit ID number or range."}]},BIRTHDAY_BY_IDCARD:{d:"Calculate the birthday based on the Chinese ID number. Support 15 or 18",a:"Get the birthday based on the ID number.",p:[{name:"ID number",detail:"15-digit or 18-digit ID number or range."},{name:"Birthday format",detail:"Date type, default:0:[1900/01/01], 1:[1900-01-01], 2:[1900\u5E741\u67081\u65E5]"}]},PROVINCE_BY_IDCARD:{d:"Calculate the province of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the province of birthplace based on the ID number.",p:[{name:"ID number",detail:"15-digit or 18-digit ID number or range."}]},CITY_BY_IDCARD:{d:"Calculate the city of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the city of birthplace based on the ID number.",p:[{name:"ID number",detail:"15-digit or 18-digit ID number or range."}]},STAR_BY_IDCARD:{d:"Calculate the constellation based on the Chinese ID number. Support 15 or 18",a:"Get the constellation based on the ID number.",p:[{name:"ID number",detail:"15-digit or 18-digit ID number or range."}]},ANIMAL_BY_IDCARD:{d:"Calculate the zodiac (rat, ox, tiger, rabbit...) based on the Chinese ID number. Support 15 or 18",a:"Get the zodiac according to the ID number.",p:[{name:"ID number",detail:"15-digit or 18-digit ID number or range."}]},ISIDCARD:{d:"Verify that the format of the ID card is correct. Support 15 or 18",a:"Verify the correctness of the ID card format.",p:[{name:"ID number",detail:"15-digit or 18-digit ID number or range."}]},DM_TEXT_CUTWORD:{d:"Text segmentation. Split a series of words into a series of individual words",a:"Chinese text segmentation.",p:[{name:"Text",detail:"Any text that needs word segmentation."},{name:"Word segmentation mode",detail:"The default is 0[precision mode], 1[full mode], 2[search engine mode]."}]},DM_TEXT_TFIDF:{d:"Use tf-idf algorithm for keyword extraction. Identify keywords from a series of text",a:"tf-idf keyword recognition.",p:[{name:"Text",detail:"Any text that needs word segmentation."},{name:"Number of keywords",detail:"The number of keywords returned by the algorithm, the default is 20"},{name:"Corpus",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]"}]},DM_TEXT_TEXTRANK:{d:"Use TextRank algorithm to extract keywords. Identify keywords from a series of text",a:"TextRank keyword recognition.",p:[{name:"Text",detail:"Any text that needs word segmentation."},{name:"Number of keywords",detail:"The number of keywords returned by the algorithm, the default is 20"},{name:"Corpus",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]"}]},DATA_CN_STOCK_CLOSE:{d:"According to the stock code and date, return the corresponding stock closing price of A shares.",a:"Returns the closing price of stock.",p:[{name:"Stock code",detail:"6-digit stock code, required."},{name:"Date",detail:"The trading day of the stock, the default is the latest trading day"},{name:"Reversion and exclusion",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]"}]},DATA_CN_STOCK_OPEN:{d:"According to the stock code and date, return the opening price of stock.",a:"Return the opening price of a shares.",p:[{name:"Stock code",detail:"6-digit stock code, required."},{name:"Date",detail:"The trading day of the stock, the default is the latest trading day"},{name:"Reversion and exclusion",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]"}]},DATA_CN_STOCK_MAX:{d:"According to the stock code and date, return the highest price of stock.",a:"Return the highest price of stock.",p:[{name:"Stock code",detail:"6-digit stock code, required."},{name:"Date",detail:"The trading day of the stock, the default is the latest trading day"},{name:"Reversion and exclusion",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]"}]},DATA_CN_STOCK_MIN:{d:"According to the stock code and date, return the lowest price of stock.",a:"Returns the lowest price of stock.",p:[{name:"Stock code",detail:"6-digit stock code, required."},{name:"Date",detail:"The trading day of the stock, the default is the latest trading day"},{name:"Reversion and exclusion",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]"}]},DATA_CN_STOCK_VOLUMN:{d:"According to the stock code and date, return the corresponding stock trading volume of A shares.",a:"Returns the corresponding stock trading volume of A shares.",p:[{name:"Stock code",detail:"6-digit stock code, required."},{name:"Date",detail:"The trading day of the stock, the default is the latest trading day"},{name:"Reversion and exclusion",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]"}]},DATA_CN_STOCK_AMOUNT:{d:"According to the stock code and date, return the corresponding stock turnover of A shares.",a:"Returns the corresponding stock turnover of A shares.",p:[{name:"Stock code",detail:"6-digit stock code, required."},{name:"Date",detail:"The trading day of the stock, the default is the latest trading day"},{name:"Reversion and exclusion",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]"}]},ISDATE:{d:"Returns whether a value is a date.",a:"Whether a value is a date.",p:[{name:"value",detail:"The value to be verified as a date."}]},LINESPLINES:{d:"Generate sparklines embedded in the cell to describe the continuous trend of data",a:"Generate sparklines line chart",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Line color",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9"},{name:"Line thickness",detail:"Line thickness of the line graph, the default is 1px"},{name:"Auxiliary line",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none"},{name:"Auxiliary line color",detail:"Color setting of auxiliary line, same as line color configuration, default #000"},{name:"Maximum mark",detail:"Identifies the maximum value of the line graph, the same line color configuration, default 0 does not display"},{name:"Minimum mark",detail:"Identify the minimum value of the line graph, the same line color configuration, default 0 does not display"},{name:"Mark size",detail:"The maximum and minimum mark size settings, the default is 1.5"}]},AREASPLINES:{d:"Generate sparklines embedded in the cell area chart, generally used to describe the continuous cumulative value trend of the data",a:"Generate sparklines area chart",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Line color",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9"},{name:"Fill color",detail:"Form an area chart, the same line color configuration, default 0 does not display"},{name:"Line thickness",detail:"Line thickness of the line graph, the default is 1px"},{name:"Auxiliary line",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none"},{name:"Auxiliary line color",detail:"Color setting of auxiliary line, same as line color configuration, default #000"}]},COLUMNSPLINES:{d:"Generate sparklines embedded in the vertical histogram of cells, generally used to describe the size of discrete data",a:"Generate sparklines vertical histogram",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Bar interval",detail:"The distance between bars, the default is 1"},{name:"Bar color",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c"},{name:"Negative bar color",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552"},{name:"Max",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null"},{name:"Color palette",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty"}]},STACKCOLUMNSPLINES:{d:"Generate sparklines, a cumulative vertical histogram embedded in a cell, generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative vertical histogram",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Stack by column",detail:"If you need to stack by row, set this item to false or 0, the default is 1"},{name:"Bar interval",detail:"The distance between bars, the default is 1"},{name:"Max",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null"},{name:"Color palette",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980..."}]},BARSPLINES:{d:"Generate sparklines embedded in the cell, generally used to describe the size of discrete data",a:"Generate sparklines horizontal bar graph",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Bar interval",detail:"The distance between bars, the default is 1"},{name:"Bar color",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c"},{name:"Negative bar color",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552"},{name:"Max",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null"},{name:"Color palette",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty"}]},STACKBARSPLINES:{d:"Generate sparklines, a cumulative horizontal bar graph embedded in a cell, which is generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative horizontal bar graph",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Stack by column",detail:"If you need to stack by row, set this item to false or 0, the default is 1"},{name:"Bar interval",detail:"The distance between bars, the default is 1"},{name:"Max",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null"},{name:"Color palette",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980..."}]},DISCRETESPLINES:{d:"Generate sparklines embedded in the cell, generally used to describe the trend of discrete data",a:"Generate sparklines discrete graph",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Segmentation threshold",detail:"Discrete graph column color distinction, for example: if the value is 0, blue is greater than 0, red is less than 0, and the default is 0"},{name:"Above threshold color",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9"},{name:"Below threshold color",detail:"The color setting of the bar below the threshold, the same as the color above the threshold, default #fc5c5c"}]},TRISTATESPLINES:{d:"Generate sparklines, a three-state graph embedded in the cell, which is generally used to describe the trend of three situations, such as winning, losing, or drawing.",a:"Generate sparklines three-state graph",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Bar interval",detail:"The distance between bars, the default is 1"},{name:"Bar color",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c"},{name:"Negative bar color",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552"},{name:"Zero value bar color",detail:"Zero value bar color setting, representing 0 value color, the same color configuration of the bar, default #999"},{name:"Color palette",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty"}]},PIESPLINES:{d:"Generate sparklines pie chart embedded in the cell, generally used to describe the proportion of data",a:"Generate sparklines pie chart",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Rotation angle",detail:"The rotation angle of the pie chart, the default is 0"},{name:"border",detail:"Pie chart border size, default is none 0"},{name:"Border color",detail:"The border color of the pie chart, the default is #000"},{name:"Color palette",detail:"The color of the slice can be set in the palette, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980..."}]},BOXSPLINES:{d:"Generate sparklines embedded in the cell box plot, generally used to describe the statistical distribution of the data set",a:"Generate sparklines box plot",p:[{name:"Range",detail:"Range\uFF0CValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc."},{name:"Outlier ratio",detail:"The threshold range of outliers, if it is 0 or false, it will not be displayed, the default is 1.5 times"},{name:"Target value",detail:"The target value setting on the box plot, the default is false and does not display"},{name:"Point size",detail:"The radius of the target point and outlier is set, the default is 1.5"}]},BULLETSPLINES:{d:"Generate sparklines embedded in the cell, generally used to describe the task achievement rate",a:"Generating sparklines bullets",p:[{name:"Target",detail:"The numerical value can be calculated effectively for the achieved target value, such as A1, 100, etc."},{name:"achieved",detail:"Only when the value is completed can the value be calculated effectively, such as A1, 100, etc."},{name:"Contrast",detail:"Comparative values, such as excess, minimum, and bottom line for awards, can be effectively calculated, such as A1, 100, etc. You can set up to 9 comparison values"}]},COMPOSESPLINES:{d:"Support multiple types of pictures in the same cell, each parameter represents a sparklines diagram",a:"Combine sparklines graphs into one cell",p:[{name:"config",detail:"Sparklines chart settings, such as A1:A20, a completed pie chart, line chart settings, etc."}]},SORT:{d:"Sorts the rows of a given array or range by the values in one or more columns.",a:"Sorts rows of range by specified column.",p:[{name:"range",detail:"The data to be sorted."},{name:"sort_column",detail:"The index of the column in `range` or a range outside of `range` containing the values by which to sort."},{name:"is_ascending",detail:"`TRUE` or `FALSE` indicating whether to sort `sort_column` in ascending order. `FALSE` sorts in descending order."},{name:"sort_column2",detail:"Additional columns."}]},FILTER:{d:"Returns a filtered version of the source range, returning only rows or columns which meet the specified conditions.",a:"Filters a range based off provided conditions.",p:[{name:"range",detail:"The data to be filtered."},{name:"condition1",detail:"A column or row containing true or false values corresponding to the first column or row of `range`, or an array formula evaluating to true or false."},{name:"condition2",detail:"Additional rows or columns containing boolean values `TRUE` or `FALSE` indicating whether the corresponding row or column in `range` should pass through `FILTER`. Can also contain array formula expressions which evaluate to such rows or columns. All conditions must be of the same type (row or column). Mixing row conditions and column conditions is not permitted."}]},UNIQUE:{d:"Returns unique rows in the provided source range, discarding duplicates. Rows are returned in the order in which they first appear in the source range.",a:"Unique rows in the provided source range.",p:[{name:"range",detail:"The data to filter by unique entries."},{name:"by_col",detail:"[Option] - Logical value, indicating how to compare; by row = FALSE() or omitted; by column = TRUE()."},{name:"occurs_once",detail:"[Option] - Logical value, only one occurrence in the unique value is returned = TRUE(); including all unique values = FALSE() or omitted."}]},RANDARRAY:{d:"Returns a grid of random numbers between 0 inclusive and 1 exclusive. The grid size will match the provided rows and columns arguments. If neither rows nor columns are provided, then the grid will be size 1 x 1.",a:"Returns a grid of random numbers.",p:[{name:"rows",detail:"The number of rows to populate with a random number."},{name:"columns",detail:"The number of columns to populate with a random number."}]},SEQUENCE:{d:"Returns a grid of sequential numbers starting at a specified start value and  increasing by a specified step size. By default, the sequence starts at and  increases by 1.",a:"Returns a grid of sequential numbers.",p:[{name:"rows",detail:"The number of rows in the function's resulting grid."},{name:"columns",detail:"The number of columns in the function's resulting grid. If omitted, the result grid will have 1 column."},{name:"start",detail:"The number, at which to start the sequence. If omitted, the sequence will start at 1."},{name:"step",detail:"The amount each value in the sequence will differ by. If omitted, each value will differ by 1."}]},EVALUATE:{d:"Evaluate a formula or expression expressed in words and return the result",a:"Evaluate according to literal formula or expression.",p:[{name:"expression",detail:"Formula or expression"}]},REMOTE:{d:"Calls a function on a remote server",a:"Calls a function on a remote back end server/API.",p:[{name:"remote_expression",detail:"Formula"}]}},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:"Text color",chooseColor:"choose color",resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:"Fill color",border:"Border",borderStyle:"Border style",mergeCell:"Merge cells",chooseMergeType:"Choose merge type",horizontalAlign:"Horizontal align",verticalAlign:"Vertical align",alignment:"Alignment",textWrap:"Text wrap",textWrapMode:"Text wrap mode",textRotate:"Text rotate",textRotateMode:"Text rotate mode",freezeTopRow:"Freeze first row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",postil:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataVerification:"Data verification",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print"},alternatingColors:{applyRange:"Apply to range",selectRange:"Select a data range",header:"Header",footer:"Footer",errorInfo:"Cannot perform this operation on multiple selection areas, please select a single area and try again",textTitle:"Format style",custom:"CUSTOM",close:"close",selectionTextColor:"Click to select text color",selectionCellColor:"Click to select cell color",removeColor:"Remove alternating colors",colorShow:"color",currentColor:"Current",tipSelectRange:"Please select the range of alternating colors",errorNoRange:"No range is selected",errorExistColors:"Alternating colors already exist and cannot be edited"},button:{confirm:"OK",cancel:"\u30AD\u30E3\u30F3\u30BB\u30EB",close:"\u9589\u3058\u308B",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},paint:{start:"Paint format start",end:"ESC",tipSelectRange:"Please select the range to be copied",tipNotMulti:"Cannot perform this operation on multiple selection ranges"},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"\u30ED\u30FC\u30C9\u4E2D\u2026",copy:"Copy",return:"Exit",rename:"Rename",tips:"WorkBook rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"},currencyDetail:{RMB:"RMB",USdollar:"US dollar",EUR:"EUR",GBP:"GBP",HK:"HK",JPY:"JPY",AlbanianLek:"Albanian Lek",AlgerianDinar:"Algerian Dinar",Afghani:"Afghani",ArgentinePeso:"Argentine Peso",UnitedArabEmiratesDirham:"United Arab Emirates Dirham",ArubanFlorin:"Aruban Florin",OmaniRial:"Omani Rial",Azerbaijanimanat:"Azerbaijani manat",EgyptianPound:"Egyptian Pound",EthiopianBirr:"Ethiopian Birr",AngolaKwanza:"Angola Kwanza",AustralianDollar:"Australian Dollar",Patacas:"Patacas",BarbadosDollar:"Barbados Dollar",PapuaNewGuineaKina:"Papua New Guinea Kina",BahamianDollar:"Bahamian Dollar",PakistanRupee:"Pakistan Rupee",ParaguayanGuarani:"Paraguayan Guarani",BahrainiDinar:"Bahraini Dinar",PanamanianBalboa:"Panamanian Balboa",Brazilianreal:"Brazilian real",Belarusianruble:"Belarusian ruble",BermudianDollar:"Bermudian Dollar",BulgarianLev:"Bulgarian Lev",IcelandKrona:"Iceland Krona",BosniaHerzegovinaConvertibleMark:"Bosnia-Herzegovina Convertible Mark",PolishZloty:"Polish Zloty",Boliviano:"Boliviano",BelizeDollar:"Belize Dollar",BotswanaPula:"Botswana Pula",NotDannuzhamu:"Not Dannuzhamu",BurundiFranc:"Burundi Franc",NorthKoreanWon:"North Korean Won",DanishKrone:"Danish Krone",EastCaribbeanDollar:"East Caribbean Dollar",DominicaPeso:"Dominica Peso",RussianRuble:"Russian Ruble",EritreanNakfa:"Eritrean Nakfa",CFAfranc:"CFA franc",PhilippinePeso:"Philippine Peso",FijiDollar:"Fiji Dollar",CapeVerdeEscudo:"Cape Verde Escudo",FalklandIslandsPound:"Falkland Islands Pound",GambianDalasi:"Gambian Dalasi",Congolesefranc:"Congolese franc",ColombianPeso:"Colombian Peso",CostaRicanColon:"Costa Rican Colon",CubanPeso:"Cuban Peso",Cubanconvertiblepeso:"Cuban convertible peso",GuyanaDollar:"Guyana Dollar",KazakhstanTenge:"Kazakhstan Tenge",Haitiangourde:"Haitian gourde",won:"won",NetherlandsAntillesGuilder:"Netherlands Antilles Guilder",Honduraslempiras:"Honduras lempiras",DjiboutiFranc:"Djibouti Franc",KyrgyzstanSom:"Kyrgyzstan Som",GuineaFranc:"Guinea Franc",CanadianDollar:"Canadian Dollar",GhanaianCedi:"Ghanaian Cedi",Cambodianriel:"Cambodian riel",CzechKoruna:"Czech Koruna",ZimbabweDollar:"Zimbabwe Dollar",QatariRiyal:"Qatari Riyal",CaymanIslandsDollar:"Cayman Islands Dollar",Comorianfranc:"Comorian franc",KuwaitiDinar:"Kuwaiti Dinar",CroatianKuna:"Croatian Kuna",KenyanShilling:"Kenyan Shilling",LesothoLoti:"Lesotho Loti",LaoKip:"Lao Kip",LebanesePound:"Lebanese Pound",Lithuanianlitas:"Lithuanian litas",LibyanDinar:"Libyan Dinar",LiberianDollar:"Liberian Dollar",RwandaFranc:"Rwanda Franc",RomanianLeu:"Romanian Leu",MalagasyAriary:"Malagasy Ariary",MaldivianRufiyaa:"Maldivian Rufiyaa",MalawiKwacha:"Malawi Kwacha",MalaysianRinggit:"Malaysian Ringgit",MacedoniawearingDinar:"Macedonia wearing Dinar",MauritiusRupee:"Mauritius Rupee",MauritanianOuguiya:"Mauritanian Ouguiya",MongolianTugrik:"Mongolian Tugrik",BangladeshiTaka:"Bangladeshi Taka",PeruvianNuevoSol:"Peruvian Nuevo Sol",MyanmarKyat:"Myanmar Kyat",MoldovanLeu:"Moldovan Leu",MoroccanDirham:"Moroccan Dirham",MozambiqueMetical:"Mozambique Metical",MexicanPeso:"Mexican Peso",NamibianDollar:"Namibian Dollar",SouthAfricanRand:"South African Rand",SouthSudanesePound:"South Sudanese Pound",NicaraguaCordoba:"Nicaragua Cordoba",NepaleseRupee:"Nepalese Rupee",NigerianNaira:"Nigerian Naira",NorwegianKrone:"Norwegian Krone",GeorgianLari:"Georgian Lari",RMBOffshore:"RMB (Offshore)",SwedishKrona:"Swedish Krona",SwissFranc:"Swiss Franc",SerbianDinar:"Serbian Dinar",SierraLeone:"Sierra Leone",SeychellesRupee:"Seychelles Rupee",SaudiRiyal:"Saudi Riyal",SaoTomeDobra:"Sao Tome Dobra",SaintHelenapound:"Saint Helena pound",SriLankaRupee:"Sri Lanka Rupee",SwazilandLilangeni:"Swaziland Lilangeni",SudanesePound:"Sudanese Pound",Surinamesedollar:"Surinamese dollar",SolomonIslandsDollar:"Solomon Islands Dollar",SomaliShilling:"Somali Shilling",TajikistanSomoni:"Tajikistan Somoni",PacificFranc:"Pacific Franc",ThaiBaht:"Thai Baht",TanzanianShilling:"Tanzanian Shilling",TonganPaanga:"Tongan Pa'anga",TrinidadandTobagoDollar:"Trinidad and Tobago Dollar",TunisianDinar:"Tunisian Dinar",TurkishLira:"Turkish Lira",VanuatuVatu:"Vanuatu Vatu",GuatemalanQuetzal:"Guatemalan Quetzal",CommissionBolivar:"Commission Bolivar",BruneiDollar:"Brunei Dollar",UgandanShilling:"Ugandan Shilling",UkrainianHryvnia:"Ukrainian Hryvnia",UruguayanPeso:"Uruguayan Peso",Uzbekistansom:"Uzbekistan som",WesternSamoaTala:"Western Samoa Tala",SingaporeDollar:"Singapore Dollar",NT:"NT",NewZealandDollar:"New Zealand Dollar",HungarianForint:"Hungarian Forint",SyrianPound:"Syrian Pound",JamaicanDollar:"Jamaican Dollar",ArmenianDram:"Armenian Dram",YemeniRial:"Yemeni Rial",IraqiDinar:"Iraqi Dinar",IranianRial:"Iranian Rial",NewIsraeliShekel:"New Israeli Shekel",IndianRupee:"Indian Rupee",IndonesianRupiah:"Indonesian Rupiah",JordanianDinar:"Jordanian Dinar",VND:"VND",ZambianKwacha:"Zambian Kwacha",GibraltarPound:"Gibraltar Pound",ChileanPeso:"Chilean Peso",CFAFrancBEAC:"CFA Franc BEAC"},defaultFmt:[{text:"Automatic",value:"General",example:""},{text:"Plain text",value:"@",example:""},{text:"",value:"split",example:""},{text:"Number",value:"##0.00",example:"1000.12"},{text:"Percent",value:"#0.00%",example:"12.21%"},{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},{text:"",value:"split",example:""},{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"Time 24H",value:"hh:mm",example:"15:00"},{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"Date time 24 H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""},{text:"Custom formats",value:"fmtOtherSelf",example:"more"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],fontFamily:{MicrosoftYaHei:"YaHei"},fontarray:["Noto Sans CJK JP","Meiryo","Noto Sans Mono CJK JP","MeiryoKe_Gothic","Noto Serif CJK JP","Arial","Verdana","Times New Roman","Tahoma"],fontjson:{"noto sans cjk jp":0,meiryo:1,"noto sans mono cjk jp":2,MeiryoKe_Gothic:3,"noto serif cjk jp":4,arial:5,verdana:6,"times new roman":7,tahoma:8},border:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{mergeAll:"Merge all",mergeV:"Vertically",mergeH:"Horizontally",mergeCancel:"Unmerge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},align:{left:"left",center:"center",right:"right",top:"Top",middle:"Middle",bottom:"Bottom"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},rotation:{none:"None",angleup:"Tilt Up",angledown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},freezen:{default:"Freeze",freezenRow:"First Row",freezenColumn:"First Column",freezenRC:"Both",freezenRowRange:"Freezen row range",freezenColumnRange:"Freezen column range",freezenRCRange:"Freezen both range",freezenCancel:"Cancel",noSeletionError:"No Range to be selected",rangeRCOverErrorTitle:"Freeze reminder",rangeRCOverError:"The frozen pane is beyond the visible range, which will lead to abnormal operation. Please reset the frozen area."},sort:{asc:"Ascending ",desc:"Descending ",custom:"Custom sort",hasTitle:"Data has a header row",sortBy:"Sort by",addOthers:"Add another sort column",close:"close",confirm:"sort",columnOperation:"Column",secondaryTitle:"then by",sortTitle:"Sort range",sortRangeTitle:"Sort range from",sortRangeTitleTo:"to",noRangeError:"Cannot perform this operation on multiple selection areas, please select a single range and try again",mergeError:"There are merged cells in the selection, this operation cannot be performed!",columnSortMergeError:"Column sorting will extend to the entire table selection. There are merged cells, this operation cannot be performed. Please use the sort feature in the toolbar."},filter:{filter:"create filter",sortByAsc:"Sort A-Z",sortByDesc:"Sort Z-A",filterByColor:"Filter by color",filterByCondition:"Filter by condition",filterByValues:"Filter by values",filiterInputNone:"None",filiterInputTip:"Enter filter value",filiterRangeStart:"",filiterRangeStartTip:"Value for formula",filiterRangeEnd:"and",filiterRangeEndTip:"Value for formula",filterValueByAllBtn:"Check all",filterValueByClearBtn:"Clear",filterValueByInverseBtn:"Inverse",filterValueByTip:"filter By Values",filterConform:"Confirm",filterCancel:"Cancel",clearFilter:"Clear filter",conditionNone:"None",conditionCellIsNull:"Is empty",conditionCellNotNull:"Is not empty",conditionCellTextContain:"Text contains",conditionCellTextNotContain:"Text does not contain",conditionCellTextStart:"Text starts with",conditionCellTextEnd:"Text ends with",conditionCellTextEqual:"Text is exactly",conditionCellDateEqual:"Date is",conditionCellDateBefore:"Date is before",conditionCellDateAfter:"Date is after",conditionCellGreater:"Greater than",conditionCellGreaterEqual:"Greater than or equal to",conditionCellLess:"Less than",conditionCellLessEqual:"Less than or equal to",conditionCellEqual:"Is equal to",conditionCellNotEqual:"Is not equal to",conditionCellBetween:"Is between",conditionCellNotBetween:"Is not between",filiterMoreDataTip:"Big amount of data! please wait",filiterMonthText:"Month",filiterYearText:"Year",filiterByColorTip:"Filter by cell color",filiterByTextColorTip:"Filter by font color",filterContainerOneColorTip:"This column contains only one color",filterDateFormatTip:"Date format",valueBlank:"(Null)",mergeError:"There are merged cells in the filter selection, this operation cannot be performed!"},rightclick:{copy:"\u30B3\u30D4\u30FC",copyAs:"Copy as",paste:"\u8CBC\u308A\u4ED8\u3051",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},comment:{insert:"Insert",edit:"Edit",delete:"Delete",showOne:"Show/Hide",showAll:"Show/Hide All"},screenshot:{screenshotTipNoSelection:"Please select the scope of the screenshot",screenshotTipTitle:"Warning\uFF01",screenshotTipHasMerge:"This operation cannot be performed on merged cells",screenshotTipHasMulti:"This operation cannot be performed on multiple selection regions",screenshotTipSuccess:"Successful",screenshotImageName:"Screenshot",downLoadClose:"Close",downLoadCopy:"Copy to clipboard",downLoadBtn:"Download",browserNotTip:"not supported by IE browser!",rightclickTip:"Please right-click 'copy' on the picture",successTip:"Successfully (if pasting fails, please right-click on the image to 'copy image')"},splitText:{splitDelimiters:"Delimiters",splitOther:"Other",splitContinueSymbol:"Consecutive separators are treated as a single",splitDataPreview:"Preview",splitTextTitle:"Split text",splitConfirmToExe:"There is already data here, do you want to replace it?",tipNoMulti:"Cannot perform this operation on multiple selection areas, please select a single area and try again",tipNoMultiColumn:"Only one column of data can be converted at a time. The selected area can have multiple rows but not multiple columns. Please try again after selecting a single column range"},imageText:{imageSetting:"Image setting",close:"Close",conventional:"Conventional",moveCell1:"Move and resize cells",moveCell2:"Move and do not resize the cell",moveCell3:"Do not move and resize the cell",fixedPos:"Fixed position",border:"Border",width:"Width",radius:"Radius",style:"Style",solid:"Solid",dashed:"Dashed",dotted:"Dotted",double:"Double",color:"Color"},punctuation:{tab:"Tab",semicolon:"semicolon",comma:"comma",space:"space"},findAndReplace:{find:"Find",replace:"Replace",goto:"Go to",location:"Location",formula:"Formula",date:"Date",number:"Number",string:"String",error:"Error",condition:"Condition",rowSpan:"Row span",columnSpan:"Column span",locationExample:"Location",lessTwoRowTip:"Please select at least two rows",lessTwoColumnTip:"Please select at least two columns",findTextbox:"Find Content",replaceTextbox:"Replace Content",regexTextbox:"Regular Expression",wholeTextbox:"Whole word",distinguishTextbox:"Case sensitive",allReplaceBtn:"Replace All",replaceBtn:"Replace",allFindBtn:"Find All",findBtn:"Find next",noFindTip:"The content was not found",modeTip:"This operation is not available in this mode",searchTargetSheet:"Sheet",searchTargetCell:"Cell",searchTargetValue:"Value",searchInputTip:"Please enter the search content",noReplceTip:"There is nothing to replace",noMatchTip:"No match found",successTip:"${xlength} items found",locationConstant:"Constant",locationFormula:"Formula",locationDate:"Date",locationDigital:"Number",locationString:"String",locationBool:"Logical",locationError:"Error",locationNull:"Null",locationCondition:"Conditional format",locationRowSpan:"Row span",locationColumnSpan:"Column span",locationTiplessTwoRow:"Please select at least two rows",locationTiplessTwoColumn:"Please select at least two columns",locationTipNotFindCell:"Cell not found"},sheetconfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] : \\ ? * / ' "`,sheetNamecannotIsEmptyError:"Sheet name cannot be empty"},conditionformat:{conditionformat_greaterThan:"Conditionformat-GreaterThan",conditionformat_greaterThan_title:"Format cells greater than",conditionformat_lessThan:"Conditionformat-LessThan",conditionformat_lessThan_title:"Format cells smaller than",conditionformat_betweenness:"Conditionformat-Betweenness",conditionformat_betweenness_title:"Format cells with values between",conditionformat_equal:"Conditionformat-Equal",conditionformat_equal_title:"Format cells equal to",conditionformat_textContains:"Conditionformat-TextContains",conditionformat_textContains_title:"Format cells containing the following text",conditionformat_occurrenceDate:"Conditionformat-OccurrenceDate",conditionformat_occurrenceDate_title:"Format cells containing the following dates",conditionformat_duplicateValue:"Conditionformat-DuplicateValue",conditionformat_duplicateValue_title:"Format cells containing the following types of values",conditionformat_top10:"Conditionformat-Top10",conditionformat_top10_percent:"Conditionformat-Top10%",conditionformat_top10_title:"Format the cells with the highest value",conditionformat_last10:"Conditionformat-Last10",conditionformat_last10_percent:"Conditionformat-Last10%",conditionformat_last10_title:"Format the cells with the smallest value",conditionformat_AboveAverage:"Conditionformat-AboveAverage",conditionformat_AboveAverage_title:"Format cells above average",conditionformat_SubAverage:"Conditionformat-SubAverage",conditionformat_SubAverage_title:"Format cells below average",rule:"Rule",newRule:"New rule",editRule:"Edit rule",deleteRule:"Delete rule",deleteCellRule:"Delete cell rule",deleteSheetRule:"Delete sheet rule",manageRules:"Management rules",showRules:"Show its formatting rules",highlightCellRules:"Highlight cell rules",itemSelectionRules:"Item selection rules",conditionformatManageRules:"Conditional Formatting Rule Manager",format:"Format",setFormat:"Set format",setAs:"Set as",setAsByArea:"For the selected area, set to",applyRange:"Apply range",selectRange:"Select application range",selectRange_percent:"Percentage of selected range",selectRange_average:"Average value of selected range",selectRange_value:"Value in the selected range",pleaseSelectRange:"Please select application range",selectDataRange:"Select data range",selectCell:"select cell",pleaseSelectCell:"Please select cell",pleaseSelectADate:"Please select a date",pleaseEnterInteger:"Please enter an integer between 1 and 1000",onlySingleCell:"Only a single cell can be referenced",conditionValueCanOnly:"The condition value can only be a number or a single cell",ruleTypeItem1:"Format all cells based on their respective values",ruleTypeItem2:"Only format cells that contain",ruleTypeItem2_title:"Only for cells that meet the following conditions",ruleTypeItem3:"Format only the top or bottom numbers",ruleTypeItem3_title:"Is the value in the following ranking",ruleTypeItem4:"Format only values above or below the average",ruleTypeItem4_title:"Is a value that satisfies the following conditions",ruleTypeItem5:"Format only unique or repeated values",ruleTypeItem6:"Use formulas to determine which cells to format",formula:"Formula",textColor:"Text color",cellColor:"Cell color",confirm:"Confirm",confirmColor:"Confirm color",cancel:"Cancel",close:"Close",clearColorSelect:"Clear color select",sheet:"Sheet",currentSheet:"Current Sheet",dataBar:"data bar",dataBarColor:"data bar color",gradientDataBar_1:"Blue-white gradient data bar",gradientDataBar_2:"Green-white gradient data bar",gradientDataBar_3:"Red-white gradient data bar",gradientDataBar_4:"Orange-white gradient stripes",gradientDataBar_5:"Light blue-white gradient stripes",gradientDataBar_6:"Purple-white gradient data bar",solidColorDataBar_1:"Blue data bar",solidColorDataBar_2:"Green data bar",solidColorDataBar_3:"Red data bar",solidColorDataBar_4:"Orange data bar",solidColorDataBar_5:"Light blue data bar",solidColorDataBar_6:"Purple data bar",colorGradation:"color gradation",colorGradation_1:"Green-yellow-red color gradation",colorGradation_2:"Red-yellow-green color gradation",colorGradation_3:"Green-white-red color gradation",colorGradation_4:"Red-white-green color gradation",colorGradation_5:"Blue-white-red color gradation",colorGradation_6:"Red-white-blue color gradation",colorGradation_7:"White-red color gradation",colorGradation_8:"Red-white color gradation",colorGradation_9:"Green-white color gradation",colorGradation_10:"White-green color gradation",colorGradation_11:"Green-yellow color gradation",colorGradation_12:"Yellow-green color gradation",icons:"icons",pleaseSelectIcon:"Please click to select a group of icons:",cellValue:"Cell value",specificText:"Specific text",occurrence:"Date",greaterThan:"Greater than",lessThan:"Less than",between:"Between",equal:"Equal",in:"In",between2:"",contain:"Contain",textContains:"Text contains",duplicateValue:"Duplicate value",uniqueValue:"Unique value",top:"Top",top10:"Top 10",top10_percent:"Top 10%",last:"Last",last10:"Last 10",last10_percent:"Last 10%",oneself:"",above:"Above",aboveAverage:"Above average",below:"Below",belowAverage:"Below average",all:"All",yesterday:"YTD",today:"Today",tomorrow:"Tomorrow",lastWeek:"Last week",thisWeek:"This week",lastMonth:"Last month",thisMonth:"This month",lastYear:"Last year",thisYear:"This year",last7days:"Last 7 days",last30days:"Last 30 days",next7days:"Next 7 days",next30days:"Next 30 days",next60days:"Next 60 days",chooseRuleType:"Choose rule type",editRuleDescription:"Edit rule description",newFormatRule:"New format rule",editFormatRule:"Edit format rule",formatStyle:"Style",fillType:"Fill",color:"Color",twocolor:"Two-color",tricolor:"Tricolor",multicolor:"Multi color",grayColor:"Gray color",gradient:"Gradient",solid:"Solid",maxValue:"Max value",medianValue:"Median value",minValue:"Min value",direction:"Direction",threeWayArrow:"Three-way arrow",fourWayArrow:"Four-way arrow",fiveWayArrow:"Five-way arrow",threeTriangles:"Three triangles",shape:"Shape",threeColorTrafficLight:"Three-color traffic light",fourColorTrafficLight:"Four-color traffic light",threeSigns:"Three signs",greenRedBlackGradient:"Green-red-black gradient",rimless:"Rimless",bordered:"Bordered",mark:"Mark",threeSymbols:"Three symbols",tricolorFlag:"Tricolor flag",circled:"Circled",noCircle:"No circle",grade:"Grade",grade4:"4 Grade",grade5:"5 Grade",threeStars:"3 Stars",fiveQuadrantDiagram:"Five-quadrant diagram",fiveBoxes:"5 Boxes"},insertLink:{linkText:"Text",linkType:"Link type",external:"External link",internal:"Internal link",linkAddress:"Link address",linkSheet:"Worksheet",linkCell:"Cell reference",linkTooltip:"Tooltip",placeholder1:"Please enter the web link address",placeholder2:"Please enter the cell to be quoted, example A1",placeholder3:"Please enter the prompt content",tooltipInfo1:"Please enter a valid link",tooltipInfo2:"Please enter the correct cell reference"},dataVerification:{cellRange:"Cell range",selectCellRange:"Click to select a cell range",selectCellRange2:"Please select a range of cells",verificationCondition:"Verification condition",allowMultiSelect:"Allow multiple selection",dropdown:"drop-down list",checkbox:"Checkbox",number:"Number",number_integer:"Number-integer",number_decimal:"Number-decimal",text_content:"Text-content",text_length:"Text-length",date:"Date",validity:"Effectiveness",placeholder1:"Please enter the options, separated by commas, such as 1,2,3,4,5",placeholder2:"Please enter content",placeholder3:"Numeric value, such as 10",placeholder4:"Please enter the specified text",placeholder5:"Please enter the prompt displayed when the cell is selected",selected:"Selected",notSelected:"Not selected",between:"Between",notBetween:"Not between",equal:"Equal",notEqualTo:"Not equal to",moreThanThe:"More than the",lessThan:"Less than",greaterOrEqualTo:"Greater or equal to",lessThanOrEqualTo:"Less than or equal to",include:"Include",exclude:"Exclude",earlierThan:"Earlier than",noEarlierThan:"No earlier than",laterThan:"Later than",noLaterThan:"No later than",identificationNumber:"Identification number",phoneNumber:"Phone number",remote:"Automatic remote acquisition option",prohibitInput:"Prohibit input when input data is invalid",hintShow:"Show prompt when the cell is selected",deleteVerification:"Delete verification",tooltipInfo1:"The drop-down list option cannot be empty",tooltipInfo2:"Checkbox content cannot be empty",tooltipInfo3:"The value entered is not a numeric type",tooltipInfo4:"The value 2 cannot be less than the value 1",tooltipInfo5:"The text content cannot be empty",tooltipInfo6:"The value entered is not a date type",tooltipInfo7:"Date 2 cannot be less than date 1",textlengthInteger:"Text length must be an integer greater than or equal to 0"},formula:{sum:"Sum",average:"Average",count:"Count",max:"Max",min:"Min",ifGenerate:"If formula generator",find:"Learn more",tipNotBelongToIf:"This cell function does not belong to the if formula!",tipSelectCell:"Please select the cell to insert the function",ifGenCompareValueTitle:"Comparison value",ifGenSelectCellTitle:"Click to select cell",ifGenRangeTitle:"Range",ifGenRangeTo:"to",ifGenRangeEvaluate:"Range evaluate",ifGenSelectRangeTitle:"Click to select range",ifGenCutWay:"Partition way",ifGenCutSame:"Same Partition value",ifGenCutNpiece:"Partition by N",ifGenCutCustom:"Custom",ifGenCutConfirm:"Confirm",ifGenTipSelectCell:"Select cells",ifGenTipSelectCellPlace:"Please select cells",ifGenTipSelectRange:"Select range",ifGenTipSelectRangePlace:"Please select range",ifGenTipNotNullValue:"The comparison value cannot be empty!",ifGenTipLableTitile:"Label",ifGenTipRangeNotforNull:"The range cannot be empty!",ifGenTipCutValueNotforNull:"The partition value cannot be empty!",ifGenTipNotGenCondition:"No conditions are available for generation!"},formulaMore:{valueTitle:"Value",tipSelectDataRange:"Select data range",tipDataRangeTile:"Data range",findFunctionTitle:"Search function",tipInputFunctionName:"Function name or brief description of function",Array:"Array",Database:"Database",Date:"Date",Engineering:"Engineering",Filter:"Filter",Financial:"Financial",luckysheet:"Luckysheet",other:"Other",Logical:"Logical",Lookup:"Lookup",Math:"Math",Operator:"Operator",Parser:"Parser",Statistical:"Statistical",Text:"Text",dataMining:"Data Mining",selectFunctionTitle:"Select a function",calculationResult:"Result",tipSuccessText:"Success",tipParamErrorText:"Parameter type error",helpClose:"Close",helpCollapse:"Collapse",helpExample:"Example",helpAbstract:"Abstract",execfunctionError:"Error in the formula",execfunctionSelfError:"The formula cannot refer to its own cell",execfunctionSelfErrorResult:"The formula cannot refer to its own cell, which will lead to inaccurate calculation results",allowRepeatText:"Repeat",allowOptionText:"Option",selectCategory:"Or select a category"},drag:{noMerge:"Cannot perform this operation on merged cells",affectPivot:"This change cannot be made to the selected cell because it will affect the pivot table!",noMulti:"Cannot perform this operation on multiple selection areas, please select a single area",noPaste:"Unable to paste this content here, please select a cell in the paste area and try to paste again",noPartMerge:"Cannot perform this operation on partially merged cells",inputCorrect:"Please enter the correct value",notLessOne:"The number of rows and columns cannot be less than 1",offsetColumnLessZero:"The offset column cannot be negative!",pasteMustKeybordAlert:"Copy and paste in the Sheet: Ctrl + C to copy, Ctrl + V to paste, Ctrl + X to cut",pasteMustKeybordAlertHTMLTitle:"Copy and paste in the Sheet",pasteMustKeybordAlertHTML:'<span style="line-height: 1.0; font-size: 36px; font-weight: bold; color: #666;">Ctrl + C</span>&nbsp;&nbsp;to copy<br/><span style="line-height: 1.0; font-size: 36px; font-weight: bold; color: #666;">Ctrl + V</span>&nbsp;&nbsp;to paste<br/><span style="line-height: 1.0; font-size: 36px; font-weight: bold; color: #666;">Ctrl + X</span>&nbsp;&nbsp;to cut'},paste:{warning:"Warning",errorNotAllowMulti:"Cannot perform this operation on multiple selection areas, please select a single range and try again",errorNotAllowMerged:"Cannot make partial changes to merged cells"},pivotTable:{title:"Pivot Table",closePannel:"Close",editRange:"Range",tipPivotFieldSelected:"Select the fields",tipClearSelectedField:"Clear all fields",btnClearSelectedField:"Clear",btnFilter:"Filter",titleRow:"Row",titleColumn:"Column",titleValue:"Value",tipShowColumn:"Statistics fields are displayed as columns",tipShowRow:"Statistics fields are displayed as rows",titleSelectionDataRange:"Select range",titleDataRange:"Data range",valueSum:"SUM",valueStatisticsSUM:"Sum",valueStatisticsCOUNT:"Count",valueStatisticsCOUNTA:"Count A",valueStatisticsCOUNTUNIQUE:"Count Unique",valueStatisticsAVERAGE:"Average",valueStatisticsMAX:"Max",valueStatisticsMIN:"Min",valueStatisticsMEDIAN:"Median",valueStatisticsPRODUCT:"Product",valueStatisticsSTDEV:"Stdev",valueStatisticsSTDEVP:"Stdevp",valueStatisticslet:"Var",valueStatisticsVARP:"VarP",errorNotAllowEdit:"This operation is prohibited in non-editing mode!",errorNotAllowMulti:"Cannot perform this operation on multiple selection areas, please select a single range and try again",errorSelectRange:"Please select the range of the new pivot table",errorIsDamage:"The source data of this pivot table is corrupted!",errorNotAllowPivotData:"Cannot select pivot table as source data!",errorSelectionRange:"Selection failed, wrong input range!",errorIncreaseRange:"Please expand the selected range!",titleAddColumn:"Add column to pivot table",titleMoveColumn:"Move the column to the white box below",titleClearColumnFilter:"Clear the filter for this column",titleFilterColumn:"Filter",titleSort:"Sort",titleNoSort:"No sort",titleSortAsc:"ASC",titleSortDesc:"DESC",titleSortBy:"Sort by",titleShowSum:"Show total",titleStasticTrue:"Yes",titleStasticFalse:"No"},dropCell:{copyCell:"Copy",sequence:"Sequence",onlyFormat:"Only format",noFormat:"Not format",day:"Day",workDay:"Work Day",month:"Month",year:"Year",chineseNumber:"Chinese numbers"},imageCtrl:{borderTile:"Image border color",borderCur:"Color"},protection:{protectiontTitle:"Protection",enterPassword:"Enter a password (optional)",enterHintTitle:"Prompt when editing is prohibited (optional)",enterHint:"The cell or chart you are trying to change is in a protected worksheet. If you want to change it, please unprotect the worksheet. You may need to enter a password",swichProtectionTip:"Protect the sheet and contents of locked cells",authorityTitle:"Allow users of this sheet to:",selectLockedCells:"Select locked cells",selectunLockedCells:"Select unlocked cells",formatCells:"Format cells",formatColumns:"Format columns",formatRows:"Format rows",insertColumns:"Insert columns",insertRows:"Insert rows",insertHyperlinks:"Insert hyperlinks",deleteColumns:"Delete columns",deleteRows:"Delete rows",sort:"Sort",filter:"Filter",usePivotTablereports:"Use Pivot Table reports",editObjects:"Edit objects",editScenarios:"Edit scenarios",allowRangeTitle:"Allow users of range to:",allowRangeAdd:"New...",allowRangeAddTitle:"Title",allowRangeAddSqrf:"Reference",selectCellRange:"Click to select a cell range",selectCellRangeHolder:"Cell range",allowRangeAddTitlePassword:"Password",allowRangeAddTitleHint:"Prompt",allowRangeAddTitleHintTitle:"Prompt when a password is set (optional)",allowRangeAddtitleDefault:"Input range name",rangeItemDblclick:"Double click to edit",rangeItemHasPassword:"Has password",rangeItemErrorTitleNull:"Title is null",rangeItemErrorRangeNull:"Reference is null",rangeItemErrorRange:"Reference is error",validationTitle:"Password validation",validationTips:"Need to enter a password to unlock the protection of the worksheet",validationInputHint:"Enter a password",checkPasswordNullalert:"Password is required!",checkPasswordWrongalert:"Incorrect password, please try again!",checkPasswordSucceedalert:"Unlock Succeed!",defaultRangeHintText:"The cell is being password protected.",defaultSheetHintText:"The cell or chart is in a protected worksheet. To make changes, please unprotect the worksheet. You may need to enter a password"},cellFormat:{cellFormatTitle:"Format cells",protection:"Protection",locked:"Locked",hidden:"Hidden",protectionTips:"To lock cells or hide formulas, protect the worksheet. On the toolbar, Click Protect Sheet Button",tipsPart:"Partial checked",tipsAll:"All checked",selectionIsNullAlert:"Selection is required!",sheetDataIsNullAlert:"error, Data is none!"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page break preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},edit:{typing:"typing"},websocket:{success:"WebSocket connection success",refresh:"An error occurred in the WebSocket connection, please refresh the page!",wait:"An error occurred in the WebSocket connection, please be patient!",close:"WebSocket connection closed",contact:"Server communication error occurred, please refresh the page and try again, if not, please contact the administrator!",support:"The current browser does not support WebSocket"}}});function Xm(){return ja[f.lang]}var ja,Q,kt=Me(()=>{Zc();Ke();ja={ja:Kc};Q=Xm});function Jc(){let e=Q().toolbar,n=Q().fontarray,t=Q().defaultFmt,l={undo:`<div class="luckysheet-toolbar-button luckysheet-inline-block disabled" data-tips="${e.undo}"
        id="luckysheet-icon-undo" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-undo iconfont luckysheet-iconfont-qianjin"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,redo:`<div class="luckysheet-toolbar-button luckysheet-inline-block disabled" data-tips="${e.redo}"
        id="luckysheet-icon-redo" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-redo iconfont luckysheet-iconfont-houtui"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,paintFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.paintFormat}"
        id="luckysheet-icon-paintformat" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-geshishua"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,currencyFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.currencyFormat}"
        id="luckysheet-icon-currency" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-jine"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,percentageFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.percentageFormat}"
        id="luckysheet-icon-percent" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-baifenhao"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,numberDecrease:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.numberDecrease}"
        id="luckysheet-icon-fmt-decimal-decrease" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon"
                    style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-decrease iconfont luckysheet-iconfont-zengjiaxiaoshuwei"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,numberIncrease:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.numberIncrease}"
        id="luckysheet-icon-fmt-decimal-increase" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon"
                    style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-increase iconfont luckysheet-iconfont-jianxiaoxiaoshuwei"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,moreFormats:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.moreFormats}"
        id="luckysheet-icon-fmt-other" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${t[0].text}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,font:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.font}" id="luckysheet-icon-font-family" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${n[0]}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,fontSize:`<div class="luckysheet-toolbar-select luckysheet-toolbar-zoom-combobox luckysheet-toolbar-combo-button luckysheet-inline-block"
        data-tips="${e.fontSize}" id="luckysheet-icon-font-size" style="user-select: none;">
            <div class="luckysheet-toolbar-combo-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-combo-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div aria-posinset="4" aria-setsize="7" class="luckysheet-inline-block luckysheet-toolbar-combo-button-caption"
                    style="user-select: none;">
                        <input aria-label="${e.fontSize}" class="luckysheet-toolbar-combo-button-input luckysheet-toolbar-textinput"
                        role="combobox" style="user-select: none;" tabindex="-1" type="text" value="10"
                        />
                    </div>
                    <div class="luckysheet-toolbar-combo-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,bold:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.bold}"
        id="luckysheet-icon-bold" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-bold iconfont luckysheet-iconfont-jiacu"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,italic:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.italic}"
        id="luckysheet-icon-italic" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-italic iconfont luckysheet-iconfont-wenbenqingxie1"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,strikethrough:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.strikethrough}"
        id="luckysheet-icon-strikethrough" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-strikethrough iconfont luckysheet-iconfont-wenbenshanchuxian"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,underline:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.underline}"
        id="luckysheet-icon-underline" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-underline iconfont luckysheet-iconfont-wenbenxiahuaxian"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,textColor:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-text-color"
        data-tips="${e.textColor}" id="luckysheet-icon-text-color" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(0, 0, 0); user-select: none;">
                            <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                                <div class="text-color-bar" style="background-color:${de.defaultTextColor}"></div>
                                <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color iconfont luckysheet-iconfont-wenbenyanse"
                                style="user-select: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseColor}..." id="luckysheet-icon-text-color-menu" role="button"
        style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,fillColor:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-cell-color"
        data-tips="${e.fillColor}" id="luckysheet-icon-cell-color" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(255, 255, 255); user-select: none;">
                            <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                                <div class="text-color-bar" style="background-color:${de.defaultCellColor}"></div>
                                <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color iconfont luckysheet-iconfont-tianchong"
                                style="user-select: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseColor}..." id="luckysheet-icon-cell-color-menu" role="button"
        style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,border:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-border-all"
        data-tips="${e.border}" id="luckysheet-icon-border-all" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.borderStyle}..." id="luckysheet-icon-border-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,mergeCell:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-merge-button"
        data-tips="${e.mergeCell}" id="luckysheet-icon-merge-button" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-merge iconfont luckysheet-iconfont-hebing"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseMergeType}..." id="luckysheet-icon-merge-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,horizontalAlignMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-align"
        data-tips="${e.horizontalAlign}" id="luckysheet-icon-align" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.alignment}..." id="luckysheet-icon-align-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,verticalAlignMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-valign"
        data-tips="${e.verticalAlign}" id="luckysheet-icon-valign" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.alignment}..." id="luckysheet-icon-valign-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,textWrapMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-textwrap"
        data-tips="${e.textWrap}" id="luckysheet-icon-textwrap" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.textWrapMode}..." id="luckysheet-icon-textwrap-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,textRotateMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-rotation"
        data-tips="${e.textRotate}" id="luckysheet-icon-rotation" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.textRotateMode}..." id="luckysheet-icon-rotation-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,image:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.insertImage}" id="luckysheet-insertImg-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-tupian"
                            style="user-select: none;">
                                <input id="luckysheet-imgUpload" type="file" accept="image/*" style="display:none;"></input>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,link:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.insertLink}" id="luckysheet-insertLink-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-lianjie"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,chart:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.chart}" id="luckysheet-chart-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-tubiao"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,postil:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.postil}"
        id="luckysheet-icon-postil" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon-img-container luckysheet-toolbar-menu-button-caption luckysheet-inline-block iconfont luckysheet-iconfont-zhushi"
                    style="user-select: none;">
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,pivotTable:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.pivotTable}" id="luckysheet-pivot-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-shujutoushi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,function:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-function"
        data-tips="${e.autoSum}" id="luckysheet-icon-function" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-jisuan"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${e.sum}
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.moreFunction}..." id="luckysheet-icon-function-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,frozenMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-freezen-btn-horizontal"
        data-tips="${e.freezeTopRow}" id="luckysheet-freezen-btn-horizontal" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-dongjie1"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.moreOptions}..." id="luckysheet-icon-freezen-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,sortAndFilter:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.sortAndFilter}"
        id="luckysheet-icon-autofilter" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-shaixuan"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`,conditionalFormat:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.conditionalFormat}"
        id="luckysheet-icon-conditionformat" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-geshitiaojian"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,dataVerification:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.dataVerification}" id="luckysheet-dataVerification-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-shujuyanzheng"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,splitColumn:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.splitColumn}" id="luckysheet-splitColumn-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wenbenfenge"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,screenshot:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.screenshot}" id="luckysheet-chart-btn-screenshot" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-jieping"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,findAndReplace:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.findAndReplace}"
        id="luckysheet-icon-seachmore" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-sousuo"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`,protection:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.protection}" id="luckysheet-icon-protection" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-biaogesuoding"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,print:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.print}"
        id="luckysheet-icon-print" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-dayin"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`},o=de.showtoolbar,a=de.showtoolbarConfig,s=['<div class="luckysheet-toolbar-left-theme"></div>'];if(N(a)==="array"){if(!o)return"";let h=0;return a.forEach(function(d,m){if(d==="|"){let p=a[m-1];p!=="|"&&s.push(`<div id="toolbar-separator-${Sn(p)}" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"></div>`)}else s.push(l[d])}),s.join("")}let u=Mr.reduce(function(h,d){return d!=="|"&&(h[d]=!0),h},{});if(!o)for(let h in u)u[h]=!1;JSON.stringify(a)!=="{}"&&(a.hasOwnProperty("undoRedo")&&(u.undo=u.redo=a.undoRedo),Object.assign(u,a));for(let h=0;h<Mr.length;h++){let d=Mr[h];if(!u[d]&&d!=="|"){Mr[h+1]==="|"&&h++;continue}if(d==="|"){let m=Mr[h-1];m!=="|"&&s.push(`<div id="toolbar-separator-${Sn(m)}" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"></div>`)}else s.push(l[d])}return s.join("")}var Mr,Wa,Ua=Me(()=>{kt();xl();ht();Mr=["undo","redo","paintFormat","|","currencyFormat","percentageFormat","numberIncrease","numberDecrease","moreFormats","|","font","|","fontSize","|","bold","italic","strikethrough","underline","textColor","|","fillColor","border","mergeCell","|","horizontalAlignMode","verticalAlignMode","textWrapMode","textRotateMode","|","image","link","chart","postil","pivotTable","|","function","frozenMode","sortAndFilter","conditionalFormat","dataVerification","splitColumn","screenshot","findAndReplace","protection","print"],Wa={undo:"#luckysheet-icon-undo",redo:"#luckysheet-icon-redo",paintFormat:["#luckysheet-icon-paintformat"],currencyFormat:"#luckysheet-icon-currency",percentageFormat:"#luckysheet-icon-percent",numberDecrease:"#luckysheet-icon-fmt-decimal-decrease",numberIncrease:"#luckysheet-icon-fmt-decimal-increase",moreFormats:"#luckysheet-icon-fmt-other",font:"#luckysheet-icon-font-family",fontSize:"#luckysheet-icon-font-size",bold:"#luckysheet-icon-bold",italic:"#luckysheet-icon-italic",strikethrough:"#luckysheet-icon-strikethrough",underline:"#luckysheet-icon-underline",textColor:["#luckysheet-icon-text-color","#luckysheet-icon-text-color-menu"],fillColor:["#luckysheet-icon-cell-color","#luckysheet-icon-cell-color-menu"],border:["#luckysheet-icon-border-all","#luckysheet-icon-border-menu"],mergeCell:["#luckysheet-icon-merge-button","#luckysheet-icon-merge-menu"],horizontalAlignMode:["#luckysheet-icon-align","#luckysheet-icon-align-menu"],verticalAlignMode:["#luckysheet-icon-valign","#luckysheet-icon-valign-menu"],textWrapMode:["#luckysheet-icon-textwrap","#luckysheet-icon-textwrap-menu"],textRotateMode:["#luckysheet-icon-rotation","#luckysheet-icon-rotation-menu"],image:"#luckysheet-insertImg-btn-title",link:"#luckysheet-insertLink-btn-title",chart:"#luckysheet-chart-btn-title",postil:"#luckysheet-icon-postil",pivotTable:["#luckysheet-pivot-btn-title"],function:["#luckysheet-icon-function","#luckysheet-icon-function-menu"],frozenMode:["#luckysheet-freezen-btn-horizontal","#luckysheet-icon-freezen-menu"],sortAndFilter:"#luckysheet-icon-autofilter",conditionalFormat:"#luckysheet-icon-conditionformat",dataVerification:"#luckysheet-dataVerification-btn-title",splitColumn:"#luckysheet-splitColumn-btn-title",screenshot:"#luckysheet-chart-btn-screenshot",findAndReplace:"#luckysheet-icon-seachmore",protection:"#luckysheet-icon-protection",print:"#luckysheet-icon-print"}});function lu(){let e=Q(),n=e.rightclick,t=e.toolbar,l=Jm(),o=!0;!l.insertRow&&!l.insertColumn&&!l.deleteRow&&!l.deleteColumn&&!l.deleteCell&&(o=!1);let a=!0;!l.clear&&!l.matrix&&!l.sort&&!l.filter&&!l.chart&&!l.image&&!l.link&&!l.data&&!l.cellFormat&&(a=!1);let s=(l.customs||[]).map((h,d)=>`
            <div data-index="${d}" class="luckysheetColsRowsHandleAdd_custom luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                ${h.title}
                </div>
            </div>`).join("");return`<div id="luckysheet-rightclick-menu" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel">
                <div id="luckysheet-copy-btn" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-copy-btn" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" style="display:${l.copy?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.copy}</div>
                </div>
                <div id="luckysheetcopyfor" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"  style="display:${l.copyAs?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.copyAs}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                    </div>
                </div>
                <div id="luckysheet-copy-paste" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.paste?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.paste}</div>
                </div>
                <div id="luckysheet-cols-rows-handleincell">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${o?"block":"none"};"></div>
                    <div id="luckysheetColsRowsHandleAdd_row" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.insertRow?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.insert}${n.row}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheetColsRowsHandleAdd_column" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.insertColumn?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.insert}${n.column}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheet-delRows" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteRow?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.row}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheet-delCols" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteColumn?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.column}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <!-- cell right click remove hide button
                    <div id="luckysheetColsRowsHandleHid" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.hide}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                    -->
                    <div id="luckysheetCellsHandleDel" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteCell?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.deleteCell}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-add">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                    <div id="luckysheet-top-left-add-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.to}
                            <span class="luckysheet-cols-rows-shift-left">${n.left}</span>
                            ${n.add}
                            <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align:center;margin-left:5px;"/>
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-bottom-right-add-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.to}
                            <span class="luckysheet-cols-rows-shift-right">${n.right}</span>
                            ${n.add}
                            <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-del-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.deleteSelected}
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-hide-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}
                        <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-show-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.showHide}
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-column-row-width-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                            <span class="luckysheet-cols-rows-shift-size luckysheet-mousedown-cancel">${n.width}</span>
                            <input type="number" class="luckysheet-mousedown-cancel rcsize" min="0" max="255" placeholder="${n.number}" value="" style="width:50px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;">
                            px
                        </div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-shift">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${l.sort?"block":"none"};"></div>
                    <div id="luckysheetorderbyasc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.orderAZ}</div>
                    </div>
                    <div id="luckysheetorderbydesc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.orderZA}</div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-data">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${a?"block":"none"};"></div>
                    <div id="luckysheet-delete-text" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.clear?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.clearContent}</div>
                    </div>
                    <div id="luckysheetmatrix" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.matrix?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.matrix}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheetorderby" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.sortSelection}</div>
                    </div>
                    <div id="luckysheetfilter" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.filter?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.filterSelection}</div>
                    </div>
                    <div id="luckysheetdatavisual" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.chart?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.chartGeneration}</div>
                    </div>
                    <div id="luckysheetInsertImage" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.image?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.insertImage}</div>
                    </div>
                    <div id="luckysheetInsertLink" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.link?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.insertLink}</div>
                    </div>
                    <div id="luckysheetDataVerification" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.data?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.dataVerification}</div>
                    </div>
                    <div id="luckysheetCellFormatRightClickMenu" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.cellFormat?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.cellFormat}</div>
                    </div>
                    ${s}
                </div>
            </div>
            <div id="luckysheetcopyfor_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-copy-json-head" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json ${n.firstLineTitle}</div>
                </div>
                <div id="luckysheet-copy-json-nohead" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json ${n.untitled}</div>
                </div>
                <div id="luckysheet-copy-array1" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.array1}</div>
                </div>
                <div id="luckysheet-copy-array2" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.array2}</div>
                </div>
                <div id="luckysheet-copy-arraymore-confirm" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        <span class="luckysheet-mousedown-cancel">${n.array3}</span>
                        <input type="number" id="luckysheet-copy-arraymore-row" min="1" class="luckysheet-mousedown-cancel" placeholder="${n.row}" style="width:40px;height:20px;box-sizing:border-box;text-align: center;"/>
                            \xD7
                            <input type="number" id="luckysheet-copy-arraymore-col" min="1" class="luckysheet-mousedown-cancel" placeholder="${n.column}" style="width:40px;height:20px;box-sizing:border-box;text-align: center;"/>
                    </div>
                </div>
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                <div id="luckysheet-copy-diagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.diagonal}</div>
                </div>
                <div id="luckysheet-copy-antidiagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.antiDiagonal}</div>
                </div>
                <div id="luckysheet-copy-diagonaloffset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.diagonalOffset}
                        <input type="number" id="luckysheet-copy-diagonaloffset-value" class="luckysheet-mousedown-cancel" placeholder="${n.offset}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        ${n.column}
                    </div>
                </div>
                <div id="luckysheet-copy-boolvalue" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.boolean}</div>
                </div>
            </div>
            
            <!-- Revision: modeled on google sheet
            
            <div id="luckysheetColsRowsHandleAdd_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.top}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.row}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.bottom}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.row}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.left}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.column}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.right}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.column}</span>
                    </div>
                </div>
            </div>
            
            -->

            <!-- delete row or column
            
            <div id="luckysheetColsRowsHandleDel_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-delRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.row}
                    </div>
                </div>
                <div id="luckysheet-delCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.column}
                    </div>
                </div>
            </div>
            
            -->

            <!--
            <div id="luckysheetColsRowsHandleHid_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-hidRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}${n.row}
                    </div>
                </div>
                <div id="luckysheet-showHidRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.showHide}${n.row}
                    </div>
                </div>
                <div id="luckysheet-hidCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}${n.column}
                    </div>
                </div>
                <div id="luckysheet-showHidCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.showHide}${n.column}
                    </div>
                </div>
            </div>

            -->

            <div id="luckysheetCellsHandleDel_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-delCellsMoveLeft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.moveLeft}
                    </div>
                </div>
                <div id="luckysheet-delCellsMoveUp" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.moveUp}
                    </div>
                </div>
            </div>
            <div id="luckysheetmatrix_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.flip}
                        <button id="luckysheet-matrix-turn-up" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.upAndDown}</button>
                        <button id="luckysheet-matrix-turn-left" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.leftAndRight}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.flip}
                        <button id="luckysheet-matrix-turn-cw" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.clockwise}</button>
                        <button id="luckysheet-matrix-turn-anticw" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.counterclockwise}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div id="luckysheet-matrix-turn-trans" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.transpose}</div>
                </div>
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                <div id="luckysheet-matrix-cal-confirm" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        <div class="luckysheet-mousedown-cancel">${n.matrixCalculation}</div>
                        <div class="luckysheet-mousedown-cancel">
                            <select id="luckysheet-matrix-cal-type" class="luckysheet-mousedown-cancel" style="height:20px;">
                                <option value="plus">${n.plus}</option>
                                <option value="minus">${n.minus}</option>
                                <option value="multiply">${n.multiply}</option>
                                <option value="divided">${n.divided}</option>
                                <option value="power">${n.power}</option>
                                <option value="root">${n.root}</option>
                                <option value="log">${n.log}</option>
                            </select>
                            <input type="number" id="luckysheet-matrix-cal-value" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="2" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        </div>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.delete0}
                        <button id="luckysheet-matrix-delezero-row" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byRow}</button>
                        <button id="luckysheet-matrix-delezero-column" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byCol}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.removeDuplicate}
                        <button id="luckysheet-matrix-delerpt-row" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byRow}</button>
                        <button id="luckysheet-matrix-delerpt-column" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byCol}</button>
                    </div>
                </div>
            </div>`}function uu(){let e=Q().sheetconfig,n=Qm();if(Object.values(n).every(a=>!a))return $("#luckysheet-sheet-container-c").addClass("luckysheet-sheet-container-menu-hide"),"";let t=!0,l=!0;return!n.delete&&!n.copy&&!n.rename&&!n.color&&(t=!1,n.hide||(l=!1)),n.hide||(t=!1),n.move||(l=!1),`<div id="luckysheet-rightclick-sheet-menu" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"> 
                <div id="luckysheetsheetconfigdelete" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.delete?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.delete}</div>
                </div> 
                <div id="luckysheetsheetconfigcopy" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.copy?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.copy}</div> 
                </div> 
                <div id="luckysheetsheetconfigrename" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.rename?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.rename}</div> 
                </div> 
                <div id="luckysheetsheetconfigcolor" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${n.color?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> 
                        ${e.changeColor} <span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span> 
                    </div> 
                </div> 
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${t?"block":"none"};"></div> 
                <div id="luckysheetsheetconfighide" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.hide?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.hide}</div> 
                </div> 
                <div id="luckysheetsheetconfigshow" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.hide?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.unhide}</div> 
                </div> 
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${l?"block":"none"};"></div> 
                <div id="luckysheetsheetconfigmoveleft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.move?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.moveLeft}</div> 
                </div> 
                <div id="luckysheetsheetconfigmoveright" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.move?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.moveRight}</div> 
                </div> 
            </div> 
            <div id="luckysheetsheetconfigcolor_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheetsheetconfigcolorreset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.resetColor}</div>
                </div> 
                <div class="luckysheet-mousedown-cancel"> 
                    <div class="luckysheet-mousedown-cancel"> 
                        <input type="text" id="luckysheetsheetconfigcolorur" /> 
                    </div> 
                </div> 
            </div>`}function jo(){let n=Q().filter;return`<div class="luckysheet-cols-menu luckysheet-mousedown-cancel luckysheet-filter-menu" id="luckysheet-\${menuid}-menu"><div id="luckysheet-\${menuid}-orderby-asc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.sortByAsc}</div></div><div id="luckysheet-\${menuid}-orderby-desc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div style="width:205px;" class="luckysheet-mousedown-cancel">${n.sortByDesc}</div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div id="luckysheet-\${menuid}-orderby-color" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="position: relative;">${n.filterByColor}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;right: 0;"></span></div></div><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-bycondition" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> ${n.filterByCondition}</div></div> <div class="luckysheet-\${menuid}-bycondition" style="display:none;"><div class="luckysheet-flat-menu-button luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-selected"><span class="luckysheet-mousedown-cancel" data-value="null" data-type="0">${n.filiterInputNone}</span><div class="luckysheet-mousedown-cancel"><i class="fa fa-sort" aria-hidden="true"></i></div></div><div class="luckysheet-\${menuid}-selected-input"><input type="text" placeholder="${n.filiterInputTip}" class="luckysheet-mousedown-cancel" /></div><div class="luckysheet-\${menuid}-selected-input luckysheet-\${menuid}-selected-input2"><span>${n.filiterRangeStart}</span><input type="text" placeholder="${n.filiterRangeStartTip}" class="luckysheet-mousedown-cancel" /><span>${n.filiterRangeEnd}</span><input type="text" placeholder="${n.filiterRangeEndTip}" class="luckysheet-mousedown-cancel" /></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-byvalue" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> ${n.filterByValues}</div></div> <div class="luckysheet-\${menuid}-byvalue"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel luckysheet-mousedown-\${menuid}-byvalue-btn"><span id="luckysheet-\${menuid}-byvalue-btn-all" class="luckysheet-mousedown-cancel">${n.filterValueByAllBtn}</span> - <span id="luckysheet-\${menuid}-byvalue-btn-clear" class="luckysheet-mousedown-cancel">${n.filterValueByClearBtn}</span> - <span id="luckysheet-\${menuid}-byvalue-btn-contra" class="luckysheet-mousedown-cancel">${n.filterValueByInverseBtn}</span> <div><i class="fa fa-\${menuid} luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="padding-left:3px; padding-right:3px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><input type="text" placeholder="${n.filterValueByTip}" class="luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-byvalue-input" /><div class="luckysheet-\${menuid}-byvalue-input-icon luckysheet-mousedown-cancel"><i class="fa fa-search luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div id="luckysheet-\${menuid}-byvalue-select" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"></div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div class="btn btn-primary luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-confirm">${n.filterConform}</div> <div class="btn btn-default luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-cancel">${n.filterCancel}</div> <div class="btn btn-danger luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-initial">${n.clearFilter}</div></div></div> </div>`}function Wo(){let n=Q().filter;return`<div style="z-index:1004;overflow-y:auto;" class="luckysheet-filter-submenu luckysheet-cols-menu luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-submenu"><div data-value="null" data-type="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionNone}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellIsNull}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnonull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotNull}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextContain}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textnotinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextNotContain}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textstart"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextStart}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textend"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextEnd}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextEqual}</div></div>  <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>  <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="dateequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datelessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateBefore}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datemorethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateAfter}</div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="morethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellGreater}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="moreequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellGreaterEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellLess}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellLessEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="equal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="include"  data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellBetween}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noinclude" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotBetween}</div></div> </div>`}function hu(){let e=Q(),n=e.alternatingColors,t=e.toolbar;return'<div id="luckysheet-modal-dialog-slider-alternateformat" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-alternateformat" style="display: block;"><div class="luckysheet-modal-dialog-slider-title"><span>'+t.alternatingColors+'</span><span class="luckysheet-model-close-btn" title="'+n.close+'"><i class="fa fa-times" aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-slider-content"><div class="textTitle">'+n.applyRange+'</div><div id="luckysheet-alternateformat-range"><input class="formulaInputFocus" placeholder="'+n.selectRange+'"/><i class="fa fa-table" aria-hidden="true"></i></div><div id="luckysheet-alternateformat-checkbox"><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowHeader"/><label for="luckysheet-alternateformat-rowHeader">'+n.header+'</label></div><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowFooter"/><label for="luckysheet-alternateformat-rowFooter">'+n.footer+'</label></div></div><div class="textTitle">'+n.textTitle+'</div><div id="luckysheet-alternateformat-modelList" class="cf"></div><div class="textTitle">'+n.custom+'</div><div id="luckysheet-alternateformat-modelCustom" class="cf"></div><div id="luckysheet-alternateformat-modelToning"><div class="toningbox header"><div class="toningShow"> '+n.header+' </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctOne"><div class="toningShow"> '+n.colorShow+'1 </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctTwo"><div class="toningShow"> '+n.colorShow+'2 </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox footer"><div class="toningShow"> '+n.footer+' </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div></div><button id="luckysheet-alternateformat-remove" class="btn btn-default" style="margin: 10px;">'+n.removeColor+"</button></div></div>"}function gu(){return Jc()}function Km(){let n=Q().info,t={enable:!0,image:()=>`<svg viewBox="25 25 50 50" class="circular">
            <circle cx="50" cy="50" r="20" fill="none"></circle>
            </svg>`,text:n.loading,viewBox:"32 32 64 64",imageClass:"",textClass:"",customClass:""};return JSON.stringify(de.loading)!=="{}"&&Object.assign(t,de.loading),t}function Jm(){let e={copy:!0,copyAs:!0,paste:!0,insertRow:!0,insertColumn:!0,deleteRow:!0,deleteColumn:!0,deleteCell:!0,hideRow:!0,hideColumn:!0,rowHeight:!0,columnWidth:!0,clear:!0,matrix:!0,sort:!0,filter:!0,chart:!0,image:!0,link:!0,data:!0,cellFormat:!0};return JSON.stringify(de.cellRightClickConfig)!=="{}"&&Object.assign(e,de.cellRightClickConfig),de.cellRightClickConfig=e,e}function Qm(){let e={delete:!0,copy:!0,rename:!0,color:!0,hide:!0,move:!0};return JSON.stringify(de.sheetRightClickConfig)!=="{}"&&Object.assign(e,de.sheetRightClickConfig),de.sheetRightClickConfig=e,e}var Qc,eu,tu,ru,nu,Ql,iu,ou,au,su,dt,cu,fu,du,mu,Zm,Ar,Gl,it,Tl,Yn,wi,Jr,Wt=Me(()=>{kt();Ke();xl();ht();Ua();Qc=function(){let e=Q(),n=e.info,t=e.print,l=de.userInfo===!0?'<i style="font-size:16px;color:#ff6a00;" class="fa fa-taxi" aria-hidden="true"></i> Lucky':de.userInfo;return`<div class="luckysheet">
                    <canvas id="luckysheetTableContentF" style="display:none;" class="luckysheetTableContent"></canvas> 
                    <div class="luckysheet-work-area luckysheet-noselected-text"> 
                        <div id ="luckysheet_info_detail" class="luckysheet_info_detail"> 
                            <div data-tips="${n.return}" id="luckysheet_info_detail_title" class="luckysheet_info_detail_back"> 
                                <i style="color:#444D5A;" class="fa fa-angle-left fa-2x" aria-hidden="true"></i> 
                            </div> 
                            <div class="luckysheet-share-logo" title="\${logotitle}"></div>
                            <div class="sheet-name"> 
                                <input data-tips="${n.tips}" id="luckysheet_info_detail_input" class="luckysheet_info_detail_input luckysheet-mousedown-cancel" value="${n.noName}" tabindex="0" dir="ltr" aria-label="${n.rename}" style="visibility: visible; width: 149px;" data-tooltip="${n.rename}"> 
                            </div> 
                            <div id="luckysheet_info_detail_update" class="luckysheet_info_detail_update"> ${n.detailUpdate} </div> 
                            <div id="luckysheet_info_detail_save" class="luckysheet_info_detail_save"> ${n.wait} </div>
                            
                            \${functionButton}
                            
                            ${N(l)==="string"?`<div class="luckysheet_info_detail_user">
                            <span id="luckysheet_info_detail_user">${l}</span></div>`:""}

                            ${N(l)==="object"?`<div class="luckysheet_info_detail_user">                            
                            <img src="${l.userImage}" id="luckysheet_info_detail_user_img">
                            <span id="luckysheet_info_detail_user">${l.userName}</span>
                            </div>`:""}
                            
                        </div> 
                        <div id="luckysheet-wa-editor" class="luckysheet-wa-editor toolbar"> \${menu} </div> 
                        <div id="luckysheet-wa-calculate" class="luckysheet-wa-calculate"> 
                            <div class="luckysheet-wa-calculate-size" id="luckysheet-wa-calculate-size"></div> 
                            <div class="luckysheet-wa-calculate-help"> 
                                <div class="luckysheet-wa-calculate-help-box"> 
                                    <div spellcheck="false" aria-hidden="false" id="luckysheet-helpbox">
                                        <div id="luckysheet-helpbox-cell" class="luckysheet-helpbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list"></div>
                                    </div> 
                                </div>  
                                <div class="luckysheet-wa-calculate-help-tool">
                                    <i class="fa fa-caret-down" aria-hidden="true"></i>
                                </div> 
                            </div> 
                            <div id="luckysheet-wa-functionbox-cancel" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-qingchu" aria-hidden="true"></i></span>
                            </div> 
                            <div id="luckysheet-wa-functionbox-confirm" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-yunhang" aria-hidden="true"></i></span>
                            </div> 
                            <div id="luckysheet-wa-functionbox-fx" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-hanshu" aria-hidden="true" style="color:#333"></i></span> 
                            </div> 
                            <div id="luckysheet-functionbox-container" class="luckysheet-mousedown-cancel">
                                <div class="luckysheet-mousedown-cancel" dir="ltr">
                                    <div spellcheck="false" aria-hidden="false" id="luckysheet-functionbox">
                                        <div id="luckysheet-functionbox-cell" class="luckysheet-functionbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list" aria-label="D4"></div>
                                    </div>
                                </div>
                            </div>   
                        </div> 
                    </div> 
                    <div class="luckysheet-grid-container luckysheet-scrollbars-enabled"> 
                        <div class="luckysheet-grid-window"> 
                            <div class="luckysheet-help-sub"></div> 
                            <div class="luckysheet-grid-window-1" id="luckysheet-grid-window-1">
                                <canvas id="luckysheetTableContent" class="luckysheetTableContent"></canvas> 
                                <table class="luckysheet-grid-window-2" cellspacing="0" cellpadding="0" dir="ltr" tabindex="-1" > 
                                    <tbody> 
                                        <tr> 
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div class="luckysheet-left-top" id="luckysheet-left-top"> </div> 
                                            </td> 
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div id="luckysheet-cols-h-c" class="luckysheet-cols-h-c">
                                                    <div class="luckysheet-cols-change-size" id="luckysheet-cols-change-size"></div>  
                                                    <div class="luckysheet-cols-menu-btn luckysheet-mousedown-cancel" id="luckysheet-cols-menu-btn"><i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i></div>  
                                                    <div class="luckysheet-cols-h-hover" id="luckysheet-cols-h-hover"></div>  
                                                    <div id="luckysheet-cols-h-selected"></div>  
                                                    <div class="luckysheet-grdusedrange"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div>  \${columnHeader}
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div class="luckysheet-rows-h" id="luckysheet-rows-h"> 
                                                    <div class="luckysheet-rows-change-size" id="luckysheet-rows-change-size"></div> 
                                                    <div class="luckysheet-rows-h-hover" id="luckysheet-rows-h-hover"></div> 
                                                    <div id="luckysheet-rows-h-selected"></div>  
                                                    <div class="luckysheet-grdusedrange"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div> \${rowHeader}
                                                </div> 
                                            </td>  
                                            <td valign="top" class="luckysheet-paneswrapper">
                                                <div class="luckysheet-cell-loading" id="luckysheet-cell-loading">
                                                    <div class="luckysheet-cell-loading-inner">
                                                        <i class="fa fa-circle-o-notch fa-spin"></i>
                                                        <span></span>
                                                    </div>
                                                </div> 
                                                <div class="luckysheet-cell-freezen"></div> 
                                                <div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-x" id="luckysheet-scrollbar-x"><div></div></div> 
                                                <div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-y" id="luckysheet-scrollbar-y"><div></div></div> 
                                                <div class="luckysheet-cell-main " id="luckysheet-cell-main">
                                                    <div id="luckysheet-formula-functionrange"></div>  
                                                    <div id="luckysheet-formula-functionrange-select" class="luckysheet-selection-copy luckysheet-formula-functionrange-select">
                                                        <div class="luckysheet-selection-copy-top luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-right luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-bottom luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-left luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-hc"></div>
                                                    </div>  
                                                    <div class="luckysheet-row-count-show luckysheet-count-show" id="luckysheet-row-count-show"></div>
                                                    <div class="luckysheet-column-count-show luckysheet-count-show" id="luckysheet-column-count-show"></div>
                                                    <div class="luckysheet-change-size-line" id="luckysheet-change-size-line"></div>  
                                                    <div class="luckysheet-cell-selected-focus" id="luckysheet-cell-selected-focus"></div>  
                                                    <div id="luckysheet-selection-copy"></div>  
                                                    <div id="luckysheet-chart-rangeShow"></div>
                                                    <div class="luckysheet-cell-selected-extend" id="luckysheet-cell-selected-extend"></div>  
                                                    <div class="luckysheet-cell-selected-move" id="luckysheet-cell-selected-move"></div>  
                                                    <div id="luckysheet-cell-selected-boxs">
                                                        <div id="luckysheet-cell-selected" class="luckysheet-cell-selected">
                                                            <div class="luckysheet-cs-inner-border"></div>
                                                            <div class="luckysheet-cs-fillhandle"></div>
                                                            <div class="luckysheet-cs-inner-border"></div>
                                                            <div class="luckysheet-cs-draghandle-top luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-bottom luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-left luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-right luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-lt"><div class="luckysheet-cs-touchhandle-btn"></div></div>
                                                            <div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-rb"><div class="luckysheet-cs-touchhandle-btn"></div></div>
                                                        </div>
                                                    </div>
                                                    <div id="luckysheet-postil-showBoxs"></div>
                                                    <div id="luckysheet-multipleRange-show"></div>  
                                                    <div id="luckysheet-dynamicArray-hightShow"></div>  
                                                    <div id="luckysheet-image-showBoxs">
                                                        <div id="luckysheet-modal-dialog-activeImage" class="luckysheet-modal-dialog" style="display:none;padding:0;position:absolute;z-index:300;">
                                                            <div class="luckysheet-modal-dialog-border" style="position:absolute;"></div> 
                                                            <div class="luckysheet-modal-dialog-content"></div>  
                                                            <div class="luckysheet-modal-dialog-resize">
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt" data-type="lt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt" data-type="mt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm" data-type="lm"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm" data-type="rm"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt" data-type="rt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb" data-type="lb"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb" data-type="mb"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb" data-type="rb"></div>
                                                            </div>
                                                            <div class="luckysheet-modal-dialog-controll">
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-crop" role="button" tabindex="0" aria-label="\u88C1\u526A" title="\u88C1\u526A">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-restore" role="button" tabindex="0" aria-label="\u6062\u590D\u539F\u56FE" title="\u6062\u590D\u539F\u56FE">
                                                                    <i class="fa fa-window-maximize" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del" role="button" tabindex="0" aria-label="\u5220\u9664" title="\u5220\u9664">
                                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div id="luckysheet-modal-dialog-cropping" class="luckysheet-modal-dialog" style="display:none;padding:0;position:absolute;z-index:300;">
                                                            <div class="cropping-mask"></div>
                                                            <div class="cropping-content"></div>
                                                            <div class="luckysheet-modal-dialog-border" style="position:absolute;"></div>
                                                            <div class="luckysheet-modal-dialog-resize">
                                                                <div class="resize-item lt" data-type="lt"></div> 
                                                                <div class="resize-item mt" data-type="mt"></div> 
                                                                <div class="resize-item lm" data-type="lm"></div> 
                                                                <div class="resize-item rm" data-type="rm"></div> 
                                                                <div class="resize-item rt" data-type="rt"></div> 
                                                                <div class="resize-item lb" data-type="lb"></div> 
                                                                <div class="resize-item mb" data-type="mb"></div> 
                                                                <div class="resize-item rb" data-type="rb"></div>
                                                            </div>
                                                            <div class="luckysheet-modal-dialog-controll">
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-crop" role="button" tabindex="0" aria-label="\u88C1\u526A" title="\u88C1\u526A">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-restore" role="button" tabindex="0" aria-label="\u6062\u590D\u539F\u56FE" title="\u6062\u590D\u539F\u56FE">
                                                                    <i class="fa fa-window-maximize" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del" role="button" tabindex="0" aria-label="\u5220\u9664" title="\u5220\u9664">
                                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="img-list"></div>
                                                        <div class="cell-date-picker">
                                                            <input id="cellDatePickerBtn" class="formulaInputFocus" readonly="readonly"/>
                                                        </div>
                                                    </div>
                                                    <div id="luckysheet-dataVerification-dropdown-btn"></div>
                                                    <div id="luckysheet-dataVerification-dropdown-List" class="luckysheet-mousedown-cancel"></div>
                                                    <div id="luckysheet-dataVerification-showHintBox" class="luckysheet-mousedown-cancel"></div>
                                                    <div class="luckysheet-cell-copy"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div>  \${flow} 
                                                </div> 
                                            </td> 
                                        </tr> 
                                    </tbody> 
                                </table> 
                            </div> 
                            <div class="luckysheet-sheet-area luckysheet-noselected-text" id="luckysheet-sheet-area">
                                <div id="luckysheet-sheet-content">
                                    <div id="luckysheet-sheets-add" class="luckysheet-sheets-add lucky-button-custom"><i class="iconfont luckysheet-iconfont-jia1"></i></div>
                                    <div id="luckysheet-sheets-m" class="luckysheet-sheets-m lucky-button-custom"><i class="iconfont luckysheet-iconfont-caidan2"></i></div>
                                    <div class="luckysheet-sheet-container" id="luckysheet-sheet-container">
                                        <div class="docs-sheet-fade docs-sheet-fade-left" style="display: none;">
                                            <div class="docs-sheet-fade3"></div>
                                            <div class="docs-sheet-fade2"></div>
                                            <div class="docs-sheet-fade1"></div>
                                        </div>
                                        <div class="docs-sheet-fade docs-sheet-fade-right" style="display: none;">
                                            <div class="docs-sheet-fade1"></div>
                                            <div class="docs-sheet-fade2"></div>
                                            <div class="docs-sheet-fade3"></div>
                                        </div>
                                        <div class="luckysheet-sheet-container-c" id="luckysheet-sheet-container-c"></div>
                                    </div>
                                    <div id="luckysheet-sheets-leftscroll" class="luckysheet-sheets-scroll lucky-button-custom"><i class="fa fa-caret-left"></i></div>
                                    <div id="luckysheet-sheets-rightscroll" class="luckysheet-sheets-scroll lucky-button-custom"><i class="fa fa-caret-right"></i></div>
                                </div>
                            </div> 
                        </div> 
                        <div class="luckysheet-stat-area"> 
                            <div class="luckysheet-sta-c">
                                <div class="luckysheet-zoom-content" id="luckysheet-zoom-content">
                                    <div class="luckysheet-zoom-minus" id="luckysheet-zoom-minus">
                                        <div class="luckysheet-zoom-minus-icon"></div>
                                    </div>
                                    <div class="luckysheet-zoom-slider" id="luckysheet-zoom-slider">
                                        <div class="luckysheet-zoom-line"></div>
                                        <div class="luckysheet-zoom-cursor" id="luckysheet-zoom-cursor"></div>
                                        <div class="luckysheet-zoom-hundred"></div>
                                    </div>
                                    <div class="luckysheet-zoom-plus" id="luckysheet-zoom-plus">
                                        <div class="luckysheet-zoom-plus-icon"></div>
                                    </div>
                                    <div class="luckysheet-zoom-ratioText" id="luckysheet-zoom-ratioText">100%</div>
                                </div>
                                <div class="luckysheet-print-viewList">
                                    <div type="viewNormal" class="luckysheet-print-viewBtn luckysheet-print-viewNormal luckysheet-print-viewBtn-active" title="${t.normalBtn}"><i class="icon iconfont luckysheet-iconfont-putong"></i></div>
                                    <div type="viewLayout" class="luckysheet-print-viewBtn luckysheet-print-viewLayout" title="${t.layoutBtn}"><i class="icon iconfont luckysheet-iconfont-yemianbuju"></i></div>
                                    <div type="viewPage" class="luckysheet-print-viewBtn luckysheet-print-viewPage" title="${t.pageBtn}"><i class="icon iconfont luckysheet-iconfont-fenyeyulan"></i></div>
                                </div>
                                <div class="luckysheet-sta-content" id="luckysheet-sta-content"></div>  
                                <!--<div class="luckysheet-bottom-content" id="luckysheet-bottom-content-show"></div> -->
                            </div> 
                        </div> 
                    </div>
                    <div id="luckysheet-copy-content" contenteditable="true"></div>
                    <input id="luckysheet-copy-btn" type="button" data-clipboard-target="luckysheet-copy-content">
                    <div id="testdpidiv" style="height: 1in; left: -100%; position: absolute; top: -100%; width: 1in;"></div>
                  </div>`},eu='<div id="luckysheet-cell-flow_${index}" class="luckysheet-cell-flow luckysheetsheetchange" style="width:${width}px;"><div class="luckysheet-cell-flow-clip"><div class="luckysheet-grdblkpush"></div>${flow}</div></div>',tu="";ru=function(){let n=Q().pivotTable;return'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleSort+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-order"> <option selected="selected" value="default">'+n.titleNoSort+'</option> <option value="asc">'+n.titleSortAsc+'</option> <option value="desc">'+n.titleSortDesc+'</option> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleSortBy+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-orderby"> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleShowSum+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-stastic"> <option  value="0">'+n.titleStasticFalse+'</option> <option value="1" selected="selected">'+n.titleStasticTrue+"</option> </select> </div> </div> </div> </div>"},nu=function(){let n=Q().pivotTable;return'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option-sumtype"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="SUM"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSUM+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNT+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTA"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNTA+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTUNIQUE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNTUNIQUE+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="AVERAGE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsAVERAGE+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MAX"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMAX+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MIN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMIN+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MEDIAN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMEDIAN+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="PRODUCT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsPRODUCT+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEV"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSTDEV+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEVP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSTDEVP+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VAR"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticslet+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VARP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsVARP+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> </div>'},Ql='<div style="${style}" id="luckysheet-sheets-item${index}" data-index="${index}" class="luckysheet-sheets-item ${active}"><span class="luckysheet-sheets-item-name" spellcheck ="false" contenteditable="false">${name}</span> <span class="luckysheet-sheets-item-menu luckysheet-mousedown-cancel"><i class="fa fa-sort-desc luckysheet-mousedown-cancel"></i></span>${colorset}</div>',iu='<div class="luckysheet-cols-h-cells luckysheetsheetchange"  id="luckysheet-cols-h-cells_${index}" style="width:${width}px;"> <div class="luckysheet-cols-h-cells-c"> <div class="luckysheet-grdblkpush"></div>${column}</div></div>',ou='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-sheet-list">${item}</div>',au='<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"  id="luckysheet-sheet-btn${index}" data-index="${index}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="${style}" ><span class="icon luckysheet-mousedown-cancel">${icon}</span>${name}</div></div>',su='<div dir="ltr"><div class="luckysheet-input-box-index" id="luckysheet-input-box-index"></div><div id="luckysheet-input-box" spellcheck="false" aria-hidden="false" class="luckysheet-input-box"><div class="luckysheet-cell-input editable" tabindex="0" role="combobox" contenteditable="true" id="luckysheet-rich-text-editor" dir="ltr" g_editable="true" aria-autocomplete="list"></div></div></div>',dt='<div id="${id}" style="${style}" class="luckysheet-modal-dialog ${addclass}" tabindex="0" role="dialog" aria-labelledby=":41e" dir="ltr"> <div class="luckysheet-modal-dialog-title luckysheet-modal-dialog-title-draggable"> <span class="luckysheet-modal-dialog-title-text" role="heading">${title}</span>	 <span class="luckysheet-modal-dialog-title-close" role="button" tabindex="0" aria-label="${close}"><i class="fa fa-times" aria-hidden="true"></i></span> </div> <div class="luckysheet-modal-dialog-content">${content}</div> <div class="luckysheet-modal-dialog-buttons">	 ${botton} </div></div>',cu='<div class="luckysheet-modal-dialog-mask" id="luckysheet-modal-dialog-mask"></div>';fu=function(){let n=Q().pivotTable;return`
        <div id="luckysheet-modal-dialog-slider-pivot" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot">
        <div class="luckysheet-modal-dialog-slider-title"> <span>${n.title}</span> <span id="luckysheet-modal-dialog-slider-close" title="${n.closePannel}"><i class="fa fa-times" aria-hidden="true"></i></span> </div>
        <div class="luckysheet-modal-dialog-slider-content">
            <div class="luckysheet-modal-dialog-slider-range">
                <div id="luckysheet-dialog-pivotTable-range"></div>
                <div id="luckysheet-dialog-pivotTable-range-seleted">${n.editRange}</div>
            </div>
            <div class="luckysheet-modal-dialog-slider-list-title"> ${n.tipPivotFieldSelected} <span title="${n.tipClearSelectedField}" id="luckysheet-dialog-pivotTable-clearitem">${n.btnClearSelectedField}</span></div>
            <div id="luckysheet-modal-dialog-pivotTable-list" class="luckysheet-modal-dialog-slider-list luckysheet-scrollbars"> </div>
            <div class="luckysheet-modal-dialog-slider-config-c">
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-filter">
                    <div> <span><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i> ${n.btnFilter}</span> </div>
                    <div id="luckysheet-modal-dialog-config-filter" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-row">
                    <div> <span><i class="fa fa-list-alt" aria-hidden="true"></i> ${n.titleRow}</span> </div>
                    <div id="luckysheet-modal-dialog-config-row" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-column">
                    <div> <span><i class="fa fa-indent" aria-hidden="true"></i> ${n.titleColumn}</span> </div>
                    <div id="luckysheet-modal-dialog-config-column" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-value">
                    <div> <span><i class="fa fa-cube" aria-hidden="true"></i> ${n.titleValue}</span> <span style="float: right;margin-right: 10px;display:none;" id="luckysheetpivottablevaluecolrowshow"><label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="${n.tipShowColumn}" for="luckysheetpivottablevaluecolrow">${n.titleColumn}</label> <input type="radio" checked="checked" value="1" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow" /> <label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="${n.tipShowRow}" for="luckysheetpivottablevaluecolrow1">${n.titleRow}</label> <input type="radio" value="0" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow1" /></span></div>
                    <div id="luckysheet-modal-dialog-config-value" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
            </div>
        </div>
        </div>
        `};du='<div class="luckysheet-chart-point-config"> <div class="luckysheet-chart-point-config-set"> <div class="luckysheet-chart-point-config-left"> <div class="luckysheet-chart-point-config-left-top"> <div class="luckysheet-chart-point-searchcondition"> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 0px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u9009\u62E9\u7EF4\u5EA6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u7EF4\u5EA6\u9009\u62E9" name="luckysheetpointconfigsearchdim" id="luckysheetpointconfigsearchdim"> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 3px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;">\u6392\u5E8F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="\u65E0\u6392\u5E8F" for="luckysheetpointconfigsearchorderno">\u65E0\u6392\u5E8F</label> <input type="radio" checked="checked" value="0" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderno"> <label data-tips="\u5347\u5E8F" for="luckysheetpointconfigsearchorderasc">\u5347\u5E8F</label> <input type="radio" value="1" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderasc"> <label data-tips="\u964D\u5E8F" for="luckysheetpointconfigsearchorderdesc">\u964D\u5E8F</label> <input type="radio" value="2" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderdesc"> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 5px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:90%;text-align: left;"> <select data-width="70" data-tips="\u6309\u7167\u4EC0\u4E48\u65B9\u5F0F\u67E5\u8BE2" name="luckysheetpointconfigsearchtype" id="luckysheetpointconfigsearchtype"> <option value="0" selected="selected">\u6309\u7167\u540D\u79F0</option> <option value="1">\u6309\u6392\u5E8F\u524D%</option> </select> <input data-tips="\u67E5\u8BE2\u5173\u4E8E\u70B9\u7684\u5173\u952E\u5B57" id="luckysheetpointconfigsearchcontent" type="text" class="luckysheet-datavisual-config-input-no" style="width:40%;" placeholder="\u67E5\u8BE2\u5185\u5BB9" /> <button id="luckysheetpointconfigsearchcomfirm" class="btn btn-primary luckysheet-model-conform-btn">\u67E5\u8BE2</button> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-left-mid"> <span id="luckysheet-chart-point-btn-all" class="luckysheet-mousedown-cancel">\u5168\u9009</span> - <span id="luckysheet-chart-point-btn-clear" class="luckysheet-mousedown-cancel">\u6E05\u9664</span> - <span id="luckysheet-chart-point-btn-contra" class="luckysheet-mousedown-cancel">\u53CD\u9009</span><span style="text-decoration:none;color:#8D8D8D;float:right;margin-right:40px;cursor:default;" class="luckysheet-mousedown-cancel">\u53EF\u4EE5\u76F4\u63A5\u6846\u9009\u6570\u636E\u70B9</span> </div> <div class="luckysheet-chart-point-config-left-bottom"> <div class="luckysheet-chart-point-searchitem-c luckysheet-noselected-text">  </div> </div> </div> <div class="luckysheet-chart-point-config-right"> <div class="luckysheet-chart-point-itemconfig"> <div class="luckysheet-datavisual-content-row" style="font-size: 16px;font-weight: bold;"> \u6570\u636E\u70B9\u8BBE\u7F6E </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u989C\u8272</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="\u989C\u8272" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstylecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="color" /> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u5927\u5C0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleallsymbolsizeslider" data-tips="\u70B9\u5927\u5C0F\u8BBE\u7F6E" name="scattersingleallsymbolsize" id="scattersingleallsymbolsize" data-width="50" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize"> <option value="4" selected="selected">4px</option> <option value="6">6px</option> <option value="8">8px</option> <option value="10">10px</option> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u5927\u5C0F" id="scattersingleallsymbolsizeslider" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="1" data-max="50" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u5927\u5C0F" data-sliderid="scattersingleallsymbolsizeslider" id="scattersingleallsymbolsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleallsymbolsizesliderdiy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u5F62\u72B6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u70B9\u7C7B\u578B\u8BBE\u7F6E" data-width="70" name="scattersingleallsymboltype" id="scattersingleallsymboltype" data-bigclass="scattersingle" data-attr="all" data-func="symboltype"> <option value="emptyCircle" selected="selected">\u7A7A\u5FC3\u5706</option> <option value="circle">\u5706\u5F62</option> <option value="emptyRectangle">\u7A7A\u5FC3\u77E9\u5F62</option> <option value="rect">\u77E9\u5F62</option> <option value="roundRect">\u5706\u89D2\u77E9\u5F62</option> <option value="emptyTriangle">\u7A7A\u5FC3\u4E09\u89D2</option> <option value="triangle">\u4E09\u89D2\u5F62</option> <option value="emptyDiamond">\u7A7A\u5FC3\u83F1\u5F62</option> <option value="diamond">\u83F1\u5F62</option> <option value="droplet">\u6C34\u6EF4</option> <option value="pin">\u6807\u6CE8</option> <option value="arrow">\u7BAD\u5934</option> <option value="heart">\u5FC3\u5F62</option> <option value="star">\u661F\u661F</option> </select> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u7C97\u7EC6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleitemstyleborderwidthslider" data-tips="\u70B9\u8FB9\u6846\u7C97\u7EC6" name="scattersingleitemstyleborderwidth" id="scattersingleitemstyleborderwidth" data-width="50" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth"><option value="0" selected="selected">\u65E0</option> <option value="1">1px</option> <option value="2">2px</option> <option value="3">3px</option> <option value="4">4px</option> <option value="5">5px</option> <option value="6">6px</option> <option value="7">7px</option> <option value="8">8px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u8FB9\u6846\u7C97\u7EC6" id="scattersingleitemstyleborderwidthslider" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u8FB9\u6846\u7C97\u7EC6" data-sliderid="scattersingleitemstyleborderwidthslider" id="scattersingleitemstyleborderwidthsliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleitemstyleborderwidthsliderdiy">%</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u6837\u5F0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u70B9\u8FB9\u6846\u7C7B\u578B\u8BBE\u7F6E" data-width="50" name="scattersingleitemstyleborderlinetype" id="scattersingleitemstyleborderlinetype" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinetype"> <option value="solid" selected="selected">\u5B9E\u7EBF</option> <option value="dashed">\u865A\u7EBF</option> <option value="dotted">\u70B9\u7EBF</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u989C\u8272</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="\u70B9\u8FB9\u6846\u989C\u8272" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstyleborderlinecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinecolor" /> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"><i class="fa fa-th-large" aria-hidden="true"></i> \u6587\u5B57\u6807\u7B7E</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="\u663E\u793A\u6570\u636E\u70B9\u7684\u6807\u7B7E" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow">\u663E\u793A</label> <input type="radio" checked="checked" value="1" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> <label data-tips="\u9690\u85CF\u6570\u636E\u70B9\u7684\u6807\u7B7E" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow1">\u9690\u85CF</label> <input type="radio" value="0" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow1" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> </div> </div> <div class="luckysheet-datavisual-content-row" style="height:auto;line-height: initial;margin-left:auto;" showfor="scattersinglelabellabelshow1" hidefor="scattersinglelabellabelshow"> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;">\u6570\u503C\u6BD4\u4F8B</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="\u523B\u5EA6\u6570\u503C\u653E\u5927\u6BD4\u4F8B" name="scattersinglelabelformatratio" id="scattersinglelabelformatratio" data-bigclass="scattersingle" data-attr="label" data-func="formatratio"> <option value="0.01">\u4E58\u4EE5100</option> <option value="0.1">\u4E58\u4EE510</option> <option value="1" selected="selected">\u9ED8\u8BA4</option> <option value="10">\u9664\u4EE510</option> <option value="100">\u9664\u4EE5100</option> <option value="1000">\u9664\u4EE51000</option> <option value="10000">\u9664\u4EE51\u4E07</option> <option value="100000">\u9664\u4EE510\u4E07</option> <option value="1000000">\u9664\u4EE5\u4E00\u767E\u4E07</option> <option value="10000000">\u9664\u4EE5\u4E00\u5343\u4E07</option> <option value="100000000">\u9664\u4EE5\u4E00\u4EBF</option> <option value="1000000000">\u9664\u4EE5\u5341\u4EBF</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;white-space: nowrap;">\u5C0F\u6570\u4F4D\u6570</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="\u6570\u503C\u5C0F\u6570\u70B9\u4F4D\u6570" name="scattersinglelabelfloatlen" id="scattersinglelabelfloatlen" data-bigclass="scattersingle" data-attr="label" data-func="floatlen"> <option value="auto" selected="selected">\u81EA\u52A8\u663E\u793A</option> <option value="0">\u6574\u6570</option> <option value="1">1\u4F4D\u5C0F\u6570</option> <option value="2">2\u4F4D\u5C0F\u6570</option> <option value="3">3\u4F4D\u5C0F\u6570</option> <option value="4">4\u4F4D\u5C0F\u6570</option> <option value="5">5\u4F4D\u5C0F\u6570</option> <option value="6">6\u4F4D\u5C0F\u6570</option> <option value="7">7\u4F4D\u5C0F\u6570</option> <option value="8">8\u4F4D\u5C0F\u6570</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:20%;">\u6807\u7B7E\u683C\u5F0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:70%;"> <select data-sliderdiy="scattersinglelabelcontentformatslider" data-tips="\u6807\u7B7E\u663E\u793A\u683C\u5F0F" name="scattersinglelabelcontentformat" id="scattersinglelabelcontentformat" data-bigclass="scattersingle" data-attr="label" data-func="contentformat"> <option value="default" selected="selected">\u9ED8\u8BA4</option> <option value="1">\u4EC5\u6570\u636E\u540D</option> <option value="2">\u6570\u636E\u540D+2\u7EF4\u6570\u503C</option> <option value="5">\u6570\u636E\u540D+\u5168\u90E8\u6570\u503C</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div style="display:none;"> <div class="luckysheet-datavisual-content-row" id="scattersinglelabelcontentformatslider"> <div style="text-align:center; width:60px; display:inline-block;">\u6570\u636E\u540D\u79F0</div> <label data-tips="\u662F\u5426\u663E\u793A\u6570\u636E\u540D" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow" for="scattersinglelabeldatalabelshow" style="font-weight:bold;"><i class="fa fa-eye" aria-hidden="true"></i></label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelshow" id="scattersinglelabeldatalabelshow" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow"> <input data-tips="\u663E\u793A\u5728\u6570\u636E\u540D\u524D\u90E8\u6587\u5B57" placeholder="\u524D\u7F00" id="scattersinglelabeldatalabelprefix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelprefix" /> <input data-tips="\u663E\u793A\u5728\u6570\u636E\u540D\u5C3E\u90E8\u6587\u5B57" placeholder="\u540E\u7F00" id="scattersinglelabeldatalabelsuffix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelsuffix" /> <label data-tips="\u662F\u5426\u5728\u6570\u636E\u540D\u540E\u6362\u884C" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline" for="scattersinglelabeldatalabelline" style="font-weight:bold;">\u6362\u884C</label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelline" id="scattersinglelabeldatalabelline" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline"> </div> </div> <div class="luckysheet-datavisual-content-row" > <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u6807\u7B7E\u4F4D\u7F6E</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersinglelabellabelplaceslider" data-tips="\u6807\u7B7E\u8DDD\u79BB\u56FE\u5F62\u4F4D\u7F6E" data-width="70" name="scattersinglelabellabelplace" id="scattersinglelabellabelplace" data-bigclass="scattersingle" data-attr="label" data-func="labelplace"> <option value="top" selected="selected">\u9876\u7AEF</option> <option value="left">\u5DE6\u4FA7</option> <option value="right">\u53F3\u4FA7</option> <option value="bottom">\u5E95\u90E8</option> <option value="inside">\u5185\u90E8\u5C45\u4E2D</option> <option value="diy">\u81EA\u5B9A\u4E49</option> <option value="insideLeft">\u5185\u90E8\u5DE6\u4FA7</option> <option value="insideRight">\u5185\u90E8\u53F3\u4FA7</option> <option value="insideTop">\u5185\u90E8\u9876\u7AEF</option> <option value="insideBottom">\u5185\u90E8\u5E95\u7AEF</option> <option value="insideTopLeft">\u5185\u90E8\u5DE6\u4E0A</option> <option value="insideBottomLeft">\u5185\u90E8\u5DE6\u4E0B</option> <option value="insideTopRight">\u5185\u90E8\u53F3\u4E0A</option> <option value="insideBottomRight">\u5185\u90E8\u53F3\u4E0B</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;height:65px;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u6587\u672C\u6C34\u5E73\u4F4D\u7F6E" id="scattersinglelabellabelplaceslider" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u6587\u672C\u6C34\u5E73\u4F4D\u7F6E" data-sliderid="scattersinglelabellabelplaceslider" id="scattersinglelabellabelplacesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplacesliderdiy">px</label> <br /> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u6587\u672C\u5782\u76F4\u4F4D\u7F6E" id="scattersinglelabellabelplaceslider1" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u6587\u672C\u5782\u76F4\u4F4D\u7F6E" data-sliderid="scattersinglelabellabelplaceslider1" id="scattersinglelabellabelplaceslider1diy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplaceslider1diy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <label data-tips="\u52A0\u7C97" data-bigclass="scattersingle" data-attr="label" data-func="labelbold" for="scattersinglelabellabelbold" style="font-weight:bold;"><i class="fa fa-bold" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelbold" id="scattersinglelabellabelbold" data-bigclass="scattersingle" data-attr="label" data-func="labelbold"> <label data-tips="\u659C\u4F53" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic" for="scattersinglelabellabelitalic" class="luckysheet-datavisual-content-column-italic"><i class="fa fa-italic" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelitalic" id="scattersinglelabellabelitalic" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic"> <select data-sliderdiy="scattersinglelabellabelfontsizeslider" data-width="50" data-tips="\u5B57\u4F53\u5927\u5C0F" name="scattersinglelabellabelfontsize" id="scattersinglelabellabelfontsize" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize"> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="18">18px</option> <option value="20">20px</option> <option value="22">22px</option> <option value="24">24px</option> <option value="30">30px</option> <option value="36">36px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> <input data-tips="\u5B57\u4F53\u989C\u8272" class="luckysheet-datavisual-config-color" id="scattersinglelinelabelcolor" type="text" data-bigclass="scattersingle" data-attr="label" data-func="labelcolor" /> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u5B57\u4F53\u5927\u5C0F" id="scattersinglelabellabelfontsizeslider" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u5B57\u4F53\u5927\u5C0F" data-sliderid="scattersinglelabellabelfontsizeslider" id="scattersinglelabellabelfontsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelfontsizesliderdiy">px</label> </div> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-chart"> <div id="luckysheet-chart-point-config-chart-c" class="luckysheet-chart-point-config-chart-c"> </div> </div> </div>',mu='<div id="luckysheet-tooltip-up" class="jfk-tooltip" role="tooltip" aria-hidden="true" style="left: 505px; top: 410px;"><div class="jfk-tooltip-contentId">\u7EC4\u5408\u56FE\u8868</div><div class="jfk-tooltip-arrow jfk-tooltip-arrowup" style="left: 35.5px;"><div class="jfk-tooltip-arrowimplbefore"></div><div class="jfk-tooltip-arrowimplafter"></div></div></div>';Zm=function(e){if(typeof e.image=="function")return e.image();let t=new RegExp("^(image|path)://").exec(e.image),l="";if(t!==null){let o=t[0],a=t[1],s=t.input.substring(o.length);switch(a){case"image":l=`<div class="image-type" style="background-image: url(${s});"></div>`;break;case"path":let u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttribute("class","path-type"),u.setAttribute("viewBox",e.viewBox);let h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",s),h.setAttribute("fill","currentColor"),u.appendChild(h),l=u.outerHTML;break;default:break}}return l},Ar=function(e,n){if(!e)return;let t=Km();if(n&&JSON.stringify(n)!=="{}"&&Object.assign(t,n),typeof t.enable=="boolean"&&t.enable===!1)return{el:"",show:u,close:h};let l=Zm(t),o="luckysheet-loading-"+uuid.v4(),a=`
        <div class="luckysheet-loading-content"> 
            <div class="${t.imageClass} luckysheet-loading-image">
                ${l}
            </div>
            <div class="${t.textClass} luckysheet-loading-text">
            <span>${t.text}</span>
            </div>    
        </div>`,s=document.createElement("div");s.id=o,s.className="luckysheet-loading-mask "+t.customClass,$(s).html(a),$(e).append(s);function u(){o&&$("#"+o).show()}function h(){o&&$("#"+o).hide()}return{el:s,show:u,close:h}},Gl=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],it={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:33,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,WIN:91,WIN_R:92,MENU:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145},Tl={fillStyle:"#000000",textBaseline:"middle",strokeStyle:"#dfdfdf",rowFillStyle:"#5e5e5e",textAlign:"center"},Yn=function(){return"normal normal normal "+f.defaultFontSize+"pt "+Q().fontarray[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC",  "WenQuanYi Micro Hei", sans-serif'},wi=new Image;wi.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAAGACAYAAACUS6SeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAHBbSURBVHja7J13mFxV+cc/M7OzLbvpjZBKQhISUgAhgAlVkADSRcDyky4iYAAhAmpQQtMIiqigYkV6FRHphgBBKSGBkB5IIb1sdrO72dmZ+f3xniGTzZR755a5s/t+nmefTGbuPec7Z8497ynveU9on5m3YJMuwNnAt4B9gA3A48CPgY0UyPxJUzN/MLMShxwDXAMcAmwGbgD+UlBKhzVn/+yqqwrVFwIuBL7tZnkyYwaK98yaNb/QW6uBk4DLgfHAduDfwI+ApYUmOnHiKC+0AowAfgh8EYgAvwF+AMTd1OlQ40nAtcB+QIMpzx8Cy70oT8U6YZvXn2x+tN8A44ByYE/gMmA18B9g7wB9v58AzwNfADoBA4A/m4c5KPwWuCdDef4X6KVVtF1yGPAx8IDpAFUBPYGvAguBucCRAdJ7CvAecA7QA+gKfB94DKgMiMargaeAQ0159gK+BrwNqLUoIUNzFPAw0C3L5+XmAXoZ6B+A7/ZNM3rJxDTgl2Y0UUwmAxdl+WwI8HOtou2OzwFP5+hERIAxwDPAhADoHQvcbxrvTB3PZ4HaImscDmSbmukO/F6rXWkYmgnAP4wxyUd/U/m6FPF7lQO35bnmMuCvQLSIOs/J8/npQIVW03bDPjaejWrgn8boFJPpRks2jgReKfLo+yygLMfnhwCDtPoF29CMMUam2ka6Y8wDVV2k73Uw0NvCdV9F1kOqiqQzX+WvQqfP2gsDkWlcO79nD/McFWuGoAJZk8nHAcBM8x2LwRAL1+ytVTC4hmawqeiFNHaHInPQkSJ8rxob156ILBp2LYLOkAu/kRJ8egEvFWgw+iPT0cXocJTnGSmkMxJ4zfxbDJ1WjKYSQEPTC3jBYW/qJODX+L8WMhuos3H9JDP876NVQnGZLsbIDHOQxt5mVqGTz9rrgTdtjtpmmhGOouQ1NF2MkRnmQh4XATf7/L02GyO3zcY944FZZhSnKG5QDfwLd9ZZJiBOBOU+f4evAAtsjt5eIVhec0oADU21qdDjXMxnKnCJz99tJuIpt97GPcOA14HRWjUUh5QDTyAL0W5xFPAn/J2OXoV4k75j455aZMr9ZK0GSiZDE0XWVQ7zIK+7kI2efvKO+S6f2LinnzFSB2v1UAokAvwNONaDtM82z5KfbDBG7lUb91Qi+2z+T6uDkm5oQsAfkSknrx6+P5kK6ycLkTWYj2zc0x14EYkqoCh2CCGbcL/sYR6XIDve/WQbsu/rKZvP/B+BKVotOjbpHiW/RNx9vZ5OeByZv32vwDQmG51DsOdJYne/TCdk09xXgUcdfN9DkE2urwGbXCjDLsDvEG+5rcCTSASENVqdA8HtwAU+5HOjGWn8psD7RxmDNRZ7TgZ2p+1CyMbjzkZzoR3izyGOSf8DVrrUFv0S2cvWgqyl3Qgs0SrsnaH5IfAdn/LsgrgTH2rzR031FC/ysXzKzSjsBex5sQGci2wa7ZXWIzzZ5vRDW6oR76NJ5v9VprE4wxie/2qVLirXIaFQ/OIu03l52OZ93wTuxd/NytOQdZv/2bzvGMRzNeWY1Aqch2y2djLqvK9Nx/prSKidc8wzprhI2PxoN/qcby/Tg7CzN+BbPhuZ9JHNWTbvmW4qcvr362xGH/sXqCOCrJ9NylKezwB9tUoXjfPM7+4nEdPg2pmOHoXE1itGRIyLbV7/VdNODGvTOXY6xf8rMs/e1AAPoc5Anhia64uU9zDsxSD6VhHL6ds2e2DX5RjNPYd9t/GQeThOymO8r9cqXTSKVfblyNRuZ4vXX4D/LtLpowarcdGGmPYhksXAPkhh671T8zzPVfi/HaNDGJo9LF77EWAlhvetNvK342s/oojlZGe387UWRnN2A4/ebNHQnqpVumhYfY5WIfu18vFzZO3ACt2QfWBW2KeIZVSB9ZhjV5A7MnQVst5rZ3PoNy0akckUL3xWuzU0b1h8OI5FNkLm4zc2jI2dDZUbi1hOG2xce6iFawYg61TdLVx7iemFWaGzVumi8YbFenQcsMLCtS8jrsxWz3tpKIHnCGCLxeusRK7ugkytWYl1dpIZIVmJUhLFXhgrxYKhud3Cw3GUMTZWuQ5ZuM/HEzbSfLqI5fSkjWuten+Nwto5GVNt5P2KVumike8EwTrEYeNDG2k+jkQZz8cyrHtxPlHEMnoLObfKTYPUC2ubYi/Cusfc+9jb6K1YMDTP5xhO1plh5GKb6SYRL7an8/Ss7Cye/gg5LMpvmhCPGatML9JvuQR/3GqVzLyU47dvBE6jMK/A35B9zS/1rH3X/GvV0DxVpDK6zsa1P8H61KHbsxdnaHV239CALGSex65TRNsQd793Ckw7bob+r2X5MU8E1tqsABOQHdfNPpbRbJvTDffZNExuPRyTsTfFp7jPDchO+LVtjMyZyFSYk9HS3VmesSuw546bRDaT3oi/02hbsrQF2XgT2SIQ91FjI/AldC+N66Rv2PwjcpLeoUjI/FkuVMTUD/d7Y1i24GyD4Xrg66bn3gfrIcwxUxDftZnfJxTmUn2jGdJf6sNvmBp16sMRDP6CuKEfjBzP/KbNDlWu+rsNcQqJIGGSbkKmo+wSM52hn5jnyM5xzIcj0+J2PNe2m05nzKbOvyPrML/24XdrQQKIvqVV2FtDkyrsVz1oCN0Ox7EDawuqIIt/PynAyHyALNyudtAwdMXbaAstZkrmHa3KgSJms/dudSRyHfamn6zMOnxq4/pTTaNvx8hsAk5w0ID/BnGaucnD3yuJzOg8o1XXG9r7oVoRJFyL3T0Os5BgnKtdqLxeOTHETfovazVWfOAi4BGbo5+V5jlyOkqYDvzCw+92HTKbo6ihsU3Kz/58m/c9jbhyb3FBQwvZ16mccpk+HIpP/BCJJmAnztl84PNY23tnhSke1fefYW/vn6KG5jO6IN50dsNU/AGZimpyUUtqnWqei2neSuHBFBXFKiHECcFuiKo3kVBJK13UkkQ2XLo5Q3A/cI3+zGpoCuVeYGIBw/ML8cbLpQ44GncW7H+Hu/P0ipKNb2Mv/BLIOscXsLa52y6tZobgPy6k9SIy9ZzUn1kNTaF80ca1CeByxDXVy0q3AZmSW+UgjaeRSAH6cCh+MNnm9X9CHAYaPdTUiERBn+sgjbdMGi36EwfT0Fhp4BIB+F5Wp75akLDgfp1YuBw4nsLOpXkDeyFJFMUp221ce5sZIbT6oKvOjJoKmSFYgkxlN+rPG1xDk8+luIlgbBq0Emaj3jT6D/msbR7i7tlo857j9eFoN6x04VnzAysRBJLIQv1Un0fahcwQrEK2LOjG5oAbmnxeH48he1yKzfQ8lWkdEjn6pSLpewtxVGix+HAcj/2D15Tg8mCekf/7uOs84kTnm3lmBL4G3FkkfXZmCOrMtUu1+vlPmc3r/4UsRl+Y5Ue/MiDfa7UZNfyT3Q9XW4as4RR7J/1LyE7k+5Aw722JmYf8Apyt6yjBYw4Su+8nGT7bioSxCQIJJAzVv9j9wL4G4HTEu7OYzEPWkv6BRDloS9xcc4mbxnvWrPmB+IEmThxVEhW+EGeAi82PNtf0aFYju4UPCtiQ9H/AOGT9ZRUyrfcY4tsflHAtTyIhzi/NUJ79kHAfi1HaIzchMdBmI7H7NpsRxEFmRBMU1iMenFORM6l2GM2HB8DIpD/rQ0x5vmnKcxMyA7M3sJ/RrJTIiAZkHva3WDsGoNisQTzKLg+wxjpjWH6t1bFDUY1sgEyav4TpfScCqLUJWey/LcDl2YRELnikBH77k5EDEsebkeG/KF50en8MzfxJU/WRd4MZM7QMFKschhy/nD6tW4XExTsL2U1/BR3wfKHUVFCxp6Y8nJK6po3BrgK+gawfTQIW6IimKI9kM4rSjvgcsh+qS5bPI8AYZOPjUbgYTXjixFFWGvAIsmbY3fzb9nWuz3Yga7h3k8VrzmEDPhwYbUYBb2L9VNFUg/4dY8hHmbZvCTKd/jNkbcxrRpL97K+eSJifw9XQKIrihH2AZ3MYmXSqEWeWI/HOA60PEl7mc0APYzScHAdebXrs1yBrjlchO/Cd0h/4K3BE2nv1yHTTneR3q+6OBJ8dl6Hhv96MJCfhvdPN2eSOF3cYMJBguLa7a2hGvVb8eHLtYvruqquCo0Wn8YLIQGTxvJeNe3oYw3SIB41gZyRK+TCPvu9Y4DkkUsA/HKTTAwlKO7jN+7XAz5HF/kvzGJvpGYxMOoMR54xvelwHBlu4ZkB7NDRhff4VxXN6Ie7s/Qvszb9s00BZ4bseGpkUEeTQw04O0rg+TwN9CRIMN9dIYYKFfD7nR8fewjWh9vgAhB1WgM3m73qUFF8CPkRCcSR9+ms1eZ6kxR84uhgj46RR39uMCjq5qOsMn75/byQieqGcbuGac5GTTbMZGysLvT20qgbP0HzJDDVTi4A3aSP3GX9GFhsjPuYZMXn+RYs/UFQjrqtjXEhrAuJEUO6StmE+lsP3HdxrdRR4DvBwlvKxEkm6m1bXYBma/mTe8zHDg+F9KfJQB81b2ZVyJObeIS6meRQSIdmNToyf+3VGOrjXztrUaYgXWUUBhqYC8UxTAmBouiCLk/2z9JAecrHHVapcgr1z2N3ieiRqg1J8IsDfkKCPbnM27kQb93OjipN1h6dsXn8iMs1Ynfae1dNydVTjEWU2H57780wDHImc7X2JawpnVgantKzv6TkTWcD1y+g+CNyi1TkQhJCoGV/2uDOzFvixgzQeBg70qUycbIb7MbKTfqCNe44xHeITkb02dgzNp1qFizuiuQsJVJmPb2H/VL72xuv4d3rf28D56GFoQeF2JBCq19zosEP3K5wdHmYHJxHdNxrDYfdY6FQsti42DI1Th4Awspb2JSRWoRuUIxs5601Z/AUY2l4NzVSblfpOZD7ZbWqR8A2fIHPMXnlxJUwet5k8C+F+vD9y+VO8P9FQsc51wNU+5neXGT0XOso4GtnJPx8JTPk8Mv39G2QH+/eQTZfFrl+LjOH42OZ9hyAef1an7pxMnU0GFiLBO59Gotmf5fB7p6ZgLwJqjCH8OhL9e3IpPRhWps5OQjY82SFqKuwhuBcpuRqYiQSi82P6YyCyw/lYJOJzIQ/brchu8G94NB1xGnqEQFA4r4DnxCkRZMf8RmSqtpDRwkU5Pu9sjE91AMp3ObJz/kUkFI1VDjDPoJeG5qtmpBFuMxL5i2k3nnbQkcg0BVuDxMo7gBKJjZZvRDMBeIDCvNN6Il43XVzSer1PRqYt43G2T+jCAhsBK+m+hRIUirWXrNw0Op1dTrcaibc2IUBlvBIJQ/NRAd/FK0OzN7JhNJylw/2AMZB2yTeLVF2Ejo0nhmYvdvfesMu+Zujnhjvm2UUsJyd5t5iRh5vxqm435aoEhz0sXrcKCf2Sj59j7QTWVAPpZiesCvH2mhTAcl6DTKPN8SDtQgzNVezuTt3WIDyNhOSxyiVkD76ZzomzZs0vD8ohbIUYmi7IoVxu7Is50WKh5WPPIpaT07zrkLUUNw6Gewbv134U+7xh4ZoNyJn1VmJZvWw6OHGL+Te49D1SI6QvBLisNyDrS28HwNAcYOGaLsiU3xAL156ETJmFLP5WnUrh4QhnEf847uxmTnENcra4E1YXsZzcyHsp4o3iZGH1Q1OOcZSgkc+9vM50uj60kebjwGUWrlsGvOfCdyhDXOWPd7ls6jwo783GGL7uYprdC7hnq8XremFt8+73sD4D9DbWPeoCZ2juxRuPsd/hbL73gSKWk1t5v2V6qYW4Im9Czm+vQwkiL5F9zrwRmT79bwHp/ibPCDaJBMh06t6e8nA6tYTKvM6MEP9TREPzQ6xPcbo9qju7VH6otoZmKvB/HuVVaXpo/Qu8fzrezMvmYw7uLro9jf2pr1bEjXUJSpC5wTw/a9sYmdQGXiejpbszvB9HTuL8h0PdISTK8lds3vc84tJbTBrMCOzfLqRVyNTZm/i3Zy69Tn2plNqDdEPzVdxZS8lFP2Nsqgss3MOQmGp+nNewAlmQPQz39xHcanqqVvku3niuKe7zF8Q1/jAzihmKHGDmlMuMwdkCbEPW6j6P83A0IVMXv2nzvv+Y0Y9fvfnO5rvOR6ahlwLvINNHM3FnDbdQ9+b7kdM7/aDFzGyUlMdpah/NocB9+HMWwoGIO+A5BfQC6pENcVdT+lyGnLORb+PVPVl6s0pwiSGHdblJ0oyE3XYE+Tn2Y+S9ifP1Rrsd4ieREFde4mTD5q+RdZhpHupLmtHTC6X2QKQMzSP4GwzzLMTdN/8I6rBm2ilxZI71NbI7XrwCXK7ttuIRl5vRsh3eMZ2jeh91nuaDkXFqaEDCAvVCTvz0gmvN6KnkCJthc78i5D0dCT7YkalD5pcz7e5fisyZt6Ao7lNlGkY7zAO+yK4OKVY2czvtLZ7uU5m40au9zCNjcCvw01KtbGG8jTJrZWTT0VlF5iCkV+LOvhtFycQEoKuN6z9C9q5savO+lViAOxxqHe5TmfzZhTRS01vPuKjLj7iJnhua85EFNj/3ZsRNnv+nzzsgXkM3ID75683rp7VYFA+xEyx2CRJBeUOBowCnbUvYpzL5lUvptJjZCDf2+PwT/73aXKcMCTXxlD53RWc6JRS7SCl5rG4c/QTZV5dt0/LLFkYcTj2kluB9nMMluOuq3Ygcq5JrDRYL5XYm7WD6vEyfN5eYMUPLQCklliFhUXKFmlllPs91FsxU05B+PsvnryOL2E54AjjDw7JIIjvy3R411CHR319DTiC2a/j89Ozz1tDMnzRVHzlF8Rcrh3j5sVfsXNMIDs6i8RjybwqsQ/YMnYl4h40w7y9FTvF8GDnfyQkPIftUDvGgDLYi3ndPelTGaxEvvVexvtdnFeJl127WaHVEoyj+86DpQWdbe3gfd6N952rQPocccfBlJGrHKmRT9XRkvdAKCfOdHvRIZxyZhrrNGLVo2mchcjs1VJM5uvJyxJPrYazHKyuUJcbYvEb+Y1NyeaKWrqEZ9dqtgRCiIyufuOqqYOnpmFOOc4AfAT/J0sP200lmE+LheGVQCidL2Pst5D6kzRMNEyeOcivJecg02jNkjorfYurFFW52MoJyhEDpjGhmVhY3//a7cVQpDjchi89XIgvdjUjssB8Ci7V42iX/RaYpT0M2dY4HtgP/An6A/aOqS2dEU8A9XZAd7d9CjkjdYIbaP0aOhu3YtF+DGEJO9fy2/u6uUI1ETE6avwQyRZTQonHEPsZYH2PK91dIWJigHK3RiETJLoWDC7+JbEAdbUa+T5myXG83IbuG5mTgj+waqmFPI+ZiYDZwgY89sj2Rk0ArkXnaKvOXel1ptKa/rmxzTRVyBvd7wJ3I/pXt+rzuxm/bTF2kfvcTkc1/urnUOocjYZ/Sp1CqkMC2ZyF7zK5AQhAp1jkN2dyY3tu7ARiFxFbc4VZGqSm1Yk9NuTi115Y7TR1M0Q85+fN4YCI215DsGJqjkIWzbDHRypGFupcR7xAvF7MipuE7H/cCgR4E/N00mBfizt6iEOLZc4Xpae1AFgSnYf9skqh5YHoCnwKLfOylTSb7/PgQJDDj17Wds8SBpm51yVG3xyBz+UfhfZTersjR4HYX2TtlaQuWIlGmH0GiTPvFOPP8VmQxQM8iUY/9iNE2wjyrDUgAUjunn1aZ9uJMk0YYcSZ4xDxnfpxHdVgbI5POIKPjTDsJWt1xOwHZvW4l8GZ/86N28bAgrjYjJy+iTfcCHjOF7dTI3IdEqh5rHuIa02i/bvRboQb4mTGAc5C9D/ONsbkO66fxOeGcPJ+fTu5z05Wd0zr/tPhsVJtrx3ioJ2Ke1QtN47hX2t8QMwOQ7S9bWzAUOdtmKd7ufWnLLXnq4FHI4XQ9PNTQ34xCFyDTys+b5/S7Fu/vaTqgtwD7me8TZed04DvAHj6UZb4D1U7B5hHSVgzNGGNk7JwhM8ZU4GqPHg6vPWQipnF32jh/M8dI8l5knSsX5UhI8KsyNE69ERfUe32oeIMs9MJ6qR3JW4bP2yynHuY56u+Rpq/gzd6UVKP5EOJp5TVVFvM50MwoeFGePUzaR7R5vxa4A1krytcxvhnYN8fnQ43B8ZoBFmZXbJVhPkMz2FT0QhqRQ5EjkN3uce9jGlk/pjic9B7yGZEQcoZFrgOTTgUOzpPOuRYqhlNCLtSljkxvMxItpIHrj0xHe2HIvT62OYwcVOg1lTbamX2AWbgfqPN6Mm98TXEpcrZUrufkIAv5HBSQOl1utyJko5fpTTux/ieZxtTNKa4ePhbmjx0aRCsN+C/JfubMEItpDEIJKl2MkRnmII29zaxCJ5e1DfXh++9rsR47YQty0qad0eVMZHrKLawcZXAhEiE6m1GMWUijWyk+BOEcD8cLDh+OFBfh7hHRW30sHyfHGFhdAAwBvyDzdGCTxTRqUYJINbJHwo11lgmIR6SbBxT6FRH4Uh/yOANxkLFKHyQszOEu5W+1Q/41xGkhmsVg5qN7ezE01aZCj3Mxn6mIa5wbzMe/0/2cjMRetHn9DHY/otpqQL1qlKBRjgSDdHMN5CjgT7g3Hb3Ip7I414c8PkEceN61cU9n0xH4kgv52/GyPZPMpxpbMTRd8McByFNDE0XWVQ7zIK+7yO/NYIUY8DufysdJ5NRbsO+K+FNjlFNY3c+jhiZYRJD9HF4shJ9tniU3eMyn8vBrF/M6JBjlf2zcU4V4iH3NYd52t0OcbO6psmlooASnz8Jteu9/RNZVvHr4/mR6ZU6ZhvinB9nQLEWm3pps3ncLO0/Ts7oPoUbb9sAQQhZ9vXTtvQR3vI8eR6aPvGaLj+W/DdlC8A8b95QBfyH7WqkVfoz9vYPHsatH76b2amjSN2z+EtmZ7PV0wuOm1/Geg3TqETfCVMTZHcYo1JmGvRHx5jrZhUrrhOcQn/MnbI46ppvfZpbF62td+F0OMRX4NRsVPt8Q/3dI5ICtSBj2nwBr2rmhuR3ZSOw1NyJ7q37jII2EeUamI8c0p/ah1LEzFE4lEoLECZsd3LsvEnVkLPacIexGPUmtldZQ2JryRuTsHrvehUcD/0aiU/s1ooki3qw9gTfMSNApnZGtFieZ+vOPdOOb+jF+SG43WzfpYgr2UPKfdZGLFjM9kYkfuWBkwJ1QNM+bwn/aprG5EXEtt4KTqbNzkfDrvdKM68kOe7rVpqJNSpueuMT08k/EflSEUuE6dl9n85K7TKfgYYedqcty/I5PFtHQnGdGh34G//0JslH2/QLuXcjO6CiDbdw30bQTj/hgaL6C7Ozvl9bGnWmjrcnWUX2CnbNVVYiH3anGgP43bH7MG31+IHshi3Be7A24HplacwO3Trd7yRS43fSO99jQTEeiF/Rq0zN5Eti/wDQjyDrfpCy/+zNA33ZoZM7D/6O4I8BfcWc6ui01pvE5xoW0Cpk6G10EIwOynODEcWk54slmtxM9AevbKQo1NNcgZwb1S3uvkzFwBzuog/dnqYM9U8972DTMxWAYEqrCTaYi4dfdws1jVF9F5o4bPGoU7HIMO9eCMo06n8O+e3sI2QF9Up5ORrHqnJcU6zuVA4+aDoKbsw7P457rbyGG5iKKd4zJN3G2Z2mFKbuPCpgJsEIhLs4HI+u/2fJ9jsLc8O8i93pkL+AHYazvfv8IcS3Oh52T1I50sXJcnaMgnUwruMlMY2zcds8uZI0m3znuvcwUgJ355pvJHxEBvN+RXgysPkersLb29nNkethqD3e8S9+juxmBu+mWXYih2aeIv2UFzjdBf4qsI8/1QF8hI5qryb1Bv5DOpdVtKyeHkcUgKw/HsViba/2NDWPjVkM+BXENdhsvjguYZYyNm1FYC5k6O9TCNQOQ9TQrPahL2NU1OxedaX9YeY42IJ5GKyxc+zLiymw1QrcbI+XeJt8DXC6bQgzNpiL/nm7kvx6ZUnrXZW3dPHre+yFLGr0tPu9WO/a9w4iXTL6H4yjsue5dh4Txz8cTLhT6Fab3ZwerD2+jR5X4ddPguGVsCjE0Vr2/Rpk/K70bq7THc1byPXR1iCPEhzbSfJzsC/XpLMOZF2dqRPYq7m7UdmJonijib/km7nhipQzWUbi7HaMQQ7PW4nXDkDiPVgyNVf4RRuZib87xcEzG/kFmScSL7ekc12zE+eLpZUhkVDvUYX0+vdHDyjzbjBK3upBWIWs004v0EC/B+hEJpcRLOcq0ETkTpRBvu9+QfS0t9ax9F2fhZAYaI2N3usrq81HI6OARZCG5GHzf5fTqgC8iWweKZWhuxr+QQ+ksBS5Pzdldj3jNpJ+SuA3ZA/JOgRnEzdD/tSyjpBNtWNlsFvUX2AsTU4csgltdpHM6tRdBDgSbgUwnXofENLsI2czZz7zvtAIUskZzH+5551llg+m4tNfTOG8A/q9NvW5E3EdfdjhaujvLM3YF9jYntmUIspPebjTj/2F902ghI5qkMc434e802mbTCXSbejOL8aILaRViaB5Fjhvx+3k/Dlid7tXxR8RN7VDkZL1ZOD8LvhGJI/R7Y1i24M7GvQvMg2fXyBxnHpBzLN7jZI0mjIT4ONmHH7RQ9+YbkUV/P4IepkbHS2jf/AVx705tiHvTYYcqffS+DXG2iCCOJTfh7ATO4abhs3vMxCzzPFsdmRY6ao8BPzAdoj7YC2VzpBkNRm3csx3nRz53ZvcNsFvTOpNuhOMp1L35DvO8f9+H5yDV9i+B3d0HW3A/JEUdsoPfLQ4yFciOkalH9qTMtjkCcDJ19nWfjIwTQ5NqwLribVSIFtM7fYeOQczFaZL0Hv515J5Gs0NPJEK7XSPzimlAttto8JyGoIkjXlxWOcN0RO0YmU3IXjcnhjuMxC87wuP65eSolOvM836Jx8/7yellWYqHVV2PPf/6BmNk3iigYXZiaM7zsUycxDpLGq1Pe6QtbtJ/GSVI/ABZm7HDv81IJjXSt7qfw89YZ99GNiXaOVr8E2R3/lsO8z7NByPjZEST3rl80CNtqfbkxbYWuNSws/em0fRSZhU4AnCyRrOfj2VS5UIP5GwPeuGpSn2/tuuB4xSb1z+NbMRN73wFzdDcaEYydsLofwB8HljgQv6n+/Q9dzi8P46sJb7ggbZrMz3vpWhorM5xNpqRzEwHIwAnazRVPpbJHBfSSM2pznNR1604C/qoeEc/G9c+ikx/txTQs64HWj3+LqmI2XYjWs9CYpOtdknHCJ9+u/tcSKPFdDbecvl5z7ifsRQNjZWGsNH0vv7j0Ag4MTQrfSwTt85lr0MWMd1YsP8d7q0nKO5jdc3jfsRDMlOUAiuGxg+PscsRT067I7RjXR5thXz67e52KZ1UZ9yNzuX9uZ73UjQ0v87zeZOx1C/luMbK5rbN2Ntc15YXfSqPjTiLvNqWDeYBXOUgjaeRxcYkSlCxcujZH5AplmwbnK0cK+3HtJndEzL/gKynNLmsww+Pyg+Aj11Mb7MxNssdpPFPZF0m6ZahsdJwJHwYNv4xxzD9FPLPPf6N3HsPms0D5sQZ4Kd4u+ET0wCcj/uBOpebyldIb/QN7IVOUYrD9DwN1m+QUO+5fkcr0y7/8+G71Nn83hd6VD+9jmaQwJu9MKkQY4Xsb3sL2SeWMy6fXUOTL0ZTE95vxkuaxvUbSCiXTUbXn5AF+OctNtCnGGPyH2Og4ubBuxeJYup0V/Ji0+Bu9qgc3jaVwytvsXnYP9pgnjFQjSi5WOnCs+aUTchRDq9m6KxdieytytexvN70sLOxDH+OILHSwCeQKbYbPBxpP4Q3mz1TMxdnWmzfCh2NfcGm0V5iRpN5n3e7YbjvJ/d+i8dw7hFh1dj81fw56R38xfx5xdPIPoXhyL6FSmR9qFva667m39TrSsQrLv11F/N5Ajnk6gfY21dQKG8ha13PWpgmWWWMTB1KPh4Evpejo/c+7jpl5PrNjjT1c7QZGb9pY4S8EdnXdoVpBEchHl9LTFvwM9wJsZSPBxC35mwRp1tMx/QhH2YYjkcOEjyMXffxhMwznY1OWZ6xpUhkiEdwP5p8W+aa5/1f5PfMTdUdSwMLu4bmX8gi74VZpluu7LBNx8ysznCNuOMVZl3HYc1upvgScirffWRe/I2ZxukCnK3r7MpVVwXr950xw83U5iCnwP4kw2dbzUjbTxaZv0JoQryNbi3irxNHNmlmOlOlHjmW4iWftGzBvmNCoFoyxMPw76aDm+l5fxuZVbL8vBdysNDFSNjrS4CRxqI9ZR6cjZ59fXcbT8UeTyI7wr9qfn//fvf2y03I0b9XImfJNJppkR9iP4itIiP8CWZ09Q1gr7R26n0tHls8i5xDdZYZKY5GplqfMbMptiNbF2JoUmeJJNv0KIo1YvAH7w3dMchRq4cg6zo34O20nl3qEI+/Xwf8IQmZEfe3kWjEG5Bw+z8OoEF8BOvnxLvCxImjaMf4Prpqx+XZgMSodOUUZLuG5mTE4yt9CmVPZPf3xchC2AXaI7PNT4xhSdEJ+DMSWdfdxdTUFFD7Ndy/bTN1kaqfJ5oer6vOKu284VZKnKDUTzuG5ihkITrbonA5sgD2sumVr/JB/56mMU5fVK80hjD9db5F+Bpkb82diNtzg4+/wTfbGJl0piEB9K7A2z0pIeBck88+iEPHayZ/u2eoRJFF4Z5mOmMR/rk6Tyb7/PgQ5IC8r2vzo42jEkxDM8E0wFY2aPVH5vgm4Z0HUgj4pZkecWvT6UHIAthGMyp7yofyL0c8VHJxGRJT6lxkIc6LsrzPGLx0YzEZmc67xOLwucYYpgvYdRFxPXJu0G0+GJx8xz+cbvTt0EdfUfzDSiM9xhgZO6HoxxhjU+2R7suREzy9iGzQE3HNPMyH8j8Ya+dzfxVZZ/Aifto5bYxM247IvcgZKPkM5gvIZrK2niq9kU1y9/pQnoPyfF6FnMehKEqADM1gYzAKeTgPRfzbIy5rDgFXe1wuEWQPgNfYCe9/IhKmvavLGr5lobx/bQx7Nk41RjMX52L/7JNC6oYbnStFUXwyNL1ML7W/g/RPMo2Um8HmhjrUZJUDgT08zmM29qYXJyFuxn1c1GDlnPjUVOXlWT4fYjGNQfrIKYoamhRdjJEZ5kIeFwE3u6i5t4/l82OP099sjLGdHb/jkfDmg13SYNXxIYSstWTalGs1OGGtPnKKooYGZF3laWCci/lMxb2jQ/3cC3GWD3nMRDz61tu4ZxgS5220C/nbjTI9g92nLq3GNqvWR05R1NBEkXUVLxbC70KCTDplCf6ccZHqxfvBO6bMP7FxTz9jpA52mPct2PcO/KnpPKSwem6PGhpF6eCGJoRsxjzJo7wiSITloxymk0A25fmBn1GIFyJrMB/ZuKe7GZEc4yDfpWbkZvdsjlvYedCR1am/Gn3kFKXjkb6P5pfkjszsBuWIm+6RWDt8LBs3mxHApAAbmsmmPIcAFTbui9rMpxMSg+iryJG7hfAccmzCEzZHHdNNHZpl8fpaF+rPIcjG29dcGtl2QQLFnogEtHwSidSwRpsHRXHX0PyQ3O6rbtIFcdM9lMJPpGtEjhz+MuIyu8O8V4ccWrYdWRM6zaHWQsJyh9g9DIrXlJvR4gsUvkn2eTOafdqmsbkR6yd8Opk6OxfZ9Nkr7bc5md3PU7FDNbJHLNVhqTL15gxjeP6rTYSiuGNozsOfw4nS6YUcOXAohceeiiE7+TPxfReMDFhfe0jnWxQnTHgnZArsHgdpvIQcdvZPm0bheI8NzXR2P4+8sxl9HIVE6bVLBFmPnJSlfj4DjAXWajOhKM4II6fkFYNhuBQZtA3fwz136kKmzr5VxN/z2y6k8Soy7edFvLdC1miOyWBk0kfHz2HfDT8E/Irc65G9ivhsKEq7MzRWNyV+BMy3cJ2dEN1Huvx9pgC3u5heIYZmRBF/z5EupTPTGJt6l/UVskYz1cLo+GXsbeK92WKH4FRtIhTFHUPzhoXrViHn02+2cO1vbBgbN48mvQKJzusmhegr5pknbobAn2WMjZuBUQuZOjvEwjUDkHW/7hauvcSC8UrRWZsIRXHH0OQbAWxA5sHthP2/DmsuyE+49D2+A9zhQfkUskbzdBF/zyddTu914DgXjU0hhsaq99co8+d0hJTOK9pEKIo7huZ5sq9p1Jlerd2DzJKm8X86T89/ugvf4RLENTtkU58VCpk6+xHwcRF+yyYkTL/bzDaj2a0upFXIGs30Ij0bS5AjBRRFcUjKvfl682C1dR89Bdm1XghxJBLAc+zu2bMB+BLOPXouBO62aWTqTONlZS2nEEOzATm/ZwbiJuvXUZazKXzaLoIcFzAe8ebbhriJN6S9vhXZpOkkWkIhazT3IVNj03x8LjaYDtYGbSIUxT1DAxIV4H7E5bgrMkfvdL2h0RiU3yP7Erbg3oa48xBXXrtGZjLW5vJTxrYQ1iMnOV6ARFq2c5LpZcB3beb3CYW7VIeR83dO9qG+FerefKPpAF3qg8ZUHVmizYOiuG9oAFpwtgEu24P7ZZfT/Bqym9uOkalH9nu8ifWYa9sd6twBrLB4bcgYYLtG5gNkHWV1gRq/7pORcWJoUga4K95Gr2hB9l+9o02DonhnaEqB/YE/YO8Aq+3GyLxhs8HzK9ZZxIzOzrd53yxkL8gWhyNDv3AS6yxptNbiTTy+uEn/ZW0WFMVdSvG0weuQkCtWaTRGZlYBPWs/DE0VEv/NrpF5Glmk3+Iw//18/O2cHkXdYkajr3mg7TJk6lhRFDU0tgJpNiJrQzPbvN/J4v3bPP4uXdgZY8wOf0CmeJpc0FDl4283x4U0Uut+81zUdSuy/0tRFDU0toxEI+I1l2kvhNWNeNs9/i73AhNt3jMd8baLu6RhpY+/3QyX0qlDgqq6sWD/O7KHuFEUpYMamrkWrmk2Pf4XsnxudW3Ka0PzRRvXJoDLgRuwvg/ICi/69LttxHqUZytsQKYOVzlI42lkH1ZSmwJFCY6hsfJAJjzWfFeez1uQGFX/znGNlbNwNgMfevxdrE59tSD7XO7yQMNP8X4tKo6sQbkdqHM5sv5WyLk0byDrPXFtBhQlWIYmn6tuE95vcnsAme7IRIMxMs/lSeNhcoe/aQb+z4cG2EoInpRb9kMeaVhsGtzNHqX/thl5eBWaZx5ytEGjzXuOx98TVBWlw2LXvfl+cu9jeAzZO+I1FyFuqJcAo02D8Qqyc32BxR72Gch+nHMRl+lOyHrF86aX78eGvelGR68sn68zjajX+zqeRnbfDwd6ItEMqpCTLFOvu5p/U68rEe+99NddzOcJY8x/AHzqQzm+hThUPEt+j8RVxsjU6eOvKME0NP8yo4kLs0xjXOm6wplZI7g8aP4KJQH8xfxZ03FYc/bPnypo0/pqTr47ddBYW2OzDPgiT11q3+AdVlB5NOKOV1ixeAn4ChKypluGz2PIZt0LcLauo3jMxRdfHBgt99xzj/4gRTA0ABcjJxpegpx/sgF4CgkmuVGL1CZPXfo/Tr57HHIq6KlAD9Mz/w5PXaqnO9rjSTOy/aqpp57Xz1JpFLXxVkrF0NQg0zhHIsEX+yLOAT2R6Z8DTI/4FdNDbyjSd2qrcwgypQMyXbI8cDqfurStzkmm0fROZ67RWWlTB/za/BWDPZCp3QPwbo9SEzKdei+FxwwsFZ19kaC/JyKH25UhzjG5PEIbzAg2E0l2j0QeQyKuP4Ksm6oXYhEMzTDgWmTBONselt7mb4LpSW5HFu1vw8Jax/xJU934Lp7rdIlS0VlcZswoRdWnIFOxtT7k9SXgKiRW3VPtVOcYxP2+d5v3y8m9FtetAJ0HA2eZTt2ZqKOIq+TyOqtEdkx/iMxrd7KRbidzz4emcfQyVL7qVILAvsiaYa2PedYi3oj7tkOd5WZ00dvn3/EE3NtYrOQxNEORhdNrsRdXLFNlucakNcwD/apTCQo/ACqKkG+Fybu96TzJPDfF4EJkmk7x0NDsjxzhO97FfMYjQS33dzFN1emuTsUZRxUx7yPboc4Di6gzQqG+m0pG2q7RDEM2O/byIK8+Ju1Dcb7OoDrd1ak4p6edi+NlYbb0q6KuTyVNtVGSYQgloKo+Rpd1zXT7tIlIq+UgG7280llR1srofqsZ0WctvWrqiYQTxBNhNjTUsnBdXz78dE92tJZ5odPW1F6nUIgxkQj7lpWxRzhMp1CIeDJJXTLJikSCD1pbmR+P2wlb0kWrtDeGpgp41KNGMb2iPYYsvBUaeVh1uqtT8ZGWqggrxnRl3dBaEpHdz+3bQhWfjuhMOJ6kz9J6Bs7bSnmT/1FyOlc1ccK+7/P5oUuIRjLnf8TwBcTiEV5fOox/fjCObU1VvuvsFApxXHk5R0ajRNt+GArRExgaiXBkNMrmZJJnW1qYFYupW5nPpE+dTQPG+ZDnWJyd/6463dWp+MSGwZ14++T+rBneOaORSScRCbFmeGfePrk/GwZ38lXngYOWc9NJj3PE8IVZjUyKaCTOEcMXctNJj3PgoOW+6hwdiXBjdTXHZjIyGegeCvG1igqmVFXRORTSClkEQzMUmOJjvlMobDFbdbqrU/GJT8Z1Y8HE3sTL7IUXjJeFWTCxN5+M6+aLzi+NncP5E2dSUdZq676KslbOnziTk8bO8ccYlpXxnaoqagswGCMiEa6tqqKbGhvfDc1UsNQpcIuoydMuqtNdnYoPrN6nCyvGdHWUxooxXVm9j7fLBl8YOZ8Tx7xPoc1vCDhhzPt8YeR8N+RkXfjZOxLhm5WVjs446RkOc1lVVS4XUJ1dc9nQ1CKbB/3mLOwt+KlOd3UqPrC9WznL93NnNLJ8v25s71buic7+3TZz6n7uxG49db93GNDNcTDwjPOFFaEQ51VWFhQ7qy17hsOcWpHV03ub1l53Dc3x2Ns86BadTN5WUZ3u6lR8YNkB3UmG3ZmiSYZDLDuguyc6v7z/25SF3TlKqiyc4Iz93/ZE59HRKN1dnPI6IhqldzisFdUHQ3N0EfM/2qNrVadSdBq6l7O1r7ueWFv7VtHQ3d1RzYBumxnZd42raY7su8aNUc1ujdWR0Wjg01Qyl/PYIuY/1qNrVadSdDYMqimJdA8c7I23mNvpDotEPPEW26+sTCurD4ZmaBHzH+rRtapTKTp1fSpLIt29e6/zRKfb6Q6NRDzR2S0Uood6oHluaDoXMf/OHl2rOpWi01xbVhLp9q71Zt3b7XR7e2gMdJ3Ge0OjKIoHxMq96YHHKtxNt1N5iyc6O1U4OtV9t8WtMg8NTYa0m7UGu2toiunGt82ja1WnUnQicW+2YkRa3U23Je6NQWxpdTTy2s3jwctAPK3J3cp0h9Zgdw3N0iLmv9Sja1WnUnQqtreWRLqbt3vjje92uhsTCc9+q01J3Z/ptaGZW8T853p0repUik7N5h0lke6KzT080el2usvj3oxp6pNJNnhoxBQxNC8VMf+XPLpWdSpFp8dKb04D7rHK3XTnrBroic73Vw1wNb2F8TjbPRh5zGlt1XgzPhiaZ5Ez6f2m0eRtFdXprk7Fa0OzqtH1EP/lTXHXDdjcVQPY2lTtappbm6p532UD1grMisVcTTMJvOpymkpmQ1OPnCHuNw+YvC2PcFWnqzoVjwklkgx6f4uraQ56fwuhhLv979ZEmGfmunuixTNzx9GacN+p9d+xGPUujmr+29rKKp0288XQANwK+GnWY8BtBdynOt3VqXhM3yX1dPvUnTPpun3aRN+l3vQlZi0Zzodr+rmS1odr+jFr6d5Ok8kYIHZ7Mslfd+xwZaprUzLJQzuyrnepB6cHhmYJcIeP+d4JLC7gPtXprk7FB0a+tp5OW5ztVem0pYWRr633LHh9Evjda4ezaquzSNOrtnbjd68dTjLpeM9L1uHQ+62tPObQ2NQnk/yqqSnXmo8u23hgaEBOafTDa2kuzk+uVJ3u6VQ8piyWYOwLa+i6rrA9gF3XNTP2hTWUxbyd4mmKlfPzF77IwnV9C7p/4bq+/PyFL9IUK/e8TF+IxfhTczOFmO9PEwlub2riU50yK4qhaQJOBzZ4mN8Gk4eT1UzV6a5OxQ9j05Jg3xfXsNc7mylrSVi+Z693NrPvi2ss3+OU7S0V3PnSsTzyzoE0tlgzGI0t5TzyzoHc+dKxbG+p8K1MZ7e2cmNjI/+z6DXWnEzyj5YWbm5sZL0aGX/rf5v/LwGOQ7yX+ric1zrkvJQlLqSlOt3VqTinGcgZ7TKUhD0/qqPvknrW7VXDpv7V1PesIB7d2d+LxBLUbtxBj1WN9FnWQMTaKKbZTZ2JZIgXF4xi1tK9OXjIUsYPWMGQHhupjO5cdmyORVm+qSdzVg5k9vKhNMeibuu0tEayMZHg983NPB0Os19ZGaMjEXqGQnQxscu2JhKsTCT4MB7n7dZWmqw7EmzXKu2doQF4F5gIPIZ7Yefnmp63m42i6lQjEyTmAAdbuTASS9Bv4Tb6LZS2NFYZIV4WItKaJNocLzRv13U2x6K8umgkry4aCUBtZTMVZTF2tEapb670Wucb2DjIb30iwb9bWvi3O79lE7BQq7R7hHP0xCcAt+PMeypm0pjgUaOoOpWgcG+hN0ab41Q2tBZqZOzmXbDO+uZKNjbUFmpk7OZ9D7C5SL/lfeh0tC+GJjXMvRYYDfzeZsE3AX8w916Lt5FQVWdbrrpKa7b//Am4vwj53m/ybm86NwKnAVt91vkOMFWrs7tYCa+6GLgQmAKcCBwJjAeGAF3NNVuB5WZo/ArwDNDghsBRoWlWL10MXDg/Oc2WzlGhaZZ1znenzItanopnJIFvAP8Fvmt+Ty9ZjrjQ3409V9xg69y1k/QfYIx5Vo5G9tZUA7k8DroChfhWrzYjmVutdAJnzZofmIo3ceKodmFo2lbS9L9ElveLhjEcD1Kc3fl2SNc5wlTwY035zQKuBpZp+11SJIBfmr8eQJe2F8Sj4fDy/bqNbexafmhrNDwyGQ7tmQzJdaEkdaFEcnVZLLGgemvszSHvbX4/EsvoHlUHbPJSZ2U0Fj51/Dtj9+y69dDKaGxkWTixZziU7AKQSIbqWhPh1c2x6II1dV3ffOy9A95vjkW90AmwCsg6RL+npiYMHGgM0ThgEJDaDLQF+AR4H3j5rqam9z6IxzPF2on50JGzrNN0AtqVW5wVQzPMTNecDWSL+93b/E0ALkY8Nh5AdqsXey3hOGTaqRm4FHguYL/B54Dn0yodwKnAJOAY7C2gKsFhU3oj+9rXhnQz9e9CIFcQsPHACXW9K1kzvHYF8Dvg7kl/W77FD533fPXPtnTu3Xsdh+298DOdF9//f1v8KNx7amqs6pwAnAlwWVXVTp0NDVt8qge2dQKf6TRGqOQJ7TPzlmyfVSIbAaeQ4RAii7Qgu9Z/RI51hfmTsk+JjnrtViffr4cZFaSOON5mpgoKWmTMpbPAdZHPAS+wc8qsLRsLNjYzZmhT78cIOn/9DAHfBm7K8TvnYyvwA+DXuXq6OevnzMrA6OSwZifPkX86czxDFqbOfNNZClNn2ZwBhgJvmpGMk22+5cA1Jq1hRfh+J6UZGczrEwM0knkhTyXsaa4Zr016SVIDPAH8ykFjg7n3LuBxk6bqVJ0lRSZDsz/wusuN23hk3WF/H79b1Bi5tlxOYYuFfhsZNTalzWDTwTrZxTRPNmkOVp2qs5QNzTBkDaOPB3n1MWn7NbK5FBiZ4f0DgHNKxMiosSlNepnfa18P0t7XpN1LdarOUjQ0VcCjHn+RXsgO+SqPv1dPZF0oG9PJ7SIZJCOjxqa0iJg67mWHahgynVKmOlVnqRmaaYjbndeMxftowz/O05gPAr5TQkZGjU3pcC3iMeg1E8k8Naw6VWdgDc1QxLvML6Z4aPn3RVwJ83E90L2EjIwam+DT39Qrv7je5Kk6VWdJGJqpyOK5X0TxLszDnRaHlt2AG0rMyKixCTZXIzvX/aLa5Kk6VWfgDU0tshnTb84iy3GtDjgF2XlrlW/jrSeHF0ZGjU0wqQTOLUK+52JvzVN1dkydRTc0x5N9x7+XdMJGGHALVCCRje3ec3MJGhk1NsFjMrvu2fKLziZv1ak6A21oji5i/m7mfRmwd4EjqwNL0MiosQkWXyiR50h1dkydRTc0Y4uYv1t590FCNRRCqICRUC729tHIpBub54G9tL0vGsU09ONUp+oMuqEZWsT83cr7JofD1yNwLzTNz3w2Mil6IRGgleKwdxHzHq46VWfQDU3nIubvRt7jgfNcSOc23NkIVcyh9LHa3pd0XfYjb9XZMXUW3dCUOne69D1GuWSwikkcpSM+S2HVqTqD/nBsK2L+TvP+MnC4i3puxLkH3vNFLM8Xtb0v2brsV96qs2PqLLqhWVrE/J3kXYlMd7lJX5xvhLoa2FCEstxACYamaEcsL2Ley1Sn6gy6oZlbxPyd5H0l3px3frUxOE6M57E4P8LWrpE5EjkOVim9uuxn3qqzY+osuqF5qYj5F5r3HsD3PdJUg0yhOWEO4hTgh7FJGZkPta0vKi8XMe9XVKfqDLqheRbYXoS8G03ehXAL3p44dx6wTwkYGzUyweEfQFMR8m0GnlGdqjPohqYeeLAIeT9g8rbL54BveKytDHf2pHhpbNTIBIttwMNFyPchoE51qs6gGxpMoxrzMd8YhS3kh4Bf4M9RzCfhjkebF8ZGjUwwuQVo9TG/1gI7RKqzY+osuqFZAtzhY753AosLuO8s4FAfdf7UJaPmprFRIxNcFgJ3+ZjfXcAC1ak6S8XQgJx66YcXw1wKP2Fzms/lcyBwpktpuWFs1MgEnxuA+T7kMx9n5ympzo6ps+iGpgk4HW/3gGwweTQWcO9eFCe2z624F6zSibFRI1MaNAIn+/AcnVzgc6Q6O7bOohsakCm044B1HuS1zqS9pMD77y1SGQ0G7nMxvUKMzXo1MiXFEuSsEC8anQ0m7SWqU3WWqqEBeBeYiLvTaHNNmu86SGNCEcvpEJfTs2Ns1gNHqZEpOd4BPg984GKaH5g031GdqrPUDU3KMk9Azmlx4o0WM2lMcMES/7eI5TTbgzStGBs1MqXNYlP3Z+DMK6kV+LlJa7HqVJ2lRq6w+M3AtcDvkRha5wDVFtNtAv6OuDC7VUAXAn82lj3kU/kkgdfx7kzwlLF5EejR5rN1yAl6rhqZiy++ODCV75577ukIxqYRCWt0DzAVOBvrZ703IfvNbvWhoVGdHVNn0Q1NunW+EJiCHA52JHIGzBB2HvC1FQkuNwcJi/AM0OCy1mXApHbYEM0BDjIjv6ONcXsOuA74WAcF7Wp0cz7wXeAEM1Idl+U5eh8JbfIs/kfoVZ0dU2fRDU3bHn76XyLL+0Vj/pMbaswPmm4Qu5iP69oYxH+OOqVXQzF0zjr1/Ew6Uz2eo5FoDZ/pnPjEHxqKVKS2ytODDkZ7IxWJ40HVqTo7CqF9Zt6S75phyBTa2Vg/q2W7GfrdhoW1mfmTpmb/8KqrrH4Xz3UyY4ZjnbNOPd+RzolP/MHaWlcWrTamzjwvzw4ydaYoHZ5cI5pKZIPkFKDcZrqdgAuQmGR3Aj9C1ny8IBA6Z516vi86Z516fl6dEyeOKvnyVBSl/ZDN62wo8Kbp0ZY7SL8ccSR40/SQ3UZ1dkydiqKUuKHZH/G0Gu9iPuOBWSZtt1CdHVOnoiglbmiGIR5PfTzIq49J240erursmDoVRSlxQ1MFPAr08jC/XsBjWPcnz4Tq7Jg6FUVpB4ZmGuLf7TVjcRaFWXV2TJ2KopS4oRmKeBn5xRQKm0pRnR1Tp6Io7cDQTAWiPuYbNXnaRXV2TJ2KopS4oalFNuX5zVkmb6uozo6pU1GUdmBojsf6zm836WTytorq7Jg6FUVpB4bm6CLmf7RH16rO9qNTUZR2YGjGFjH/sR5dqzrbj05FUdqBoRlaxPyHenSt6mw/OhVFaQeGpnMR8+/s0bWqs/3oVBSlHRgaRVEURfHU0BTzJLdtHl2rOtuPTkVR2oGhWVrE/Jd6dK3qbD86FUVpB4ZmbhHzn+vRtaqz/ehUFKUdGJqXipj/Sx5dqzrbj05FUdqBoXkWOevdbxpN3lZRnR1Tp6Io7cDQ1AMPFiHvB0zeVlGdHVOnoijtwNAA3ArEfMw3BtxWwH2qs2PqVBSlHRiaJcAdPuZ7J7C4gPtUZ8fUqShKOzA0IKcf+uENNBfnJ0Kqzo6nU1GUdmBomoDTgQ0e5rfB5NHoIA3V2TF1KorSDgwNyFTKccA6D/JaZ9Je4kJaqrNj6lQUpR0YGoB3gYm4O50y16T5rotpqs6OqVNRlHZgaFI93AnA7TjzSoqZNCZ41KNVnR1Tp6IoJURon5m35Ltmb+Aa4Byg2mK6TcDfEVdWS15G8ydNzfzBzEprOT51qTOdJ99tzRvqsObM7191laXbZ516viOdE5/4gzWdM2ZkfPviiy+2Wjc8/93vuecefQKVgp4j38jyHCn2KLNwzWLgQmAKcCJwJDAeGAJ0NddsBZYDc4BXgGeABl+/iRiKC3nqUns6T77bV53GUFw469Tzbemc+MQfGnyuG6XxuyveYLWDZ7UjpqihaVecfHdJyJz4xB9KpUQbkAgCD+rj0mEZCnwPmAz0BdYD/7YzY1EghwJTgdHARuBfyF6srS6lvwdwHXAS0AP4ELgBeEF/cv8NzTDgWnJPofQyfwcBFyFTKPcj8/R+bdBTnRbQ6SrFJieYTkZN2nv9gfNNHf4G8KgH+U5Cgq9Gzf/3Ms/DhcBpwFsO0z8GeDhtdI5J/1/A4cDr+tP7Y2gqgRuB7wLl5r1VSEDE2cBCYLN5vzswAjgYON5UxAtMJbwT+BHg1Zi6ves8AdjTR52KDUa9dmug9GRd6yyM4aYxztYhqjIdoI/MaMBNbkwzMun0A140z+9rBaZ9LPCk0d+WiOkInqS123tDMwx4DBhr/j8LuNkMlxNZ7nkD+CPiyfZFMySdiCwoH4ds2HPbAymfzu7AZaaHAvAf4K4A6gxKeSpKOt8nvyNIOXC9Gd24ybgcn9WYkcfxwEyb6X4BeCKLkUmxj/707pLJvXl/0xCOReZCv2aGsf/K0SimkzDXHmbu3WrSmmXSdot8Oochi9TTkIXsI83rOeazoOgMSnkqweeL5ndvMqPfv5hRuVcca6Pxdpu6PJ93Ms/FUTbSPBJ4yoLx3KRVzVtDMwx4DugDLAIOMEPjQkiaew8w00J9TNrDXBoh5NP5B2BAhnsHmM+CorOQ8lzksk4l+HwbmWb9PDIN2w34OvBfZGrVC/aweF0vD/J+0cI11cA/LBq6wxGvSCuu+s9rdfPO0FQhi3q9zJTMJGCZC3ksM73xJSbtx/IMW/NhRedgk2c2DkPcdIuhM4TsUdnHvM5HCBiFeN6ETRqTXNSpBJ9LgV9lmYHYA++OXggV8Tv/FGixaGyeMqO9XM/7sxaNzFZkel3xyNBMQ+ZF65A1gPUu5rPeVIStyLTPNAdpWdFppZc/tAg6RyELp4uA+UholiE50hgCvI0stH5g/kaZtCabtJ3qVILNd0zDl6vRP6Edfu/FwHlmJG/F2DxpnrO2TLJhZFqBr+JtgNkObWiGIhvzUhV7qYt5VCOLd8uQhXlMXoVM+VjVWWEhrYocIzAvdIaQRcgRadeNRxYzh2ZJYya7rsPsY0ZJITOi+Y5DnUqwuRz4pYWRRXU7/f73I1OGVoxNpTE2x6e9N9EYmU4W7o8jDg16zLiHhmYq4ko4i8LXENrSHXgE2Gb+/o3sHp9l8irED/P7HujMVsHd1jkMcRdtS39TLkPbGJlXybzQu0+aUXGqUwkuVyCu7Famr95qx+XwW+Bii8amwnTmvoSsZT3Lrvt/8hmZR7TaeWdoaoGzzf9vtviDWjEyLwBnIH7pIcSD5QkgFVztbJO3VbzQmY2kyQPgLJd0xnPcMyDN2Aw1r/vneTDa6rRbnkpw+S5y8qkVIxNH9py0Z36H7COz4qVZbkb9z1p8HuKIN+fDWu28NTTHm6HlajPqcMvIZHK9PRBYaf6qkRhaVjnB3OOWznz82+js1GY4XqjOZYhrdT5j8wqZveVSvMeuzg//LrA8Fe/oCQwke3T0XEyxYWSSprf/Ugco0/uQNZu4RWPT2aKR+QYaXskXQ3O0ef2MxR5DoUYmvRKk5kGPtJH2US7qtEIiTefRLuk8A4kGkMvY5DIyq4Azc+g8Uqt0UdkfeBNZTP4EWMPOdTQrXAn83Eb9vIBdXfXbO38GzrVobKwYmW8i0cYVHwxNarf6bB+MzErkMKw3zf/H2UjfLZ12eLNN3k51LgWOyGNschmZI8gcDaCQ8lTcZTQSEuXgtPd6Ix5j+bzGAK4GrMakTxmZ+zpgOf/VjEKcGJu4GR39Tautf4YmtQi9oM1nZWSONVSokakHvowcirXIvLeXDa3ZdBaKlTWeRW3ydkNnIcYmZWSW5tG5l1bponET2b2/voPsg8lmbL6H7Bux2khegIQn8ppkQMv674gbciHGJlV+f9Eq66+hSc1lpkI+9EHcBOuQEPF/IfeimhUjsw3Z95Hyjtli/u1sQ2tbnblYa+EaK/uEvNJpx9iszGNkCtWpuEu+UCjfBu7OYGyuQaJyW20kz/fJyIBM/VmhGPtOHkIcYOycBJtAoj//Saur/4amLY8CJ5veWTkS5uJ5oIsDI3M8/obdnpun8m8E3g9A+Sddvk4JNpcAv04zNlOxvqs/Nd3zZx/1Wg3F8mKRynMJsN3m85bQalgcQ7PNvO6C7DqfmOG6g5G4Wl1cMjLd0j63SrrOfMTIva/kWos9Ia90plyYB1hIbwCyp2Yvl3Uq7vKyxeu+hewNuY6drv5WjMy5+D/dcyv5j6NoYaeLvZ+MN+1PVxv3RBDniXO1uvpvaFJTMiPIvYM23dg4Hcnsbf61E0stXacV7jOjsfTpqVXmPauLqHu3ydsNnanNmANspJkyNkPz6FymVbpoXA80Wrz2ImC6DSPzf8giuN8sRDYyZhs1NCFrJR/4rGucaX96FHBvythcoFXWX0Mz17w+BJlOWm3B2DidLjvU/DvXhtZ0nVb5GzDINPojzGs7niZu6xxG9h3/VozNK1mMTSE6FXeZj+yhanQxzdQ+j/uL+L2eMKOHe5H1wphpI+4z7z/qs56xpv3p6SCNkPk+F2m19c/QpDZ7ncjOoHKNeYyNEyOT2iRqZ7oB08imdFrdCNcJ8fi5xfx9B2txj9rqfMklnY/kMTIryb/P5mGXylNxn1fNb+GGsYmb0XcQ9nksQTaGDkTWbVNHOS/yWce+yHqQG8cShJApzG9rtfXH0DxrhsZ7IpGL/2MayUIeFisL/8eaBrMR2dRolWfMPSmd+egPvAP8Ajlj/DTz+h2LI4p0nc+6oHMv0wPMZWRSB7TlMjb7s+t6TaHlqXjDfxAPy+0O0oibDt8DAflOIeTMl5+ZGYGfI5GS/TxGYLTpSFkxMklgh8Xv9SvsbapVCjQ09ewMwXBdWq/c7jSAVe+y682/D5i8rVKf9uBdZ+H635N5nWSE+QyfdUZy3LPKGJilpveYz9hEXNCpeMdMY2waCjQyZyPuu0FgD2M8XwCuMgZwCnK65evYW2sslFE2jcwUJLCmlfYrhETIvkKrrbeGBsS7JIZ4nH0tbRrAqrGxamS+avKIUdhhTZl0ZhvN5Br1fDHPA+KFziXI4momI3MEuzocLCH7PpuF7IwO4FSn4h2vmWfCjrFpNUYmKFGEOyGx9CZl+fwQYwC83L+1j8mjt8XrrzQzFy/YNDZ3mnsVDw3NEiSQH0i4jCE2jI1VIzPEDFMxP+riAvRm05kpr3wM8llnEpm++yjtuneR0/8yebUtRY6fndPGyJxm0trLBZ2K98ZmssWRZixgRgYkivSYPNcMQyIbeMEAY2T62DAyd6b9/2XTflmdxpyB7HVSPDI0IKc0zkX80p9P60HkMjapHf/5jExv0zPqavKY5kBzNp3prLSQzuoi6JyPzDUPN9MBnwOW50hjGbImsy8y5TfKpOGmTsVbZplnZJsFI/NowLSfbfG6r3iQdwiZ0u9r8fqr0zp36byKvWnMu9CYgZ4amibgdGRH/TAkKOS+aT/W8ey62z517PEbefLYFwn6uLe5/3SceeXk0pniY9ObzPXwLy+SzqQZfXyEtR3/SeQo50XIruYxJq1hLulUvOd18/xkCku0wzTojwVQt9VTW4d4kPcX2Om2n49ryB2Q1M7IMoIcXKh4ZGhSUz7HAetM5XkDWQcAWRAchoSnOdZ8ni+S8tdMGnuZNI8jc/Rhu+TSmeK8LCObley+M7iYOu3wNdNoDXFZp+KPsZmA7EupM9M5LyDrH48FVPMmi9dt8SDvYy1eNxVrAUlnmefFSqzEL2h19dbQgKwbTDRTMrWIO2O6F83T5gFpzJHmZHPPX00ac02a77qoPZfOsGmA90OmlV41f9PMe0sCpNPKb+SHTsV7UmtsXZEjho8F/hdgvcWMdWZlQ+Z12HOCecOisemiVdVdynL0xCcgR8ROMb2uScAKJDLAG2b6J9Xj6Y6sOxxiGsWB5v0YMm/6I/LHTCp0xJBP5wvsdN/ujuwRCqLOTOV5qNE5wCedipLOrchR5pU5rvEq1tlHeT6/Aeux4tKZDRxjjGjXLNdohA2XCe0zM+9vtTcyB3oO2c/baEsTsqP5Nix6Q82flCUG5sxKq9/FF50clqV9v+qqYOmcMUNrt1I4O5+7U81IulOWevkN0p0YDnPY/9n5HPVAYqi1dQZIkH9NxgrjgKfY3fs0DpxEapO2PkeejmjSWYyc4TDFjAaORHa4D0nrEWxFFtfnIJs9n6GwzWpOUJ2K4j6pWGffQ6ad+iKOQM+bjo9XYWg2Ia7/M8wz0oJMH9+GO6fsvo8451yBeNX2Mc/mT7EXckqxYWgms/Ps8fORXb9nmh+5GtkA9QQyBfVgEfWqTkXxn1SsM79ZbEYXXtGARNGerj+xt6Smzj5FQk2AnKrXD9jMznNOUryKrDO86rYQi1NnRddpceqs+Dp1yK+UItanoP1BnyNXDU3b/Rwhcu/xmGkaSMfRgrMamMzGpmg6Lc0973xIiqdTHwxFUQJGuMD7DkPmMV9DPDiCiupUFEUpUUOTYiKyKPg6slAYVFSnoihKiRqaFIciC96z2XkIVxBRnYqiKCVqaFJMAP4J/Bdx3Q0F9HurTkVRlBI1NCkOBP6BhNc4KcANpOpUFEUpUUOT4gBk9+07wCkBbiBVp6IoSokamhT7IRsU30PC2tcEtDxUp6IoSokamhTjkLhI64BLA1wuqlNRFMUHQxP3MN9qJAKxG6hOd3UqiqL4Zmi8DOIYY9ezvZ2gOt3VqSiK4iplPuc3F7gdOSNmfYDLRXUqiqKUmKF5Azmk6J/kjvlVbFSnoihKiRma55BT+v4T8HJQnYqiKCVkaBLA48jxru8F+LurTkVRlBIzNC3A3/D21D3VqSiK0gENzXbg98jpkSsD/F1Vp6IoSokZmi3A3cixxBsD/B1Vp6IoSokZmrXAz4HfAvUB/m6qU1EUJeCGZivQJe3/y4CfAn8CmgP0HVSnoihKgMkVGeAyZI2gHnGpHWF63UFrFFWnoihKiY5o/mH+go7qVBRFKdERjaIoiqKooVEURVHU0CiKoihqaBRFURRFDY2iKIqihkZRFEVRdiWU/E8Fo0LTPgX2MO+tnZ+ctofvSg7Lsp1kZmX6/3bRmfY6WDqfunRXnSffHRydiqIoRRrRXGAa7tXA+QHWqzoVRVFKcUTjwEg9D4SAY5BzU7we0ahOHdEEkilXrPUzu0OQI7yHAzOBKXf8ou+qYuls2B5mwIAYx03eSjwO8Xgo9VE34FFgLHLc+LkTJ47a4YXObdsijB7dxJFHb6OxMUzS3rmzruls2RGiulOCE760lepOCVp2hNws6oJ1Fhsn0ZvPAI42r78MPBTQ76g6lfZEGXAHMMH8/xRgA/DtYgmKhGFHc4jWVohEIB7/7KOngEnm9dmmE3V2AMtUdXqME2eAi7O8DhqqU2lP7JVmZFKGp6iNTUV5gk2byti4sYyqqs8G4kPTGsUUpwWwPFVngA1NH+DwtP8fZt4LGqpTaW/0zvBe16I2ImXQ3BxmyeJKQjtblJ4ZLo0HsDxVZ4ANzalABJgPLDCvTw3g91OdSqnRBTgPuBQYk+HzUIC0HgGcQhKqq+OsXFHBpo0RKisTIEeRt6XVSzGhUB6dmfFdZ97yDL5O3wzNmebfR4CHzesvB/D7qU6llKgBbgamAz8BbkMW/NNJBkTrr4FXgCeAuRUVyZ5btkRYtqySikr/JaYW/8Ph3DqzjAwCV54B1umboRmITO2AeEA8Yl4fDgwI0HdTnUqpMQlZ1O+LeBhNBs4NoM7jgEvS/j8GmBEOw7o1UVpjoVyjC08oiyTZVh8mFttlZJNRZ6mUZ0c3NNciUztzgA/N33vmvakB+m5tdX5QAjo/CLBOxXsOyfDeoQHUeUSG9yaEw5BIiNeZ34amsirBmk/LWbMmSk1NPDXCyaizVMqzIxuak4Bvmdc/Ar5o/m40733LXFNsMumkBHQSUJ2Ku0SyvF9u49piEsvw3g6QqatQEVaRysqguSnM4oVVhMPJlIasOkulPDuiobkQmdYJA38GnjY97qmIf/efzGePmGuLRTadlIBOAqhTcdfA7Ad8BTgggxHJtLhRrDWZPoj77OAMn8UtvuebzmSSwTU1cZYvq2Dt2ijV1Ymi6QyF5C9ZmuVZFENTARwPvAzca3pczyD7PA5B1hEON68vNp+Vm2tfNvdW+PA9rOhMEVSdbSmmTsUbJpvf9PfIsd4nBlTnocBi4DHz7wmloLO8InnCtvoIixdWEo0W32ciVHrl6d2I01T+84D+QNS838181jdtOB8DbjXTOnF2XT+4FnHLO8VMAU0FjjR/LUjcr1ZgS1paq4A/As/aeEid6sToCaJOfNapeDNiCZtRSCbX0+lAP/O6CvEqeyZgvdcw8CBQm9ZGPAp0B5qCrDOZ5NFoWbL7+g3RpuYdIVJrRr5WgDLYvj3M9u0hunZN0LIjUirl6bmheRhxq8zGZuBxxAtigXlvFPCltGtOMu/NB34I/B24ygwVuyOeVZk4Lu0HyEchOke30Zk+LA2Szmx4qVNxl1rgeuBgYDnwY/Nvih5IjKp0RiBurOt81noVEu5oBXA5u+7R6Mfu3o6VwEjESSXQOiPh5MhkkvcS8RChUBKfth19pjMSSV5eXx9p+eTjCgYMaAlaeRbV0PwWuNr8f7lp2NaZXtla4CPT4NUi88rDgYva/IIh4G4zxbPI/F2ILGbvY3ryIWSe8sfAEHPfvTa02tH5OaPzwjw1bUERddrBC52Ku0xBNlnWABOR3fqnszM4aqcs91X6rPNaM5JOsTc7Y+xBZoeE1Ggt8DqTEPHZIWE3nRXlyaM/Xl7JmLFNRKPJ8lgsFITyLLqhuQbxcLjONFiXmQdklRkRPG96XnvmSesIdnXTWw0sND2RF41Vv8nkkUQ2pv3AhlYrOkemTU3YIc5O12IvdTrFTZ2Ku1ycNpKNINOeg9JGNdmaPr8XE65r8/+jzEhrblody1b3VKcFndHy5NimpvDchoYwvXu3xrMYmnhHejhS88k3INGD64GDgHeRRfQPjZHYs4C09wReMmkcArxj0q43ed1g8yGzorOfw/LwWqdbuKFTcZd+ed4Lym9TleG9/gEsz5LVmUzSPxIRF+ukPpGfGZoUjyObhBYAvUzDvR9wCzCtgLSnmV7255CzE3qZEc4Ek1ehuK0zhV86neK2TsWf5ysoZNqf0aI63dcZCukDkO1B+Mj0lucA1ciZKFWIZ9R0G+nebO6pBh5A5qffRxZKP3JBdyad1QXoTO+V/N3onOODTie9Jy90Kt6QLBFNqrP96wxcj2srspN+PbIAd5l5/wbgLgtp/grxvsHcO8ykdaxJ2y3a6vyOTZ3pXG7SWG/S9ENnIXipU1EUxdeh/Xp2hkH5Ttp1cyyk+V5a2pea1zeaNN3GiU4CoJOA6VQURfHN0AD8BdlQNAA40Ly3j4U0U9ccaO5tMml5RaE6CYBOAqhTURTFN0PTAMw2rw8y/46ykOaoNvfMNml5RaE6CYBOAqhTURTFN0MD8LH5d2CGBnwJslP9NPO6raEZ2CYNL7GiMxupe5YXQacd/NSpKIrim6HZbv6NIJ5Og4CNyCL/aOQ0uCfM68vMZ4PMtZG0nrzXWNGZjUibNPzSaRc/dSqKovhmaIaaf9eYxvs2xOvpV+zq095i3tsbuN30vteYz/by4XtY1ZmJlM5hPuu0i586FUVRXKMsx2flyNGyAP9FAmZ+HwmzcQayZtDHfL7OXPMcO6Ml9zb/TkSiGMc8+g6F6mxIuweThp86U9QgwTCDolNRFMU3Q/N50wjWAW8gmwW/j+zl6JLlnjrgl8gu/TfM/7sYY/OKR99BdSqKopSooUkdzvM8srj+ADvdhj9FwqCkFqaHAMcgsZ1+YEYSZ5l7v2zS8qphVJ1KUAlleY2F93HpekUpCUPTF3GprUQW2K8G/sbu0UcjwNeAn5kG9C12TvecwM7Q+V414KpTCRrpoUiyRetNtPnN8z2jTsObRPO8V2bhvvJsn6fF94rabG981Zknn/aos6hkcwYYhITcB1kTqDQ96PHI+fbZzrj+s7nmFXPPYeazkSZNt1GdSlCoy/DehrTX29oYlZTRSPfKzHQA2uY2/88UEWKrDZ2ZjFlDG52ZSH8/li3dROKziMV1DhtGT3Xm+d3ao87ijmhmhd/d7c2Jif3T96G0IscJ3zor/K6Vg1FXT0zs/wVk/WFaWmGMmhV+95MMeTnRn1Fnhgc6o04go07gE5fLuVR0lhyzZs13dP/EiaPckvIAcEHa7/MWsLRNw/I0cDI7p7+eZedx3CDHaqxjp1PIduDJNvksM2lPSKtPD9jQ+ZAZKadYC/yvjXF8AZm6TfEBu54G+whyoF86fw2FksQTIRKJEKFQciGE5rLrqaIvBkFnm/8vRM64ae86AzmiWWJ6Uq8Ch84Kv3uzRSMjD3/43cSs8LvTgUNNGpvZdVOnW+yiE4kabeeU8AQS7Vl1Kk6ZbozCemAWcKUxAulch6yzrTdG5Zo2n8811yw0HYzfAfe3uaYVOc1zlknnSVOfrHIBsq9ss8nvKHYPdf8Vo3OzyWdym88/AM5BNiBvRE7XvSUUgkQilH4Gy5dMo7sZ+HebBrloOjPk1RF0FndEk8VQLEbOOP+MjRsX1SBrA0ea6Zwh7PSWqkMWsueYaZ5/9uw5vGFW+N3/mesd8+TmBzO9vYvOUChEMpm0pdMMc/PqPKX7Wa7pNNjSGQ6HGxKJhHs6n3wy62emHAmHwyQSiULKMy+nnHKKqxW5kPrp8rO0CnHUyMVHiCt7rg7FfebPK3aQO1IGZpT1RQsjuAcAGraHGTAgxtlf3UQ8DmknStabv4RpHLd7pXPbtgijRzdx5NHbaGwM09IS2k1nDlzT2bIjRHWnBCd8aSvVnRI0NYVtl6cXOp2O/G1yCLKfcjgwE5hSZuEBHgZcC6Gzy8urO0WjnYhGKwmHo4RCMiBKJhO9E4lY71iseUIstv3ilpbG7Rs3LnoAuK1nz+F+9byHAddWVFSe06NH7+q+ffegS5daKisriETCvPnmgow6IfkAssHTV53ZyvOQQ0YSjyd6Nzfv6F1XVz9h/fp1F69fv6axtTX2oOnl+Knz+2Vl0bN69uxd3bt3b7p160KnTtU0NcVYtmwd9fXbfSnPjz7aeeROeXk54XCY1tZWamtr2bhx0bBIJPL9aLT8rJ49U797Z6qrqygrk/rZ2pro3djY1LuubtuEtWvXXLxx4/rGLVuWPhiPx29Zu7b7kvr6esrKykgkErS07Nzfu88++xBAyoA70qbOTjHTM98ulqBIGHY0h2hthUgE4jtXHJ9i596xs82U4dkBLFPV6XH9LMthYCqBaaFQeEpVVbfyysquhMORLD3gCOFwhLKySqqqupJIxDs1N2+9oKlpyzc2blx0J/Cjnj2HN2e8+bDm3LJTn2fvgVcC02pqaq8cOHCv6MCB/ams3NVBI5lMEgqFcupMJhN3ImsnnurMV56RSJiysggVFVG6dKlh4MA9iMX2rV6x4tPzPv54ydfr67fd4UhnfiqBH1dVVX934MDB0UGD+lNdvetZbS0tccLhEOGwg/J0yIcfflgJTKuu7nTlgAGDo4MGDaCyspxQKLzbyYbl5WHKy2vp0qWWAQP2oLm5pfqTT1aet3Llx1+fPXv2HcCPxo0b10xpsFfaQ5x6sM8upqGpKE+waVMZGzeWMXhwC7FYBCQKxqQ2l54WwPJUnT7Uz7IsRmYo8GhFRe34Tp16EQ7bc24IhyNUV/egsrJL+fbtG67ZsaP+2I0bF33Zg9HN0HA4/NigQUPHDR8+jKqqCsc6zfTHEg8qScHlGY2WMXToQAYO7BddtGjpNR9/vGRyLBY7zQud4XD48X79BowdOXI4NTWdAlme77///tBQKPTYnnsOHDdy5AiqqysJh/Mf8RMKQSgUprq6khEjhjJgwJ7RBQsWXrN69Yovvv/++2eMGTOmFNa9emd4r2sxBYXLoHlbmCWLKxmy12cjwp4ZLo0HsDxVpw/1M5zByOwPvF5T03t8be0ethvFXRueMmpr96Cmpvd4YJZJ2y32j0ajb4wf/7lx48aNtm1kcukEXNXpVnlGo2WMHj2C/fc/aExlZeUbbuuMRqNvjho1Zuz48WNsGxm/ynPevHn7R6PRN0ePHjduzJjR1NRUWzIyu2sMU1NTzZgxoxk9ety4aDT6xrx58/YPwIPaBTgPOeRuTCZ7GaBG5QjgFJJQXR1n5YoKNm2MUFmZgMwxBlu9FBMK5dGZGd915i3PYOssqH6G2xiZYcBztbV79KmsdK+TVFnZldraPfoAz5k8nDIsGo3+e7/9Duo9cGA/T3TiTvBKT8pzjz16cdBBh/SqrKx83i2d0Wj0hX33HddryJBBlJWVBbI8Fy5cOCwajT6/777jew0e3J+KinLn0z4V5Qwe3J999x3fKxqNPr9w4cJiBi2tQTzIpgM/Qda6hre5Jijn0f8acax4AphbUZHsuWVLhGXLKqmo9F9iytMtQ59jF51ZRgaBK8+A6iy4fobTjEwV8GhNTe9eFRW1riusqKilpqZ3L+Axk1ehVIXD4cf23Xe/nv369fJUJxKPrGCdXpZn9+5dOOCAg3qUlZU94VRnOBx+bMSIUd3799+DSCQcyPJcuHBhFfDoyJH79thzzz6uGUOAsrIy9tyzLyNH7tsDeMzkVQwmIWstfYFuiBvsuQFscI4DLkn7/xhgRjgM69ZEaY2Fco0uPKEskmRbfZhYbJeRTUadpVKeAdRZcP1Mb1WmVVTUjnOz552ph1tRUTsW2XhYKNMGDRo6duDAPQKv0+vy7NWrO3vvPXLfcDj848KnG0I37rnnwLEDB/YnEokEsjzLy8sBpvXvP2jcgAH9XDUyO41NhAED+tG//6CxwDSTp98ckuG9QwPY4ByR4b0J4bBEBojH8d3QVFYlWPNpOWvWRKmpiadGOBl1lkp5BlBnwfUzbEYzQ0Oh8JROnXp5rrRTp96EQuEpBU6hDa2pqb1y+PBhhDyuySmdBU75+Faew4btRW1t5+8WqrOysmrKiBF7U14eDWx5zps3b2hVVdWVw4cP91RneXmU4cOHU1VVfeW8efO8nELLZtHLbVxbTDKFTNkBMnUVKsIqUlkZNDeFWbywinA4mdKQVWeplGeRcL1+pkY0U6uqukWdLFRbJRyOUFXVLcrOc2vs9L6nDhy4V5mThX8/dPpZnpFImOHD9ymLRCLX2f+O4esHDBhUVlVVGfTf/bqBA/cqq6mp9lxnTU01AwcOKQuFQtd59ADvh+wUPyDDQ5ppfrtYazJ9EPfZwRk+i1t8zzedySSDa2riLF9Wwdq1UaqrE0XTKd6Nu/1wpVCentXP8MaNi2ohdLaXUzyZplIgdJbkbZna8vKKcwYO3NN3nYAtnX6X5x579Ka8vOIrdnVGImVfGTx4oGdTZm6U55NPPlkbiZSdNXjwQMJh77vK4XAIKZOyrzz55JNuL65NBp4Bfg/8AziRYHIoEs3iMfPvCaWgs7wiecK2+giLF1YSjRbfZyJUeuXpWf0MA8eXl1d3yrYZ06vebXl5dSfgeBu3Hd+zZ+/qysrywOv0vzxD9OvXv9quzl69eldXVlYEvjx79epT7ccodqdBrKBXrz52yzPVI4ySParudOSMoSpgD8RrJ2hTY2HgwbTOQBnwKM4cTnzRmUzyaLQsWbV+Q5TmHSHCYf9FRcpg+/Yw27eHqChPBK08i1Y/w8DR0Wgn37+xyfNoG7cc3afPHiWhsxjl2atXb9s6e/fu7flalxvl2bdvX397oiEwedrRWWse1BeQYJhD2nzeg10j7wKMoDhurFchkaN/y+7z7v2AAW1tLzuPuQi0zkg4OTKZhEQ8RCiU9F1nJJIsb2wM88nHFYTDySCVZ1HrZxkwtqyswvcaZPIca+OWsZ0715aEzmKUZ21tp3Zbnl27dvFdp8nTjs4pyCa2GuSo7a7A6eyM0p2t91Hp81e7FjmiIsXebQxqeY7ecOB1JiHis0PCbjorypNHf7y8kjFjm4hGk+VpQUaLWZ5FrZ9hYGgk4r8rp8lzqI1bhlZXV5SEzmKUp9m8aLM8q30f0RRSnlVV/s8ymDzt6LzYPMSpRuQUdj2cLltB+72Y0NbJ4ag2BjXbInRcdVrTGS1Pjm1qCtPQECYaTQZFZ1HrZxjoHC7CZKbJs7ONWzqHw2GSyaTtv0Qi6bvOUijPaLRwr7iUgZJgpdb/jOOBLZ2pKMz+jrxsl2e/PO8FZUd/Jqvdn+BRsjqTSfpHIuJinUwGRmdR62fJHAUKMHv2AoIV6ik4JBIJ3/KqqalizJjCTpKOx+M888yijvKzhAOoaQe7nz/fojrd1xkKaf1Mz2ibn41Um4Zxm41bVGcOWlpitnXGYoXH5LM7kkn9tbbGbetsbfW/PE2e2xwmkwxg45JUnR1SZ1HrZxhYGo/731EweS61cYvqzEF9faNtnY2NjSR9HNsnk0kaG+3rbGpq8r08TZ5LURTFFUMzt7XV/2gH8fgOkCilVlGdOdi8eYttndu21fuu0+RpS+fWrXW+6zR5ztUmQlHcMTQvxWLbfc+4pWU7wEs2blGdWUgkkqxZ86ltnevXr/d9RLN+/XrbOteuXevromoyCWvXrrWrU1GUHIbm2ZaWxu2JhH/edolEnJaWxkZkk5NVVGcW1q/fSkPDVts6N2xY39jc7N/oq7l5Bxs2rG+yr3NdEXSus6tTUZRshqZnz+H1kHywuXmrjw/yViD5gORtmaLplLyDqTMeT7Bs2XISibhtnfF468OffLKSeDzug844klfrQ3Z0nnLKKfXxeOtDH3+8wpGbup3R4ccfryAeb33wlFNOqdcmQlHcGdEA3NrUtCXmRy88kYjT1LQlhsTRsYvqbMOKFevZuHF1QToTicT0FSs+bm1qavZcZ1NTMytXftyaSCRutntvMpm8ecWK5a0NDY2e69y+vZEVK5a3JpPJW7R5UBQXDU3PnsOXJJOJO7ZvX+/Dg7yeZDJxZ8+ewxcXcLvvOpFoq4HUuWlTPYsXLyCRiBess7m56Y6FCxen3KM9oaUlxsKFi2lsbLyjEJ1jxoxZ0tTU+PNFixb5orOpqfGOMWPGLNbmQVHcHdEATNuxo36ul1M+zc1b2bGjfi4OT65UnbB163bmz19IY+NWRzqTyeSPVq9eMW/FilWeTKHF43FWrFjF6tUr5hWqs6WlBWDaqlWfzF258tPUXhxXaW1tZeXKT1m9+pN5wDSTp6Iobhqanj2HNwGnNzSs37Bjh/tT0zt21NPQsH4DcHrPnsOdzIH4phMIpM716+v44IOFbNq0yhWdiUTitIUL529etWoN8bh7myPj8QSrVq1h4cL5mxOJxGlOdI4YMaIJOH3Bgg82rV691lVj09oaZ/XqdSxY8MGmZDJ52ogRIxq1aVAUb0Y09Ow5fAlwXH39mnVu9sSbm7dSX79mHXCcycMpnus0eQRKZyzWytKla5g/fwEbN65wVWcsFjvmgw/e37h8+Se0trY6TrC1tZXlyz/hgw/e3xiLxY5xQ+eIESOWxGKxYz/4YM6Gjz9eyY4dzkcdO3a08PHHK/nggzkbYrHYsSNGjFji4vMVyvIaC+/j0vWKUvT6uVusm549h78LTGxoWD+3vn4NiUThjU4iEae+fg0NDevnAhNN2m7hmU6TdmB0xmJxVqzYwJw5y1i0aD5bt67xRGcsFjtk/vx5H8yZM4+GhsL3AjU0bGfOnHnMnz/vg1gsdoibOseMGfNuLBY7dP78ufPmzfuQhobGguK8JRIJGhoamTfvQ+bPnzsvFosdOmbMmHddfpDT3eSyDcHSxWcKHV+WI81CiOZ5r8zCfeXZPk+L7xW18F2KpjNPPu1RZ1HrZ8agambUMWHHjvrbt2z5ONbYuAk7HlSJRJzGxk1s2bI8tmNH/e3ABJdGMplGDK7qdGmEULDOeDxJS0sr27Y18umnm5k/fyVvv72QhQsX8umnCzzXmUgkDly9esXPXn/99daPPlqUChljicbGRj76aBGvv/566+rVK36WSCQO9ELnuHHjliQSiYNWrfrk9jfeeL114cKlNDY2k0gkcm7sTCbFwDQ2NrNw4VLeeOP11lWrPrk9kUgcNG7cOKc6M4Uv2JD2elubhzb1UDak/X9dhjQ2t/l/Jg8TO8PlTI1FQxudmUh/P5Yt3UTis4jFdQ4bRk915vnd2qPOotbPrEJ79hzeDFy7ceOi3zc2brqmsXHzOeXl1dXRaCei0UrC4WgqND2JRIJEIkYs1kwstp2WlsYmSP4duK1A7zJbM17AtclkwpFOCvPacl3n7NkfBUHn95qaGu9dvHjB1KVLF5/ds2fvqt69e9OtWxeqq6soKyv7bHqssbGJLVvqWL9+PRs3rm9OJOIPJBKJW0KhkKc6R48e3VxbW3vt7Nmzf79kyYKpy5aJzr59+9K1axeqqqooK4sYnXGamprYurWOtWvXfqYzHo/fcvDBBy+ur3dlDe0B4IK0h/8tdo2Vtg14Gjg5bXrhWWBL2jUvmYe5j/n/duDJNvksM2lPSM1Smryt8hDwtbT/rwX+16bxeQE4Ju29D4AFaf9/BPhhm3T/GgoliSdCJBIhQqHkQgjNZdczZF4Mgs42/1+IhBpq7zqLWj9Dr732oSWVGzcuqgFOBI4ExiNHgXZN61EtB+YArwDP9Ow5vMFKuo890p07fpH9qN4pV6wF4PAjZ1stUFs621js7K1vUwVnnT056+cPPvAvACqrdpS8zlAoRDKZJBwOk0gkbOkMh8MNiUTiszSc6sxH/wGDHNXPVSs/yZtHLp1p9bQ/cAdwGLAIOXnxjTaX7WOu2Q+YB1wOzG8zw/BN4BpTPx4Brmd3J4pDgNuB4cBMYModv+i7ykp5TblibYVpdA4HVgFnAR+1uawbcs7954y+s8216ZwN3Gx0PgR8Z/v2MHv2j3Hc5K0kEhCPhwYCjyIHyP0POGfixFGbvdS5vSG8qv/AFo6bXEc8DvF4aDedGbJzVWcsFvooGk0y+YSt9OjRSlNTuKDydFPnrFnzi1o/Q9+9fE034H7gWKwdL9oCPAycf/qXN7cYY1GJnEP9lSxziW1pNVb+bKDOiqExlaognUDLhIPfAzmWtGCdFhtGRzrNe6rTBZ39BwxqMcbEM52KouQnDPwCmIz1M6zLzVDx+sce6c5jj3QH+IF5L2oxjTKT5502tBasM+091dmBdK5a+UlqxOKHTkVRchiaQrtr6fcd50Iabl6rOlWn3zoVRclhaHoWeG+ftNdupJEP1ak6g6xTUZQchkZRlCzo+oyiqKFRFEVR1NAoiqIoamgURVEURQ2NoiiKooZGURRFUdTQKIqiKGpoFEVRlHZlaOoKvDc9mJsbaeRDdarOIOtUFCWHoXm0wHsfS3vtRhr5UJ2qM8g6FUXJQhlwFVALfAFrx3a2mgfw9rT3bgX6IefXWwl+mEDOUvieDa2qU3UGWaeiKDkMTR0SPt0JLcC3zJ9XqE7VGWSdiqLkMDQdgrdm7+c4jbPO9jZ9t/BDpznfR1EUxZKh6QLci/WpiTgyNXE5Ow/AKgfuAk6zODWRRA6WuhjrC7WqU3UGWaeiKDkMzQzgTJv3XYwcRXqT+f9U4CKbaXwFOafa6n2qU3UGWaeiKFkIA2cUeO/paa/dSCMfqlN1Blmnoig5DE2XAu/t3mZ6w2ka+VCdqjPIOhVFyWFoFEVRFEUNjaIoiqKGRlEURVHU0CiKoihqaBRFURQ1NIqiKIqihkZRFEVRQ6MoiqJ0BEOzscB716W9diONfKhO1RlknYqi5DA0/yrw3mfTXj/nQhr5UJ2qM8g6FUXJYWguNw9zq8V7WoC/Ajenvfdj4G/sjJabj1bzEE+xoVV1qs4g61QUJQv/PwAlukJhy2ScjQAAAABJRU5ErkJggg==";Jr={border:{"border-top":" iconfont luckysheet-iconfont-shangbiankuang","border-bottom":" iconfont luckysheet-iconfont-xiabiankuang","border-left":" iconfont luckysheet-iconfont-zuobiankuang","border-right":" iconfont luckysheet-iconfont-youbiankuang","border-none":" iconfont luckysheet-iconfont-wubiankuang","border-all":" iconfont luckysheet-iconfont-quanjiabiankuang","border-outside":" iconfont luckysheet-iconfont-sizhoujiabiankuang","border-inside":" iconfont luckysheet-iconfont-neikuangxian","border-horizontal":" iconfont luckysheet-iconfont-neikuanghengxian","border-vertical":" iconfont luckysheet-iconfont-neikuangshuxian"},align:{left:" iconfont luckysheet-iconfont-wenbenzuoduiqi",center:" iconfont luckysheet-iconfont-wenbenjuzhongduiqi",right:" iconfont luckysheet-iconfont-wenbenyouduiqi",top:" iconfont luckysheet-iconfont-dingbuduiqi",middle:" iconfont luckysheet-iconfont-shuipingduiqi",bottom:" iconfont luckysheet-iconfont-dibuduiqi"},textWrap:{overflow:" iconfont luckysheet-iconfont-yichu1",wrap:" iconfont luckysheet-iconfont-zidonghuanhang",clip:" iconfont luckysheet-iconfont-jieduan"},rotation:{none:" iconfont luckysheet-iconfont-wuxuanzhuang",angleup:" iconfont luckysheet-iconfont-xiangshangqingxie",angledown:" iconfont luckysheet-iconfont-xiangxiaqingxie",vertical:" iconfont luckysheet-iconfont-shupaiwenzi","rotation-up":" iconfont luckysheet-iconfont-wenbenxiangshang","rotation-down":" iconfont luckysheet-iconfont-xiangxia90"}}});function Z(e){for(let n=0;n<f.luckysheetfile.length;n++)if(f.luckysheetfile[n].index==e)return n;return null}function Mt(e,n,t){let l="";t==null&&(t=f.currentSheetIndex),e!=t&&(l=f.luckysheetfile[Z(e)].name.replace(/'/g,"''"),/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/.test(l)?l=l+"!":l="'"+l+"'!");let o=n.row[0],a=n.row[1],s=n.column[0],u=n.column[1];return o==null&&a==null?l+tt(s)+":"+tt(u):s==null&&u==null?l+(o+1)+":"+(a+1):s==u&&o==a?l+tt(s)+(o+1):l+tt(s)+(o+1)+":"+tt(u)+(a+1)}function pu(){return f.luckysheet_select_save}function At(e){return e&&f.luckysheetfile.forEach(n=>{n.chart&&n.chart.forEach(t=>{let l=f.getChartJson(t.chart_id);t.chartOptions=l})}),f.luckysheetfile}function vu(){return f.config}var Et=Me(()=>{ht();Ke()});function yu(e){f.luckysheet_select_save=e}function Xn(e){f.luckysheet_scroll_status=e}function Kn(e){f.luckysheetfile=e}var Zn=Me(()=>{Et();Ke()});var eg,fr,xi=Me(()=>{eg={mobilecheck:function(){var e=!1;return function(n){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),document.body&&document.body.clientWidth&&document.body.clientHeight&&document.body.clientWidth<350&&document.body.clientHeight<500&&(e=!0),e},iphoneCheck:function(){var e=!1;return/iPhone/i.test(navigator.userAgent)&&(e=!0),!0},isWeixin:function(){var e=navigator.userAgent.toLowerCase();return e.match(/MicroMessenger/i)=="micromessenger"},isAndroid:function(){var e=navigator.userAgent,n=(navigator.appVersion,e.indexOf("Android")>-1||e.indexOf("Linux")>-1);return n},tabletCheck:function(){var e=/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase());return e},BrowserType:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,a=e.indexOf("Firefox")>-1,s=e.indexOf("Safari")>-1&&e.indexOf("Chrome")==-1,u=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(t){var h=new RegExp("MSIE (\\d+\\.\\d+);");h.test(e);var d=parseFloat(RegExp.$1);return d==7?"IE7":d==8?"IE8":d==9?"IE9":d==10?"IE10":"0"}if(a)return"FF";if(n)return"Opera";if(s)return"Safari";if(u)return"Chrome";if(o)return"Edge";if(l)return"IE11"},isIE:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1;return t||l?"1":"-1"},IEVersion:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Windows NT 6.1; Trident/7.0;")>-1&&!t;if(t){var a=new RegExp("MSIE (\\d+\\.\\d+);");a.test(e);var s=parseFloat(RegExp.$1);return s==7?"IE7":s==8?"IE8":s==9?"IE9":s==10?"IE10":"0"}else return o?"Edge":l?"IE11":"-1"},luckysheetrefreshfixednum:null,luckysheetrefreshfixed:function(){var e=this;return e.luckysheetrefreshfixednum==null&&(e.BrowserType()=="FF"?e.luckysheetrefreshfixednum=5:e.luckysheetrefreshfixednum=0),e.luckysheetrefreshfixednum},detectOS(){var e=navigator.userAgent,n=navigator.platform=="Win32"||navigator.platform=="Windows",t=navigator.platform=="Mac68K"||navigator.platform=="MacPPC"||navigator.platform=="Macintosh"||navigator.platform=="MacIntel";if(t)return"Mac";var l=navigator.platform=="X11"&&!n&&!t;if(l)return"Unix";var o=String(navigator.platform).indexOf("Linux")>-1;if(o)return"Linux";if(n){var a=e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1;if(a)return"Win2000";var s=e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1;if(s)return"WinXP";var u=e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1;if(u)return"Win2003";var h=e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1;if(h)return"WinVista";var d=e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1;if(d)return"Win7"}return"other"}},fr=eg});var un=wl(Yl=>{"use strict";var tg=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function lg(e,n){return Object.prototype.hasOwnProperty.call(e,n)}Yl.assign=function(e){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var t=n.shift();if(!!t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(var l in t)lg(t,l)&&(e[l]=t[l])}}return e};Yl.shrinkBuf=function(e,n){return e.length===n?e:e.subarray?e.subarray(0,n):(e.length=n,e)};var rg={arraySet:function(e,n,t,l,o){if(n.subarray&&e.subarray){e.set(n.subarray(t,t+l),o);return}for(var a=0;a<l;a++)e[o+a]=n[t+a]},flattenChunks:function(e){var n,t,l,o,a,s;for(l=0,n=0,t=e.length;n<t;n++)l+=e[n].length;for(s=new Uint8Array(l),o=0,n=0,t=e.length;n<t;n++)a=e[n],s.set(a,o),o+=a.length;return s}},ng={arraySet:function(e,n,t,l,o){for(var a=0;a<l;a++)e[o+a]=n[t+a]},flattenChunks:function(e){return[].concat.apply([],e)}};Yl.setTyped=function(e){e?(Yl.Buf8=Uint8Array,Yl.Buf16=Uint16Array,Yl.Buf32=Int32Array,Yl.assign(Yl,rg)):(Yl.Buf8=Array,Yl.Buf16=Array,Yl.Buf32=Array,Yl.assign(Yl,ng))};Yl.setTyped(tg)});var Hu=wl($i=>{"use strict";var ig=un(),og=4,ku=0,bu=1,ag=2;function _i(e){for(var n=e.length;--n>=0;)e[n]=0}var sg=0,wu=1,cg=2,ug=3,fg=258,Ga=29,no=256,io=no+1+Ga,Ci=30,Ya=19,xu=2*io+1,Jn=15,Xa=16,hg=7,Ka=256,_u=16,Cu=17,$u=18,Za=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Uo=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],dg=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Tu=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],mg=512,fn=new Array((io+2)*2);_i(fn);var oo=new Array(Ci*2);_i(oo);var ao=new Array(mg);_i(ao);var so=new Array(fg-ug+1);_i(so);var Ja=new Array(Ga);_i(Ja);var Go=new Array(Ci);_i(Go);function Qa(e,n,t,l,o){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=l,this.max_length=o,this.has_stree=e&&e.length}var Su,Iu,Ru;function es(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}function Fu(e){return e<256?ao[e]:ao[256+(e>>>7)]}function co(e,n){e.pending_buf[e.pending++]=n&255,e.pending_buf[e.pending++]=n>>>8&255}function er(e,n,t){e.bi_valid>Xa-t?(e.bi_buf|=n<<e.bi_valid&65535,co(e,e.bi_buf),e.bi_buf=n>>Xa-e.bi_valid,e.bi_valid+=t-Xa):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)}function Qr(e,n,t){er(e,t[n*2],t[n*2+1])}function Du(e,n){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--n>0);return t>>>1}function gg(e){e.bi_valid===16?(co(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function pg(e,n){var t=n.dyn_tree,l=n.max_code,o=n.stat_desc.static_tree,a=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,u=n.stat_desc.extra_base,h=n.stat_desc.max_length,d,m,p,v,y,k,b=0;for(v=0;v<=Jn;v++)e.bl_count[v]=0;for(t[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<xu;d++)m=e.heap[d],v=t[t[m*2+1]*2+1]+1,v>h&&(v=h,b++),t[m*2+1]=v,!(m>l)&&(e.bl_count[v]++,y=0,m>=u&&(y=s[m-u]),k=t[m*2],e.opt_len+=k*(v+y),a&&(e.static_len+=k*(o[m*2+1]+y)));if(b!==0){do{for(v=h-1;e.bl_count[v]===0;)v--;e.bl_count[v]--,e.bl_count[v+1]+=2,e.bl_count[h]--,b-=2}while(b>0);for(v=h;v!==0;v--)for(m=e.bl_count[v];m!==0;)p=e.heap[--d],!(p>l)&&(t[p*2+1]!==v&&(e.opt_len+=(v-t[p*2+1])*t[p*2],t[p*2+1]=v),m--)}}function Mu(e,n,t){var l=new Array(Jn+1),o=0,a,s;for(a=1;a<=Jn;a++)l[a]=o=o+t[a-1]<<1;for(s=0;s<=n;s++){var u=e[s*2+1];u!==0&&(e[s*2]=Du(l[u]++,u))}}function vg(){var e,n,t,l,o,a=new Array(Jn+1);for(t=0,l=0;l<Ga-1;l++)for(Ja[l]=t,e=0;e<1<<Za[l];e++)so[t++]=l;for(so[t-1]=l,o=0,l=0;l<16;l++)for(Go[l]=o,e=0;e<1<<Uo[l];e++)ao[o++]=l;for(o>>=7;l<Ci;l++)for(Go[l]=o<<7,e=0;e<1<<Uo[l]-7;e++)ao[256+o++]=l;for(n=0;n<=Jn;n++)a[n]=0;for(e=0;e<=143;)fn[e*2+1]=8,e++,a[8]++;for(;e<=255;)fn[e*2+1]=9,e++,a[9]++;for(;e<=279;)fn[e*2+1]=7,e++,a[7]++;for(;e<=287;)fn[e*2+1]=8,e++,a[8]++;for(Mu(fn,io+1,a),e=0;e<Ci;e++)oo[e*2+1]=5,oo[e*2]=Du(e,5);Su=new Qa(fn,Za,no+1,io,Jn),Iu=new Qa(oo,Uo,0,Ci,Jn),Ru=new Qa(new Array(0),dg,0,Ya,hg)}function Au(e){var n;for(n=0;n<io;n++)e.dyn_ltree[n*2]=0;for(n=0;n<Ci;n++)e.dyn_dtree[n*2]=0;for(n=0;n<Ya;n++)e.bl_tree[n*2]=0;e.dyn_ltree[Ka*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function zu(e){e.bi_valid>8?co(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function yg(e,n,t,l){zu(e),l&&(co(e,t),co(e,~t)),ig.arraySet(e.pending_buf,e.window,n,t,e.pending),e.pending+=t}function Pu(e,n,t,l){var o=n*2,a=t*2;return e[o]<e[a]||e[o]===e[a]&&l[n]<=l[t]}function ts(e,n,t){for(var l=e.heap[t],o=t<<1;o<=e.heap_len&&(o<e.heap_len&&Pu(n,e.heap[o+1],e.heap[o],e.depth)&&o++,!Pu(n,l,e.heap[o],e.depth));)e.heap[t]=e.heap[o],t=o,o<<=1;e.heap[t]=l}function Nu(e,n,t){var l,o,a=0,s,u;if(e.last_lit!==0)do l=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1],o=e.pending_buf[e.l_buf+a],a++,l===0?Qr(e,o,n):(s=so[o],Qr(e,s+no+1,n),u=Za[s],u!==0&&(o-=Ja[s],er(e,o,u)),l--,s=Fu(l),Qr(e,s,t),u=Uo[s],u!==0&&(l-=Go[s],er(e,l,u)));while(a<e.last_lit);Qr(e,Ka,n)}function ls(e,n){var t=n.dyn_tree,l=n.stat_desc.static_tree,o=n.stat_desc.has_stree,a=n.stat_desc.elems,s,u,h=-1,d;for(e.heap_len=0,e.heap_max=xu,s=0;s<a;s++)t[s*2]!==0?(e.heap[++e.heap_len]=h=s,e.depth[s]=0):t[s*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=h<2?++h:0,t[d*2]=1,e.depth[d]=0,e.opt_len--,o&&(e.static_len-=l[d*2+1]);for(n.max_code=h,s=e.heap_len>>1;s>=1;s--)ts(e,t,s);d=a;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],ts(e,t,1),u=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=u,t[d*2]=t[s*2]+t[u*2],e.depth[d]=(e.depth[s]>=e.depth[u]?e.depth[s]:e.depth[u])+1,t[s*2+1]=t[u*2+1]=d,e.heap[1]=d++,ts(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],pg(e,n),Mu(t,h,e.bl_count)}function Eu(e,n,t){var l,o=-1,a,s=n[0*2+1],u=0,h=7,d=4;for(s===0&&(h=138,d=3),n[(t+1)*2+1]=65535,l=0;l<=t;l++)a=s,s=n[(l+1)*2+1],!(++u<h&&a===s)&&(u<d?e.bl_tree[a*2]+=u:a!==0?(a!==o&&e.bl_tree[a*2]++,e.bl_tree[_u*2]++):u<=10?e.bl_tree[Cu*2]++:e.bl_tree[$u*2]++,u=0,o=a,s===0?(h=138,d=3):a===s?(h=6,d=3):(h=7,d=4))}function Lu(e,n,t){var l,o=-1,a,s=n[0*2+1],u=0,h=7,d=4;for(s===0&&(h=138,d=3),l=0;l<=t;l++)if(a=s,s=n[(l+1)*2+1],!(++u<h&&a===s)){if(u<d)do Qr(e,a,e.bl_tree);while(--u!=0);else a!==0?(a!==o&&(Qr(e,a,e.bl_tree),u--),Qr(e,_u,e.bl_tree),er(e,u-3,2)):u<=10?(Qr(e,Cu,e.bl_tree),er(e,u-3,3)):(Qr(e,$u,e.bl_tree),er(e,u-11,7));u=0,o=a,s===0?(h=138,d=3):a===s?(h=6,d=3):(h=7,d=4)}}function kg(e){var n;for(Eu(e,e.dyn_ltree,e.l_desc.max_code),Eu(e,e.dyn_dtree,e.d_desc.max_code),ls(e,e.bl_desc),n=Ya-1;n>=3&&e.bl_tree[Tu[n]*2+1]===0;n--);return e.opt_len+=3*(n+1)+5+5+4,n}function bg(e,n,t,l){var o;for(er(e,n-257,5),er(e,t-1,5),er(e,l-4,4),o=0;o<l;o++)er(e,e.bl_tree[Tu[o]*2+1],3);Lu(e,e.dyn_ltree,n-1),Lu(e,e.dyn_dtree,t-1)}function wg(e){var n=4093624447,t;for(t=0;t<=31;t++,n>>>=1)if(n&1&&e.dyn_ltree[t*2]!==0)return ku;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return bu;for(t=32;t<no;t++)if(e.dyn_ltree[t*2]!==0)return bu;return ku}var Ou=!1;function xg(e){Ou||(vg(),Ou=!0),e.l_desc=new es(e.dyn_ltree,Su),e.d_desc=new es(e.dyn_dtree,Iu),e.bl_desc=new es(e.bl_tree,Ru),e.bi_buf=0,e.bi_valid=0,Au(e)}function Bu(e,n,t,l){er(e,(sg<<1)+(l?1:0),3),yg(e,n,t,!0)}function _g(e){er(e,wu<<1,3),Qr(e,Ka,fn),gg(e)}function Cg(e,n,t,l){var o,a,s=0;e.level>0?(e.strm.data_type===ag&&(e.strm.data_type=wg(e)),ls(e,e.l_desc),ls(e,e.d_desc),s=kg(e),o=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=o&&(o=a)):o=a=t+5,t+4<=o&&n!==-1?Bu(e,n,t,l):e.strategy===og||a===o?(er(e,(wu<<1)+(l?1:0),3),Nu(e,fn,oo)):(er(e,(cg<<1)+(l?1:0),3),bg(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Nu(e,e.dyn_ltree,e.dyn_dtree)),Au(e),l&&zu(e)}function $g(e,n,t){return e.pending_buf[e.d_buf+e.last_lit*2]=n>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=n&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,n===0?e.dyn_ltree[t*2]++:(e.matches++,n--,e.dyn_ltree[(so[t]+no+1)*2]++,e.dyn_dtree[Fu(n)*2]++),e.last_lit===e.lit_bufsize-1}$i._tr_init=xg;$i._tr_stored_block=Bu;$i._tr_flush_block=Cg;$i._tr_tally=$g;$i._tr_align=_g});var rs=wl((Ik,Vu)=>{"use strict";function Tg(e,n,t,l){for(var o=e&65535|0,a=e>>>16&65535|0,s=0;t!==0;){s=t>2e3?2e3:t,t-=s;do o=o+n[l++]|0,a=a+o|0;while(--s);o%=65521,a%=65521}return o|a<<16|0}Vu.exports=Tg});var ns=wl((Rk,qu)=>{"use strict";function Sg(){for(var e,n=[],t=0;t<256;t++){e=t;for(var l=0;l<8;l++)e=e&1?3988292384^e>>>1:e>>>1;n[t]=e}return n}var Ig=Sg();function Rg(e,n,t,l){var o=Ig,a=l+t;e^=-1;for(var s=l;s<a;s++)e=e>>>8^o[(e^n[s])&255];return e^-1}qu.exports=Rg});var Yo=wl((Fk,ju)=>{"use strict";ju.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var Qu=wl(ln=>{"use strict";var Xl=un(),yr=Hu(),Wu=rs(),In=ns(),Fg=Yo(),Qn=0,Dg=1,Mg=3,Rn=4,Uu=5,en=0,Gu=1,kr=-2,Ag=-3,is=-5,zg=-1,Pg=1,Xo=2,Ng=3,Eg=4,Lg=0,Og=2,Ko=8,Bg=9,Hg=15,Vg=8,qg=29,jg=256,os=jg+1+qg,Wg=30,Ug=19,Gg=2*os+1,Yg=15,qt=3,Fn=258,zr=Fn+qt+1,Xg=32,Zo=42,as=69,Jo=73,Qo=91,ea=103,ei=113,uo=666,Sl=1,fo=2,ti=3,Ti=4,Kg=3;function Dn(e,n){return e.msg=Fg[n],n}function Yu(e){return(e<<1)-(e>4?9:0)}function Mn(e){for(var n=e.length;--n>=0;)e[n]=0}function An(e){var n=e.state,t=n.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(Xl.arraySet(e.output,n.pending_buf,n.pending_out,t,e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,n.pending===0&&(n.pending_out=0))}function zl(e,n){yr._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,An(e.strm)}function Gt(e,n){e.pending_buf[e.pending++]=n}function ho(e,n){e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=n&255}function Zg(e,n,t,l){var o=e.avail_in;return o>l&&(o=l),o===0?0:(e.avail_in-=o,Xl.arraySet(n,e.input,e.next_in,o,t),e.state.wrap===1?e.adler=Wu(e.adler,n,o,t):e.state.wrap===2&&(e.adler=In(e.adler,n,o,t)),e.next_in+=o,e.total_in+=o,o)}function Xu(e,n){var t=e.max_chain_length,l=e.strstart,o,a,s=e.prev_length,u=e.nice_match,h=e.strstart>e.w_size-zr?e.strstart-(e.w_size-zr):0,d=e.window,m=e.w_mask,p=e.prev,v=e.strstart+Fn,y=d[l+s-1],k=d[l+s];e.prev_length>=e.good_match&&(t>>=2),u>e.lookahead&&(u=e.lookahead);do if(o=n,!(d[o+s]!==k||d[o+s-1]!==y||d[o]!==d[l]||d[++o]!==d[l+1])){l+=2,o++;do;while(d[++l]===d[++o]&&d[++l]===d[++o]&&d[++l]===d[++o]&&d[++l]===d[++o]&&d[++l]===d[++o]&&d[++l]===d[++o]&&d[++l]===d[++o]&&d[++l]===d[++o]&&l<v);if(a=Fn-(v-l),l=v-Fn,a>s){if(e.match_start=n,s=a,a>=u)break;y=d[l+s-1],k=d[l+s]}}while((n=p[n&m])>h&&--t!=0);return s<=e.lookahead?s:e.lookahead}function li(e){var n=e.w_size,t,l,o,a,s;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-zr)){Xl.arraySet(e.window,e.window,n,n,0),e.match_start-=n,e.strstart-=n,e.block_start-=n,l=e.hash_size,t=l;do o=e.head[--t],e.head[t]=o>=n?o-n:0;while(--l);l=n,t=l;do o=e.prev[--t],e.prev[t]=o>=n?o-n:0;while(--l);a+=n}if(e.strm.avail_in===0)break;if(l=Zg(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=l,e.lookahead+e.insert>=qt)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+qt-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<qt)););}while(e.lookahead<zr&&e.strm.avail_in!==0)}function Jg(e,n){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(li(e),e.lookahead===0&&n===Qn)return Sl;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var l=e.block_start+t;if((e.strstart===0||e.strstart>=l)&&(e.lookahead=e.strstart-l,e.strstart=l,zl(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-zr&&(zl(e,!1),e.strm.avail_out===0))return Sl}return e.insert=0,n===Rn?(zl(e,!0),e.strm.avail_out===0?ti:Ti):(e.strstart>e.block_start&&(zl(e,!1),e.strm.avail_out===0),Sl)}function ss(e,n){for(var t,l;;){if(e.lookahead<zr){if(li(e),e.lookahead<zr&&n===Qn)return Sl;if(e.lookahead===0)break}if(t=0,e.lookahead>=qt&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+qt-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-zr&&(e.match_length=Xu(e,t)),e.match_length>=qt)if(l=yr._tr_tally(e,e.strstart-e.match_start,e.match_length-qt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=qt){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+qt-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else l=yr._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(l&&(zl(e,!1),e.strm.avail_out===0))return Sl}return e.insert=e.strstart<qt-1?e.strstart:qt-1,n===Rn?(zl(e,!0),e.strm.avail_out===0?ti:Ti):e.last_lit&&(zl(e,!1),e.strm.avail_out===0)?Sl:fo}function Si(e,n){for(var t,l,o;;){if(e.lookahead<zr){if(li(e),e.lookahead<zr&&n===Qn)return Sl;if(e.lookahead===0)break}if(t=0,e.lookahead>=qt&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+qt-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=qt-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-zr&&(e.match_length=Xu(e,t),e.match_length<=5&&(e.strategy===Pg||e.match_length===qt&&e.strstart-e.match_start>4096)&&(e.match_length=qt-1)),e.prev_length>=qt&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-qt,l=yr._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-qt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+qt-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=qt-1,e.strstart++,l&&(zl(e,!1),e.strm.avail_out===0))return Sl}else if(e.match_available){if(l=yr._tr_tally(e,0,e.window[e.strstart-1]),l&&zl(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Sl}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(l=yr._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<qt-1?e.strstart:qt-1,n===Rn?(zl(e,!0),e.strm.avail_out===0?ti:Ti):e.last_lit&&(zl(e,!1),e.strm.avail_out===0)?Sl:fo}function Qg(e,n){for(var t,l,o,a,s=e.window;;){if(e.lookahead<=Fn){if(li(e),e.lookahead<=Fn&&n===Qn)return Sl;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=qt&&e.strstart>0&&(o=e.strstart-1,l=s[o],l===s[++o]&&l===s[++o]&&l===s[++o])){a=e.strstart+Fn;do;while(l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&o<a);e.match_length=Fn-(a-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=qt?(t=yr._tr_tally(e,1,e.match_length-qt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=yr._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(zl(e,!1),e.strm.avail_out===0))return Sl}return e.insert=0,n===Rn?(zl(e,!0),e.strm.avail_out===0?ti:Ti):e.last_lit&&(zl(e,!1),e.strm.avail_out===0)?Sl:fo}function ep(e,n){for(var t;;){if(e.lookahead===0&&(li(e),e.lookahead===0)){if(n===Qn)return Sl;break}if(e.match_length=0,t=yr._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(zl(e,!1),e.strm.avail_out===0))return Sl}return e.insert=0,n===Rn?(zl(e,!0),e.strm.avail_out===0?ti:Ti):e.last_lit&&(zl(e,!1),e.strm.avail_out===0)?Sl:fo}function tn(e,n,t,l,o){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=l,this.func=o}var Ii;Ii=[new tn(0,0,0,0,Jg),new tn(4,4,8,4,ss),new tn(4,5,16,8,ss),new tn(4,6,32,32,ss),new tn(4,4,16,16,Si),new tn(8,16,32,32,Si),new tn(8,16,128,128,Si),new tn(8,32,128,256,Si),new tn(32,128,258,1024,Si),new tn(32,258,258,4096,Si)];function tp(e){e.window_size=2*e.w_size,Mn(e.head),e.max_lazy_match=Ii[e.level].max_lazy,e.good_match=Ii[e.level].good_length,e.nice_match=Ii[e.level].nice_length,e.max_chain_length=Ii[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=qt-1,e.match_available=0,e.ins_h=0}function lp(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ko,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Xl.Buf16(Gg*2),this.dyn_dtree=new Xl.Buf16((2*Wg+1)*2),this.bl_tree=new Xl.Buf16((2*Ug+1)*2),Mn(this.dyn_ltree),Mn(this.dyn_dtree),Mn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Xl.Buf16(Yg+1),this.heap=new Xl.Buf16(2*os+1),Mn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Xl.Buf16(2*os+1),Mn(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ku(e){var n;return!e||!e.state?Dn(e,kr):(e.total_in=e.total_out=0,e.data_type=Og,n=e.state,n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?Zo:ei,e.adler=n.wrap===2?0:1,n.last_flush=Qn,yr._tr_init(n),en)}function Zu(e){var n=Ku(e);return n===en&&tp(e.state),n}function rp(e,n){return!e||!e.state||e.state.wrap!==2?kr:(e.state.gzhead=n,en)}function Ju(e,n,t,l,o,a){if(!e)return kr;var s=1;if(n===zg&&(n=6),l<0?(s=0,l=-l):l>15&&(s=2,l-=16),o<1||o>Bg||t!==Ko||l<8||l>15||n<0||n>9||a<0||a>Eg)return Dn(e,kr);l===8&&(l=9);var u=new lp;return e.state=u,u.strm=e,u.wrap=s,u.gzhead=null,u.w_bits=l,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+qt-1)/qt),u.window=new Xl.Buf8(u.w_size*2),u.head=new Xl.Buf16(u.hash_size),u.prev=new Xl.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=u.lit_bufsize*4,u.pending_buf=new Xl.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=(1+2)*u.lit_bufsize,u.level=n,u.strategy=a,u.method=t,Zu(e)}function np(e,n){return Ju(e,n,Ko,Hg,Vg,Lg)}function ip(e,n){var t,l,o,a;if(!e||!e.state||n>Uu||n<0)return e?Dn(e,kr):kr;if(l=e.state,!e.output||!e.input&&e.avail_in!==0||l.status===uo&&n!==Rn)return Dn(e,e.avail_out===0?is:kr);if(l.strm=e,t=l.last_flush,l.last_flush=n,l.status===Zo)if(l.wrap===2)e.adler=0,Gt(l,31),Gt(l,139),Gt(l,8),l.gzhead?(Gt(l,(l.gzhead.text?1:0)+(l.gzhead.hcrc?2:0)+(l.gzhead.extra?4:0)+(l.gzhead.name?8:0)+(l.gzhead.comment?16:0)),Gt(l,l.gzhead.time&255),Gt(l,l.gzhead.time>>8&255),Gt(l,l.gzhead.time>>16&255),Gt(l,l.gzhead.time>>24&255),Gt(l,l.level===9?2:l.strategy>=Xo||l.level<2?4:0),Gt(l,l.gzhead.os&255),l.gzhead.extra&&l.gzhead.extra.length&&(Gt(l,l.gzhead.extra.length&255),Gt(l,l.gzhead.extra.length>>8&255)),l.gzhead.hcrc&&(e.adler=In(e.adler,l.pending_buf,l.pending,0)),l.gzindex=0,l.status=as):(Gt(l,0),Gt(l,0),Gt(l,0),Gt(l,0),Gt(l,0),Gt(l,l.level===9?2:l.strategy>=Xo||l.level<2?4:0),Gt(l,Kg),l.status=ei);else{var s=Ko+(l.w_bits-8<<4)<<8,u=-1;l.strategy>=Xo||l.level<2?u=0:l.level<6?u=1:l.level===6?u=2:u=3,s|=u<<6,l.strstart!==0&&(s|=Xg),s+=31-s%31,l.status=ei,ho(l,s),l.strstart!==0&&(ho(l,e.adler>>>16),ho(l,e.adler&65535)),e.adler=1}if(l.status===as)if(l.gzhead.extra){for(o=l.pending;l.gzindex<(l.gzhead.extra.length&65535)&&!(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=In(e.adler,l.pending_buf,l.pending-o,o)),An(e),o=l.pending,l.pending===l.pending_buf_size));)Gt(l,l.gzhead.extra[l.gzindex]&255),l.gzindex++;l.gzhead.hcrc&&l.pending>o&&(e.adler=In(e.adler,l.pending_buf,l.pending-o,o)),l.gzindex===l.gzhead.extra.length&&(l.gzindex=0,l.status=Jo)}else l.status=Jo;if(l.status===Jo)if(l.gzhead.name){o=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=In(e.adler,l.pending_buf,l.pending-o,o)),An(e),o=l.pending,l.pending===l.pending_buf_size)){a=1;break}l.gzindex<l.gzhead.name.length?a=l.gzhead.name.charCodeAt(l.gzindex++)&255:a=0,Gt(l,a)}while(a!==0);l.gzhead.hcrc&&l.pending>o&&(e.adler=In(e.adler,l.pending_buf,l.pending-o,o)),a===0&&(l.gzindex=0,l.status=Qo)}else l.status=Qo;if(l.status===Qo)if(l.gzhead.comment){o=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=In(e.adler,l.pending_buf,l.pending-o,o)),An(e),o=l.pending,l.pending===l.pending_buf_size)){a=1;break}l.gzindex<l.gzhead.comment.length?a=l.gzhead.comment.charCodeAt(l.gzindex++)&255:a=0,Gt(l,a)}while(a!==0);l.gzhead.hcrc&&l.pending>o&&(e.adler=In(e.adler,l.pending_buf,l.pending-o,o)),a===0&&(l.status=ea)}else l.status=ea;if(l.status===ea&&(l.gzhead.hcrc?(l.pending+2>l.pending_buf_size&&An(e),l.pending+2<=l.pending_buf_size&&(Gt(l,e.adler&255),Gt(l,e.adler>>8&255),e.adler=0,l.status=ei)):l.status=ei),l.pending!==0){if(An(e),e.avail_out===0)return l.last_flush=-1,en}else if(e.avail_in===0&&Yu(n)<=Yu(t)&&n!==Rn)return Dn(e,is);if(l.status===uo&&e.avail_in!==0)return Dn(e,is);if(e.avail_in!==0||l.lookahead!==0||n!==Qn&&l.status!==uo){var h=l.strategy===Xo?ep(l,n):l.strategy===Ng?Qg(l,n):Ii[l.level].func(l,n);if((h===ti||h===Ti)&&(l.status=uo),h===Sl||h===ti)return e.avail_out===0&&(l.last_flush=-1),en;if(h===fo&&(n===Dg?yr._tr_align(l):n!==Uu&&(yr._tr_stored_block(l,0,0,!1),n===Mg&&(Mn(l.head),l.lookahead===0&&(l.strstart=0,l.block_start=0,l.insert=0))),An(e),e.avail_out===0))return l.last_flush=-1,en}return n!==Rn?en:l.wrap<=0?Gu:(l.wrap===2?(Gt(l,e.adler&255),Gt(l,e.adler>>8&255),Gt(l,e.adler>>16&255),Gt(l,e.adler>>24&255),Gt(l,e.total_in&255),Gt(l,e.total_in>>8&255),Gt(l,e.total_in>>16&255),Gt(l,e.total_in>>24&255)):(ho(l,e.adler>>>16),ho(l,e.adler&65535)),An(e),l.wrap>0&&(l.wrap=-l.wrap),l.pending!==0?en:Gu)}function op(e){var n;return!e||!e.state?kr:(n=e.state.status,n!==Zo&&n!==as&&n!==Jo&&n!==Qo&&n!==ea&&n!==ei&&n!==uo?Dn(e,kr):(e.state=null,n===ei?Dn(e,Ag):en))}function ap(e,n){var t=n.length,l,o,a,s,u,h,d,m;if(!e||!e.state||(l=e.state,s=l.wrap,s===2||s===1&&l.status!==Zo||l.lookahead))return kr;for(s===1&&(e.adler=Wu(e.adler,n,t,0)),l.wrap=0,t>=l.w_size&&(s===0&&(Mn(l.head),l.strstart=0,l.block_start=0,l.insert=0),m=new Xl.Buf8(l.w_size),Xl.arraySet(m,n,t-l.w_size,l.w_size,0),n=m,t=l.w_size),u=e.avail_in,h=e.next_in,d=e.input,e.avail_in=t,e.next_in=0,e.input=n,li(l);l.lookahead>=qt;){o=l.strstart,a=l.lookahead-(qt-1);do l.ins_h=(l.ins_h<<l.hash_shift^l.window[o+qt-1])&l.hash_mask,l.prev[o&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=o,o++;while(--a);l.strstart=o,l.lookahead=qt-1,li(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=qt-1,l.match_available=0,e.next_in=h,e.input=d,e.avail_in=u,l.wrap=s,en}ln.deflateInit=np;ln.deflateInit2=Ju;ln.deflateReset=Zu;ln.deflateResetKeep=Ku;ln.deflateSetHeader=rp;ln.deflate=ip;ln.deflateEnd=op;ln.deflateSetDictionary=ap;ln.deflateInfo="pako deflate (from Nodeca project)"});var cs=wl(Ri=>{"use strict";var ta=un(),ef=!0,tf=!0;try{String.fromCharCode.apply(null,[0])}catch(e){ef=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){tf=!1}var mo=new ta.Buf8(256);for(var zn=0;zn<256;zn++)mo[zn]=zn>=252?6:zn>=248?5:zn>=240?4:zn>=224?3:zn>=192?2:1;mo[254]=mo[254]=1;Ri.string2buf=function(e){var n,t,l,o,a,s=e.length,u=0;for(o=0;o<s;o++)t=e.charCodeAt(o),(t&64512)==55296&&o+1<s&&(l=e.charCodeAt(o+1),(l&64512)==56320&&(t=65536+(t-55296<<10)+(l-56320),o++)),u+=t<128?1:t<2048?2:t<65536?3:4;for(n=new ta.Buf8(u),a=0,o=0;a<u;o++)t=e.charCodeAt(o),(t&64512)==55296&&o+1<s&&(l=e.charCodeAt(o+1),(l&64512)==56320&&(t=65536+(t-55296<<10)+(l-56320),o++)),t<128?n[a++]=t:t<2048?(n[a++]=192|t>>>6,n[a++]=128|t&63):t<65536?(n[a++]=224|t>>>12,n[a++]=128|t>>>6&63,n[a++]=128|t&63):(n[a++]=240|t>>>18,n[a++]=128|t>>>12&63,n[a++]=128|t>>>6&63,n[a++]=128|t&63);return n};function lf(e,n){if(n<65534&&(e.subarray&&tf||!e.subarray&&ef))return String.fromCharCode.apply(null,ta.shrinkBuf(e,n));for(var t="",l=0;l<n;l++)t+=String.fromCharCode(e[l]);return t}Ri.buf2binstring=function(e){return lf(e,e.length)};Ri.binstring2buf=function(e){for(var n=new ta.Buf8(e.length),t=0,l=n.length;t<l;t++)n[t]=e.charCodeAt(t);return n};Ri.buf2string=function(e,n){var t,l,o,a,s=n||e.length,u=new Array(s*2);for(l=0,t=0;t<s;){if(o=e[t++],o<128){u[l++]=o;continue}if(a=mo[o],a>4){u[l++]=65533,t+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&t<s;)o=o<<6|e[t++]&63,a--;if(a>1){u[l++]=65533;continue}o<65536?u[l++]=o:(o-=65536,u[l++]=55296|o>>10&1023,u[l++]=56320|o&1023)}return lf(u,l)};Ri.utf8border=function(e,n){var t;for(n=n||e.length,n>e.length&&(n=e.length),t=n-1;t>=0&&(e[t]&192)==128;)t--;return t<0||t===0?n:t+mo[e[t]]>n?t:n}});var us=wl((Ak,rf)=>{"use strict";function sp(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}rf.exports=sp});var sf=wl(vo=>{"use strict";var go=Qu(),po=un(),fs=cs(),hs=Yo(),cp=us(),nf=Object.prototype.toString,up=0,ds=4,Fi=0,of=1,af=2,fp=-1,hp=0,dp=8;function ri(e){if(!(this instanceof ri))return new ri(e);this.options=po.assign({level:fp,method:dp,chunkSize:16384,windowBits:15,memLevel:8,strategy:hp,to:""},e||{});var n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new cp,this.strm.avail_out=0;var t=go.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(t!==Fi)throw new Error(hs[t]);if(n.header&&go.deflateSetHeader(this.strm,n.header),n.dictionary){var l;if(typeof n.dictionary=="string"?l=fs.string2buf(n.dictionary):nf.call(n.dictionary)==="[object ArrayBuffer]"?l=new Uint8Array(n.dictionary):l=n.dictionary,t=go.deflateSetDictionary(this.strm,l),t!==Fi)throw new Error(hs[t]);this._dict_set=!0}}ri.prototype.push=function(e,n){var t=this.strm,l=this.options.chunkSize,o,a;if(this.ended)return!1;a=n===~~n?n:n===!0?ds:up,typeof e=="string"?t.input=fs.string2buf(e):nf.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new po.Buf8(l),t.next_out=0,t.avail_out=l),o=go.deflate(t,a),o!==of&&o!==Fi)return this.onEnd(o),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(a===ds||a===af))&&(this.options.to==="string"?this.onData(fs.buf2binstring(po.shrinkBuf(t.output,t.next_out))):this.onData(po.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&o!==of);return a===ds?(o=go.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===Fi):(a===af&&(this.onEnd(Fi),t.avail_out=0),!0)};ri.prototype.onData=function(e){this.chunks.push(e)};ri.prototype.onEnd=function(e){e===Fi&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=po.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function ms(e,n){var t=new ri(n);if(t.push(e,!0),t.err)throw t.msg||hs[t.err];return t.result}function mp(e,n){return n=n||{},n.raw=!0,ms(e,n)}function gp(e,n){return n=n||{},n.gzip=!0,ms(e,n)}vo.Deflate=ri;vo.deflate=ms;vo.deflateRaw=mp;vo.gzip=gp});var uf=wl((Pk,cf)=>{"use strict";var la=30,pp=12;cf.exports=function(n,t){var l,o,a,s,u,h,d,m,p,v,y,k,b,w,x,C,S,_,T,F,R,I,P,O,M;l=n.state,o=n.next_in,O=n.input,a=o+(n.avail_in-5),s=n.next_out,M=n.output,u=s-(t-n.avail_out),h=s+(n.avail_out-257),d=l.dmax,m=l.wsize,p=l.whave,v=l.wnext,y=l.window,k=l.hold,b=l.bits,w=l.lencode,x=l.distcode,C=(1<<l.lenbits)-1,S=(1<<l.distbits)-1;e:do{b<15&&(k+=O[o++]<<b,b+=8,k+=O[o++]<<b,b+=8),_=w[k&C];t:for(;;){if(T=_>>>24,k>>>=T,b-=T,T=_>>>16&255,T===0)M[s++]=_&65535;else if(T&16){F=_&65535,T&=15,T&&(b<T&&(k+=O[o++]<<b,b+=8),F+=k&(1<<T)-1,k>>>=T,b-=T),b<15&&(k+=O[o++]<<b,b+=8,k+=O[o++]<<b,b+=8),_=x[k&S];l:for(;;){if(T=_>>>24,k>>>=T,b-=T,T=_>>>16&255,T&16){if(R=_&65535,T&=15,b<T&&(k+=O[o++]<<b,b+=8,b<T&&(k+=O[o++]<<b,b+=8)),R+=k&(1<<T)-1,R>d){n.msg="invalid distance too far back",l.mode=la;break e}if(k>>>=T,b-=T,T=s-u,R>T){if(T=R-T,T>p&&l.sane){n.msg="invalid distance too far back",l.mode=la;break e}if(I=0,P=y,v===0){if(I+=m-T,T<F){F-=T;do M[s++]=y[I++];while(--T);I=s-R,P=M}}else if(v<T){if(I+=m+v-T,T-=v,T<F){F-=T;do M[s++]=y[I++];while(--T);if(I=0,v<F){T=v,F-=T;do M[s++]=y[I++];while(--T);I=s-R,P=M}}}else if(I+=v-T,T<F){F-=T;do M[s++]=y[I++];while(--T);I=s-R,P=M}for(;F>2;)M[s++]=P[I++],M[s++]=P[I++],M[s++]=P[I++],F-=3;F&&(M[s++]=P[I++],F>1&&(M[s++]=P[I++]))}else{I=s-R;do M[s++]=M[I++],M[s++]=M[I++],M[s++]=M[I++],F-=3;while(F>2);F&&(M[s++]=M[I++],F>1&&(M[s++]=M[I++]))}}else if((T&64)==0){_=x[(_&65535)+(k&(1<<T)-1)];continue l}else{n.msg="invalid distance code",l.mode=la;break e}break}}else if((T&64)==0){_=w[(_&65535)+(k&(1<<T)-1)];continue t}else if(T&32){l.mode=pp;break e}else{n.msg="invalid literal/length code",l.mode=la;break e}break}}while(o<a&&s<h);F=b>>3,o-=F,b-=F<<3,k&=(1<<b)-1,n.next_in=o,n.next_out=s,n.avail_in=o<a?5+(a-o):5-(o-a),n.avail_out=s<h?257+(h-s):257-(s-h),l.hold=k,l.bits=b}});var vf=wl((Nk,pf)=>{"use strict";var ff=un(),Di=15,hf=852,df=592,mf=0,gs=1,gf=2,vp=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],yp=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],kp=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],bp=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];pf.exports=function(n,t,l,o,a,s,u,h){var d=h.bits,m=0,p=0,v=0,y=0,k=0,b=0,w=0,x=0,C=0,S=0,_,T,F,R,I,P=null,O=0,M,A=new ff.Buf16(Di+1),z=new ff.Buf16(Di+1),L=null,E=0,V,q,G;for(m=0;m<=Di;m++)A[m]=0;for(p=0;p<o;p++)A[t[l+p]]++;for(k=d,y=Di;y>=1&&A[y]===0;y--);if(k>y&&(k=y),y===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,h.bits=1,0;for(v=1;v<y&&A[v]===0;v++);for(k<v&&(k=v),x=1,m=1;m<=Di;m++)if(x<<=1,x-=A[m],x<0)return-1;if(x>0&&(n===mf||y!==1))return-1;for(z[1]=0,m=1;m<Di;m++)z[m+1]=z[m]+A[m];for(p=0;p<o;p++)t[l+p]!==0&&(u[z[t[l+p]]++]=p);if(n===mf?(P=L=u,M=19):n===gs?(P=vp,O-=257,L=yp,E-=257,M=256):(P=kp,L=bp,M=-1),S=0,p=0,m=v,I=s,b=k,w=0,F=-1,C=1<<k,R=C-1,n===gs&&C>hf||n===gf&&C>df)return 1;for(;;){V=m-w,u[p]<M?(q=0,G=u[p]):u[p]>M?(q=L[E+u[p]],G=P[O+u[p]]):(q=32+64,G=0),_=1<<m-w,T=1<<b,v=T;do T-=_,a[I+(S>>w)+T]=V<<24|q<<16|G|0;while(T!==0);for(_=1<<m-1;S&_;)_>>=1;if(_!==0?(S&=_-1,S+=_):S=0,p++,--A[m]==0){if(m===y)break;m=t[l+u[p]]}if(m>k&&(S&R)!==F){for(w===0&&(w=k),I+=v,b=m-w,x=1<<b;b+w<y&&(x-=A[b+w],!(x<=0));)b++,x<<=1;if(C+=1<<b,n===gs&&C>hf||n===gf&&C>df)return 1;F=S&R,a[F]=k<<24|b<<16|I-s|0}}return S!==0&&(a[I+S]=m-w<<24|64<<16|0),h.bits=k,0}});var Jf=wl(Pr=>{"use strict";var hr=un(),ps=rs(),rn=ns(),wp=uf(),yo=vf(),xp=0,yf=1,kf=2,bf=4,_p=5,ra=6,ni=0,Cp=1,$p=2,br=-2,wf=-3,vs=-4,Tp=-5,xf=8,_f=1,Cf=2,$f=3,Tf=4,Sf=5,If=6,Rf=7,Ff=8,Df=9,Mf=10,na=11,hn=12,ys=13,Af=14,ks=15,zf=16,Pf=17,Nf=18,Ef=19,ia=20,oa=21,Lf=22,Of=23,Bf=24,Hf=25,Vf=26,bs=27,qf=28,jf=29,hl=30,ws=31,Sp=32,Ip=852,Rp=592,Fp=15,Dp=Fp;function Wf(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function Mp(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new hr.Buf16(320),this.work=new hr.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Uf(e){var n;return!e||!e.state?br:(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=n.wrap&1),n.mode=_f,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new hr.Buf32(Ip),n.distcode=n.distdyn=new hr.Buf32(Rp),n.sane=1,n.back=-1,ni)}function Gf(e){var n;return!e||!e.state?br:(n=e.state,n.wsize=0,n.whave=0,n.wnext=0,Uf(e))}function Yf(e,n){var t,l;return!e||!e.state||(l=e.state,n<0?(t=0,n=-n):(t=(n>>4)+1,n<48&&(n&=15)),n&&(n<8||n>15))?br:(l.window!==null&&l.wbits!==n&&(l.window=null),l.wrap=t,l.wbits=n,Gf(e))}function Xf(e,n){var t,l;return e?(l=new Mp,e.state=l,l.window=null,t=Yf(e,n),t!==ni&&(e.state=null),t):br}function Ap(e){return Xf(e,Dp)}var Kf=!0,xs,_s;function zp(e){if(Kf){var n;for(xs=new hr.Buf32(512),_s=new hr.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(yo(yf,e.lens,0,288,xs,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;yo(kf,e.lens,0,32,_s,0,e.work,{bits:5}),Kf=!1}e.lencode=xs,e.lenbits=9,e.distcode=_s,e.distbits=5}function Zf(e,n,t,l){var o,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new hr.Buf8(a.wsize)),l>=a.wsize?(hr.arraySet(a.window,n,t-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(o=a.wsize-a.wnext,o>l&&(o=l),hr.arraySet(a.window,n,t-l,o,a.wnext),l-=o,l?(hr.arraySet(a.window,n,t-l,l,0),a.wnext=l,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}function Pp(e,n){var t,l,o,a,s,u,h,d,m,p,v,y,k,b,w=0,x,C,S,_,T,F,R,I,P=new hr.Buf8(4),O,M,A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return br;t=e.state,t.mode===hn&&(t.mode=ys),s=e.next_out,o=e.output,h=e.avail_out,a=e.next_in,l=e.input,u=e.avail_in,d=t.hold,m=t.bits,p=u,v=h,I=ni;e:for(;;)switch(t.mode){case _f:if(t.wrap===0){t.mode=ys;break}for(;m<16;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if(t.wrap&2&&d===35615){t.check=0,P[0]=d&255,P[1]=d>>>8&255,t.check=rn(t.check,P,2,0),d=0,m=0,t.mode=Cf;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",t.mode=hl;break}if((d&15)!==xf){e.msg="unknown compression method",t.mode=hl;break}if(d>>>=4,m-=4,R=(d&15)+8,t.wbits===0)t.wbits=R;else if(R>t.wbits){e.msg="invalid window size",t.mode=hl;break}t.dmax=1<<R,e.adler=t.check=1,t.mode=d&512?Mf:hn,d=0,m=0;break;case Cf:for(;m<16;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if(t.flags=d,(t.flags&255)!==xf){e.msg="unknown compression method",t.mode=hl;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=hl;break}t.head&&(t.head.text=d>>8&1),t.flags&512&&(P[0]=d&255,P[1]=d>>>8&255,t.check=rn(t.check,P,2,0)),d=0,m=0,t.mode=$f;case $f:for(;m<32;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}t.head&&(t.head.time=d),t.flags&512&&(P[0]=d&255,P[1]=d>>>8&255,P[2]=d>>>16&255,P[3]=d>>>24&255,t.check=rn(t.check,P,4,0)),d=0,m=0,t.mode=Tf;case Tf:for(;m<16;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}t.head&&(t.head.xflags=d&255,t.head.os=d>>8),t.flags&512&&(P[0]=d&255,P[1]=d>>>8&255,t.check=rn(t.check,P,2,0)),d=0,m=0,t.mode=Sf;case Sf:if(t.flags&1024){for(;m<16;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}t.length=d,t.head&&(t.head.extra_len=d),t.flags&512&&(P[0]=d&255,P[1]=d>>>8&255,t.check=rn(t.check,P,2,0)),d=0,m=0}else t.head&&(t.head.extra=null);t.mode=If;case If:if(t.flags&1024&&(y=t.length,y>u&&(y=u),y&&(t.head&&(R=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),hr.arraySet(t.head.extra,l,a,y,R)),t.flags&512&&(t.check=rn(t.check,l,y,a)),u-=y,a+=y,t.length-=y),t.length))break e;t.length=0,t.mode=Rf;case Rf:if(t.flags&2048){if(u===0)break e;y=0;do R=l[a+y++],t.head&&R&&t.length<65536&&(t.head.name+=String.fromCharCode(R));while(R&&y<u);if(t.flags&512&&(t.check=rn(t.check,l,y,a)),u-=y,a+=y,R)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Ff;case Ff:if(t.flags&4096){if(u===0)break e;y=0;do R=l[a+y++],t.head&&R&&t.length<65536&&(t.head.comment+=String.fromCharCode(R));while(R&&y<u);if(t.flags&512&&(t.check=rn(t.check,l,y,a)),u-=y,a+=y,R)break e}else t.head&&(t.head.comment=null);t.mode=Df;case Df:if(t.flags&512){for(;m<16;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if(d!==(t.check&65535)){e.msg="header crc mismatch",t.mode=hl;break}d=0,m=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=hn;break;case Mf:for(;m<32;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}e.adler=t.check=Wf(d),d=0,m=0,t.mode=na;case na:if(t.havedict===0)return e.next_out=s,e.avail_out=h,e.next_in=a,e.avail_in=u,t.hold=d,t.bits=m,$p;e.adler=t.check=1,t.mode=hn;case hn:if(n===_p||n===ra)break e;case ys:if(t.last){d>>>=m&7,m-=m&7,t.mode=bs;break}for(;m<3;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}switch(t.last=d&1,d>>>=1,m-=1,d&3){case 0:t.mode=Af;break;case 1:if(zp(t),t.mode=ia,n===ra){d>>>=2,m-=2;break e}break;case 2:t.mode=Pf;break;case 3:e.msg="invalid block type",t.mode=hl}d>>>=2,m-=2;break;case Af:for(d>>>=m&7,m-=m&7;m<32;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if((d&65535)!=(d>>>16^65535)){e.msg="invalid stored block lengths",t.mode=hl;break}if(t.length=d&65535,d=0,m=0,t.mode=ks,n===ra)break e;case ks:t.mode=zf;case zf:if(y=t.length,y){if(y>u&&(y=u),y>h&&(y=h),y===0)break e;hr.arraySet(o,l,a,y,s),u-=y,a+=y,h-=y,s+=y,t.length-=y;break}t.mode=hn;break;case Pf:for(;m<14;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if(t.nlen=(d&31)+257,d>>>=5,m-=5,t.ndist=(d&31)+1,d>>>=5,m-=5,t.ncode=(d&15)+4,d>>>=4,m-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=hl;break}t.have=0,t.mode=Nf;case Nf:for(;t.have<t.ncode;){for(;m<3;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}t.lens[A[t.have++]]=d&7,d>>>=3,m-=3}for(;t.have<19;)t.lens[A[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,O={bits:t.lenbits},I=yo(xp,t.lens,0,19,t.lencode,0,t.work,O),t.lenbits=O.bits,I){e.msg="invalid code lengths set",t.mode=hl;break}t.have=0,t.mode=Ef;case Ef:for(;t.have<t.nlen+t.ndist;){for(;w=t.lencode[d&(1<<t.lenbits)-1],x=w>>>24,C=w>>>16&255,S=w&65535,!(x<=m);){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if(S<16)d>>>=x,m-=x,t.lens[t.have++]=S;else{if(S===16){for(M=x+2;m<M;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if(d>>>=x,m-=x,t.have===0){e.msg="invalid bit length repeat",t.mode=hl;break}R=t.lens[t.have-1],y=3+(d&3),d>>>=2,m-=2}else if(S===17){for(M=x+3;m<M;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}d>>>=x,m-=x,R=0,y=3+(d&7),d>>>=3,m-=3}else{for(M=x+7;m<M;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}d>>>=x,m-=x,R=0,y=11+(d&127),d>>>=7,m-=7}if(t.have+y>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=hl;break}for(;y--;)t.lens[t.have++]=R}}if(t.mode===hl)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=hl;break}if(t.lenbits=9,O={bits:t.lenbits},I=yo(yf,t.lens,0,t.nlen,t.lencode,0,t.work,O),t.lenbits=O.bits,I){e.msg="invalid literal/lengths set",t.mode=hl;break}if(t.distbits=6,t.distcode=t.distdyn,O={bits:t.distbits},I=yo(kf,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,O),t.distbits=O.bits,I){e.msg="invalid distances set",t.mode=hl;break}if(t.mode=ia,n===ra)break e;case ia:t.mode=oa;case oa:if(u>=6&&h>=258){e.next_out=s,e.avail_out=h,e.next_in=a,e.avail_in=u,t.hold=d,t.bits=m,wp(e,v),s=e.next_out,o=e.output,h=e.avail_out,a=e.next_in,l=e.input,u=e.avail_in,d=t.hold,m=t.bits,t.mode===hn&&(t.back=-1);break}for(t.back=0;w=t.lencode[d&(1<<t.lenbits)-1],x=w>>>24,C=w>>>16&255,S=w&65535,!(x<=m);){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if(C&&(C&240)==0){for(_=x,T=C,F=S;w=t.lencode[F+((d&(1<<_+T)-1)>>_)],x=w>>>24,C=w>>>16&255,S=w&65535,!(_+x<=m);){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}d>>>=_,m-=_,t.back+=_}if(d>>>=x,m-=x,t.back+=x,t.length=S,C===0){t.mode=Vf;break}if(C&32){t.back=-1,t.mode=hn;break}if(C&64){e.msg="invalid literal/length code",t.mode=hl;break}t.extra=C&15,t.mode=Lf;case Lf:if(t.extra){for(M=t.extra;m<M;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}t.length+=d&(1<<t.extra)-1,d>>>=t.extra,m-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Of;case Of:for(;w=t.distcode[d&(1<<t.distbits)-1],x=w>>>24,C=w>>>16&255,S=w&65535,!(x<=m);){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if((C&240)==0){for(_=x,T=C,F=S;w=t.distcode[F+((d&(1<<_+T)-1)>>_)],x=w>>>24,C=w>>>16&255,S=w&65535,!(_+x<=m);){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}d>>>=_,m-=_,t.back+=_}if(d>>>=x,m-=x,t.back+=x,C&64){e.msg="invalid distance code",t.mode=hl;break}t.offset=S,t.extra=C&15,t.mode=Bf;case Bf:if(t.extra){for(M=t.extra;m<M;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}t.offset+=d&(1<<t.extra)-1,d>>>=t.extra,m-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=hl;break}t.mode=Hf;case Hf:if(h===0)break e;if(y=v-h,t.offset>y){if(y=t.offset-y,y>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=hl;break}y>t.wnext?(y-=t.wnext,k=t.wsize-y):k=t.wnext-y,y>t.length&&(y=t.length),b=t.window}else b=o,k=s-t.offset,y=t.length;y>h&&(y=h),h-=y,t.length-=y;do o[s++]=b[k++];while(--y);t.length===0&&(t.mode=oa);break;case Vf:if(h===0)break e;o[s++]=t.length,h--,t.mode=oa;break;case bs:if(t.wrap){for(;m<32;){if(u===0)break e;u--,d|=l[a++]<<m,m+=8}if(v-=h,e.total_out+=v,t.total+=v,v&&(e.adler=t.check=t.flags?rn(t.check,o,v,s-v):ps(t.check,o,v,s-v)),v=h,(t.flags?d:Wf(d))!==t.check){e.msg="incorrect data check",t.mode=hl;break}d=0,m=0}t.mode=qf;case qf:if(t.wrap&&t.flags){for(;m<32;){if(u===0)break e;u--,d+=l[a++]<<m,m+=8}if(d!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=hl;break}d=0,m=0}t.mode=jf;case jf:I=Cp;break e;case hl:I=wf;break e;case ws:return vs;case Sp:default:return br}return e.next_out=s,e.avail_out=h,e.next_in=a,e.avail_in=u,t.hold=d,t.bits=m,(t.wsize||v!==e.avail_out&&t.mode<hl&&(t.mode<bs||n!==bf))&&Zf(e,e.output,e.next_out,v-e.avail_out)?(t.mode=ws,vs):(p-=e.avail_in,v-=e.avail_out,e.total_in+=p,e.total_out+=v,t.total+=v,t.wrap&&v&&(e.adler=t.check=t.flags?rn(t.check,o,v,e.next_out-v):ps(t.check,o,v,e.next_out-v)),e.data_type=t.bits+(t.last?64:0)+(t.mode===hn?128:0)+(t.mode===ia||t.mode===ks?256:0),(p===0&&v===0||n===bf)&&I===ni&&(I=Tp),I)}function Np(e){if(!e||!e.state)return br;var n=e.state;return n.window&&(n.window=null),e.state=null,ni}function Ep(e,n){var t;return!e||!e.state||(t=e.state,(t.wrap&2)==0)?br:(t.head=n,n.done=!1,ni)}function Lp(e,n){var t=n.length,l,o,a;return!e||!e.state||(l=e.state,l.wrap!==0&&l.mode!==na)?br:l.mode===na&&(o=1,o=ps(o,n,t,0),o!==l.check)?wf:(a=Zf(e,n,t,t),a?(l.mode=ws,vs):(l.havedict=1,ni))}Pr.inflateReset=Gf;Pr.inflateReset2=Yf;Pr.inflateResetKeep=Uf;Pr.inflateInit=Ap;Pr.inflateInit2=Xf;Pr.inflate=Pp;Pr.inflateEnd=Np;Pr.inflateGetHeader=Ep;Pr.inflateSetDictionary=Lp;Pr.inflateInfo="pako inflate (from Nodeca project)"});var Cs=wl((Lk,Qf)=>{"use strict";Qf.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var th=wl((Ok,eh)=>{"use strict";function Op(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}eh.exports=Op});var rh=wl(bo=>{"use strict";var Mi=Jf(),ko=un(),aa=cs(),yl=Cs(),$s=Yo(),Bp=us(),Hp=th(),lh=Object.prototype.toString;function ii(e){if(!(this instanceof ii))return new ii(e);this.options=ko.assign({chunkSize:16384,windowBits:0,to:""},e||{});var n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(e&&e.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15)==0&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bp,this.strm.avail_out=0;var t=Mi.inflateInit2(this.strm,n.windowBits);if(t!==yl.Z_OK)throw new Error($s[t]);if(this.header=new Hp,Mi.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=aa.string2buf(n.dictionary):lh.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(t=Mi.inflateSetDictionary(this.strm,n.dictionary),t!==yl.Z_OK)))throw new Error($s[t])}ii.prototype.push=function(e,n){var t=this.strm,l=this.options.chunkSize,o=this.options.dictionary,a,s,u,h,d,m=!1;if(this.ended)return!1;s=n===~~n?n:n===!0?yl.Z_FINISH:yl.Z_NO_FLUSH,typeof e=="string"?t.input=aa.binstring2buf(e):lh.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new ko.Buf8(l),t.next_out=0,t.avail_out=l),a=Mi.inflate(t,yl.Z_NO_FLUSH),a===yl.Z_NEED_DICT&&o&&(a=Mi.inflateSetDictionary(this.strm,o)),a===yl.Z_BUF_ERROR&&m===!0&&(a=yl.Z_OK,m=!1),a!==yl.Z_STREAM_END&&a!==yl.Z_OK)return this.onEnd(a),this.ended=!0,!1;t.next_out&&(t.avail_out===0||a===yl.Z_STREAM_END||t.avail_in===0&&(s===yl.Z_FINISH||s===yl.Z_SYNC_FLUSH))&&(this.options.to==="string"?(u=aa.utf8border(t.output,t.next_out),h=t.next_out-u,d=aa.buf2string(t.output,u),t.next_out=h,t.avail_out=l-h,h&&ko.arraySet(t.output,t.output,u,h,0),this.onData(d)):this.onData(ko.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(m=!0)}while((t.avail_in>0||t.avail_out===0)&&a!==yl.Z_STREAM_END);return a===yl.Z_STREAM_END&&(s=yl.Z_FINISH),s===yl.Z_FINISH?(a=Mi.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===yl.Z_OK):(s===yl.Z_SYNC_FLUSH&&(this.onEnd(yl.Z_OK),t.avail_out=0),!0)};ii.prototype.onData=function(e){this.chunks.push(e)};ii.prototype.onEnd=function(e){e===yl.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ko.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Ts(e,n){var t=new ii(n);if(t.push(e,!0),t.err)throw t.msg||$s[t.err];return t.result}function Vp(e,n){return n=n||{},n.raw=!0,Ts(e,n)}bo.Inflate=ii;bo.inflate=Ts;bo.inflateRaw=Vp;bo.ungzip=Ts});var oh=wl((Hk,ih)=>{"use strict";var qp=un().assign,jp=sf(),Wp=rh(),Up=Cs(),nh={};qp(nh,jp,Wp,Up);ih.exports=nh});function Ai(e){$("#luckysheet-cell-loading").find("span").text(e).end().show()}function wo(){$("#luckysheet-cell-loading").hide()}var Ss=Me(()=>{});var Gp,xe,Jt=Me(()=>{xi();Ut();Kt();Yt();Et();Ke();Gp={deepCopyFlowDataState:!1,deepCopyFlowDataCache:"",deepCopyFlowDataWorker:null,deepCopyFlowData:function(e){let n=this;return n.deepCopyFlowDataState?(n.deepCopyFlowDataWorker!=null&&n.deepCopyFlowDataWorker.terminate(),n.deepCopyFlowDataCache):(e==null&&(e=f.flowdata),$.extend(!0,[],e))},webWorkerFlowDataCache:function(e){let n=this;try{n.deepCopyFlowDataWorker!=null&&n.deepCopyFlowDataWorker.terminate();let t="data:text/javascript;chartset=US-ASCII,onmessage = function (e) { postMessage(e.data); };";n.deepCopyFlowDataState=!1;let l;if(fr.isIE()==1){let o="self.onmessage=function(e){postMessage(e.data);}";l=new Worker("./plugins/Worker-helper.js"),l.postMessage(o)}else l=new Worker(t);n.deepCopyFlowDataWorker=l,l.postMessage(e),l.onmessage=function(o){n.deepCopyFlowDataCache=o.data,n.deepCopyFlowDataState=!0}}catch(t){n.deepCopyFlowDataCache=$.extend(!0,[],e)}},controlHandler:function(e,n){let l=this.deepCopyFlowData(f.flowdata),o=n||f.luckysheet_select_save[f.luckysheet_select_save.length-1],a=o.row==null?0:o.row[0],s=o.column==null?0:o.column[0],u=e.length,h=e[0].length,d=a+u-l.length,m=s+h-l[0].length;(d>0||m>0)&&(l=cl([].concat(l),d,m,!0));for(let p=0;p<u;p++){let v=[].concat(l[p+a]);for(let y=0;y<h;y++){let k="";e[p]!=null&&e[p][y]!=null&&(k=e[p][y]),v[y+s]=k}l[p+a]=v}d>0||m>0?Kl(l[0].length,l.length,l,null,f.luckysheet_select_save,"datachangeAll"):zi(l,f.luckysheet_select_save)},clearRangeByindex:function(e,n,t,l,o){let a=Z(o),s=$.extend(!0,[],f.luckysheetfile[a].data);for(let u=e;u<=n;u++){let h=[].concat(s[u]);for(let d=t;d<=l;d++)g.delFunctionGroup(u,d),g.execFunctionGroup(u,d,""),h[d]=null;s[u]=h}if(o==f.currentSheetIndex){let u=n-e+1,h=l-t+1;u>5e3?Ze(s,[{row:[e,n],column:[t,l]}]):zi(s,{row:[e,n],column:[t,l]})}else f.luckysheetfile[a].data=s},controlHandlerD:function(e){let t=this.deepCopyFlowData(f.flowdata),l=f.luckysheet_select_save[f.luckysheet_select_save.length-1],o=l.row[0],a=l.row[1],s=l.column[0],u=l.column[1],h=e.length,d=e[0].length,m=o+h-t.length,p=s+d-t[0].length;(m>0||p>0)&&(t=cl([].concat(t),m,p,!0));for(let y=o;y<=a;y++)for(let k=s;k<=u;k++)t[y][k]=null;for(let y=0;y<h;y++)for(let k=0;k<d;k++)t[o+y][s+k]=e[y][k];let v=[{row:[o,a],column:[s,u]},{row:[o,o+h-1],column:[s,s+d-1]}];Ze(t,v)}},xe=Gp});function xo(e){let n={};if(N(e)=="array")for(let t=0;t<e.length;t++){let l=e[t].r,o=e[t].c,a=e[t].f;if(f.flowdata[l][o]!=null&&f.flowdata[l][o].f!=null&&f.flowdata[l][o].f==a){l+"_"+o in n&&(n=Yp(n,l,o));let s=e[t].data,u=s.length,h=1;if(N(s[0])=="array"&&(h=s[0].length),Xp({row:[l,l+u-1],column:[o,o+h-1]},f.flowdata))for(let d=0;d<u;d++)for(let m=0;m<h;m++){let p=l+d,v=o+m;N(s[0])=="array"?n[p+"_"+v]={v:s[d][m],r:l,c:o}:n[p+"_"+v]={v:s[d],r:l,c:o}}else n[l+"_"+o]={v:"#SPILL!",r:l,c:o}}}return n}function Yp(e,n,t){let l=e[n+"_"+t].r,o=e[n+"_"+t].c;for(let a in e)a==l+"_"+o?e[a].v="#SPILL!":e[a].r==l&&e[a].c==o&&delete e[a];return e}function Xp(e,n){let t=e.row[0],l=e.row[1],o=e.column[0],a=e.column[1],s=!0;for(let u=t;u<=l;u++)for(let h=o;h<=a;h++)if(!(u==t&&h==o)&&n[u][h]!=null&&n[u][h].v!=null&&n[u][h].v.toString()!=""){s=!1;break}return s}function ah(e,n){let t=f.luckysheetfile[Z(f.currentSheetIndex)].dynamicArray==null?[]:f.luckysheetfile[Z(f.currentSheetIndex)].dynamicArray,l=xo(t);if(e+"_"+n in l&&l[e+"_"+n].v!="#SPILL!"){let o=l[e+"_"+n].r,a=l[e+"_"+n].c,s=f.flowdata[o][a].f,u,h;for(let b=0;b<t.length;b++)t[b].f==s&&(u=t[b].data.length,N(t[b].data[0])=="array"?h=t[b].data[0].length:h=1);let d=o+u-1,m=a+h-1,p=f.visibledatarow[d],v=o-1==-1?0:f.visibledatarow[o-1],y=f.visibledatacolumn[m],k=a-1==-1?0:f.visibledatacolumn[a-1];$("#luckysheet-dynamicArray-hightShow").css({left:k,width:y-k-1,top:v,height:p-v-1,display:"block"})}else $("#luckysheet-dynamicArray-hightShow").hide()}var sa=Me(()=>{ht();Et();Ke()});function wr(e){let n;if(document.createRange)if(e.innerHTML!=e.innerText||e.innerHTML=="")e.focus(),n=window.getSelection(),n.selectAllChildren(e),n.collapseToEnd();else{let t=e.innerText.length;n=document.createRange(),n.selectNodeContents(e),n.setStart(e.childNodes[0],t),n.collapse(!0);let l=window.getSelection();l.removeAllRanges(),l.addRange(n)}else document.selection&&(n=document.body.createTextRange(),n.moveToElementText(e),n.collapse(!1),n.select())}function xr(e){e.target.classList&&(e.target.classList.contains("luckysheet-cols-rows-shift-left")||e.target.classList.contains("luckysheet-cols-rows-shift-right"))||!$(e.target).hasClass("luckysheet-mousedown-cancel")&&$(e.target).filter("[class*='sp-palette']").length==0&&$(e.target).filter("[class*='sp-thumb']").length==0&&$(e.target).filter("[class*='sp-']").length==0&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide(),f.luckysheet_cols_menu_status=!1)}function sh(e){if(window.getSelection){let n=document.createRange();n.selectNodeContents(e),n.startContainer&&ca(n.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(n))}else if(document.selection){let n=document.body.createTextRange();n.moveToElementText(e),n.select()}}function ch(e){if(window.getSelection){let t=document.createRange();var n=e.firstChild;t.setStart(n,0),t.setEnd(n,n.length),t.startContainer&&ca(t.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(t))}else if(document.selection){let t=document.body.createTextRange();t.moveToElementText(e),t.select()}}function uh(e,n){if(window.getSelection){let o=document.createRange();var t=e.firstChild,l=n.firstChild;o.setStart(t,0),o.setEnd(l,l.length),o.startContainer&&ca(o.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(o))}}function fh(e,n){if(window.getSelection){let l=document.createRange();var t=e.firstChild;n>t.length?n=t.length:n<0&&(n=0),l.setStart(t,n),l.collapse(!0),l.startContainer&&ca(l.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(l))}}function ca(e){return e===document.body?!1:document.body.contains(e)}var dn=Me(()=>{Ke()});function _l(e){return e&&e.ct!=null&&e.ct.t=="inlineStr"&&e.ct.s!=null&&e.ct.s.length>0}function Pi(e){return e!=null&&e.t=="inlineStr"&&e.s!=null&&e.s.length>0}function mh(e,n,t,l){var o=window.getSelection(),a;o.type=="None"?a=f.inlineStringEditRange:a=o.getRangeAt(0);let s=a.commonAncestorContainer,u;s.id=="luckysheet-rich-text-editor"?u=$(s):u=$(s).closest("#luckysheet-rich-text-editor");let h=$(s).closest("#luckysheet-functionbox-cell");if(u.length==0&&h.length==0&&f.inlineStringEditRange!=null&&(a=f.inlineStringEditRange,s=a.commonAncestorContainer,s.id=="luckysheet-rich-text-editor"?u=$(s):u=$(s).closest("#luckysheet-rich-text-editor"),h=$(s).closest("#luckysheet-functionbox-cell")),a.collapsed===!0)return;let d=a.endContainer,m=a.startContainer,p=a.endOffset,v=a.startOffset;if(u.length>0){if(m===d){let y=m.parentNode,k,b=!1,w=y.innerText;u.html().substr(0,5)!="<span"&&(b=!0);let C="",S="",_="",T=0,F=v,R=p,I=w.length;C=w.substring(T,F),S=w.substring(F,R),_=w.substring(R,I);let P="";if(C!=""){let M=y.style.cssText;if(b){let A=$(y).closest("#luckysheet-input-box").get(0);A!=null&&(M=Rs(A.style.cssText,M))}P+="<span style='"+M+"'>"+C+"</span>"}if(S!=""){let M=ua(y.style.cssText,n,t);if(b){let A=$(y).closest("#luckysheet-input-box").get(0);A!=null&&(M=Rs(A.style.cssText,M))}P+="<span style='"+M+"'>"+S+"</span>"}if(_!=""){let M=y.style.cssText;if(b){let A=$(y).closest("#luckysheet-input-box").get(0);A!=null&&(M=Rs(A.style.cssText,M))}P+="<span style='"+M+"'>"+_+"</span>"}m.parentNode.tagName=="SPAN"?(k=u.find("span").index(y),$(y).replaceWith(P)):(k=0,$(y).html(P));let O=0;T==F?O=k:O=k+1,ch(u.find("span").get(O))}else if(m.parentNode.tagName=="SPAN"&&d.parentNode.tagName=="SPAN"){let y=m.parentNode,k,b=d.parentNode,w;k=u.find("span").index(y),w=u.find("span").index(b);let x=y.innerHTML,C=b.innerHTML,S="",_="",T="",F="",R=0,I=v,P=p,O=C.length;S=x.substring(R,I),_=x.substring(I,x.length),T=C.substring(0,P),F=C.substring(P,O);let M=u.find("span"),A=M.slice(k,w+1),z="";for(let V=0;V<k;V++){let q=M.get(V),G=q.innerHTML;z+="<span style='"+q.style.cssText+"'>"+G+"</span>"}if(S!=""&&(z+="<span style='"+y.style.cssText+"'>"+S+"</span>"),_!=""){let V=ua(y.style.cssText,n,t);z+="<span style='"+V+"'>"+_+"</span>"}if(k<w)for(let V=k+1;V<w;V++){let q=M.get(V),G=q.innerHTML,X=ua(q.style.cssText,n,t);z+="<span style='"+X+"'>"+G+"</span>"}if(T!=""){let V=ua(b.style.cssText,n,t);z+="<span style='"+V+"'>"+T+"</span>"}F!=""&&(z+="<span style='"+b.style.cssText+"'>"+F+"</span>");for(let V=w+1;V<M.length;V++){let q=M.get(V),G=q.innerHTML;z+="<span style='"+q.style.cssText+"'>"+G+"</span>"}u.html(z);let L,E;R==I?(L=k,E=w):(L=k+1,E=w+1),M=u.find("span"),uh(M.get(L),M.get(E))}}else h.length>0}function gh(e){var n=window.getSelection();if(n.type=="None")return;var t=n.getRangeAt(0);let l=t.commonAncestorContainer,o;l.id=="luckysheet-rich-text-editor"?o=$(l):o=$(l).closest("#luckysheet-rich-text-editor");let a=$(l).closest("#luckysheet-functionbox-cell"),s=t.endContainer,u=t.startContainer,h=t.endOffset,d=t.startOffset;if(o.length>0){let m=u.parentNode;u.id=="luckysheet-rich-text-editor"&&(m=$(u).find("span"),m.length==0&&(u.innerHTML=`<span>${u.innerText}</span>`,m=$(u).find("span")),m=m.get(m.length-1),d=m.innerHTML.length),t.collapsed===!1&&t.deleteContents();let p=m.innerText,v="",y="",k=0,b=d;v=p.substring(k,b),y=p.substring(b,p.length);let w,x;if(u.parentNode.tagName=="SPAN"){let C=o.find("span");if(w=C.index(m),w==C.length-1&&y==""){let S=C[w].innerHTML;S.substr(S.length-1,1)==`
`?x="<span style='"+m.style.cssText+"'>"+v+`
</span>`:x="<span style='"+m.style.cssText+"'>"+v+`

</span>`}else x="<span style='"+m.style.cssText+"'>"+v+`
`+y+"</span>";$(m).replaceWith(x)}else{let C=m.style.cssText;if(y==""?x="<span style='"+C+"'>"+v+`

</span>`:x="<span style='"+C+"'>"+v+`
`+y+"</span>",u.id=="luckysheet-rich-text-editor"){$(m).replaceWith(x);let S=o.find("span");w=S.length-1,d=S.get(w).innerHTML.length-1}else $(m).html(x),w=0}fh(o.find("span").get(w),d+1)}else a.length>0}function ph(e,n,t){if(e.ct==null)return;let l=e.ct.s;if(l!=null)for(let o=0;o<l.length;o++){let a=l[o];a[n]=t}}function vh(e){let n=[],t,l=null;for(let o=0;o<e.length;o++){let a=e.get(o),s=Is(a.style.cssText),u=JSON.stringify(s),h=a.innerText;h=h.replace(/\n/g,`\r
`),u==l?t.v+=h:(s.v=h,n.push(s),l=u,t=s)}return n}function Is(e){if(e==null||e.length==0)return{};let n=e.split(";"),t=Q(),l=t.fontarray,o=t.fontjson,a={ff:l[0],fc:"#000000",fs:10,cl:0,un:0,bl:0,it:0};return n.forEach(s=>{s=s.toLowerCase();let u=Pl(s.substr(0,s.indexOf(":"))),h=Pl(s.substr(s.indexOf(":")+1));if(u=="font-weight"&&(h=="bold"?a.bl=1:a.bl=0),u=="font-style"&&(h=="italic"?a.it=1:a.it=0),u=="font-family"){let d=o[h];d==null?a.ff=h:a.ff=d}u=="font-size"&&(a.fs=parseInt(h)),u=="color"&&(a.fc=h),u=="text-decoration"&&(a.cl=1),u=="border-bottom"&&(a.un=1),u=="lucky-strike"&&(a.cl=h),u=="lucky-underline"&&(a.un=h)}),a}function kh(e,n){let t=e.split(";");if(n==null||n.length==0)return e;if(e.indexOf(n)>-1)for(let l=0;l<t.length;l++){let o=t[l];o=o.toLowerCase();let a=Pl(o.substr(0,o.indexOf(":"))),s=Pl(o.substr(o.indexOf(":")+1));if(a==n)return s}return""}function Kp(e,n,t){let l=e.split(";"),o="";if(n==null||n.length==0)return e;if(e.indexOf(n)>-1)for(let a=0;a<l.length;a++){let s=l[a];s=s.toLowerCase();let u=Pl(s.substr(0,s.indexOf(":"))),h=Pl(s.substr(s.indexOf(":")+1));u==n?o+=u+":"+t+";":u.length>0&&(o+=u+":"+h+";")}else n.length>0&&(e+=n+":"+t+";",o=e);return o}function Zp(e,n){let t=e.split(";"),l="",o=n;if(n==null||n.length==0)return e;if(n in yh&&(n=yh[n]),e.indexOf(n)>-1)for(let a=0;a<t.length;a++){let s=t[a];s=s.toLowerCase();let u=Pl(s.substr(0,s.indexOf(":"))),h=Pl(s.substr(s.indexOf(":")+1));u==n||o=="cl"&&u=="lucky-strike"||o=="un"&&u=="lucky-underline"||u.length>0&&(l+=u+":"+h+";")}else l=e;return l}function ua(e,n,t){let l={};if(l[n]=t,n=="un"){let u=kh(e,"color");u==""&&(u="#000000");let h=kh(e,"font-size");h==""&&(h=11),h=parseInt(h),l._fontSize=h,l._color=u}let o=_o(l,void 0,void 0,!1),a=Pl(o.substr(0,o.indexOf(":"))),s=Pl(o.substr(o.indexOf(":")+1));return s=s.substr(0,s.length-1),e=Zp(e,n),e=Kp(e,a,s),e}function Rs(e,n,t=!0){let l=e.split(";"),o=n.split(";"),a="",s={};for(let u=0;u<l.length;u++){let h=l[u],d=!0;h=h.toLowerCase();let m=Pl(h.substr(0,h.indexOf(":")));if(m=="font-size")continue;let p=Pl(h.substr(h.indexOf(":")+1));if(!(t&&!(m in dh))){for(let v=0;v<o.length;v++){let y=o[v];y=y.toLowerCase();let k=Pl(y.substr(0,y.indexOf(":"))),b=Pl(y.substr(y.indexOf(":")+1));if(m==k){a+=k+":"+b+";",d=!1;continue}}d&&(a+=m+":"+p+";"),s[m]=1}}for(let u=0;u<o.length;u++){let h=o[u];h=h.toLowerCase();let d=Pl(h.substr(0,h.indexOf(":"))),m=Pl(h.substr(h.indexOf(":")+1));t&&!(d in dh)||d in s||(a+=d+":"+m+";")}return a}var hh,dh,yh,mn=Me(()=>{Kt();dn();kt();Ke();hh={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1},dh={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1};yh={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",cl:"text-decoration",un:"border-bottom"}});function Bt(e,n){if(e==null&&(e=f.luckysheet_select_save[0]),e.row==null||e.row.length==0)return[];let t,l;n!=null&&n!=f.currentSheetIndex?(t=f.luckysheetfile[Z(n)].data,l=f.luckysheetfile[Z(n)].config):(t=xe.deepCopyFlowData(f.flowdata),l=f.config);let o=[];for(let a=e.row[0];a<=e.row[1];a++){if(t[a]==null||l.rowhidden!=null&&l.rowhidden[a]!=null)continue;let s=[];for(let u=e.column[0];u<=e.column[1];u++)s.push(t[a][u]);o.push(s)}return o}function Co(e,n){if(n==null||n.row==null||n.row.length==0)return[];let t=xo(f.luckysheetfile[Z(f.currentSheetIndex)].dynamicArray),l=[];if(e==null)return l;for(let o=n.row[0];o<=n.row[1];o++){if(e[o]==null)continue;let a=[];for(let s=n.column[0];s<=n.column[1];s++){let u;o+"_"+s in t?u=t[o+"_"+s]:u=e[o][s],a.push(u)}l.push(a)}return l}function bh(e){if(e==null||e.row==null||e.row.length==0)return[];let n=[];for(let t=e.row[0];t<=e.row[1];t++){let l=[];if(!(f.config.rowhidden!=null&&f.config.rowhidden[t]!=null)){for(let o=e.column[0];o<=e.column[1];o++){let a="";f.flowdata[t]!=null&&f.flowdata[t][o]!=null&&(a=f.flowdata[t][o]),l.push(a)}n.push(l)}}return n}function Le(e,n,t,l){l==null&&(l="v"),t==null&&(t=f.flowdata);let o;if(e!=null&&n!=null)o=t[e][n];else if(e!=null)o=t[e];else if(n!=null)o=t[0].map(function(u,h){return t.map(function(d){return d[h]})})[n];else return t;let a=o;return N(o)=="object"&&(a=o[l],l=="f"&&a!=null?a=g.functionHTMLGenerate(a):l=="f"?a=o.v:o&&o.ct&&o.ct.t=="d"&&(a=o.m)),a==null&&(a=null),a}function cl(e,n,t,l){if(n<=0&&t<=0)return e;n<=0&&(n=0),t<=0&&(t=0);let o=0;e.length==0?(e=[],o=0):o=e[0].length;let a=[];for(let u=0;u<t;u++)a.push(null);let s=[];for(let u=0;u<o+t;u++)s.push(null);for(let u=0;u<e.length;u++)e[u]=[].concat(e[u].concat(a));for(let u=0;u<n;u++)e.push([].concat(s));return l&&(ne.saveParam("all",f.currentSheetIndex,e.length,{k:"row"}),ne.saveParam("all",f.currentSheetIndex,e[0].length,{k:"column"})),e}function Ll(e,n,t,l){let o;return l!=null?o=l[e][n]:o=Jp(e,n,t),o==null?null:o.f}function Jp(e,n,t){if(e==null||n==null)return;let l;if(t==null?l=f.flowdata:l=ye.getSheetByIndex(t).data,!(!l||!l[e]||!l[e][n]))return l[e][n]}function Fs(e,n){let t=Le(e,n,null,"m");if(t==null&&(t=Le(e,n),t==null)){let l=Le(e,n,null,"ct");Pi(l)&&(t=l.s)}return t}function wh(e,n){let t=Le(e,n,null,"ct");if(Pi(t)){let l=t.s,o="";for(let a=0;a<l.length;a++){let s=l[a];s.v!=null&&(o+=s.v)}return o}return""}function xh(e,n,t){let l=Le(e,n,t,"ct");t==null&&(t=f.flowdata);let o=t[e][n];if(Pi(l)){let a=l.s,s="";for(let u=0;u<a.length;u++){let h=a[u];if(h.v!=null){let d=_o(h);s+="<span index='"+u+"' style='"+d+"'>"+h.v+"</span>"}}return s}return""}function _o(e,n,t,l=!0){if(e==null)return;let o="",s=Q().fontarray;for(let u in e){let h=e[u];if(l&&(h=_r(e,u)),u=="bl"&&h!="0"&&(o+="font-weight: bold;"),u=="it"&&h!="0"&&(o+="font-style:italic;"),u=="ff"){let d=h;isNaN(parseInt(h))?d=h:d=s[parseInt(h)],o+="font-family: "+d+";"}u=="fs"&&(o+="font-size: "+h+"pt;"),(u=="fc"&&h!="#000000"||n!=null||t!=null&&t.textColor!=null)&&(t!=null&&t.textColor!=null?o+="color: "+t.textColor+";":n!=null?o+="color: "+n[0]+";":o+="color: "+h+";"),u=="cl"&&h!="0"&&(o+="text-decoration: line-through;")}return o}function _r(e,n){let t=e;return n in{bl:1,it:1,ff:1,cl:1,un:1}||n=="fs"&&_l(e)?t==null?t="0":(t=t[n],t==null&&(t="0")):n=="fc"?t==null?t="#000000":(t=t[n],t==null&&(t="#000000"),t.indexOf("rgba")>-1&&(t=Pn(t))):n=="bg"?t==null?t=null:(t=t[n],t==null?t=null:t.toString().indexOf("rgba")>-1&&(t=Pn(t))):n.substr(0,2)=="bs"?t==null?t="none":(t=t[n],t==null&&(t="none")):n.substr(0,2)=="bc"?t==null?t="#000000":(t=t[n],t==null&&(t="#000000")):n=="ht"?(t==null?t="1":(t=t[n],t==null&&(t="1")),["0","1","2"].indexOf(t.toString())==-1&&(t="1")):n=="vt"?(t==null?t="0":(t=t[n],t==null&&(t="0")),["0","1","2"].indexOf(t.toString())==-1&&(t="0")):n=="ct"?t==null?t=null:(t=t[n],t==null&&(t=null)):n=="fs"?t==null?t=String(f.defaultFontSize):(t=t[n],t==null&&(t=String(f.defaultFontSize))):n=="tb"||n=="tr"?t==null?t="0":(t=t[n],t==null&&(t="0")):n=="rt"&&(t==null?t=null:(t=t[n],t==null&&(t=null))),t}function Pl(e){return e==null||e.length==0?e:e.replace(/^\s+|\s+$/gm,"")}var Kt=Me(()=>{ht();Et();Qt();Ut();Jt();sa();dl();mn();kt();Ke()});function Qp(e,n){let t=0,l=e.length-1;for(;t<=l;){let o=parseInt((l+t)/2);if(n<e[o]&&(o==0||n>=e[o-1]))return o;if(n>=e[o])t=o+1;else if(n<e[o])l=o-1;else return-1}}function ev(e,n){let t=0,l=0,o=0,a=-1,s=e.length-1;for(;t<e.length&&s>=0&&s>=t;){if(l=e[s],s==0?o=0:o=e[s-1],n>=o&&n<l){a=s;break}if(l=e[t],t==0?o=0:o=e[t-1],n>=o&&n<l){a=t;break}t++,s--}return a}function at(e,n){let t=e.length-1;return e.length<40||n<=e[20]||n>=e[t-20]?t=ev(e,n):t=Qp(e,n),t}var Nr=Me(()=>{});function tl(e){let n=0,t=0;return n=f.visibledatarow[e],e==0?t=0:t=f.visibledatarow[e-1],[t,n,e]}function $t(e){let n=at(f.visibledatarow,e);return n==-1&&e>0?n=f.visibledatarow.length-1:n==-1&&e<=0&&(n=0),tl(n)}function Rt(e){let n=0,t=0;return n=f.visibledatacolumn[e],e==0?t=0:t=f.visibledatacolumn[e-1],[t,n,e]}function _h(e,n){let t=0,l=0;return t=f.visibledatacolumn[e+n-1],e==0?l=0:l=f.visibledatacolumn[e-1],[l,t,e]}function _t(e){let n=at(f.visibledatacolumn,e);return n==-1&&e>0?n=f.visibledatacolumn.length-1:n==-1&&e<=0&&(n=0),Rt(n)}function ut(e,n){let t=$("#"+f.container).offset(),l=e-t.left-f.rowHeaderWidth,o=n-t.top-f.infobarHeight-f.toolbarHeight-f.calculatebarHeight-f.columnHeaderHeight;return[l,o]}var Zl=Me(()=>{Nr();Ke()});function pl(e,n,t,l){var s;let o=$.extend(!0,{},l);o.rowlen==null&&(o.rowlen={}),o.customHeight==null&&(o.customHeight={});let a=$("#luckysheetTableContent").get(0).getContext("2d");a.textBaseline="top";for(let u=n;u<=t;u++){if(o.rowhidden!=null&&o.rowhidden[u]!=null)continue;let h=f.defaultrowlen;if(o.customHeight[u]!=1){delete o.rowlen[u];for(let d=0;d<e[u].length;d++){let m=e[u][d];if(m!=null&&m!=null&&(m.v!=null||_l(m))){let p;if(m.mc)if(d===m.mc.c){let k=Rt(d)[0];p=Rt(m.mc.c+m.mc.cs-1)[1]-k-2}else continue;else p=Rt(d)[1]-Rt(d)[0]-2;let v=Cr(m,a,{r:u,c:d,cellWidth:p}),y=0;v!=null&&(y=v.textHeightAll+2),y>h&&(h=y)}}h=h/f.zoomRatio,h!=f.defaultrowlen?o.rowlen[u]=h:((s=l.rowlen)==null?void 0:s[u])&&(o.rowlen[u]=l.rowlen[u])}}return o}function Ch(e,n){let t=0,l=$("#luckysheetTableContent").get(0).getContext("2d");l.textBaseline="top";for(let o=0;o<e[n].length;o++){let a=e[n][o];if(a!=null&&!(a.mc!=null&&a.mc.rs!==1)&&!(f.config.colhidden!=null&&f.config.colhidden[o]!=null)&&a!=null&&(a.v!=null||_l(a))){let s=tv(a,o),u=Cr(a,l,{r:n,c:o,cellWidth:s}),h=0;u!=null&&(h=u.textHeightAll+2),h>t&&(t=h)}}return t}function tv(e,n){let t=Rt(n);return e.mc&&e.mc.cs!==1&&(t=_h(n,e.mc.cs)),t[1]-t[0]-2}function $h(e,n,t){let l=0,o=fa(t,n),a=$("#luckysheetTableContent").get(0).getContext("2d");a.textBaseline="top";for(var s=0;s<e.length;s++){var u=e[s][n];if(u!=null&&(u.v!=null||_l(u))){let h=o[n],d=Cr(u,a,{r:s,c:n,cellHeight:h}),m=0;d!=null&&(m=d.textWidthAll+2),m>l&&(l=m)}}return l}function fa(e,n){let t=[],l=0;for(let o=0;o<e;o++){let a=f.defaultrowlen;if(n.rowlen!=null&&n.rowlen[o]!=null&&(a=n.rowlen[o]),n.rowhidden!=null&&n.rowhidden[o]!=null){a=n.rowhidden[o],t.push(l);continue}else l+=a+1;t.push(l)}return t}function Er(e,n,t){let l=f.measureTextCache[e+"_"+n.font];if(t!=null&&(l=f.measureTextCache[e+"_"+t]),l!=null)return l;{if(t!=null){let s=n.font;n.font=t}let o=n.measureText(e),a={};if(a.width=o.width,t!=null&&(n.font=t),a.actualBoundingBoxDescent=o.actualBoundingBoxDescent,a.actualBoundingBoxAscent=o.actualBoundingBoxAscent,a.actualBoundingBoxDescent==null||a.actualBoundingBoxAscent==null||isNaN(a.actualBoundingBoxDescent)||isNaN(a.actualBoundingBoxAscent)){let s="M";Tn(e)&&(s="\u7530");let u=be.getTextSize(s,n.font)[1]*.8;n.textBaseline=="top"?(a.actualBoundingBoxDescent=u,a.actualBoundingBoxAscent=0):n.textBaseline=="middle"?(a.actualBoundingBoxDescent=u/2,a.actualBoundingBoxAscent=u/2):(a.actualBoundingBoxDescent=0,a.actualBoundingBoxAscent=u)}if(n.textBaseline=="alphabetic"){let s="gjpqy",u="abcdABCD",h=f.measureTextCache[s+"_"+n.font];t!=null&&(h=f.measureTextCache[s+"_"+t]);let d=f.measureTextCache[u+"_"+n.font];t!=null&&(d=f.measureTextCache[u+"_"+t]),h==null&&(h=n.measureText(s)),d==null&&(d=n.measureText(u)),a.actualBoundingBoxDescent<=d.actualBoundingBoxDescent&&(a.actualBoundingBoxDescent=h.actualBoundingBoxDescent,a.actualBoundingBoxDescent==null&&(a.actualBoundingBoxDescent=0))}return a.width*=f.zoomRatio,a.actualBoundingBoxDescent*=f.zoomRatio,a.actualBoundingBoxAscent*=f.zoomRatio,f.measureTextCache[e+"_"+f.zoomRatio+"_"+n.font]=a,a}}function lv(e){return e.measureText("\u7530").actualBoundingBoxAscent!=null}function Cr(e,n,t){let l=t.cellWidth,o=t.cellHeight,a="",s="";l==null&&(a="onlyWidth",s="_");let u=f.measureTextCellInfoCache[t.r+"_"+t.c+s+a];if(u!=null)return u;let h=t.space_width,d=t.space_height;h==null&&(h=2),d==null&&(d=2);let m=_r(e,"ht"),p=_r(e,"vt"),v=_r(e,"tb"),y=_r(e,"tr"),k=_r(e,"rt"),b=1,w=0;k==null&&(y=="0"?k=0:y=="1"?k=45:y=="4"?k=90:y=="2"?k=135:y=="5"&&(k=180),k==null&&(k=0)),(k>180||k<0)&&(k=0),k=parseInt(k),k>90&&(k=90-k,b=0,w=1),n.textAlign="start";let x={};x.values=[];let C,S="0",_="0",T=11,F=!1,R,I=[];if(_l(e)){let P=e.ct.s,O=0;for(let M=0;M<P.length;M++){let A=P[M],z=oi(A),L=A.fc,E=A.cl,V=A.un,q=A.v,G=A.fs;q=q.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_");let X=q.split("_x000D_");for(let ee=0;ee<X.length;ee++){let le=X[ee];if(le==""&&ee!=X.length-1)I.push({fontset:z,fc:L==null?"#000":L,cl:E==null?0:E,un:V==null?0:V,wrap:!0,fs:G==null?11:G}),O++;else{let se=le.split("");for(let ae=0;ae<se.length;ae++){let ue=se[ae];I.push({fontset:z,fc:L==null?"#000":L,cl:E==null?0:E,un:V==null?0:V,v:ue,si:O,fs:G==null?11:G})}ee!=X.length-1&&(I.push({fontset:z,fc:L==null?"#000":L,cl:E==null?0:E,un:V==null?0:V,wrap:!0,fs:G==null?11:G}),O++)}}O++}F=!0}else if(C=oi(e),n.font=C,S=_r(e,"cl"),_=_r(e,"un"),T=_r(e,"fs"),e instanceof Object?(R=e.m,R==null&&(R=e.v)):R=e,me(R))return null;if(y=="3"){n.textBaseline="top";let P=0,O=0,M=0,A=0,z={},L=[];if(F){let q=null;for(let G=0;G<I.length;G++){let X=I[G],ee=X.v,le=X.v;if(X.wrap===!0&&(ee="M",le="",q!=null&&q.wrap!==!0&&G<I.length-1)){L.push(A),A=0,M+=1,q=X;continue}let se=Er(ee,n,X.fontset),ae=se.width+h,ue=se.actualBoundingBoxAscent+se.actualBoundingBoxDescent+d;A+=ue,v=="2"&&!X.wrap&&A>o&&z[M]!=null&&(L.push(A-ue),A=ue,M+=1),G==I.length-1&&L.push(A),z[M]==null&&(z[M]=[]);let fe={content:le,style:X,width:ae,height:ue,left:0,top:0,colIndex:M,asc:se.actualBoundingBoxAscent,desc:se.actualBoundingBoxDescent,inline:!0};X.wrap===!0&&(fe.wrap=!0),z[M].push(fe),console.log("normal",G,M,X,q,z),q=X}}else{let q=Er(R,n),G=q.actualBoundingBoxDescent+q.actualBoundingBoxAscent;R=R.toString();let X=[];R.length>1?X=R.split(""):X.push(R);let ee=Er(X[0],n).width;for(let le=0;le<X.length;le++){let se=ee+h,ae=G+d;A+=ae,v=="2"&&A>o&&z[M]!=null&&(L.push(A-ae),A=ae,M+=1),le==X.length-1&&L.push(A),z[M]==null&&(z[M]=[]),z[M].push({content:X[le],style:C,width:se,height:ae,left:0,top:0,colIndex:M,asc:q.actualBoundingBoxAscent,desc:q.actualBoundingBoxDescent})}}let E=[];for(let q=0;q<L.length;q++){let G=L[q],X=z[q],ee=0;for(let le=0;le<X.length;le++){let se=X[le];ee=Math.max(ee,se.width)}E.push(ee),P+=ee,O=Math.max(O,G)}if(x.type="verticalWrap",x.textWidthAll=P,x.textHeightAll=O,a=="onlyWidth")return x;let V=0;for(let q=0;q<L.length;q++){let G=L[q],X=E[q],ee=z[q],le=0;for(let se=0;se<ee.length;se++){let ae=ee[se],ue=h+V;m=="0"?ue=l/2+V-P/2+h*L.length:m=="2"&&(ue=l+V-P+h);let fe=o-d+le-G;p=="0"?fe=o/2+le-G/2:p=="1"&&(fe=d+le),le+=ae.height,ae.left=ue,ae.top=fe,$o(ae,S,_,{width:X,height:ae.height,left:ue,top:fe+ae.height-d,asc:ae.height,desc:0,fs:T}),x.values.push(ae)}V+=X}}else{let P=lv(n);if(P?n.textBaseline="alphabetic":n.textBaseline="bottom",v=="2"||F){let O=0,M=0,A=0,z=0,L=0,E={},V=[];x.rotate=k,k=Math.abs(k);let q=0,G=0,X=0,ee,le,se,ae,ue=1,fe={},ce=null,K=null;if(F)for(;ue<=I.length;){let Pe=I.slice(q,ue);if(Pe[Pe.length-1].wrap===!0){if(q=ue,Pe.length>1)for(let qe=0;qe<Pe.length-1;qe++){let Te=Pe[qe],Xe={content:Te.v,style:Te,width:Te.measureText.width,height:Te.measureText.actualBoundingBoxAscent+Te.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:z,asc:Te.measureText.actualBoundingBoxAscent,desc:Te.measureText.actualBoundingBoxDescent,inline:!0,fs:Te.fs};E[z].push(Xe)}if(Pe.length==1||ue==I.length){let qe=Pe[0],Te=Er("M",n,qe.fontset);E[z]==null&&(E[z]=[]),E[z].push({content:"",style:qe,width:Te.width,height:Te.actualBoundingBoxAscent+Te.actualBoundingBoxDescent,left:0,top:0,splitIndex:z,asc:Te.actualBoundingBoxAscent,desc:Te.actualBoundingBoxDescent,inline:!0,wrap:!0,fs:qe.fs})}z+=1,ue++;continue}let et=0,yt=0;for(let qe=0;qe<Pe.length;qe++){let Te=Pe[qe];Te.measureText==null&&(Te.measureText=Er(Te.v,n,Te.fontset)),et+=Te.measureText.width,yt=Math.max(Te.measureText.actualBoundingBoxAscent+Te.measureText.actualBoundingBoxDescent)}let St=et*Math.cos(k*Math.PI/180)+yt*Math.sin(k*Math.PI/180),ot=et*Math.sin(k*Math.PI/180)+yt*Math.cos(k*Math.PI/180),bt=Pe[Pe.length-1];if((bt.v==" "||qa(bt.v)==2)&&(K=ue),k!=0)if(console.log(ot,d,o,Pe,ot+d>o),ot+d>o&&E[z]!=null&&v=="2"&&ue!=I.length)if(K!=null&&K<ue){for(let qe=0;qe<K-q;qe++){let Te=Pe[qe];E[z].push({content:Te.v,style:Te,width:Te.measureText.width,height:Te.measureText.actualBoundingBoxAscent+Te.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:z,asc:Te.measureText.actualBoundingBoxAscent,desc:Te.measureText.actualBoundingBoxDescent,inline:!0,fs:Te.fs})}q=K,ue=K+1,z+=1,K=null}else{q=ue-1;for(let qe=0;qe<Pe.length-1;qe++){let Te=Pe[qe];E[z].push({content:Te.v,style:Te,width:Te.measureText.width,height:Te.measureText.actualBoundingBoxAscent+Te.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:z,asc:Te.measureText.actualBoundingBoxAscent,desc:Te.measureText.actualBoundingBoxDescent,inline:!0,fs:Te.fs})}z+=1}else if(ue==I.length){E[z]==null&&(E[z]=[]);for(let qe=0;qe<Pe.length;qe++){let Te=Pe[qe];E[z].push({content:Te.v,style:Te,width:Te.measureText.width,height:Te.measureText.actualBoundingBoxAscent+Te.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:z,asc:Te.measureText.actualBoundingBoxAscent,desc:Te.measureText.actualBoundingBoxDescent,inline:!0,fs:Te.fs})}break}else E[z]==null&&(E[z]=[]),ue++;else if(St+h>l&&E[z]!=null&&v=="2"&&ue!=I.length)if(K!=null&&K<ue){for(let qe=0;qe<K-q;qe++){let Te=Pe[qe];E[z].push({content:Te.v,style:Te,width:Te.measureText.width,height:Te.measureText.actualBoundingBoxAscent+Te.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:z,asc:Te.measureText.actualBoundingBoxAscent,desc:Te.measureText.actualBoundingBoxDescent,inline:!0,fs:Te.fs})}q=K,ue=K+1,z+=1,K=null}else{q=ue-1;for(let qe=0;qe<Pe.length-1;qe++){let Te=Pe[qe];E[z].push({content:Te.v,style:Te,width:Te.measureText.width,height:Te.measureText.actualBoundingBoxAscent+Te.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:z,asc:Te.measureText.actualBoundingBoxAscent,desc:Te.measureText.actualBoundingBoxDescent,inline:!0,fs:Te.fs})}z+=1}else if(ue==I.length){E[z]==null&&(E[z]=[]);for(let qe=0;qe<Pe.length;qe++){let Te=Pe[qe];E[z].push({content:Te.v,style:Te,width:Te.measureText.width,height:Te.measureText.actualBoundingBoxAscent+Te.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:z,asc:Te.measureText.actualBoundingBoxAscent,desc:Te.measureText.actualBoundingBoxDescent,inline:!0,fs:Te.fs})}break}else E[z]==null&&(E[z]=[]),ue++}else for(R=R.toString();ue<=R.length;){let Pe=R.substring(q,ue),et=Er(Pe,n),yt=et.width,St=et.actualBoundingBoxAscent+et.actualBoundingBoxDescent,ot=yt*Math.cos(k*Math.PI/180)+St*Math.sin(k*Math.PI/180),bt=yt*Math.sin(k*Math.PI/180)+St*Math.cos(k*Math.PI/180),qe=Pe.substr(Pe.length-1,1);if((qe==" "||qa(qe)==2)&&ae!=null&&(ce={index:ue,str:ee+qe,width:se,height:le,asc:ae.actualBoundingBoxAscent,desc:ae.actualBoundingBoxDescent}),k!=0)if(bt+d>o&&E[z]!=null&&ue!=R.length)ce!=null&&ce.index<ue?(q=ce.index,ue=ce.index+1,E[z].push({content:ce.str,style:C,width:ce.width,height:ce.height,left:0,top:0,splitIndex:z,asc:ce.asc,desc:ce.desc,fs:T}),z+=1,ce=null):(q=ue-1,E[z].push({content:ee,style:C,left:0,top:0,splitIndex:z,height:le,width:se,asc:et.actualBoundingBoxAscent,desc:et.actualBoundingBoxDescent,fs:T}),z+=1);else if(ue==R.length){E[z]==null&&(E[z]=[]),E[z].push({content:Pe,style:C,left:0,top:0,splitIndex:z,height:St,width:yt,asc:et.actualBoundingBoxAscent,desc:et.actualBoundingBoxDescent,fs:T});break}else E[z]==null&&(E[z]=[]),ue++;else if(ot+h>l&&E[z]!=null&&ue!=R.length)ce!=null&&ce.index<ue?(q=ce.index,ue=ce.index+1,E[z].push({content:ce.str,style:C,width:ce.width,height:ce.height,left:0,top:0,splitIndex:z,asc:ce.asc,desc:ce.desc,fs:T}),z+=1,ce=null):(ce=null,q=ue-1,E[z].push({content:ee,style:C,width:se,height:le,left:0,top:0,splitIndex:z,asc:et.actualBoundingBoxAscent,desc:et.actualBoundingBoxDescent,fs:T}),z+=1);else if(ue==R.length){E[z]==null&&(E[z]=[]),E[z].push({content:Pe,style:C,width:yt,height:St,left:0,top:0,splitIndex:z,asc:et.actualBoundingBoxAscent,desc:et.actualBoundingBoxDescent,fs:T});break}else E[z]==null&&(E[z]=[]),ue++;ee=Pe,le=St,se=yt,ae=et}let U=[],te=0,ge=Object.keys(E).length;for(let Pe=0;Pe<ge;Pe++){let et=E[Pe];if(et==null)continue;let yt=0,St=0,ot=0,bt=0,qe=0,Te=0;for(let Xe=0;Xe<et.length;Xe++){let Ae=et[Xe];k!=0,yt+=Ae.width,St=Math.max(St,Ae.height-(P?Ae.desc:0)),ot=Math.max(ot,P?Ae.desc:0),bt=Math.max(bt,Ae.asc),Te++}qe=St/2,te=Math.max(te,Te),k!=0?(St+=qe,A=Math.max(A,yt),M+=St):(St+=qe,O=Math.max(O,yt),M+=St),U.push({width:yt,height:St,desc:ot,asc:bt,lineHeight:qe,wordCount:Te})}let ie=0,$e=0,oe=k*Math.PI/180,ze=U[ge-1],je=ze.lineHeight;M=M-je+ze.desc;let Ce=M/Math.sin(oe)+A*Math.cos(oe),Ee=A*Math.sin(oe),Ue=0;if(k!=0?(ge==1?(O=A+2*(M/Math.tan(oe)),Ue=M/Math.tan(oe)):O=A+M/Math.tan(oe),x.textWidthAll=Ce,x.textHeightAll=Ee):(x.textWidthAll=O,x.textHeightAll=M),a=="onlyWidth")return x;if(k!=0&&b=="1"){n.textAlign="end";for(let Pe=0;Pe<ge;Pe++){let et=E[Pe];if(et==null)continue;let yt=U[Pe];$e=0;for(let St=et.length-1;St>=0;St--){let ot=et[St],bt,qe;if(k!=0){let Te,Xe=ie+yt.asc;if(Te=ie/Math.tan(oe)-$e+A,m=="0"){let Ae=M/Math.sin(oe);p=="0"?(bt=Te+l/2-O/2+je*Math.cos(oe)/2,qe=Xe+o/2-M/2-je*Math.cos(oe)/2):p=="1"?(bt=Te+l/2-O/2,qe=Xe-(M/2-Ee/2)):p=="2"&&(bt=Te+l/2-O/2+je*Math.cos(oe),qe=Xe+o-Ee/2-M/2-je*Math.cos(oe))}else m=="1"?p=="0"?(bt=Te-Ee*Math.sin(oe)/2+je*Math.cos(oe)/2,qe=Xe+o/2+Ee*Math.cos(oe)/2-je*Math.cos(oe)/2):p=="1"?(bt=Te-Ee*Math.sin(oe),qe=Xe+Ee*Math.cos(oe)):p=="2"&&(bt=Te+je*Math.cos(oe),qe=Xe+o-je*Math.cos(oe)):m=="2"&&(p=="0"?(bt=Te+l-Ce/2-(A/2+M/2/Math.tan(oe))+je*Math.cos(oe)/2,qe=Xe+o/2-M/2-je*Math.cos(oe)/2):p=="1"?(bt=Te+l-O+Ue,qe=Xe-M):p=="2"&&(bt=Te+l-Ce*Math.cos(oe)+je*Math.cos(oe),qe=Xe+o-Ce*Math.sin(oe)-je*Math.cos(oe)))}ot.left=bt,ot.top=qe,$o(ot,S,_,{width:ot.width,height:ot.height,left:bt-ot.width,top:qe,asc:yt.asc,desc:yt.desc,fs:ot.fs}),x.values.push(ot),$e+=ot.width}ie+=yt.height}}else for(let Pe=0;Pe<ge;Pe++){let et=E[Pe];if(et==null)continue;let yt=U[Pe];$e=0;for(let St=0;St<et.length;St++){let ot=et[St],bt,qe;if(k!=0){let Te,Xe=ie+yt.asc;if(Te=(M-ie)/Math.tan(oe)+$e,m=="0"){let Ae=M/Math.sin(oe);p=="0"?(bt=Te+l/2-O/2-je*Math.cos(oe)/2,qe=Xe+o/2-M/2+je*Math.cos(oe)/2):p=="1"?(bt=Te+l/2-O/2-je*Math.cos(oe)/2,qe=Xe-(M/2-Ee/2)+je*Math.cos(oe)/2):p=="2"&&(bt=Te+l/2-O/2-je*Math.cos(oe),qe=Xe+o-Ee/2-M/2-je*Math.cos(oe))}else m=="1"?p=="0"?(bt=Te-Ee*Math.sin(oe)/2-je*Math.cos(oe)/2,qe=Xe-M+o/2-Ee*Math.cos(oe)/2-je*Math.cos(oe)/2):p=="1"?(bt=Te,qe=Xe-M):p=="2"&&(bt=Te-Ee*Math.sin(oe)-je*Math.cos(oe),qe=Xe-M+o-Ee*Math.cos(oe)-je*Math.cos(oe)):m=="2"&&(p=="0"?(bt=Te+l-Ce/2-O/2-je*Math.cos(oe)/2,qe=Xe+o/2-M/2-je*Math.cos(oe)/2):p=="1"?(bt=Te+l-Ce*Math.cos(oe),qe=Xe+Ee*Math.cos(oe)):p=="2"&&(bt=Te+l-O-je*Math.cos(oe)+Ue,qe=Xe+o-je*Math.cos(oe)));$o(ot,S,_,{width:ot.width,height:ot.height,left:bt,top:qe,asc:yt.asc,desc:yt.desc,fs:ot.fs})}else bt=h+$e,m=="0"?bt=l/2+$e-yt.width/2:m=="2"&&(bt=l+$e-yt.width),qe=o-d+ie+yt.asc-M,p=="0"?qe=o/2+ie-M/2+yt.asc:p=="1"&&(qe=d+ie+yt.asc),$o(ot,S,_,{width:ot.width,height:ot.height,left:bt,top:qe,asc:yt.asc,desc:yt.desc,fs:ot.fs});ot.left=bt,ot.top=qe,x.values.push(ot),$e+=ot.width}ie+=yt.height}x.type="plainWrap",k!=0&&(m=="0"?p=="0"?(x.textLeftAll=l/2,x.textTopAll=o/2):p=="1"?(x.textLeftAll=l/2,x.textTopAll=Ee/2):p=="2"&&(x.textLeftAll=l/2,x.textTopAll=o-Ee/2):m=="1"?p=="0"?(x.textLeftAll=0,x.textTopAll=o/2):p=="1"?(x.textLeftAll=0,x.textTopAll=0):p=="2"&&(x.textLeftAll=0,x.textTopAll=o):m=="2"&&(p=="0"?(x.textLeftAll=l-Ce/2,x.textTopAll=o/2):p=="1"?(x.textLeftAll=l,x.textTopAll=0):p=="2"&&(x.textLeftAll=l,x.textTopAll=o)))}else{let O=Er(R,n),M=O.width,A=O.actualBoundingBoxDescent+O.actualBoundingBoxAscent;x.rotate=k,k=Math.abs(k);let z=k*Math.PI/180,L=M*Math.cos(z)+A*Math.sin(z),E=M*Math.sin(z)+A*Math.cos(z);if(k!=0?x.textHeightAll=E:x.textHeightAll=E+A/2-O.actualBoundingBoxDescent-d,x.textWidthAll=L,a=="onlyWidth")return x;let V=L,q=E,G=h+A*Math.sin(z)*b;m=="0"?G=l/2-V/2+A*Math.sin(z)*b:m=="2"&&(G=l-h-V+A*Math.sin(z)*b);let X=o-d-q+O.actualBoundingBoxAscent*Math.cos(z)+M*Math.sin(z)*b;p=="0"?X=o/2-q/2+O.actualBoundingBoxAscent*Math.cos(z)+M*Math.sin(z)*b:p=="1"&&(X=d+O.actualBoundingBoxAscent*Math.cos(z)+M*Math.sin(z)*b),x.type="plain";let ee={content:R,style:C,width:V,height:q,left:G,top:X};$o(ee,S,_,{width:M,height:A,left:G,top:X,asc:O.actualBoundingBoxAscent,desc:O.actualBoundingBoxDescent,fs:T}),x.values.push(ee),x.textLeftAll=G,x.textTopAll=X,x.asc=O.actualBoundingBoxAscent,x.desc=O.actualBoundingBoxDescent}}return x}function $o(e,n,t,l){let o=l.left,a=l.top,s=l.width,u=l.height,h=l.asc,d=l.desc,m=l.fs;if(e.wrap!==!0&&(e.inline==!0&&e.style!=null&&(n=e.style.cl,t=e.style.un),n!="0"&&(e.cancelLine={},e.cancelLine.startX=o,e.cancelLine.startY=a-h/2+1,e.cancelLine.endX=o+s,e.cancelLine.endY=a-h/2+1,e.cancelLine.fs=m),t!="0")){if(e.underLine=[],t=="1"||t=="2"){let p={};p.startX=o,p.startY=a+3,p.endX=o+s,p.endY=a+3,p.fs=m,e.underLine.push(p)}if(t=="2"){let p={};p.startX=o,p.startY=a+d,p.endX=o+s,p.endY=a+d,p.fs=m,e.underLine.push(p)}if(t=="3"||t=="4"){let p={};p.startX=o,p.startY=a+d,p.endX=o+s,p.endY=a+d,p.fs=m,e.underLine.push(p)}if(t=="4"){let p={};p.startX=o,p.startY=a+d+2,p.endX=o+s,p.endY=a+d+2,p.fs=m,e.underLine.push(p)}}}var dr=Me(()=>{ht();ol();Kt();Zl();Nt();mn();Ke()});function gn(e,n){if(rv(),e!=null){f.visibledatarow=[],f.rh_height=0;for(let t=0;t<e;t++){let l=f.defaultrowlen;if(f.config.rowlen!=null&&f.config.rowlen[t]!=null&&(l=f.config.rowlen[t]),f.config.rowhidden!=null&&f.config.rowhidden[t]!=null){f.visibledatarow.push(f.rh_height);continue}l==="auto"&&(l=Ch(f.flowdata,t)),f.rh_height+=Math.round((l+1)*f.zoomRatio),f.visibledatarow.push(f.rh_height)}!de.enableAddRow&&!de.enableAddBackTop?f.rh_height+=29:f.rh_height+=80}if(n!=null){f.visibledatacolumn=[],f.ch_width=0;let t=120;for(let l=0;l<n;l++){let o=f.defaultcollen;if(f.config.columnlen!=null&&f.config.columnlen[l]!=null?o=f.config.columnlen[l]:f.flowdata[0]!=null&&f.flowdata[0][l]!=null&&(o>300?o=300:o<f.defaultcollen&&(o=f.defaultcollen),o!=f.defaultcollen&&(f.config.columnlen==null&&(f.config.columnlen={}),f.config.columnlen[l]=o)),f.config.colhidden!=null&&f.config.colhidden[l]!=null){f.visibledatacolumn.push(f.ch_width);continue}o==="auto"&&(o=$h(f.flowdata,l,e)),f.ch_width+=Math.round((o+1)*f.zoomRatio),f.visibledatacolumn.push(f.ch_width)}f.ch_width+=t}}function rv(){f.rowHeaderWidth=de.rowHeaderWidth*f.zoomRatio,f.columnHeaderHeight=de.columnHeaderHeight*f.zoomRatio,$("#luckysheet-rows-h").width(f.rowHeaderWidth-1.5),$("#luckysheet-cols-h-c").height(f.columnHeaderHeight-1.5),$("#luckysheet-left-top").css({width:f.rowHeaderWidth-1.5,height:f.columnHeaderHeight-1.5})}var To=Me(()=>{Ke();dr();xl()});var pn=wl((Ds,Ms)=>{(function(e,n){typeof Ds=="object"&&typeof Ms!="undefined"?Ms.exports=n():typeof define=="function"&&define.amd?define(n):(e=typeof globalThis!="undefined"?globalThis:e||self).dayjs=n()})(Ds,function(){"use strict";var e=1e3,n=6e4,t=36e5,l="millisecond",o="second",a="minute",s="hour",u="day",h="week",d="month",m="quarter",p="year",v="date",y="Invalid Date",k=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},x=function(M,A,z){var L=String(M);return!L||L.length>=A?M:""+Array(A+1-L.length).join(z)+M},C={s:x,z:function(M){var A=-M.utcOffset(),z=Math.abs(A),L=Math.floor(z/60),E=z%60;return(A<=0?"+":"-")+x(L,2,"0")+":"+x(E,2,"0")},m:function M(A,z){if(A.date()<z.date())return-M(z,A);var L=12*(z.year()-A.year())+(z.month()-A.month()),E=A.clone().add(L,d),V=z-E<0,q=A.clone().add(L+(V?-1:1),d);return+(-(L+(z-E)/(V?E-q:q-E))||0)},a:function(M){return M<0?Math.ceil(M)||0:Math.floor(M)},p:function(M){return{M:d,y:p,w:h,d:u,D:v,h:s,m:a,s:o,ms:l,Q:m}[M]||String(M||"").toLowerCase().replace(/s$/,"")},u:function(M){return M===void 0}},S="en",_={};_[S]=w;var T=function(M){return M instanceof P},F=function M(A,z,L){var E;if(!A)return S;if(typeof A=="string"){var V=A.toLowerCase();_[V]&&(E=V),z&&(_[V]=z,E=V);var q=A.split("-");if(!E&&q.length>1)return M(q[0])}else{var G=A.name;_[G]=A,E=G}return!L&&E&&(S=E),E||!L&&S},R=function(M,A){if(T(M))return M.clone();var z=typeof A=="object"?A:{};return z.date=M,z.args=arguments,new P(z)},I=C;I.l=F,I.i=T,I.w=function(M,A){return R(M,{locale:A.$L,utc:A.$u,x:A.$x,$offset:A.$offset})};var P=function(){function M(z){this.$L=F(z.locale,null,!0),this.parse(z)}var A=M.prototype;return A.parse=function(z){this.$d=function(L){var E=L.date,V=L.utc;if(E===null)return new Date(NaN);if(I.u(E))return new Date;if(E instanceof Date)return new Date(E);if(typeof E=="string"&&!/Z$/i.test(E)){var q=E.match(k);if(q){var G=q[2]-1||0,X=(q[7]||"0").substring(0,3);return V?new Date(Date.UTC(q[1],G,q[3]||1,q[4]||0,q[5]||0,q[6]||0,X)):new Date(q[1],G,q[3]||1,q[4]||0,q[5]||0,q[6]||0,X)}}return new Date(E)}(z),this.$x=z.x||{},this.init()},A.init=function(){var z=this.$d;this.$y=z.getFullYear(),this.$M=z.getMonth(),this.$D=z.getDate(),this.$W=z.getDay(),this.$H=z.getHours(),this.$m=z.getMinutes(),this.$s=z.getSeconds(),this.$ms=z.getMilliseconds()},A.$utils=function(){return I},A.isValid=function(){return this.$d.toString()!==y},A.isSame=function(z,L){var E=R(z);return this.startOf(L)<=E&&E<=this.endOf(L)},A.isAfter=function(z,L){return R(z)<this.startOf(L)},A.isBefore=function(z,L){return this.endOf(L)<R(z)},A.$g=function(z,L,E){return I.u(z)?this[L]:this.set(E,z)},A.unix=function(){return Math.floor(this.valueOf()/1e3)},A.valueOf=function(){return this.$d.getTime()},A.startOf=function(z,L){var E=this,V=!!I.u(L)||L,q=I.p(z),G=function(ce,K){var U=I.w(E.$u?Date.UTC(E.$y,K,ce):new Date(E.$y,K,ce),E);return V?U:U.endOf(u)},X=function(ce,K){return I.w(E.toDate()[ce].apply(E.toDate("s"),(V?[0,0,0,0]:[23,59,59,999]).slice(K)),E)},ee=this.$W,le=this.$M,se=this.$D,ae="set"+(this.$u?"UTC":"");switch(q){case p:return V?G(1,0):G(31,11);case d:return V?G(1,le):G(0,le+1);case h:var ue=this.$locale().weekStart||0,fe=(ee<ue?ee+7:ee)-ue;return G(V?se-fe:se+(6-fe),le);case u:case v:return X(ae+"Hours",0);case s:return X(ae+"Minutes",1);case a:return X(ae+"Seconds",2);case o:return X(ae+"Milliseconds",3);default:return this.clone()}},A.endOf=function(z){return this.startOf(z,!1)},A.$set=function(z,L){var E,V=I.p(z),q="set"+(this.$u?"UTC":""),G=(E={},E[u]=q+"Date",E[v]=q+"Date",E[d]=q+"Month",E[p]=q+"FullYear",E[s]=q+"Hours",E[a]=q+"Minutes",E[o]=q+"Seconds",E[l]=q+"Milliseconds",E)[V],X=V===u?this.$D+(L-this.$W):L;if(V===d||V===p){var ee=this.clone().set(v,1);ee.$d[G](X),ee.init(),this.$d=ee.set(v,Math.min(this.$D,ee.daysInMonth())).$d}else G&&this.$d[G](X);return this.init(),this},A.set=function(z,L){return this.clone().$set(z,L)},A.get=function(z){return this[I.p(z)]()},A.add=function(z,L){var E,V=this;z=Number(z);var q=I.p(L),G=function(le){var se=R(V);return I.w(se.date(se.date()+Math.round(le*z)),V)};if(q===d)return this.set(d,this.$M+z);if(q===p)return this.set(p,this.$y+z);if(q===u)return G(1);if(q===h)return G(7);var X=(E={},E[a]=n,E[s]=t,E[o]=e,E)[q]||1,ee=this.$d.getTime()+z*X;return I.w(ee,this)},A.subtract=function(z,L){return this.add(-1*z,L)},A.format=function(z){var L=this,E=this.$locale();if(!this.isValid())return E.invalidDate||y;var V=z||"YYYY-MM-DDTHH:mm:ssZ",q=I.z(this),G=this.$H,X=this.$m,ee=this.$M,le=E.weekdays,se=E.months,ae=function(K,U,te,ge){return K&&(K[U]||K(L,V))||te[U].slice(0,ge)},ue=function(K){return I.s(G%12||12,K,"0")},fe=E.meridiem||function(K,U,te){var ge=K<12?"AM":"PM";return te?ge.toLowerCase():ge},ce={YY:String(this.$y).slice(-2),YYYY:this.$y,M:ee+1,MM:I.s(ee+1,2,"0"),MMM:ae(E.monthsShort,ee,se,3),MMMM:ae(se,ee),D:this.$D,DD:I.s(this.$D,2,"0"),d:String(this.$W),dd:ae(E.weekdaysMin,this.$W,le,2),ddd:ae(E.weekdaysShort,this.$W,le,3),dddd:le[this.$W],H:String(G),HH:I.s(G,2,"0"),h:ue(1),hh:ue(2),a:fe(G,X,!0),A:fe(G,X,!1),m:String(X),mm:I.s(X,2,"0"),s:String(this.$s),ss:I.s(this.$s,2,"0"),SSS:I.s(this.$ms,3,"0"),Z:q};return V.replace(b,function(K,U){return U||ce[K]||q.replace(":","")})},A.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},A.diff=function(z,L,E){var V,q=I.p(L),G=R(z),X=(G.utcOffset()-this.utcOffset())*n,ee=this-G,le=I.m(this,G);return le=(V={},V[p]=le/12,V[d]=le,V[m]=le/3,V[h]=(ee-X)/6048e5,V[u]=(ee-X)/864e5,V[s]=ee/t,V[a]=ee/n,V[o]=ee/e,V)[q]||ee,E?le:I.a(le)},A.daysInMonth=function(){return this.endOf(d).$D},A.$locale=function(){return _[this.$L]},A.locale=function(z,L){if(!z)return this.$L;var E=this.clone(),V=F(z,L,!0);return V&&(E.$L=V),E},A.clone=function(){return I.w(this.$d,this)},A.toDate=function(){return new Date(this.valueOf())},A.toJSON=function(){return this.isValid()?this.toISOString():null},A.toISOString=function(){return this.$d.toISOString()},A.toString=function(){return this.$d.toUTCString()},M}(),O=P.prototype;return R.prototype=O,[["$ms",l],["$s",o],["$m",a],["$H",s],["$W",u],["$M",d],["$y",p],["$D",v]].forEach(function(M){O[M[1]]=function(A){return this.$g(A,M[0],M[1])}}),R.extend=function(M,A){return M.$i||(M(A,P,R),M.$i=!0),R},R.locale=F,R.isDayjs=T,R.unix=function(M){return R(1e3*M)},R.en=_[S],R.Ls=_,R.p={},R})});function zt(e){if(e==null||e.toString().length<5)return!1;return!!n(e);function n(t){var l=/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/,o=/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;if(!l.test(t)&&!o.test(t))return!1;var a=RegExp.$1,s=RegExp.$2,u=RegExp.$3;if(a<1900||s>12||u>31)return!1;if(s==2){if(new Date(a,1,29).getDate()==29&&u>29)return!1;if(new Date(a,1,29).getDate()!=29&&u>28)return!1}return!0}}function ul(e,n){return(0,As.default)(e).diff((0,As.default)(n))}function Nn(e){let n={};return zt(e)&&(n.date=!0),!isNaN(parseFloat(e))&&!Tn(e)&&(n.num=!0),n}function tr(e){let n="string";return zt(e)?n="date":!isNaN(parseFloat(e))&&!Tn(e)&&(n="num"),n}var As,Lr=Me(()=>{Nt();As=El(pn())});var ai=wl((Th,ha)=>{(function(e,n){typeof define=="function"&&define.amd?define(n):typeof ha=="object"&&ha.exports?ha.exports=n():e.numeral=n()})(Th,function(){var e,n,t="2.0.6",l={},o={},a={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},s={currentLocale:a.currentLocale,zeroFormat:a.zeroFormat,nullFormat:a.nullFormat,defaultFormat:a.defaultFormat,scalePercentBy100:a.scalePercentBy100};function u(h,d){this._input=h,this._value=d}return e=function(h){var d,m,p,v;if(e.isNumeral(h))d=h.value();else if(h===0||typeof h=="undefined")d=0;else if(h===null||n.isNaN(h))d=null;else if(typeof h=="string")if(s.zeroFormat&&h===s.zeroFormat)d=0;else if(s.nullFormat&&h===s.nullFormat||!h.replace(/[^0-9]+/g,"").length)d=null;else{for(m in l)if(v=typeof l[m].regexps.unformat=="function"?l[m].regexps.unformat():l[m].regexps.unformat,v&&h.match(v)){p=l[m].unformat;break}p=p||e._.stringToNumber,d=p(h)}else d=Number(h)||null;return new u(h,d)},e.version=t,e.isNumeral=function(h){return h instanceof u},e._=n={numberToFormat:function(h,d,m){var p=o[e.options.currentLocale],v=!1,y=!1,k=0,b="",w=1e12,x=1e9,C=1e6,S=1e3,_="",T=!1,F,R,I,P,O,M,A,z,L,E;if(h=h||0,R=Math.abs(h),e._.includes(d,"(")?(v=!0,d=d.replace(/[\(|\)]/g,"")):(e._.includes(d,"+")||e._.includes(d,"-"))&&(z=e._.includes(d,"+")?d.indexOf("+"):h<0?d.indexOf("-"):-1,d=d.replace(/[\+|\-]/g,"")),e._.includes(d,"a")&&(F=d.match(/a(k|m|b|t)?/),F=F?F[1]:!1,e._.includes(d," a")&&(b=" "),d=d.replace(new RegExp(b+"a[kmbt]?"),""),R>=w&&!F||F==="t"?(b+=p.abbreviations.trillion,h=h/w):R<w&&R>=x&&!F||F==="b"?(b+=p.abbreviations.billion,h=h/x):R<x&&R>=C&&!F||F==="m"?(b+=p.abbreviations.million,h=h/C):(R<C&&R>=S&&!F||F==="k")&&(b+=p.abbreviations.thousand,h=h/S)),e._.includes(d,"[.]")&&(y=!0,d=d.replace("[.]",".")),M=h.toString().split(".")[0],A=d.split(".")[1],L=d.indexOf(","),k=(d.split(".")[0].split(",")[0].match(/0/g)||[]).length,A?(e._.includes(A,"[")?(A=A.replace("]",""),A=A.split("["),_=e._.toFixed(h,A[0].length+A[1].length,m,A[1].length)):_=e._.toFixed(h,A.length,m),M=_.split(".")[0],e._.includes(_,".")?_=p.delimiters.decimal+_.split(".")[1]:_="",y&&Number(_.slice(1))===0&&(_="")):M=e._.toFixed(h,0,m),b&&!F&&Number(M)>=1e3&&b!==p.abbreviations.trillion)switch(M=String(Number(M)/1e3),b){case p.abbreviations.thousand:b=p.abbreviations.million;break;case p.abbreviations.million:b=p.abbreviations.billion;break;case p.abbreviations.billion:b=p.abbreviations.trillion;break}if(e._.includes(M,"-")&&(M=M.slice(1),T=!0),M.length<k)for(var V=k-M.length;V>0;V--)M="0"+M;return L>-1&&(M=M.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p.delimiters.thousands)),d.indexOf(".")===0&&(M=""),E=M+_+(b||""),v?E=(v&&T?"(":"")+E+(v&&T?")":""):z>=0?E=z===0?(T?"-":"+")+E:E+(T?"-":"+"):T&&(E="-"+E),E},stringToNumber:function(h){var d=o[s.currentLocale],m=h,p={thousand:3,million:6,billion:9,trillion:12},v,y,k,b;if(s.zeroFormat&&h===s.zeroFormat)y=0;else if(s.nullFormat&&h===s.nullFormat||!h.replace(/[^0-9]+/g,"").length)y=null;else{y=1,d.delimiters.decimal!=="."&&(h=h.replace(/\./g,"").replace(d.delimiters.decimal,"."));for(v in p)if(b=new RegExp("[^a-zA-Z]"+d.abbreviations[v]+"(?:\\)|(\\"+d.currency.symbol+")?(?:\\))?)?$"),m.match(b)){y*=Math.pow(10,p[v]);break}y*=(h.split("-").length+Math.min(h.split("(").length-1,h.split(")").length-1))%2?1:-1,h=h.replace(/[^0-9\.]+/g,""),y*=Number(h)}return y},isNaN:function(h){return typeof h=="number"&&isNaN(h)},includes:function(h,d){return h.indexOf(d)!==-1},insert:function(h,d,m){return h.slice(0,m)+d+h.slice(m)},reduce:function(h,d){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof d!="function")throw new TypeError(d+" is not a function");var m=Object(h),p=m.length>>>0,v=0,y;if(arguments.length===3)y=arguments[2];else{for(;v<p&&!(v in m);)v++;if(v>=p)throw new TypeError("Reduce of empty array with no initial value");y=m[v++]}for(;v<p;v++)v in m&&(y=d(y,m[v],v,m));return y},multiplier:function(h){var d=h.toString().split(".");return d.length<2?1:Math.pow(10,d[1].length)},correctionFactor:function(){var h=Array.prototype.slice.call(arguments);return h.reduce(function(d,m){var p=n.multiplier(m);return d>p?d:p},1)},toFixed:function(h,d,m,p){var v=h.toString().split("."),y=d-(p||0),k,b,w,x;return v.length===2?k=Math.min(Math.max(v[1].length,y),d):k=y,w=Math.pow(10,k),x=(m(h+"e+"+k)/w).toFixed(k),p>d-k&&(b=new RegExp("\\.?0{1,"+(p-(d-k))+"}$"),x=x.replace(b,"")),x}},e.options=s,e.formats=l,e.locales=o,e.locale=function(h){return h&&(s.currentLocale=h.toLowerCase()),s.currentLocale},e.localeData=function(h){if(!h)return o[s.currentLocale];if(h=h.toLowerCase(),!o[h])throw new Error("Unknown locale : "+h);return o[h]},e.reset=function(){for(var h in a)s[h]=a[h]},e.zeroFormat=function(h){s.zeroFormat=typeof h=="string"?h:null},e.nullFormat=function(h){s.nullFormat=typeof h=="string"?h:null},e.defaultFormat=function(h){s.defaultFormat=typeof h=="string"?h:"0.0"},e.register=function(h,d,m){if(d=d.toLowerCase(),this[h+"s"][d])throw new TypeError(d+" "+h+" already registered.");return this[h+"s"][d]=m,m},e.validate=function(h,d){var m,p,v,y,k,b,w,x;if(typeof h!="string"&&(h+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",h)),h=h.trim(),h.match(/^\d+$/))return!0;if(h==="")return!1;try{w=e.localeData(d)}catch(C){w=e.localeData(e.locale())}return v=w.currency.symbol,k=w.abbreviations,m=w.delimiters.decimal,w.delimiters.thousands==="."?p="\\.":p=w.delimiters.thousands,x=h.match(/^[^\d]+/),x!==null&&(h=h.substr(1),x[0]!==v)||(x=h.match(/[^\d]+$/),x!==null&&(h=h.slice(0,-1),x[0]!==k.thousand&&x[0]!==k.million&&x[0]!==k.billion&&x[0]!==k.trillion))?!1:(b=new RegExp(p+"{2}"),h.match(/[^\d.,]/g)?!1:(y=h.split(m),y.length>2?!1:y.length<2?!!y[0].match(/^\d+.*\d$/)&&!y[0].match(b):y[0].length===1?!!y[0].match(/^\d+$/)&&!y[0].match(b)&&!!y[1].match(/^\d+$/):!!y[0].match(/^\d+.*\d$/)&&!y[0].match(b)&&!!y[1].match(/^\d+$/)))},e.fn=u.prototype={clone:function(){return e(this)},format:function(h,d){var m=this._value,p=h||s.defaultFormat,v,y,k;if(d=d||Math.round,m===0&&s.zeroFormat!==null)y=s.zeroFormat;else if(m===null&&s.nullFormat!==null)y=s.nullFormat;else{for(v in l)if(p.match(l[v].regexps.format)){k=l[v].format;break}k=k||e._.numberToFormat,y=k(m,p,d)}return y},value:function(){return this._value},input:function(){return this._input},set:function(h){return this._value=Number(h),this},add:function(h){var d=n.correctionFactor.call(null,this._value,h);function m(p,v,y,k){return p+Math.round(d*v)}return this._value=n.reduce([this._value,h],m,0)/d,this},subtract:function(h){var d=n.correctionFactor.call(null,this._value,h);function m(p,v,y,k){return p-Math.round(d*v)}return this._value=n.reduce([h],m,Math.round(this._value*d))/d,this},multiply:function(h){function d(m,p,v,y){var k=n.correctionFactor(m,p);return Math.round(m*k)*Math.round(p*k)/Math.round(k*k)}return this._value=n.reduce([this._value,h],d,1),this},divide:function(h){function d(m,p,v,y){var k=n.correctionFactor(m,p);return Math.round(m*k)/Math.round(p*k)}return this._value=n.reduce([this._value,h],d),this},difference:function(h){return Math.abs(e(this._value).subtract(h).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(h){var d=h%10;return~~(h%100/10)==1?"th":d===1?"st":d===2?"nd":d===3?"rd":"th"},currency:{symbol:"$"}}),function(){e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(h,d,m){var p=e._.includes(d," BPS")?" ":"",v;return h=h*1e4,d=d.replace(/\s?BPS/,""),v=e._.numberToFormat(h,d,m),e._.includes(v,")")?(v=v.split(""),v.splice(-1,0,p+"BPS"),v=v.join("")):v=v+p+"BPS",v},unformat:function(h){return+(e._.stringToNumber(h)*1e-4).toFixed(15)}})}(),function(){var h={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},d={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},m=h.suffixes.concat(d.suffixes.filter(function(v){return h.suffixes.indexOf(v)<0})),p=m.join("|");p="("+p.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(p)},format:function(v,y,k){var b,w=e._.includes(y,"ib")?d:h,x=e._.includes(y," b")||e._.includes(y," ib")?" ":"",C,S,_;for(y=y.replace(/\s?i?b/,""),C=0;C<=w.suffixes.length;C++)if(S=Math.pow(w.base,C),_=Math.pow(w.base,C+1),v===null||v===0||v>=S&&v<_){x+=w.suffixes[C],S>0&&(v=v/S);break}return b=e._.numberToFormat(v,y,k),b+x},unformat:function(v){var y=e._.stringToNumber(v),k,b;if(y){for(k=h.suffixes.length-1;k>=0;k--){if(e._.includes(v,h.suffixes[k])){b=Math.pow(h.base,k);break}if(e._.includes(v,d.suffixes[k])){b=Math.pow(d.base,k);break}}y*=b||1}return y}})}(),function(){e.register("format","currency",{regexps:{format:/(\$)/},format:function(h,d,m){var p=e.locales[e.options.currentLocale],v={before:d.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:d.match(/([\+|\-|\)|\s|\$]*)$/)[0]},y,k,b;for(d=d.replace(/\s?\$\s?/,""),y=e._.numberToFormat(h,d,m),h>=0?(v.before=v.before.replace(/[\-\(]/,""),v.after=v.after.replace(/[\-\)]/,"")):h<0&&!e._.includes(v.before,"-")&&!e._.includes(v.before,"(")&&(v.before="-"+v.before),b=0;b<v.before.length;b++)switch(k=v.before[b],k){case"$":y=e._.insert(y,p.currency.symbol,b);break;case" ":y=e._.insert(y," ",b+p.currency.symbol.length-1);break}for(b=v.after.length-1;b>=0;b--)switch(k=v.after[b],k){case"$":y=b===v.after.length-1?y+p.currency.symbol:e._.insert(y,p.currency.symbol,-(v.after.length-(1+b)));break;case" ":y=b===v.after.length-1?y+" ":e._.insert(y," ",-(v.after.length-(1+b)+p.currency.symbol.length-1));break}return y}})}(),function(){e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(h,d,m){var p,v=typeof h=="number"&&!e._.isNaN(h)?h.toExponential():"0e+0",y=v.split("e");return d=d.replace(/e[\+|\-]{1}0/,""),p=e._.numberToFormat(Number(y[0]),d,m),p+"e"+y[1]},unformat:function(h){var d=e._.includes(h,"e+")?h.split("e+"):h.split("e-"),m=Number(d[0]),p=Number(d[1]);p=e._.includes(h,"e-")?p*=-1:p;function v(y,k,b,w){var x=e._.correctionFactor(y,k),C=y*x*(k*x)/(x*x);return C}return e._.reduce([m,Math.pow(10,p)],v,1)}})}(),function(){e.register("format","ordinal",{regexps:{format:/(o)/},format:function(h,d,m){var p=e.locales[e.options.currentLocale],v,y=e._.includes(d," o")?" ":"";return d=d.replace(/\s?o/,""),y+=p.ordinal(h),v=e._.numberToFormat(h,d,m),v+y}})}(),function(){e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(h,d,m){var p=e._.includes(d," %")?" ":"",v;return e.options.scalePercentBy100&&(h=h*100),d=d.replace(/\s?\%/,""),v=e._.numberToFormat(h,d,m),e._.includes(v,")")?(v=v.split(""),v.splice(-1,0,p+"%"),v=v.join("")):v=v+p+"%",v},unformat:function(h){var d=e._.stringToNumber(h);return e.options.scalePercentBy100?d*.01:d}})}(),function(){e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(h,d,m){var p=Math.floor(h/60/60),v=Math.floor((h-p*60*60)/60),y=Math.round(h-p*60*60-v*60);return p+":"+(v<10?"0"+v:v)+":"+(y<10?"0"+y:y)},unformat:function(h){var d=h.split(":"),m=0;return d.length===3?(m=m+Number(d[0])*60*60,m=m+Number(d[1])*60,m=m+Number(d[2])):d.length===2&&(m=m+Number(d[0])*60,m=m+Number(d[1])),Number(m)}})}(),e})});function zs(e,n){var t=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),l=Date.UTC(1899,11,31,0,0,0);return n?t-=1461*24*60*60*1e3:e>=ov&&(t+=24*60*60*1e3),(t-l)/(24*60*60*1e3)}function sv(e,n){var t=new Date(e);if(av)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(da.getFullYear()==1917&&!isNaN(t.getFullYear())){var l=t.getFullYear();return e.indexOf(""+l)>-1||t.setFullYear(t.getFullYear()+100),t}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function cv(e){var n=Number(e);if(typeof e=="number")return e;if(!isNaN(n))return n;var t=1,l=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(l))||(l=l.replace(/[(](.*)[)]/,function(o,a){return t=-t,a}),!isNaN(n=Number(l)))?n/t:n}function nt(e){var n=[],t=null,l={},o=e;if(e==null)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(e)){t=e,o=Number(e.split(".")[0].replace(",",""));let x="#,##0";if(e.split(".")[1]){x="#,##0.";for(let C=0;C<e.split(".")[1].length;C++)x+=0}l={fa:x,t:"n"}}else if(e.toString().substr(0,1)==="'")t=e.toString().substr(1),l={fa:"@",t:"s"};else if(e.toString().toUpperCase()==="TRUE")t="TRUE",l={fa:"General",t:"b"},o=!0;else if(e.toString().toUpperCase()==="FALSE")t="FALSE",l={fa:"General",t:"b"},o=!1;else if(H(e))t=e.toString(),l={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))t=e.toString(),l={fa:"@",t:"s"};else if(B(e)&&Math.abs(parseFloat(e))>0&&(Math.abs(parseFloat(e))>=1e11||Math.abs(parseFloat(e))<1e-9)){o=(0,Or.default)(e).value();var a=o.toExponential();if(a.indexOf(".")>-1){var s=a.split(".")[1].split("e")[0].length;s>5&&(s=5),l={fa:"#0."+new Array(s+1).join("0")+"E+00",t:"n"}}else l={fa:"#0.E+00",t:"n"};t=kl.format(l.fa,o)}else if(e.toString().indexOf("%")>-1){var u=e.toString().indexOf("%"),h=e.toString().substr(0,u),d=h.replace(/,/g,"");if(u==e.toString().length-1&&B(d))if(h.indexOf(".")>-1)if(h.indexOf(".")==h.lastIndexOf(".")){var m=h.split(".")[0],p=h.split(".")[1],v=p.length;if(v>9&&(v=9),m.indexOf(",")>-1){for(var y=!0,k=m.split(","),b=1;b<k.length;b++)if(k[b].length<3){y=!1;break}y?(l={fa:"#,##0."+new Array(v+1).join("0")+"%",t:"n"},o=(0,Or.default)(e).value(),t=kl.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else l={fa:"0."+new Array(v+1).join("0")+"%",t:"n"},o=(0,Or.default)(e).value(),t=kl.format(l.fa,o)}else t=e.toString(),l={fa:"@",t:"s"};else if(h.indexOf(",")>-1){for(var y=!0,k=h.split(","),b=1;b<k.length;b++)if(k[b].length<3){y=!1;break}y?(l={fa:"#,##0%",t:"n"},o=(0,Or.default)(e).value(),t=kl.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else l={fa:"0%",t:"n"},o=(0,Or.default)(e).value(),t=kl.format(l.fa,o);else t=e.toString(),l={fa:"@",t:"s"}}else if(e.toString().indexOf(".")>-1)if(e.toString().indexOf(".")==e.toString().lastIndexOf(".")){var w=e.toString().split(".")[0],h=e.toString().split(".")[1],v=h.length;if(v>9&&(v=9),w.indexOf(",")>-1){for(var y=!0,k=w.split(","),b=1;b<k.length;b++)if(!B(k[b])||k[b].length<3){y=!1;break}y?(l={fa:"#,##0."+new Array(v+1).join("0"),t:"n"},o=(0,Or.default)(e).value(),t=kl.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else B(w)&&B(h)?(l={fa:"0."+new Array(v+1).join("0"),t:"n"},o=(0,Or.default)(e).value(),t=kl.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else t=e.toString(),l={fa:"@",t:"s"};else B(e)?(t=e.toString(),l={fa:"General",t:"n"},o=parseFloat(e)):zt(e)&&(e.toString().indexOf(".")>-1||e.toString().indexOf(":")>-1||e.toString().length<16)?(o=zs(sv(e.toString().replace(/-/g,"/"))),o.toString().indexOf(".")>-1?e.toString().length>18?l.fa="yyyy-MM-dd hh:mm:ss":e.toString().length>11?l.fa="yyyy-MM-dd hh:mm":l.fa="yyyy-MM-dd":l.fa="yyyy-MM-dd",l.t="d",t=kl.format(l.fa,o)):(t=e,l.fa="General",l.t="g");return[t,l,o]}function mt(e,n){return kl.format(e,n)}function Sh(e,n){return kl.is_date(e,n)}function vn(e,n,t){var l=Le(e,n,t,"m");return l==null?l=Le(e,n,t,"v"):isNaN(cv(l))?t[e][n].ct!=null&&t[e][n].ct.t=="d"||t[e][n].ct!=null&&t[e][n].ct.t=="b"||(l=Le(e,n,t,"v")):typeof l=="string"&&l.indexOf("%")>-1||(l=Le(e,n,t,"v")),l}var Or,kl,nv,Bb,Hb,iv,Vb,ov,da,av,Fl=Me(()=>{Nt();Lr();Kt();Or=El(ai()),kl={},nv=function(n){n.version="0.11.2";function t(K){for(var U="",te=K.length-1;te>=0;)U+=K.charAt(te--);return U}function l(K,U){for(var te="";te.length<U;)te+=K;return te}function o(K,U){var te=""+K;return te.length>=U?te:l("0",U-te.length)+te}function a(K,U){var te=""+K;return te.length>=U?te:l(" ",U-te.length)+te}function s(K,U){var te=""+K;return te.length>=U?te:te+l(" ",U-te.length)}function u(K,U){var te=""+Math.round(K);return te.length>=U?te:l("0",U-te.length)+te}function h(K,U){var te=""+K;return te.length>=U?te:l("0",U-te.length)+te}var d=Math.pow(2,32);function m(K,U){if(K>d||K<-d)return u(K,U);var te=Math.round(K);return h(te,U)}function p(K,U){return U=U||0,K.length>=7+U&&(K.charCodeAt(U)|32)==103&&(K.charCodeAt(U+1)|32)==101&&(K.charCodeAt(U+2)|32)==110&&(K.charCodeAt(U+3)|32)==101&&(K.charCodeAt(U+4)|32)==114&&(K.charCodeAt(U+5)|32)==97&&(K.charCodeAt(U+6)|32)==108}var v=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],y=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function k(K){K[0]="General",K[1]="0",K[2]="0.00",K[3]="#,##0",K[4]="#,##0.00",K[9]="0%",K[10]="0.00%",K[11]="0.00E+00",K[12]="# ?/?",K[13]="# ??/??",K[14]="m/d/yy",K[15]="d-mmm-yy",K[16]="d-mmm",K[17]="mmm-yy",K[18]="h:mm AM/PM",K[19]="h:mm:ss AM/PM",K[20]="h:mm",K[21]="h:mm:ss",K[22]="m/d/yy h:mm",K[37]="#,##0 ;(#,##0)",K[38]="#,##0 ;[Red](#,##0)",K[39]="#,##0.00;(#,##0.00)",K[40]="#,##0.00;[Red](#,##0.00)",K[45]="mm:ss",K[46]="[h]:mm:ss",K[47]="mmss.0",K[48]="##0.0E+0",K[49]="@",K[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',K[65535]="General"}var b={};k(b);var w=[],x=0;for(x=5;x<=8;++x)w[x]=32+x;for(x=23;x<=26;++x)w[x]=0;for(x=27;x<=31;++x)w[x]=14;for(x=50;x<=58;++x)w[x]=14;for(x=59;x<=62;++x)w[x]=x-58;for(x=67;x<=68;++x)w[x]=x-58;for(x=72;x<=75;++x)w[x]=x-58;for(x=67;x<=68;++x)w[x]=x-57;for(x=76;x<=78;++x)w[x]=x-56;for(x=79;x<=81;++x)w[x]=x-34;var C=[];C[5]=C[63]='"$"#,##0_);\\("$"#,##0\\)',C[6]=C[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',C[7]=C[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',C[8]=C[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',C[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',C[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',C[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',C[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function S(K,U,te){for(var ge=K<0?-1:1,ie=K*ge,$e=0,oe=1,ze=0,je=1,Ce=0,Ee=0,Ue=Math.floor(ie);Ce<U&&(Ue=Math.floor(ie),ze=Ue*oe+$e,Ee=Ue*Ce+je,!(ie-Ue<5e-8));)ie=1/(ie-Ue),$e=oe,oe=ze,je=Ce,Ce=Ee;if(Ee>U&&(Ce>U?(Ee=je,ze=$e):(Ee=Ce,ze=oe)),!te)return[0,ge*ze,Ee];var Pe=Math.floor(ge*ze/Ee);return[Pe,ge*ze-Pe*Ee,Ee]}function _(K,U,te){if(K>2958465||K<0)return null;var ge=K|0,ie=Math.floor(86400*(K-ge)),$e=0,oe=[],ze={D:ge,T:ie,u:86400*(K-ge)-ie,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(ze.u)<1e-6&&(ze.u=0),U&&U.date1904&&(ge+=1462),ze.u>.9999&&(ze.u=0,++ie==86400&&(ze.T=ie=0,++ge,++ze.D)),ge===60)oe=te?[1317,10,29]:[1900,2,29],$e=3;else if(ge===0)oe=te?[1317,8,29]:[1900,1,0],$e=6;else{ge>60&&--ge;var je=new Date(1900,0,1);je.setDate(je.getDate()+ge-1),oe=[je.getFullYear(),je.getMonth()+1,je.getDate()],$e=je.getDay(),ge<60&&($e=($e+6)%7),te&&($e=A(je,oe))}return ze.y=oe[0],ze.m=oe[1],ze.d=oe[2],ze.S=ie%60,ie=Math.floor(ie/60),ze.M=ie%60,ie=Math.floor(ie/60),ze.H=ie,ze.q=$e,ze}n.parse_date_code=_;var T=new Date(1899,11,31,0,0,0),F=T.getTime(),R=new Date(1900,2,1,0,0,0);function I(K,U){var te=K.getTime();return U?te-=1461*24*60*60*1e3:K>=R&&(te+=24*60*60*1e3),(te-(F+(K.getTimezoneOffset()-T.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function P(K){return K.toString(10)}n._general_int=P;var O=function(){var U=/(?:\.0*|(\.\d*[1-9])0+)$/;function te(Ce){return Ce.indexOf(".")==-1?Ce:Ce.replace(U,"$1")}var ge=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,ie=/(E[+-])(\d)$/;function $e(Ce){return Ce.indexOf("E")==-1?Ce:Ce.replace(ge,"$1E").replace(ie,"$10$2")}function oe(Ce){var Ee=Ce<0?12:11,Ue=te(Ce.toFixed(12));return Ue.length<=Ee||(Ue=Ce.toPrecision(10),Ue.length<=Ee)?Ue:Ce.toExponential(5)}function ze(Ce){var Ee=te(Ce.toFixed(11));return Ee.length>(Ce<0?12:11)||Ee==="0"||Ee==="-0"?Ce.toPrecision(6):Ee}function je(Ce){var Ee=Math.floor(Math.log(Math.abs(Ce))*Math.LOG10E),Ue;return Ee>=-4&&Ee<=-1?Ue=Ce.toPrecision(10+Ee):Math.abs(Ee)<=9?Ue=oe(Ce):Ee===10?Ue=Ce.toFixed(10).substr(0,12):Ue=ze(Ce),te($e(Ue.toUpperCase()))}return je}();n._general_num=O;function M(K,U){switch(typeof K){case"string":return K;case"boolean":return K?"TRUE":"FALSE";case"number":return(K|0)===K?K.toString(10):O(K);case"undefined":return"";case"object":if(K==null)return"";if(K instanceof Date)return fe(14,I(K,U&&U.date1904),U)}throw new Error("unsupported value in General format: "+K)}n._general=M;function A(K,U){U[0]-=581;var te=K.getDay();return K<60&&(te=(te+6)%7),te}var z="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function L(K,U,te,ge){var ie="",$e=0,oe=0,ze=te.y,je,Ce=0;switch(K){case 98:ze=te.y+543;case 121:switch(U.length){case 1:case 2:je=ze%100,Ce=2;break;default:je=ze%1e4,Ce=4;break}break;case 109:switch(U.length){case 1:case 2:je=te.m,Ce=U.length;break;case 3:return y[te.m-1][1];case 5:return y[te.m-1][0];default:return y[te.m-1][2]}break;case 100:switch(U.length){case 1:case 2:je=te.d,Ce=U.length;break;case 3:return v[te.q][0];default:return v[te.q][1]}break;case 104:switch(U.length){case 1:case 2:je=1+(te.H+11)%12,Ce=U.length;break;default:throw"bad hour format: "+U}break;case 72:switch(U.length){case 1:case 2:je=te.H,Ce=U.length;break;default:throw"bad hour format: "+U}break;case 77:switch(U.length){case 1:case 2:je=te.M,Ce=U.length;break;default:throw"bad minute format: "+U}break;case 115:if(U!="s"&&U!="ss"&&U!=".0"&&U!=".00"&&U!=".000")throw"bad second format: "+U;return te.u===0&&(U=="s"||U=="ss")?o(te.S,U.length):(ge>=2?oe=ge===3?1e3:100:oe=ge===1?10:1,$e=Math.round(oe*(te.S+te.u)),$e>=60*oe&&($e=0),U==="s"?$e===0?"0":""+$e/oe:(ie=o($e,2+ge),U==="ss"?ie.substr(0,2):"."+ie.substr(2,U.length-1)));case 90:switch(U){case"[h]":case"[hh]":je=te.D*24+te.H;break;case"[m]":case"[mm]":je=(te.D*24+te.H)*60+te.M;break;case"[s]":case"[ss]":je=((te.D*24+te.H)*60+te.M)*60+Math.round(te.S+te.u);break;default:throw"bad abstime format: "+U}Ce=U.length===3?1:2;break;case 101:je=ze,Ce=1;break}var Ee=Ce>0?o(je,Ce):"";return Ee}function E(K){var U=3;if(K.length<=U)return K;for(var te=K.length%U,ge=K.substr(0,te);te!=K.length;te+=U)ge+=(ge.length>0?",":"")+K.substr(te,U);return ge}var V=function(){var U=/%/g;function te(Ae,ve,ke){var ft=ve.replace(U,""),Fe=ve.length-ft.length;return V(Ae,ft,ke*Math.pow(10,2*Fe))+l("%",Fe)}function ge(Ae,ve,ke){for(var ft=ve.length-1;ve.charCodeAt(ft-1)===44;)--ft;return V(Ae,ve.substr(0,ft),ke/Math.pow(10,3*(ve.length-ft)))}function ie(Ae,ve){var ke,ft=Ae.indexOf("E")-Ae.indexOf(".")-1;if(Ae.match(/^#+0.0E\+0$/)){if(ve==0)return"0.0E+0";if(ve<0)return"-"+ie(Ae,-ve);var Fe=Ae.indexOf(".");Fe===-1&&(Fe=Ae.indexOf("E"));var Ne=Math.floor(Math.log(ve)*Math.LOG10E)%Fe;if(Ne<0&&(Ne+=Fe),ke=(ve/Math.pow(10,Ne)).toPrecision(ft+1+(Fe+Ne)%Fe),ke.indexOf("e")===-1){var Ft=Math.floor(Math.log(ve)*Math.LOG10E);for(ke.indexOf(".")===-1?ke=ke.charAt(0)+"."+ke.substr(1)+"E+"+(Ft-ke.length+Ne):ke+="E+"+(Ft-Ne);ke.substr(0,2)==="0.";)ke=ke.charAt(0)+ke.substr(2,Fe)+"."+ke.substr(2+Fe),ke=ke.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");ke=ke.replace(/\+-/,"-")}ke=ke.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(pt,al,sl,Vt){return al+sl+Vt.substr(0,(Fe+Ne)%Fe)+"."+Vt.substr(Ne)+"E"})}else ke=ve.toExponential(ft);return Ae.match(/E\+00$/)&&ke.match(/e[+-]\d$/)&&(ke=ke.substr(0,ke.length-1)+"0"+ke.charAt(ke.length-1)),Ae.match(/E\-/)&&ke.match(/e\+/)&&(ke=ke.replace(/e\+/,"e")),ke.replace("e","E")}var $e=/# (\?+)( ?)\/( ?)(\d+)/;function oe(Ae,ve,ke){var ft=parseInt(Ae[4],10),Fe=Math.round(ve*ft),Ne=Math.floor(Fe/ft),Ft=Fe-Ne*ft,pt=ft;return ke+(Ne===0?"":""+Ne)+" "+(Ft===0?l(" ",Ae[1].length+1+Ae[4].length):a(Ft,Ae[1].length)+Ae[2]+"/"+Ae[3]+o(pt,Ae[4].length))}function ze(Ae,ve,ke){return ke+(ve===0?"":""+ve)+l(" ",Ae[1].length+2+Ae[4].length)}var je=/^#*0*\.([0#]+)/,Ce=/\).*[0#]/,Ee=/\(###\) ###\\?-####/;function Ue(Ae){for(var ve="",ke,ft=0;ft!=Ae.length;++ft)switch(ke=Ae.charCodeAt(ft)){case 35:break;case 63:ve+=" ";break;case 48:ve+="0";break;default:ve+=String.fromCharCode(ke)}return ve}function Pe(Ae,ve){var ke=Math.pow(10,ve);return""+Math.round(Ae*ke)/ke}function et(Ae,ve){var ke=Ae-Math.floor(Ae),ft=Math.pow(10,ve);return ve<(""+Math.round(ke*ft)).length?0:Math.round(ke*ft)}function yt(Ae,ve){return ve<(""+Math.round((Ae-Math.floor(Ae))*Math.pow(10,ve))).length?1:0}function St(Ae){return Ae<2147483647&&Ae>-2147483648?""+(Ae>=0?Ae|0:Ae-1|0):""+Math.floor(Ae)}function ot(Ae,ve,ke){if(Ae.charCodeAt(0)===40&&!ve.match(Ce)){var ft=ve.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return ke>=0?ot("n",ft,ke):"("+ot("n",ft,-ke)+")"}if(ve.charCodeAt(ve.length-1)===44)return ge(Ae,ve,ke);if(ve.indexOf("%")!==-1)return te(Ae,ve,ke);if(ve.indexOf("E")!==-1)return ie(ve,ke);if(ve.charCodeAt(0)===36)return"$"+ot(Ae,ve.substr(ve.charAt(1)==" "?2:1),ke);var Fe,Ne,Ft,pt,al=Math.abs(ke),sl=ke<0?"-":"";if(ve.match(/^00+$/))return sl+m(al,ve.length);if(ve.match(/^[#?]+$/))return Fe=m(ke,0),Fe==="0"&&(Fe=""),Fe.length>ve.length?Fe:Ue(ve.substr(0,ve.length-Fe.length))+Fe;if(Ne=ve.match($e))return oe(Ne,al,sl);if(ve.match(/^#+0+$/))return sl+m(al,ve.length-ve.indexOf("0"));if(Ne=ve.match(je))return Fe=Pe(ke,Ne[1].length).replace(/^([^\.]+)$/,"$1."+Ue(Ne[1])).replace(/\.$/,"."+Ue(Ne[1])).replace(/\.(\d*)$/,function(Ul,Gn){return"."+Gn+l("0",Ue(Ne[1]).length-Gn.length)}),ve.indexOf("0.")!==-1?Fe:Fe.replace(/^0\./,".");if(ve=ve.replace(/^#+([0.])/,"$1"),Ne=ve.match(/^(0*)\.(#*)$/))return sl+Pe(al,Ne[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,Ne[1].length?"0.":".");if(Ne=ve.match(/^#{1,3},##0(\.?)$/))return sl+E(m(al,0));if(Ne=ve.match(/^#,##0\.([#0]*0)$/))return ke<0?"-"+ot(Ae,ve,-ke):E(""+(Math.floor(ke)+yt(ke,Ne[1].length)))+"."+o(et(ke,Ne[1].length),Ne[1].length);if(Ne=ve.match(/^#,#*,#0/))return ot(Ae,ve.replace(/^#,#*,/,""),ke);if(Ne=ve.match(/^([0#]+)(\\?-([0#]+))+$/))return Fe=t(ot(Ae,ve.replace(/[\\-]/g,""),ke)),Ft=0,t(t(ve.replace(/\\/g,"")).replace(/[0#]/g,function(Ul){return Ft<Fe.length?Fe.charAt(Ft++):Ul==="0"?"0":""}));if(ve.match(Ee))return Fe=ot(Ae,"##########",ke),"("+Fe.substr(0,3)+") "+Fe.substr(3,3)+"-"+Fe.substr(6);var Vt="";if(Ne=ve.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return Ft=Math.min(Ne[4].length,7),pt=S(al,Math.pow(10,Ft)-1,!1),Fe=""+sl,Vt=V("n",Ne[1],pt[1]),Vt.charAt(Vt.length-1)==" "&&(Vt=Vt.substr(0,Vt.length-1)+"0"),Fe+=Vt+Ne[2]+"/"+Ne[3],Vt=s(pt[2],Ft),Vt.length<Ne[4].length&&(Vt=Ue(Ne[4].substr(Ne[4].length-Vt.length))+Vt),Fe+=Vt,Fe;if(Ne=ve.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return Ft=Math.min(Math.max(Ne[1].length,Ne[4].length),7),pt=S(al,Math.pow(10,Ft)-1,!0),sl+(pt[0]||(pt[1]?"":"0"))+" "+(pt[1]?a(pt[1],Ft)+Ne[2]+"/"+Ne[3]+s(pt[2],Ft):l(" ",2*Ft+1+Ne[2].length+Ne[3].length));if(Ne=ve.match(/^[#0?]+$/))return Fe=m(ke,0),ve.length<=Fe.length?Fe:Ue(ve.substr(0,ve.length-Fe.length))+Fe;if(Ne=ve.match(/^([#0?]+)\.([#0]+)$/)){Fe=""+ke.toFixed(Math.min(Ne[2].length,10)).replace(/([^0])0+$/,"$1"),Ft=Fe.indexOf(".");var Kr=ve.indexOf(".")-Ft,Un=ve.length-Fe.length-Kr;return Ue(ve.substr(0,Kr)+Fe+ve.substr(ve.length-Un))}if(Ne=ve.match(/^00,000\.([#0]*0)$/))return Ft=et(ke,Ne[1].length),ke<0?"-"+ot(Ae,ve,-ke):E(St(ke)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Ul){return"00,"+(Ul.length<3?o(0,3-Ul.length):"")+Ul})+"."+o(Ft,Ne[1].length);switch(ve){case"###,##0.00":return ot(Ae,"#,##0.00",ke);case"###,###":case"##,###":case"#,###":var Wl=E(m(al,0));return Wl!=="0"?sl+Wl:"";case"###,###.00":return ot(Ae,"###,##0.00",ke).replace(/^0\./,".");case"#,###.00":return ot(Ae,"#,##0.00",ke).replace(/^0\./,".");default:}throw new Error("unsupported format |"+ve+"|")}function bt(Ae,ve,ke){for(var ft=ve.length-1;ve.charCodeAt(ft-1)===44;)--ft;return V(Ae,ve.substr(0,ft),ke/Math.pow(10,3*(ve.length-ft)))}function qe(Ae,ve,ke){var ft=ve.replace(U,""),Fe=ve.length-ft.length;return V(Ae,ft,ke*Math.pow(10,2*Fe))+l("%",Fe)}function Te(Ae,ve){var ke,ft=Ae.indexOf("E")-Ae.indexOf(".")-1;if(Ae.match(/^#+0.0E\+0$/)){if(ve==0)return"0.0E+0";if(ve<0)return"-"+Te(Ae,-ve);var Fe=Ae.indexOf(".");Fe===-1&&(Fe=Ae.indexOf("E"));var Ne=Math.floor(Math.log(ve)*Math.LOG10E)%Fe;if(Ne<0&&(Ne+=Fe),ke=(ve/Math.pow(10,Ne)).toPrecision(ft+1+(Fe+Ne)%Fe),!ke.match(/[Ee]/)){var Ft=Math.floor(Math.log(ve)*Math.LOG10E);ke.indexOf(".")===-1?ke=ke.charAt(0)+"."+ke.substr(1)+"E+"+(Ft-ke.length+Ne):ke+="E+"+(Ft-Ne),ke=ke.replace(/\+-/,"-")}ke=ke.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(pt,al,sl,Vt){return al+sl+Vt.substr(0,(Fe+Ne)%Fe)+"."+Vt.substr(Ne)+"E"})}else ke=ve.toExponential(ft);return Ae.match(/E\+00$/)&&ke.match(/e[+-]\d$/)&&(ke=ke.substr(0,ke.length-1)+"0"+ke.charAt(ke.length-1)),Ae.match(/E\-/)&&ke.match(/e\+/)&&(ke=ke.replace(/e\+/,"e")),ke.replace("e","E")}function Xe(Ae,ve,ke){if(Ae.charCodeAt(0)===40&&!ve.match(Ce)){var ft=ve.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return ke>=0?Xe("n",ft,ke):"("+Xe("n",ft,-ke)+")"}if(ve.charCodeAt(ve.length-1)===44)return bt(Ae,ve,ke);if(ve.indexOf("%")!==-1)return qe(Ae,ve,ke);if(ve.indexOf("E")!==-1)return Te(ve,ke);if(ve.charCodeAt(0)===36)return"$"+Xe(Ae,ve.substr(ve.charAt(1)==" "?2:1),ke);var Fe,Ne,Ft,pt,al=Math.abs(ke),sl=ke<0?"-":"";if(ve.match(/^00+$/))return sl+o(al,ve.length);if(ve.match(/^[#?]+$/))return Fe=""+ke,ke===0&&(Fe=""),Fe.length>ve.length?Fe:Ue(ve.substr(0,ve.length-Fe.length))+Fe;if(Ne=ve.match($e))return ze(Ne,al,sl);if(ve.match(/^#+0+$/))return sl+o(al,ve.length-ve.indexOf("0"));if(Ne=ve.match(je))return Fe=(""+ke).replace(/^([^\.]+)$/,"$1."+Ue(Ne[1])).replace(/\.$/,"."+Ue(Ne[1])),Fe=Fe.replace(/\.(\d*)$/,function(Ul,Gn){return"."+Gn+l("0",Ue(Ne[1]).length-Gn.length)}),ve.indexOf("0.")!==-1?Fe:Fe.replace(/^0\./,".");if(ve=ve.replace(/^#+([0.])/,"$1"),Ne=ve.match(/^(0*)\.(#*)$/))return sl+(""+al).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,Ne[1].length?"0.":".");if(Ne=ve.match(/^#{1,3},##0(\.?)$/))return sl+E(""+al);if(Ne=ve.match(/^#,##0\.([#0]*0)$/))return ke<0?"-"+Xe(Ae,ve,-ke):E(""+ke)+"."+l("0",Ne[1].length);if(Ne=ve.match(/^#,#*,#0/))return Xe(Ae,ve.replace(/^#,#*,/,""),ke);if(Ne=ve.match(/^([0#]+)(\\?-([0#]+))+$/))return Fe=t(Xe(Ae,ve.replace(/[\\-]/g,""),ke)),Ft=0,t(t(ve.replace(/\\/g,"")).replace(/[0#]/g,function(Ul){return Ft<Fe.length?Fe.charAt(Ft++):Ul==="0"?"0":""}));if(ve.match(Ee))return Fe=Xe(Ae,"##########",ke),"("+Fe.substr(0,3)+") "+Fe.substr(3,3)+"-"+Fe.substr(6);var Vt="";if(Ne=ve.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return Ft=Math.min(Ne[4].length,7),pt=S(al,Math.pow(10,Ft)-1,!1),Fe=""+sl,Vt=V("n",Ne[1],pt[1]),Vt.charAt(Vt.length-1)==" "&&(Vt=Vt.substr(0,Vt.length-1)+"0"),Fe+=Vt+Ne[2]+"/"+Ne[3],Vt=s(pt[2],Ft),Vt.length<Ne[4].length&&(Vt=Ue(Ne[4].substr(Ne[4].length-Vt.length))+Vt),Fe+=Vt,Fe;if(Ne=ve.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return Ft=Math.min(Math.max(Ne[1].length,Ne[4].length),7),pt=S(al,Math.pow(10,Ft)-1,!0),sl+(pt[0]||(pt[1]?"":"0"))+" "+(pt[1]?a(pt[1],Ft)+Ne[2]+"/"+Ne[3]+s(pt[2],Ft):l(" ",2*Ft+1+Ne[2].length+Ne[3].length));if(Ne=ve.match(/^[#0?]+$/))return Fe=""+ke,ve.length<=Fe.length?Fe:Ue(ve.substr(0,ve.length-Fe.length))+Fe;if(Ne=ve.match(/^([#0]+)\.([#0]+)$/)){Fe=""+ke.toFixed(Math.min(Ne[2].length,10)).replace(/([^0])0+$/,"$1"),Ft=Fe.indexOf(".");var Kr=ve.indexOf(".")-Ft,Un=ve.length-Fe.length-Kr;return Ue(ve.substr(0,Kr)+Fe+ve.substr(ve.length-Un))}if(Ne=ve.match(/^00,000\.([#0]*0)$/))return ke<0?"-"+Xe(Ae,ve,-ke):E(""+ke).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Ul){return"00,"+(Ul.length<3?o(0,3-Ul.length):"")+Ul})+"."+o(0,Ne[1].length);switch(ve){case"###,###":case"##,###":case"#,###":var Wl=E(""+al);return Wl!=="0"?sl+Wl:"";default:if(ve.match(/\.[0#?]*$/))return Xe(Ae,ve.slice(0,ve.lastIndexOf(".")),ke)+Ue(ve.slice(ve.lastIndexOf(".")))}throw new Error("unsupported format |"+ve+"|")}return function(ve,ke,ft){return(ft|0)===ft?Xe(ve,ke,ft):ot(ve,ke,ft)}}();function q(K){for(var U=[],te=!1,ge=0,ie=0;ge<K.length;++ge)switch(K.charCodeAt(ge)){case 34:te=!te;break;case 95:case 42:case 92:++ge;break;case 59:U[U.length]=K.substr(ie,ge-ie),ie=ge+1}if(U[U.length]=K.substr(ie),te===!0)throw new Error("Format |"+K+"| unterminated string ");return U}n._split=q;var G=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function X(K){for(var U=0,te="",ge="";U<K.length;)switch(te=K.charAt(U)){case"G":p(K,U)&&(U+=6),U++;break;case'"':for(;K.charCodeAt(++U)!==34&&U<K.length;);++U;break;case"\\":U+=2;break;case"_":U+=2;break;case"@":++U;break;case"B":case"b":if(K.charAt(U+1)==="1"||K.charAt(U+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(K.substr(U,3).toUpperCase()==="A/P"||K.substr(U,5).toUpperCase()==="AM/PM"||K.substr(U,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++U;break;case"[":for(ge=te;K.charAt(U++)!=="]"&&U<K.length;)ge+=K.charAt(U);if(ge.match(G))return!0;break;case".":case"0":case"#":for(;U<K.length&&("0#?.,E+-%".indexOf(te=K.charAt(++U))>-1||te=="\\"&&K.charAt(U+1)=="-"&&"0#".indexOf(K.charAt(U+2))>-1););break;case"?":for(;K.charAt(++U)===te;);break;case"*":++U,(K.charAt(U)==" "||K.charAt(U)=="*")&&++U;break;case"(":case")":++U;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;U<K.length&&"0123456789".indexOf(K.charAt(++U))>-1;);break;case" ":++U;break;default:++U;break}return!1}n.is_date=X;function ee(K,U,te,ge){for(var ie=[],$e="",oe=0,ze="",je="t",Ce,Ee,Ue,Pe="H";oe<K.length;)switch(ze=K.charAt(oe)){case"G":if(!p(K,oe))throw new Error("unrecognized character "+ze+" in "+K);ie[ie.length]={t:"G",v:"General"},oe+=7;break;case'"':for($e="";(Ue=K.charCodeAt(++oe))!==34&&oe<K.length;)$e+=String.fromCharCode(Ue);ie[ie.length]={t:"t",v:$e},++oe;break;case"\\":var et=K.charAt(++oe),yt=et==="("||et===")"?et:"t";ie[ie.length]={t:yt,v:et},++oe;break;case"_":ie[ie.length]={t:"t",v:" "},oe+=2;break;case"@":ie[ie.length]={t:"T",v:U},++oe;break;case"B":case"b":if(K.charAt(oe+1)==="1"||K.charAt(oe+1)==="2"){if(Ce==null&&(Ce=_(U,te,K.charAt(oe+1)==="2"),Ce==null))return"";ie[ie.length]={t:"X",v:K.substr(oe,2)},je=ze,oe+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":ze=ze.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(U<0)return"";if(Ce==null&&(Ce=_(U,te),Ce==null))return"#####";for($e=ze;++oe<K.length&&K.charAt(oe).toLowerCase()===ze;)$e+=ze;ze==="m"&&je.toLowerCase()==="h"&&(ze="M"),ze==="h"&&(ze=Pe),ie[ie.length]={t:ze,v:$e},je=ze;break;case"A":case"a":case"\u4E0A":var St={t:ze,v:ze};if(Ce==null&&(Ce=_(U,te)),K.substr(oe,3).toUpperCase()==="A/P"?(Ce!=null&&(St.v=Ce.H>=12?"P":"A"),St.t="T",Pe="h",oe+=3):K.substr(oe,5).toUpperCase()==="AM/PM"?(Ce!=null&&(St.v=Ce.H>=12?"PM":"AM"),St.t="T",oe+=5,Pe="h"):K.substr(oe,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(Ce!=null&&(St.v=Ce.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),St.t="T",oe+=5,Pe="h"):(St.t="t",++oe),Ce==null&&St.t==="T")return"";ie[ie.length]=St,je=ze;break;case"[":for($e=ze;K.charAt(oe++)!=="]"&&oe<K.length;)$e+=K.charAt(oe);if($e.slice(-1)!=="]")throw'unterminated "[" block: |'+$e+"|";if($e.match(G)){if(Ce==null&&(Ce=_(U,te),Ce==null))return"";ie[ie.length]={t:"Z",v:$e.toLowerCase()},je=$e.charAt(1)}else $e.indexOf("$")>-1&&($e=($e.match(/\$([^-\[\]]*)/)||[])[1]||"$",X(K)||(ie[ie.length]={t:"t",v:$e}));break;case".":if(Ce!=null){for($e=ze;++oe<K.length&&(ze=K.charAt(oe))==="0";)$e+=ze;ie[ie.length]={t:"s",v:$e};break}case"0":case"#":for($e=ze;++oe<K.length&&"0#?.,E+-%".indexOf(ze=K.charAt(oe))>-1;)$e+=ze;ie[ie.length]={t:"n",v:$e};break;case"?":for($e=ze;K.charAt(++oe)===ze;)$e+=ze;ie[ie.length]={t:ze,v:$e},je=ze;break;case"*":++oe,(K.charAt(oe)==" "||K.charAt(oe)=="*")&&++oe;break;case"(":case")":ie[ie.length]={t:ge===1?"t":ze,v:ze},++oe;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for($e=ze;oe<K.length&&"0123456789".indexOf(K.charAt(++oe))>-1;)$e+=K.charAt(oe);ie[ie.length]={t:"D",v:$e};break;case" ":ie[ie.length]={t:ze,v:ze},++oe;break;case"$":ie[ie.length]={t:"t",v:"$"},++oe;break;default:if("\xA4\u0E3FBsBr\u20B5\u20A1\u20AB\u0192FtRs.\u20ADkr\xA3\u20A4Lm\u20A5\u20A6\u20B1PQRSkRp\u09F2\u09F3R$S/.\u3012\u20AE\u20A9\xA5NT\uFFE5z\u0142\u20B4\u20AA\u17DB\u0440\u0443\u0431\u20AC\uFF04,$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP$\uFFE5LekdinAf$dhAflRial?\uFFE1BirrKzMOPPGKRsGsB/R$\u0440\u0440levkrKMzBsPNuFBuKPkrRD$NfkCFA?CVEGMDFrCDHTGNAfLFdjKGSFGGHSRielKCFknKshLSLL\uFFE1LtRFRONArRfMWKRMMURsMROS/KMDLMTnRC$kr\u20ACGELCHFSLLSCRDbSZLSDGSOSSomFCFPTShT$VUVQUGX\u0433\u0440\u043DsomWSTNT$FtDramRpZMWFCFA".indexOf(ze)===-1)throw new Error("unrecognized character "+ze+" in "+K);ie[ie.length]={t:"t",v:ze},++oe;break}var ot=0,bt=0,qe;for(oe=ie.length-1,je="t";oe>=0;--oe)switch(ie[oe].t){case"h":case"H":ie[oe].t=Pe,je="h",ot<1&&(ot=1);break;case"s":(qe=ie[oe].v.match(/\.0+$/))&&(bt=Math.max(bt,qe[0].length-1)),ot<3&&(ot=3);case"d":case"y":case"M":case"e":je=ie[oe].t;break;case"m":je==="s"&&(ie[oe].t="M",ot<2&&(ot=2));break;case"X":break;case"Z":ot<1&&ie[oe].v.match(/[Hh]/)&&(ot=1),ot<2&&ie[oe].v.match(/[Mm]/)&&(ot=2),ot<3&&ie[oe].v.match(/[Ss]/)&&(ot=3)}switch(ot){case 0:break;case 1:Ce.u>=.5&&(Ce.u=0,++Ce.S),Ce.S>=60&&(Ce.S=0,++Ce.M),Ce.M>=60&&(Ce.M=0,++Ce.H);break;case 2:Ce.u>=.5&&(Ce.u=0,++Ce.S),Ce.S>=60&&(Ce.S=0,++Ce.M);break}var Te="",Xe;for(oe=0;oe<ie.length;++oe)switch(ie[oe].t){case"t":case"T":case" ":case"D":break;case"X":ie[oe].v="",ie[oe].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":ie[oe].v=L(ie[oe].t.charCodeAt(0),ie[oe].v,Ce,bt),ie[oe].t="t";break;case"n":case"?":for(Xe=oe+1;ie[Xe]!=null&&((ze=ie[Xe].t)==="?"||ze==="D"||(ze===" "||ze==="t")&&ie[Xe+1]!=null&&(ie[Xe+1].t==="?"||ie[Xe+1].t==="t"&&ie[Xe+1].v==="/")||ie[oe].t==="("&&(ze===" "||ze==="n"||ze===")")||ze==="t"&&(ie[Xe].v==="/"||ie[Xe].v===" "&&ie[Xe+1]!=null&&ie[Xe+1].t=="?"));)ie[oe].v+=ie[Xe].v,ie[Xe]={v:"",t:";"},++Xe;Te+=ie[oe].v,oe=Xe-1;break;case"G":ie[oe].t="t",ie[oe].v=M(U,te);break}var Ae="",ve,ke;if(Te.length>0){Te.charCodeAt(0)==40?(ve=U<0&&Te.charCodeAt(0)===45?-U:U,ke=V("n",Te,ve)):(ve=U<0&&ge>1?-U:U,ke=V("n",Te,ve),ve<0&&ie[0]&&ie[0].t=="t"&&(ke=ke.substr(1),ie[0].v="-"+ie[0].v)),Xe=ke.length-1;var ft=ie.length;for(oe=0;oe<ie.length;++oe)if(ie[oe]!=null&&ie[oe].t!="t"&&ie[oe].v.indexOf(".")>-1){ft=oe;break}var Fe=ie.length;if(ft===ie.length&&ke.indexOf("E")===-1){for(oe=ie.length-1;oe>=0;--oe)ie[oe]==null||"n?".indexOf(ie[oe].t)===-1||(Xe>=ie[oe].v.length-1?(Xe-=ie[oe].v.length,ie[oe].v=ke.substr(Xe+1,ie[oe].v.length)):Xe<0?ie[oe].v="":(ie[oe].v=ke.substr(0,Xe+1),Xe=-1),ie[oe].t="t",Fe=oe);Xe>=0&&Fe<ie.length&&(ie[Fe].v=ke.substr(0,Xe+1)+ie[Fe].v)}else if(ft!==ie.length&&ke.indexOf("E")===-1){for(Xe=ke.indexOf(".")-1,oe=ft;oe>=0;--oe)if(!(ie[oe]==null||"n?".indexOf(ie[oe].t)===-1)){for(Ee=ie[oe].v.indexOf(".")>-1&&oe===ft?ie[oe].v.indexOf(".")-1:ie[oe].v.length-1,Ae=ie[oe].v.substr(Ee+1);Ee>=0;--Ee)Xe>=0&&(ie[oe].v.charAt(Ee)==="0"||ie[oe].v.charAt(Ee)==="#")&&(Ae=ke.charAt(Xe--)+Ae);ie[oe].v=Ae,ie[oe].t="t",Fe=oe}for(Xe>=0&&Fe<ie.length&&(ie[Fe].v=ke.substr(0,Xe+1)+ie[Fe].v),Xe=ke.indexOf(".")+1,oe=ft;oe<ie.length;++oe)if(!(ie[oe]==null||"n?(".indexOf(ie[oe].t)===-1&&oe!==ft)){for(Ee=ie[oe].v.indexOf(".")>-1&&oe===ft?ie[oe].v.indexOf(".")+1:0,Ae=ie[oe].v.substr(0,Ee);Ee<ie[oe].v.length;++Ee)Xe<ke.length&&(Ae+=ke.charAt(Xe++));ie[oe].v=Ae,ie[oe].t="t",Fe=oe}}}for(oe=0;oe<ie.length;++oe)ie[oe]!=null&&"n?".indexOf(ie[oe].t)>-1&&(ve=ge>1&&U<0&&oe>0&&ie[oe-1].v==="-"?-U:U,ie[oe].v=V(ie[oe].t,ie[oe].v,ve),ie[oe].t="t");var Ne="";for(oe=0;oe!==ie.length;++oe)ie[oe]!=null&&(Ne+=ie[oe].v);return Ne}n._eval=ee;var le=/\[[=<>]/,se=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ae(K,U){if(U==null)return!1;var te=parseFloat(U[2]);switch(U[1]){case"=":if(K==te)return!0;break;case">":if(K>te)return!0;break;case"<":if(K<te)return!0;break;case"<>":if(K!=te)return!0;break;case">=":if(K>=te)return!0;break;case"<=":if(K<=te)return!0;break}return!1}function ue(K,U){var te=q(K),ge=te.length,ie=te[ge-1].indexOf("@");if(ge<4&&ie>-1&&--ge,te.length>4)throw new Error("cannot find right format for |"+te.join("|")+"|");if(typeof U!="number")return[4,te.length===4||ie>-1?te[te.length-1]:"@"];switch(te.length){case 1:te=ie>-1?["General","General","General",te[0]]:[te[0],te[0],te[0],"@"];break;case 2:te=ie>-1?[te[0],te[0],te[0],te[1]]:[te[0],te[1],te[0],"@"];break;case 3:te=ie>-1?[te[0],te[1],te[0],te[2]]:[te[0],te[1],te[2],"@"];break;case 4:break}var $e=U>0?te[0]:U<0?te[1]:te[2];if(te[0].indexOf("[")===-1&&te[1].indexOf("[")===-1)return[ge,$e];if(te[0].match(le)!=null||te[1].match(le)!=null){var oe=te[0].match(se),ze=te[1].match(se);return ae(U,oe)?[ge,te[0]]:ae(U,ze)?[ge,te[1]]:[ge,te[oe!=null&&ze!=null?2:1]]}return[ge,$e]}function fe(K,U,te){te==null&&(te={});var ge="";switch(typeof K){case"string":K=="m/d/yy"&&te.dateNF?ge=te.dateNF:ge=K;break;case"number":K==14&&te.dateNF?ge=te.dateNF:ge=(te.table!=null?te.table:b)[K],ge==null&&(ge=te.table&&te.table[w[K]]||b[w[K]]),ge==null&&(ge=C[K]||"General");break}var ie=/^(w|W)((0?)|(0\.0+))$/;if(ge.match(ie)){if(isNaN(U))return U;var $e=ge.slice(1),oe=!1;!isNaN(U)&&Number(U)<0&&(oe=!0,U=Math.abs(U));var ze=parseInt(U),je=ze.toString().length;if(je>4){if(je>8){var Ce=parseInt(U/1e8),Ee=parseInt(parseFloat(U).subtract(Ce*1e8)/1e4),Ue=parseFloat(U).subtract(Ce*1e8+Ee*1e4);$e!=""&&(Ue=(0,Or.default)(Ue).format($e)),U=Ce+"\u4EBF"+Ee+"\u4E07"+Ue}else{var Ee=parseInt(U/1e4),Ue=parseFloat(U).subtract(Ee*1e4);$e!=""&&(Ue=(0,Or.default)(Ue).format($e)),U=Ee+"\u4E07"+Ue}if(U.indexOf("\u4EBF0\u4E070")!=-1?U=U.replace("0\u4E070",""):U.indexOf("\u4EBF0\u4E07")!=-1?U=U.replace("0\u4E07",""):U.indexOf("\u4E070")!=-1&&(U=U.replace("\u4E070","\u4E07")),U.indexOf("\u4EBF")!=-1&&U.indexOf("\u4E07")==-1){var Pe=U.substring(U.indexOf("\u4EBF")+1);if(Pe.substring(0,1)!=="."&&Pe!=""){switch((parseInt(Pe)+"").length){case 1:Pe="000"+Pe;break;case 2:Pe="00"+Pe;break;case 3:Pe="0"+Pe;break}U=U.substring(0,U.indexOf("\u4EBF")+1)+Pe}}else if(U.indexOf("\u4EBF")==-1&&U.indexOf("\u4E07")!=-1){var et=U.substring(U.indexOf("\u4E07")+1);if(et.substring(0,1)!=="."&&et!=""){switch((parseInt(et)+"").length){case 1:et="000"+et;break;case 2:et="00"+et;break;case 3:et="0"+et;break}U=U.substring(0,U.indexOf("\u4E07")+1)+et}}else if(U.indexOf("\u4EBF")!=-1&&U.indexOf("\u4E07")!=-1){var Pe=U.substring(U.indexOf("\u4EBF")+1,U.indexOf("\u4E07")),et=U.substring(U.indexOf("\u4E07")+1);switch((parseInt(Pe)+"").length){case 1:Pe="000"+Pe;break;case 2:Pe="00"+Pe;break;case 3:Pe="0"+Pe;break}if(U=U.substring(0,U.indexOf("\u4EBF")+1)+Pe+U.substring(U.indexOf("\u4E07")),et.substring(0,1)!=="."&&et!=""){switch((parseInt(et)+"").length){case 1:et="000"+et;break;case 2:et="00"+et;break;case 3:et="0"+et;break}U=U.substring(0,U.indexOf("\u4E07")+1)+et}}}else $e!=""&&(U=(0,Or.default)(U).format($e));return oe?"-"+U:U}if(p(ge,0))return M(U,te);U instanceof Date&&(U=I(U,te.date1904));var yt=ue(ge,U);if(p(yt[1]))return M(U,te);if(U===!0)U="TRUE";else if(U===!1)U="FALSE";else if(U===""||U==null)return"";return ee(yt[1],U,te,yt[0])}function ce(K,U){if(typeof U!="number"){U=+U||-1;for(var te=0;te<392;++te){if(b[te]==null){U<0&&(U=te);continue}if(b[te]==K){U=te;break}}U<0&&(U=391)}return b[U]=K,U}n.load=ce,n._table=b,n.get_table=function(){return b},n.load_table=function(U){for(var te=0;te!=392;++te)U[te]!==void 0&&ce(U[te],te)},n.init_table=k,n.format=fe};nv(kl);Bb={"General Number":"General","General Date":kl._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kl._table[15],"Short Date":kl._table[14],"Long Time":kl._table[19],"Medium Time":kl._table[18],"Short Time":kl._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kl._table[2],Standard:kl._table[4],Percent:kl._table[10],Scientific:kl._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},Hb=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,n=/_x([\da-fA-F]{4})_/g;return function t(l){var o=l+"",a=o.indexOf("<![CDATA[");if(a==-1)return o.replace(e,function(u,h){return encodings[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(n,function(u,h){return String.fromCharCode(parseInt(h,16))});var s=o.indexOf("]]>");return t(o.slice(0,a))+o.slice(a+9,s)+t(o.slice(s+3))}}(),iv=new Date(1899,11,31,0,0,0),Vb=iv.getTime(),ov=new Date(1900,2,1,0,0,0);da=new Date("2017-02-19T19:06:09.000Z");isNaN(da.getFullYear())&&(da=new Date("2/19/17"));av=da.getFullYear()==2017});function Ht(e,n,t,l){t==null&&(t=f.flowdata);let o=t[e][n],a;if(N(l)=="object"?(o==null?o=l:(l.f!=null?o.f=l.f:o.hasOwnProperty("f")&&delete o.f,l.spl!=null&&(o.spl=l.spl),l.ct!=null&&(o.ct=l.ct)),N(l.v)=="object"?a=l.v.v:a=l.v):a=l,me(a)){N(o)=="object"?(delete o.m,delete o.v):o=null,t[e][n]=o;return}(me(o)||(N(o)==="string"||N(o)==="number")&&o===l)&&(o={});let s=a.toString();if(s.substr(0,1)=="'")o.m=s.substr(1),o.ct={fa:"@",t:"s"},o.v=s.substr(1),o.qp=1;else if(o.qp==1)o.m=s,o.ct={fa:"@",t:"s"},o.v=s;else if(s.toUpperCase()==="TRUE")o.m="TRUE",o.ct={fa:"General",t:"b"},o.v=!0;else if(s.toUpperCase()==="FALSE")o.m="FALSE",o.ct={fa:"General",t:"b"},o.v=!1;else if(s.substr(-1)==="%"&&B(s.substring(0,s.length-1)))o.ct={fa:"0%",t:"n"},o.v=s.substring(0,s.length-1)/100,o.m=a;else if(H(a))o.m=s,o.ct!=null?o.ct.t="e":o.ct={fa:"General",t:"e"},o.v=a;else if(o.f!=null&&B(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a))if(o.v=parseFloat(a),o.ct==null&&(o.ct={fa:"General",t:"n"}),o.v==Infinity||o.v==-Infinity)o.m=o.v.toString();else if(o.v.toString().indexOf("e")>-1){let u;o.v.toString().split(".").length==1?u=0:u=o.v.toString().split(".")[1].split("e")[0].length,u>5&&(u=5),o.m=o.v.toExponential(u).toString()}else{let u=Math.round(o.v*1e9)/1e9;if(o.ct==null){let h=nt(u);o.m=h[0].toString()}else{let h=mt(o.ct.fa,u);o.m=h.toString()}}else if(o.ct!=null&&o.ct.fa=="@")o.m=s,o.v=a;else if(o.ct!=null&&o.ct.fa!=null&&o.ct.fa!="General"){B(a)&&(a=parseFloat(a));let u=mt(o.ct.fa,a);u===a?(u=nt(a),o.m=u[0].toString(),o.ct=u[1],o.v=u[2]):(o.m=u.toString(),o.v=a)}else if(B(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a))if(typeof a=="string"&&a.split("").every(h=>h=="0"||h==".")&&(a=parseFloat(a)),o.v=a,o.ct={fa:"General",t:"n"},o.v==Infinity||o.v==-Infinity)o.m=o.v.toString();else{let u=nt(o.v);o.m=u[0].toString()}else{let u=nt(a);o.m=u[0].toString(),o.ct=u[1],o.v=u[2]}if(!ne.allowUpdate&&!de.pointEdit&&o.ct!=null&&/^(w|W)((0?)|(0\.0+))$/.test(o.ct.fa)==!1&&o.ct.t=="n"&&o.v!=null&&parseInt(o.v).toString().length>4){let u=de.autoFormatw.toString().toUpperCase(),h=de.accuracy,d=uv(u,h);d!="General"&&(o.ct.fa=d,o.m=mt(d,o.v))}t[e][n]=o}function uv(e,n){let t="0.",l;if(e=="TRUE"){if(n==null)return"w";{let o=parseInt(n);if(o==0)return"w0";t="w0.";for(let a=0;a<o;a++)t+="0";l=t}}else{if(n==null)return"General";{let o=parseInt(n);if(o==0)return"0";for(let a=0;a<o;a++)t+="0";l=t}}return l.toString()}var $r=Me(()=>{ht();Nt();Fl();Qt();xl();Ke()});function bl(){if(f.luckysheet_select_save.length==0)return;let e=Infinity,n=-Infinity,t=0,l=0,o=0;for(let u=0;u<f.luckysheet_select_save.length;u++){let h=bh(f.luckysheet_select_save[u]);for(let d=0;d<h.length;d++)for(let m=0;m<h[0].length;m++){if(me(h[d][m])||(l++,h[d][m].ct!=null&&h[d][m].ct.t=="d"))continue;let p=h[d][m].v;!B(p)||(p=parseFloat(p),t+=p,p<e&&(e=p),p>n&&(n=p))}}let a=Q().formula,s="";s+="<span>"+a.count+":"+l+"</span>",(isFinite(n)||isFinite(e))&&(s+="<span>"+a.sum+":"+mt("w",t)+"</span>",s+="<span>"+a.average+":"+mt("w",Math.round(t/l*1e4)/1e4)+"</span>"),isFinite(n)&&(s+="<span>"+a.max+":"+mt("w",n)+"</span>"),isFinite(e)&&(s+="<span>"+a.min+":"+mt("w",e)+"</span>"),$("#luckysheet-sta-content").html(s)}var Ni=Me(()=>{Ke();Kt();Nt();Fl();kt()});function Ps(e,n,t,l,o){t==null&&(t=!0),e||(e="down"),n||(n="cell"),o==null&&(o=!1);let a=f.luckysheet_select_save[f.luckysheet_select_save.length-1],s=a.row==null?0:a.row[0],u=a.column==null?0:a.column[0],h=a.row==null?0:a.row[0],d=a.column==null?0:a.column[0],m=a.row==null?0:a.row[1],p=a.column==null?0:a.column[1];if(g.fucntionboxshow(s,u),n=="range"){var v=f.luckysheet_shiftpositon.row[0],y=f.luckysheet_shiftpositon.column[0];let S=f.luckysheet_shiftpositon.row[1],_=f.luckysheet_shiftpositon.column[1];e=="down"||e=="up"?S<m?s=a.row==null?0:a.row[1]:v>h?s=a.row==null?0:a.row[0]:S==m&&v==h&&(e=="down"?s=a.row==null?0:a.row[1]:s=a.row==null?0:a.row[0]):(e=="right"||e=="left")&&(_<p?u=a.column==null?0:a.column[1]:y>d?u=a.column==null?0:a.column[0]:_==p&&y==d&&(e=="right"?u=a.column==null?0:a.column[1]:u=a.column==null?0:a.column[0]))}let k=f.flowdata.length,b=f.flowdata[0].length,w=f.flowdata,x="",C=0;if(e=="up"){if(s==0)return;{let S=[],_=null,T=0,F=null;for(let R=d;R<=p;R++){S=[],T=0;for(let I=s-1;I>=0;I--){let P=w[I][R];if(N(P)=="object"&&me(P.v)||me(P)?S.push(!1):S.push(!0),S.length>1){if(S[T]==!0&&S[T-1]==!1){_=I;break}else if(S[T]==!1&&S[T-1]==!0){_=I+1;break}}T++}_==null&&(_=0),(F==null||_<F)&&(F=_)}x="down",C=F-s}}else if(e=="down"){if(s==k-1)return;{let S=[],_=null,T=0,F=null;for(let R=d;R<=p;R++){S=[],T=0;for(let I=s+1;I<w.length;I++){let P=w[I][R];if(N(P)=="object"&&me(P.v)||me(P)?S.push(!1):S.push(!0),S.length>1){if(S[T]==!0&&S[T-1]==!1){_=I;break}else if(S[T]==!1&&S[T-1]==!0){_=I-1;break}}T++}_==null&&(_=w.length-1),(F==null||_>F)&&(F=_)}x="down",C=F-s}}else if(e=="left"){if(u==0)return;{let S=[],_=null,T=0,F=null;for(let R=h;R<=m;R++){S=[],T=0;for(let I=u-1;I>=0;I--){let P=w[R][I];if(N(P)=="object"&&me(P.v)||me(P)?S.push(!1):S.push(!0),S.length>1){if(S[T]==!0&&S[T-1]==!1){_=I;break}else if(S[T]==!1&&S[T-1]==!0){_=I+1;break}}T++}_==null&&(_=0),(F==null||_<F)&&(F=_)}x="right",C=F-u}}else if(e=="right"){if(u==b-1)return;{let S=[],_=null,T=0,F=null;for(let R=h;R<=m;R++){S=[],T=0;for(let I=u+1;I<w[0].length;I++){let P=w[R][I];if(N(P)=="object"&&me(P.v)||me(P)?S.push(!1):S.push(!0),S.length>1){if(S[T]==!0&&S[T-1]==!1){_=I;break}else if(S[T]==!1&&S[T-1]==!0){_=I-1;break}}T++}_==null&&(_=w[0].length-1),(F==null||_>F)&&(F=_)}x="right",C=F-u}}if(n=="range"&&(e=="up"?p_endR<m&&C+s<p_endR&&(C=p_endR-s):e=="down"?v>h&&C+s>v&&(C=v-s):e=="left"?p_endC<p&&C+u<p_endC&&(C=p_endC-u):e=="right"&&y>d&&C+u>y&&(C=y-u),l!=null&&Math.abs(C)>Math.abs(l)&&(C=l)),!o)n=="cell"?jt(x,C,"rangeOfSelect",t):n=="range"&&En(x,C,"rangeOfSelect",t);else return C}function jt(e,n,t,l){l==null&&(l=!0),e||e=="down";let o=f.flowdata.length,a=f.flowdata[0].length,s,u,h,d,m,p,v,y;if(t=="rangeOfSelect"){let _=f.luckysheet_select_save[f.luckysheet_select_save.length-1],T;_.row_focus==null?T=_.row[0]:T=_.row_focus;let F;_.column_focus==null?F=_.column[0]:F=_.column_focus;let R=be.mergeborer(f.flowdata,T,F);if(R){let M=R.row[2],A=R.row[3],z=R.column[2],L=R.column[3];n>0?e=="down"?(T=A,F=z):e=="right"&&(T=M,F=L):(T=M,F=z)}let I=_.moveXY==null?T:_.moveXY.x,P=_.moveXY==null?F:_.moveXY.y;e=="down"?(T+=n,I=T):e=="right"&&(F+=n,P=F),T>=o&&(T=o-1,I=T),T<0&&(T=0,I=T),F>=a&&(F=a-1,P=F),F<0&&(F=0,P=F);let O=be.mergeborer(f.flowdata,T,F);O?(s=O.row[1],u=O.row[0],h=O.row[2],d=O.row[3],m=O.column[1],p=O.column[0],v=O.column[2],y=O.column[3]):(s=f.visibledatarow[I],u=I-1==-1?0:f.visibledatarow[I-1],m=f.visibledatacolumn[P],p=P-1==-1?0:f.visibledatacolumn[P-1],h=d=T,v=y=F),_.row=[h,d],_.column=[v,y],_.row_focus=h,_.column_focus=v,_.moveXY={x:I,y:P},lt(),Oe.pivotclick(h,v),g.fucntionboxshow(h,v)}else if(t=="rangeOfFormula"){let _=g.func_selectedrange,T;_.row_focus==null?T=_.row[0]:T=_.row_focus;let F;_.column_focus==null?F=_.column[0]:F=_.column_focus;let R=be.mergeborer(f.flowdata,T,F);if(R){let M=R.row[2],A=R.row[3],z=R.column[2],L=R.column[3];n>0?e=="down"?(T=A,F=z):e=="right"&&(T=M,F=L):(T=M,F=z)}let I=_.moveXY==null?T:_.moveXY.x,P=_.moveXY==null?F:_.moveXY.y;e=="down"?(T+=n,I=T):e=="right"&&(F+=n,P=F),T>=o&&(T=o-1,I=T),T<0&&(T=0,I=T),F>=a&&(F=a-1,P=F),F<0&&(F=0,P=F);let O=be.mergeborer(f.flowdata,T,F);O?(s=O.row[1],u=O.row[0],h=O.row[2],d=O.row[3],m=O.column[1],p=O.column[0],v=O.column[2],y=O.column[3]):(s=f.visibledatarow[I],u=I-1==-1?0:f.visibledatarow[I-1],h=I,d=I,m=f.visibledatacolumn[P],p=P-1==-1?0:f.visibledatacolumn[P-1],v=P,y=P),g.func_selectedrange={left:p,width:m-p-1,top:u,height:s-u-1,left_move:p,width_move:m-p-1,top_move:u,height_move:s-u-1,row:[h,d],column:[v,y],row_focus:h,column_focus:v,moveXY:{x:I,y:P}},$("#luckysheet-formula-functionrange-select").css({left:p,width:m-p-1,top:u,height:s-u-1}).show(),g.rangeSetValue({row:[h,d],column:[v,y]})}let k=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),w=$("#luckysheet-cell-main").height(),x=$("#luckysheet-cell-main").width(),C=0,S=0;m-k-x+20>0?(C=m-x+20,l&&$("#luckysheet-scrollbar-x").scrollLeft(C)):p-k-20<0&&(C=p-20,l&&$("#luckysheet-scrollbar-x").scrollLeft(C)),s-b-w+20>0?(S=s-w+20,l&&$("#luckysheet-scrollbar-y").scrollTop(S)):u-b-20<0&&(S=u-20,l&&$("#luckysheet-scrollbar-y").scrollTop(S)),clearTimeout(f.countfuncTimeout),bl(),ne.saveParam("mv",f.currentSheetIndex,f.luckysheet_select_save)}function si(e,n,t){t||(t=!0);let l,o,a,s;if(n=="rangeOfSelect"){let y=f.luckysheet_select_save[f.luckysheet_select_save.length-1],k=y.row_focus,b=y.column_focus,w=!1,x={};if(f.config.merge!=null&&k+"_"+b in f.config.merge&&(w=!0,x=f.config.merge[k+"_"+b]),e=="down"){if(k==f.flowdata.length-1)return;w?k=gt("down",b,x.r+x.rs-1,f.flowdata.length-1):k=gt("down",b,k,f.flowdata.length-1)}else if(e=="up"){if(k==0)return;w?k=gt("up",b,0,x.r):k=gt("up",b,0,k)}else if(e=="right"){if(b==f.flowdata[0].length-1)return;w?b=gt("right",k,x.c+x.cs-1,f.flowdata[0].length-1):b=gt("right",k,b,f.flowdata[0].length-1)}else if(e=="left"){if(b==0)return;w?b=gt("left",k,0,x.c):b=gt("left",k,0,b)}let C=[k,k],S=[b,b];l=f.visibledatarow[k],o=k-1==-1?0:f.visibledatarow[k-1],a=f.visibledatacolumn[b],s=b-1==-1?0:f.visibledatacolumn[b-1];let _=be.mergeMoveMain(S,C,y,o,l-o-1,s,a-s-1);_!=null&&(S=_[0],C=_[1]),f.luckysheet_select_save=[{row:C,column:S}],lt(),Oe.pivotclick(k,b),g.fucntionboxshow(k,b)}else if(n=="rangeOfFormula"){let y=g.func_selectedrange,k=y.row_focus,b=y.column_focus,w=!1,x={};if(f.config.merge!=null&&k+"_"+b in f.config.merge&&(w=!0,x=f.config.merge[k+"_"+b]),e=="down"){if(k==f.flowdata.length-1)return;w?k=gt("down",b,x.r+x.rs-1,f.flowdata.length-1):k=gt("down",b,k,f.flowdata.length-1)}else if(e=="up"){if(k==0)return;w?k=gt("up",b,0,x.r):k=gt("up",b,0,k)}else if(e=="right"){if(b==f.flowdata[0].length-1)return;w?b=gt("right",k,x.c+x.cs-1,f.flowdata[0].length-1):b=gt("right",k,b,f.flowdata[0].length-1)}else if(e=="left"){if(b==0)return;w?b=gt("left",k,0,x.c):b=gt("left",k,0,b)}let C=[k,k],S=[b,b];l=f.visibledatarow[k],o=k-1==-1?0:f.visibledatarow[k-1],a=f.visibledatacolumn[b],s=b-1==-1?0:f.visibledatacolumn[b-1];let _=o,T=l-o-1,F=s,R=a-s-1,I=be.mergeMoveMain(S,C,y,_,T,F,R);I!=null&&(S=I[0],C=I[1],_=I[2],T=I[3],F=I[4],R=I[5]),g.func_selectedrange={left:F,width:R,top:_,height:T,left_move:F,width_move:R,top_move:_,height_move:T,row:C,column:S,row_focus:k,column_focus:b},$("#luckysheet-formula-functionrange-select").css({left:F,width:R,top:_,height:T}).show(),g.rangeSetValue({row:C,column:S})}let u=$("#luckysheet-cell-main").scrollLeft(),h=$("#luckysheet-cell-main").scrollTop(),d=$("#luckysheet-cell-main").height(),m=$("#luckysheet-cell-main").width(),p=0,v=0;a-u-m+20>0?(p=a-m+20,t&&$("#luckysheet-scrollbar-x").scrollLeft(p)):s-u-20<0&&(p=s-20,t&&$("#luckysheet-scrollbar-x").scrollLeft(p)),l-h-d+20>0?(v=l-d+20,t&&$("#luckysheet-scrollbar-y").scrollTop(v)):o-h-20<0&&(v=o-20,t&&$("#luckysheet-scrollbar-y").scrollTop(v)),clearTimeout(f.countfuncTimeout),bl()}function En(e,n,t,l){l==null&&(l=!0),e||e=="down";let o,a,s,u;if(t=="rangeOfSelect"){let k=f.luckysheet_select_save[f.luckysheet_select_save.length-1],b=k.row[0],w=k.row[1],x=k.column[0],C=k.column[1],S=k.row_focus,_=k.column_focus,T=f.flowdata.length,F=f.flowdata[0].length;if(e=="down"){if(Ol(S,x,C)){let O=lr(S,x,C),M=O[0],A=O[1];M>b&&A==w?(n>0&&Ol(b,x,C)&&(b=lr(b,x,C)[1]),b+=n):A<w&&M==b?(n<0&&Ol(w,x,C)&&(w=lr(w,x,C)[0]),w+=n):n>0?w+=n:b+=n}else S>b&&S==w?(n>0&&Ol(b,x,C)&&(b=lr(b,x,C)[1]),b+=n):S<w&&S==b?(n<0&&Ol(w,x,C)&&(w=lr(w,x,C)[0]),w+=n):S==b&&S==w&&(n>0?w+=n:b+=n);w>=T&&(w=T-1),w<0&&(w=0),b>=T&&(b=T-1),b<0&&(b=0)}else{if(Bl(_,b,w)){let O=rr(_,b,w),M=O[0],A=O[1];M>x&&A==C?(n>0&&Bl(x,b,w)&&(x=rr(x,b,w)[1]),x+=n):A<C&&M==x?(n<0&&Bl(C,b,w)&&(C=rr(C,b,w)[0]),C+=n):n>0?C+=n:x+=n}else _>x&&_==C?(n>0&&Bl(x,b,w)&&(x=rr(x,b,w)[1]),x+=n):_<C&&_==x?(n<0&&Bl(C,b,w)&&(C=rr(C,b,w)[0]),C+=n):_==x&&_==C&&(n>0?C+=n:x+=n);C>=F&&(C=F-1),C<0&&(C=0),x>=F&&(x=F-1),x<0&&(x=0)}let R=[b,w],I=[x,C];o=f.visibledatarow[w],a=b-1==-1?0:f.visibledatarow[b-1],s=f.visibledatacolumn[C],u=x-1==-1?0:f.visibledatacolumn[x-1];let P=be.mergeMoveMain(I,R,k,a,o-a-1,u,s-u-1);P!=null&&(I=P[0],R=P[1]),k.row=R,k.column=I,lt()}else if(t=="rangeOfFormula"){let k=g.func_selectedrange,b=k.row[0],w=k.row[1],x=k.column[0],C=k.column[1],S=k.row_focus,_=k.column_focus,T=f.flowdata.length,F=f.flowdata[0].length;if(e=="down"){if(Ol(S,x,C)){let L=lr(S,x,C),E=L[0],V=L[1];E>b&&V==w?(n>0&&Ol(b,x,C)&&(b=lr(b,x,C)[1]),b+=n):V<w&&E==b?(n<0&&Ol(w,x,C)&&(w=lr(w,x,C)[0]),w+=n):n>0?w+=n:b+=n}else S>b&&S==w?(n>0&&Ol(b,x,C)&&(b=lr(b,x,C)[1]),b+=n):S<w&&S==b?(n<0&&Ol(w,x,C)&&(w=lr(w,x,C)[0]),w+=n):S==b&&S==w&&(n>0?w+=n:b+=n);w>=T&&(w=T-1),w<0&&(w=0),b>=T&&(b=T-1),b<0&&(b=0)}else{if(Bl(_,b,w)){let L=rr(_,b,w),E=L[0],V=L[1];E>x&&V==C?(n>0&&Bl(x,b,w)&&(x=rr(x,b,w)[1]),x+=n):V<C&&E==x?(n<0&&Bl(C,b,w)&&(C=rr(C,b,w)[0]),C+=n):n>0?C+=n:x+=n}else _>x&&_==C?(n>0&&Bl(x,b,w)&&(x=rr(x,b,w)[1]),x+=n):_<C&&_==x?(n<0&&Bl(C,b,w)&&(C=rr(C,b,w)[0]),C+=n):_==x&&_==C&&(n>0?C+=n:x+=n);C>=F&&(C=F-1),C<0&&(C=0),x>=F&&(x=F-1),x<0&&(x=0)}let R=[b,w],I=[x,C];o=f.visibledatarow[w],a=b-1==-1?0:f.visibledatarow[b-1],s=f.visibledatacolumn[C],u=x-1==-1?0:f.visibledatacolumn[x-1];let P=a,O=o-a-1,M=u,A=s-u-1,z=be.mergeMoveMain(I,R,k,P,O,M,A);z!=null&&(I=z[0],R=z[1],P=z[2],O=z[3],M=z[4],A=z[5]),g.func_selectedrange={left:M,width:A,top:P,height:O,left_move:M,width_move:A,top_move:P,height_move:O,row:R,column:I,row_focus:S,column_focus:_},$("#luckysheet-formula-functionrange-select").css({left:M,width:A,top:P,height:O}).show(),g.rangeSetValue({row:R,column:I})}let h=$("#luckysheet-cell-main").scrollLeft(),d=$("#luckysheet-cell-main").scrollTop(),m=$("#luckysheet-cell-main").height(),p=$("#luckysheet-cell-main").width(),v=0,y=0;s-h-p+20>0?(v=s-p+20,l&&$("#luckysheet-scrollbar-x").scrollLeft(v)):u-h-20<0&&(v=u-20,l&&$("#luckysheet-scrollbar-x").scrollLeft(v)),o-d-m+20>0?(y=o-m+20,l&&$("#luckysheet-scrollbar-y").scrollTop(y)):a-d-20<0&&(y=a-20,l&&$("#luckysheet-scrollbar-y").scrollTop(y)),clearTimeout(f.countfuncTimeout),bl()}function ci(e,n,t){t||(t=!0);let l,o,a,s;if(n=="rangeOfSelect"){let y=f.luckysheet_select_save[f.luckysheet_select_save.length-1],k=y.row_focus,b=y.column_focus,w=y.row[0],x=y.row[1],C=y.column[0],S=y.column[1];if(e=="down"){if(x==f.flowdata.length-1)return;if(Ol(k,C,S)){let R=lr(k,C,S),I=R[0],P=R[1];I>w&&P==x?w=gt("down",b,w,x):x=gt("down",b,x,f.flowdata.length-1)}else k>w&&k==x?w=gt("down",b,w,x):x=gt("down",b,x,f.flowdata.length-1)}else if(e=="up"){if(w==0)return;if(Ol(k,C,S)){let R=lr(k,C,S),I=R[0];R[1]<x&&I==w?x=gt("up",b,w,x):w=gt("up",b,0,w)}else k<x&&k==w?x=gt("up",b,w,x):w=gt("up",b,0,w)}else if(e=="right"){if(S==f.flowdata[0].length-1)return;if(Bl(b,w,x)){let R=rr(b,w,x),I=R[0],P=R[1];I>C&&P==S?C=gt("right",k,C,S):S=gt("right",k,S,f.flowdata[0].length-1)}else b>C&&b==S?C=gt("right",k,C,S):S=gt("right",k,S,f.flowdata[0].length-1)}else if(e=="left"){if(C==0)return;if(Bl(b,w,x)){let R=rr(b,w,x),I=R[0];R[1]<S&&I==C?S=gt("left",k,C,S):C=gt("left",k,0,C)}else b<S&&b==C?S=gt("left",k,C,S):C=gt("left",k,0,C)}let _=[w,x],T=[C,S];l=f.visibledatarow[x],o=w-1==-1?0:f.visibledatarow[w-1],a=f.visibledatacolumn[S],s=C-1==-1?0:f.visibledatacolumn[C-1];let F=be.mergeMoveMain(T,_,y,o,l-o-1,s,a-s-1);F!=null&&(T=F[0],_=F[1]),y.row=_,y.column=T,lt()}else if(n=="rangeOfFormula"){let y=g.func_selectedrange,k=y.row_focus,b=y.column_focus,w=y.row[0],x=y.row[1],C=y.column[0],S=y.column[1];if(e=="down"){if(x==f.flowdata.length-1)return;if(Ol(k,C,S)){let M=lr(k,C,S),A=M[0],z=M[1];A>w&&z==x?w=gt("down",b,w,x):x=gt("down",b,x,f.flowdata.length-1)}else k>w&&k==x?w=gt("down",b,w,x):x=gt("down",b,x,f.flowdata.length-1)}else if(e=="up"){if(w==0)return;if(Ol(k,C,S)){let M=lr(k,C,S),A=M[0];M[1]<x&&A==w?x=gt("up",b,w,x):w=gt("up",b,0,w)}else k<x&&k==w?x=gt("up",b,w,x):w=gt("up",b,0,w)}else if(e=="right"){if(S==f.flowdata[0].length-1)return;if(Bl(b,w,x)){let M=rr(b,w,x),A=M[0],z=M[1];A>C&&z==S?C=gt("right",k,C,S):S=gt("right",k,S,f.flowdata[0].length-1)}else b>C&&b==S?C=gt("right",k,C,S):S=gt("right",k,S,f.flowdata[0].length-1)}else if(e=="left"){if(C==0)return;if(Bl(b,w,x)){let M=rr(b,w,x),A=M[0];M[1]<S&&A==C?S=gt("left",k,C,S):C=gt("left",k,0,C)}else b<S&&b==C?S=gt("left",k,C,S):C=gt("left",k,0,C)}let _=[w,x],T=[C,S];l=f.visibledatarow[x],o=w-1==-1?0:f.visibledatarow[w-1],a=f.visibledatacolumn[S],s=C-1==-1?0:f.visibledatacolumn[C-1];let F=o,R=l-o-1,I=s,P=a-s-1,O=be.mergeMoveMain(T,_,y,F,R,I,P);O!=null&&(T=O[0],_=O[1],F=O[2],R=O[3],I=O[4],P=O[5]),g.func_selectedrange={left:I,width:P,top:F,height:R,left_move:I,width_move:P,top_move:F,height_move:R,row:_,column:T,row_focus:k,column_focus:b},$("#luckysheet-formula-functionrange-select").css({left:I,width:P,top:F,height:R}).show(),g.rangeSetValue({row:_,column:T})}let u=$("#luckysheet-cell-main").scrollLeft(),h=$("#luckysheet-cell-main").scrollTop(),d=$("#luckysheet-cell-main").height(),m=$("#luckysheet-cell-main").width(),p=0,v=0;a-u-m+20>0?(p=a-m+20,t&&$("#luckysheet-scrollbar-x").scrollLeft(p)):s-u-20<0&&(p=s-20,t&&$("#luckysheet-scrollbar-x").scrollLeft(p)),l-h-d+20>0?(v=l-d+20,t&&$("#luckysheet-scrollbar-y").scrollTop(v)):o-h-20<0&&(v=o-20,t&&$("#luckysheet-scrollbar-y").scrollTop(v)),clearTimeout(f.countfuncTimeout),bl()}function Ol(e,n,t){let l=!1;for(let o=n;o<=t;o++){let a=f.flowdata[e][o];if(N(a)=="object"&&"mc"in a){l=!0;break}}return l}function Bl(e,n,t){let l=!1;for(let o=n;o<=t;o++){let a=f.flowdata[o][e];if(N(a)=="object"&&"mc"in a){l=!0;break}}return l}function lr(e,n,t){let l=0,o=f.flowdata.length-1,a=null;if(e>l)for(let u=e;u>=l;u--){for(let h=n;h<=t;h++){let d=f.flowdata[u][h];if(N(d)=="object"&&"mc"in d){let m=f.config.merge[d.mc.r+"_"+d.mc.c];(a==null||m.r<a)&&(a=m.r)}}if(Ol(a-1,n,t)&&a>l)u=a;else break}else a=l;let s=null;if(e<o)for(let u=e;u<=o;u++){for(let h=n;h<=t;h++){let d=f.flowdata[u][h];if(N(d)=="object"&&"mc"in d){let m=f.config.merge[d.mc.r+"_"+d.mc.c];(s==null||m.r+m.rs-1>s)&&(s=m.r+m.rs-1)}}if(Ol(s+1,n,t)&&s<o)u=s;else break}else s=o;return[a,s]}function rr(e,n,t){let l=0,o=f.flowdata[0].length-1,a=null;if(e>l)for(let u=e;u>=l;u--){for(let h=n;h<=t;h++){let d=f.flowdata[h][u];if(N(d)=="object"&&"mc"in d){let m=f.config.merge[d.mc.r+"_"+d.mc.c];(a==null||m.c<a)&&(a=m.c)}}if(Bl(a-1,n,t)&&a>l)u=a;else break}else a=l;let s=null;if(e<o)for(let u=e;u<=o;u++){for(let h=n;h<=t;h++){let d=f.flowdata[h][u];if(N(d)=="object"&&"mc"in d){let m=f.config.merge[d.mc.r+"_"+d.mc.c];(s==null||m.c+m.cs-1>s)&&(s=m.c+m.cs-1)}}if(Bl(s+1,n,t)&&s<o)u=s;else break}else s=o;return[a,s]}function gt(e,n,t,l){let o=null,a;if(e=="down"){let s=f.flowdata[t][n];N(s)=="object"&&me(s.v)||me(s)?a=!0:a=!1,console.log(a,"stNull");let u=[],h=0;for(let d=t+1;d<=l;d++){let m=f.flowdata[d][n];if(N(m)=="object"&&me(m.v)||me(m)?u.push(!0):u.push(!1),u.length==1&&a==!0&&u[h]==!1){o=t+h+1;break}else if(u.length>1){if(a&&u[h]==!1){o=t+h+1;break}else if(!a){if(u[h]==!1&&u[h-1]==!0){o=t+h+1;break}else if(u[h]==!0&&u[h-1]==!1){o=t+h;break}}}d==l&&(o=l),h++}}else if(e=="up"){let s=f.flowdata[l][n];N(s)=="object"&&me(s.v)||me(s)?a=!0:a=!1;let u=[],h=0;for(let d=l-1;d>=t;d--){let m=f.flowdata[d][n];if(N(m)=="object"&&me(m.v)||me(m)?u.push(!0):u.push(!1),u.length==1&&a&&u[h]==!1){o=l-(h+1);break}else if(u.length>1){if(a&&u[h]==!1){o=l-(h+1);break}else if(!a){if(u[h]==!1&&u[h-1]==!0){o=l-(h+1);break}else if(u[h]==!0&&u[h-1]==!1){o=l-h;break}}}d==t&&(o=t),h++}}else if(e=="right"){let s=f.flowdata[n][t];N(s)=="object"&&me(s.v)||me(s)?a=!0:a=!1;let u=[],h=0;for(let d=t+1;d<=l;d++){let m=f.flowdata[n][d];if(N(m)=="object"&&me(m.v)||me(m)?u.push(!0):u.push(!1),u.length==1&&a&&u[h]==!1){o=t+h+1;break}else if(u.length>1){if(a&&u[h]==!1){o=t+h+1;break}else if(!a){if(u[h]==!1&&u[h-1]==!0){o=t+h+1;break}else if(u[h]==!0&&u[h-1]==!1){o=t+h;break}}}d==l&&(o=l),h++}}else if(e=="left"){let s=f.flowdata[n][l];N(s)=="object"&&me(s.v)||me(s)?a=!0:a=!1;let u=[],h=0;for(let d=l-1;d>=t;d--){let m=f.flowdata[n][d];if(N(m)=="object"&&me(m.v)||me(m)?u.push(!0):u.push(!1),u.length==1&&a&&u[h]==!1){o=l-(h+1);break}else if(u.length>1){if(a&&u[h]==!1){o=l-(h+1);break}else if(!a){if(u[h]==!1&&u[h-1]==!0){o=l-(h+1);break}else if(u[h]==!0&&u[h-1]==!1){o=l-h;break}}}d==t&&(o=t),h++}}return o}var So=Me(()=>{ht();Ut();Nt();Ni();ol();Zt();nn();Ke();Qt()});var fv,el,Ei=Me(()=>{Et();ht();Ut();Nt();ll();Yt();Wt();Br();Qt();Zt();Ke();kt();fv={rangefocus:!1,modelfocusIndex:null,FixedModelColor:[{head:{fc:"#000",bc:"#bfbdbe"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f3f7"},foot:{fc:"#000",bc:"#dde2de"}},{head:{fc:"#000",bc:"#4bd4e7"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eaf7ff"},foot:{fc:"#000",bc:"#aae9f8"}},{head:{fc:"#000",bc:"#5ed593"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#e5fbee"},foot:{fc:"#000",bc:"#a5efcc"}},{head:{fc:"#000",bc:"#f6cb4b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fff9e7"},foot:{fc:"#000",bc:"#ffebac"}},{head:{fc:"#000",bc:"#f96420"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ffe5d9"},foot:{fc:"#000",bc:"#ffcfba"}},{head:{fc:"#000",bc:"#5599fc"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ecf2fe"},foot:{fc:"#000",bc:"#afcbfa"}},{head:{fc:"#000",bc:"#22a69b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#dff2f8"},foot:{fc:"#000",bc:"#8dd4d0"}},{head:{fc:"#000",bc:"#7a939a"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0eff7"},foot:{fc:"#000",bc:"#bdcad0"}},{head:{fc:"#000",bc:"#d7a270"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fdf3f1"},foot:{fc:"#000",bc:"#ead2b6"}},{head:{fc:"#000",bc:"#89c54b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f1f7e9"},foot:{fc:"#000",bc:"#c5e3a7"}},{head:{fc:"#000",bc:"#8f88f0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0e5ff"},foot:{fc:"#000",bc:"#c6c4f6"}},{head:{fc:"#000",bc:"#fd1664"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#feddee"},foot:{fc:"#000",bc:"#f98ab5"}},{head:{fc:"#000",bc:"#da96d3"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fce8fb"},foot:{fc:"#000",bc:"#f2caee"}},{head:{fc:"#000",bc:"#b49191"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f5ebe8"},foot:{fc:"#000",bc:"#d8c3c3"}},{head:{fc:"#000",bc:"#91b493"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0fbf0"},foot:{fc:"#000",bc:"#b4cfb6"}},{head:{fc:"#000",bc:"#b4a891"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f6f1"},foot:{fc:"#000",bc:"#d3cab8"}},{head:{fc:"#000",bc:"#91abb4"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eff7fa"},foot:{fc:"#000",bc:"#b7cbd3"}},{head:{fc:"#000",bc:"#b7ba82"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fafbeb"},foot:{fc:"#000",bc:"#dadcb4"}},{head:{fc:"#000",bc:"#df3e3e"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fde9e9"},foot:{fc:"#000",bc:"#f89292"}},{head:{fc:"#000",bc:"#f2711c"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fef0d7"},foot:{fc:"#000",bc:"#fbb335"}},{head:{fc:"#000",bc:"#b5cc18"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f9fbd4"},foot:{fc:"#000",bc:"#e2ed2a"}},{head:{fc:"#000",bc:"#00b5ad"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ccfaf9"},foot:{fc:"#000",bc:"#00e4df"}},{head:{fc:"#000",bc:"#2185d0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#d8f3fc"},foot:{fc:"#000",bc:"#3cc4f0"}},{head:{fc:"#000",bc:"#a5673f"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f6ede5"},foot:{fc:"#000",bc:"#d3a47c"}}],getModelBox:function(e,n){let t=this;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").empty(),$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").empty();let l="";for(let a=0;a<t.FixedModelColor.length;a++){let s=t.FixedModelColor[a],u,h,d,m;e&&n?(u=s.head,h=s.one,d=s.two,m=s.foot):e?(u=s.head,h=s.one,d=s.two,m=s.one):n?(u=s.one,h=s.two,d=s.one,m=s.foot):(u=s.one,h=s.two,d=s.one,m=s.two),l+='<div class="modelbox"><div class="box"><span style="color:'+u.fc+";background-color:"+u.bc+'"> \u2014 </span><span style="color:'+h.fc+";background-color:"+h.bc+'"> \u2014 </span><span style="color:'+d.fc+";background-color:"+d.bc+'"> \u2014 </span><span style="color:'+m.fc+";background-color:"+m.bc+'"> \u2014 </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").append(l);let o=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(o!=null&&o.length>0){let a="";for(let s=0;s<o.length;s++){let u=o[s],h,d,m,p;e&&n?(h=u.head,d=u.one,m=u.two,p=u.foot):e?(h=u.head,d=u.one,m=u.two,p=u.one):n?(h=u.one,d=u.two,m=u.one,p=u.foot):(h=u.one,d=u.two,m=u.one,p=u.two),a+='<div class="modelbox"><div class="box"><span style="color:'+h.fc+";background-color:"+h.bc+'"> \u2014 </span><span style="color:'+d.fc+";background-color:"+d.bc+'"> \u2014 </span><span style="color:'+m.fc+";background-color:"+m.bc+'"> \u2014 </span><span style="color:'+p.fc+";background-color:"+p.bc+'"> \u2014 </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").append(a)}},init:function(){let e=this;$("#luckysheet-modal-dialog-slider-alternateformat").remove(),$("body").append(hu()),Ot(),$("#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Ot()}),$(document).off("focus.AFrangeInput").on("focus.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!0}),$(document).off("blur.AFrangeInput").on("blur.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!1}),$(document).off("keydown.AFrangeInput").on("keydown.AFrangeInput","#luckysheet-alternateformat-range input",function(n){let t=$(this).val().trim();n.keyCode==13&&e.update()}),$(document).off("click.AFrangeIcon").on("click.AFrangeIcon","#luckysheet-alternateformat-range .fa-table",function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Ot();let n=$(this).parents("#luckysheet-alternateformat-range").find("input").val().trim();e.rangeDialog(n)}),$(document).off("click.AFrDCf").on("click.AFrDCf","#luckysheet-alternateformat-rangeDialog-confirm",function(){let n=$(this).parents("#luckysheet-alternateformat-rangeDialog").find("input").val().trim();$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val(n),$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Ot(),e.update()}),$(document).off("click.AFrDCl").on("click.AFrDCl","#luckysheet-alternateformat-rangeDialog-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Ot()}),$(document).off("click.AFrDTitle").on("click.AFrDTitle","#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Ot()}),$(document).off("change.AFrowHeader").on("change.AFrowHeader","#luckysheet-alternateformat-rowHeader",function(){let n;$(this).is(":checked")?n=!0:n=!1;let t;$("#luckysheet-alternateformat-rowFooter").is(":checked")?t=!0:t=!1,e.checkboxChange(n,t),e.modelboxOn(),e.update()}),$(document).off("change.AFrowFooter").on("change.AFrowFooter","#luckysheet-alternateformat-rowFooter",function(){let n;$("#luckysheet-alternateformat-rowHeader").is(":checked")?n=!0:n=!1;let t;$(this).is(":checked")?t=!0:t=!1,e.checkboxChange(n,t),e.modelboxOn(),e.update()}),$(document).off("click.AFmodelbox").on("click.AFmodelbox","#luckysheet-modal-dialog-slider-alternateformat .modelbox",function(){let n=$(this).index(),t=$(this).parents(".cf").attr("id");if(t=="luckysheet-alternateformat-modelList")e.modelfocusIndex=n;else if(t=="luckysheet-alternateformat-modelCustom"){let l=e.FixedModelColor.length;e.modelfocusIndex=n+l}e.modelboxOn(),e.update()}),$(document).off("click.AFselectColor").on("click.AFselectColor","#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator",function(){let n=$(this).closest(".toningbox"),t,l;$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-text-color")?(t="fc",l=n.find(".toningShow").data("fc")):$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-cell-color")&&(t="bc",l=n.find(".toningShow").data("bc"));let o;n.hasClass("header")?o="0":n.hasClass("ctOne")?o="1":n.hasClass("ctTwo")?o="2":n.hasClass("footer")&&(o="3"),e.colorSelectDialog(l,t,o)}),$(document).off("click.AFselectColorConfirm").on("click.AFselectColorConfirm","#luckysheet-alternateformat-colorSelect-dialog-confirm",function(){let n=$(this).parents("#luckysheet-alternateformat-colorSelect-dialog"),l=Q().alternatingColors;$("#luckysheet-modal-dialog-mask").hide(),n.hide();let o=n.find(".currenColor span").attr("title"),a;n.find(".luckysheet-modal-dialog-title-text").text()==l.selectionTextColor?a="fc":n.find(".luckysheet-modal-dialog-title-text").text()==l.selectionCellColor&&(a="bc");let s=n.find(".currenColor").attr("data-source");s=="0"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="1"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="2"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="3"&&(a=="fc"&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)));let u;$("#luckysheet-alternateformat-rowHeader").is(":checked")?u=!0:u=!1;let h;$("#luckysheet-alternateformat-rowFooter").is(":checked")?h=!0:h=!1;let d=e.modelfocusIndex,m=e.FixedModelColor.length,p,v;if(d<m)p=$.extend(!0,{},e.getFormatByIndex());else{v=f.luckysheetfile[Z(f.currentSheetIndex)];let y=v.luckysheet_alternateformat_save_modelCustom;p=$.extend(!0,{},y[d-m])}s=="0"?a=="fc"?p.head.fc=o:a=="bc"&&(p.head.bc=o):s=="1"?a=="fc"?p.one.fc=o:a=="bc"&&(p.one.bc=o):s=="2"?a=="fc"?p.two.fc=o:a=="bc"&&(p.two.bc=o):s=="3"&&(a=="fc"&&(p.foot.fc=o),a=="bc"&&(p.foot.bc=o)),e.modelfocusIndex<m?(e.addCustomModel(p),e.modelfocusIndex=e.getIndexByFormat(p)):(v.luckysheet_alternateformat_save_modelCustom[d-m]=p,ne.allowUpdate&&ne.saveParam("all",f.currentSheetIndex,v.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})),e.getModelBox(u,h),e.modelboxOn(),e.update()}),$(document).off("click.AFremove").on("click.AFremove","#luckysheet-alternateformat-remove",function(){let n=$(this).data("index"),l=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save,o=$.extend(!0,[],l);l.length>1?l.splice(n,1):l=[];let a=$.extend(!0,[],l);e.ref(o,a),ne.allowUpdate&&ne.saveParam("all",f.currentSheetIndex,l,{k:"luckysheet_alternateformat_save"}),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Ot()})},perfect:function(){let e=this,n=$.extend(!0,{},f.luckysheet_select_save[0]),t=e.rangeIsExists(n)[1],l=$.extend(!0,{},f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save[t]),o=l.cellrange;$("#luckysheet-alternateformat-range input").val(Mt(f.currentSheetIndex,{row:o.row,column:o.column},f.currentSheetIndex)),f.luckysheet_select_save=[{row:o.row,column:o.column}],lt();let a=l.hasRowHeader,s=l.hasRowFooter,u=l.format;e.modelfocusIndex=e.getIndexByFormat(u),e.modelfocusIndex==null&&(e.addCustomModel(u),e.modelfocusIndex=e.getIndexByFormat(u)),e.checkboxChange(a,s),e.modelboxOn(),$("#luckysheet-alternateformat-remove").data("index",t)},checkboxChange:function(e,n){e?($("#luckysheet-alternateformat-rowHeader").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .header").show()):($("#luckysheet-alternateformat-rowHeader").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .header").hide()),n?($("#luckysheet-alternateformat-rowFooter").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .footer").show()):($("#luckysheet-alternateformat-rowFooter").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .footer").hide()),this.getModelBox(e,n)},modelboxOn:function(){let e=this;$("#luckysheet-modal-dialog-slider-alternateformat .modelbox").removeClass("on");let n=e.modelfocusIndex,t=e.FixedModelColor.length;n<t?$("#luckysheet-alternateformat-modelList .modelbox").eq(n).addClass("on"):$("#luckysheet-alternateformat-modelCustom .modelbox").eq(n-t).addClass("on"),e.modelToningColor()},modelToningColor:function(){let e=this.getFormatByIndex();$("#luckysheet-alternateformat-modelToning .header .toningShow").css({color:e.head.fc,"background-color":e.head.bc}),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",e.head.fc).data("bc",e.head.bc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.fc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.bc),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css({color:e.one.fc,"background-color":e.one.bc}),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",e.one.fc).data("bc",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.fc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css({color:e.two.fc,"background-color":e.two.bc}),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",e.two.fc).data("bc",e.two.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.fc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.bc),$("#luckysheet-alternateformat-modelToning .footer .toningShow").css({color:e.foot.fc,"background-color":e.foot.bc}),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",e.foot.fc).data("bc",e.foot.bc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.fc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.bc)},addCustomModel:function(e){let n=f.luckysheetfile[Z(f.currentSheetIndex)];n.luckysheet_alternateformat_save_modelCustom==null&&(n.luckysheet_alternateformat_save_modelCustom=[]),n.luckysheet_alternateformat_save_modelCustom.push(e),ne.allowUpdate&&ne.saveParam("all",f.currentSheetIndex,n.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})},colorSelectDialog:function(e,n,t){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-alternateformat-colorSelect-dialog").remove();let l=Q(),o=l.alternatingColors,a=l.button,s=l.toolbar,u;n=="fc"?u=o.selectionTextColor:n=="bc"&&(u=o.selectionCellColor),$("body").append(_e(dt,{id:"luckysheet-alternateformat-colorSelect-dialog",addclass:"luckysheet-alternateformat-colorSelect-dialog",title:u,content:"<div class='currenColor' data-source='"+t+"'>"+o.currentColor+"\uFF1A<span title='"+e+"' style='background-color:"+e+"'></span></div><div class='colorshowbox'></div>",botton:'<button id="luckysheet-alternateformat-colorSelect-dialog-confirm" class="btn btn-primary">'+a.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+a.cancel+"</button>",style:"z-index:100003"}));let h=$("#luckysheet-alternateformat-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),d=h.outerHeight(),m=h.outerWidth(),p=$(window).width(),v=$(window).height(),y=$(document).scrollLeft(),k=$(document).scrollTop();$("#luckysheet-alternateformat-colorSelect-dialog").css({left:(p+y-m)/2,top:(v+k-d)/3}).show(),$("#luckysheet-alternateformat-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:a.cancel,chooseText:s.confirmColor,togglePaletteMoreText:s.customColor,togglePaletteLessText:s.collapse,togglePaletteOnly:!0,clearText:s.clearText,noColorSelectedText:s.noColorSelectedText,localStorageKey:"spectrum.textcolor"+ne.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(b){b!=null?b=b.toHexString():b="#000",$("#luckysheet-alternateformat-colorSelect-dialog .currenColor span").css("background-color",b).attr("title",b)}})},rangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-alternateformat-rangeDialog").remove();let n=Q(),t=n.alternatingColors,l=n.button;$("body").append(_e(dt,{id:"luckysheet-alternateformat-rangeDialog",addclass:"luckysheet-alternateformat-rangeDialog",title:t.selectRange,content:'<input readonly="readonly" placeholder="'+t.tipSelectRange+'" value="'+e+'"/>',botton:'<button id="luckysheet-alternateformat-rangeDialog-confirm" class="btn btn-primary">'+l.confirm+'</button><button id="luckysheet-alternateformat-rangeDialog-close" class="btn btn-default">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-alternateformat-rangeDialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-alternateformat-rangeDialog").css({left:(u+d-s)/2,top:(h+m-a)/3}).show()},rangeIsExists:function(e,n){let t=this,l=!1,o=null,a=$.extend(!0,[],f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save);if(n!=null&&n!=null&&(a.length>1?a.splice(n,1):a=[]),a.length>0){let s=[];for(let h=0;h<a.length;h++){let d={index:h,map:t.getRangeMap(a[h].cellrange.row,a[h].cellrange.column)};s.push(d)}let u=t.getRangeMap(e.row,e.column);for(let h in u){if(l)break;for(let d=0;d<s.length;d++)if(h in s[d].map){l=!0,o=s[d].index;break}}}return[l,o]},getRangeMap:function(e,n){let t={},l=e[0],o=e[1],a=n[0],s=n[1];for(let u=l;u<=o;u++)for(let h=a;h<=s;h++)t[u+"_"+h]=0;return t},getIndexByFormat:function(e){let n=this,t=null,l=n.FixedModelColor;for(let a=0;a<l.length;a++){let s=l[a];if(e.head.fc==s.head.fc&&e.head.bc==s.head.bc&&e.one.fc==s.one.fc&&e.one.bc==s.one.bc&&e.two.fc==s.two.fc&&e.two.bc==s.two.bc&&e.foot.fc==s.foot.fc&&e.foot.bc==s.foot.bc){t=a;break}}let o=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(o!=null&&o.length>0)for(let a=0;a<o.length;a++){let s=o[a];if(e.head.fc==s.head.fc&&e.head.bc==s.head.bc&&e.one.fc==s.one.fc&&e.one.bc==s.one.bc&&e.two.fc==s.two.fc&&e.two.bc==s.two.bc&&e.foot.fc==s.foot.fc&&e.foot.bc==s.foot.bc){t=l.length+a;break}}return t},getFormatByIndex:function(){let e=this,n=e.modelfocusIndex,t=e.FixedModelColor.length,l={};return n<t?l=e.FixedModelColor[n]:l=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom[n-t],l},new:function(e){let n=this,t=n.getFormatByIndex(),o=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save;o==null&&(o=[]);let a=$.extend(!0,[],o),s={cellrange:{row:e.row,column:e.column},format:t,hasRowHeader:!0,hasRowFooter:!1};o.push(s);let u=$.extend(!0,[],o);n.ref(a,u),ne.allowUpdate&&ne.saveParam("all",f.currentSheetIndex,o,{k:"luckysheet_alternateformat_save"})},update:function(){let e=this,t=Q().alternatingColors,l=$("#luckysheet-alternateformat-remove").data("index"),o=$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val().trim();if(!g.iscelldata(o)){he()?alert(t.errorNoRange):W.info(t.errorNoRange,"");return}let a=g.getcellrange(o);if(e.rangeIsExists(a,l)[0]){he()?alert(t.errorExistColors):W.info(t.errorExistColors,"");return}let u;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader").is(":checked")?u=!0:u=!1;let h;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter").is(":checked")?h=!0:h=!1;let d=e.getFormatByIndex(),p=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save;p==null&&(p=[]);let v=$.extend(!0,[],p),y={cellrange:{row:a.row,column:a.column},format:d,hasRowHeader:u,hasRowFooter:h};p[l]=y;let k=$.extend(!0,[],p);e.ref(v,k),ne.allowUpdate&&ne.saveParam("all",f.currentSheetIndex,p,{k:"luckysheet_alternateformat_save"})},checksAF:function(e,n,t){return e+"_"+n in t?t[e+"_"+n]:null},getComputeMap:function(){let n=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_alternateformat_save;return this.compute(n)},compute:function(e){let n={};if(e!=null&&e.length>0)for(let t=0;t<e.length;t++){let l=e[t].cellrange,o=e[t].format,a=e[t].hasRowHeader,s=e[t].hasRowFooter,u=l.row[0],h=l.row[1],d=l.column[0],m=l.column[1];if(a&&s){for(let p=d;p<=m;p++)n[u+"_"+p]=[o.head.fc,o.head.bc];if(h-u>1)for(let p=u+1;p<h;p++){let v,y;(p-u)%2!=0?(v=o.one.fc,y=o.one.bc):(v=o.two.fc,y=o.two.bc);for(let k=d;k<=m;k++)n[p+"_"+k]=[v,y]}if(h>u)for(let p=d;p<=m;p++)n[h+"_"+p]=[o.foot.fc,o.foot.bc]}else if(a){for(let p=d;p<=m;p++)n[u+"_"+p]=[o.head.fc,o.head.bc];if(h>u)for(let p=u+1;p<=h;p++){let v,y;(p-u)%2!=0?(v=o.one.fc,y=o.one.bc):(v=o.two.fc,y=o.two.bc);for(let k=d;k<=m;k++)n[p+"_"+k]=[v,y]}}else if(s){if(h>u)for(let p=u;p<h;p++){let v,y;(p-u)%2==0?(v=o.one.fc,y=o.one.bc):(v=o.two.fc,y=o.two.bc);for(let k=d;k<=m;k++)n[p+"_"+k]=[v,y]}for(let p=d;p<=m;p++)n[h+"_"+p]=[o.foot.fc,o.foot.bc]}else for(let p=u;p<=h;p++){let v,y;(p-u)%2==0?(v=o.one.fc,y=o.one.bc):(v=o.two.fc,y=o.two.bc);for(let k=d;k<=m;k++)n[p+"_"+k]=[v,y]}}return n},ref:function(e,n){if(f.clearjfundo){f.jfundo.length=0;let l={};l.type="updateAF",l.sheetIndex=f.currentSheetIndex,l.data={historyRules:e,currentRules:n},f.jfredo.push(l)}let t=Z(f.currentSheetIndex);f.luckysheetfile[t].luckysheet_alternateformat_save=n,setTimeout(function(){Be()},1)}},el=fv});var hv,Ln,Li=Me(()=>{ht();hv={parseJsonParm:function(e){if(e==null)return{};if(N(e)=="string")try{return new Function("return "+e)()}catch(n){return{}}else return e},hasKey:function(e){let t=this.parseJsonParm(e);for(let l in t)return!0;return!1}},Ln=hv});function On(e,n,t,l,o,a,s,u,h,d){if(n?(e.addClass("luckysheet-filter-options-active").data("rowhidden",JSON.stringify(t)).data("caljs",JSON.stringify(l)).html('<i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i>'),l!=null&&(e.data("byconditionvalue",l.value).data("byconditiontype",l.type).data("byconditiontext",l.text),l.value1!=null&&e.data("byconditionvalue1",l.value1),l.value2!=null&&e.data("byconditionvalue2",l.value2))):(e.removeClass("luckysheet-filter-options-active").data("rowhidden","").data("caljs","").html('<i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i>'),e.data("byconditionvalue","null").data("byconditiontype","0").data("byconditiontext","\u65E0").data("byconditionvalue1","").data("byconditionvalue2","")),o){let m=f.luckysheetfile[Z(f.currentSheetIndex)];if(m.filter==null&&(m.filter={}),n){let p={caljs:l,rowhidden:t,optionstate:n,str:a,edr:s,cindex:u,stc:h,edc:d};m.filter[u-h]=p}else delete m.filter[u-h];ne.saveParam("all",f.currentSheetIndex,m.filter,{k:"filter"})}}function Ih(e,n,t,l,o,a){let s=xe.deepCopyFlowData(f.flowdata);e=e+1;let u=!1,h=[];for(let m=e;m<=t;m++){let p=[];for(let v=n;v<=l;v++){if(s[m][v]!=null&&s[m][v].mc!=null){u=!0;break}p.push(s[m][v])}h.push(p)}if(u){let m=Q().filter;he()?alert(m.mergeError):W.info(m.mergeError,"");return}h=Hr(h,o-n,a);for(let m=e;m<=t;m++)for(let p=n;p<=l;p++)s[m][p]=h[m-e][p-n];let d={};if(f.config.rowlen!=null){let m=$.extend(!0,{},f.config);m=pl(s,e,t,m),d={cfg:m,RowlChange:!0}}Ze(s,[{row:[e,t],column:[n,l]}],d)}function Io(){if(!Tt(f.currentSheetIndex,"filter"))return;if(f.luckysheet_select_save.length>1){$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#"+f.container).attr("tabindex",0).focus();let n=Q().splitText;he()?alert(n.tipNoMulti):W.info(n.tipNoMulti,"");return}if(f.luckysheetfile[Z(f.currentSheetIndex)].isPivotTable)return;$("#luckysheet-filter-selected-sheet"+f.currentSheetIndex+", #luckysheet-filter-options-sheet"+f.currentSheetIndex).remove();let e=f.luckysheet_select_save[0];if(e.row[0]==e.row[1]&&e.column[0]==e.column[1]){let n,t,l=e.row[1];for(let o=0;o<f.flowdata[l].length;o++){let a=f.flowdata[l][o];if(a!=null&&!me(a.v))n==null&&(n=o);else if(n!=null){t=o-1;break}}t==null&&(t=f.flowdata[l].length-1),f.luckysheet_select_save=[{row:[l,l],column:[n,t]}],lt(),f.luckysheet_shiftpositon=$.extend(!0,{},e),Ps("down","range")}else e.row[1]-e.row[0]<2&&(f.luckysheet_shiftpositon=$.extend(!0,{},e),Ps("down","range"));f.luckysheet_filter_save=$.extend(!0,{},f.luckysheet_select_save[0]),Dl(f.luckysheet_filter_save),ne.saveParam("all",f.currentSheetIndex,f.luckysheet_filter_save,{k:"filter_select"}),f.filterchage&&f.jfredo.push({type:"filtershow",data:[],curdata:[],sheetIndex:f.currentSheetIndex,filter_save:f.luckysheet_filter_save})}function Dl(e,n){if($("#luckysheet-filter-selected-sheet"+f.currentSheetIndex).remove(),$("#luckysheet-filter-options-sheet"+f.currentSheetIndex).remove(),e==null||JSON.stringify(e)=="{}")return;let t=e.row[0],l=e.row[1],o=e.column[0],a=e.column[1],s=f.visibledatarow[l],u=t-1==-1?0:f.visibledatarow[t-1],h=f.visibledatacolumn[a],d=o-1==-1?0:f.visibledatacolumn[o-1],m='<div id="luckysheet-filter-selected-sheet'+f.currentSheetIndex+'" class="luckysheet-cell-selected luckysheet-filter-selected"  style="left:'+d+"px;width:"+(h-d-1)+"px;top:"+u+"px;height:"+(s-u-1)+'px;display:block;border-color:#897BFF;z-index:20;background:none;"></div>';$("#luckysheet-cell-main").append(m);let p="";for(let y=o;y<=a;y++)if(n==null||n[y-o]==null)p+='<div data-rowhidden="" data-str="'+t+'" data-edr="'+l+'" data-cindex="'+y+'" data-stc="'+o+'" data-edc="'+a+'" class="luckysheet-filter-options" style="left:'+(f.visibledatacolumn[y]-20)+"px;top:"+u+'px;display:block;"><i class="fa fa-caret-down" aria-hidden="true"></i></div>';else{let k;if(n[y-o].caljs!=null){let b;n[y-o].caljs.value1!=null?b='data-byconditionvalue1="'+n[y-o].caljs.value1+'" ':b="";let w;n[y-o].caljs.value2!=null?w='data-byconditionvalue2="'+n[y-o].caljs.value2+'" ':w="",k='data-caljs="'+JSON.stringify(n[y-o].caljs)+'" data-byconditionvalue="'+n[y-o].caljs.value+'" data-byconditiontype="'+n[y-o].caljs.type+'" data-byconditiontext="'+n[y-o].caljs.text+'" '+b+w}else k="";p+='<div data-rowhidden="'+JSON.stringify(n[y-o].rowhidden).replace(/\"/g,"'")+'" '+k+' data-str="'+t+'" data-edr="'+l+'" data-cindex="'+y+'" data-stc="'+o+'" data-edc="'+a+'" class="luckysheet-filter-options luckysheet-filter-options-active" style="left:'+(f.visibledatacolumn[y]-20)+"px;top:"+u+'px;display:block;"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i></div>'}$("#luckysheet-cell-main").append('<div id="luckysheet-filter-options-sheet'+f.currentSheetIndex+'" class="luckysheet-filter-options-c">'+p+"</div>"),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-cell-main").scrollTop()>e.top_move&&$("#luckysheet-scrollbar-y").scrollTop(e.top_move);let v=f.luckysheetfile[Z(f.currentSheetIndex)];v.filter_select=e}function Rh(){let e=null,n=Q(),t=n.filter,l=n.button;$("#luckysheetfilter").click(Io);let o=null,a=null;$(".luckysheet-cols-menu .luckysheet-cols-submenu").hover(function(){let s=$(this),u=s.attr("id"),h=$("#"+u+"_sub"),d=s.parent(),m=$(window).width(),p=$(window).height(),v=d.width(),y=h.height()+25,k=h.width()+5,b=s.offset(),w=b.top,x=b.left+v;x+k>m&&(x=b.left-k),w+y>p&&(w=p-y),h.css({top:w,left:x}).show(),a=s},function(){let s=$(this),u=s.attr("id"),h=$("#"+u+"_sub");o=setTimeout(function(){h.hide()},200)}),$(".luckysheet-rightgclick-menu-sub").hover(function(){a.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(o)},function(){a.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide()}),$("#luckysheet-filter-menu").mouseover(function(){clearTimeout(e),e=setTimeout(function(){$("#luckysheet-filter-submenu").hide()},500)}),$("#luckysheet-filter-submenu").mouseover(function(){clearTimeout(e)}).find(".luckysheet-cols-menuitem").click(function(s){$("#luckysheet-filter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide();let u=$(this).data("type"),h=$(this).attr("data-value");u=="2"?($("#luckysheet-filter-selected span").data("type","2"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show(),$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number")):u=="0"?$("#luckysheet-filter-selected span").data("type","0"):($("#luckysheet-filter-selected span").data("type","1"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show(),h=="dateequal"||h=="datelessthan"||h=="datemorethan"?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","date"):h=="morethan"||h=="moreequalthan"||h=="lessthan"||h=="lessequalthan"||h=="equal"||h=="noequal"?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number"):$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","text")),$("#luckysheet-filter-byvalue").next().slideUp(),$("#luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-bycondition, #luckysheet-filter-byvalue").click(function(){let s=$(this);s.next().slideToggle(200),setTimeout(function(){s.attr("id")=="luckysheet-filter-bycondition"&&$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-selected span").text()!=t.filiterInputNone&&$("#luckysheet-filter-byvalue").next().slideUp(200),s.is($("#luckysheet-filter-bycondition"))&&$("#luckysheet-filter-bycondition").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-filter-selected").click(function(){let s=$(this),u=s.offset(),h=$("#luckysheet-filter-submenu");h.hide();let d=$(window).height(),m=$(window).width(),p=h.width(),v=h.height(),y=u.top,k=u.left,b=d-u.top-20;u.left+p>m&&(k=u.left-p),u.top>d/2&&(y=d-u.top,y<0&&(y=0),b=u.top-20),h.css({top:y,left:k,height:b}).show(),clearTimeout(e)}),$("#luckysheet-cell-main").on("click",".luckysheet-filter-options",function(s){if(!Tt(f.currentSheetIndex,"filter"))return;let u=$(s.currentTarget),h=u.offset(),d=$("#luckysheet-filter-menu"),m=$(window).height(),p=$(window).width(),v=u.data("str"),y=u.data("edr"),k=u.data("cindex"),b=u.data("stc"),w=u.data("edc"),x=u.data("rowhidden")==""?{}:JSON.parse(u.data("rowhidden").replace(/\'/g,'"'));$("body .luckysheet-cols-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-filter-byvalue-input").val(""),$("#luckysheet-filter-bycondition").next().hide(),$("#luckysheet-filter-byvalue").next().show(),d.data("str",v),d.data("edr",y),d.data("cindex",k),d.data("stc",b),d.data("edc",w),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(t.filiterInputNone);let C=u.data("byconditiontype");if($("#luckysheet-filter-selected span").data("value",u.data("byconditionvalue")).data("type",C).text(u.data("byconditiontext")),C=="2"){let F=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show().find("input");F.eq(0).val(u.data("byconditionvalue1")),F.eq(1).val(u.data("byconditionvalue2"))}else C=="1"&&$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show().find("input").val(u.data("byconditionvalue1"));$("#luckysheet-filter-orderby-asc").off("click").on("click",function(){Ih(v,b,y,w,k,!0)}),$("#luckysheet-filter-orderby-desc").off("click").on("click",function(){Ih(v,b,y,w,k,!1)});let S=Ar("#luckysheet-filter-byvalue-select",{text:t.filiterMoreDataTip});$("#luckysheet-filter-byvalue-select").empty().append(S.el);let _={};$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").not(this).each(function(){let F=$(this),R=F.data("rowhidden");if(R=="")return!0;R=JSON.parse(R.replace(/\'/g,'"'));for(let I in R)_[I]=0});let T=f.flowdata;return setTimeout(function(){let F={},R={},I={},P={};for(let A=v+1;A<=y;A++){if(A in _||f.flowdata[A]==null)continue;let z=f.flowdata[A][k];if(z!=null&&!me(z.v)&&z.ct!=null&&z.ct.t=="d"){let L=mt("YYYY-MM-DD",z.v),E=L.split("-")[0],V=L.split("-")[1],q=L.split("-")[2];E in F||(F[E]={}),V in F[E]||(F[E][V]={}),q in F[E][V]||(F[E][V][q]=0),F[E][V][q]++,A in x&&(R[E]=0,R[V]=0,R[q]=0)}else{let L,E;z==null||me(z.v)?(L=null,E=null):(L=z.v,E=z.m),L in I||(I[L]={}),E in I[L]||(I[L][E]=0),I[L][E]++,A in x&&(P[L+"#$$$#"+E]=0)}}let O=[];if(JSON.stringify(F).length>2)for(let A in F){let z=0,L="";for(let V in F[A]){let q=0,G="";for(let ee in F[A][V]){let le=F[A][V][ee];q+=le;let se;Number(V)<10?se="0"+Number(V):se=V;let ae;Number(ee)<10?ae="0"+Number(ee):ae=ee,A in R&&V in R&&ee in R?G+='<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+A+"-"+se+"-"+ae+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+ee+'</label><span class="count luckysheet-mousedown-cancel">( '+le+" )</span></div>":G+='<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+A+"-"+se+"-"+ae+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+ee+'</label><span class="count luckysheet-mousedown-cancel">( '+le+" )</span></div>"}z+=q;let X;Number(V)<10?X="0"+Number(V):X=V,A in R&&V in R?L+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+A+"-"+X+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+V+""+t.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+q+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+G+"</div></div>":L+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+A+"-"+X+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+V+""+t.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+q+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+G+"</div></div>"}let E;A in R?E='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+A+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+A+""+t.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+z+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+L+"</div></div>":E='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+A+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+A+""+t.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+z+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+L+"</div></div>",O.unshift(E)}if(JSON.stringify(I).length>2){let A=Object.keys(I);A=ma(A,!0);for(let z=0;z<A.length;z++){let L=A[z];for(let E in I[L]){let V;L+"#$$$#"+E=="null#$$$#null"?V=t.valueBlank:V=E;let q;L+"#$$$#"+E in P?q='<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+(L+"#$$$#"+E)+'" title="'+V+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+V+'</label><span class="luckysheet-mousedown-cancel count">( '+I[L][E]+" )</span></div>":q='<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+(L+"#$$$#"+E)+'" title="'+V+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+V+'</label><span class="luckysheet-mousedown-cancel count">( '+I[L][E]+" )</span></div>",O.push(q)}}}let M=m-h.top-350;M<0&&(M=100),$("#luckysheet-filter-byvalue-select").append("<div class='ListBox luckysheet-mousedown-cancel' style='min-height: 100px; max-height: "+M+"px; overflow-y: auto; overflow-x: hidden;'><table cellspacing='0' style='width:100%;' class='luckysheet-mousedown-cancel'>"+O.join("")+"</table></div>"),S.close()},1),on(d,h.left,h.top+20),s.stopPropagation(),!1}),$("#luckysheet-filter-orderby-color").hover(function(){let s=$("#luckysheet-filter-menu"),u=s.data("str"),h=s.data("edr"),d=s.data("cindex"),m=s.data("stc"),p=s.data("edc"),v={},y={},k=el.getComputeMap(),b=Se.getComputeMap();for(let z=u+1;z<=h;z++){let L=f.flowdata[z][d],E=be.checkstatus(f.flowdata,z,d,"bg");E==null&&(E="#ffffff");let V=el.checksAF(z,d,k);V!=null&&(E=V[1]);let q=Se.checksCF(z,d,b);q!=null&&q.cellColor!=null&&(E=q.cellColor),E.indexOf("rgb")>-1&&(E=Pn(E)),E.length==4&&(E=E.substr(0,1)+E.substr(1,1).repeat(2)+E.substr(2,1).repeat(2)+E.substr(3,1).repeat(2));let G=be.checkstatus(f.flowdata,z,d,"fc");V!=null&&(G=V[0]),q!=null&&q.textColor!=null&&(G=q.textColor),G.indexOf("rgb")>-1&&(G=Pn(G)),G.length==4&&(G=G.substr(0,1)+G.substr(1,1).repeat(2)+G.substr(2,1).repeat(2)+G.substr(3,1).repeat(2)),f.config!=null&&f.config.rowhidden!=null&&z in f.config.rowhidden?(v[E]=1,L!=null&&!me(L.v)&&(y[G]=1)):(v[E]=0,L!=null&&!me(L.v)&&(y[G]=0))}let w="";if(JSON.stringify(v).length>2&&Object.keys(v).length>1){let z="";for(let L in v)v[L]==0?z+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+L+'" title="'+L+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':z+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+L+'" title="'+L+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';w='<div id="filterBgColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">'+t.filiterByColorTip+'</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+z+"</div></div>"}let x="";if(JSON.stringify(y).length>2&&Object.keys(y).length>1){let z="";for(let L in y)y[L]==0?z+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+L+'" title="'+L+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':z+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+L+'" title="'+L+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';x='<div id="filterFcColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">'+t.filiterByTextColorTip+'</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+z+"</div></div>"}let C;w==""&&x==""?C='<div class="luckysheet-mousedown-cancel" style="padding: 10px 30px;text-align: center;">'+t.filterContainerOneColorTip+"</div>":C=w+x+'<div class="luckysheet-mousedown-cancel"><button id="luckysheet-filter-orderby-color-confirm" class="btn btn-primary luckysheet-mousedown-cancel" style="margin: 5px 20px;width: 70px;">'+l.confirm+"</button></div>",$("#luckysheet-filter-orderby-color-submenu").remove(),$("body").append('<div id="luckysheet-filter-orderby-color-submenu" class="luckysheet-cols-menu luckysheet-mousedown-cancel">'+C+"</div>");let S=$("#luckysheet-filter-orderby-color-submenu").end(),_=$(this).parent(),T=$(window).width(),F=$(window).height(),R=_.width(),I=S.height()+25,P=S.width()+5,O=$(this).offset(),M=O.top,A=O.left+R;A+P>T&&(A=O.left-P),M+I>F&&(M=F-I),$("#luckysheet-filter-orderby-color-submenu").css({top:M,left:A}).show()},function(){o=setTimeout(function(){$("#luckysheet-filter-orderby-color-submenu").hide()},200)}),$(document).on("mouseover mouseleave","#luckysheet-filter-orderby-color-submenu",function(s){s.type==="mouseover"?clearTimeout(o):$(this).hide()}),$(document).on("click","#luckysheet-filter-orderby-color-submenu .item label",function(){$(this).siblings("input[type='checkbox']").click()}),$(document).off("click.orderbyColorConfirm").on("click.orderbyColorConfirm","#luckysheet-filter-orderby-color-submenu #luckysheet-filter-orderby-color-confirm",function(){let s={},u={};$("#luckysheet-filter-orderby-color-submenu .item").each(function(M,A){if($(A).find("input[type='checkbox']").is(":checked")){let z=$(this).find("label").attr("title"),L=$(this).closest(".box").attr("id");L=="filterBgColor"?s[z]=0:L=="filterFcColor"&&(u[z]=0)}});let h;$("#luckysheet-filter-orderby-color-submenu #filterBgColor").length>0?h=!0:h=!1;let d;$("#luckysheet-filter-orderby-color-submenu #filterFcColor").length>0?d=!0:d=!1;let m=$("#luckysheet-filter-menu"),p=m.data("str"),v=m.data("edr"),y=m.data("cindex"),k=m.data("stc"),b=m.data("edc"),w={};$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").eq(y-k).get(0)).each(function(){let M=$(this),A=M.data("rowhidden");if(A=="")return!0;A=JSON.parse(A);for(let z in A)w[z]=0});let x={},C={},S={},_=el.getComputeMap(),T=Se.getComputeMap();for(let M=p+1;M<=v;M++){if(M in w||f.flowdata[M]==null)continue;let A=f.flowdata[M][y],z=be.checkstatus(f.flowdata,M,y,"bg"),L=el.checksAF(M,y,_);L!=null&&(z=L[1]);let E=Se.checksCF(M,y,T);E!=null&&E.cellColor!=null&&(z=E.cellColor),z=z==null?"#ffffff":z,z.indexOf("rgb")>-1&&(z=Pn(z)),z.length==4&&(z=z.substr(0,1)+z.substr(1,1).repeat(2)+z.substr(2,1).repeat(2)+z.substr(3,1).repeat(2));let V=be.checkstatus(f.flowdata,M,y,"fc");L!=null&&(V=L[0]),E!=null&&E.textColor!=null&&(V=E.textColor),V.indexOf("rgb")>-1&&(V=Pn(V)),V.length==4&&(V=V.substr(0,1)+V.substr(1,1).repeat(2)+V.substr(2,1).repeat(2)+V.substr(3,1).repeat(2)),h&&d?!(z in s)&&(!(V in u)||A==null||me(A.v))&&(C[M]=0):h?z in s||(C[M]=0):d&&(!(V in u)||A==null||me(A.v))&&(C[M]=0)}let F=$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").eq(y-k),R=Object.keys(C).length>0,I=$.extend(!0,w,C),P=Ln.parseJsonParm(F.data("rowhidden"));On(F,R,C,S,!0,p,v,y,k,b);let O=$.extend(!0,{},f.config);if(O.rowhidden=I,f.clearjfundo){let M={};M.type="datachangeAll_filter",M.sheetIndex=f.currentSheetIndex,M.config=$.extend(!0,{},f.config),M.curconfig=O,M.optionstate=R,M.optionsindex=y-k,M.rowhidden=$.extend(!0,{},C),M.rowhidenPre=$.extend(!0,{},P),S!=null&&(M.caljs=S),f.jfundo.length=0,f.jfredo.push(M)}f.config=O,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,O.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu, #luckysheet-filter-orderby-color-submenu").hide(),rl()}),$(document).off("click.filterCheckbox1").on("click.filterCheckbox1","#luckysheet-filter-byvalue-select .textBox",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox2").on("click.filterCheckbox2","#luckysheet-filter-byvalue-select .year",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox3").on("click.filterCheckbox3","#luckysheet-filter-byvalue-select .month",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));let s=!0;$(this).parents(".yearBox").find(".day").each(function(h,d){$(d).attr("data-check")=="true"||(s=!1)}),s?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterCheckbox4").on("click.filterCheckbox4","#luckysheet-filter-byvalue-select .day",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));let s=!0;$(this).parents(".monthBox").find(".day").each(function(m,p){$(p).attr("data-check")=="true"||(s=!1)}),s?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));let h=!0;$(this).parents(".yearBox").find(".day").each(function(m,p){$(p).attr("data-check")=="true"||(h=!1)}),h?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterYearDropdown").on("click.filterYearDropdown","#luckysheet-filter-byvalue-select .yearBox .fa-caret-right",function(s){let u=$(this).parents(".luckysheet-mousedown-cancel");u.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),u.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle(),s.stopPropagation()}),$("#luckysheet-filter-byvalue-btn-all").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-filter-byvalue-btn-clear").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-filter-byvalue-btn-contra").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(d,m){$(m).is(":checked")?($(m).removeAttr("checked"),$(m).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(m).prop("checked",!0),$(m).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-filter-byvalue-select .ListBox .monthBox").each(function(d,m){let p=!0;$(m).find(".day input[type='checkbox']").each(function(y,k){$(k).is(":checked")||(p=!1)}),p?($(m).find(".month input[type='checkbox']").prop("checked",!0),$(m).attr("data-check","true")):($(m).find(".month input[type='checkbox']").removeAttr("checked"),$(m).attr("data-check","false"))}),$("#luckysheet-filter-byvalue-select .ListBox .yearBox").each(function(d,m){let p=!0;$(m).find(".day input[type='checkbox']").each(function(y,k){$(k).is(":checked")||(p=!1)}),p?($(m).find(".year input[type='checkbox']").prop("checked",!0),$(m).attr("data-check","true")):($(m).find(".year input[type='checkbox']").removeAttr("checked"),$(m).attr("data-check","false"))})}),$("#luckysheet-filter-initial").click(function(){if(!Tt(f.currentSheetIndex,"filter"))return;$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(t.conditionNone);let s={};s.type="datachangeAll_filter_clear",s.sheetIndex=f.currentSheetIndex,s.config=$.extend(!0,{},f.config),f.config.rowhidden={},s.curconfig=$.extend(!0,{},f.config),s.filter_save=$.extend(!0,{},f.luckysheet_filter_save);let u=[];$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").each(function(){let h=$(this),d=h.hasClass("luckysheet-filter-options-active"),m=Ln.parseJsonParm(h.data("rowhidden")),p=Ln.parseJsonParm(h.data("caljs"));u.push({optionstate:d,rowhidden:m,caljs:p,str:h.data("str"),edr:h.data("edr"),cindex:h.data("cindex"),stc:h.data("stc"),edc:h.data("edc")})}),s.optiongroups=u,f.jfundo.length=0,f.jfredo.push(s),$("#luckysheet-filter-selected-sheet"+f.currentSheetIndex+", #luckysheet-filter-options-sheet"+f.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),f.luckysheetfile[Z(f.currentSheetIndex)].filter=null,f.luckysheetfile[Z(f.currentSheetIndex)].filter_select=null,ne.saveParam("fsc",f.currentSheetIndex,null),f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,{},{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length)}),$("#luckysheet-filter-byvalue-input").on("input propertychange",function(){let s=$(this).val().toString();$("#luckysheet-filter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),s!=""&&$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(u,h){if($(h).closest(".day").length>0){let d=$(h).siblings("label").text().toString(),m=$(h).closest(".monthBox").find(".month label").text().toString();($(h).closest(".yearBox").find(".year label").text().toString()+"-"+m+"-"+d).indexOf(s)==-1&&($(h).closest(".day").hide(),$(h).closest(".dayList").find(".day:visible").length==0&&$(h).closest(".monthBox").find(".month").hide(),$(h).closest(".monthList").find(".day:visible").length==0&&$(h).closest(".yearBox").find(".year").hide())}$(h).closest(".textBox").length>0&&$(h).siblings("label").text().toString().indexOf(s)==-1&&$(h).parents(".textBox").hide()})}),$("#luckysheet-filter-cancel").click(function(){$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-confirm").click(function(){let s=$("#luckysheet-filter-menu"),u=s.data("str"),h=s.data("edr"),d=s.data("cindex"),m=s.data("stc"),p=s.data("edc"),v={};$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").eq(d-m).get(0)).each(function(){let T=$(this),F=T.data("rowhidden");if(F=="")return!0;F=JSON.parse(F.replace(/\'/g,'"'));for(let R in F)v[R]=0});let y={},k={},b={};if($("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-selected span").data("value")!="null"){let T=$("#luckysheet-filter-selected span"),F=T.data("type"),R=T.data("value");if(b.value=R,b.text=T.text(),F=="0")b.type="0";else if(F=="2"){let I=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2 input");b.type="2",b.value1=I.eq(0).val(),b.value2=I.eq(1).val()}else b.type="1",b.value1=$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).find("input").val();for(let I=u+1;I<=h;I++){if(I in v||f.flowdata[I]==null)continue;let P=f.flowdata[I][d];if(R=="cellnull")P!=null&&!me(P.v)&&(k[I]=0);else if(R=="cellnonull")(P==null||me(P.v))&&(k[I]=0);else if(R=="textinclude"){let O=b.value1;(P==null||me(P.v)||P.m.indexOf(O)==-1)&&(k[I]=0)}else if(R=="textnotinclude"){let O=b.value1;P==null||me(P.v)||P.m.indexOf(O)>-1&&(k[I]=0)}else if(R=="textstart"){let O=b.value1,M=O.length;(P==null||me(P.v)||P.m.substr(0,M)!=O)&&(k[I]=0)}else if(R=="textend"){let O=b.value1,M=O.length;(P==null||me(P.v)||M>P.m.length||P.m.substr(P.m.length-M,M)!=O)&&(k[I]=0)}else if(R=="textequal"){let O=b.value1;(P==null||me(P.v)||P.m!=O)&&(k[I]=0)}else if(R=="dateequal"){let O=nt(b.value1)[2];P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="d"?parseInt(P.v)!=O&&(k[I]=0):k[I]=0}else if(R=="datelessthan"){let O=nt(b.value1)[2];P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="d"?parseInt(P.v)>=O&&(k[I]=0):k[I]=0}else if(R=="datemorethan"){let O=nt(b.value1)[2];P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="d"?parseInt(P.v)<=O&&(k[I]=0):k[I]=0}else if(R=="morethan"){let O=parseFloat(b.value1);P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="n"?P.v<=O&&(k[I]=0):k[I]=0}else if(R=="moreequalthan"){let O=parseFloat(b.value1);P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="n"?P.v<O&&(k[I]=0):k[I]=0}else if(R=="lessthan"){let O=parseFloat(b.value1);P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="n"?P.v>=O&&(k[I]=0):k[I]=0}else if(R=="lessequalthan"){let O=parseFloat(b.value1);P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="n"?P.v>O&&(k[I]=0):k[I]=0}else if(R=="equal"){let O=parseFloat(b.value1);P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="n"?P.v!=O&&(k[I]=0):k[I]=0}else if(R=="noequal"){let O=parseFloat(b.value1);P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="n"?P.v==O&&(k[I]=0):k[I]=0}else if(R=="include"){let O=parseFloat(b.value1),M=parseFloat(b.value2),A,z;O<M?(A=O,z=M):(z=O,A=M),P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="n"?(P.v<A||P.v>z)&&(k[I]=0):k[I]=0}else if(R=="noinclude"){let O=parseFloat(b.value1),M=parseFloat(b.value2),A,z;O<M?(A=O,z=M):(z=O,A=M),P==null||me(P.v)?k[I]=0:P.ct!=null&&P.ct.t=="n"?P.v>=A&&P.v<=z&&(k[I]=0):k[I]=0}}}else{$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(T,F){if($(F).is(":visible")&&$(F).is(":checked"))return!0;if($(F).closest(".day").length>0){let R=$(F).siblings("label").text();Number(R)<10&&(R="0"+Number(R));let I=$(F).closest(".monthBox").find(".month label").text().replace(t.filiterMonthText,"");Number(I)<10&&(I="0"+Number(I));let P=$(F).closest(".yearBox").find(".year label").text().replace(t.filiterYearText,""),O=t.filterDateFormatTip+"#$$$#"+P+"-"+I+"-"+R;y[O]="1"}if($(F).closest(".textBox").length>0){let R=$(F).closest(".textBox").data("filter");y[R]="1"}});for(let T=u+1;T<=h;T++){if(T in v||f.flowdata[T]==null)continue;let F=f.flowdata[T][d],R;if(F==null||me(F.v))R="null#$$$#null";else if(F.ct!=null&&F.ct.t=="d"){let I=mt("YYYY-MM-DD",F.v);R=t.filterDateFormatTip+"#$$$#"+I}else R=F.v+"#$$$#"+F.m;R in y&&(k[T]=0)}}let w=$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").eq(d-m),x=$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible").length||$("#luckysheet-filter-byvalue-input").val().length>0||$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-selected span").data("value")!="null",C=$.extend(!0,v,k),S=Ln.parseJsonParm(w.data("rowhidden"));On(w,x,k,b,!0,u,h,d,m,p);let _=$.extend(!0,{},f.config);if(_.rowhidden=C,f.clearjfundo){let T={};T.type="datachangeAll_filter",T.sheetIndex=f.currentSheetIndex,T.config=$.extend(!0,{},f.config),T.curconfig=_,T.optionstate=x,T.optionsindex=d-m,T.rowhidden=$.extend(!0,{},k),T.rowhidenPre=$.extend(!0,{},S),b!=null&&(T.caljs=b),f.jfundo.length=0,f.jfredo.push(T)}f.config=_,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,_.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),rl()})}var yn=Me(()=>{Et();Jt();Nt();ll();dr();Zt();So();Wt();Qt();kt();Ke();ol();mr();Ei();Ml();ht();Vr();Yt();ui();Li();Fl()});var Ns,Ie,qr=Me(()=>{Zl();Qt();Br();Wt();Ml();Et();Zn();ht();Ke();kt();ll();Nl();Ns={imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null,insertImg:function(e){let n=f.toJsonOptions&&f.toJsonOptions.uploadImage;if(typeof n=="function")n(e).then(t=>{Ns._insertImg(t)}).catch(t=>{W.info('<i class="fa fa-exclamation-triangle"></i>',"\u56FE\u7247\u4E0A\u4F20\u5931\u8D25")});else{let t=new FileReader;t.readAsDataURL(e),t.onload=function(l){let o=l.target.result;Ns._insertImg(o),$("#luckysheet-imgUpload").val("")}}},_insertImg:function(e){let n=this,t=f.luckysheet_select_save[f.luckysheet_select_save.length-1],l=t.row_focus||0,o=t.column_focus||0,a=o==0?0:f.visibledatacolumn[o-1],s=l==0?0:f.visibledatarow[l-1],u=new Image;u.onload=function(){let d=u.width,m=u.height,p={src:e,left:a,top:s,originWidth:d,originHeight:m};n.addImgItem(p)};let h=f.toJsonOptions&&f.toJsonOptions.imageUrlHandle;u.src=typeof h=="function"?h(e):e},generateRandomId:function(e){e==null&&(e="img");let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="";for(let o=0;o<12;o++)t+=n[Math.round(Math.random()*(n.length-1))];let l=new Date().getTime();return e+"_"+t+"_"+l},modelHtml:function(e,n){let t=this,l=f.toJsonOptions&&f.toJsonOptions.imageUrlHandle,o=typeof l=="function"?l(n.src):n.src,a=t.getImgItemParam(n),s=a.width*f.zoomRatio,u=a.height*f.zoomRatio,h=a.left*f.zoomRatio,d=a.top*f.zoomRatio,m=a.position,p=n.border.width;return`<div id="${e}" class="luckysheet-modal-dialog luckysheet-modal-dialog-image" style="width:${s}px;height:${u}px;padding:0;position:${m};left:${h}px;top:${d}px;z-index:200;">
                    <div class="luckysheet-modal-dialog-content" style="width:100%;height:100%;overflow:hidden;position:relative;">
                        <img src="${o}" style="position:absolute;width:${n.default.width*f.zoomRatio}px;height:${n.default.height*f.zoomRatio}px;left:${-n.crop.offsetLeft*f.zoomRatio}px;top:${-n.crop.offsetTop*f.zoomRatio}px;" />
                    </div>
                    <div class="luckysheet-modal-dialog-border" style="border:${p}px ${n.border.style} ${n.border.color};border-radius:${n.border.radius*f.zoomRatio}px;position:absolute;left:${-p}px;right:${-p}px;top:${-p}px;bottom:${-p}px;"></div>
                </div>`},getSliderHtml:function(){let e=Q().imageText;return`<div id="luckysheet-modal-dialog-slider-imageCtrl" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-imageCtrl" style="display:block;">
                    <div class="luckysheet-modal-dialog-slider-title">
                        <span>${e.imageSetting}</span>
                        <span class="luckysheet-model-close-btn" title="${e.close}">
                            <i class="fa fa-times" aria-hidden="true"></i>
                        </span>
                    </div>
                    <div class="luckysheet-modal-dialog-slider-content">
                        <div class="slider-box">
                            <div class="slider-box-title">${e.conventional}</div>
                            <div class="slider-box-radios">
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType1" name="imgItemType" value="1">
                                    <label for="imgItemType1">${e.moveCell1}</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType2" name="imgItemType" value="2">
                                    <label for="imgItemType2">${e.moveCell2}</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType3" name="imgItemType" value="3">
                                    <label for="imgItemType3">${e.moveCell3}</label>
                                </div>
                            </div>
                            <div class="slider-box-checkbox">
                                <input type="checkbox" id="imgItemIsFixedPos">
                                <label for="imgItemIsFixedPos">${e.fixedPos}</label>
                            </div>
                        </div>
                        <div class="slider-box">
                            <div class="slider-box-title">${e.border}</div>
                            <div class="slider-box-borderConfig">
                                <div class="border-item">
                                    <label>${e.width}</label>
                                    <input type="number" id="imgItemBorderWidth" min="0">
                                </div>
                                <div class="border-item">
                                    <label>${e.radius}</label>
                                    <input type="number" id="imgItemBorderRadius" min="0">
                                </div>
                                <div class="border-item">
                                    <label>${e.style}</label>
                                    <select id="imgItemBorderStyle">
                                        <option value="solid">${e.solid}</option>
                                        <option value="dashed">${e.dashed}</option>
                                        <option value="dotted">${e.dotted}</option>
                                        <option value="double">${e.double}</option>
                                    </select>
                                </div>
                                <div class="border-item">
                                    <label>${e.color}</label>
                                    <div id="imgItemBorderColor" class="imgItemBorderColor">
                                        <span></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`},sliderHtmlShow:function(){let e=this;$("#luckysheet-modal-dialog-slider-imageCtrl").remove();let n=e.getSliderHtml();$("body").append(n),Ot();let t=e.images[e.currentImgId],l=t.type;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemType"+l).prop("checked",!0);let o=t.isFixedPos;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemIsFixedPos").prop("checked",o);let a=t.border;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderWidth").val(a.width),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderRadius").val(a.radius),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderStyle").val(a.style),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span").css("background-color",a.color).attr("title",a.color),e.init()},colorSelectDialog:function(e){let n=Q(),t=n.button,l=n.toolbar,o=n.imageCtrl;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-imageCtrl-colorSelect-dialog").remove(),$("body").append(_e(dt,{id:"luckysheet-imageCtrl-colorSelect-dialog",addclass:"luckysheet-imageCtrl-colorSelect-dialog",title:o.borderTile,content:`<div class="currenColor">
                            ${o.borderCur}:<span title="${e}" style="background-color:${e}"></span>
                        </div>
                        <div class="colorshowbox"></div>`,botton:`<button id="luckysheet-imageCtrl-colorSelect-dialog-confirm" class="btn btn-primary">${t.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${t.cancel}</button>`,style:"z-index:100003"}));let a=$("#luckysheet-imageCtrl-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),s=a.outerHeight(),u=a.outerWidth(),h=$(window).width(),d=$(window).height(),m=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-imageCtrl-colorSelect-dialog").css({left:(h+m-u)/2,top:(d+p-s)/3}).show(),$("#luckysheet-imageCtrl-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:t.cancel,chooseText:l.confirmColor,togglePaletteMoreText:l.customColor,togglePaletteLessText:l.collapse,togglePaletteOnly:!0,clearText:l.clearText,noColorSelectedText:l.noColorSelectedText,localStorageKey:"spectrum.textcolor"+ne.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(v){v!=null?v=v.toHexString():v="#000",$("#luckysheet-imageCtrl-colorSelect-dialog .currenColor span").css("background-color",v).attr("title",v)}})},init:function(){let e=this;$("#luckysheet-modal-dialog-slider-imageCtrl .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),Ot()}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.radio").on("change.radio",".radio-item input[type=radio][name=imgItemType]",function(){e.configChange("type",this.value)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.checkbox").on("change.checkbox",".slider-box-checkbox input[type=checkbox]",function(){e.configChange("fixedPos",this.checked)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderWidth").on("change.borderWidth","#imgItemBorderWidth",function(){e.configChange("border-width",this.valueAsNumber)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderRadius").on("change.borderRadius","#imgItemBorderRadius",function(){e.configChange("border-radius",this.valueAsNumber)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderStyle").on("change.borderStyle","#imgItemBorderStyle",function(){e.configChange("border-style",this.value)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("click.color").on("click.color","#imgItemBorderColor",function(){let n=$(this).find("span").attr("title");e.colorSelectDialog(n)}),$(document).off("click.selectColorConfirm").on("click.selectColorConfirm","#luckysheet-imageCtrl-colorSelect-dialog-confirm",function(){let n=$(this).parents("#luckysheet-imageCtrl-colorSelect-dialog");$("#luckysheet-modal-dialog-mask").hide(),n.hide();let t=n.find(".currenColor span").attr("title");$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span").css("background-color",t).attr("title",t),e.configChange("border-color",t)}),$("#luckysheet-image-showBoxs").off("mousedown.active").on("mousedown.active",".luckysheet-modal-dialog-image",function(n){if(!Tt(f.currentSheetIndex,"editObjects",!1))return;$(this).hide();let t=$(this).attr("id");e.currentImgId!=null&&e.currentImgId!=t&&e.cancelActiveImgItem(),e.currentImgId=t;let l=e.images[t],o=e.getImgItemParam(l),a=o.width*f.zoomRatio,s=o.height*f.zoomRatio,u=o.left*f.zoomRatio,h=o.top*f.zoomRatio,d=o.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:a,height:s,left:u,top:h,position:d});let m=f.toJsonOptions&&f.toJsonOptions.imageUrlHandle,p=typeof m=="function"?m(l.src):l.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+p+")","background-size":l.default.width*f.zoomRatio+"px "+l.default.height*f.zoomRatio+"px","background-position":-l.crop.offsetLeft*f.zoomRatio+"px "+-l.crop.offsetTop*f.zoomRatio+"px"}),$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css({"border-width":l.border.width*f.zoomRatio,"border-style":l.border.style,"border-color":l.border.color,"border-radius":l.border.radius*f.zoomRatio,left:-l.border.width*f.zoomRatio,right:-l.border.width*f.zoomRatio,top:-l.border.width*f.zoomRatio,bottom:-l.border.width*f.zoomRatio}),e.sliderHtmlShow(),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.move").on("mousedown.move",".luckysheet-modal-dialog-content",function(n){if(!Tt(f.currentSheetIndex,"editObjects",!1))return;$("#luckysheet-modal-dialog-slider-imageCtrl").is(":visible")||e.sliderHtmlShow(),e.move=!0,e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight;let t=$("#luckysheet-modal-dialog-activeImage").offset();e.moveXY=[n.pageX-t.left,n.pageY-t.top],Xn(!0),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.resize").on("mousedown.resize",".luckysheet-modal-dialog-resize-item",function(n){if(!Tt(f.currentSheetIndex,"editObjects",!1))return;e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.resize=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=ut(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t,u=$("#luckysheet-modal-dialog-activeImage").position(),h=$("#luckysheet-modal-dialog-activeImage").width(),d=$("#luckysheet-modal-dialog-activeImage").height();e.resizeXY=[a,s,h,d,u.left+l,u.top+t,l,t],Xn(!0),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.croppingEnter").on("mousedown.croppingEnter",".luckysheet-modal-controll-crop",function(n){e.croppingEnter(),n.stopPropagation()}),$("#luckysheet-modal-dialog-cropping").off("mousedown.croppingExit").on("mousedown.croppingExit",".luckysheet-modal-controll-crop",function(n){e.croppingExit(),n.stopPropagation()}),$("#luckysheet-modal-dialog-cropping").off("mousedown.cropChange").on("mousedown.cropChange",".resize-item",function(n){e.cropChange=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=ut(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t;e.cropChangeXY=[a,s],Xn(!0),n.stopPropagation()}),$("#luckysheet-image-showBoxs").off("mousedown.restore").on("mousedown.restore",".luckysheet-modal-controll-restore",function(n){e.restoreImgItem(),n.stopPropagation()}),$("#luckysheet-image-showBoxs").off("mousedown.delete").on("mousedown.delete",".luckysheet-modal-controll-del",function(n){e.removeImgItem(),n.stopPropagation()})},configChange:function(e,n){let t=this,l=t.images[t.currentImgId];switch(e){case"type":l.type=n;break;case"fixedPos":l.isFixedPos=n;let o=t.getImgItemParam(l),a=o.width,s=o.height,u=o.left,h=o.top,d=o.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:a,height:s,left:u,top:h,position:d});break;case"border-width":l.border.width=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css({"border-width":n,left:-n,right:-n,top:-n,bottom:-n});break;case"border-radius":l.border.radius=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-radius",n);break;case"border-style":l.border.style=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-style",n);break;case"border-color":l.border.color=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-color",n);break}t.ref()},getImgItemParam(e){let n=e.isFixedPos,t=e.default.width,l=e.default.height,o=e.default.left,a=e.default.top;(e.crop.width!=t||e.crop.height!=l)&&(t=e.crop.width,l=e.crop.height,o+=e.crop.offsetLeft,a+=e.crop.offsetTop);let s="absolute";return n&&(s="fixed",o=e.fixedLeft+e.crop.offsetLeft,a=e.fixedTop+e.crop.offsetTop),{width:t,height:l,left:o,top:a,position:s}},cancelActiveImgItem:function(){let e=this;$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width*f.zoomRatio,o=t.height*f.zoomRatio,a=t.left*f.zoomRatio,s=t.top*f.zoomRatio,u=t.position;$("#"+e.currentImgId).show().css({width:l,height:o,left:a,top:s,position:u}),$("#"+e.currentImgId+" img").css({width:n.default.width*f.zoomRatio,height:n.default.height*f.zoomRatio,left:-n.crop.offsetLeft*f.zoomRatio,top:-n.crop.offsetTop*f.zoomRatio}),$("#"+e.currentImgId+" .luckysheet-modal-dialog-border").css({"border-width":n.border.width*f.zoomRatio,"border-style":n.border.style,"border-color":n.border.color,"border-radius":n.border.radius*f.zoomRatio,left:-n.border.width*f.zoomRatio,right:-n.border.width*f.zoomRatio,top:-n.border.width*f.zoomRatio,bottom:-n.border.width*f.zoomRatio}),e.currentImgId=null},addImgItem:function(e){let n=this,t,l,o=400;e.originHeight<e.originWidth?(l=Math.round(e.originHeight*(o/e.originWidth)),t=o):(t=Math.round(e.originWidth*(o/e.originHeight)),l=o),n.images==null&&(n.images={});let a=$.extend(!0,{},n.imgItem);a.src=e.src,a.originWidth=e.originWidth,a.originHeight=e.originHeight,a.default.width=t,a.default.height=l,a.default.left=e.left,a.default.top=e.top,a.crop.width=t,a.crop.height=l;let s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").scrollLeft();a.fixedLeft=e.left-u+f.rowHeaderWidth,a.fixedTop=e.top-s+f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight;let h=n.generateRandomId(),d=n.modelHtml(h,a);$("#luckysheet-image-showBoxs .img-list").append(d),n.images[h]=a,n.ref(),n.init()},moveImgItem:function(){let e=this;e.move=!1;let n=$("#luckysheet-modal-dialog-activeImage")[0],t=e.images[e.currentImgId];t.isFixedPos?(t.fixedLeft=n.offsetLeft-t.crop.offsetLeft,t.fixedTop=n.offsetTop-t.crop.offsetTop):(t.default.left=n.offsetLeft-t.crop.offsetLeft,t.default.top=n.offsetTop-t.crop.offsetTop),e.ref()},resizeImgItem:function(){let e=this;e.resize=null;let n=$("#luckysheet-modal-dialog-activeImage")[0],t=e.images[e.currentImgId],l=n.clientWidth/t.crop.width,o=n.clientHeight/t.crop.height;t.default.width=Math.round(t.default.width*l),t.default.height=Math.round(t.default.height*o),t.crop.width=Math.round(t.crop.width*l),t.crop.height=Math.round(t.crop.height*o),t.crop.offsetLeft=Math.round(t.crop.offsetLeft*l),t.crop.offsetTop=Math.round(t.crop.offsetTop*o),t.isFixedPos?(t.fixedLeft=n.offsetLeft,t.fixedTop=n.offsetTop):(t.default.left=n.offsetLeft-t.crop.offsetLeft,t.default.top=n.offsetTop-t.crop.offsetTop),e.ref()},croppingEnter:function(){let e=this;if(e.cropping=!0,!Tt(f.currentSheetIndex,"editObjects",!1))return;$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-cropping").show().css({width:l,height:o,left:a,top:s,position:u});let h=f.toJsonOptions&&f.toJsonOptions.imageUrlHandle,d=typeof h=="function"?h(n.src):n.src;$("#luckysheet-modal-dialog-cropping .cropping-mask").css({width:n.default.width,height:n.default.height,"background-image":"url("+d+")",left:-n.crop.offsetLeft,top:-n.crop.offsetTop}),$("#luckysheet-modal-dialog-cropping .cropping-content").css({"background-image":"url("+d+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"}),$("#luckysheet-modal-dialog-cropping .luckysheet-modal-dialog-border").css({"border-width":n.border.width,"border-style":n.border.style,"border-color":n.border.color,"border-radius":n.border.radius,left:-n.border.width,right:-n.border.width,top:-n.border.width,bottom:-n.border.width})},croppingExit:function(){let e=this;e.cropping=!1,$("#luckysheet-modal-dialog-cropping").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:l,height:o,left:a,top:s,position:u});let h=f.toJsonOptions&&f.toJsonOptions.imageUrlHandle,d=typeof h=="function"?h(n.src):n.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+d+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"})},cropChangeImgItem:function(){let e=this;e.cropChange=null;let n=e.images[e.currentImgId];n.crop.width=e.cropChangeObj.width,n.crop.height=e.cropChangeObj.height,n.crop.offsetLeft=e.cropChangeObj.offsetLeft,n.crop.offsetTop=e.cropChangeObj.offsetTop,e.ref()},restoreImgItem:function(){let e=this,n=e.images[e.currentImgId];n.default.width=n.originWidth,n.default.height=n.originHeight,n.crop.width=n.originWidth,n.crop.height=n.originHeight,n.crop.offsetLeft=0,n.crop.offsetTop=0;let t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:l,height:o,left:a,top:s,position:u});let h=f.toJsonOptions&&f.toJsonOptions.imageUrlHandle,d=typeof h=="function"?h(n.src):n.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+d+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"}),e.ref()},removeImgItem:function(){let e=this,n=e.images[e.currentImgId];!Je.createHookFunction("imageDeleteBefore",n)||($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),$("#"+e.currentImgId).remove(),delete e.images[e.currentImgId],e.currentImgId=null,Je.createHookFunction("imageDeleteAfter",n),e.ref())},copyImgItem:function(e){let n=this;n.copyImgItemObj=$.extend(!0,{},n.images[n.currentImgId]);let t=window.clipboardData;t||(t=e.originalEvent.clipboardData);let l='<table data-type="luckysheet_copy_action_image"><tr><td><td></tr></table>';if(t)return t.setData("Text",l),!1;{let o=$("#luckysheet-copy-content");o.html(l),o.focus(),o.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#luckysheet-copy-content").blur()},10)}},pasteImgItem:function(){let e=this;e.images==null&&(e.images={});let n=f.luckysheet_select_save[0].row_focus||0,t=f.luckysheet_select_save[0].column_focus||0,l=t==0?0:f.visibledatacolumn[t-1],o=n==0?0:f.visibledatarow[n-1],a=$.extend(!0,{},e.copyImgItemObj);a.default.left=l-a.crop.offsetLeft,a.default.top=o-a.crop.offsetTop;let s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").scrollLeft();a.fixedLeft=a.default.left-u+f.rowHeaderWidth,a.fixedTop=a.default.top-s+f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight;let h=e.generateRandomId(),d=e.modelHtml(h,a);$("#luckysheet-image-showBoxs .img-list").append(d),e.images[h]=a,e.ref(),e.init()},allImagesShow:function(){let e=this;if($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),$("#luckysheet-image-showBoxs .img-list").empty(),e.images!=null)for(let n in e.images){let t=e.images[n],l=e.modelHtml(n,t);$("#luckysheet-image-showBoxs .img-list").append(l)}},moveChangeSize:function(e,n,t){let l=this,o=$.extend(!0,{},l.images);if(e=="row"){let a=f.visibledatarow[n],s=n-1==-1?0:f.visibledatarow[n-1],u=t-(a-s-1);for(let h in o){let d=o[h],m=l.getImgItemParam(d),p=d.type;if(p=="1"){if(m.top>=a)d.default.top=m.top+u-d.crop.offsetTop;else if(m.top+m.height>=a-2)if(m.top<a+u){let v=(m.height+u)/m.height;d.default.height=Math.round(d.default.height*v),d.crop.height=Math.round(d.crop.height*v),d.crop.offsetTop=Math.round(d.crop.offsetTop*v)}else{let v=(m.top+m.height-a)/m.height;d.default.height=Math.round(d.default.height*v),d.crop.height=Math.round(d.crop.height*v),d.crop.offsetTop=Math.round(d.crop.offsetTop*v),d.default.top=a+u-d.crop.offsetTop}else if(m.top>a+u){let v=1/m.height;d.default.height=Math.round(d.default.height*v),d.crop.height=Math.round(d.crop.height*v),d.crop.offsetTop=Math.round(d.crop.offsetTop*v),d.default.top=a+u-d.crop.offsetTop}else if(m.top+m.height>a+u){let v=(a+u-m.top)/m.height;d.default.height=Math.round(d.default.height*v),d.crop.height=Math.round(d.crop.height*v),d.crop.offsetTop=Math.round(d.crop.offsetTop*v)}}else p=="2"&&(m.top>=a?d.default.top=m.top+u-d.crop.offsetTop:m.top>a+u&&(d.default.top=a+u-d.crop.offsetTop))}}else if(e=="column"){let a=f.visibledatacolumn[n],s=n-1==-1?0:f.visibledatacolumn[n-1],u=t-(a-s-1);for(let h in o){let d=o[h],m=l.getImgItemParam(d),p=d.type;if(p=="1"){if(m.left>=a)d.default.left=m.left+u-d.crop.offsetLeft;else if(m.left+m.width>=a-2)if(m.left<a+u){let v=(m.width+u)/m.width;d.default.width=Math.round(d.default.width*v),d.crop.width=Math.round(d.crop.width*v),d.crop.offsetLeft=Math.round(d.crop.offsetLeft*v)}else{let v=(m.left+m.width-a)/m.width;d.default.width=Math.round(d.default.width*v),d.crop.width=Math.round(d.crop.width*v),d.crop.offsetLeft=Math.round(d.crop.offsetLeft*v),d.default.left=a+u-d.crop.offsetLeft}else if(m.left>a+u){let v=1/m.width;d.default.width=Math.round(d.default.width*v),d.crop.width=Math.round(d.crop.width*v),d.crop.offsetLeft=Math.round(d.crop.offsetLeft*v),d.default.left=a+u-d.crop.offsetLeft}else if(m.left+m.width>a+u){let v=(a+u-m.left)/m.width;d.default.width=Math.round(d.default.width*v),d.crop.width=Math.round(d.crop.width*v),d.crop.offsetLeft=Math.round(d.crop.offsetLeft*v)}}else p=="2"&&(m.left>=a?d.default.left=m.left+u-d.crop.offsetLeft:m.left>a+u&&(d.default.left=a+u-d.crop.offsetLeft))}}return o},ref:function(){let e=this,n=f.luckysheetfile[Z(f.currentSheetIndex)],t=e.images;f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"imageCtrl",sheetIndex:f.currentSheetIndex,images:n.images==null?null:$.extend(!0,{},n.images),curImages:t})),n.images=$.extend(!0,{},t),ne.saveParam("all",f.currentSheetIndex,n.images,{k:"images"})}},Ie=Ns});function mv(e){var n=/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/;if(n.test(e)){if(e.length==18){for(var t=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),l=new Array(1,0,10,9,8,7,6,5,4,3,2),o=0,a=0;a<17;a++)o+=e.substring(a,a+1)*t[a];var s=o%11,u=e.substring(17);return s==2?u=="X"||u=="x":u==l[s]}}else return!1}var dv,Ye,gr=Me(()=>{ht();Ut();Nt();Lr();Yt();ll();$r();Kt();Jt();Wt();Zt();Qt();ol();dl();Et();kt();Ke();dv={defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1,optionLabel:{number:"\u6570\u503C",number_integer:"\u6574\u6570",number_decimal:"\u5C0F\u6570",bw:"\u4ECB\u4E8E",nb:"\u4E0D\u4ECB\u4E8E",eq:"\u7B49\u4E8E",ne:"\u4E0D\u7B49\u4E8E",gt:"\u5927\u4E8E",lt:"\u5C0F\u4E8E",gte:"\u5927\u4E8E\u7B49\u4E8E",lte:"\u5C0F\u4E8E\u7B49\u4E8E",include:"\u5305\u62EC",exclude:"\u4E0D\u5305\u62EC",equal:"\u7B49\u4E8E",bf:"\u65E9\u4E8E",nbf:"\u4E0D\u65E9\u4E8E",af:"\u665A\u4E8E",naf:"\u4E0D\u665A\u4E8E",card:"\u8EAB\u4EFD\u8BC1\u53F7\u7801",phone:"\u624B\u673A\u53F7"},optionLabel_en:{number:"numeric",number_integer:"integer",number_decimal:"decimal",bw:"between",nb:"not between",eq:"equal to",ne:"not equal to",gt:"greater",lt:"less than",gte:"greater or equal to",lte:"less than or equal to",include:"include",exclude:"not include",equal:"equal to",bf:"earlier than",nbf:"not earlier than",af:"later than",naf:"not later than",card:"identification number",phone:"phone number"},createDialog:function(){let e=this,n=Q(),t=n.dataVerification,l=n.toolbar,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").remove();let a=`<div class="box">
                            <div class="box-item" style="border-top:1px solid #E1E4E8;">
                                <div class="box-item-title">${t.cellRange}</div>
                                <div id="data-verification-range" class="range">
                                    <input class="formulaInputFocus" spellcheck="false">
                                    <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                                </div>
                            </div>
                            <div class="box-item">
                                <div class="box-item-title">${t.verificationCondition}</div>
                                <select id="data-verification-type-select">
                                    <option value="dropdown">${t.dropdown}</option>
                                    <option value="checkbox">${t.checkbox}</option>
                                    <option value="number">${t.number}</option>
                                    <option value="number_integer">${t.number_integer}</option>
                                    <option value="number_decimal">${t.number_decimal}</option>
                                    <option value="text_content">${t.text_content}</option>
                                    <option value="text_length">${t.text_length}</option>
                                    <option value="date">${t.date}</option>
                                    <option value="validity">${t.validity}</option>
                                </select>
                                <div class="show-box">
                                    <div class="show-box-item show-box-item-dropdown">
                                        <div class="range">
                                            <input class="formulaInputFocus data-verification-value1" placeholder="${t.placeholder1}" spellcheck="false">
                                            <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                                        </div>
                                        <div class="multi">
                                            <input type="checkbox" id="data-verification-multi" class="data-verification-multi">
                                            <label for="data-verification-multi">${t.allowMultiSelect}</label>
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-checkbox">
                                        <div class="check-box">
                                            <span>${t.selected} \u2014\u2014</span>
                                            <input type="text" class="data-verification-value1" placeholder="${t.placeholder2}">
                                        </div>
                                        <div class="check-box">
                                            <span>${t.notSelected} \u2014\u2014</span>
                                            <input type="text" class="data-verification-value2" placeholder="${t.placeholder2}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-number">
                                        <select id="data-verification-number-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="gt">${t.moreThanThe}</option>
                                            <option value="lt">${t.lessThan}</option>
                                            <option value="gte">${t.greaterOrEqualTo}</option>
                                            <option value="lte">${t.lessThanOrEqualTo}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="number" class="data-verification-value1" placeholder="1">
                                            <span>-</span>
                                            <input type="number" class="data-verification-value2" placeholder="100">
                                        </div>
                                        <div class="input input2">
                                            <input type="number" class="data-verification-value1" placeholder="${t.placeholder3}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-text">
                                        <select id="data-verification-text-select">
                                            <option value="include">${t.include}</option>
                                            <option value="exclude">${t.exclude}</option>
                                            <option value="equal">${t.equal}</option>
                                        </select>
                                        <div class="input input2">
                                            <input type="text" class="data-verification-value1" placeholder="${t.placeholder4}"/>
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-textLength">
                                        <select id="data-verification-textLength-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="gt">${t.moreThanThe}</option>
                                            <option value="lt">${t.lessThan}</option>
                                            <option value="gte">${t.greaterOrEqualTo}</option>
                                            <option value="lte">${t.lessThanOrEqualTo}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="number" class="data-verification-value1" placeholder="1">
                                            <span>-</span>
                                            <input type="number" class="data-verification-value2" placeholder="100">
                                        </div>
                                        <div class="input input2">
                                            <input type="number" class="data-verification-value1" placeholder="${t.placeholder3}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-date">
                                        <select id="data-verification-date-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="bf">${t.earlierThan}</option>
                                            <option value="nbf">${t.noEarlierThan}</option>
                                            <option value="af">${t.laterThan}</option>
                                            <option value="naf">${t.noLaterThan}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">
                                            <span>-</span>
                                            <input type="date" class="data-verification-value2" placeholder="2020/9/10">
                                        </div>
                                        <div class="input input2">
                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-validity">
                                        <select id="data-verification-validity-select">
                                            <option value="card">${t.identificationNumber}</option>
                                            <option value="phone">${t.phoneNumber}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="box-item">
                                <div class="check">
                                    <input type="checkbox" id="data-verification-remote" class="data-verification-remote">
                                    <label for="data-verification-remote">${t.remote}</label>
                                </div>
                                <div class="check">
                                    <input type="checkbox" id="data-verification-prohibitInput">
                                    <label for="data-verification-prohibitInput">${t.prohibitInput}</label>
                                </div>
                                <div class="check">
                                    <input type="checkbox" id="data-verification-hint-show">
                                    <label for="data-verification-hint-show">${t.hintShow}</label>
                                </div>
                                <div class="data-verification-hint-text">
                                    <input type="text" placeholder="${t.placeholder5}">
                                </div>
                            </div>
                        </div>`;$("body").append(_e(dt,{id:"luckysheet-dataVerification-dialog",addclass:"luckysheet-dataVerification-dialog",title:l.dataVerification,content:a,botton:`<button id="luckysheet-dataVerification-dialog-confirm" class="btn btn-primary">${o.confirm}</button>
                        <button id="luckysheet-dataVerification-dialog-delete" class="btn btn-default">${t.deleteVerification}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"}));let s=$("#luckysheet-dataVerification-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),u=s.outerHeight(),h=s.outerWidth(),d=$(window).width(),m=$(window).height(),p=$(document).scrollLeft(),v=$(document).scrollTop();$("#luckysheet-dataVerification-dialog").css({left:(d+p-h)/2,top:(m+v-u)/3}).show(),e.dataAllocation()},init:function(){let e=this,n=Q().dataVerification;$(document).off("click.dropdownBtn").on("click.dropdownBtn","#luckysheet-dataVerification-dropdown-btn",function(t){e.dropdownListShow(),t.stopPropagation()}),$(document).off("click.dropdownListItem").on("click.dropdownListItem","#luckysheet-dataVerification-dropdown-List .dropdown-List-item",function(t){var l=$(this);let o=t.target.innerText;l.hasClass("multi")?(l.toggleClass("checked"),o=$.map($("#luckysheet-dataVerification-dropdown-List").children().filter(".checked"),function(h){return h.innerText}).join(",")):$("#luckysheet-dataVerification-dropdown-List").hide();let a=f.luckysheet_select_save[f.luckysheet_select_save.length-1],s=a.row_focus,u=a.column_focus;$("#luckysheet-rich-text-editor").text(o),g.updatecell(s,u),t.stopPropagation()}),$(document).off("click.dvRange").on("click.dvRange","#data-verification-range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();let l="0",o=$(this).siblings("input").val().trim();e.rangeDialog(l,o),e.selectRange=[];let a=e.getRangeByTxt(o);if(g.rangetosheet=f.currentSheetIndex,a[0].sheetIndex!=f.currentSheetIndex&&ye.changeSheetExec(a[0].sheetIndex),a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],h=a[s].row[1],d=a[s].column[0],m=a[s].column[1],p=f.visibledatarow[h],v=u-1==-1?0:f.visibledatarow[u-1],y=f.visibledatacolumn[m],k=d-1==-1?0:f.visibledatacolumn[d-1];e.selectRange.push({left:k,width:y-k-1,top:v,height:p-v-1,left_move:k,width_move:y-k-1,top_move:v,height_move:p-v-1,row:[u,h],column:[d,m],row_focus:u,column_focus:d})}Pt(e.selectRange)}),$(document).off("click.dvRange2").on("click.dvRange2","#luckysheet-dataVerification-dialog .show-box-item-dropdown .range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();let l="1",o=$(this).siblings("input").val().trim();e.rangeDialog(l,o),e.selectRange=[];let a=e.getRangeByTxt(o);if(g.rangetosheet=f.currentSheetIndex,a[0].sheetIndex!=f.currentSheetIndex&&ye.changeSheetExec(a[0].sheetIndex),a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],h=a[s].row[1],d=a[s].column[0],m=a[s].column[1],p=f.visibledatarow[h],v=u-1==-1?0:f.visibledatarow[u-1],y=f.visibledatacolumn[m],k=d-1==-1?0:f.visibledatacolumn[d-1];e.selectRange.push({left:k,width:y-k-1,top:v,height:p-v-1,left_move:k,width_move:y-k-1,top_move:v,height_move:p-v-1,row:[u,h],column:[d,m],row_focus:u,column_focus:d})}Pt(e.selectRange)}),$(document).off("click.dvRangeConfirm").on("click.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(t){let l=$(this).attr("data-source"),o=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val();if(e.getRangeByTxt(o).length>1){W.info('<i class="fa fa-exclamation-triangle"></i>',"\u4E0D\u80FD\u5BF9\u591A\u91CD\u9009\u62E9\u533A\u57DF\u6267\u884C\u6B64\u64CD\u4F5C\uFF0C\u8BF7\u9009\u62E9\u5355\u4E2A\u533A\u57DF\uFF0C\u7136\u540E\u518D\u8BD5");return}l=="0"?$("#luckysheet-dataVerification-dialog #data-verification-range input").val(o):l=="1"&&$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .range input").val(o),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),g.rangetosheet!=null&&g.rangetosheet!=f.currentSheetIndex&&(ye.changeSheetExec(g.rangetosheet),g.rangetosheet=null),Pt([])}),$(document).off("click.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(t){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),g.rangetosheet!=null&&g.rangetosheet!=f.currentSheetIndex&&(ye.changeSheetExec(g.rangetosheet),g.rangetosheet=null),Pt([])}),$(document).on("click","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(t){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),g.rangetosheet!=null&&g.rangetosheet!=f.currentSheetIndex&&(ye.changeSheetExec(g.rangetosheet),g.rangetosheet=null),Pt([])}),$(document).off("change.typeSelect").on("change.typeSelect","#data-verification-type-select",function(t){$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide();let l=this.value,o=e.curItem;if(l=="dropdown"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show();let a="";l==o.type&&(a=o.value1),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(a),$("#luckysheet-dataVerification-dialog #data-verification-multi").prop("checked",!!o.type2)}else if(l=="checkbox"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show();let a="",s="";l==o.type&&(a=o.value1,s=o.value2),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(a),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(s)}else if(l=="number"||l=="number_integer"||l=="number_decimal"){$("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();let a="bw",s="",u="";(o.type=="number"||o.type=="number_integer"||o.type=="number_decimal")&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(u)}else if(l=="text_content"){$("#luckysheet-dataVerification-dialog .show-box-item-text").show();let a="include",s="";l==o.type&&(a=o.type2,s=o.value1),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(a),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(s)}else if(l=="text_length"){$("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide();let a="bw",s="",u="";l==o.type&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(u)}else if(l=="date"){$("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();let a="bw",s="",u="";l==o.type&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(u)}else if(l=="validity"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show();let a="card";l==o.type&&(a=o.type2),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(a)}}),$(document).off("change.numberSelect").on("change.numberSelect","#data-verification-number-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show()}),$(document).off("change.textLengthSelect").on("change.textLengthSelect","#data-verification-textLength-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show()}),$(document).off("change.dateSelect").on("change.dateSelect","#data-verification-date-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show()}),$(document).off("change.hintShow").on("change.hintShow","#data-verification-hint-show",function(t){this.checked?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide()}),$(document).off("click.dvSaveConfirm").on("click.dvSaveConfirm","#luckysheet-dataVerification-dialog-confirm",function(t){let l=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),o=e.getRangeByTxt(l);if(o.length==0){W.info('<i class="fa fa-exclamation-triangle"></i>',n.selectCellRange2);return}let a=o[o.length-1].row[0],s=o[o.length-1].row[1],u=o[o.length-1].column[0],h=o[o.length-1].column[1],d=xe.deepCopyFlowData(f.flowdata);a<0&&(a=0),s>d.length-1&&(s=d.length-1),u<0&&(u=0),h>d[0].length-1&&(h=d[0].length-1);let m=$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(),p=null,v="",y="";if(m=="dropdown"){if(v=$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val().trim(),v.length==0){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo1);return}p=$("#luckysheet-dataVerification-dialog #data-verification-multi").is(":checked")}else if(m=="checkbox"){if(v=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val().trim(),y=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val().trim(),v.length==0||y.length==0){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo2);return}}else if(m=="number"||m=="number_integer"||m=="number_decimal"){if(p=$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(),v=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value1").val().trim(),!B(v)){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(p=="bw"||p=="nb"){if(y=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value2").val().trim(),!B(y)){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(Number(y)<Number(v)){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo4);return}}}else if(m=="text_content"){if(p=$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(),v=$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val().trim(),v.length==0){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo5);return}}else if(m=="text_length"){if(p=$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(),v=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value1").val().trim(),!B(v)){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(!Number.isInteger(Number(v))||Number(v)<0){W.info('<i class="fa fa-exclamation-triangle"></i>',n.textlengthInteger);return}if(p=="bw"||p=="nb"){if(y=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value2").val().trim(),!B(y)){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(!Number.isInteger(Number(y))||Number(y)<0){W.info('<i class="fa fa-exclamation-triangle"></i>',n.textlengthInteger);return}if(Number(y)<Number(v)){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo4);return}}}else if(m=="date"){if(p=$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(),v=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value1").val().trim(),!zt(v)){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo6);return}if(p=="bw"||p=="nb"){if(y=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value2").val().trim(),!zt(y)){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo6);return}if(ul(v,y)>0){W.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo7);return}}}else m=="validity"&&(p=$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val());let k=$("#luckysheet-dataVerification-dialog #data-verification-remote").is(":checked"),b=$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").is(":checked"),w=$("#luckysheet-dataVerification-dialog #data-verification-hint-show").is(":checked"),x="";w&&(x=$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val().trim());let C={type:m,type2:p,value1:v,value2:y,checked:!1,remote:k,prohibitInput:b,hintShow:w,hintText:x},S=$.extend(!0,{},e.dataVerification),_=$.extend(!0,{},e.dataVerification);for(let T=a;T<=s;T++)for(let F=u;F<=h;F++)_[T+"_"+F]=C,m=="checkbox"&&Ht(T,F,d,C.value2);m=="checkbox"?e.refOfCheckbox(S,_,f.currentSheetIndex,d,o[o.length-1]):e.ref(S,_,f.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}),$(document).off("click.delete").on("click.delete","#luckysheet-dataVerification-dialog-delete",function(t){let l=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),o=e.getRangeByTxt(l);if(o.length==0){W.info('<i class="fa fa-exclamation-triangle"></i>',n.selectCellRange2);return}let a=$.extend(!0,{},e.dataVerification),s=$.extend(!0,{},e.dataVerification),u=o[o.length-1].row[0],h=o[o.length-1].row[1],d=o[o.length-1].column[0],m=o[o.length-1].column[1];for(let p=u;p<=h;p++)for(let v=d;v<=m;v++)delete s[p+"_"+v];e.ref(a,s,f.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}),$(document).on("click","#luckysheet-info .luckysheet-modal-dialog-title-close, #luckysheet-info .luckysheet-model-close-btn",function(t){$(this).parents("#luckysheet-info").hide(),$("#luckysheet-dataVerification-dialog").is(":visible")&&$("#luckysheet-modal-dialog-mask").show(),t.stopPropagation()})},dataAllocation:function(){let e=this,n=f.luckysheet_select_save[f.luckysheet_select_save.length-1],t=Mt(f.currentSheetIndex,n,f.currentSheetIndex);$("#luckysheet-dataVerification-dialog #data-verification-range input").val(t);let l=n.row_focus||n.row[0],o=n.column_focus||n.column[0],s=$.extend(!0,{},e.dataVerification)[l+"_"+o];s==null&&(s=$.extend(!0,{},e.defaultItem)),e.curItem=s,$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(s.type),$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide(),s.type=="dropdown"?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show(),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog #data-verification-multi").prop("checked",!!s.type2)):s.type=="checkbox"?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show(),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(s.value2)):s.type=="number"||s.type=="number_integer"||s.type=="number_decimal"?($("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(s.value2)):s.type=="text_content"?($("#luckysheet-dataVerification-dialog .show-box-item-text").show(),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(s.value1)):s.type=="text_length"?($("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(s.value2)):s.type=="date"?($("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(s.value2)):s.type=="validity"&&($("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show(),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(s.type2)),$("#luckysheet-dataVerification-dialog #data-verification-remote").prop("checked",s.remote),$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").prop("checked",s.prohibitInput),$("#luckysheet-dataVerification-dialog #data-verification-hint-show").prop("checked",s.hintShow),s.hintShow?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide(),$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val(s.hintText)},rangeDialog:function(e,n){let t=this,l=Q(),o=l.dataVerification,a=l.button;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerificationRange-dialog").remove(),$("body").append(_e(dt,{id:"luckysheet-dataVerificationRange-dialog",addclass:"luckysheet-dataVerificationRange-dialog",title:o.selectCellRange,content:`<input readonly="readonly" placeholder="${o.selectCellRange2}" value="${n}"/>`,botton:`<button id="luckysheet-dataVerificationRange-dialog-confirm" class="btn btn-primary" data-source="${e}">${a.confirm}</button>
                        <button id="luckysheet-dataVerificationRange-dialog-close" class="btn btn-default">${a.close}</button>`,style:"z-index:100003"}));let s=$("#luckysheet-dataVerificationRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),u=s.outerHeight(),h=s.outerWidth(),d=$(window).width(),m=$(window).height(),p=$(document).scrollLeft(),v=$(document).scrollTop();$("#luckysheet-dataVerificationRange-dialog").css({left:(d+p-h)/2,top:(m+v-u)/3}).show()},getTxtByRange:function(e){if(e.length>0){let n=[];for(let t=0;t<e.length;t++){let l=e[t].row[0],o=e[t].row[1],a=e[t].column[0],s=e[t].column[1];n.push(Mt(f.currentSheetIndex,{row:[l,o],column:[a,s]},f.currentSheetIndex))}return n.join(",")}},getRangeByTxt:function(e){let n=[];if(e.indexOf(",")!=-1){let t=e.split(",");for(let l=0;l<t.length;l++)if(g.iscelldata(t[l]))n.push(g.getcellrange(t[l]));else{n=[];break}}else g.iscelldata(e)&&n.push(g.getcellrange(e));return n},cellFocus:function(e,n,t){$("#luckysheet-dataVerification-dropdown-btn").hide(),$("#luckysheet-dataVerification-showHintBox").hide();let l=this;if(l.dataVerification==null||l.dataVerification[e+"_"+n]==null){$("#luckysheet-dataVerification-dropdown-List").hide();return}let o=f.visibledatarow[e],a=e==0?0:f.visibledatarow[e-1],s=f.visibledatacolumn[n],u=n==0?0:f.visibledatacolumn[n-1],h=be.mergeborer(f.flowdata,e,n);h&&(o=h.row[1],a=h.row[0],s=h.column[1],u=h.column[0]);let d=l.dataVerification[e+"_"+n];if(t&&d.type=="checkbox"){l.checkboxChange(e,n);return}if(d.type=="dropdown"?($("#luckysheet-dataVerification-dropdown-btn").show().css({"max-width":s-u,"max-height":o-a,left:s-20,top:a+(o-a-20)/2}),$("#luckysheet-dataVerification-dropdown-List").is(":visible")&&$("#luckysheet-dataVerification-dropdown-List").prop("data-index")!=e+"_"+n&&$("#luckysheet-dataVerification-dropdown-List").hide()):$("#luckysheet-dataVerification-dropdown-List").hide(),d.hintShow){let v;f.lang=="en"?v='<span style="color:#f5a623;">Hint: </span>':v='<span style="color:#f5a623;">\u63D0\u793A\uFF1A</span>',v+=l.getHintText(d),$("#luckysheet-dataVerification-showHintBox").html(v).show().css({left:u,top:o});return}let m=Le(e,n,null);if(me(m))return;if(!l.validateCellData(m,d)){let v;f.lang=="en"?v='<span style="color:#f72626;">Failure: </span>':v='<span style="color:#f72626;">\u5931\u6548\uFF1A</span>',v+=l.getFailureText(d),$("#luckysheet-dataVerification-showHintBox").html(v).show().css({left:u,top:o})}},getHintText:function(e){let n=this,t=e.hintText||"";return t.length==0&&(f.lang=="en"?e.type=="dropdown"?t+="please select an option in the drop-down list":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="please enter a "+n.optionLabel_en[e.type]+" "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="text_content"?t+="please enter text "+n.optionLabel_en[e.type2]+" "+e.value1:e.type=="text_length"?(t+="please enter text with length "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="date"?(t+="please enter a date "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="validity"&&(t+="please enter the correct "+n.optionLabel_en[e.type2])):e.type=="dropdown"?t+="\u8BF7\u9009\u62E9\u4E0B\u62C9\u5217\u8868\u4E2D\u7684\u9009\u9879":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="\u8BF7\u8F93\u5165"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684"+n.optionLabel[e.type]):e.type=="text_content"?t+="\u8BF7\u8F93\u5165\u5185\u5BB9"+n.optionLabel[e.type2]+e.value1+"\u7684\u6587\u672C":e.type=="text_length"?(t+="\u8BF7\u8F93\u5165\u957F\u5EA6"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u6587\u672C"):e.type=="date"?(t+="\u8BF7\u8F93\u5165"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u65E5\u671F"):e.type=="validity"&&(t+="\u8BF7\u8F93\u5165\u6B63\u786E\u7684"+n.optionLabel[e.type2]))),t},getFailureText:function(e){let n=this,t="";return f.lang=="en"?e.type=="dropdown"?t+="what you selected is not an option in the drop-down list":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="what you entered is not a "+n.optionLabel_en[e.type]+" "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="text_content"?t+="what you entered is not text that "+n.optionLabel_en[e.type2]+" "+e.value1:e.type=="text_length"?(t+="the text you entered is not length "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="date"?(t+="the date you entered is not "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="validity"&&(t+="what you entered is not a correct "+n.optionLabel_en[e.type2])):e.type=="dropdown"?t+="\u4F60\u9009\u62E9\u7684\u4E0D\u662F\u4E0B\u62C9\u5217\u8868\u4E2D\u7684\u9009\u9879":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684"+n.optionLabel[e.type]):e.type=="text_content"?t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u5185\u5BB9"+n.optionLabel[e.type2]+e.value1+"\u7684\u6587\u672C":e.type=="text_length"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u957F\u5EA6"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u6587\u672C"):e.type=="date"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u65E5\u671F"):e.type=="validity"&&(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u4E00\u4E2A\u6B63\u786E\u7684"+n.optionLabel[e.type2])),t},validateCellData:function(e,n){let t=this,l=n.type,o=n.type2,a=n.value1,s=n.value2;if(l=="dropdown"){let u=t.getDropdownList(a);if(o&&e)return e.split(",").every(function(d){return u.indexOf(d)!==-1});let h=!1;for(let d=0;d<u.length;d++)if(u[d]==e){h=!0;break}return h}else if(l!="checkbox"){if(l=="number"||l=="number_integer"||l=="number_decimal"){if(!B(e)||(e=Number(e),l=="number_integer"&&e%1!=0)||l=="number_decimal"&&e%1==0||(a=Number(a),s=Number(s),o=="bw"&&(e<a||e>s))||o=="nb"&&e>=a&&e<=s||o=="eq"&&e!=a||o=="ne"&&e==a||o=="gt"&&e<=a||o=="lt"&&e>=a||o=="gte"&&e<a||o=="lte"&&e>a)return!1}else if(l=="text_content"){if(e=e.toString(),a=a.toString(),o=="include"&&e.indexOf(a)==-1||o=="exclude"&&e.indexOf(a)>-1||o=="equal"&&e!=a)return!1}else if(l=="text_length"){if(e=e.toString().length,a=Number(a),s=Number(s),o=="bw"&&(e<a||e>s)||o=="nb"&&e>=a&&e<=s||o=="eq"&&e!=a||o=="ne"&&e==a||o=="gt"&&e<=a||o=="lt"&&e>=a||o=="gte"&&e<a||o=="lte"&&e>a)return!1}else if(l=="date"){if(!zt(e)||o=="bw"&&(ul(e,a)<0||ul(e,s)>0)||o=="nb"&&ul(e,a)>=0&&ul(e,s)<=0||o=="eq"&&ul(e,a)!=0||o=="ne"&&ul(e,a)==0||o=="bf"&&ul(e,a)>=0||o=="nbf"&&ul(e,a)<0||o=="af"&&ul(e,a)<=0||o=="naf"&&ul(e,a)>0)return!1}else if(l=="validity"&&(o=="card"&&!mv(e)||o=="phone"&&!/^1[3456789]\d{9}$/.test(e)))return!1}return!0},dropdownListShow:function(){$("#luckysheet-dataVerification-showHintBox").hide();let e=this,n=f.luckysheet_select_save[f.luckysheet_select_save.length-1],t=n.row_focus,l=n.column_focus,o=f.visibledatarow[t],a=t==0?0:f.visibledatarow[t-1],s=f.visibledatacolumn[l],u=l==0?0:f.visibledatacolumn[l-1],h=be.mergeborer(f.flowdata,t,l);h&&(o=h.row[1],a=h.row[0],s=h.column[1],u=h.column[0]);let d=e.dataVerification[t+"_"+l],m=e.getDropdownList(d.value1),p="";if(d.type==="dropdown"&&d.type2){let k=Le(t,l,null),b=me(k)?[]:k.split(",");m.forEach(w=>{p+=`<div class="dropdown-List-item  luckysheet-mousedown-cancel multi${b.indexOf(w)!==-1?" checked":""}">${w}</div>`})}else m.forEach(k=>{p+=`<div class="dropdown-List-item luckysheet-mousedown-cancel">${k}</div>`});$("#luckysheet-dataVerification-dropdown-List").html(p).prop("data-index",t+"_"+l).show().css({width:s-u-1,left:u,top:o});let v=$("#luckysheet-dataVerification-dropdown-List").outerHeight(),y=$("#luckysheet-cell-main")[0].scrollHeight;o+v>y-42-6&&$("#luckysheet-dataVerification-dropdown-List").css({top:a-v})},getDropdownList:function(e){let n=[];if(g.iscelldata(e)){let t=g.getcellrange(e),l=f.luckysheetfile[Z(t.sheetIndex)].data;for(let o=t.row[0];o<=t.row[1];o++)for(let a=t.column[0];a<=t.column[1];a++){if(l[o]==null)continue;let s=l[o][a];if(s==null||s.v==null)continue;let u=s.m||s.v;n.includes(u)||n.push(u)}}else{let t=e.split(",");for(let l=0;l<t.length;l++){let o=t[l];o.length!=0&&(n.includes(o)||n.push(o))}}return n},checkboxChange:function(e,n){let t=this,l=$.extend(!0,{},t.dataVerification),o=$.extend(!0,{},t.dataVerification),a=o[e+"_"+n];a.checked=!a.checked;let s=a.value2;a.checked&&(s=a.value1);let u=xe.deepCopyFlowData(f.flowdata);Ht(e,n,u,s),t.refOfCheckbox(l,o,f.currentSheetIndex,u,{row:[e,e],column:[n,n]})},ref:function(e,n,t){let l=this;if(f.clearjfundo){f.jfundo.length=0;let o={};o.type="updateDataVerification",o.sheetIndex=t,o.historyDataVerification=e,o.currentDataVerification=n,f.jfredo.push(o)}l.dataVerification=n,f.luckysheetfile[Z(t)].dataVerification=n,ne.allowUpdate&&ne.saveParam("all",t,n,{k:"dataVerification"}),setTimeout(function(){Be()},1)},refOfCheckbox:function(e,n,t,l,o){let a=this;if(f.clearjfundo){f.jfundo.length=0;let s={};s.type="updateDataVerificationOfCheckbox",s.sheetIndex=t,s.historyDataVerification=e,s.currentDataVerification=n,s.data=f.flowdata,s.curData=l,s.range=o,f.jfredo.push(s)}a.dataVerification=n,f.luckysheetfile[Z(t)].dataVerification=n,f.flowdata=l,xe.webWorkerFlowDataCache(f.flowdata),f.luckysheetfile[Z(t)].data=f.flowdata,ne.allowUpdate&&(ne.saveParam("all",t,n,{k:"dataVerification"}),ne.historyParam(f.flowdata,t,o)),setTimeout(function(){Be()},1)}};Ye=dv});function Tr(e,n,t,l,o){if(o=o||f.currentSheetIndex,e=="row"&&!Tt(o,"insertRows"))return;if(e=="column"&&!Tt(o,"insertColumns"))return;let a=Z(o),s=f.luckysheetfile[a],u=$.extend(!0,[],s.data);t=Math.floor(t);let h=$.extend(!0,{},s.config);h.merge==null&&(h.merge={});let d={};for(let A in h.merge){let z=h.merge[A],L=z.r,E=z.c,V=z.rs,q=z.cs;e=="row"?n<L?d[L+t+"_"+E]={r:L+t,c:E,rs:V,cs:q}:n==L&&V!=1?l=="lefttop"?d[L+t+"_"+E]={r:L+t,c:E,rs:V,cs:q}:d[L+"_"+E]={r:L,c:E,rs:V+t,cs:q}:n<L+V-1?d[L+"_"+E]={r:L,c:E,rs:V+t,cs:q}:n==L+V-1?l=="lefttop"?V==1?d[L+t+"_"+E]={r:L+t,c:E,rs:V,cs:q}:d[L+"_"+E]={r:L,c:E,rs:V+t,cs:q}:d[L+"_"+E]={r:L,c:E,rs:V,cs:q}:d[L+"_"+E]={r:L,c:E,rs:V,cs:q}:e=="column"&&(n<E?d[L+"_"+(E+t)]={r:L,c:E+t,rs:V,cs:q}:n==E&&q!=1?l=="lefttop"?d[L+"_"+(E+t)]={r:L,c:E+t,rs:V,cs:q}:d[L+"_"+E]={r:L,c:E,rs:V,cs:q+t}:n<E+q-1?d[L+"_"+E]={r:L,c:E,rs:V,cs:q+t}:n==E+q-1?l=="lefttop"?q==1?d[L+"_"+(E+t)]={r:L,c:E+t,rs:V,cs:q}:d[L+"_"+E]={r:L,c:E,rs:V,cs:q+t}:d[L+"_"+E]={r:L,c:E,rs:V,cs:q}:d[L+"_"+E]={r:L,c:E,rs:V,cs:q})}h.merge=d;let m=s.calcChain,p=[];if(m!=null&&m.length>0)for(let A=0;A<m.length;A++){let z=$.extend(!0,{},m[A]),L=z.r,E=z.c,V=z.index,q=Ll(L,E,V);if(e=="row"){let G="="+g.functionStrChange(q,"add","row",l,n,t);u[L][E]&&u[L][E].f==q&&(u[L][E].f=G),l=="lefttop"?L>=n&&(z.r+=t):l=="rightbottom"&&L>n&&(z.r+=t),p.push(z)}else if(e=="column"){let G="="+g.functionStrChange(q,"add","col",l,n,t);u[L][E]&&u[L][E].f==q&&(u[L][E].f=G),l=="lefttop"?E>=n&&(z.c+=t):l=="rightbottom"&&E>n&&(z.c+=t),p.push(z)}}let v=s.filter_select,y=s.filter,k=null;if(v!=null&&JSON.stringify(v)!="{}"){k={filter_select:null,filter:null};let A=v.row[0],z=v.row[1],L=v.column[0],E=v.column[1];if(e=="row"){if(A<n?(z==n&&l=="lefttop"||z>n)&&(z+=t):A==n?l=="lefttop"?(A+=t,z+=t):l=="rightbottom"&&z>n&&(z+=t):(A+=t,z+=t),y!=null){k.filter={};for(let V in y){let q=y[V].rowhidden,G={};for(let X in q)X=parseFloat(X),X<n?G[X]=0:X==n?l=="lefttop"?G[X+t]=0:l=="rightbottom"&&(G[X]=0):G[X+t]=0;k.filter[V]=$.extend(!0,{},y[V]),k.filter[V].rowhidden=G,k.filter[V].str=A,k.filter[V].edr=z}}}else if(e=="column"&&(L<n?(E==n&&l=="lefttop"||E>n)&&(E+=t):L==n?l=="lefttop"?(L+=t,E+=t):l=="rightbottom"&&E>n&&(E+=t):(L+=t,E+=t),y!=null)){k.filter={};for(let V in y){let q=y[V].cindex;(q==n&&l=="lefttop"||q>n)&&(q+=t),k.filter[q-L]=$.extend(!0,{},y[V]),k.filter[q-L].cindex=q,k.filter[q-L].stc=L,k.filter[q-L].edc=E}}k.filter_select={row:[A,z],column:[L,E]}}if(k!=null&&k.filter!=null){h.rowhidden==null&&(h.rowhidden={});for(let A in k.filter){let z=k.filter[A].rowhidden;for(let L in z)h.rowhidden[L]=0}}let b=s.luckysheet_conditionformat_save,w=[];if(b!=null&&b.length>0)for(let A=0;A<b.length;A++){let z=b[A].cellrange,L=[];for(let V=0;V<z.length;V++){let q=z[V].row[0],G=z[V].row[1],X=z[V].column[0],ee=z[V].column[1];e=="row"?q<n?(G==n&&l=="lefttop"||G>n)&&(G+=t):q==n?l=="lefttop"?(q+=t,G+=t):l=="rightbottom"&&G>n&&(G+=t):(q+=t,G+=t):e=="column"&&(X<n?(ee==n&&l=="lefttop"||ee>n)&&(ee+=t):X==n?l=="lefttop"?(X+=t,ee+=t):l=="rightbottom"&&ee>n&&(ee+=t):(X+=t,ee+=t)),L.push({row:[q,G],column:[X,ee]})}let E=$.extend(!0,{},b[A]);E.cellrange=L,w.push(E)}let x=s.luckysheet_alternateformat_save,C=[];if(x!=null&&x.length>0)for(let A=0;A<x.length;A++){let z=x[A].cellrange.row[0],L=x[A].cellrange.row[1],E=x[A].cellrange.column[0],V=x[A].cellrange.column[1],q=$.extend(!0,{},x[A]);e=="row"?z<n?(L==n&&l=="lefttop"||L>n)&&(L+=t):z==n?l=="lefttop"?(z+=t,L+=t):l=="rightbottom"&&L>n&&(L+=t):(z+=t,L+=t):e=="column"&&(E<n?(V==n&&l=="lefttop"||V>n)&&(V+=t):E==n?l=="lefttop"?(E+=t,V+=t):l=="rightbottom"&&V>n&&(V+=t):(E+=t,V+=t)),q.cellrange={row:[z,L],column:[E,V]},C.push(q)}let S={freezenhorizontaldata:null,freezenverticaldata:null};if(Y.freezenhorizontaldata!=null&&e=="row"){let A=Y.freezenhorizontaldata[2],z=Y.freezenhorizontaldata[1]-1;(z==n&&l=="lefttop"||z>n)&&(z+=t);let L=f.visibledatarow[z]-2-A+f.columnHeaderHeight;S.freezenhorizontaldata=[f.visibledatarow[z],z+1,A,Y.cutVolumn(f.visibledatarow,z+1),L]}else S.freezenhorizontaldata=Y.freezenhorizontaldata;if(Y.freezenverticaldata!=null&&e=="column"){let A=Y.freezenverticaldata[2],z=Y.freezenverticaldata[1]-1;(z==n&&l=="lefttop"||z>n)&&(z+=t);let L=f.visibledatacolumn[z]-2-A+f.rowHeaderWidth;S.freezenverticaldata=[f.visibledatacolumn[z],z+1,A,Y.cutVolumn(f.visibledatacolumn,z+1),L]}else S.freezenverticaldata=Y.freezenverticaldata;let _=s.dataVerification,T={};if(_!=null)for(let A in _){let z=Number(A.split("_")[0]),L=Number(A.split("_")[1]),E=_[A];if(e=="row")if(n<z)T[z+t+"_"+L]=E;else if(n==z)if(l=="lefttop"){T[z+t+"_"+L]=E;for(let V=0;V<t;V++)T[z+V+"_"+L]=E}else{T[z+"_"+L]=E;for(let V=0;V<t;V++)T[z+V+1+"_"+L]=E}else T[z+"_"+L]=E;else if(e=="column")if(n<L)T[z+"_"+(L+t)]=E;else if(n==L)if(l=="lefttop"){T[z+"_"+(L+t)]=E;for(let V=0;V<t;V++)T[z+"_"+(L+V)]=E}else{T[z+"_"+L]=E;for(let V=0;V<t;V++)T[z+"_"+(L+V+1)]=E}else T[z+"_"+L]=E}let F=s.hyperlink,R={};if(F!=null)for(let A in F){let z=Number(A.split("_")[0]),L=Number(A.split("_")[1]),E=F[A];e=="row"?n<z||n==z&&l=="lefttop"?R[z+t+"_"+L]=E:R[z+"_"+L]=E:e=="column"&&(n<L||n==L&&l=="lefttop"?R[z+"_"+(L+t)]=E:R[z+"_"+L]=E)}let I;if(e=="row"){if(I="r",h.rowlen!=null){let L={};for(let E in h.rowlen)E=parseFloat(E),E<n?L[E]=h.rowlen[E]:E==n?l=="lefttop"?L[E+t]=h.rowlen[E]:l=="rightbottom"&&(L[E]=h.rowlen[E]):L[E+t]=h.rowlen[E];h.rowlen=L}if(h.rowhidden!=null){let L={};for(let E in h.rowhidden)E=parseFloat(E),E<n?L[E]=h.rowhidden[E]:E==n?l=="lefttop"?L[E+t]=h.rowhidden[E]:l=="rightbottom"&&(L[E]=h.rowhidden[E]):L[E+t]=h.rowhidden[E];h.rowhidden=L}let A=[];for(let L=0;L<u[0].length;L++)A.push(null);var P=[];if(h.borderInfo&&h.borderInfo.length>0){let L=[];for(let E=0;E<h.borderInfo.length;E++){let V=h.borderInfo[E].rangeType;if(V=="range"){let q=h.borderInfo[E].range,G=[];for(let X=0;X<q.length;X++){let ee=q[X].row[0],le=q[X].row[1];l=="lefttop"?n<=ee?(ee+=t,le+=t):n<=le&&(le+=t):n<ee?(ee+=t,le+=t):n<le&&(le+=t),le>=ee&&G.push({row:[ee,le],column:q[X].column})}if(G.length>0){let X={rangeType:"range",borderType:h.borderInfo[E].borderType,style:h.borderInfo[E].style,color:h.borderInfo[E].color,range:G};L.push(X)}}else if(V=="cell"){let q=h.borderInfo[E].value.row_index;q===n&&P.push(JSON.parse(JSON.stringify(h.borderInfo[E]))),l=="lefttop"?n<=q&&(q+=t):n<q&&(q+=t),h.borderInfo[E].value.row_index=q,L.push(h.borderInfo[E])}}h.borderInfo=L}let z=[];for(let L=0;L<t;L++)if(z.push(JSON.stringify(A)),P.length){var O=JSON.parse(JSON.stringify(P));O.forEach(E=>{l==="rightbottom"?E.value.row_index+=L+1:l==="lefttop"&&(E.value.row_index+=L)}),h.borderInfo.push(...O)}l=="lefttop"?n==0?new Function("d","return d.unshift("+z.join(",")+")")(u):new Function("d","return d.splice("+n+", 0, "+z.join(",")+")")(u):new Function("d","return d.splice("+(n+1)+", 0, "+z.join(",")+")")(u)}else{if(I="c",h.columnlen!=null){let L={};for(let E in h.columnlen)E=parseFloat(E),E<n?L[E]=h.columnlen[E]:E==n?l=="lefttop"?L[E+t]=h.columnlen[E]:l=="rightbottom"&&(L[E]=h.columnlen[E]):L[E+t]=h.columnlen[E];h.columnlen=L}if(h.colhidden!=null){let L={};for(let E in h.colhidden)E=parseFloat(E),E<n?L[E]=h.colhidden[E]:E==n?l=="lefttop"?L[E+t]=h.colhidden[E]:l=="rightbottom"&&(L[E]=h.colhidden[E]):L[E+t]=h.colhidden[E];h.colhidden=L}let A=[];for(let L=0;L<u.length;L++)A.push(null);var P=[];if(h.borderInfo&&h.borderInfo.length>0){let L=[];for(let E=0;E<h.borderInfo.length;E++){let V=h.borderInfo[E].rangeType;if(V=="range"){let q=h.borderInfo[E].range,G=[];for(let X=0;X<q.length;X++){let ee=q[X].column[0],le=q[X].column[1];l=="lefttop"?n<=ee?(ee+=t,le+=t):n<=le&&(le+=t):n<ee?(ee+=t,le+=t):n<le&&(le+=t),le>=ee&&G.push({row:q[X].row,column:[ee,le]})}if(G.length>0){let X={rangeType:"range",borderType:h.borderInfo[E].borderType,style:h.borderInfo[E].style,color:h.borderInfo[E].color,range:G};L.push(X)}}else if(V=="cell"){let q=h.borderInfo[E].value.col_index;q===n&&P.push(JSON.parse(JSON.stringify(h.borderInfo[E]))),l=="lefttop"?n<=q&&(q+=t):n<q&&(q+=t),h.borderInfo[E].value.col_index=q,L.push(h.borderInfo[E])}}h.borderInfo=L}if(P.length)for(let L=0;L<t;L++){var O=JSON.parse(JSON.stringify(P));O.forEach(V=>{l==="rightbottom"?V.value.col_index+=L+1:l==="lefttop"&&(V.value.col_index+=L)}),h.borderInfo.push(...O)}for(let L=0;L<u.length;L++){let E=u[L];for(let V=0;V<t;V++){let q=JSON.parse(JSON.stringify(A[L]));l=="lefttop"?n==0?E.unshift(q):E.splice(n,0,q):E.splice(n+1,0,q)}}}s.index==f.currentSheetIndex?Hn(u,h,"addRC",{index:n,len:t,direction:l,rc:I,restore:!1},p,k,w,C,S,T,R):(s.data=u,s.config=h,s.calcChain=p,s.filter=k.filter,s.filter_select=k.filter_select,s.luckysheet_conditionformat_save=w,s.luckysheet_alternateformat_save=C,s.dataVerification=T,s.hyperlink=R);let M=null;if(e=="row"?l=="lefttop"?M=[{row:[n,n+t-1],column:[0,u[0].length-1]}]:M=[{row:[n+1,n+t],column:[0,u[0].length-1]}]:l=="lefttop"?M=[{row:[0,u.length-1],column:[n,n+t-1]}]:M=[{row:[0,u.length-1],column:[n+1,n+t]}],s.luckysheet_select_save=M,s.index==f.currentSheetIndex&&(f.luckysheet_select_save=M,lt()),e=="row"){let A=$("#luckysheet-cell-main").scrollLeft(),z=$("#luckysheet-cell-main").scrollTop(),L=$("#luckysheet-cell-main").height(),E=$("#luckysheet-cell-main").width(),V=f.visibledatarow[M[0].row[1]],q=M[0].row[0]-1==-1?0:f.visibledatarow[M[0].row[0]-1];V-z-L+20>0?$("#luckysheet-scrollbar-y").scrollTop(V-L+20):q-z-20<0&&$("#luckysheet-scrollbar-y").scrollTop(q-20),t>30&&($("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide())}}function ga(e,n){let t=xe.deepCopyFlowData(f.flowdata),l=$.extend(!0,{},f.config);l.merge==null&&(l.merge={});let o=t[0].length,a=cl([],e,o);t=t.concat(a);for(let s=0;s<n.length;s++){let u=n[s].r,h=n[s].c,d=n[s].v;Ht(u,h,t,d),d!=null&&d.mc!=null&&d.mc.rs!=null&&(l.merge[d.mc.r+"_"+d.mc.c]=$.extend(!0,{},d.mc))}f.flowdata=t,xe.webWorkerFlowDataCache(f.flowdata),f.luckysheetfile[Z(f.currentSheetIndex)].data=t,f.config=l,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,Ct(f.flowdata.length,f.flowdata[0].length)}function Bn(e,n,t,l){if(l=l||f.currentSheetIndex,e=="row"&&!Tt(l,"deleteRows"))return;if(e=="column"&&!Tt(l,"deleteColumns"))return;let o=Z(l),a=f.luckysheetfile[o],s=$.extend(!0,[],a.data);if(n<0&&(n=0),t<0&&(t=0),e=="row"?(n>s.length-1&&(n=s.length-1),t>s.length-1&&(t=s.length-1)):(n>s[0].length-1&&(n=s[0].length-1),t>s[0].length-1&&(t=s[0].length-1)),n>t)return;let u=t-n+1,h=$.extend(!0,{},a.config);h.merge==null&&(h.merge={});let d={};for(let P in h.merge){let O=h.merge[P],M=O.r,A=O.c,z=O.rs,L=O.cs;e=="row"?M<n?M+z-1<n?d[M+"_"+A]={r:M,c:A,rs:z,cs:L}:M+z-1>=n&&M+z-1<t?d[M+"_"+A]={r:M,c:A,rs:n-M,cs:L}:M+z-1>=t&&(d[M+"_"+A]={r:M,c:A,rs:z-u,cs:L}):M>=n&&M<=t?M+z-1>t&&(d[n+"_"+A]={r:n,c:A,rs:M+z-1-t,cs:L}):M>t&&(d[M-u+"_"+A]={r:M-u,c:A,rs:z,cs:L}):e=="column"&&(A<n?A+L-1<n?d[M+"_"+A]={r:M,c:A,rs:z,cs:L}:A+L-1>=n&&A+L-1<t?d[M+"_"+A]={r:M,c:A,rs:z,cs:n-A}:A+L-1>=t&&(d[M+"_"+A]={r:M,c:A,rs:z,cs:L-u}):A>=n&&A<=t?A+L-1>t&&(d[M+"_"+n]={r:M,c:n,rs:z,cs:A+L-1-t}):A>t&&(d[M+"_"+(A-u)]={r:M,c:A-u,rs:z,cs:L}))}h.merge=d;let m=a.calcChain,p=[];if(m!=null&&m.length>0)for(let P=0;P<m.length;P++){let O=$.extend(!0,{},m[P]),M=O.r,A=O.c,z=O.index,L=Ll(M,A,z);if(e=="row"){if(M<n||M>t){let E="="+g.functionStrChange(L,"del","row",null,n,u);s[M][A]&&s[M][A].f==L&&(s[M][A].f=E),M>t&&(O.r=M-u),p.push(O)}}else if(e=="column"&&(A<n||A>t)){let E="="+g.functionStrChange(L,"del","col",null,n,u);s[M][A]&&s[M][A].f==L&&(s[M][A].f=E),A>t&&(O.c=A-u),p.push(O)}}let v=a.filter_select,y=a.filter,k=null;if(v!=null&&JSON.stringify(v)!="{}"){k={filter_select:null,filter:null};let P=v.row[0],O=v.row[1],M=v.column[0],A=v.column[1];if(e=="row"){if(P>t?(P-=u,O-=u,k.filter_select={row:[P,O],column:[M,A]}):P<n&&(O<n||(O<=t?O=n-1:O-=u),k.filter_select={row:[P,O],column:[M,A]}),k.filter_select!=null&&y!=null)for(let z in y){let L=y[z].rowhidden,E={};for(let V in L)V<n?E[V]=0:V>t&&(E[V-u]=0);JSON.stringify(E)!="{}"&&(k.filter==null&&(k.filter={}),k.filter[z]=$.extend(!0,{},y[z]),k.filter[z].rowhidden=E,k.filter[z].str=P,k.filter[z].edr=O)}}else if(e=="column"&&(M>t?(M-=u,A-=u,k.filter_select={row:[P,O],column:[M,A]}):M<n?(A<n||(A<=t?A=n-1:A-=u),k.filter_select={row:[P,O],column:[M,A]}):A>t&&(M=n,A-=u,k.filter_select={row:[P,O],column:[M,A]}),k.filter_select!=null&&y!=null))for(let z in y){let L=y[z].cindex;L<n?(k.filter==null&&(k.filter={}),k.filter[L-M]=$.extend(!0,{},y[z]),k.filter[L-M].edc=A):L>t&&(L-=u,k.filter==null&&(k.filter={}),k.filter[L-M]=$.extend(!0,{},y[z]),k.filter[L-M].cindex=L,k.filter[L-M].stc=M,k.filter[L-M].edc=A)}}if(k!=null&&k.filter!=null){h.rowhidden==null&&(h.rowhidden={});for(let P in k.filter){let O=k.filter[P].rowhidden;for(let M in O)h.rowhidden[M]=0}}let b=a.luckysheet_conditionformat_save,w=[];if(b!=null&&b.length>0)for(let P=0;P<b.length;P++){let O=b[P].cellrange,M=[];for(let A=0;A<O.length;A++){let z=O[A].row[0],L=O[A].row[1],E=O[A].column[0],V=O[A].column[1];e=="row"?z>=n&&L<=t||(z>t?(z-=u,L-=u):z<n?L<n||(L<=t?L=n-1:L-=u):L>t&&(z=n,L-=u),M.push({row:[z,L],column:[E,V]})):e=="column"&&(E>=n&&V<=t||(E>t?(E-=u,V-=u):E<n?V<n||(V<=t?V=n-1:V-=u):V>t&&(E=n,V-=u),M.push({row:[z,L],column:[E,V]})))}if(M.length>0){let A=$.extend(!0,{},b[P]);A.cellrange=M,w.push(A)}}let x=a.luckysheet_alternateformat_save,C=[];if(x!=null&&x.length>0)for(let P=0;P<x.length;P++){let O=x[P].cellrange.row[0],M=x[P].cellrange.row[1],A=x[P].cellrange.column[0],z=x[P].cellrange.column[1];if(e=="row"){if(!(O>=n&&M<=t)){let L=$.extend(!0,{},x[P]);O>t?(O-=u,M-=u):O<n?M<n||(M<=t?M=n-1:M-=u):M>t&&(O=n,M-=u),L.cellrange={row:[O,M],column:[A,z]},C.push(L)}}else if(e=="column"&&!(A>=n&&z<=t)){let L=$.extend(!0,{},x[P]);A>t?(A-=u,z-=u):A<n?z<n||(z<=t?z=n-1:z-=u):z>t&&(A=n,z-=u),L.cellrange={row:[O,M],column:[A,z]},C.push(L)}}let S={freezenhorizontaldata:null,freezenverticaldata:null};if(Y.freezenhorizontaldata!=null&&e=="row"){let P=Y.freezenhorizontaldata[2],O=at(f.visibledatarow,P);O==-1&&(O=0);let M=Y.freezenhorizontaldata[1]-1;M>=n&&(M<t?M=n-1:M-=u),M<O&&(M=O);let A=f.visibledatarow[M]-2-P+f.columnHeaderHeight;S.freezenhorizontaldata=[f.visibledatarow[M],M+1,P,Y.cutVolumn(f.visibledatarow,M+1),A]}else S.freezenhorizontaldata=Y.freezenhorizontaldata;if(Y.freezenverticaldata!=null&&e=="column"){let P=Y.freezenverticaldata[2],O=at(f.visibledatacolumn,P);O==-1&&(O=0);let M=Y.freezenverticaldata[1]-1;M>=n&&(M<t?M=n-1:M-=u),M<O&&(M=O);let A=f.visibledatacolumn[M]-2-P+f.rowHeaderWidth;S.freezenverticaldata=[f.visibledatacolumn[M],M+1,P,Y.cutVolumn(f.visibledatacolumn,M+1),A]}else S.freezenverticaldata=Y.freezenverticaldata;let _=a.dataVerification,T={};if(_!=null)for(let P in _){let O=Number(P.split("_")[0]),M=Number(P.split("_")[1]),A=_[P];e=="row"?O<n?T[O+"_"+M]=A:O>t&&(T[O-u+"_"+M]=A):e=="column"&&(M<n?T[O+"_"+M]=A:M>t&&(T[O+"_"+(M-u)]=A))}let F=a.hyperlink,R={};if(F!=null)for(let P in F){let O=Number(P.split("_")[0]),M=Number(P.split("_")[1]),A=F[P];e=="row"?O<n?R[O+"_"+M]=A:O>t&&(R[O-u+"_"+M]=A):e=="column"&&(M<n?R[O+"_"+M]=A:M>t&&(R[O+"_"+(M-u)]=A))}let I;if(e=="row"){I="r",h.rowlen==null&&(h.rowlen={});let P={};for(let M in h.rowlen)M<n?P[M]=h.rowlen[M]:M>t&&(P[M-u]=h.rowlen[M]);h.rowlen=P,h.rowhidden==null&&(h.rowhidden={});let O={};for(let M in h.rowhidden)M<n?O[M]=h.rowhidden[M]:M>t&&(O[M-u]=h.rowhidden[M]);if(h.rowhidden=O,h.borderInfo&&h.borderInfo.length>0){let M=[];for(let A=0;A<h.borderInfo.length;A++){let z=h.borderInfo[A].rangeType;if(z=="range"){let L=h.borderInfo[A].range,E=[];for(let V=0;V<L.length;V++){let q=L[V].row[0],G=L[V].row[1];for(let X=n;X<=t;X++)X<L[V].row[0]?(q-=1,G-=1):X<=L[V].row[1]&&(G-=1);G>=q&&E.push({row:[q,G],column:L[V].column})}if(E.length>0){let V={rangeType:"range",borderType:h.borderInfo[A].borderType,style:h.borderInfo[A].style,color:h.borderInfo[A].color,range:E};M.push(V)}}else if(z=="cell"){let L=h.borderInfo[A].value.row_index;L<n?M.push(h.borderInfo[A]):L>t&&(h.borderInfo[A].value.row_index=L-(t-n+1),M.push(h.borderInfo[A]))}}h.borderInfo=M}s.splice(n,u);for(let M=0;M<u;M++){let A=[];for(let z=0;z<s[0].length;z++)A.push(null);s.push(A)}}else{I="c",h.columnlen==null&&(h.columnlen={});let P={};for(let A in h.columnlen)A<n?P[A]=h.columnlen[A]:A>t&&(P[A-u]=h.columnlen[A]);h.columnlen=P,h.colhidden==null&&(h.colhidden={});let O={};for(let A in h.colhidden)A<n?O[A]=h.colhidden[A]:A>t&&(O[A-u]=h.colhidden[A]);if(h.colhidden=O,h.borderInfo&&h.borderInfo.length>0){let A=[];for(let z=0;z<h.borderInfo.length;z++){let L=h.borderInfo[z].rangeType;if(L=="range"){let E=h.borderInfo[z].range,V=[];for(let q=0;q<E.length;q++){let G=E[q].column[0],X=E[q].column[1];for(let ee=n;ee<=t;ee++)ee<E[q].column[0]?(G-=1,X-=1):ee<=E[q].column[1]&&(X-=1);X>=G&&V.push({row:E[q].row,column:[G,X]})}if(V.length>0){let q={rangeType:"range",borderType:h.borderInfo[z].borderType,style:h.borderInfo[z].style,color:h.borderInfo[z].color,range:V};A.push(q)}}else if(L=="cell"){let E=h.borderInfo[z].value.col_index;E<n?A.push(h.borderInfo[z]):E>t&&(h.borderInfo[z].value.col_index=E-(t-n+1),A.push(h.borderInfo[z]))}}h.borderInfo=A}let M=[];for(let A=0;A<u;A++)M.push(null);for(let A=0;A<s.length;A++){let z=[].concat(s[A]);z.splice(n,u),s[A]=z.concat(M)}}a.index==f.currentSheetIndex?Hn(s,h,"delRC",{index:n,len:t-n+1,rc:I},p,k,w,C,S,T,R):(a.data=s,a.config=h,a.calcChain=p,a.filter=k.filter,a.filter_select=k.filter_select,a.luckysheet_conditionformat_save=w,a.luckysheet_alternateformat_save=C,a.dataVerification=T,a.hyperlink=R)}function fi(e,n,t,l,o,a){if(a=a||f.currentSheetIndex,!jr(a))return;let s=Z(a),u=f.luckysheetfile[s],h=$.extend(!0,[],u.data),d=t-n+1,m=o-l+1,p=$.extend(!0,{},f.config);p.merge==null&&(p.merge={});let v={};for(let P in p.merge){let O=p.merge[P],M=O.r,A=O.c,z=O.rs,L=O.cs;if(e=="moveLeft")if(n>M+z-1||t<M||l>A+L-1)v[M+"_"+A]={r:M,c:A,rs:z,cs:L};else if(n<=M&&t>=M+z-1&&o<A)v[M+"_"+(A-m)]={r:M,c:A-m,rs:z,cs:L};else for(let E=M;E<=M+z-1;E++)for(let V=A;V<=A+L-1;V++)delete h[E][V].mc;else if(e=="moveUp")if(l>A+L-1||o<A||n>M+z-1)v[M+"_"+A]={r:M,c:A,rs:z,cs:L};else if(l<=A&&o>=A+L-1&&t<M)v[M-d+"_"+A]={r:M-d,c:A,rs:z,cs:L};else for(let E=M;E<=M+z-1;E++)for(let V=A;V<=A+L-1;V++)delete h[E][V].mc}p.merge=v;let y=u.calcChain,k=[];if(y!=null&&y.length>0)for(let P=0;P<y.length;P++){let O=$.extend(!0,{},y[P]),M=O.r,A=O.c,z=O.index,L=Ll(M,A,z);if(M<n||M>t||A<l||A>o){let E;e=="moveLeft"?(E="="+g.functionStrChange(L,"del","col",null,l,m),A>o&&M>=n&&M<=t&&(O.c=A-m)):e=="moveUp"&&(E="="+g.functionStrChange(L,"del","row",null,n,d),M>t&&A>=l&&A<=o&&(O.r=M-d)),h[M][A]&&h[M][A].f==L&&(h[M][A].f=E),k.push(O)}}let b=u.filter_select,w=u.filter,x=null;if(b!=null&&JSON.stringify(b)!="{}"){x={filter_select:null,filter:null};let P=b.row[0],O=b.row[1],M=b.column[0],A=b.column[1];if(e=="moveUp")if(M>=l&&A<=o){if(P>t?x.filter_select={row:[P-d,O-d],column:[M,A]}:O<n?x.filter_select={row:[P,O],column:[M,A]}:P<n&&(O>t?x.filter_select={row:[P,O-d],column:[M,A]}:x.filter_select={row:[P,n-1],column:[M,A]}),x.filter_select!=null&&w!=null)for(let z in w){let L=w[z].rowhidden,E={};for(let V in L)V<n?E[V]=0:V>t&&(E[V-slen]=0);x.filter==null&&(x.filter={}),x.filter[z]=$.extend(!0,{},w[z]),JSON.stringify(E)!="{}"&&(x.filter[z].rowhidden=E),x.filter[z].str=x.filter_select.row[0],x.filter[z].edr=x.filter_select.row[1]}}else if(P>=n&&O<=t){if(M>o?x.filter_select={row:[P,O],column:[M,A]}:M>=l?A>o&&(x.filter_select={row:[P,O],column:[l,A-m]}):A<l?x.filter_select={row:[P,O],column:[M,A]}:A<=o?x.filter_select={row:[P,O],column:[M,l-1]}:x.filter_select={row:[P,O],column:[M,A-m]},x.filter_select!=null&&w!=null)for(let z in w){let L=x.filter_select.column[0],E=x.filter_select.column[1],V=w[z].cindex;if(V<l||V>o){x.filter==null&&(x.filter={}),V>o&&(V-=m);let q=V-L;x.filter[q]=$.extend(!0,{},w[z]),x.filter[q].cindex=V,x.filter[q].stc=L,x.filter[q].edc=E}}}else x.filter_select={row:[P,O],column:[M,A]},w!=null&&(x.filter=w);else if(e=="moveLeft")if(P>=n&&O<=t){if(M>o?x.filter_select={row:[P,O],column:[M-m,A-m]}:A<l?x.filter_select={row:[P,O],column:[M,A]}:M<l&&(A>o?x.filter_select={row:[P,O],column:[M,A-m]}:x.filter_select={row:[P,O],column:[M,l-1]}),x.filter_select!=null&&w!=null)for(let z in w){let L=x.filter_select.column[0],E=x.filter_select.column[1],V=w[z].cindex;if(V<l||V>o){x.filter==null&&(x.filter={}),V>o&&(V-=m);let q=V-L;x.filter[q]=$.extend(!0,{},w[z]),x.filter[q].cindex=V,x.filter[q].stc=L,x.filter[q].edc=E}}}else M>=l&&A<=o?(P<n||P>t)&&(x.filter_select={row:[P,O],column:[M,A]},w!=null&&(x.filter=w)):(x.filter_select={row:[P,O],column:[M,A]},w!=null&&(x.filter=w))}if(x!=null&&x.filter!=null){p.rowhidden==null&&(p.rowhidden={});for(let P in x.filter){let O=x.filter[P].rowhidden;for(let M in O)p.rowhidden[M]=0}}let C=u.luckysheet_conditionformat_save,S=[];if(C!=null&&C.length>0)for(let P=0;P<C.length;P++){let O=C[P].cellrange,M=[];for(let A=0;A<O.length;A++){let z=O[A].row[0],L=O[A].row[1],E=O[A].column[0],V=O[A].column[1];n<=z&&t>=L&&l<=E&&o>=V||(M=Fh(e,n,t,l,o,z,L,E,V,d,m))}if(M.length>0){let A=$.extend(!0,{},C[P]);A.cellrange=M,S.push(A)}}let _=u.dataVerification,T={};if(_!=null)for(let P in _){let O=Number(P.split("_")[0]),M=Number(P.split("_")[1]),A=_[P];(O<n||O>t||M<l||M>o)&&(e=="moveLeft"?M>o&&O>=n&&O<=t?T[O+"_"+(M-m)]=A:T[O+"_"+M]=A:e=="moveUp"&&(O>t&&M>=l&&M<=o?T[O-d+"_"+M]=A:T[O+"_"+M]=A))}let F=u.hyperlink,R={};if(F!=null)for(let P in F){let O=Number(P.split("_")[0]),M=Number(P.split("_")[1]),A=F[P];(O<n||O>t||M<l||M>o)&&(e=="moveLeft"?M>o&&O>=n&&O<=t?R[O+"_"+(M-m)]=A:R[O+"_"+M]=A:e=="moveUp"&&(O>t&&M>=l&&M<=o?R[O-d+"_"+M]=A:R[O+"_"+M]=A))}if(p.borderInfo&&p.borderInfo.length>0){let P=[];for(let O=0;O<p.borderInfo.length;O++){let M=p.borderInfo[O].rangeType;if(M=="range"){let A=p.borderInfo[O].range,z=[];for(let L=0;L<A.length;L++){let E=A[L].row[0],V=A[L].row[1],q=A[L].column[0],G=A[L].column[1];n<=E&&t>=V&&l<=q&&o>=G||(z=Fh(e,n,t,l,o,E,V,q,G,d,m))}if(z.length>0){let L={rangeType:"range",borderType:p.borderInfo[O].borderType,style:p.borderInfo[O].style,color:p.borderInfo[O].color,range:z};P.push(L)}}else if(M=="cell"){let A=p.borderInfo[O].value.row_index,z=p.borderInfo[O].value.col_index;(A<n||A>t||z<l||z>o)&&(e=="moveLeft"?z>o&&A>=n&&A<=t&&(z-=m,p.borderInfo[O].value.col_index=z):e=="moveUp"&&A>t&&z>=l&&z<=o&&(A-=d,p.borderInfo[O].value.row_index=A),P.push(p.borderInfo[O]))}}p.borderInfo=P}let I=[];for(let P=l;P<=o;P++)I.push(null);if(e=="moveUp"){let P=[];for(let M=n;M<=h.length-1;M++){let A=[];for(let z=l;z<=o;z++)A.push(h[M][z]);P.push(A)}P.splice(0,d);let O=[];for(let M=n;M<=t;M++)O.push(I);P=P.concat(O);for(let M=n;M<=h.length-1;M++)for(let A=l;A<=o;A++)h[M][A]=P[M-n][A-l]}else if(e=="moveLeft")for(let P=n;P<=t;P++)h[P].splice(l,m),h[P]=h[P].concat(I);u.index==f.currentSheetIndex?Ro(h,p,{type:e,str:n,edr:t,stc:l,edc:o},k,x,S,T,R):(u.data=h,u.config=p,u.calcChain=k,u.filter=x.filter,u.filter_select=x.filter_select,u.luckysheet_conditionformat_save=S,u.dataVerification=T,u.hyperlink=R)}function Fh(e,n,t,l,o,a,s,u,h,d,m){let p=[];if(e=="moveLeft"){if(n>s||t<a||l>h)p.push({row:[a,s],column:[u,h]});else if(o<u){if(n<=a&&t>=s)p.push({row:[a,s],column:[u-m,h-m]});else if(n>a&&t<s){let v=[{row:[a,n-1],column:[u,h]},{row:[t+1,s],column:[u,h]},{row:[n,t],column:[u-m,h-m]}];p=p.concat(v)}else if(n>a){let v=[{row:[a,n-1],column:[u,h]},{row:[n,s],column:[u-m,h-m]}];p=p.concat(v)}else if(t<s){let v=[{row:[a,t],column:[u-m,h-m]},{row:[t+1,s],column:[u,h]}];p=p.concat(v)}}else if(o>=u){if(l<=u&&o>=h){if(n>a&&t<s){let v=[{row:[a,n-1],column:[u,h]},{row:[t+1,s],column:[u,h]}];p=p.concat(v)}else if(n>a){let v=[{row:[a,n-1],column:[u,h]}];p=p.concat(v)}else if(t<s){let v=[{row:[t+1,s],column:[u,h]}];p=p.concat(v)}}else if(l>u&&o<h){if(n<=a&&t>=s)p.push({row:[a,s],column:[u,h-m]});else if(n>a&&t<s){let v=[{row:[a,n-1],column:[u,h]},{row:[t+1,s],column:[u,h]},{row:[n,t],column:[u,h-m]}];p=p.concat(v)}else if(n>a){let v=[{row:[a,n-1],column:[u,h]},{row:[n,s],column:[u,h-m]}];p=p.concat(v)}else if(t<s){let v=[{row:[a,t],column:[u,h-m]},{row:[t+1,s],column:[u,h]}];p=p.concat(v)}}else if(l>u){if(n<=a&&t>=s)p.push({row:[a,s],column:[u,l-1]});else if(n>a&&t<s){let v=[{row:[a,n-1],column:[u,h]},{row:[t+1,s],column:[u,h]},{row:[n,t],column:[u,l-1]}];p=p.concat(v)}else if(n>a){let v=[{row:[a,n-1],column:[u,h]},{row:[n,s],column:[u,l-1]}];p=p.concat(v)}else if(t<s){let v=[{row:[a,t],column:[u,l-1]},{row:[t+1,s],column:[u,h]}];p=p.concat(v)}}else if(o<h){if(n<=a&&t>=s)p.push({row:[a,s],column:[u-m,h-m]});else if(n>a&&t<s){let v=[{row:[a,n-1],column:[u,h]},{row:[t+1,s],column:[u,h]},{row:[n,t],column:[u-m,h-m]}];p=p.concat(v)}else if(n>a){let v=[{row:[a,n-1],column:[u,h]},{row:[n,s],column:[u-m,h-m]}];p=p.concat(v)}else if(t<s){let v=[{row:[a,t],column:[u-m,h-m]},{row:[t+1,s],column:[u,h]}];p=p.concat(v)}}}}else if(e=="moveUp"){if(l>h||o<u||n>s)p.push({row:[a,s],column:[u,h]});else if(t<a){if(l<=u&&o>=h)p.push({row:[a-d,s-d],column:[u,h]});else if(l>u&&o<h){let v=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,h]},{row:[a-d,s-d],column:[l,o]}];p=p.concat(v)}else if(l>u){let v=[{row:[a,s],column:[u,l-1]},{row:[a-d,s-d],column:[l,h]}];p=p.concat(v)}else if(o<h){let v=[{row:[a-d,s-d],column:[u,o]},{row:[a,s],column:[o+1,h]}];p=p.concat(v)}}else if(t>=a){if(n<=a&&t>=s){if(l>u&&o<h){let v=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,h]}];p=p.concat(v)}else if(l>u){let v=[{row:[a,s],column:[u,l-1]}];p=p.concat(v)}else if(o<h){let v=[{row:[a,s],column:[o+1,h]}];p=p.concat(v)}}else if(n>a&&t<s){if(l<=u&&o>=h)p.push({row:[a,s-d],column:[u,h]});else if(l>u&&o<h){let v=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,h]},{row:[a,s-d],column:[l,o]}];p=p.concat(v)}else if(l>u){let v=[{row:[a,s],column:[u,l-1]},{row:[a,s-d],column:[l,h]}];p=p.concat(v)}else if(o<h){let v=[{row:[a,s-d],column:[u,o]},{row:[a,s],column:[o+1,h]}];p=p.concat(v)}}else if(n>a){if(l<=u&&o>=h)p.push({row:[a,n-1],column:[u,h]});else if(l>u&&o<h){let v=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,h]},{row:[a,n-1],column:[l,o]}];p=p.concat(v)}else if(l>u){let v=[{row:[a,s],column:[u,l-1]},{row:[a,n-1],column:[l,h]}];p=p.concat(v)}else if(o<h){let v=[{row:[a,n-1],column:[u,o]},{row:[a,s],column:[o+1,h]}];p=p.concat(v)}}else if(t<s){if(l<=u&&o>=h)p.push({row:[a-d,s-d],column:[u,h]});else if(l>u&&o<h){let v=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,h]},{row:[a-d,s-d],column:[l,o]}];p=p.concat(v)}else if(l>u){let v=[{row:[a,s],column:[u,l-1]},{row:[a-d,s-d],column:[l,h]}];p=p.concat(v)}else if(o<h){let v=[{row:[a-d,s-d],column:[u,o]},{row:[a,s],column:[o+1,h]}];p=p.concat(v)}}}}return p}var hi=Me(()=>{Jt();Ut();Yt();Kt();$r();mr();Hl();Zt();Nr();Ml();Et();Ke()});function Es(e,n,t,l,o){o==null&&(o=!0),f.visibledatarow=[],f.visibledatacolumn=[],f.ch_width=0,f.rh_height=0,f.zoomRatio=1,l!=null?f.config=l:f.config={},t.length==0?f.flowdata=cl(t,n,e):t.length<n&&t[0].length<e?f.flowdata=cl(t,n-t.length,e-t[0].length):t.length<n?f.flowdata=cl(t,n-t.length,0):t[0].length<e?f.flowdata=cl(t,0,e-t[0].length):f.flowdata=t,xe.webWorkerFlowDataCache(f.flowdata),gn(n,e),o&&(ye.showSheet(),setTimeout(function(){ye.restoreCache(),g.execFunctionGroup(),ye.restoreSheetAll(f.currentSheetIndex),Be()},1))}var Dh=Me(()=>{Kt();Jt();To();Ut();Yt();dl();Ke()});var Oi,gv,Je,Nl=Me(()=>{Qt();Wt();dl();Ut();qr();gr();nn();Hl();Et();hi();xl();Jt();Dh();Ke();Oi={defaultStore:{container:null,luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfredo:[],jfundo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],currentSheetView:"viewNormal"},defaultFormula:{searchFunctionCell:null,functionlistPosition:{},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangedrag_column_start:!1,rangedrag_row_start:!1,rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,functionHTMLIndex:0,functionRangeIndex:null,execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},cellTextToIndexList:{},isFunctionRangeSave:!1,formulaContainCellList:{},execFunctionGlobalData:{},groupValuesRefreshData:[],functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},defaultSheet:{sheetMaxIndex:0,nulldata:null,mergeCalculationSheet:{},checkLoadSheetIndexToDataIndex:{},CacheNotLoadControll:[]},defaultPivotTable:{pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},drawPivotTable:!0,pivotTableBoundary:[12,6]},defaultImage:{imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null},defaultDataVerification:{defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1}},gv={addDataAjax:function(e,n,t,l){let o=this;n==null&&(n=f.currentSheetIndex),t==null&&(t=ne.loadSheetUrl),$("#luckysheet-grid-window-1").append(Ar()),e.currentPage++;let a="application/json;charset=UTF-8",s=sessionStorage.getItem("x-auth-token");$.ajax({method:"POST",url:t,headers:{"x-auth-token":s},data:JSON.stringify(e),contentType:a,success:function(u){typeof u=="string"&&(u=JSON.parse(u));let h=u.data,d=h.celldata;ga(h.row,d),setTimeout(function(){f.loadingObj.close()},500),l&&typeof l=="function"&&l(h)}})},reload:function(e,n,t,l){let o=this;n==null&&(n=f.currentSheetIndex),t==null&&(t=ne.loadSheetUrl),$("#luckysheet-grid-window-1").append(Ar());let a={gridKey:ne.gridKey,index:n};e=$.extend(!0,e,a);let s=f.luckysheetfile[Z(n)];$.post(t,e,function(u){let h=new Function("return "+u)();s.celldata=h[n.toString()];let d=ye.buildGridData(s);setTimeout(function(){f.loadingObj.close()},500),s.data=d,f.flowdata=d,xe.webWorkerFlowDataCache(d),Es(d[0].length,d.length,d,null,!1),s.load="1",f.luckysheet_select_save.length=0,f.luckysheet_selection_range=[],ne.saveParam("shs",null,f.currentSheetIndex),ye.changeSheet(n),l&&typeof l=="function"&&l()})},clearSheetByIndex:function(e){let n=Z(e),t=f.luckysheetfile[n];t.isPivotTable?delete f.luckysheetfile[n]:(t.data=[],t.row=f.defaultrowNum,t.column=f.defaultcolumnNum,t.chart=[],t.config=null,t.filter=null,t.filter_select=null,t.celldata=[],t.pivotTable={},t.calcChain=[],t.status=0,t.load=0,f.flowdata=[],xe.webWorkerFlowDataCache(f.flowdata),$("#"+f.container+" .luckysheet-data-visualization-chart").remove(),$("#"+f.container+" .luckysheet-datavisual-selection-set").remove(),$("#luckysheet-row-count-show, #luckysheet-formula-functionrange-select, #luckysheet-row-count-show, #luckysheet-column-count-show, #luckysheet-change-size-line, #luckysheet-cell-selected-focus, #luckysheet-selection-copy, #luckysheet-cell-selected-extend, #luckysheet-cell-selected-move, #luckysheet-cell-selected").hide(),delete t.load)},clear:function(e){let n=this;if(e=="all")for(let t=0;t<f.luckysheetfile.length;t++){let l=f.luckysheetfile[t];n.clearSheetByIndex(l.index)}else e==null&&(e=f.currentSheetIndex),n.clearSheetByIndex(e);ye.changeSheet(f.luckysheetfile[0].index)},destroy:function(){$("#"+f.container).empty(),$("body > .luckysheet-cols-menu").remove(),$("#luckysheet-modal-dialog-mask, #luckysheetTextSizeTest, #luckysheet-icon-morebtn-div").remove(),$("#luckysheet-input-box").parent().remove(),$("#luckysheet-formula-help-c").remove(),$(".chartSetting, .luckysheet-modal-dialog-slider").remove(),$(document).off(".luckysheetEvent"),$(document).off(".luckysheetProtection"),Y.initialHorizontal=!0,Y.initialVertical=!0;let e=$.extend(!0,{},Oi.defaultStore);for(let s in e)s in f&&(f[s]=e[s]);let n=$.extend(!0,{},Oi.defaultFormula);for(let s in n)s in g&&(g[s]=n[s]);let t=$.extend(!0,{},Oi.defaultSheet);for(let s in t)s in ye&&(ye[s]=t[s]);let l=$.extend(!0,{},Oi.defaultPivotTable);for(let s in l)s in Oe&&(Oe[s]=l[s]);let o=$.extend(!0,{},Oi.defaultImage);for(let s in o)s in Ie&&(Ie[s]=o[s]);let a=$.extend(!0,{},Oi.defaultDataVerification);for(let s in a)s in Ye&&(Ye[s]=a[s]);f.asyncLoad=["core"]},editorChart:function(e){let n=Gl[0],t="luckysheetEditMode-datav-chart",l=t+"_selection";e.chart_id=t;let o=e.chartTheme;o=o==null?"default0000":o,luckysheet.insertChartTosheet(e.sheetIndex,e.dataSheetIndex,e.option,e.chartType,e.selfOption,e.defaultOption,e.row,e.column,n,t,l,e.chartStyle,e.rangeConfigCheck,e.rangeRowCheck,e.rangeColCheck,e.chartMarkConfig,e.chartTitleConfig,e.winWidth,e.winHeight,e.scrollLeft,e.scrollTop,o,e.myWidth,e.myHeight,e.myLeft!=null?parseFloat(e.myLeft):null,e.myTop!=null?parseFloat(e.myTop):null,e.myindexrank,!0),$("#"+t).find(".luckysheet-modal-controll-update").click()},createHookFunction:function(){let e=arguments[0];if(de.hook&&de.hook[e]!=null&&typeof de.hook[e]=="function"){var n=Array.prototype.slice.apply(arguments);return n.shift(),de.hook[e].apply(this,n)!==!1}return!0}},Je=gv});var pv,He,Wr=Me(()=>{Zl();Jt();Ut();dn();Yt();Zn();Et();ht();Hl();ol();Ml();Qt();Ke();Nl();pv={defaultWidth:144,defaultHeight:84,currentObj:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,init:function(){let e=this;$("#luckysheet-postil-showBoxs").off("mousedown.showPs").on("mousedown.showPs",".luckysheet-postil-show",function(n){if(!!Tt(f.currentSheetIndex,"editObjects",!1)){if(e.currentObj=$(this).find(".luckysheet-postil-show-main"),$(this).hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).addClass("luckysheet-postil-show-active"),$(this).find(".luckysheet-postil-dialog-resize").show(),$(this).find(".arrowCanvas").css("z-index",200),$(this).find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()}}),$("#luckysheet-postil-showBoxs").off("mouseup.showPs").on("mouseup.showPs",".luckysheet-postil-show",function(n){n.which=="3"&&n.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.resize").on("mousedown.resize",".luckysheet-postil-show .luckysheet-postil-dialog-resize .luckysheet-postil-dialog-resize-item",function(n){if(!Tt(f.currentSheetIndex,"editObjects",!1))return;e.currentObj=$(this).closest(".luckysheet-postil-show-main"),e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.resize=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=ut(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t,u=e.currentObj.position(),h=e.currentObj.width(),d=e.currentObj.height();if(e.resizeXY=[a,s,h,d,u.left+l,u.top+t,l,t],Xn(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.move").on("mousedown.move",".luckysheet-postil-show .luckysheet-postil-dialog-move .luckysheet-postil-dialog-move-item",function(n){if(!Tt(f.currentSheetIndex,"editObjects",!1))return;e.currentObj=$(this).closest(".luckysheet-postil-show-main"),e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.move=!0;let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=e.currentObj.offset(),a=e.currentObj.position();if(e.moveXY=[n.pageX-o.left,n.pageY-o.top,a.left,a.top,l,t],Xn(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()})},overshow:function(e){let n=this;if($("#luckysheet-postil-overshow").remove(),$(e.target).closest("#luckysheet-cell-main").length==0)return;let t=ut(e.pageX,e.pageY),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").scrollTop(),a=t[0],s=t[1],u=0,h=0;Y.freezenverticaldata!=null&&t[0]<Y.freezenverticaldata[0]-Y.freezenverticaldata[2]?u=l:a+=l,Y.freezenhorizontaldata!=null&&t[1]<Y.freezenhorizontaldata[0]-Y.freezenhorizontaldata[2]?h=o:s+=o;let d=$t(s)[2],m=_t(a)[2],p=be.mergeborer(f.flowdata,d,m);if(p&&(d=p.row[2],m=p.column[2]),f.flowdata[d]==null||f.flowdata[d][m]==null||f.flowdata[d][m].ps==null)return;let v=f.flowdata[d][m].ps;if(v.isshow||$("#luckysheet-postil-show_"+d+"_"+m).length>0)return;let y=v.value==null?"":v.value,k=f.visibledatarow[d],b=d-1==-1?0:f.visibledatarow[d-1],w=f.visibledatacolumn[m],x=m-1==-1?0:f.visibledatacolumn[m-1];p&&(k=p.row[1],b=p.row[0],w=p.column[1],x=p.column[0]);let C=w+u,S=b+h,_=C+18*f.zoomRatio,T=S-18*f.zoomRatio;T<0&&(T=2);let F=v.width==null?n.defaultWidth*f.zoomRatio:v.width*f.zoomRatio,R=v.height==null?n.defaultHeight*f.zoomRatio:v.height*f.zoomRatio,I=n.getArrowCanvasSize(_,T,C,S),P="",O=y.split(`
`);for(let z of O)P+="<div>"+n.htmlEscape(z)+"</div>";let M='<div id="luckysheet-postil-overshow"><canvas class="arrowCanvas" width="'+I[2]+'" height="'+I[3]+'" style="position:absolute;left:'+I[0]+"px;top:"+I[1]+'px;z-index:100;pointer-events:none;"></canvas><div style="width:'+(F-12)+"px;min-height:"+(R-12)+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+_+"px;top:"+T+'px;z-index:100;">'+P+"</div></div>";$(M).appendTo($("#luckysheet-cell-main"));let A=$("#luckysheet-postil-overshow .arrowCanvas").get(0).getContext("2d");n.drawArrow(A,I[4],I[5],I[6],I[7])},getArrowCanvasSize:function(e,n,t,l){let o=t-5;e<t&&(o=e-5);let a=l-5;n<l&&(a=n-5);let s=Math.abs(e-t)+10,u=Math.abs(n-l)+10,h=s-5,d=5;e<t&&(h=5,d=s-5);let m=u-5,p=5;return n<l&&(m=5,p=u-5),[o,a,s,u,h,m,d,p]},drawArrow:function(e,n,t,l,o,a,s,u,h){a=N(a)=="undefined"?30:a,s=N(s)=="undefined"?6:s,u=N(u)=="undefined"?1:u,h=N(h)=="undefined"?"#000":h;let d=Math.atan2(t-o,n-l)*180/Math.PI,m=(d+a)*Math.PI/180,p=(d-a)*Math.PI/180,v=s*Math.cos(m),y=s*Math.sin(m),k=s*Math.cos(p),b=s*Math.sin(p);e.save(),e.beginPath();let w=n-v,x=t-y;e.moveTo(w,x),e.moveTo(n,t),e.lineTo(l,o),e.lineWidth=u,e.strokeStyle=h,e.stroke(),w=l+v,x=o+y,e.moveTo(w,x),e.lineTo(l,o),w=l+k,x=o+b,e.lineTo(w,x),e.fillStyle=h,e.fill(),e.restore()},buildAllPs:function(e){let n=this;$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(let t=0;t<e.length;t++)for(let l=0;l<e[0].length;l++)if(e[t][l]!=null&&e[t][l].ps!=null){let o=e[t][l].ps;n.buildPs(t,l,o)}n.init()},buildPs:function(e,n,t){if($("#luckysheet-postil-show_"+e+"_"+n).length>0&&$("#luckysheet-postil-show_"+e+"_"+n).remove(),t==null)return;let l=this;if(t.isshow==null?!1:t.isshow){let a=f.visibledatarow[e],s=e-1==-1?0:f.visibledatarow[e-1],u=f.visibledatacolumn[n],h=n-1==-1?0:f.visibledatacolumn[n-1],d=be.mergeborer(f.flowdata,e,n);d&&(a=d.row[1],s=d.row[0],u=d.column[1],h=d.column[0]);let m=u,p=s,v=t.left==null?m+18*f.zoomRatio:t.left*f.zoomRatio,y=t.top==null?p-18*f.zoomRatio:t.top*f.zoomRatio,k=t.width==null?l.defaultWidth*f.zoomRatio:t.width*f.zoomRatio,b=t.height==null?l.defaultHeight*f.zoomRatio:t.height*f.zoomRatio,w=t.value==null?"":t.value;y<0&&(y=2);let x=l.getArrowCanvasSize(v,y,m,p),C="",S=w.split(`
`);for(let F of S)C+="<div>"+l.htmlEscape(F)+"</div>";let _='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+x[2]+'" height="'+x[3]+'" style="position:absolute;left:'+x[0]+"px;top:"+x[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+k+"px;height:"+b+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+v+"px;top:"+y+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(k-12)+"px;height:"+(b-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+C+"</div></div></div></div>";$(_).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let T=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");l.drawArrow(T,x[4],x[5],x[6],x[7])}},newPs:function(e,n){if(!Tt(f.currentSheetIndex,"editObjects")||!Je.createHookFunction("commentInsertBefore",e,n))return;let t=this,l=f.visibledatarow[e],o=e-1==-1?0:f.visibledatarow[e-1],a=f.visibledatacolumn[n],s=n-1==-1?0:f.visibledatacolumn[n-1],u=be.mergeborer(f.flowdata,e,n);u&&(l=u.row[1],o=u.row[0],a=u.column[1],s=u.column[0]);let h=a,d=o,m=h+18*f.zoomRatio,p=d-18*f.zoomRatio;p<0&&(p=2);let v=t.defaultWidth*f.zoomRatio,y=t.defaultHeight*f.zoomRatio,k=t.getArrowCanvasSize(m,p,h,d),b='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+k[2]+'" height="'+k[3]+'" style="position:absolute;left:'+k[0]+"px;top:"+k[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+v+"px;height:"+y+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+m+"px;top:"+p+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:132px;height:72px;line-height:20px;box-sizing:border-box;text-align: center;word-break:break-all;" spellcheck="false" contenteditable="true"></div></div></div></div>';$(b).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let w=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(w,k[4],k[5],k[6],k[7]),$("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").focus(),t.init();let x=xe.deepCopyFlowData(f.flowdata),C=[];x[e][n]==null&&(x[e][n]={}),x[e][n].ps={left:null,top:null,width:null,height:null,value:"",isshow:!1},C.push(e+"_"+n),t.ref(x,C),setTimeout(()=>{Je.createHookFunction("commentInsertAfter",e,n,x[e][n])},0)},editPs:function(e,n){let t=this;if(!!Tt(f.currentSheetIndex,"editObjects")){if($("#luckysheet-postil-show_"+e+"_"+n).length>0)$("#luckysheet-postil-show_"+e+"_"+n).show(),$("#luckysheet-postil-show_"+e+"_"+n).addClass("luckysheet-postil-show-active"),$("#luckysheet-postil-show_"+e+"_"+n).find(".luckysheet-postil-dialog-resize").show();else{let l=f.flowdata[e][n].ps,o=f.visibledatarow[e],a=e-1==-1?0:f.visibledatarow[e-1],s=f.visibledatacolumn[n],u=n-1==-1?0:f.visibledatacolumn[n-1],h=be.mergeborer(f.flowdata,e,n);h&&(o=h.row[1],a=h.row[0],s=h.column[1],u=h.column[0]);let d=s,m=a,p=l.left==null?d+18*f.zoomRatio:l.left*f.zoomRatio,v=l.top==null?m-18*f.zoomRatio:l.top*f.zoomRatio,y=l.width==null?t.defaultWidth*f.zoomRatio:l.width*f.zoomRatio,k=l.height==null?t.defaultHeight*f.zoomRatio:l.height*f.zoomRatio,b=l.value==null?"":l.value;v<0&&(v=2);let w=t.getArrowCanvasSize(p,v,d,m),x="",C=b.split(`
`);for(let T of C)x+="<div>"+t.htmlEscape(T)+"</div>";let S='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+w[2]+'" height="'+w[3]+'" style="position:absolute;left:'+w[0]+"px;top:"+w[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+y+"px;height:"+k+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+p+"px;top:"+v+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(y-12)+"px;height:"+(k-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+x+"</div></div></div></div>";$(S).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let _=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(_,w[4],w[5],w[6],w[7])}$("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").focus(),wr($("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").get(0)),t.init()}},delPs:function(e,n){if(!Tt(f.currentSheetIndex,"editObjects")||!Je.createHookFunction("commentDeleteBefore",e,n,f.flowdata[e][n]))return;$("#luckysheet-postil-show_"+e+"_"+n).length>0&&$("#luckysheet-postil-show_"+e+"_"+n).remove();let t=xe.deepCopyFlowData(f.flowdata),l=[];delete t[e][n].ps,l.push(e+"_"+n),this.ref(t,l),setTimeout(()=>{Je.createHookFunction("commentDeleteAfter",e,n,f.flowdata[e][n])},0)},showHidePs:function(e,n){let t=this,l=f.flowdata[e][n].ps,o=l.isshow,a=xe.deepCopyFlowData(f.flowdata),s=[];if(o)a[e][n].ps.isshow=!1,$("#luckysheet-postil-show_"+e+"_"+n).remove();else{a[e][n].ps.isshow=!0;let u=f.visibledatarow[e],h=e-1==-1?0:f.visibledatarow[e-1],d=f.visibledatacolumn[n],m=n-1==-1?0:f.visibledatacolumn[n-1],p=be.mergeborer(f.flowdata,e,n);p&&(u=p.row[1],h=p.row[0],d=p.column[1],m=p.column[0]);let v=$("#luckysheet-cell-main").scrollLeft(),y=$("#luckysheet-cell-main").scrollTop(),k=d,b=h;Y.freezenverticaldata!=null&&k<Y.freezenverticaldata[0]-Y.freezenverticaldata[2]&&(k+=v),Y.freezenhorizontaldata!=null&&b<Y.freezenhorizontaldata[0]-Y.freezenhorizontaldata[2]&&(b+=y);let w=l.left==null?k+18*f.zoomRatio:l.left*f.zoomRatio,x=l.top==null?b-18*f.zoomRatio:l.top*f.zoomRatio,C=l.width==null?t.defaultWidth*f.zoomRatio:l.width*f.zoomRatio,S=l.height==null?t.defaultHeight*f.zoomRatio:l.height*f.zoomRatio,_=l.value==null?"":l.value;x<0&&(x=2);let T=t.getArrowCanvasSize(w,x,k,b),F="",R=_.split(`
`);for(let O of R)F+="<div>"+t.htmlEscape(O)+"</div>";let I='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+T[2]+'" height="'+T[3]+'" style="position:absolute;left:'+T[0]+"px;top:"+T[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+C+"px;height:"+S+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+w+"px;top:"+x+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(C-12)+"px;height:"+(S-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+F+"</div></div></div></div>";$(I).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let P=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(P,T[4],T[5],T[6],T[7]),t.init()}s.push(e+"_"+n),t.ref(a,s)},showHideAllPs:function(){let e=this,n=xe.deepCopyFlowData(f.flowdata),t=!0,l=[];for(let a=0;a<n.length;a++)for(let s=0;s<n[0].length;s++)n[a]!=null&&n[a][s]!=null&&n[a][s].ps!=null&&(l.push(a+"_"+s),n[a][s].ps.isshow||(t=!1));let o=[];if(l.length>0)if(t){$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(let a=0;a<l.length;a++){let s=l[a].split("_")[0],u=l[a].split("_")[1];n[s][u].ps.isshow&&(n[s][u].ps.isshow=!1,o.push(l[a]))}}else for(let a=0;a<l.length;a++){let s=l[a].split("_")[0],u=l[a].split("_")[1],h=n[s][u].ps;if(!h.isshow){let d=f.visibledatarow[s],m=s-1==-1?0:f.visibledatarow[s-1],p=f.visibledatacolumn[u],v=u-1==-1?0:f.visibledatacolumn[u-1],y=be.mergeborer(f.flowdata,s,u);y&&(d=y.row[1],m=y.row[0],p=y.column[1],v=y.column[0]);let k=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),w=p,x=m;Y.freezenverticaldata!=null&&w<Y.freezenverticaldata[0]-Y.freezenverticaldata[2]&&(w+=k),Y.freezenhorizontaldata!=null&&x<Y.freezenhorizontaldata[0]-Y.freezenhorizontaldata[2]&&(x+=b);let C=h.left==null?w+18*f.zoomRatio:h.left*f.zoomRatio,S=h.top==null?x-18*f.zoomRatio:h.top*f.zoomRatio,_=h.width==null?e.defaultWidth*f.zoomRatio:h.width*f.zoomRatio,T=h.height==null?e.defaultHeight*f.zoomRatio:h.height*f.zoomRatio,F=h.value==null?"":h.value;S<0&&(S=2);let R=e.getArrowCanvasSize(C,S,w,x),I="",P=F.split(`
`);for(let A of P)I+="<div>"+e.htmlEscape(A)+"</div>";let O='<div id="luckysheet-postil-show_'+s+"_"+u+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+R[2]+'" height="'+R[3]+'" style="position:absolute;left:'+R[0]+"px;top:"+R[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+_+"px;height:"+T+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+C+"px;top:"+S+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(_-12)+"px;height:"+(T-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+I+"</div></div></div></div>";$(O).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let M=$("#luckysheet-postil-show_"+s+"_"+u+" .arrowCanvas").get(0).getContext("2d");e.drawArrow(M,R[4],R[5],R[6],R[7]),n[s][u].ps.isshow=!0,o.push(l[a])}}e.ref(n,o),e.init()},removeActivePs:function(){if($("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").length>0){let e=$("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").attr("id"),n=e.split("luckysheet-postil-show_")[1].split("_")[0],t=e.split("luckysheet-postil-show_")[1].split("_")[1],l=$("#"+e).find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim();if(!Je.createHookFunction("commentUpdateBefore",n,t,l)){f.flowdata[n][t].ps.isshow||$("#"+e).remove();return}let o=$.extend(!0,{},f.flowdata[n][t]);$("#"+e).removeClass("luckysheet-postil-show-active"),$("#"+e).find(".luckysheet-postil-dialog-resize").hide(),$("#"+e).find(".arrowCanvas").css("z-index",100),$("#"+e).find(".luckysheet-postil-show-main").css("z-index",100);let a=xe.deepCopyFlowData(f.flowdata),s=[];a[n][t].ps.value=l,s.push(n+"_"+t),this.ref(a,s),a[n][t].ps.isshow||$("#"+e).remove(),setTimeout(()=>{Je.createHookFunction("commentUpdateAfter",n,t,o,a[n][t])},0)}},ref:function(e,n){if(f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"postil",data:f.flowdata,curdata:e,sheetIndex:f.currentSheetIndex,rc:n})),f.flowdata=e,xe.webWorkerFlowDataCache(f.flowdata),f.luckysheetfile[Z(f.currentSheetIndex)].data=f.flowdata,ne.allowUpdate)for(let t=0;t<n.length;t++){let l=n[t].split("_")[0],o=n[t].split("_")[1];ne.saveParam("v",f.currentSheetIndex,f.flowdata[l][o],{r:l,c:o})}setTimeout(function(){Be()},1)},positionSync:function(){let e=this;$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(n,t){let l=$(t).attr("id"),o=l.split("luckysheet-postil-show_")[1].split("_")[0],a=l.split("luckysheet-postil-show_")[1].split("_")[1],s=f.flowdata[o][a];s!=null&&s.ps!=null?e.buildPs(o,a,s.ps):$("#"+l).hide()})},htmlEscape:function(e){return e.replace(/[<>"&]/g,function(n,t,l){switch(console.log(n,t,l),n){case"<":return"&lt";case">":return"&gt";case"&":return"&amp";case'"':return"&quot;"}})}},He=pv});function Ls(e,n,t,l,o){let a={},s,u;o==null?(s=f.config,u=f.flowdata):(s=f.luckysheetfile[Z(o)].config,u=f.luckysheetfile[Z(o)].data);let h=s.borderInfo;if(h!=null&&h.length>0)for(let d=0;d<h.length;d++){let m=h[d].rangeType;if(m=="range"){let p=h[d].borderType,v=h[d].color,y=h[d].style,k=h[d].range;for(let b=0;b<k.length;b++){let w=k[b].row[0],x=k[b].row[1],C=k[b].column[0],S=k[b].column[1];if(w<e&&(w=e),x>n&&(x=n),C<t&&(C=t),S>l&&(S=l),p=="border-left")for(let _=w;_<=x;_++){if(s.rowhidden!=null&&s.rowhidden[_]!=null)continue;a[_+"_"+C]==null&&(a[_+"_"+C]={}),a[_+"_"+C].l={color:v,style:y};let T=C-1;if(T>=0&&a[_+"_"+T])if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let R=u[_][T],I=s.merge[R.mc.r+"_"+R.mc.c];I.c+I.cs-1==T&&(a[_+"_"+T].r={color:v,style:y})}else a[_+"_"+T].r={color:v,style:y};let F=s.merge||{};for(let R in F){let{c:I,r:P,cs:O,rs:M}=F[R];C<=I+O-1&&C>I&&_>=P&&_<=P+M-1&&(a[_+"_"+C].l=null)}}else if(p=="border-right")for(let _=w;_<=x;_++){if(s.rowhidden!=null&&s.rowhidden[_]!=null)continue;a[_+"_"+S]==null&&(a[_+"_"+S]={}),a[_+"_"+S].r={color:v,style:y};let T=S+1;if(T<u[0].length&&a[_+"_"+T])if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let R=u[_][T];s.merge[R.mc.r+"_"+R.mc.c].c==T&&(a[_+"_"+T].l={color:v,style:y})}else a[_+"_"+T].l={color:v,style:y};let F=s.merge||{};for(let R in F){let{c:I,r:P,cs:O,rs:M}=F[R];S<I+O-1&&S>=I&&_>=P&&_<=P+M-1&&(a[_+"_"+S].r=null)}}else if(p=="border-top"){if(s.rowhidden!=null&&s.rowhidden[w]!=null)continue;for(let _=C;_<=S;_++){a[w+"_"+_]==null&&(a[w+"_"+_]={}),a[w+"_"+_].t={color:v,style:y};let T=w-1;if(T>=0&&a[T+"_"+_])if(u[T]!=null&&N(u[T][_])=="object"&&u[T][_].mc!=null){let R=u[T][_],I=s.merge[R.mc.r+"_"+R.mc.c];I.r+I.rs-1==T&&(a[T+"_"+_].b={color:v,style:y})}else a[T+"_"+_].b={color:v,style:y};let F=s.merge||{};for(let R in F){let{c:I,r:P,cs:O,rs:M}=F[R];w<=P+M-1&&w>P&&_>=I&&_<=I+O-1&&(a[w+"_"+_].t=null)}}}else if(p=="border-bottom"){if(s.rowhidden!=null&&s.rowhidden[x]!=null)continue;for(let _=C;_<=S;_++){a[x+"_"+_]==null&&(a[x+"_"+_]={}),a[x+"_"+_].b={color:v,style:y};let T=x+1;if(T<u.length&&a[T+"_"+_])if(u[T]!=null&&N(u[T][_])=="object"&&u[T][_].mc!=null){let R=u[T][_];s.merge[R.mc.r+"_"+R.mc.c].r==T&&(a[T+"_"+_].t={color:v,style:y})}else a[T+"_"+_].t={color:v,style:y};let F=s.merge||{};for(let R in F){let{c:I,r:P,cs:O,rs:M}=F[R];x<P+M-1&&x>=P&&_>=I&&_<=I+O-1&&(a[x+"_"+_].b=null)}}}else if(p=="border-all"){for(let _=w;_<=x;_++)if(!(s.rowhidden!=null&&s.rowhidden[_]!=null))for(let T=C;T<=S;T++){if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let F=u[_][T],R=s.merge[F.mc.r+"_"+F.mc.c];R.r==_&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].t={color:v,style:y}),R.r+R.rs-1==_&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].b={color:v,style:y}),R.c==T&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y}),R.c+R.cs-1==T&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y})}else a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y},a[_+"_"+T].r={color:v,style:y},a[_+"_"+T].t={color:v,style:y},a[_+"_"+T].b={color:v,style:y};if(_==w){let F=w-1;if(F>=0&&a[F+"_"+T])if(u[F]!=null&&N(u[F][T])=="object"&&u[F][T].mc!=null){let R=u[F][T],I=s.merge[R.mc.r+"_"+R.mc.c];I.r+I.rs-1==F&&(a[F+"_"+T].b={color:v,style:y})}else a[F+"_"+T].b={color:v,style:y}}if(_==x){let F=x+1;if(F<u.length&&a[F+"_"+T])if(u[F]!=null&&N(u[F][T])=="object"&&u[F][T].mc!=null){let R=u[F][T];s.merge[R.mc.r+"_"+R.mc.c].r==F&&(a[F+"_"+T].t={color:v,style:y})}else a[F+"_"+T].t={color:v,style:y}}if(T==C){let F=C-1;if(F>=0&&a[_+"_"+F])if(u[_]!=null&&N(u[_][F])=="object"&&u[_][F].mc!=null){let R=u[_][F],I=s.merge[R.mc.r+"_"+R.mc.c];I.c+I.cs-1==F&&(a[_+"_"+F].r={color:v,style:y})}else a[_+"_"+F].r={color:v,style:y}}if(T==S){let F=S+1;if(F<u[0].length&&a[_+"_"+F])if(u[_]!=null&&N(u[_][F])=="object"&&u[_][F].mc!=null){let R=u[_][F];s.merge[R.mc.r+"_"+R.mc.c].c==F&&(a[_+"_"+F].l={color:v,style:y})}else a[_+"_"+F].l={color:v,style:y}}}}else if(p=="border-outside"){for(let _=w;_<=x;_++)if(!(s.rowhidden!=null&&s.rowhidden[_]!=null)){for(let T=C;T<=S;T++)if(_==w||_==x||T==C||T==S){if(_==w){a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].t={color:v,style:y};let F=w-1;if(F>=0&&a[F+"_"+T])if(u[F]!=null&&N(u[F][T])=="object"&&u[F][T].mc!=null){let R=u[F][T],I=s.merge[R.mc.r+"_"+R.mc.c];I.r+I.rs-1==F&&(a[F+"_"+T].b={color:v,style:y})}else a[F+"_"+T].b={color:v,style:y}}if(_==x){a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].b={color:v,style:y};let F=x+1;if(F<u.length&&a[F+"_"+T])if(u[F]!=null&&N(u[F][T])=="object"&&u[F][T].mc!=null){let R=u[F][T];s.merge[R.mc.r+"_"+R.mc.c].r==F&&(a[F+"_"+T].t={color:v,style:y})}else a[F+"_"+T].t={color:v,style:y}}if(T==C){a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y};let F=C-1;if(F>=0&&a[_+"_"+F])if(u[_]!=null&&N(u[_][F])=="object"&&u[_][F].mc!=null){let R=u[_][F],I=s.merge[R.mc.r+"_"+R.mc.c];I.c+I.cs-1==F&&(a[_+"_"+F].r={color:v,style:y})}else a[_+"_"+F].r={color:v,style:y}}if(T==S){a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y};let F=S+1;if(F<u[0].length&&a[_+"_"+F])if(u[_]!=null&&N(u[_][F])=="object"&&u[_][F].mc!=null){let R=u[_][F];s.merge[R.mc.r+"_"+R.mc.c].c==F&&(a[_+"_"+F].l={color:v,style:y})}else a[_+"_"+F].l={color:v,style:y}}}}}else if(p=="border-inside"){for(let _=w;_<=x;_++)if(!(s.rowhidden!=null&&s.rowhidden[_]!=null))for(let T=C;T<=S;T++)if(_==w&&T==C)u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null||(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y},a[_+"_"+T].b={color:v,style:y});else if(_==x&&T==C)u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null||(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y},a[_+"_"+T].t={color:v,style:y});else if(_==w&&T==S)u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null||(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y},a[_+"_"+T].b={color:v,style:y});else if(_==x&&T==S)u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null||(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y},a[_+"_"+T].t={color:v,style:y});else if(_==w)if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let F=u[_][T],R=s.merge[F.mc.r+"_"+F.mc.c];R.c==T?(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y}):R.c+R.cs-1==T&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y})}else a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y},a[_+"_"+T].r={color:v,style:y},a[_+"_"+T].b={color:v,style:y};else if(_==x)if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let F=u[_][T],R=s.merge[F.mc.r+"_"+F.mc.c];R.c==T?(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y}):R.c+R.cs-1==T&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y})}else a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y},a[_+"_"+T].r={color:v,style:y},a[_+"_"+T].t={color:v,style:y};else if(T==C)if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let F=u[_][T],R=s.merge[F.mc.r+"_"+F.mc.c];R.r==_?(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].t={color:v,style:y}):R.r+R.rs-1==_&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].b={color:v,style:y})}else a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y},a[_+"_"+T].t={color:v,style:y},a[_+"_"+T].b={color:v,style:y};else if(T==S)if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let F=u[_][T],R=s.merge[F.mc.r+"_"+F.mc.c];R.r==_?(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].t={color:v,style:y}):R.r+R.rs-1==_&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].b={color:v,style:y})}else a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y},a[_+"_"+T].t={color:v,style:y},a[_+"_"+T].b={color:v,style:y};else if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let F=u[_][T],R=s.merge[F.mc.r+"_"+F.mc.c];R.r==_?(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].t={color:v,style:y}):R.r+R.rs-1==_&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].b={color:v,style:y}),R.c==T?(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y}):R.c+R.cs-1==T&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y})}else a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y},a[_+"_"+T].r={color:v,style:y},a[_+"_"+T].t={color:v,style:y},a[_+"_"+T].b={color:v,style:y}}else if(p=="border-horizontal"){for(let _=w;_<=x;_++)if(!(s.rowhidden!=null&&s.rowhidden[_]!=null))for(let T=C;T<=S;T++)if(_==w)u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null||(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].b={color:v,style:y});else if(_==x)u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null||(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].t={color:v,style:y});else if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let F=u[_][T],R=s.merge[F.mc.r+"_"+F.mc.c];R.r==_?(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].t={color:v,style:y}):R.r+R.rs-1==_&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].b={color:v,style:y})}else a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].t={color:v,style:y},a[_+"_"+T].b={color:v,style:y}}else if(p=="border-vertical"){for(let _=w;_<=x;_++)if(!(s.rowhidden!=null&&s.rowhidden[_]!=null))for(let T=C;T<=S;T++)if(T==C)u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null||(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y});else if(T==S)u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null||(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y});else if(u[_]!=null&&N(u[_][T])=="object"&&u[_][T].mc!=null){let F=u[_][T],R=s.merge[F.mc.r+"_"+F.mc.c]||{};R.c==T?(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y}):R.c+R.cs-1==T&&(a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].r={color:v,style:y})}else a[_+"_"+T]==null&&(a[_+"_"+T]={}),a[_+"_"+T].l={color:v,style:y},a[_+"_"+T].r={color:v,style:y}}else if(p=="border-none"){for(let _=w;_<=x;_++)if(!(s.rowhidden!=null&&s.rowhidden[_]!=null))for(let T=C;T<=S;T++){if(a[_+"_"+T]!=null&&delete a[_+"_"+T],_==w){let F=w-1;F>=0&&a[F+"_"+T]&&delete a[F+"_"+T].b}if(_==x){let F=x+1;F<u.length&&a[F+"_"+T]&&delete a[F+"_"+T].t}if(T==C){let F=C-1;F>=0&&a[_+"_"+F]&&delete a[_+"_"+F].r}if(T==S){let F=S+1;F<u[0].length&&a[_+"_"+F]&&delete a[_+"_"+F].l}}}}}else if(m=="cell"){let p=h[d].value,v=p.row_index,y=p.col_index;if(v<e||v>n||y<t||y>l||s.rowhidden!=null&&s.rowhidden[v]!=null)continue;if(p.l!=null||p.r!=null||p.t!=null||p.b!=null)if(a[v+"_"+y]==null&&(a[v+"_"+y]={}),u[v]!=null&&N(u[v][y])=="object"&&u[v][y].mc!=null){let k=u[v][y],b=s.merge[k.mc.r+"_"+k.mc.c]||{};if(p.l!=null&&y==b.c){a[v+"_"+y].l={color:p.l.color,style:p.l.style};let w=y-1;if(w>=0&&a[v+"_"+w])if(u[v]!=null&&N(u[v][w])=="object"&&u[v][w].mc!=null){let x=u[v][w],C=s.merge[x.mc.r+"_"+x.mc.c];C.c+C.cs-1==w&&(a[v+"_"+w].r={color:p.l.color,style:p.l.style})}else a[v+"_"+w].r={color:p.l.color,style:p.l.style}}else a[v+"_"+y].l=null;if(p.r!=null&&y==b.c+b.cs-1){a[v+"_"+y].r={color:p.r.color,style:p.r.style};let w=y+1;if(w<u[0].length&&a[v+"_"+w])if(u[v]!=null&&N(u[v][w])=="object"&&u[v][w].mc!=null){let x=u[v][w];s.merge[x.mc.r+"_"+x.mc.c].c==w&&(a[v+"_"+w].l={color:p.r.color,style:p.r.style})}else a[v+"_"+w].l={color:p.r.color,style:p.r.style}}else a[v+"_"+y].r=null;if(p.t!=null&&v==b.r){a[v+"_"+y].t={color:p.t.color,style:p.t.style};let w=v-1;if(w>=0&&a[w+"_"+y])if(u[w]!=null&&N(u[w][y])=="object"&&u[w][y].mc!=null){let x=u[w][y],C=s.merge[x.mc.r+"_"+x.mc.c];C.r+C.rs-1==w&&(a[w+"_"+y].b={color:p.t.color,style:p.t.style})}else a[w+"_"+y].b={color:p.t.color,style:p.t.style}}else a[v+"_"+y].t=null;if(p.b!=null&&v==b.r+b.rs-1){a[v+"_"+y].b={color:p.b.color,style:p.b.style};let w=v+1;if(w<u.length&&a[w+"_"+y])if(u[w]!=null&&N(u[w][y])=="object"&&u[w][y].mc!=null){let x=u[w][y];s.merge[x.mc.r+"_"+x.mc.c].r==w&&(a[w+"_"+y].t={color:p.b.color,style:p.b.style})}else a[w+"_"+y].t={color:p.b.color,style:p.b.style}}else a[v+"_"+y].b=null}else{if(p.l!=null){a[v+"_"+y].l={color:p.l.color,style:p.l.style};let k=y-1;if(k>=0&&a[v+"_"+k])if(u[v]!=null&&N(u[v][k])=="object"&&u[v][k].mc!=null){let b=u[v][k],w=s.merge[b.mc.r+"_"+b.mc.c];w.c+w.cs-1==k&&(a[v+"_"+k].r={color:p.l.color,style:p.l.style})}else a[v+"_"+k].r={color:p.l.color,style:p.l.style}}else a[v+"_"+y].l=null;if(p.r!=null){a[v+"_"+y].r={color:p.r.color,style:p.r.style};let k=y+1;if(k<u[0].length&&a[v+"_"+k])if(u[v]!=null&&N(u[v][k])=="object"&&u[v][k].mc!=null){let b=u[v][k];s.merge[b.mc.r+"_"+b.mc.c].c==k&&(a[v+"_"+k].l={color:p.r.color,style:p.r.style})}else a[v+"_"+k].l={color:p.r.color,style:p.r.style}}else a[v+"_"+y].r=null;if(p.t!=null){a[v+"_"+y].t={color:p.t.color,style:p.t.style};let k=v-1;if(k>=0&&a[k+"_"+y])if(u[k]!=null&&N(u[k][y])=="object"&&u[k][y].mc!=null){let b=u[k][y],w=s.merge[b.mc.r+"_"+b.mc.c];w.r+w.rs-1==k&&(a[k+"_"+y].b={color:p.t.color,style:p.t.style})}else a[k+"_"+y].b={color:p.t.color,style:p.t.style}}else a[v+"_"+y].t=null;if(p.b!=null){a[v+"_"+y].b={color:p.b.color,style:p.b.style};let k=v+1;if(k<u.length&&a[k+"_"+y])if(u[k]!=null&&N(u[k][y])=="object"&&u[k][y].mc!=null){let b=u[k][y];s.merge[b.mc.r+"_"+b.mc.c].r==k&&(a[k+"_"+y].t={color:p.b.color,style:p.b.style})}else a[k+"_"+y].t={color:p.b.color,style:p.b.style}}else a[v+"_"+y].b=null}else delete a[v+"_"+y]}}return a}function Ur(e){let n={},t,l;return e==null?(t=f.config,l=f.flowdata):(t=f.luckysheetfile[Z(e)].config,l=f.luckysheetfile[Z(e)].data),n=Ls(0,l.length,0,l[0].length,e),n}var Bi=Me(()=>{Et();ht();Ke()});var Re,vv,nl,Os=Me(()=>{Zl();Ni();Bi();Nt();Fl();Yt();Jt();Ut();mr();Ml();Zt();Et();ht();Ke();kt();Re=El(pn()),vv={iconHtml:'<div id="luckysheet-dropCell-icon" style="position: absolute;padding: 2px;background-color: #f1f1f1;z-index: 990;cursor: pointer;"><div id="icon_dropCell"></div></div>',typeListHtml:'<div id="luckysheet-dropCell-typeList" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${copyCell}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="1"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${sequence}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${onlyFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="3"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${noFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="4"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${day}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="5"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${workDay}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="6"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${month}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="7"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${year}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="8"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${chineseNumber}</div></div></div>',copyRange:{},applyRange:{},applyType:null,direction:null,chnNumChar:{\u96F6:0,\u4E00:1,\u4E8C:2,\u4E09:3,\u56DB:4,\u4E94:5,\u516D:6,\u4E03:7,\u516B:8,\u4E5D:9},chnNameValue:{\u5341:{value:10,secUnit:!1},\u767E:{value:100,secUnit:!1},\u5343:{value:1e3,secUnit:!1},\u4E07:{value:1e4,secUnit:!0},\u4EBF:{value:1e8,secUnit:!0}},ChineseToNumber:function(e){let n=this,t=0,l=0,o=0,a=!1,s=e.split("");for(let u=0;u<s.length;u++){let h=n.chnNumChar[s[u]];if(typeof h!="undefined")o=h,u==s.length-1&&(l+=o);else{let d=n.chnNameValue[s[u]].value;a=n.chnNameValue[s[u]].secUnit,a?(l=(l+o)*d,t+=l,l=0):l+=o*d,o=0}}return t+l},chnNumChar2:["\u96F6","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D"],chnUnitSection:["","\u4E07","\u4EBF","\u4E07\u4EBF","\u4EBF\u4EBF"],chnUnitChar:["","\u5341","\u767E","\u5343"],SectionToChinese:function(e){let n=this,t="",l="",o=0,a=!0;for(;e>0;){let s=e%10;s==0?a||(a=!0,l=n.chnNumChar2[s]+l):(a=!1,t=n.chnNumChar2[s],t+=n.chnUnitChar[o],l=t+l),o++,e=Math.floor(e/10)}return l},NumberToChinese:function(e){let n=this,t=0,l="",o="",a=!1;if(e==0)return n.chnNumChar2[0];for(;e>0;){let s=e%1e4;a&&(o=n.chnNumChar2[0]+o),l=n.SectionToChinese(s),l+=s!=0?n.chnUnitSection[t]:n.chnUnitSection[0],o=l+o,a=s<1e3&&s>0,e=Math.floor(e/1e4),t++}return o},isChnNumber:function(e){let n=this,t=!0;if(e.length==1)e=="\u65E5"||e in n.chnNumChar?t=!0:t=!1;else{let l=e.split("");for(let o=0;o<l.length;o++)if(!(l[o]in n.chnNumChar||l[o]in n.chnNameValue)){t=!1;break}}return t},isExtendNumber:function(e){let n=/0|([1-9]+[0-9]*)/g,t=n.test(e);if(t){let l=e.match(n),o=l[l.length-1],a=e.lastIndexOf(o),s=e.substr(0,a),u=e.substr(a+o.length);return[t,Number(o),s,u]}else return[t]},isChnWeek1:function(e){let n=this,t;return e.length==1&&(e=="\u65E5"||n.ChineseToNumber(e)<7)?t=!0:t=!1,t},isChnWeek2:function(e){let n;return e.length==2&&(e=="\u5468\u4E00"||e=="\u5468\u4E8C"||e=="\u5468\u4E09"||e=="\u5468\u56DB"||e=="\u5468\u4E94"||e=="\u5468\u516D"||e=="\u5468\u65E5")?n=!0:n=!1,n},isChnWeek3:function(e){let n;return e.length==3&&(e=="\u661F\u671F\u4E00"||e=="\u661F\u671F\u4E8C"||e=="\u661F\u671F\u4E09"||e=="\u661F\u671F\u56DB"||e=="\u661F\u671F\u4E94"||e=="\u661F\u671F\u516D"||e=="\u661F\u671F\u65E5")?n=!0:n=!1,n},createIcon:function(){let e=this,n=e.copyRange.row[1],t=e.copyRange.column[1],l=e.applyRange.row[1],o=e.applyRange.column[1],a,s;l>=n&&o>=t?(a=l,s=o):(a=n,s=t);let u=tl(a)[1],h=tl(a)[0],d=Rt(s)[1],m=Rt(s)[0];$("#luckysheet-dropCell-icon").remove(),$("#luckysheet-cell-main").append(e.iconHtml),$("#luckysheet-dropCell-icon").css({left:d,top:u}),$("#luckysheet-dropCell-icon").mouseover(function(){$(this).css("background-color","#ffe8e8")}).mouseleave(function(){$(this).css("background-color","#f1f1f1")}).mousedown(function(p){$("#luckysheet-dropCell-typeList").remove();let y=Q().dropCell;$("body").append(_e(e.typeListHtml,{copyCell:y.copyCell,sequence:y.sequence,onlyFormat:y.onlyFormat,noFormat:y.noFormat,day:y.day,workDay:y.workDay,month:y.month,year:y.year,chineseNumber:y.chineseNumber}));let k=e.typeItemHide();!k[0]&&!k[1]&&!k[2]&&!k[3]&&!k[4]&&!k[5]&&!k[6]&&($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=1]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide()),k[2]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide()),k[3]||$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide();let b=$(this).offset().left,w=$(this).offset().top+25,x=$(window).height(),C=$(window).width(),S=$("#luckysheet-dropCell-typeList").width(),_=$("#luckysheet-dropCell-typeList").height();b+S>C&&(b=b-S),w+_>x&&(w=w-_-38),w<0&&(w=0),$("#luckysheet-dropCell-typeList").css({left:b,top:w}).show(),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#ffe8e8")});let T=e.applyType;$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type="+T+"]").find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'),p.stopPropagation()}),$(document).off("click.dCtypeList").on("click.dCtypeList","#luckysheet-dropCell-typeList .luckysheet-cols-menuitem",function(){$("#luckysheet-dropCell-typeList .fa-check").remove(),$(this).find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');let p=$(this).attr("data-type");e.applyType=p,e.update(),$("#luckysheet-dropCell-typeList").hide(),$("#luckysheet-dropCell-icon").css("backgroundColor","#f1f1f1"),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#f1f1f1")}),bl()})},typeItemHide:function(){let e=this,n=e.copyRange,t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1],s=!1,u=!1,h=!1,d=!1,m=!1,p=!1,v=!1;for(let y=t;y<=l;y++)for(let k=o;k<=a;k++)if(f.flowdata[y][k]){let b=f.flowdata[y][k];N(b)=="object"&&b.v!=null&&b.f==null&&(b.ct!=null&&b.ct.t=="n"?s=!0:b.ct!=null&&b.ct.t=="d"?h=!0:e.isExtendNumber(b.m)[0]?u=!0:e.isChnNumber(b.m)&&b.m!="\u65E5"?d=!0:b.m=="\u65E5"?m=!0:e.isChnWeek2(b.m)?p=!0:e.isChnWeek3(b.m)&&(v=!0))}return[s,u,h,d,m,p,v]},update:function(){let e=this;if(!pr([e.applyRange],f.currentSheetIndex)||f.allowEdit===!1)return;let n=xe.deepCopyFlowData(f.flowdata),t=f.luckysheetfile[Z(f.currentSheetIndex)],l=$.extend(!0,{},f.config),o=Ur(),a=$.extend(!0,{},t.dataVerification),s=e.direction,u=e.applyType,h=e.copyRange,d=h.row[0],m=h.row[1],p=h.column[0],v=h.column[1],y=e.getCopyData(n,d,m,p,v,s),k;s=="down"||s=="up"?k=m-d+1:(s=="right"||s=="left")&&(k=v-p+1);let b=e.applyRange,w=b.row[0],x=b.row[1],C=b.column[0],S=b.column[1];if(s=="down"||s=="up"){let F=x-w+1;for(let R=C;R<=S;R++){let I=y[R-C],P=e.getApplyData(I,k,F);if(s=="down")for(let O=w;O<=x;O++){let M=P[O-w];if(M.f!=null){let L="="+g.functionCopy(M.f,"down",O-w+1),E=g.execfunction(L,O,R);if(g.execFunctionGroup(O,R,E[1],void 0,n),M.f=E[2],M.v=E[1],M.spl!=null)M.spl=E[3].data;else if(B(M.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(M.v)){if(M.v==Infinity||M.v==-Infinity)M.m=M.v.toString();else if(M.v.toString().indexOf("e")>-1){let V=M.v.toString().split(".")[1].split("e")[0].length;V>5&&(V=5),M.m=M.v.toExponential(V).toString()}else{let V;M.ct.fa==="##0.00"?(V=nt(Math.round(M.v*1e9)/1e9+".00"),M.m=V[0].toString()):(V=nt(Math.round(M.v*1e9)/1e9),M.m=V[0].toString())}M.ct=M.ct||{fa:"General",t:"n"}}else{let V=nt(M.v);M.m=V[0].toString(),M.ct=V[1]}}n[O][R]=M;let A=d+(O-w)%k,z=R;if(o[A+"_"+z]){let L={rangeType:"cell",value:{row_index:O,col_index:R,l:o[A+"_"+z].l,r:o[A+"_"+z].r,t:o[A+"_"+z].t,b:o[A+"_"+z].b}};l.borderInfo.push(L)}else if(o[O+"_"+R]){let L={rangeType:"cell",value:{row_index:O,col_index:R,l:null,r:null,t:null,b:null}};l.borderInfo.push(L)}a[A+"_"+z]&&(a[O+"_"+R]=a[A+"_"+z])}if(s=="up")for(let O=x;O>=w;O--){let M=P[x-O];if(M.f!=null){let L="="+g.functionCopy(M.f,"up",x-O+1),E=g.execfunction(L,O,R);if(g.execFunctionGroup(O,R,E[1],void 0,n),M.f=E[2],M.v=E[1],M.spl!=null)M.spl=E[3].data;else if(B(M.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(M.v)){if(M.v==Infinity||M.v==-Infinity)M.m=M.v.toString();else if(M.v.toString().indexOf("e")>-1){let V=M.v.toString().split(".")[1].split("e")[0].length;V>5&&(V=5),M.m=M.v.toExponential(V).toString()}else{let V=nt(Math.round(M.v*1e9)/1e9);M.m=V[0].toString()}M.ct={fa:"General",t:"n"}}else{let V=nt(M.v);M.m=V[0].toString(),M.ct=V[1]}}n[O][R]=M;let A=m-(x-O)%k,z=R;if(o[A+"_"+z]){let L={rangeType:"cell",value:{row_index:O,col_index:R,l:o[A+"_"+z].l,r:o[A+"_"+z].r,t:o[A+"_"+z].t,b:o[A+"_"+z].b}};l.borderInfo.push(L)}else if(o[O+"_"+R]){let L={rangeType:"cell",value:{row_index:O,col_index:R,l:null,r:null,t:null,b:null}};l.borderInfo.push(L)}a[A+"_"+z]&&(a[O+"_"+R]=a[A+"_"+z])}}}else if(s=="right"||s=="left"){let F=S-C+1;for(let R=w;R<=x;R++){let I=y[R-w],P=e.getApplyData(I,k,F);if(s=="right")for(let O=C;O<=S;O++){let M=P[O-C];if(M.f!=null){let L="="+g.functionCopy(M.f,"right",O-C+1),E=g.execfunction(L,R,O);if(g.execFunctionGroup(R,O,E[1],void 0,n),M.f=E[2],M.v=E[1],M.spl!=null)M.spl=E[3].data;else if(B(M.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(M.v)){if(M.v==Infinity||M.v==-Infinity)M.m=M.v.toString();else if(M.v.toString().indexOf("e")>-1){let V=M.v.toString().split(".")[1].split("e")[0].length;V>5&&(V=5),M.m=M.v.toExponential(V).toString()}else{let V=nt(Math.round(M.v*1e9)/1e9);M.m=V[0].toString()}M.ct={fa:"General",t:"n"}}else{let V=nt(M.v);M.m=V[0].toString(),M.ct=V[1]}}n[R][O]=M;let A=R,z=p+(O-C)%k;if(o[A+"_"+z]){let L={rangeType:"cell",value:{row_index:R,col_index:O,l:o[A+"_"+z].l,r:o[A+"_"+z].r,t:o[A+"_"+z].t,b:o[A+"_"+z].b}};l.borderInfo.push(L)}else if(o[R+"_"+O]){let L={rangeType:"cell",value:{row_index:R,col_index:O,l:null,r:null,t:null,b:null}};l.borderInfo.push(L)}a[A+"_"+z]&&(a[R+"_"+O]=a[A+"_"+z])}if(s=="left")for(let O=S;O>=C;O--){let M=P[S-O];if(M.f!=null){let L="="+g.functionCopy(M.f,"left",S-O+1),E=g.execfunction(L,R,O);if(g.execFunctionGroup(R,O,E[1],void 0,n),M.f=E[2],M.v=E[1],M.spl!=null)M.spl=E[3].data;else if(B(M.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(M.v)){if(M.v==Infinity||M.v==-Infinity)M.m=M.v.toString();else if(M.v.toString().indexOf("e")>-1){let V=M.v.toString().split(".")[1].split("e")[0].length;V>5&&(V=5),M.m=M.v.toExponential(V).toString()}else{let V=nt(Math.round(M.v*1e9)/1e9);M.m=V[0].toString()}M.ct={fa:"General",t:"n"}}else{let V=nt(M.v);M.m=V[0].toString(),M.ct=V[1]}}n[R][O]=M;let A=R,z=v-(S-O)%k;if(o[A+"_"+z]){let L={rangeType:"cell",value:{row_index:R,col_index:O,l:o[A+"_"+z].l,r:o[A+"_"+z].r,t:o[A+"_"+z].t,b:o[A+"_"+z].b}};l.borderInfo.push(L)}else if(o[R+"_"+O]){let L={rangeType:"cell",value:{row_index:R,col_index:O,l:null,r:null,t:null,b:null}};l.borderInfo.push(L)}a[A+"_"+z]&&(a[R+"_"+O]=a[A+"_"+z])}}}let _=$.extend(!0,[],t.luckysheet_conditionformat_save);if(_!=null&&_.length>0)for(let F=0;F<_.length;F++){let R=_[F].cellrange,I=[];for(let P=0;P<R.length;P++){let O=Se.CFSplitRange(R[P],{row:h.row,column:h.column},{row:b.row,column:b.column},"operatePart");O.length>0&&(I=I.concat(O))}I.length>0&&_[F].cellrange.push(b)}let T={cfg:l,cdformat:_,dataVerification:a};Ze(n,f.luckysheet_select_save,T),lt()},getCopyData:function(e,n,t,l,o,a){let s=this,u=[],h,d,m,p;a=="down"||a=="up"?(h=l,d=o,m=n,p=t):(a=="right"||a=="left")&&(h=n,d=t,m=l,p=o);for(let v=h;v<=d;v++){let y={},k=[],b=[],w="",x=null,C=null,S=!0;for(let _=m;_<=p;_++){let T;a=="down"||a=="up"?T=e[_][v]:(a=="right"||a=="left")&&(T=e[v][_]);let F;if(!!T&&!!T.v&&T.f==null)if(!!T.ct&&T.ct.t=="n")F="number",x=null,C=null;else if(!!T.ct&&T.ct.t=="d")F="date",x=null,C=null;else if(s.isExtendNumber(T.m)[0]){F="extendNumber";let R=s.isExtendNumber(T.m);x==null||C==null?(S=!0,x=R[2],C=R[3]):R[2]!=x||R[3]!=C?(S=!1,x=R[2],C=R[3]):S=!0}else s.isChnNumber(T.m)?(F="chnNumber",x=null,C=null):s.isChnWeek2(T.m)?(F="chnWeek2",x=null,C=null):s.isChnWeek3(T.m)?(F="chnWeek3",x=null,C=null):(F="other",x=null,C=null);else F="other",x=null,C=null;F=="extendNumber"?_==m?m==p?(w=F,k.push(T),b.push(_-m+1),y[w]=[],y[w].push({data:k,index:b})):(w=F,k.push(T),b.push(_-m+1)):_==p?w==F&&S?(k.push(T),b.push(_-m+1),w in y?y[w].push({data:k,index:b}):(y[w]=[],y[w].push({data:k,index:b}))):(w in y?y[w].push({data:k,index:b}):(y[w]=[],y[w].push({data:k,index:b})),w=F,k=[],k.push(T),b=[],b.push(_-m+1),w in y?y[w].push({data:k,index:b}):(y[w]=[],y[w].push({data:k,index:b}))):w==F&&S?(k.push(T),b.push(_-m+1)):(w in y?y[w].push({data:k,index:b}):(y[w]=[],y[w].push({data:k,index:b})),w=F,k=[],k.push(T),b=[],b.push(_-m+1)):_==m?m==p?(w=F,k.push(T),b.push(_-m+1),y[w]=[],y[w].push({data:k,index:b})):(w=F,k.push(T),b.push(_-m+1)):_==p?w==F?(k.push(T),b.push(_-m+1),w in y?y[w].push({data:k,index:b}):(y[w]=[],y[w].push({data:k,index:b}))):(w in y?y[w].push({data:k,index:b}):(y[w]=[],y[w].push({data:k,index:b})),w=F,k=[],k.push(T),b=[],b.push(_-m+1),w in y?y[w].push({data:k,index:b}):(y[w]=[],y[w].push({data:k,index:b}))):w==F?(k.push(T),b.push(_-m+1)):(w in y?y[w].push({data:k,index:b}):(y[w]=[],y[w].push({data:k,index:b})),w=F,k=[],k.push(T),b=[],b.push(_-m+1))}u.push(y)}return u},getApplyData:function(e,n,t){let l=this,o=[],a=l.direction,s=l.applyType,u=Math.floor(t/n),h=t%n,d=e.number,m=[];if(d)for(let R=0;R<d.length;R++){let I=l.getLenS(d[R].index,h),P=d[R].index.length*u+I,O;s=="1"||s=="3"?O=l.getDataByType(d[R].data,P,a,s,"number"):s=="2"?O=l.getDataByType(d[R].data,P,a,s):O=l.getDataByType(d[R].data,P,a,"0");let M=l.getDataIndex(n,t,d[R].index);m.push({data:O,index:M})}let p=e.extendNumber,v=[];if(p)for(let R=0;R<p.length;R++){let I=l.getLenS(p[R].index,h),P=p[R].index.length*u+I,O;s=="1"||s=="3"?O=l.getDataByType(p[R].data,P,a,s,"extendNumber"):s=="2"?O=l.getDataByType(p[R].data,P,a,s):O=l.getDataByType(p[R].data,P,a,"0");let M=l.getDataIndex(n,t,p[R].index);v.push({data:O,index:M})}let y=e.date,k=[];if(y)for(let R=0;R<y.length;R++){let I=l.getLenS(y[R].index,h),P=y[R].index.length*u+I,O;s=="1"||s=="3"?O=l.getDataByType(y[R].data,P,a,s,"date"):s=="8"?O=l.getDataByType(y[R].data,P,a,"0"):O=l.getDataByType(y[R].data,P,a,s);let M=l.getDataIndex(n,t,y[R].index);k.push({data:O,index:M})}let b=e.chnNumber,w=[];if(b)for(let R=0;R<b.length;R++){let I=l.getLenS(b[R].index,h),P=b[R].index.length*u+I,O;s=="1"||s=="3"?O=l.getDataByType(b[R].data,P,a,s,"chnNumber"):s=="2"||s=="8"?O=l.getDataByType(b[R].data,P,a,s):O=l.getDataByType(b[R].data,P,a,"0");let M=l.getDataIndex(n,t,b[R].index);w.push({data:O,index:M})}let x=e.chnWeek2,C=[];if(x)for(let R=0;R<x.length;R++){let I=l.getLenS(x[R].index,h),P=x[R].index.length*u+I,O;s=="1"||s=="3"?O=l.getDataByType(x[R].data,P,a,s,"chnWeek2"):s=="2"?O=l.getDataByType(x[R].data,P,a,s):O=l.getDataByType(x[R].data,P,a,"0");let M=l.getDataIndex(n,t,x[R].index);C.push({data:O,index:M})}let S=e.chnWeek3,_=[];if(S)for(let R=0;R<S.length;R++){let I=l.getLenS(S[R].index,h),P=S[R].index.length*u+I,O;s=="1"||s=="3"?O=l.getDataByType(S[R].data,P,a,s,"chnWeek3"):s=="2"?O=l.getDataByType(S[R].data,P,a,s):O=l.getDataByType(S[R].data,P,a,"0");let M=l.getDataIndex(n,t,S[R].index);_.push({data:O,index:M})}let T=e.other,F=[];if(T)for(let R=0;R<T.length;R++){let I=l.getLenS(T[R].index,h),P=T[R].index.length*u+I,O;s=="2"||s=="3"?O=l.getDataByType(T[R].data,P,a,s):O=l.getDataByType(T[R].data,P,a,"0");let M=l.getDataIndex(n,t,T[R].index);F.push({data:O,index:M})}for(let R=1;R<=t;R++){if(m.length>0)for(let I=0;I<m.length;I++)R in m[I].index&&o.push(m[I].data[m[I].index[R]]);if(v.length>0)for(let I=0;I<v.length;I++)R in v[I].index&&o.push(v[I].data[v[I].index[R]]);if(k.length>0)for(let I=0;I<k.length;I++)R in k[I].index&&o.push(k[I].data[k[I].index[R]]);if(w.length>0)for(let I=0;I<w.length;I++)R in w[I].index&&o.push(w[I].data[w[I].index[R]]);if(C.length>0)for(let I=0;I<C.length;I++)R in C[I].index&&o.push(C[I].data[C[I].index[R]]);if(_.length>0)for(let I=0;I<_.length;I++)R in _[I].index&&o.push(_[I].data[_[I].index[R]]);if(F.length>0)for(let I=0;I<F.length;I++)R in F[I].index&&o.push(F[I].data[F[I].index[R]])}return o},getLenS:function(e,n){let t=0;for(let l=0;l<e.length&&e[l]<=n;l++)t++;return t},getDataIndex:function(e,n,t){let l={},o=Math.floor(n/e),a=n%e,s=0;if(o>0){for(let u=1;u<=o;u++)for(let h=0;h<t.length;h++)l[t[h]+(u-1)*e]=s,s++;for(let u=0;u<t.length&&t[u]<=a;u++)l[t[u]+e*o]=s,s++}else for(let u=0;u<t.length&&t[u]<=a;u++)l[t[u]]=s,s++;return l},getDataByType:function(e,n,t,l,o){let a=this,s=[];if(l=="0")(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n);else if(l=="1")if(o=="number")s=a.FillSeries(e,n,t);else if(o=="extendNumber")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillExtendNumber(e,n,u)}else{let u=[];for(let h=0;h<e.length;h++){let d=e[h].m;u.push(Number(a.isExtendNumber(d)[1]))}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let h=u[1]-u[0];s=a.FillExtendNumber(e,n,h)}else s=a.FillCopy(e,n)}else if(o=="date")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillDays(e,n,u)}else{(t=="up"||t=="left")&&e.reverse();let u=a.judgeDate(e);if(u[0]&&u[3]){let h=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months");s=a.FillMonths(e,n,h)}else if(!u[0]&&u[2]){let h=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"days");s=a.FillDays(e,n,h)}else s=a.FillCopy(e,n)}else if(o=="chnNumber")if(e.length==1)if(e[0].m=="\u65E5"||a.ChineseToNumber(e[0].m)<7){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnNumber(e,n,u)}else{let u=!1;for(let m=0;m<e.length;m++)if(e[m].m=="\u65E5"){u=!0;break}let h=[],d=0;for(let m=0;m<e.length;m++)e[m].m=="\u65E5"?m==0?h.push(0):(d++,h.push(d*7)):u&&a.ChineseToNumber(e[m].m)>0&&a.ChineseToNumber(e[m].m)<7?h.push(a.ChineseToNumber(e[m].m)+d*7):h.push(a.ChineseToNumber(e[m].m));if((t=="up"||t=="left")&&(e.reverse(),h.reverse()),a.isEqualDiff(h))if(u||h[h.length-1]<6&&h[0]>0||h[0]<6&&h[h.length-1]>0){let m=h[1]-h[0];s=a.FillChnWeek(e,n,m)}else{let m=h[1]-h[0];s=a.FillChnNumber(e,n,m)}else s=a.FillCopy(e,n)}else if(o=="chnWeek2")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek2(e,n,u)}else{let u=[],h=0;for(let d=0;d<e.length;d++){let m=e[d].m.substr(e[d].m.length-1,1);e[d].m=="\u5468\u65E5"?d==0?u.push(0):(h++,u.push(h*7)):u.push(a.ChineseToNumber(m)+h*7)}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let d=u[1]-u[0];s=a.FillChnWeek2(e,n,d)}else s=a.FillCopy(e,n)}else if(o=="chnWeek3")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek3(e,n,u)}else{let u=[],h=0;for(let d=0;d<e.length;d++){let m=e[d].m.substr(e[d].m.length-1,1);e[d].m=="\u661F\u671F\u65E5"?d==0?u.push(0):(h++,u.push(h*7)):u.push(a.ChineseToNumber(m)+h*7)}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let d=u[1]-u[0];s=a.FillChnWeek3(e,n,d)}else s=a.FillCopy(e,n)}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n);else if(l=="2")(t=="up"||t=="left")&&e.reverse(),s=a.FillOnlyFormat(e,n);else if(l=="3"){let u=a.getDataByType(e,n,t,"1",o);s=a.FillWithoutFormat(u)}else if(l=="4")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillDays(e,n,u)}else if(e.length==2){(t=="up"||t=="left")&&e.reverse();let u=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"days");s=a.FillDays(e,n,u)}else{(t=="up"||t=="left")&&e.reverse();let u=a.judgeDate(e);if(u[0]&&u[3]){let h=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months");s=a.FillMonths(e,n,h)}else if(!u[0]&&u[2]){let h=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"days");s=a.FillDays(e,n,h)}else s=a.FillCopy(e,n)}else if(l=="5")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1);let h=Math.round(n*1.5);for(let d=1;d<=h;d++){let m=$.extend(!0,{},e[0]),p=(0,Re.default)(m.m).add(d,"days").day();if(p==0||p==6)continue;let v=(0,Re.default)(m.m).add(u*d,"days").format("YYYY-MM-DD");if(m.m=v,m.v=nt(v)[2],s.push(m),s.length==n)break}}else if(e.length==2)if((0,Re.default)(e[1].m).date()==(0,Re.default)(e[0].m).date()&&(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months");for(let h=1;h<=n;h++){let d=(h-1)%e.length,m=$.extend(!0,{},e[d]),p=(0,Re.default)(e[e.length-1]).add(u*h,"months").day(),v;p==0?v=(0,Re.default)(e[e.length-1]).add(u*h,"months").subtract(2,"days").format("YYYY-MM-DD"):p==6?v=(0,Re.default)(e[e.length-1]).add(u*h,"months").subtract(1,"days").format("YYYY-MM-DD"):v=(0,Re.default)(e[e.length-1]).add(u*h,"months").format("YYYY-MM-DD"),m.m=v,m.v=nt(v)[2],s.push(m)}}else if(Math.abs((0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m)))>7){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let h;for(let d=1;d<=n;d++){let m=(d-1)%e.length,p=$.extend(!0,{},e[m]),v=Math.ceil(d/e.length);m==0&&(h=(0,Re.default)(p.m).add(u*v,"months").diff((0,Re.default)(p.m),"days"));let y=(0,Re.default)(p.m).add(h,"days").day(),k;y==0?k=(0,Re.default)(p.m).add(h,"days").subtract(2,"days").format("YYYY-MM-DD"):y==6?k=(0,Re.default)(p.m).add(h,"days").subtract(1,"days").format("YYYY-MM-DD"):k=(0,Re.default)(p.m).add(h,"days").format("YYYY-MM-DD"),p.m=k,p.v=nt(k)[2],s.push(p)}}else{let u;t=="down"||t=="right"?u=7:(t=="up"||t=="left")&&(u=-7,e.reverse());let h;for(let d=1;d<=n;d++){let m=(d-1)%e.length,p=$.extend(!0,{},e[m]),v=Math.ceil(d/e.length);m==0&&(h=(0,Re.default)(p.m).add(u*v,"days").diff((0,Re.default)(p.m),"days"));let y=(0,Re.default)(p.m).add(h,"days").day(),k;y==0?k=(0,Re.default)(p.m).add(h,"days").subtract(2,"days").format("YYYY-MM-DD"):y==6?k=(0,Re.default)(p.m).add(h,"days").subtract(1,"days").format("YYYY-MM-DD"):k=(0,Re.default)(p.m).add(h,"days").format("YYYY-MM-DD"),p.m=k,p.v=nt(k)[2],s.push(p)}}else{let u=a.judgeDate(e);if(u[0]&&u[3]){(t=="up"||t=="left")&&e.reverse();let h=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months");for(let d=1;d<=n;d++){let m=(d-1)%e.length,p=$.extend(!0,{},e[m]),v=(0,Re.default)(e[e.length-1].m).add(h*d,"months").day(),y;v==0?y=(0,Re.default)(e[e.length-1].m).add(h*d,"months").subtract(2,"days").format("YYYY-MM-DD"):v==6?y=(0,Re.default)(e[e.length-1].m).add(h*d,"months").subtract(1,"days").format("YYYY-MM-DD"):y=(0,Re.default)(e[e.length-1].m).add(h*d,"months").format("YYYY-MM-DD"),p.m=y,p.v=nt(y)[2],s.push(p)}}else if(!u[0]&&u[2])if(Math.abs((0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m)))>7){let h;t=="down"||t=="right"?h=1:(t=="up"||t=="left")&&(h=-1,e.reverse());let d;for(let m=1;m<=n;m++){let p=(m-1)%e.length,v=$.extend(!0,{},e[p]),y=Math.ceil(m/e.length);p==0&&(d=(0,Re.default)(v.m).add(h*y,"months").diff((0,Re.default)(v.m),"days"));let k=(0,Re.default)(v.m).add(d,"days").day(),b;k==0?b=(0,Re.default)(v.m).add(d,"days").subtract(2,"days").format("YYYY-MM-DD"):k==6?b=(0,Re.default)(v.m).add(d,"days").subtract(1,"days").format("YYYY-MM-DD"):b=(0,Re.default)(v.m).add(d,"days").format("YYYY-MM-DD"),v.m=b,v.v=nt(b)[2],s.push(v)}}else{let h;t=="down"||t=="right"?h=7:(t=="up"||t=="left")&&(h=-7,e.reverse());let d;for(let m=1;m<=n;m++){let p=(m-1)%e.length,v=$.extend(!0,{},e[p]),y=Math.ceil(m/e.length);p==0&&(d=(0,Re.default)(v.m).add(h*y,"days").diff((0,Re.default)(v.m),"days"));let k=(0,Re.default)(v.m).add(d,"days").day(),b;k==0?b=(0,Re.default)(v.m).add(d,"days").subtract(2,"days").format("YYYY-MM-DD"):k==6?b=(0,Re.default)(v.m).add(d,"days").subtract(1,"days").format("YYYY-MM-DD"):b=(0,Re.default)(v.m).add(d,"days").format("YYYY-MM-DD"),v.m=b,v.v=nt(b)[2],s.push(v)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="6")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillMonths(e,n,u)}else if(e.length==2)if((0,Re.default)(e[1].m).date()==(0,Re.default)(e[0].m).date()&&(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months");s=a.FillMonths(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let h;for(let d=1;d<=n;d++){let m=(d-1)%e.length,p=$.extend(!0,{},e[m]),v=Math.ceil(d/e.length);m==0&&(h=(0,Re.default)(p.m).add(u*v,"months").diff((0,Re.default)(p.m),"days"));let y=(0,Re.default)(p.m).add(h,"days").format("YYYY-MM-DD");p.m=y,p.v=nt(y)[2],s.push(p)}}else{let u=a.judgeDate(e);if(u[0]&&u[3]){(t=="up"||t=="left")&&e.reverse();let h=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months");s=a.FillMonths(e,n,h)}else if(!u[0]&&u[2]){let h;t=="down"||t=="right"?h=1:(t=="up"||t=="left")&&(h=-1,e.reverse());let d;for(let m=1;m<=n;m++){let p=(m-1)%e.length,v=$.extend(!0,{},e[p]),y=Math.ceil(m/e.length);p==0&&(d=(0,Re.default)(v.m).add(h*y,"months").diff((0,Re.default)(v.m),"days"));let k=(0,Re.default)(v.m).add(d,"days").format("YYYY-MM-DD");v.m=k,v.v=nt(k)[2],s.push(v)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="7")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillYears(e,n,u)}else if(e.length==2)if((0,Re.default)(e[1].m).date()==(0,Re.default)(e[0].m).date()&&(0,Re.default)(e[1].m).month()==(0,Re.default)(e[0].m).month()&&(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"years")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"years");s=a.FillYears(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let h;for(let d=1;d<=n;d++){let m=(d-1)%e.length,p=$.extend(!0,{},e[m]),v=Math.ceil(d/e.length);m==0&&(h=(0,Re.default)(p.m).add(u*v,"years").diff((0,Re.default)(p.m),"days"));let y=(0,Re.default)(p.m).add(h,"days").format("YYYY-MM-DD");p.m=y,p.v=nt(y)[2],s.push(p)}}else{let u=a.judgeDate(e);if(u[0]&&u[1]&&u[4]){(t=="up"||t=="left")&&e.reverse();let h=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"years");s=a.FillYears(e,n,h)}else if(u[0]&&u[3]||u[2]){let h;t=="down"||t=="right"?h=1:(t=="up"||t=="left")&&(h=-1,e.reverse());let d;for(let m=1;m<=n;m++){let p=(m-1)%e.length,v=$.extend(!0,{},e[p]),y=Math.ceil(m/e.length);p==0&&(d=(0,Re.default)(v.m).add(h*y,"years").diff((0,Re.default)(v.m),"days"));let k=(0,Re.default)(v.m).add(d,"days").format("YYYY-MM-DD");v.m=k,v.v=nt(k)[2],s.push(v)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="8")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnNumber(e,n,u)}else{let u=[];for(let h=0;h<e.length;h++)u.push(a.ChineseToNumber(e[h].m));if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let h=u[1]-u[0];s=a.FillChnNumber(e,n,h)}else s=a.FillCopy(e,n)}return s},FillCopy:function(e,n){let t=[];for(let l=1;l<=n;l++){let o=(l-1)%e.length,a=$.extend(!0,{},e[o]);t.push(a)}return t},FillSeries:function(e,n,t){let l=this,o=[],a=[];for(let s=0;s<e.length;s++)a.push(Number(e[s].v));if(e.length>2&&l.isEqualRatio(a))for(let s=1;s<=n;s++){let u=(s-1)%e.length,h=$.extend(!0,{},e[u]),d;t=="down"||t=="right"?d=Number(e[e.length-1].v)*Math.pow(Number(e[1].v)/Number(e[0].v),s):(t=="up"||t=="left")&&(d=Number(e[0].v)/Math.pow(Number(e[1].v)/Number(e[0].v),s)),h.v=d,h.m=mt(h.ct.fa,d),o.push(h)}else{let s=l.getXArr(e.length);for(let u=1;u<=n;u++){let h=(u-1)%e.length,d=$.extend(!0,{},e[h]),m;t=="down"||t=="right"?m=l.forecast(e.length+u,a,s):(t=="up"||t=="left")&&(m=l.forecast(1-u,a,s)),d.v=m,d.m=mt(d.ct.fa,m),o.push(d)}}return o},FillExtendNumber:function(e,n,t){let l=this,o=[],a=/0|([1-9]+[0-9]*)/g;for(let s=1;s<=n;s++){let u=(s-1)%e.length,h=$.extend(!0,{},e[u]),d=e[e.length-1].m,m=d.match(a),p=m[m.length-1],v=Math.abs(Number(p)+t*s),y=d.lastIndexOf(p),k=d.substr(0,y)+v.toString()+d.substr(y+p.length);h.v=k,h.m=k,o.push(h)}return o},FillOnlyFormat:function(e,n){let t=[];for(let l=1;l<=n;l++){let o=(l-1)%e.length,a=$.extend(!0,{},e[o]);delete a.f,delete a.m,delete a.v,t.push(a)}return t},FillWithoutFormat:function(e){let n=[];for(let t=0;t<e.length;t++){let l=$.extend(!0,{},e[t]),o;l.f==null?o={m:l.v.toString(),v:l.v}:o={f:l.f,m:l.v.toString(),v:l.v},n.push(o)}return n},FillDays:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=mt("yyyy-MM-dd",s.v);u=(0,Re.default)(u).add(t*o,"days").format("YYYY-MM-DD"),s.v=nt(u)[2],s.m=mt(s.ct.fa,s.v),l.push(s)}return l},FillMonths:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=mt("yyyy-MM-dd",s.v);u=(0,Re.default)(u).add(t*o,"months").format("YYYY-MM-DD"),s.v=nt(u)[2],s.m=mt(s.ct.fa,s.v),l.push(s)}return l},FillYears:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=mt("yyyy-MM-dd",s.v);u=(0,Re.default)(u).add(t*o,"years").format("YYYY-MM-DD"),s.v=nt(u)[2],s.m=mt(s.ct.fa,s.v),l.push(s)}return l},FillChnWeek:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),h;e[e.length-1].m=="\u65E5"?h=7+t*a:h=l.ChineseToNumber(e[e.length-1].m)+t*a,h<0&&(h=Math.ceil(Math.abs(h)/7)*7+h);let d=h%7;d==0?(u.m="\u65E5",u.v="\u65E5"):d==1?(u.m="\u4E00",u.v="\u4E00"):d==2?(u.m="\u4E8C",u.v="\u4E8C"):d==3?(u.m="\u4E09",u.v="\u4E09"):d==4?(u.m="\u56DB",u.v="\u56DB"):d==5?(u.m="\u4E94",u.v="\u4E94"):d==6&&(u.m="\u516D",u.v="\u516D"),o.push(u)}return o},FillChnWeek2:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),h;if(e[e.length-1].m=="\u5468\u65E5")h=7+t*a;else{let m=e[e.length-1].m,p=m.substr(m.length-1,1);h=l.ChineseToNumber(p)+t*a}h<0&&(h=Math.ceil(Math.abs(h)/7)*7+h);let d=h%7;d==0?(u.m="\u5468\u65E5",u.v="\u5468\u65E5"):d==1?(u.m="\u5468\u4E00",u.v="\u5468\u4E00"):d==2?(u.m="\u5468\u4E8C",u.v="\u5468\u4E8C"):d==3?(u.m="\u5468\u4E09",u.v="\u5468\u4E09"):d==4?(u.m="\u5468\u56DB",u.v="\u5468\u56DB"):d==5?(u.m="\u5468\u4E94",u.v="\u5468\u4E94"):d==6&&(u.m="\u5468\u516D",u.v="\u5468\u516D"),o.push(u)}return o},FillChnWeek3:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),h;if(e[e.length-1].m=="\u661F\u671F\u65E5")h=7+t*a;else{let m=e[e.length-1].m,p=m.substr(m.length-1,1);h=l.ChineseToNumber(p)+t*a}h<0&&(h=Math.ceil(Math.abs(h)/7)*7+h);let d=h%7;d==0?(u.m="\u661F\u671F\u65E5",u.v="\u661F\u671F\u65E5"):d==1?(u.m="\u661F\u671F\u4E00",u.v="\u661F\u671F\u4E00"):d==2?(u.m="\u661F\u671F\u4E8C",u.v="\u661F\u671F\u4E8C"):d==3?(u.m="\u661F\u671F\u4E09",u.v="\u661F\u671F\u4E09"):d==4?(u.m="\u661F\u671F\u56DB",u.v="\u661F\u671F\u56DB"):d==5?(u.m="\u661F\u671F\u4E94",u.v="\u661F\u671F\u4E94"):d==6&&(u.m="\u661F\u671F\u516D",u.v="\u661F\u671F\u516D"),o.push(u)}return o},FillChnNumber:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),h=l.ChineseToNumber(e[e.length-1].m)+t*a,d;h<=0?d="\u96F6":d=l.NumberToChinese(h),u.v=d,u.m=d.toString(),o.push(u)}return o},isEqualDiff:function(e){let n=!0,t=e[1]-e[0];for(let l=1;l<e.length;l++)if(e[l]-e[l-1]!=t){n=!1;break}return n},isEqualRatio:function(e){let n=!0,t=e[1]/e[0];for(let l=1;l<e.length;l++)if(e[l]/e[l-1]!=t){n=!1;break}return n},getXArr:function(e){let n=[];for(let t=1;t<=e;t++)n.push(t);return n},forecast:function(e,n,t){function l(m){let p=0;for(let v=0;v<m.length;v++)p+=m[v];return p/m.length}let o=l(t),a=l(n),s=0,u=0;for(let m=0;m<t.length;m++)s+=(t[m]-o)*(n[m]-a),u+=(t[m]-o)*(t[m]-o);let h;u==0?h=1:h=s/u;let d=a-h*o;return Math.round((d+h*e)*1e5)/1e5},judgeDate:function(e){let n=!0,t=!0,l=!0,o=!0,a=!0,s=(0,Re.default)(e[0].m).date(),u=(0,Re.default)(e[0].m).month(),h=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"days"),d=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"months"),m=(0,Re.default)(e[1].m).diff((0,Re.default)(e[0].m),"years");for(let p=1;p<e.length;p++)(0,Re.default)(e[p].m).date()!=s&&(n=!1),(0,Re.default)(e[p].m).month()!=u&&(t=!1),(0,Re.default)(e[p].m).diff((0,Re.default)(e[p-1].m),"days")!=h&&(l=!1),(0,Re.default)(e[p].m).diff((0,Re.default)(e[p-1].m),"months")!=d&&(o=!1),(0,Re.default)(e[p].m).diff((0,Re.default)(e[p-1].m),"years")!=m&&(a=!1);return h==0&&(l=!1),d==0&&(o=!1),m==0&&(a=!1),[n,t,l,o,a]}},nl=vv});var an,Y,Hl=Me(()=>{Et();Nr();Zt();yn();Qt();ol();Wr();Os();Zl();Ke();kt();Yt();an={freezenHorizontalHTML:'<div id="luckysheet-freezebar-horizontal" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-horizontal-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-horizontal-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-bar" >&nbsp;</div></div></div>',freezenVerticalHTML:'<div id="luckysheet-freezebar-vertical" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-vertical-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-vertical-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-bar" >&nbsp;</div></div></div>',initialHorizontal:!0,initialVertical:!0,horizontalmovestate:!1,horizontalmoveposition:null,verticalmovestate:!1,verticalmoveposition:null,windowHeight:null,windowWidth:null,freezenhorizontaldata:null,freezenverticaldata:null,freezenRealFirstRowColumn:!0,cutVolumn:function(e,n){if(n<=0)return e;let t=e.slice(0,n),l=t[t.length-1];return e.slice(n)},cancelFreezenVertical:function(e){let n=this,l=Q().freezen,o=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${l.default}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(o),$("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+l.freezenColumn),n.freezenverticaldata=null;let a=$("#luckysheet-freezebar-vertical").is(":visible");$("#luckysheet-freezebar-vertical").hide(),e==null&&(e=f.currentSheetIndex);let s=f.luckysheetfile[Z(e)];s.freezen!=null&&(s.freezen.vertical=null),s.frozen!=null&&a&&ne.saveParam("all",e,s.frozen,{k:"frozen"})},createFreezenVertical:function(e,n){let t=this;if(t.initialVertical){t.initialVertical=!1,$("#luckysheet-grid-window-1").append(t.freezenVerticalHTML),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").mousedown(function(){t.verticalmovestate=!0,t.verticalmoveposition=$(this).position().left,t.windowWidth=$("#luckysheet-grid-window-1").width(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grabbing")});let o=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:o-10,width:"4px",cursor:"-webkit-grab",top:"0px"}).end().find(".luckysheet-freezebar-vertical-drop").css({height:o-10,width:"4px",top:"0px",cursor:"-webkit-grab"})}if(e==null){if(t.freezenRealFirstRowColumn){let o=0;n=f.visibledatacolumn[o]-2+f.rowHeaderWidth,e=[f.visibledatacolumn[o],o+1,0,t.cutVolumn(f.visibledatacolumn,o+1),n]}else{let o=$("#luckysheet-cell-main").scrollLeft(),a=at(f.visibledatacolumn,o);a==-1&&(a=0),n=f.visibledatacolumn[a]-2-o+f.rowHeaderWidth,e=[f.visibledatacolumn[a],a+1,o,t.cutVolumn(f.visibledatacolumn,a+1),n]}t.saveFreezen(null,null,e,n)}t.freezenverticaldata=e;let l=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Q().freezen.freezenCancel}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(l),$("#luckysheet-freezebar-vertical").show().find(".luckysheet-freezebar-vertical-handle").css({left:n}).end().find(".luckysheet-freezebar-vertical-drop").css({left:n})},saveFreezen:function(e,n,t,l){let o=f.luckysheetfile[Z(f.currentSheetIndex)];o.freezen==null&&(o.freezen={}),e!=null&&(o.freezen.horizontal==null&&(o.freezen.horizontal={}),o.freezen.horizontal.freezenhorizontaldata=e,o.freezen.horizontal.top=n),t!=null&&(o.freezen.vertical==null&&(o.freezen.vertical={}),o.freezen.vertical.freezenverticaldata=t,o.freezen.vertical.left=l),o.frozen!=null&&ne.saveParam("all",f.currentSheetIndex,o.frozen,{k:"frozen"})},initialFreezen:function(e){let n=this;n.frozenTofreezen();let t=f.luckysheetfile[Z(e)];t.freezen!=null&&t.freezen.horizontal!=null&&t.freezen.horizontal.freezenhorizontaldata!=null?n.createFreezenHorizontal(t.freezen.horizontal.freezenhorizontaldata,t.freezen.horizontal.top):n.cancelFreezenHorizontal(e),t.freezen!=null&&t.freezen.vertical!=null&&t.freezen.vertical.freezenverticaldata!=null?n.createFreezenVertical(t.freezen.vertical.freezenverticaldata,t.freezen.vertical.left):n.cancelFreezenVertical(e),n.createAssistCanvas()},changeFreezenIndex:function(e,n){let t=this;if(n=="v"&&t.freezenverticaldata!=null){let l=t.freezenverticaldata[1],o=at(f.visibledatacolumn,$("#luckysheet-cell-main").scrollLeft());e-o<l&&(e=e-o)}else if(n=="h"&&t.freezenhorizontaldata!=null){let l=t.freezenhorizontaldata[1],o=at(f.visibledatarow,$("#luckysheet-cell-main").scrollTop());e-o<l&&(e=e-o)}return e},scrollFreezen:function(){let e=this,n,t=f.luckysheet_select_save[0].row_focus;t==f.luckysheet_select_save[0].row[0]?n=f.luckysheet_select_save[0].row[1]:t==f.luckysheet_select_save[0].row[1]&&(n=f.luckysheet_select_save[0].row[0]);let l,o=f.luckysheet_select_save[0].column_focus;if(o==f.luckysheet_select_save[0].column[0]?l=f.luckysheet_select_save[0].column[1]:o==f.luckysheet_select_save[0].column[1]&&(l=f.luckysheet_select_save[0].column[0]),e.freezenverticaldata!=null){let a=e.freezenverticaldata[1],s=at(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()),u=e.freezenverticaldata[4];a+=s,l>=f.visibledatacolumn.length&&(l=f.visibledatacolumn.length-1),a>=f.visibledatacolumn.length&&(a=f.visibledatacolumn.length-1);let h=f.visibledatacolumn[l],d=f.visibledatacolumn[a];h<=d+u&&setTimeout(function(){$("#luckysheet-scrollbar-x").scrollLeft(0)},100)}if(e.freezenhorizontaldata!=null){let a=e.freezenhorizontaldata[1],s=at(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()),u=e.freezenhorizontaldata[4];a+=s,n>=f.visibledatarow.length&&(n=f.visibledatarow.length-1),a>=f.visibledatarow.length&&(a=f.visibledatarow.length-1);let h=f.visibledatarow[n],d=f.visibledatarow[a];h<=d+u&&setTimeout(function(){$("#luckysheet-scrollbar-y").scrollTop(0)},100)}},cancelFreezenHorizontal:function(e){let n=this,t=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Q().freezen.default}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(t),n.freezenhorizontaldata=null;let l=$("#luckysheet-freezebar-horizontal").is(":visible");$("#luckysheet-freezebar-horizontal").hide(),e==null&&(e=f.currentSheetIndex);let o=f.luckysheetfile[Z(e)];o.freezen!=null&&(o.freezen.horizontal=null),o.frozen!=null&&l&&ne.saveParam("all",e,o.frozen,{k:"frozen"})},createFreezenHorizontal:function(e,n){let t=this;if(t.initialHorizontal){t.initialHorizontal=!1,$("#luckysheet-grid-window-1").append(t.freezenHorizontalHTML),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").mousedown(function(){t.horizontalmovestate=!0,t.horizontalmoveposition=$(this).position().top,t.windowHeight=$("#luckysheet-grid-window-1").height(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grabbing")});let o=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:o-10,height:"4px",cursor:"-webkit-grab",left:"0px"}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:o-10,height:"4px",left:"0px",cursor:"-webkit-grab"})}if(e==null){let o;if(t.freezenRealFirstRowColumn)o=0,n=f.visibledatarow[o]-2+f.columnHeaderHeight,e=[f.visibledatarow[o],o+1,0,t.cutVolumn(f.visibledatarow,o+1),n],t.saveFreezen(e,n,null,null),setTimeout(()=>{an.createAssistCanvas(),Be()});else{let a=$("#luckysheet-cell-main").scrollTop();o=at(f.visibledatarow,a),o==-1&&(o=0),n=f.visibledatarow[o]-2-a+f.columnHeaderHeight,e=[f.visibledatarow[o],o+1,a,t.cutVolumn(f.visibledatarow,o+1),n],t.saveFreezen(e,n,null,null)}}t.freezenhorizontaldata=e;let l=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Q().freezen.freezenCancel}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(l),$("#luckysheet-freezebar-horizontal").show().find(".luckysheet-freezebar-horizontal-handle").css({top:n}).end().find(".luckysheet-freezebar-horizontal-drop").css({top:n})},createAssistCanvas:function(){let e=this;if(e.removeAssistCanvas(),e.freezenverticaldata!=null||e.freezenhorizontaldata!=null){let n,t,l,o,a,s,u=f.luckysheetTableContentHW[0],h=f.luckysheetTableContentHW[1];e.freezenverticaldata!=null&&e.freezenhorizontaldata!=null?(n=e.freezenhorizontaldata[0],t=e.freezenhorizontaldata[1],l=e.freezenhorizontaldata[2],o=e.freezenverticaldata[0],a=e.freezenverticaldata[1],s=e.freezenverticaldata[2],e.createCanvas("freezen_3",o-s,n-l+1,f.rowHeaderWidth-1,f.columnHeaderHeight-1),e.createCanvas("freezen_4",u-o+s,n-l+1,o-s+f.rowHeaderWidth-1,f.columnHeaderHeight-1),e.createCanvas("freezen_7",o-s,h-n+l-f.columnHeaderHeight,f.rowHeaderWidth-1,n-l+f.columnHeaderHeight-1)):e.freezenhorizontaldata!=null?(n=e.freezenhorizontaldata[0],t=e.freezenhorizontaldata[1],l=e.freezenhorizontaldata[2],e.createCanvas("freezen_h",u,n-l+1,f.rowHeaderWidth-1,f.columnHeaderHeight-1)):e.freezenverticaldata!=null&&(o=e.freezenverticaldata[0],a=e.freezenverticaldata[1],s=e.freezenverticaldata[2],e.createCanvas("freezen_v",o-s,h,f.rowHeaderWidth-1,f.columnHeaderHeight-1)),e.scrollAdapt()}},createCanvas:function(e,n,t,l,o){let a=$("<canvas/>").appendTo("#luckysheet-grid-window-1").attr({id:e,width:Math.ceil(n*f.devicePixelRatio),height:Math.ceil(t*f.devicePixelRatio)}).css({"user-select":"none",postion:"absolute",left:l,top:o,width:n,height:t,"z-index":10,"pointer-events":"none"})},removeAssistCanvas:function(){$("#luckysheet-grid-window-1 > canvas").not($("#luckysheetTableContent")).remove(),$("#luckysheet-cell-selected").css("z-index",15)},scrollAdapt:function(){let e=this;if(f.luckysheet_select_save!=null&&f.luckysheet_select_save.length>0&&e.scrollAdaptOfselect(),$("#luckysheet-cell-main .luckysheet-data-visualization-chart").length>0){let n=f.luckysheetfile[Z(f.currentSheetIndex)].chart;n!=null&&n.length>0&&e.scrollAdaptOfchart()}$("#luckysheet-postil-showBoxs .luckysheet-postil-show").length>0&&e.scrollAdaptOfpostil(),$("#luckysheet-dropCell-icon").length>0&&e.scrollAdaptOfdpicon(),$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").length>0&&e.scrollAdaptOffilteroptions()},scrollAdaptOfselect:function(){let e=this;$("#luckysheet-row-count-show").is(":visible")&&$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").is(":visible")&&$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty();let n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenhorizontaldata[1],a=n-e.freezenhorizontaldata[2],s=e.freezenverticaldata[0],u=e.freezenverticaldata[1],h=t-e.freezenverticaldata[2];for(let d=0;d<f.luckysheet_select_save.length;d++){let m=$.extend(!0,{},f.luckysheet_select_save[d]),p=m.row[0],v=m.row[1],y=f.visibledatarow[v],k=p-1==-1?0:f.visibledatarow[p-1],b=k,w=y-k-1,x=!0;p>=o?b+w<l+a?x=!1:b<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css({top:l+a,height:w-(l+a-b)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css({top:b,height:w}):v>=o?b+w<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css({top:b+a,height:l-b}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css({top:b+a,height:w-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css("top",b+a);let C=m.column[0],S=m.column[1],_=f.visibledatacolumn[S],T=C-1==-1?0:f.visibledatacolumn[C-1],F=T,R=_-T-1;if(C>=u?F+R<s+h?x=!1:F<s+h?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css({left:s+h,width:R-(s+h-F)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css({left:F,width:R}):S>=u?F+R<s+h?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css({left:F+h,width:s-F}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css({left:F+h,width:R-h}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).show().css("left",F+h),x||$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(d).hide(),d==f.luckysheet_select_save.length-1){let I=m.row_focus==null?p:m.row_focus,P=m.column_focus==null?C:m.column_focus,O=f.visibledatarow[I],M=I-1==-1?0:f.visibledatarow[I-1],A=f.visibledatacolumn[P],z=P-1==-1?0:f.visibledatacolumn[P-1],L=be.mergeborer(f.flowdata,I,P);L&&(O=L.row[1],M=L.row[0],A=L.column[1],z=L.column[0]);let E=M,V=O-M-1,q=z,G=A-z-1,X=!0;E>=l?E+V<l+a?X=!1:E<l+a?$("#luckysheet-cell-selected-focus").show().css({top:l+a,height:V-(l+a-E)}):$("#luckysheet-cell-selected-focus").show().css({top:E,height:V}):E+V>=l?E+V<l+a?$("#luckysheet-cell-selected-focus").show().css({top:E+a,height:l-E}):$("#luckysheet-cell-selected-focus").show().css({top:E+a,height:V-a}):$("#luckysheet-cell-selected-focus").show().css("top",E+a),q>=s?q+G<s+h?X=!1:q<s+h?$("#luckysheet-cell-selected-focus").show().css({left:s+h,width:G-(s+h-q)}):$("#luckysheet-cell-selected-focus").show().css({left:q,width:G}):q+G>=s?q+G<s+h?$("#luckysheet-cell-selected-focus").show().css({left:q+h,width:s-q}):$("#luckysheet-cell-selected-focus").show().css({left:q+h,width:G-h}):$("#luckysheet-cell-selected-focus").show().css("left",q+h),X||$("#luckysheet-cell-selected-focus").hide()}}}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenhorizontaldata[1],a=n-e.freezenhorizontaldata[2];for(let s=0;s<f.luckysheet_select_save.length;s++){let u=$.extend(!0,{},f.luckysheet_select_save[s]),h=u.row[0],d=u.row[1],m=f.visibledatarow[d],p=h-1==-1?0:f.visibledatarow[h-1],v=p,y=m-p-1;if(h>=o?v+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).hide():v<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:l+a,height:y-(l+a-v)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:v,height:y}):d>=o?v+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:v+a,height:l-v}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:v+a,height:y-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css("top",v+a),s==f.luckysheet_select_save.length-1){let k=u.row_focus==null?h:u.row_focus,b=u.column_focus==null?u.column[0]:u.column_focus,w=f.visibledatarow[k],x=k-1==-1?0:f.visibledatarow[k-1],C=be.mergeborer(f.flowdata,k,b);C&&(w=C.row[1],x=C.row[0]);let S=x,_=w-x-1;S>=l?S+_<l+a?$("#luckysheet-cell-selected-focus").hide():S<l+a?$("#luckysheet-cell-selected-focus").show().css({top:l+a,height:_-(l+a-S)}):$("#luckysheet-cell-selected-focus").show().css({top:S,height:_}):S+_>=l?S+_<l+a?$("#luckysheet-cell-selected-focus").show().css({top:S+a,height:l-S}):$("#luckysheet-cell-selected-focus").show().css({top:S+a,height:_-a}):$("#luckysheet-cell-selected-focus").show().css("top",S+a)}}}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0],o=e.freezenverticaldata[1],a=t-e.freezenverticaldata[2];for(let s=0;s<f.luckysheet_select_save.length;s++){let u=$.extend(!0,{},f.luckysheet_select_save[s]),h=u.column[0],d=u.column[1],m=f.visibledatacolumn[d],p=h-1==-1?0:f.visibledatacolumn[h-1],v=p,y=m-p-1;if(h>=o?v+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).hide():v<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:l+a,width:y-(l+a-v)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:v,width:y}):d>=o?v+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:v+a,width:l-v}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:v+a,width:y-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css("left",v+a),s==f.luckysheet_select_save.length-1){let k=u.row_focus==null?u.row[0]:u.row_focus,b=u.column_focus==null?h:u.column_focus,w=f.visibledatacolumn[b],x=b-1==-1?0:f.visibledatacolumn[b-1],C=be.mergeborer(f.flowdata,k,b);C&&(w=C.column[1],x=C.column[0]);let S=x,_=w-x-1;S>=l?S+_<l+a?$("#luckysheet-cell-selected-focus").hide():S<l+a?$("#luckysheet-cell-selected-focus").show().css({left:l+a,width:_-(l+a-S)}):$("#luckysheet-cell-selected-focus").show().css({left:S,width:_}):S+_>=l?S+_<l+a?$("#luckysheet-cell-selected-focus").show().css({left:S+a,width:l-S}):$("#luckysheet-cell-selected-focus").show().css({left:S+a,width:_-a}):$("#luckysheet-cell-selected-focus").show().css("left",S+a)}}}else lt()},scrollAdaptOfchart:function(){let e=this,n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0]-e.freezenhorizontaldata[2],o=e.freezenverticaldata[0]-e.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(a,s){let u=$(s).position(),h=$(s).width(),d=$(s).height(),m=$(s).find("canvas").width(),p=$(s).find("canvas").height(),v=p-d,y=m-h;if(u.top-v<l){let k=l-(u.top-v);k>p+40+2?$(s).css("visibility","hidden"):($(s).css({top:l+n,height:p-k,visibility:"visible"}),$(s).find("canvas").css("top",-k))}else $(s).css({top:u.top-v+n,height:p,visibility:"visible"}),$(s).find("canvas").css("top",0);if(u.left-y<o){let k=o-(u.left-y);k>m+20+2?$(s).css("visibility","hidden"):($(s).css({left:o+t,width:m-k,visibility:"visible"}),$(s).find("canvas").css("left",-k))}else $(s).css({left:u.left-y+t,width:m,visibility:"visible"}),$(s).find("canvas").css("left",0)})}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0]-e.freezenhorizontaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(o,a){let s=$(a).position(),u=$(a).height(),h=$(a).find("canvas").height(),d=h-u;if(s.top-d<l){let m=l-(s.top-d);m>h+40+2?$(a).css("visibility","hidden"):($(a).css({top:l+n,height:h-m,visibility:"visible"}),$(a).find("canvas").css("top",-m))}else $(a).css({top:s.top-d+n,height:h,visibility:"visible"}),$(a).find("canvas").css("top",0)})}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0]-e.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(o,a){let s=$(a).position(),u=$(a).width(),h=$(a).find("canvas").width(),d=h-u;if(s.left-d<l){let m=l-(s.left-d);m>h+20+2?$(a).css("visibility","hidden"):($(a).css({left:l+t,width:h-m,visibility:"visible"}),$(a).find("canvas").css("left",-m))}else $(a).css({left:s.left-d+t,width:h,visibility:"visible"}),$(a).find("canvas").css("left",0)})}else $("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(l,o){let a=$(o).position(),s=$(o).width(),u=$(o).height(),h=$(o).find("canvas").width(),d=$(o).find("canvas").height(),m=d-u,p=h-s;$(o).css({top:a.top-m+n,height:d,left:a.left-p+t,width:h,visibility:"visible"}),$(o).find("canvas").css({top:0,left:0})})},scrollAdaptOfpostil:function(){let e=this,n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenverticaldata[0],a=n-e.freezenhorizontaldata[2],s=t-e.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(u,h){let d=$(h).attr("id"),m=d.split("luckysheet-postil-show_")[1].split("_")[0],p=d.split("luckysheet-postil-show_")[1].split("_")[1],v=f.flowdata[m][p].ps,y=f.visibledatarow[m],k=m-1==-1?0:f.visibledatarow[m-1],b=f.visibledatacolumn[p],w=p-1==-1?0:f.visibledatacolumn[p-1],x=be.mergeborer(f.flowdata,m,p);x&&(y=x.row[1],k=x.row[0],b=x.column[1],w=x.column[0]);let C=b,S=k,_=v.left==null?C+18:v.left,T=v.top==null?S-18:v.top,F=v.width==null?He.defaultWidth:v.width,R=v.height==null?He.defaultHeight:v.height;T<0&&(T=2);let I=He.getArrowCanvasSize(_,T,C,S),P=!0,O=!0;m>=e.freezenhorizontaldata[1]?T+R<l?($(h).show().find(".luckysheet-postil-show-main").css("top",T+a),$(h).show().find(".arrowCanvas").css("top",I[1]+a)):T<l+a?T+R<=l+a?P=!1:($(h).show().find(".luckysheet-postil-show-main").css({top:l+a,height:R-(l+a-T)}),$(h).show().find(".formulaInputFocus").css("margin-top",-(l+a-T)),$(h).show().find(".arrowCanvas").hide(),O=!1):($(h).show().find(".luckysheet-postil-show-main").css({top:T,height:R}),$(h).show().find(".formulaInputFocus").css("margin-top",0),$(h).show().find(".arrowCanvas").css("top",I[1])):($(h).show().find(".luckysheet-postil-show-main").css("top",T+a),$(h).show().find(".arrowCanvas").css("top",I[1]+a)),p>=e.freezenverticaldata[1]?_+F<o?($(h).show().find(".luckysheet-postil-show-main").css("left",_+s),$(h).show().find(".arrowCanvas").css("left",I[0]+s)):_<o+s?_+F<=o+s?P=!1:($(h).show().find(".luckysheet-postil-show-main").css({left:o+s,width:F-(o+s-_)}),$(h).show().find(".formulaInputFocus").css("margin-left",-(o+s-_)),$(h).show().find(".arrowCanvas").hide(),O=!1):($(h).show().find(".luckysheet-postil-show-main").css({left:_,width:F}),$(h).show().find(".formulaInputFocus").css("margin-left",0),$(h).show().find(".arrowCanvas").css("left",I[0])):($(h).show().find(".luckysheet-postil-show-main").css("left",_+s),$(h).show().find(".arrowCanvas").css("left",I[0]+s)),P||$(h).hide(),P&&O&&$(h).show().find(".arrowCanvas").show()})}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0],o=n-e.freezenhorizontaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(a,s){let u=$(s).attr("id"),h=u.split("luckysheet-postil-show_")[1].split("_")[0],d=u.split("luckysheet-postil-show_")[1].split("_")[1],m=f.flowdata[h][d].ps,p=f.visibledatarow[h],v=h-1==-1?0:f.visibledatarow[h-1],y=f.visibledatacolumn[d],k=d-1==-1?0:f.visibledatacolumn[d-1],b=be.mergeborer(f.flowdata,h,d);b&&(p=b.row[1],v=b.row[0],y=b.column[1],k=b.column[0]);let w=y,x=v,C=m.left==null?w+18:m.left,S=m.top==null?x-18:m.top,_=m.width==null?He.defaultWidth:m.width,T=m.height==null?He.defaultHeight:m.height;S<0&&(S=2);let F=He.getArrowCanvasSize(C,S,w,x);h>=e.freezenhorizontaldata[1]?S+T<l?($(s).show().find(".luckysheet-postil-show-main").css("top",S+o),$(s).show().find(".arrowCanvas").css("top",F[1]+o)):S<l+o?S+T<=l+o?$(s).hide():($(s).show().find(".luckysheet-postil-show-main").css({top:l+o,height:T-(l+o-S)}),$(s).show().find(".formulaInputFocus").css("margin-top",-(l+o-S)),$(s).show().find(".arrowCanvas").hide()):He.buildPs(h,d,m):($(s).show().find(".luckysheet-postil-show-main").css("top",S+o),$(s).show().find(".arrowCanvas").css("top",F[1]+o))})}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0],o=t-e.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(a,s){let u=$(s).attr("id"),h=u.split("luckysheet-postil-show_")[1].split("_")[0],d=u.split("luckysheet-postil-show_")[1].split("_")[1],m=f.flowdata[h][d].ps,p=f.visibledatarow[h],v=h-1==-1?0:f.visibledatarow[h-1],y=f.visibledatacolumn[d],k=d-1==-1?0:f.visibledatacolumn[d-1],b=be.mergeborer(f.flowdata,h,d);b&&(p=b.row[1],v=b.row[0],y=b.column[1],k=b.column[0]);let w=y,x=v,C=m.left==null?w+18:m.left,S=m.top==null?x-18:m.top,_=m.width==null?He.defaultWidth:m.width,T=m.height==null?He.defaultHeight:m.height;S<0&&(S=2);let F=He.getArrowCanvasSize(C,S,w,x);d>=e.freezenverticaldata[1]?C+_<l?($(s).show().find(".luckysheet-postil-show-main").css("left",C+o),$(s).show().find(".arrowCanvas").css("left",F[0]+o)):C<l+o?C+_<=l+o?$(s).hide():($(s).show().find(".luckysheet-postil-show-main").css({left:l+o,width:_-(l+o-C)}),$(s).show().find(".formulaInputFocus").css("margin-left",-(l+o-C)),$(s).show().find(".arrowCanvas").hide()):He.buildPs(h,d,m):($(s).show().find(".luckysheet-postil-show-main").css("left",C+o),$(s).show().find(".arrowCanvas").css("left",F[0]+o))})}else $("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(l,o){let a=$(o).attr("id"),s=a.split("luckysheet-postil-show_")[1].split("_")[0],u=a.split("luckysheet-postil-show_")[1].split("_")[1],h=f.flowdata[s][u].ps;He.buildPs(s,u,h)})},scrollAdaptOfdpicon:function(){let e=this,n=nl.copyRange.row[1],t=nl.copyRange.column[1],l=nl.applyRange.row[1],o=nl.applyRange.column[1],a,s;if(l>=n&&o>=t?(a=l,s=o):(a=n,s=t),e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let u=e.freezenhorizontaldata[1],h=at(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-e.freezenhorizontaldata[2]),d=e.freezenverticaldata[1],m=at(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);if(a>=u&&s>=d)a<u+h-1||s<d+m-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else if(a>=u)if(a<u+h-1)$("#luckysheet-dropCell-icon").hide();else{let p=Rt(s+m)[1];$("#luckysheet-dropCell-icon").show().css("left",p)}else if(s>=d)if(s<d+m-1)$("#luckysheet-dropCell-icon").hide();else{let p=tl(a+h)[1];$("#luckysheet-dropCell-icon").show().css("top",p)}else{let p=tl(a+h)[1],v=Rt(s+m)[1];$("#luckysheet-dropCell-icon").show().css({left:v,top:p})}}else if(e.freezenhorizontaldata!=null){let u=e.freezenhorizontaldata[1],h=at(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-e.freezenhorizontaldata[2]);if(a>=u)a<u+h-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{let d=tl(a+h)[1];$("#luckysheet-dropCell-icon").show().css("top",d)}}else if(e.freezenverticaldata!=null){let u=e.freezenverticaldata[1],h=at(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);if(s>=u)s<u+h-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{let d=Rt(s+h)[1];$("#luckysheet-dropCell-icon").show().css("left",d)}}else{let u=tl(a)[1],h=Rt(s)[1];$("#luckysheet-dropCell-icon").show().css({left:h,top:u})}},scrollAdaptOffilteroptions:function(){let e=this;if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let n=e.freezenhorizontaldata[1],t=e.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop(),l=e.freezenverticaldata[1],o=at(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").each(function(a,s){let u=$(s).data("str"),h=u-1==-1?0:f.visibledatarow[u-1],d=$(s).data("cindex");if(u>=n&&d>=l)h<t||d<l+o?$(s).hide():$(s).show();else if(u>=n)if(h<t)$(s).hide();else{let m=f.visibledatacolumn[d+o]-20;$(s).show().css("left",m)}else if(d>=l)d<l+o?$(s).hide():$(s).show().css("top",h+$("#luckysheet-cell-main").scrollTop());else{let m=f.visibledatacolumn[d+o]-20;$(s).show().css({left:m,top:h+$("#luckysheet-cell-main").scrollTop()})}})}else if(e.freezenhorizontaldata!=null){let n=e.freezenhorizontaldata[1],t=e.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").each(function(l,o){let a=$(o).data("str"),s=a-1==-1?0:f.visibledatarow[a-1];a>=n?s<t?$(o).hide():$(o).show():$(o).show().css("top",s+$("#luckysheet-cell-main").scrollTop())})}else if(e.freezenverticaldata!=null){let n=e.freezenverticaldata[1],t=at(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").each(function(l,o){let a=$(o).data("cindex");if(a>=n)a<n+t?$(o).hide():$(o).show();else{let s=f.visibledatacolumn[a+t]-20;$(o).show().css("left",s)}})}else $("#luckysheet-filter-options-sheet"+f.currentSheetIndex).empty(),Dl(f.luckysheetfile[Z(f.currentSheetIndex)].filter_select)},saveFrozen:function(e,n,t={}){n==null&&(n=Z(f.currentSheetIndex));let l=f.luckysheet_select_save[f.luckysheet_select_save.length-1],o=l.row_focus==null?l.row[0]:l.row_focus,a=l.column_focus==null?l.column[0]:l.column_focus,s={row_focus:t.row_focus||o,column_focus:t.column_focus||a},u={freezenRow:{type:"row"},freezenColumn:{type:"column"},freezenRC:{type:"both"},freezenRowRange:{type:"rangeRow",range:s},freezenColumnRange:{type:"rangeColumn",range:s},freezenRCRange:{type:"rangeBoth",range:s},freezenCancel:{type:"cancel"}};f.luckysheetfile[n].frozen=u[e]},frozenTofreezen:function(){let e=f.luckysheetfile[Z(f.currentSheetIndex)],n=e.frozen;if(n==null)return;let t=null;if(n.type==="row"){let l=0,o=at(f.visibledatarow,l);o==-1&&(o=0);let a=f.visibledatarow[o]-2-l+f.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[f.visibledatarow[o],o+1,l,an.cutVolumn(f.visibledatarow,o+1),a],top:a}}}else if(n.type==="column"){let l=0,o=at(f.visibledatacolumn,l);o==-1&&(o=0);let a=f.visibledatacolumn[o]-2-l+f.rowHeaderWidth;t={vertical:{freezenverticaldata:[f.visibledatacolumn[o],o+1,l,an.cutVolumn(f.visibledatacolumn,o+1),a],left:a}}}else if(n.type==="both"){let l=0,o=at(f.visibledatarow,l);o==-1&&(o=0);let a=f.visibledatarow[o]-2-l+f.columnHeaderHeight,s=[f.visibledatarow[o],o+1,l,an.cutVolumn(f.visibledatarow,o+1),a],u=0,h=at(f.visibledatacolumn,u);h==-1&&(h=0);let d=f.visibledatacolumn[h]-2-u+f.rowHeaderWidth,m=[f.visibledatacolumn[h],h+1,u,an.cutVolumn(f.visibledatacolumn,h+1),d];t={horizontal:{freezenhorizontaldata:s,top:a},vertical:{freezenverticaldata:m,left:d}}}else if(n.type==="rangeRow"){let l=0,o=at(f.visibledatarow,l),a=n.range.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=f.visibledatarow[o]-2-l+f.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[f.visibledatarow[o],o+1,l,an.cutVolumn(f.visibledatarow,o+1),s],top:s}}}else if(n.type==="rangeColumn"){let l=0,o=at(f.visibledatacolumn,l),a=n.range.column_focus;a>o&&(o=a),o==-1&&(o=0);let s=f.visibledatacolumn[o]-2-l+f.rowHeaderWidth;t={vertical:{freezenverticaldata:[f.visibledatacolumn[o],o+1,l,an.cutVolumn(f.visibledatacolumn,o+1),s],left:s}}}else if(n.type==="rangeBoth"){let l=0,o=at(f.visibledatarow,l),a=n.range.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=f.visibledatarow[o]-2-l+f.columnHeaderHeight,u=[f.visibledatarow[o],o+1,l,an.cutVolumn(f.visibledatarow,o+1),s],h=0,d=at(f.visibledatacolumn,h),m=n.range.column_focus;m>d&&(d=m),d==-1&&(d=0);let p=f.visibledatacolumn[d]-2-h+f.rowHeaderWidth,v=[f.visibledatacolumn[d],d+1,h,an.cutVolumn(f.visibledatacolumn,d+1),p];t={horizontal:{freezenhorizontaldata:u,top:s},vertical:{freezenverticaldata:v,left:p}}}else n.type==="cancel"&&(t={horizontal:null,vertical:null});e.freezen=t}},Y=an});function Ot(e=!0){de.showinfobar?($("#luckysheet_info_detail").show(),f.infobarHeight=document.querySelector("#luckysheet_info_detail").offsetHeight):(f.infobarHeight=0,$("#luckysheet_info_detail").hide()),!!f.toobarObject&&!!f.toobarObject.toobarElements&&f.toobarObject.toobarElements.length===0?($("#"+f.container).find(".luckysheet-wa-editor").hide(),f.toolbarHeight=0):($("#"+f.container).find(".luckysheet-wa-editor").show(),f.toolbarHeight=document.querySelector("#"+f.container+" .luckysheet-wa-editor").offsetHeight),yv(),kv();let n=document.querySelector("#"+f.container+" .luckysheet-wa-calculate");de.sheetFormulaBar?(n.style.display="block",f.calculatebarHeight=n.offsetHeight):(n.style.display="none",f.calculatebarHeight=0),$("#"+f.container).find(".luckysheet-grid-container").css("top",f.toolbarHeight+f.infobarHeight+f.calculatebarHeight),Vn=$("#"+f.container).width(),de.showConfigWindowResize&&($("#luckysheet-modal-dialog-slider-pivot").is(":visible")?Vn-=$("#luckysheet-modal-dialog-slider-pivot").outerWidth():$(".chartSetting").is(":visible")?Vn-=$(".chartSetting").outerWidth():$("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")&&(Vn-=$("#luckysheet-modal-dialog-slider-alternateformat").outerWidth()),$("#luckysheet-modal-dialog-slider-protection").is(":visible")&&(Vn-=$("#luckysheet-modal-dialog-slider-protection").outerWidth()));let l=Q().toolbar,o=!1,a=0,s=`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${l.toolMoreTip}" id="luckysheet-icon-morebtn" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;">

                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                        ${l.toolMore}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">
                    </div>

                </div>
            </div>
         </div>`,u='<div id="luckysheet-icon-morebtn-div" class="luckysheet-wa-editor" style="position:absolute;top:'+(f.infobarHeight+f.toolbarHeight+$("#"+f.container).offset().top+$("body").scrollTop())+'px;right:0px;z-index:1003;padding:5.5px;visibility:hidden;height:auto;white-space:initial;"></div>';$("#luckysheet-icon-morebtn-div").length==0&&$("body").append(u),Ge("#luckysheet-icon-morebtn-div").style.visibility="hidden",$("#luckysheet-icon-morebtn-div > div").each(function(){let p=$(this)[0],v=$("#luckysheet-wa-editor")[0];v.appendChild(document.createTextNode(" ")),v.appendChild(p)}),$("#luckysheet-icon-morebtn").remove();let h=f.toobarObject.toobarWidths,d=f.toobarObject.toobarElements,m=0;if(h!=null){for(let p=h.length-1;p>=0;p--)if(h[p]<Vn-90){m=p,m<h.length-1&&(o=!0);break}for(let p=m;p<d.length;p++){let v=d[p];if(v instanceof Array)for(let y of v)$("#luckysheet-icon-morebtn-div").append($(`${y}`));else $("#luckysheet-icon-morebtn-div").append($(`${v}`))}o&&($("#luckysheet-wa-editor").append(s),$("#luckysheet-icon-morebtn").click(function(){Ge("#luckysheet-icon-morebtn-div").style.left="";let p=Ge(`#${f.container}`).getBoundingClientRect?Ge(`#${f.container}`).getBoundingClientRect().left:0;Ge("#luckysheet-icon-morebtn-div").getBoundingClientRect().left<p&&(Ge("#luckysheet-icon-morebtn-div").style.left=p+"px");let y=$(window).width()-$("#luckysheet-icon-morebtn").offset().left-$("#luckysheet-icon-morebtn").width()+$("body").scrollLeft();if(Ge("#luckysheet-icon-morebtn-div").style.right=y<0?0:y+"px",Ge("#luckysheet-icon-morebtn-div").style.visibility==="hidden"?Ge("#luckysheet-icon-morebtn-div").style.visibility="visible":Ge("#luckysheet-icon-morebtn-div").style.visibility="hidden",$(this).find(".luckysheet-toolbar-menu-button-caption").text().indexOf(l.toolMore)>-1){let b=`
                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                    ${l.toolClose}
                </div>
                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-shangyige" style="user-select: none;font-size:12px;">
                </div>
                `;$(this).find(".luckysheet-toolbar-button-inner-box").html(b)}else{let b=`
                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                    ${l.toolMore}
                </div>
                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">
                </div>
                `;$(this).find(".luckysheet-toolbar-button-inner-box").html(b)}}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),W.createHoverTip("#luckysheet-icon-morebtn-div",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button")),$("#"+f.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#"+f.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),Bs=$("#"+f.container).height(),$("#"+f.container).find(".luckysheet").height(Bs-2).width(Vn-2),Hs(Vn,Bs),e&&Be($("#luckysheet-cell-main").scrollLeft(),$("#luckysheet-cell-main").scrollTop()),ye.sheetArrowShowAndHide(),ye.sheetBarShowAndHide()}}function Hs(e,n){e==null&&(e=$("#"+f.container).width()),n==null&&(n=$("#"+f.container).height()),f.cellmainHeight=n-(f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight+f.sheetBarHeight+f.statisticBarHeight),f.cellmainWidth=e-f.rowHeaderWidth,$("#luckysheet-cols-h-c, #luckysheet-cell-main").width(f.cellmainWidth),$("#luckysheet-cell-main").height(f.cellmainHeight),$("#luckysheet-rows-h").height(f.cellmainHeight-f.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").height(f.cellmainHeight+f.columnHeaderHeight-f.cellMainSrollBarSize-3),$("#luckysheet-scrollbar-x").height(f.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").width(f.cellMainSrollBarSize),$("#luckysheet-scrollbar-x").width(f.cellmainWidth).css("left",f.rowHeaderWidth-2),f.luckysheetTableContentHW=[f.cellmainWidth+f.rowHeaderWidth-f.cellMainSrollBarSize,f.cellmainHeight+f.columnHeaderHeight-f.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(f.luckysheetTableContentHW[0]*f.devicePixelRatio),height:Math.ceil(f.luckysheetTableContentHW[1]*f.devicePixelRatio)}).css({width:f.luckysheetTableContentHW[0],height:f.luckysheetTableContentHW[1]}),$("#"+f.container).find("#luckysheet-grid-window-1").css("bottom",f.sheetBarHeight),$("#"+f.container).find(".luckysheet-grid-window").css("bottom",f.statisticBarHeight);let t=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:t-10}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:t-10});let l=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:l-10}).end().find(".luckysheet-freezebar-vertical-drop").css({height:l-10}),Y.createAssistCanvas()}function Mh(){let e=de.showtoolbar,n=de.showtoolbarConfig,t=f.toobarObject.toobarWidths=[],l=f.toobarObject.toobarElements=[],o=f.toobarObject.toolbarConfig=a();function a(){let h={};function d(p){let v={},y,k,b=0;for(let w=0;w<p.length;w++)y=p[w],k=p[w+1],y!=="|"&&(v[y]={ele:Wa[y],index:b++}),k==="|"&&(N(v[y].ele)==="array"?v[y].ele.push(`#toolbar-separator-${Sn(y)}`):v[y].ele=[v[y].ele,`#toolbar-separator-${Sn(y)}`]);return v}if(N(n)==="array")return e?d(n):h;let m=Mr.reduce(function(p,v){return v!=="|"&&(p[v]=!0),p},{});if(!e)for(let p in m)m[p]=!1;if(JSON.stringify(n)!=="{}"){n.hasOwnProperty("undoRedo")&&(m.undo=m.redo=n.undoRedo),Object.assign(m,n);let p,v,y=0;for(let k=0;k<Mr.length;k++)p=Mr[k],v=Mr[k+1],m[p]!==!1&&(p!=="|"&&m[p]&&(h[p]={ele:Wa[p],index:y++}),v==="|"&&(N(h[p].ele)==="array"?h[p].ele.push(`#toolbar-separator-${Sn(p)}`):h[p].ele=[h[p].ele,`#toolbar-separator-${Sn(p)}`]))}else h=e?d(Mr):{};return h}for(let h in o)Object.prototype.hasOwnProperty.call(o,h)&&l.push($.extend(!0,{},o[h]));l.sort(s);function s(h,d){return h.index>d.index?1:-1}l.forEach((h,d,m)=>{m[d]=h.ele,d!==l.length-1?h.ele instanceof Array?t.push($(h.ele[0]).offset().left):t.push($(h.ele).offset().left):h.ele instanceof Array?(t.push($(h.ele[0]).offset().left),t.push($(h.ele[0]).offset().left+$(h.ele[0]).outerWidth()+5)):(t.push($(h.ele).offset().left),t.push($(h.ele).offset().left+$(h.ele).outerWidth()+5))});let u=$("#"+f.container).offset().left;t.forEach((h,d)=>{t[d]-=u})}function yv(){if(!de.initShowsheetbarConfig){de.initShowsheetbarConfig=!0;let t={add:!0,menu:!0,sheet:!0};if(!de.showsheetbar)for(let l in t)t[l]=!1;JSON.stringify(de.showsheetbarConfig)!=="{}"&&Object.assign(t,de.showsheetbarConfig),de.showsheetbarConfig=t}let e=de.showsheetbarConfig,n=0;for(let t in e)if(!e[t])switch(t){case"add":$("#luckysheet-sheets-add").hide(),n++;break;case"menu":$("#luckysheet-sheets-m").hide(),n++;break;case"sheet":$("#luckysheet-sheet-container").hide(),$("#luckysheet-sheets-leftscroll").hide(),$("#luckysheet-sheets-rightscroll").hide(),n++;break;default:break}n===3?($("#"+f.container).find("#luckysheet-sheet-area").hide(),f.sheetBarHeight=0):($("#"+f.container).find("#luckysheet-sheet-area").show(),f.sheetBarHeight=31)}function kv(){if(!de.initStatisticBarConfig){de.initStatisticBarConfig=!0;let t={count:!0,view:!0,zoom:!0};if(!de.showstatisticBar)for(let l in t)t[l]=!1;JSON.stringify(de.showstatisticBarConfig)!=="{}"&&Object.assign(t,de.showstatisticBarConfig),de.showstatisticBarConfig=t}let e=de.showstatisticBarConfig,n=0;for(let t in e)if(!e[t])switch(t){case"count":$("#luckysheet-sta-content").hide(),n++;break;case"view":$(".luckysheet-print-viewList").hide(),n++;break;case"zoom":$("#luckysheet-zoom-content").hide(),n++;break;default:break}n===3?($("#"+f.container).find(".luckysheet-stat-area").hide(),f.statisticBarHeight=0):($("#"+f.container).find(".luckysheet-stat-area").show(),f.statisticBarHeight=23)}var Vn,Bs,Br=Me(()=>{xl();Hl();Yt();Ke();kt();dl();ll();ht();Ua();Vn=0,Bs=0});function Lh(e){let n=Q(),t=n.protection,l=n.button,o=e.name,a=e.sqref,s=e.password,u="";s!=null&&s.length>0&&(u='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+t.rangeItemHasPassword+'"></i>');let h=`
        <div class="luckysheet-protection-rangeItem" title="${t.rangeItemDblclick}">
            <div class="luckysheet-protection-rangeItem-del" title="${l.delete}">
                <i class="icon iconfont luckysheet-iconfont-shanchu"></i>
            </div>
            <div class="luckysheet-protection-rangeItem-name" title="${o}">
                ${o}${u}
            </div>
            <div class="luckysheet-protection-rangeItem-range" title="${a}">
                ${a}
            </div>
            <div class="luckysheet-protection-rangeItem-update" title="${l.update}">
                <i class="icon iconfont luckysheet-iconfont-bianji"></i>
            </div>
        </div>
    `;$("#luckysheet-protection-rangeItem-container").append(h)}function bv(e){let n=Q(),t=n.protection,l=n.button;$("#luckysheet-slider-protection-ok").click(function(){let o=$("#protection-password").val(),a=$("#protection-swichProtectionState").is(":checked"),s=$("#protection-hint").val(),u=Nh,h={};u!=null&&u.config!=null&&u.config.authority!=null&&(h=u.config.authority);let d={},m="None";o!="\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"?(d.password=o,d.algorithmName="None",d.saltValue=null):h!=null?(d.algorithmName=h.algorithmName,d.saltValue=h.saltValue,d.password=h.password):(d.algorithmName="None",d.saltValue=null,d.password=""),d.hintText=s,d.sheet=a==!0?1:0;for(let p=0;p<Hi.length;p++){let v=Hi[p],y="luckysheet-protection-check-"+v,k=$("#"+y).is(":checked");d[v]=k==!0?1:0}d.allowRangeList=sn,sn=[],qs=!0,u.config==null&&(u.config={}),u.config.authority=d,js={},Hh()}),$("#luckysheet-slider-protection-cancel, #luckysheet-modal-dialog-protection-close").click(function(){Hh()}),$("#luckysheet-slider-protection-addRange").click(function(){Oh(),Vs=!0,$("#luckysheet-protection-rangeItem-confirm").html(l.insert),di("luckysheet-protection-rangeItem-dialog"),$("#protection-allowRangeAdd-title").val("Default"+sn.length),$("#protection-allowRangeAdd-range input").val(""),$("#protection-allowRangeAdd-password").val(""),$("#protection-allowRangeAdd-hint").val("")}),$(document).off("click.luckysheetProtection.rangeItemUpdate").on("click.luckysheetProtection.rangeItemUpdate","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-update",function(o){Oh(),Vs=!1,$("#luckysheet-protection-rangeItem-confirm").html(l.update),di("luckysheet-protection-rangeItem-dialog");let a=$(o.target).closest(".luckysheet-protection-rangeItem"),u=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(a),h=sn[u];Ph=u,$("#protection-allowRangeAdd-title").val(h.name),$("#protection-allowRangeAdd-range input").val(h.sqref),h.algorithmName=="None"?$("#protection-allowRangeAdd-password").val(h.password):$("#protection-allowRangeAdd-password").val("\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"),$("#protection-allowRangeAdd-hint").val(h.hintText)}),$(document).off("click.luckysheetProtection.rangeItemDelete").on("click.luckysheetProtection.rangeItemDelete","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-del",function(o){let a=$(o.target).closest(".luckysheet-protection-rangeItem"),u=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(a),h=sn[u];sn.splice(u,1),a.remove()}),$(document).off("click.luckysheetProtection.rangeItemConfirm").on("click.luckysheetProtection.rangeItemConfirm","#luckysheet-protection-rangeItem-confirm",function(){let o=$("#protection-allowRangeAdd-title").val(),a=$("#protection-allowRangeAdd-range input").val(),s=$("#protection-allowRangeAdd-password").val(),u=$("#protection-allowRangeAdd-hint").val();if(o.length==0){alert(t.rangeItemErrorTitleNull);return}let h=Ye.getRangeByTxt(a);if(a.length==0){alert(t.rangeItemErrorRangeNull);return}if(h.length==0){alert(t.rangeItemErrorRange);return}if(a=Vh(a),Vs){let d={name:o,password:s,hintText:u,algorithmName:"None",saltValue:null,checkRangePasswordUrl:null,sqref:a};Lh(d),sn.push(d)}else{let d=Ph,m=sn[d];m.name=o,m.sqref=a,m.hintText=u,s!="\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"&&(m.password=s,m.algorithmName="None");let v=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").eq(d),y=v.find(".luckysheet-protection-rangeItem-name"),k="";s!=null&&s.length>0&&(k='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+t.rangeItemHasPassword+'"></i>'),y.html(o+k).attr("title",o),v.find(".luckysheet-protection-rangeItem-range").html(a).attr("title",a)}$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$(document).off("click.luckysheetProtection.validationConfirm").on("click.luckysheetProtection.validationConfirm","#luckysheet-protection-sheet-validation-confirm",function(o){let a=$("#luckysheet-protection-sheet-validation"),s=pa;if(s==null){Ws(pa),a.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),Ot();return}let h=a.find("input").val();if(h==null||h.length==0){alert(t.checkPasswordNullalert);return}if(s.algorithmName!=null&&s.algorithmName!="None")if(s.saltValue!=null&&s.saltValue.length>0){var d=CryptoApi.getHasher(s.algorithmName);h=CryptoApi.hmac(s.saltValue,h,d)}else h=CryptoApi.hash(s.algorithmName,h);h==s.password?(Ws(pa),a.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),Ot(),qs=!1):alert(t.checkPasswordWrongalert)}),$("#luckysheet-protection-check-selectLockedCells").change(function(){let o=$("#luckysheet-protection-check-selectLockedCells"),a=$("#luckysheet-protection-check-selectunLockedCells"),s=o.is(":checked"),u=a.is(":checked");s&&a.prop("checked",!0)}),$("#luckysheet-protection-check-selectunLockedCells").change(function(){let o=$("#luckysheet-protection-check-selectLockedCells"),a=$("#luckysheet-protection-check-selectunLockedCells"),s=o.is(":checked");a.is(":checked")||o.prop("checked",!1)}),$(document).off("click.luckysheetProtection.dvRange").on("click.luckysheetProtection.dvRange","#protection-allowRangeAdd-range .fa-table",function(o){$("#luckysheet-protection-rangeItem-dialog").hide();let a="0",s=$(this).siblings("input").val().trim();Ye.rangeDialog(a,s),Ye.selectRange=[];let u=Ye.getRangeByTxt(s);if(u.length>0)for(let h=0;h<u.length;h++){let d=u[h].row[0],m=u[h].row[1],p=u[h].column[0],v=u[h].column[1],y=f.visibledatarow[m],k=d-1==-1?0:f.visibledatarow[d-1],b=f.visibledatacolumn[v],w=p-1==-1?0:f.visibledatacolumn[p-1];Ye.selectRange.push({left:w,width:b-w-1,top:k,height:y-k-1,left_move:w,width_move:b-w-1,top_move:k,height_move:y-k-1,row:[d,m],column:[p,v],row_focus:d,column_focus:p})}Pt(Ye.selectRange)}),$(document).off("click.luckysheetProtection.dvRange2").on("click.luckysheetProtection.dvRange2","#luckysheet-protection-rangeItem-dialog .show-box-item-dropdown .range .fa-table",function(o){$("#luckysheet-protection-rangeItem-dialog").hide();let a="1",s=$(this).siblings("input").val().trim();Ye.rangeDialog(a,s),Ye.selectRange=[];let u=Ye.getRangeByTxt(s);if(u.length>0)for(let h=0;h<u.length;h++){let d=u[h].row[0],m=u[h].row[1],p=u[h].column[0],v=u[h].column[1],y=f.visibledatarow[m],k=d-1==-1?0:f.visibledatarow[d-1],b=f.visibledatacolumn[v],w=p-1==-1?0:f.visibledatacolumn[p-1];Ye.selectRange.push({left:w,width:b-w-1,top:k,height:y-k-1,left_move:w,width_move:b-w-1,top_move:k,height_move:y-k-1,row:[d,m],column:[p,v],row_focus:d,column_focus:p})}Pt(Ye.selectRange)}),$(document).off("click.luckysheetProtection.dvRangeConfirm").on("click.luckysheetProtection.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(o){let a=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val(),s=$("#protection-allowRangeAdd-range input"),u=s.val();u.substr(u.length-1,1)==","?s.val(u+a):s.val(a),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),Pt([])}),$(document).off("click.luckysheetProtection.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(o){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),Pt([])}),$(document).on("click.luckysheetProtection.luckysheetProtection","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(o){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),Pt([])})}function Oh(e){if(zh)return;zh=!0;let n=Q(),t=n.protection,l=n.button;$("body").append(_e(dt,{id:"luckysheet-protection-rangeItem-dialog",addclass:"luckysheet-protection-rangeItem-dialog",title:t.allowRangeTitle,content:`
            <div class="luckysheet-protection-rangeItem-content">
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitle}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-title"  placeHolder="${t.allowRangeAddtitleDefault}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddSqrf}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <div id="protection-allowRangeAdd-range" class="range">
                            <input class="formulaInputFocus" spellcheck="false" placeHolder="${t.selectCellRangeHolder}">
                            <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                        </div>
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitlePassword}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-password"  placeHolder="${t.enterPassword}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitleHint}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <textarea class="luckysheet-protection-rangeItemTextarea" id="protection-allowRangeAdd-hint"  placeHolder="${t.allowRangeAddTitleHintTitle}"></textarea>
                    </div>
                </div>
            </div>
        `,botton:`<button id="luckysheet-protection-rangeItem-confirm" class="btn btn-primary">${l.insert}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"}))}function wv(e){let n=Q(),t=n.protection,l=n.button,o="";for(let s=0;s<Hi.length;s++){let u=Hi[s];o+=`
            <div class="luckysheet-slider-protection-row" style="height:18px;">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                <label for="luckysheet-protection-check-${u}"><input id="luckysheet-protection-check-${u}" name="luckysheet-protection-check-${u}" type="checkbox">${t[u]}</label>
                </div>
            </div>
        `}let a=`
    <div id="luckysheet-modal-dialog-slider-protection" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot" style="display:none;">
        <div class="luckysheet-modal-dialog-slider-title"> <span>${t.protectiontTitle}</span> <span id="luckysheet-modal-dialog-protection-close" title="${l.close}"><i class="fa fa-times" aria-hidden="true"></i></span> </div>
        <div class="luckysheet-modal-dialog-slider-content">
            <div class="luckysheet-slider-protection-config" style="top:10px;height:115px">
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    <label for="protection-swichProtectionState"><input id="protection-swichProtectionState" name="protection-swichProtectionState" type="checkbox">${t.swichProtectionTip}</label>
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="height:23px;">
                    <div class="luckysheet-slider-protection-column" style="width:98%;">
                        <input class="luckysheet-protection-input" id="protection-password"  placeHolder="${t.enterPassword}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="height:47px;margin-top:4px;">
                    <div class="luckysheet-slider-protection-column" style="width:98%;">
                        <textarea class="luckysheet-protection-textarea" id="protection-hint"  placeHolder="${t.enterHint}"></textarea>
                    </div>
                </div>
            </div>
            <div class="luckysheet-slider-protection-config" style="top:130px;height:290px;border-top:1px solid #c5c5c5">
                <div class="luckysheet-slider-protection-row" style="height:20px;">
                    ${t.authorityTitle}
                </div>
                ${o}
            </div>
            <div class="luckysheet-slider-protection-config" style="top:440px;bottom:45px;border-top:1px solid #c5c5c5">
                <div class="luckysheet-slider-protection-row" style="height:25px;">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:0px;line-height: 25px;">
                        ${t.allowRangeTitle}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x" style="left:70%;">
                        <div class="luckysheet-slider-protection-ok luckysheet-slider-protection-addRange" id="luckysheet-slider-protection-addRange">
                            ${t.allowRangeAdd}
                        </div>
                    </div>
                </div>

                <div id="luckysheet-protection-rangeItem-container" class="luckysheet-slider-protection-row" style="top:25px;bottom:0px;position:absolute">
                   
                </div>
            </div>
            <div class="luckysheet-slider-protection-config" style="bottom:0px;height:45px">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:0px;">
                    <div class="luckysheet-slider-protection-ok" id="luckysheet-slider-protection-ok">
                        ${l.confirm}
                    </div>
                </div>
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:50%;">
                    <div class="luckysheet-slider-protection-cancel" id="luckysheet-slider-protection-cancel">
                        ${l.cancel}
                    </div>
                </div>
            </div>
        </div>
    </div>
    `;$("body").append(a),$("body").append(_e(dt,{id:"luckysheet-protection-sheet-validation",addclass:"luckysheet-protection-sheet-validation",title:t.validationTitle,content:`
            <div class="luckysheet-slider-protection-row">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    ${t.validationTips}
                </div>
            </div>
            <div class="luckysheet-slider-protection-row" style="margin-top:20px">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="${t.validationInputHint}">
                </div>
            </div>
        `,botton:`<button id="luckysheet-protection-sheet-validation-confirm" class="btn btn-primary">${l.confirm}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"}))}function Ws(e){e==null&&(e={});for(let o=0;o<Hi.length;o++){let a=Hi[o],s="luckysheet-protection-check-"+a,u=e[a];u==null&&(u=0),u==null&&a in{selectLockedCells:1,selectunLockedCells:1}&&(u=1),$("#"+s).prop("checked",u==1)}e.password!=null&&e.password.length>0?e.algorithmName=="None"||e.algorithmName==null?$("#protection-password").val(e.password):$("#protection-password").val("\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"):$("#protection-password").val("");let n=e.sheet;e.sheet==null&&(n=0),$("#protection-swichProtectionState").prop("checked",n==1);let t=e.hintText;t==null&&(t=""),$("#protection-hint").val(t),sn=[],$("#luckysheet-protection-rangeItem-container").empty();let l=e.allowRangeList;if(l!=null&&l.length>0)for(let o=0;o<l.length;o++){let a=l[o];Lh(a),sn.push(a)}}function Bh(e){if(Ah||(wv(e),bv(e),Ah=!0),Nh=e,e!=null&&e.config!=null&&e.config.authority!=null){let n=e.config.authority;if(qs&&n.sheet==1&&n.password!=null&&n.password.length>0){pa=n,$("#luckysheet-protection-sheet-validation input").val(""),di("luckysheet-protection-sheet-validation");return}else Ws(n)}else $("#luckysheet-protection-check-selectLockedCells").prop("checked",!0),$("#luckysheet-protection-check-selectunLockedCells").prop("checked",!0);$("#luckysheet-modal-dialog-slider-protection").show(),Ot()}function Hh(){$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-slider-protection").hide(),Ot()}function Us(e,n,t,l,o=!0,a=!0){let s=!1,u=t.allowRangeList;if(u!=null&&u.length>0){let h=!1;for(let d=0;d<u.length;d++){let m=u[d],p=m.sqref,v=Ye.getRangeByTxt(p);if(v.length>0)for(let y=0;y<v.length;y++){let k=v[y].row[0],b=v[y].row[1],w=v[y].column[0],x=v[y].column[1];if(e>=k&&e<=b&&n>=w&&n<=x){h=!0;break}}if(h){let y=m.password;if(y!=null&&y.length>0&&!(p in js))return o&&(xv(m),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()),!1;s=!0;break}}}if(!s&&!a&&(s=!0),!s&&o){let h;t.hintText!=null&&t.hintText.length>0?h=t.hintText:h=l.defaultSheetHintText,W.info("",h),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()}return s}function xv(e){let n=Q(),t=n.protection,l=n.button;Eh||$("body").append(_e(dt,{id:"luckysheet-protection-range-validation",addclass:"luckysheet-protection-sheet-validation",title:t.validationTitle,content:`
                <div class="luckysheet-slider-protection-row">
                    <div id="luckysheet-protection-range-validation-hint" class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                        
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="margin-top:20px">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                        <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="${t.validationInputHint}">
                    </div>
                </div>
            `,botton:`<button id="luckysheet-protection-range-validation-confirm" class="btn btn-primary">${l.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"})),Eh=!0,di("luckysheet-protection-range-validation");let o=$("#luckysheet-protection-range-validation-hint");e.hintText!=null&&e.hintText.length>0?o.html(e.hintText):o.html(t.defaultRangeHintText);let a=$("#luckysheet-protection-range-validation"),s=a.find("input");s.val(""),$("#luckysheet-protection-range-validation-confirm").off("click").on("click",function(){let u=s.val();if(u==null||u.length==0){alert(t.checkPasswordNullalert);return}if(e.algorithmName!=null&&e.algorithmName!="None")if(e.saltValue!=null&&e.saltValue.length>0){var h=CryptoApi.getHasher(e.algorithmName);u=CryptoApi.hmac(e.saltValue,u,h)}else u=CryptoApi.hash(e.algorithmName,u);u==e.password?(js[e.sqref]=1,a.hide(),$("#luckysheet-modal-dialog-mask").hide(),alert(t.checkPasswordSucceedalert)):alert(t.checkPasswordWrongalert)})}function jr(e){let n=ye.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;let t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0)return!0;let o=Q().protection,a;return t.hintText!=null&&t.hintText.length>0?a=t.hintText:a=o.defaultSheetHintText,W.info("",a),!1}function kn(e,n,t,l=!0,o=!0){let a=ye.getSheetByIndex(t);if(a==null||a.config==null||a.config.authority==null)return!0;let s=a.data,u=s[e][n],h=a.config.authority;if(h==null||h.sheet==null||h.sheet==0||u&&u.lo===0)return!0;let m=Q().protection;return Us(e,n,h,m,l,o)}function va(e,n,t){let l=ye.getSheetByIndex(t);if(!l||l.data&&!l.data[e]||l.data&&!l.data[e][n]||l.config==null||l.config.authority==null)return!0;let o=l.data,a=o[e][n],s=l.config.authority;return s==null||s.sheet==null||s.sheet==0||a==null||a.hi==null||a.hi==0}function pr(e,n){let t=ye.getSheetByIndex(n);if(t==null||t.config==null||t.config.authority==null)return!0;let l=t.config.authority;if(l==null||l.sheet==null||l.sheet==0||e==null||e.length==0)return!0;let a=Q().protection;for(let s=0;s<e.length;s++){let u=e[s].row[0],h=e[s].row[1],d=e[s].column[0],m=e[s].column[1];for(let p=u;p<=h;p++)for(let v=d;v<=m;v++){let y=t.data[p][v]||{},k=y.lo===void 0||y.lo===1;if(!Us(p,v,l,a,!0,k))return!1}}return!0}function Gs(e,n,t){let o=Q().protection,a=ye.getSheetByIndex(t);if(a==null||a.config==null||a.config.authority==null)return!0;let s=a.data,u=s[e][n],h=a.config.authority;return h==null||h.sheet==null||h.sheet==0?!0:u&&u.lo===0||Us(e,n,h,o,!1)?h.selectunLockedCells==1||h.selectunLockedCells==null:h.selectLockedCells==1||h.selectLockedCells==null}function Fo(e){let t=Q().protection,l=ye.getSheetByIndex(e);if(l==null||l.config==null||l.config.authority==null)return!0;let o=l.config.authority;if(o==null||o.sheet==null||o.sheet==0)return!0;let a=!1;(o.selectunLockedCells==1||o.selectunLockedCells==null)&&(a=!0);let s=!1;return(o.selectLockedCells==1||o.selectLockedCells==null)&&(s=!0),!!(a&&s)}function Sr(e){let n=ye.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;let t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0||t.formatCells==1||t.formatCells==null)return!0;let o=Q().protection,a;return t.hintText!=null&&t.hintText.length>0?a=t.hintText:a=o.defaultSheetHintText,W.info("",a),!1}function Tt(e,n="formatColumns",t=!0){let l=ye.getSheetByIndex(e);if(l==null||l.config==null||l.config.authority==null)return!0;let o=l.config.authority;if(o==null||o.sheet==null||o.sheet==0||o[n]==1||o[n]==null)return!0;if(t){let s=Q().protection,u;o.hintText!=null&&o.hintText.length>0?u=o.hintText:u=s.defaultSheetHintText,W.info("",u)}return!1}var Ah,zh,sn,Vs,Ph,pa,Nh,qs,js,Eh,Hi,Ml=Me(()=>{Ke();kt();Wt();Et();Zn();dl();Br();gr();ht();Zt();ll();Vr();Ah=!1,zh=!1,sn=[],Vs=!0,Ph=null,pa=null,Nh=null,qs=!0,js={},Eh=!1,Hi=["selectLockedCells","selectunLockedCells","formatCells","formatColumns","formatRows","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","filter","usePivotTablereports","editObjects","editScenarios"]});function Hr(e,n,t){t==null&&(t=!0);let l=function(a,s){let u=a[n],h=s[n];if(N(a[n])=="object"&&(u=a[n].v),N(s[n])=="object"&&(h=s[n].v),me(u))return 1;if(me(h))return-1;if(zt(u)&&zt(h))return ul(u,h);if(B(u)&&B(h))return(0,bn.default)(u).value()-(0,bn.default)(h).value();if(!B(u)&&!B(h))return u.localeCompare(h,"zh");if(B(u)){if(!B(h))return-1}else return 1},o=function(a,s){let u=a[n],h=s[n];if(N(a[n])=="object"&&(u=a[n].v),N(s[n])=="object"&&(h=s[n].v),me(u))return 1;if(me(h))return-1;if(zt(u)&&zt(h))return ul(h,u);if(B(u)&&B(h))return(0,bn.default)(h).value()-(0,bn.default)(u).value();if(!B(u)&&!B(h))return h.localeCompare(u,"zh");if(B(u)){if(!B(h))return 1}else return-1};return t?e.sort(l):e.sort(o)}function ma(e,n){n==null&&(n=!0);let t=function(o,a){let s=o,u=a;if(N(o)=="object"&&(s=o.v),N(a)=="object"&&(u=a.v),s==null&&(s=""),u==null&&(u=""),zt(s)&&zt(u))return ul(s,u);if(B(s)&&B(u))return(0,bn.default)(s).value()-(0,bn.default)(u).value();if(!B(s)&&!B(u))return s.localeCompare(u,"zh");if(B(s)){if(!B(u))return-1}else return 1},l=function(o,a){let s=o,u=a;if(N(o)=="object"&&(s=o.v),N(a)=="object"&&(u=a.v),s==null&&(s=""),u==null&&(u=""),zt(s)&&zt(u))return ul(u,s);if(B(s)&&B(u))return(0,bn.default)(u).value()-(0,bn.default)(s).value();if(!B(s)&&!B(u))return u.localeCompare(s,"zh");if(B(s)){if(!B(u))return 1}else return-1};return n?e.sort(t):e.sort(l)}function Ys(e){if(!Tt(f.currentSheetIndex,"sort"))return;let t=Q().sort;if(f.luckysheet_select_save.length>1){he()?alert(t.noRangeError):W.info(t.noRangeError,"");return}e==null&&(e=!0);let l=xe.deepCopyFlowData(f.flowdata),o=f.luckysheet_select_save[0].row[0],a=f.luckysheet_select_save[0].row[1],s=f.luckysheet_select_save[0].column[0],u=f.luckysheet_select_save[0].column[1],h,d;for(let y=o;y<=a;y++)if(l[y]!=null&&l[y][s]!=null){let k=l[y][s];if(k.mc!=null||me(k.v))continue;if(h==null&&/[\u4e00-\u9fa5]+/g.test(k.v)){h=y+1,d=y+1;continue}h==null&&(h=y),d=y}if(h==null||h>a)return;let m=!1,p=[];for(let y=h;y<=d;y++){let k=[];for(let b=s;b<=u;b++){if(l[y][b]!=null&&l[y][b].mc!=null){m=!0;break}k.push(l[y][b])}p.push(k)}if(m){he()?alert(t.mergeError):W.info(t.mergeError,"");return}p=Hr(p,0,e);for(let y=h;y<=d;y++)for(let k=s;k<=u;k++)l[y][k]=p[y-h][k-s];let v={};if(f.config.rowlen!=null){let y=$.extend(!0,{},f.config);y=pl(l,h,d,y),v={cfg:y,RowlChange:!0}}Ze(l,[{row:[h,d],column:[s,u]}],v)}function Xs(e,n){if(!Tt(f.currentSheetIndex,"sort"))return;n==null&&(n=!0);let l=Q().sort,o=xe.deepCopyFlowData(f.flowdata),a=0,s=o.length-1,u=0,h=o[0].length-1,d,m;for(let k=a;k<=s;k++)if(!(o[k][e]!=null&&o[k][e].mc!=null)){if(o[k][e]!=null&&!me(o[k][e].v)&&/[\u4e00-\u9fa5]+/g.test(o[k][e].v)&&d==null){d=k+1,m=k+1;continue}d==null&&(d=k),o[k][e]!=null&&!me(o[k][e].v)&&(m=k)}if(d==null||d>s)return;let p=!1,v=[];for(let k=d;k<=m;k++){let b=[];for(let w=u;w<=h;w++){if(o[k][w]!=null&&o[k][w].mc!=null){p=!0;break}b.push(o[k][w])}v.push(b)}if(p){he()?alert(l.columnSortMergeError):W.info(l.columnSortMergeError,"");return}v=Hr(v,e,n);for(let k=d;k<=m;k++)for(let b=u;b<=h;b++)o[k][b]=v[k-d][b-u];let y={};if(f.config.rowlen!=null){let k=$.extend(!0,{},f.config);k=pl(o,d,m,k),y={cfg:k,RowlChange:!0}}Ze(o,[{row:[d,m],column:[u,h]}],y)}var bn,ui=Me(()=>{ht();Nt();Lr();ll();Jt();dr();Yt();Ml();Ke();kt();bn=El(ai())});var _v,qh,jh=Me(()=>{Kt();_v={transpose:function(e,n=!0){let t=[];if(e.length==0)return[];if(e[0].length==0)return[];for(let l=0;l<e[0].length;l++){let o=[];for(let a=0;a<e.length;a++){let s="";e[a]!=null&&e[a][l]!=null&&(n?s=Le(a,l,e):s=e[a][l]),o.push(s)}t.push(o)}return t},minusClear:function(e,n){if(n.row[0]>e.row[1]||n.row[1]<e.row[0]||n.column[0]>e.column[1]||n.column[1]<e.column[0])return null;if(n.row[0]==e.row[0]&&n.row[1]<e.row[1]&&n.column[0]>e.column[0]&&n.column[1]<e.column[1])return[];let t=[],l={row:[],column:[]},o=null,a=[e.column[0],e.column[1]];n.row[1]>e.row[0]&&n.row[1]<e.row[1]?o=[n.row[1]+1,e.row[1]]:n.row[0]>e.row[0]&&n.row[0]<e.row[1]&&(o=[e.row[0],n.row[0]-1]),o!=null&&t.push({row:o,column:a});let s=[e.row[0],e.row[1]],u=null;return n.column[1]>e.column[0]&&n.column[1]<e.column[1]?u=[n.column[1]+1,e.column[1]]:n.column[0]>e.column[0]&&n.column[0]<e.column[1]&&(u=[e.column[0],n.column[0]-1]),u!=null&&t.push({row:s,column:u}),t}},qh=_v});var Cv,Do,Wh=Me(()=>{ht();Cv={STDEVP:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Il(Math.sqrt(t/n.length))},STDEV:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Il(Math.sqrt(t/(n.length-1)))},VARP:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Il(t/n.length)},let:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Il(t/(n.length-1))}},Do=Cv});var Mo,Uh,Oe,nn=Me(()=>{Et();ht();Kt();Lr();Fl();Nt();ui();Yt();ll();Jt();Vr();jh();Wh();Zt();Nr();Wt();dl();Br();Qt();Ml();Ke();kt();Mo=El(ai());Wt();Uh={pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,getCellData:function(e,n,t){let l=this,o;e!=null?o=e:o=f.currentSheetIndex;let a=Z(o);N(f.luckysheetfile[a].pivotTable)!="object"&&(f.luckysheetfile[a].pivotTable=new Function("return "+f.luckysheetfile[a].pivotTable)()),f.luckysheetfile[a].pivotTable!=null?(l.column=f.luckysheetfile[a].pivotTable.column,l.row=f.luckysheetfile[a].pivotTable.row,l.values=f.luckysheetfile[a].pivotTable.values,l.filter=f.luckysheetfile[a].pivotTable.filter,l.showType=f.luckysheetfile[a].pivotTable.showType,l.filterparm=f.luckysheetfile[a].pivotTable.filterparm,f.luckysheetfile[a].pivotTable.drawPivotTable!=null?l.drawPivotTable=f.luckysheetfile[a].pivotTable.drawPivotTable:l.drawPivotTable=!0,f.luckysheetfile[a].pivotTable.pivotTableBoundary!=null?l.pivotTableBoundary=f.luckysheetfile[a].pivotTable.pivotTableBoundary:l.pivotTableBoundary=[12,6],t!=null?l.pivot_select_save=t:l.pivot_select_save=f.luckysheetfile[a].pivotTable.pivot_select_save,n!=null?l.pivotDataSheetIndex=n:l.pivotDataSheetIndex=f.luckysheetfile[a].pivotTable.pivotDataSheetIndex):(l.column=null,l.row=null,l.values=null,l.filter=null,l.showType=null,l.filterparm=null,l.drawPivotTable=!0,l.pivotTableBoundary=[12,6],t!=null?l.pivot_select_save=t:l.pivot_select_save=f.luckysheet_select_save,n!=null?l.pivotDataSheetIndex=n:l.pivotDataSheetIndex=o);let s=Z(l.pivotDataSheetIndex),u=f.luckysheetfile[s];u.data==null&&(u.data=ye.buildGridData(u)),l.origindata=Co(u.data,l.pivot_select_save);let h={};if(l.filterparm!=null)for(let m in l.filterparm)for(let p in l.filterparm[m])p==="rowhidden"&&l.filterparm[m][p]!=null&&(h=$.extend(!0,h,l.filterparm[m][p]));l.rowhidden=h,l.pivotSheetIndex=o;let d=[];for(let m=0;m<l.origindata.length;m++)l.rowhidden!=null&&l.rowhidden[m]!=null||d.push([].concat(l.origindata[m]));l.celldata=d,l.pivot_data_type={};for(let m=0;m<l.celldata[1].length;m++){let p=tr(l.celldata[1][m]);l.pivot_data_type[m.toString()]=p}},pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},showvaluecolrow:function(){let e=this;$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").length>=2?($("#luckysheetpivottablevaluecolrowshow").show(),e.showType=="column"?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active"))):$("#luckysheetpivottablevaluecolrowshow").hide()},resetOrderby:function(e){let n=$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").index(e);$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("orderby")==n&&$(this).data("orderby","self")})},luckysheetsliderlistclearfilter:function(e){let n=this,t=e.parent(),l=t.data("index"),o={},a={},s=n.origindata,u={};t.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),n.setDatatojsfile("selected",{},l),n.setDatatojsfile("rowhidden",null,l);let h=[];for(let d=0;d<s.length;d++)o[d]==null&&h.push([].concat(s[d]));n.celldata=h,n.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()},luckysheetsliderlistitemfilter:function(e){let n=this,l=Q().filter,o=e.parent(),a=o.offset(),s=$("#luckysheet-pivotTableFilter-menu"),u=$(window).height(),h=$(window).width(),d=o.data("index"),m=o.data("rowhidden");m==null||m==""?m={}:N(m)=="string"&&(m=JSON.parse(m)),$("body .luckysheet-cols-menu").hide(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-byvalue-input").val(""),$("#luckysheet-pivotTableFilter-bycondition").next().hide(),$("#luckysheet-pivotTableFilter-byvalue").next().show(),s.data("index",d),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text(l.filiterInputNone);let p=o.data("byconditiontype");if($("#luckysheet-pivotTableFilter-selected span").data("value",o.data("byconditionvalue")).data("type",p).text(o.data("byconditiontext")),p=="2"){let b=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show().find("input");b.eq(0).val(o.data("byconditionvalue1")),b.eq(1).val(o.data("byconditionvalue2"))}else p=="1"&&$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show().find("input").val(o.data("byconditionvalue1"));let v=Ar("#luckysheet-pivotTableFilter-byvalue-select",{text:l.filiterMoreDataTip});$("#luckysheet-pivotTableFilter-byvalue-select").empty().append(v.el);let y={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").not(o.get(0)).each(function(){let b=$(this),w=b.data("rowhidden");if(w==null||w=="")return!0;N(w)=="string"&&(w=JSON.parse(w));for(let x in w)y[x]=0});let k=n.origindata;setTimeout(function(){let b={},w={},x={},C={};for(let T=1;T<k.length;T++){if(T in y||k[T]==null)continue;let F=k[T][d];if(F!=null&&F.ct!=null&&F.ct.t=="d"){let R=mt("YYYY-MM-DD",F.v),I=R.split("-")[0],P=R.split("-")[1],O=R.split("-")[2];I in b||(b[I]={}),P in b[I]||(b[I][P]={}),O in b[I][P]||(b[I][P][O]=0),b[I][P][O]++,T in m&&(w[I]=0,w[P]=0,w[O]=0)}else{let R,I;F==null||me(F.v)?(R=null,I=null):(R=F.v,I=F.m),R in x||(x[R]={}),I in x[R]||(x[R][I]=0),x[R][I]++,T in m&&(C[R+"#$$$#"+I]=0)}}let S=[];if(JSON.stringify(b).length>2)for(let T in b){let F=0,R="";for(let P in b[T]){let O=0,M="";for(let z in b[T][P]){let L=b[T][P][z];O+=L;let E;Number(P)<10?E="0"+Number(P):E=P;let V;Number(z)<10?V="0"+Number(z):V=z,T in w&&P in w&&z in w?M+='<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+T+"-"+E+"-"+V+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+z+'</label><span class="count luckysheet-mousedown-cancel">( '+L+" )</span></div>":M+='<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+T+"-"+E+"-"+V+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+z+'</label><span class="count luckysheet-mousedown-cancel">( '+L+" )</span></div>"}F+=O;let A;Number(P)<10?A="0"+Number(P):A=P,T in w&&P in w?R+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+T+"-"+A+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+P+""+l.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+O+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+M+"</div></div>":R+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+T+"-"+A+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+P+""+l.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+O+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+M+"</div></div>"}let I;T in w?I='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+T+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+T+""+l.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+F+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+R+"</div></div>":I='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+T+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+T+""+l.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+F+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+R+"</div></div>",S.unshift(I)}if(JSON.stringify(x).length>2){let T=Object.keys(x);T=ma(T,!0);for(let F=0;F<T.length;F++){let R=T[F];for(let I in x[R]){let P;R+"#$$$#"+I=="null#$$$#null"?P=l.valueBlank:P=I;let O;R+"#$$$#"+I in C?O='<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+(R+"#$$$#"+I)+'" title="'+I+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+P+'</label><span class="luckysheet-mousedown-cancel count">( '+x[R][I]+" )</span></div>":O='<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+(R+"#$$$#"+I)+'" title="'+I+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+P+'</label><span class="luckysheet-mousedown-cancel count">( '+x[R][I]+" )</span></div>",S.push(O)}}}let _=u-a.top-350;_<0&&(_=100),$("#luckysheet-pivotTableFilter-byvalue-select").append("<div class='ListBox luckysheet-mousedown-cancel' style='max-height:"+_+"px;overflow-y:auto;overflow-x:hidden;'>"+S.join("")+"</div>"),v.close()},1),on(s,a.left-250,a.top)},getSumTypeName:function(e){let n="",l=Q().pivotTable;return e=="SUM"?n=l.valueStatisticsSUM:e=="COUNT"?n=l.valueStatisticsCOUNT:e=="COUNTA"?n=l.valueStatisticsCOUNTA:e=="COUNTUNIQUE"?n=l.valueStatisticsCOUNTUNIQUE:e=="AVERAGE"?n=l.valueStatisticsAVERAGE:e=="MAX"?n=l.valueStatisticsMAX:e=="MIN"?n=l.valueStatisticsMIN:e=="MEDIAN"?n=l.valueStatisticsMEDIAN:e=="PRODUCT"?n=l.valueStatisticsPRODUCT:e=="STDEV"?n=l.valueStatisticsSTDEV:e=="STDEVP"?n=l.valueStatisticsSTDEVP:e=="let"?n=l.valueStatisticslet:e=="VARP"&&(n=l.valueStatisticsVARP),n},setDatatojsfile:function(e,n,t){let l=this,o=Z(l.pivotSheetIndex);f.luckysheetfile[o].pivotTable==null&&(f.luckysheetfile[o].pivotTable={}),t==null?(f.luckysheetfile[o].pivotTable[e]=n,l[e]=n):(f.luckysheetfile[o].pivotTable.filterparm==null&&(f.luckysheetfile[o].pivotTable.filterparm={}),f.luckysheetfile[o].pivotTable.filterparm[t.toString()]==null&&(f.luckysheetfile[o].pivotTable.filterparm[t.toString()]={}),f.luckysheetfile[o].pivotTable.filterparm[t.toString()][e]=n,l.filterparm==null&&(l.filterparm={}),l.filterparm[t.toString()]==null&&(l.filterparm[t.toString()]={}),l.filterparm[t.toString()][e]=n)},createPivotTable:function(e){if(he()||f.allowEdit===!1)return;let n=this,t=f.currentSheetIndex,o=Q().pivotTable;if(he()){alert(o.errorNotAllowEdit);return}if(f.luckysheet_select_save.length>1){W.info("",o.errorNotAllowMulti);return}if(f.luckysheet_select_save.length==0||f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]||f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]){W.info("",o.errorSelectRange);return}let a=$.extend(!0,{},f.luckysheet_select_save[0]);ye.addNewSheet(e,!0),n.getCellData(f.currentSheetIndex,t,a),n.setDatatojsfile("pivot_select_save",a),n.setDatatojsfile("pivotDataSheetIndex",t),n.initialPivotManage()},changePivotTable:function(e){let n=this,l=Q().pivotTable,o=f.luckysheetfile[Z(e)].pivotTable.pivotDataSheetIndex;if(Z(o)==null){W.info(l.errorIsDamage,"");return}n.getCellData(e),n.initialPivotManage(!0),n.refreshPivotTable()},refreshPivotTable:function(e=!0){let n=this,t={};t.pivotTable=Uh,t.data=xe.deepCopyFlowData(f.flowdata),n.storePivotTableParam();let l=n.dataHandler(n.column,n.row,n.values,n.showType,n.celldata);n.setDatatojsfile("pivotDatas",l);let o=$.extend(!0,[],ye.nulldata),a=o,s=0,u=0;if(l.length==0)n.setDatatojsfile("drawPivotTable",!0),n.setDatatojsfile("pivotTableBoundary",[12,6]);else{n.setDatatojsfile("drawPivotTable",!1),n.setDatatojsfile("pivotTableBoundary",[l.length,l[0].length]);let h=l.length,d=l[0].length;s=h-o.length,u=d-o[0].length,a=cl(o,s+20,u+10,!0);for(let m=0;m<h;m++){let p=[].concat(a[m]);for(let v=0;v<d;v++){let y="";l[m]!=null&&l[m][v]!=null&&(y=Le(m,v,l)),p[v]=y}a[m]=p}}t.type="pivotTable_change",t.curdata=$.extend(!0,[],a),t.sheetIndex=f.currentSheetIndex,t.pivotTablecur=n.getPivotTableData(),f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push(t)),rl(),f.clearjfundo=!1,s>0||u>0?Kl(a[0].length,a.length,a,null,f.luckysheet_select_save,"datachangeAll",void 0,void 0,e):(Ze(a,f.luckysheet_select_save,{},null,e),lt()),f.clearjfundo=!0},drawPivotTable:!0,pivotTableBoundary:[12,6],pivotclick:function(e,n,t){t==null&&(t=f.currentSheetIndex);let l=f.luckysheetfile[Z(t)];if(!l.isPivotTable)return;let o=l.pivotTable.pivotDataSheetIndex;if(Z(o)==null)return;let s=$("#luckysheet-modal-dialog-slider-pivot"),u=this.isPivotRange(e,n);if(u&&s.is(":hidden")){if(!Tt(t,"usePivotTablereports",!1))return;s.show(),Ot(),$("#luckysheet-sta-content").css("padding-right",260)}else!u&&s.is(":visible")&&(s.hide(),Ot(),$("#luckysheet-sta-content").css("padding-right",10))},isPivotRange:function(e,n){let t=this;if(f.luckysheetcurrentisPivotTable)return e<t.pivotTableBoundary[0]&&n<t.pivotTableBoundary[1]},storePivotTableParam:function(){let e=this,n=[],t=[],l=[],o=[];$("#luckysheet-modal-dialog-config-filter .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),l.push(u)}),$("#luckysheet-modal-dialog-config-row .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.order=$(this).data("order"),u.orderby=$(this).data("orderby"),u.stastic=$(this).data("stastic"),t.push(u)}),$("#luckysheet-modal-dialog-config-column .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.order=$(this).data("order"),u.orderby=$(this).data("orderby"),u.stastic=$(this).data("stastic"),n.push(u)}),$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.sumtype=$(this).data("sumtype"),u.nameindex=$(this).data("nameindex"),o.push(u)}),e.setDatatojsfile("column",n),e.setDatatojsfile("row",t),e.setDatatojsfile("filter",l),e.setDatatojsfile("values",o);let a=$("#luckysheetpivottablevaluecolrow:checked, #luckysheetpivottablevaluecolrow1:checked").val();e.setDatatojsfile("showType",a=="0"?"row":"column");let s=e.getPivotTableData();delete s.pivotDatas,ne.saveParam("all",e.pivotSheetIndex,s,{k:"pivotTable"})},getPivotTableData:function(e){e==null&&(e=this.pivotSheetIndex);let n=Z(e),t=f.luckysheetfile[n].pivotTable;return N(t)=="object"?t=$.extend(!0,{},f.luckysheetfile[n].pivotTable):t=new Function("return "+t)(),t},addValuesToTitle:function(e,n){let t=e.length*n.length,l=e[0].length+1,o=[];if(e.length==0&&n.length>0){for(let a=0;a<n.length;a++)o.push(n[a].fullname);return o}if(n.length==0&&e.length>0)return e;for(let a=0;a<t;a++){o[a]=new Array(l);for(let s=0;s<l-1;s++)o[a][s]=e[Math.floor(a/n.length)][s];o[a][l-1]=n[a%n.length].fullname}return o},initialPivotManage:function(e){let n=this,t=Q(),l=t.pivotTable,o=t.button,a=t.filter;if(n.initial){n.initial=!1,$("body").append(fu()),$("#luckysheet-modal-dialog-slider-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),Ot()}),$("body").append(_e(dt,{id:"luckysheet-data-pivotTable-selection",addclass:"luckysheet-data-pivotTable-selection",title:l.titleSelectionDataRange,content:'<input id="luckysheet-pivotTable-range-selection-input" class="luckysheet-datavisual-range-container" style="font-size: 14px;padding:5px;max-width:none;" spellcheck="false" aria-label="'+l.titleDataRange+'" placeholder="'+l.titleDataRange+'">',botton:'<button id="luckysheet-pivotTable-selection-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>"})),$("body").append(_e(jo(),{menuid:"pivotTableFilter"})),$("body").append(_e(Wo(),{menuid:"pivotTableFilter"})),$("body").append(ru()),$("body").append(nu()),$("#luckysheet-pivotTableFilter-orderby-asc").remove(),$("#luckysheet-pivotTableFilter-orderby-desc").next().remove(),$("#luckysheet-pivotTableFilter-orderby-desc").remove(),$("#luckysheet-pivotTableFilter-orderby-color").next().remove(),$("#luckysheet-pivotTableFilter-orderby-color").remove(),$("#luckysheetpivottablevaluecolrow, #luckysheetpivottablevaluecolrow1").checkboxradio({icon:!1}).change(function(){n.refreshPivotTable()});let m=null;$("#luckysheet-pivotTableFilter-menu").mouseover(function(){clearTimeout(m),m=setTimeout(function(){$("#luckysheet-pivotTableFilter-submenu").hide()},500)}),$(document).off("click.ptFilterCheckbox1").on("click.ptFilterCheckbox1","#luckysheet-pivotTableFilter-byvalue-select .textBox",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox2").on("click.ptFilterCheckbox2","#luckysheet-pivotTableFilter-byvalue-select .year",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox3").on("click.ptFilterCheckbox3","#luckysheet-pivotTableFilter-byvalue-select .month",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));let p=!0;$(this).parents(".yearBox").find(".day").each(function(y,k){$(k).attr("data-check")=="true"||(p=!1)}),p?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterCheckbox4").on("click.ptFilterCheckbox4","#luckysheet-pivotTableFilter-byvalue-select .day",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));let p=!0;$(this).parents(".monthBox").find(".day").each(function(b,w){$(w).attr("data-check")=="true"||(p=!1)}),p?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));let y=!0;$(this).parents(".yearBox").find(".day").each(function(b,w){$(w).attr("data-check")=="true"||(y=!1)}),y?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterYearDropdown").on("click.ptFilterYearDropdown","#luckysheet-pivotTableFilter-byvalue-select .yearBox .fa-caret-right",function(){let p=$(this).parents(".luckysheet-mousedown-cancel");p.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),p.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle()}),$("#luckysheet-pivotTableFilter-byvalue-btn-all").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-pivotTableFilter-byvalue-btn-contra").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(k,b){$(b).is(":checked")?($(b).removeAttr("checked"),$(b).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(b).prop("checked",!0),$(b).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .monthBox").each(function(k,b){let w=!0;$(b).find(".day input[type='checkbox']").each(function(C,S){$(S).is(":checked")||(w=!1)}),w?($(b).find(".month input[type='checkbox']").prop("checked",!0),$(b).attr("data-check","true")):($(b).find(".month input[type='checkbox']").removeAttr("checked"),$(b).attr("data-check","false"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .yearBox").each(function(k,b){let w=!0;$(b).find(".day input[type='checkbox']").each(function(C,S){$(S).is(":checked")||(w=!1)}),w?($(b).find(".year input[type='checkbox']").prop("checked",!0),$(b).attr("data-check","true")):($(b).find(".year input[type='checkbox']").removeAttr("checked"),$(b).attr("data-check","false"))})}),$("#luckysheet-pivotTableFilter-byvalue-btn-clear").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-pivotTableFilter-byvalue-input").on("input propertychange",function(){let p=$(this).val().toString();$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),p!=""&&$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(y,k){let b=$(k).parents(".luckysheet-mousedown-cancel");if(b.hasClass("day")){let w=$(k).siblings("label").text().toString(),x=$(k).parents(".monthBox").find(".month label").text().toString();($(k).parents(".yearBox").find(".year label").text().toString()+"-"+x+"-"+w).indexOf(p)==-1&&($(k).parents(".day").hide(),$(k).parents(".dayList").find(".day:visible").length==0&&$(k).parents(".monthBox").find(".month").hide(),$(k).parents(".monthList").find(".day:visible").length==0&&$(k).parents(".yearBox").find(".year").hide())}b.hasClass("textBox")&&$(k).siblings("label").text().toString().indexOf(p)==-1&&$(k).parents(".textBox").hide()})}),$("#luckysheet-pivotTableFilter-bycondition, #luckysheet-pivotTableFilter-byvalue").click(function(){let p=$(this);p.next().slideToggle(200),setTimeout(function(){p.attr("id")=="luckysheet-pivotTableFilter-bycondition"&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-selected span").text()!=a.filiterInputNone&&$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(200),p.is($("#luckysheet-pivotTableFilter-bycondition"))&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-pivotTableFilter-cancel").click(function(){$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-pivotTableFilter-selected").click(function(){let p=$(this),v=p.offset(),y=$("#luckysheet-pivotTableFilter-submenu");y.hide();let k=$(window).height(),b=$(window).width(),w=y.width(),x=y.height(),C=v.top,S=v.left,_=k-v.top-20;v.left+w>b&&(S=v.left-w),v.top>k/2&&(C=k-v.top,C<0&&(C=0),_=v.top-20),y.css({top:C,left:S,height:_}).show(),clearTimeout(m)}),$("#luckysheet-pivotTableFilter-submenu").mouseover(function(){clearTimeout(m)}).find(".luckysheet-cols-menuitem").click(function(p){$("#luckysheet-pivotTableFilter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide(),$(this).data("type")=="2"?($("#luckysheet-pivotTableFilter-selected span").data("type","2"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show()):$(this).data("type")=="0"?$("#luckysheet-pivotTableFilter-selected span").data("type","0"):($("#luckysheet-pivotTableFilter-selected span").data("type","1"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show(),$(this).attr("data-value")=="dateequal"||$(this).attr("data-value")=="datelessthan"||$(this).attr("data-value")=="datemorethan"?$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","date"):$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","text")),$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(),$("#luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filter",function(p){return n.luckysheetsliderlistitemfilter($(this)),p.stopPropagation(),!1}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filtered",function(p){return n.luckysheetsliderlistclearfilter($(this).next()),p.stopPropagation(),!1}),$("#luckysheet-dialog-pivotTable-range-seleted").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),Ot();let p=$("#luckysheet-data-pivotTable-selection"),v=p.outerHeight(),y=p.outerWidth(),k=$(window).width(),b=$(window).height(),w=$(document).scrollLeft(),x=$(document).scrollTop();$("#luckysheet-data-pivotTable-selection").css({left:(k+w-y)/2,top:(b+x-v)/4}).show(),n.jgridCurrentPivotInput=$("#luckysheet-dialog-pivotTable-range").html(),$("#luckysheet-pivotTable-range-selection-input").val(n.jgridCurrentPivotInput),n.luckysheet_pivotTable_select_state=!0}),$("#luckysheet-pivotTableFilter-initial").click(function(){$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-slider-list-item-filtered").hide(),$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").data("rowhidden",""),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text(a.filiterInputNone),n.setDatatojsfile("filterparm",null),n.celldata=n.origindata,n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(p){let v=$(p.target),y=v.closest(".luckysheet-modal-dialog-slider-config-item"),k=y.data("index"),b=y.offset(),w=y.data("order"),x=y.data("orderby"),C=y.data("stastic");w==null&&(w="default");let S='<option value="self">'+y.find(".luckysheet-modal-dialog-slider-config-item-txt").data("name")+"</option>";return $("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(_){S+='<option value="'+_+'">'+$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()+"</option>"}),$("#luckysheet-pivotTable-config-option-orderby").empty().html(S),x==null&&(x="self"),C==null&&(C="1"),$("#luckysheet-pivotTable-config-option-order").val(w).data("index",k),$("#luckysheet-pivotTable-config-option-orderby").val(x).data("index",k),$("#luckysheet-pivotTable-config-option-stastic").val(C).data("index",k),ml($("#luckysheet-pivotTable-config-option"),b.left+y.outerWidth(),b.top-13,"rightbottom"),p.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-order,#luckysheet-pivotTable-config-option-orderby,#luckysheet-pivotTable-config-option-stastic").change(function(){let p=$(this),v=p.data("index");$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==v&&$(this).data(p.attr("id").replace("luckysheet-pivotTable-config-option-",""),p.val())}),n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-value").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(p){let v=$(p.target),y=v.closest(".luckysheet-modal-dialog-slider-config-item"),k=y.data("index"),b=y.offset(),w=y.data("sumtype"),x=n.pivot_data_type[k.toString()];w==null&&(x=="num"?w="SUM":w="COUNTA");let C=$("#luckysheet-pivotTable-config-option-sumtype");return C.find(".luckysheet-submenu-arrow").hide(),C.find(".luckysheet-cols-menuitem[sumtype='"+w+"'] .luckysheet-submenu-arrow").css("display","inline"),C.data("item",y),ml(C,b.left+y.outerWidth(),b.top-13,"rightbottom"),p.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-sumtype .luckysheet-cols-menuitem").click(function(){let p=$("#luckysheet-pivotTable-config-option-sumtype").data("item"),v=$(this).attr("sumtype");p.data("sumtype",$(this).attr("sumtype"));let y=n.getSumTypeName(v)+":"+p.data("name");p.attr("title",y).find(".luckysheet-modal-dialog-slider-config-item-txt").html(y),$("#luckysheet-pivotTable-config-option-sumtype").hide(),n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-filter").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(p){let v=$(p.target),y=v.closest(".luckysheet-modal-dialog-slider-config-item").data("index");return n.luckysheetsliderlistitemfilter($("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(y).find(".luckysheet-slider-list-item-filter")),p.stopPropagation(),!1}),$("#luckysheet-pivotTableFilter-confirm").click(function(){let v=$("#luckysheet-pivotTableFilter-menu").data("index"),y={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").each(function(){let _=$(this),T=_.data("rowhidden");if(_.data("index")!=v){if(T==null||T=="")return!0;N(T)=="string"&&(T=JSON.parse(T));for(let F in T)y[F]=0}});let k=n.origindata,b={},w={},x={};if($("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-selected span").data("value")!="null"){let _=$("#luckysheet-pivotTableFilter-selected span"),T=_.data("type"),F=_.data("value");if(x.value=F,x.text=_.text(),T=="0")x.type="0";else if(T=="2"){let R=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2 input");x.type="2",x.value1=R.eq(0).val(),x.value2=R.eq(1).val()}else x.type="1",x.value1=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).find("input").val();for(let R=1;R<k.length;R++){if(R in y||k[R]==null)continue;let I=k[R][v];if(F=="cellnull")I!=null&&!me(I.v)&&(w[R]=0);else if(F=="cellnonull")(I==null||me(I.v))&&(w[R]=0);else if(F=="textinclude"){let P=x.value1;(I==null||me(I.v)||I.m.indexOf(P)==-1)&&(w[R]=0)}else if(F=="textnotinclude"){let P=x.value1;I==null||me(I.v)||I.m.indexOf(P)>-1&&(w[R]=0)}else if(F=="textstart"){let P=x.value1,O=P.length;(I==null||me(I.v)||I.m.substr(0,O)!=P)&&(w[R]=0)}else if(F=="textend"){let P=x.value1,O=P.length;(I==null||me(I.v)||O>I.m.length||I.m.substr(I.m.length-O,O)!=P)&&(w[R]=0)}else if(F=="textequal"){let P=x.value1;(I==null||me(I.v)||I.m!=P)&&(w[R]=0)}else if(F=="dateequal"){let P=nt(x.value1)[2];I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="d"?parseInt(I.v)!=P&&(w[R]=0):w[R]=0}else if(F=="datelessthan"){let P=nt(x.value1)[2];I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="d"?parseInt(I.v)>=P&&(w[R]=0):w[R]=0}else if(F=="datemorethan"){let P=nt(x.value1)[2];I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="d"?parseInt(I.v)<=P&&(w[R]=0):w[R]=0}else if(F=="morethan"){let P=parseFloat(x.value1);I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="n"?I.v<=P&&(w[R]=0):w[R]=0}else if(F=="moreequalthan"){let P=parseFloat(x.value1);I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="n"?I.v<P&&(w[R]=0):w[R]=0}else if(F=="lessthan"){let P=parseFloat(x.value1);I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="n"?I.v>=P&&(w[R]=0):w[R]=0}else if(F=="lessequalthan"){let P=parseFloat(x.value1);I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="n"?I.v>P&&(w[R]=0):w[R]=0}else if(F=="equal"){let P=parseFloat(x.value1);I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="n"?I.v!=P&&(w[R]=0):w[R]=0}else if(F=="noequal"){let P=parseFloat(x.value1);I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="n"?I.v==P&&(w[R]=0):w[R]=0}else if(F=="include"){let P=parseFloat(x.value1),O=parseFloat(x.value2),M,A;P<O?(M=P,A=O):(A=P,M=O),I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="n"?(I.v<M||I.v>A)&&(w[R]=0):w[R]=0}else if(F=="noinclude"){let P=parseFloat(x.value1),O=parseFloat(x.value2),M,A;P<O?(M=P,A=O):(A=P,M=O),I==null||me(I.v)?w[R]=0:I.ct!=null&&I.ct.t=="n"?I.v>=M&&I.v<=A&&(w[R]=0):w[R]=0}}}else{$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(_,T){if($(T).is(":visible")&&$(T).is(":checked"))return!0;if($(T).closest(".day").length>0){let F=$(T).siblings("label").text();Number(F)<10&&(F="0"+F);let R=$(T).closest(".monthBox").find(".month label").text().replace(a.filiterMonthText,"");Number(R)<10&&(R="0"+R);let I=$(T).closest(".yearBox").find(".year label").text().replace(a.filiterYearText,""),P=a.filterDateFormatTip+"#$$$#"+I+"-"+R+"-"+F;b[P]="1"}if($(T).closest(".textBox").length>0){let F=$(T).closest(".textBox").data("filter");b[F]="1"}});for(let _=1;_<k.length;_++){if(_ in y||k[_]==null)continue;let T=k[_][v],F;if(T==null||me(T.v))F="null#$$$#null";else if(T.ct!=null&&T.ct.t=="d"){let R=mt("YYYY-MM-DD",T.v);F=a.filterDateFormatTip+"#$$$#"+R}else F=T.v+"#$$$#"+T.m;F in b&&(w[_]=0)}}let C=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(v);$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible").length||$("#luckysheet-pivotTableFilter-byvalue-input").val().length>0||$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-selected span").data("value")!="null"?(C.data("rowhidden",JSON.stringify(w)).find(".luckysheet-slider-list-item-filtered").show(),n.setDatatojsfile("rowhidden",w,v),x!=null&&(C.data("byconditionvalue",x.value).data("byconditiontype",x.type).data("byconditiontext",x.text),x.value1!=null&&C.data("byconditionvalue1",x.value1),x.value2!=null&&C.data("byconditionvalue2",x.value2),n.setDatatojsfile("caljs",x,v))):(C.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),n.setDatatojsfile("rowhidden",null,v));let S=[];for(let _=0;_<k.length;_++)_ in w||_ in y||S.push([].concat(k[_]));n.celldata=S,n.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),rl()}),$("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn, #luckysheet-data-pivotTable-selection .luckysheet-modal-dialog-title-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").show(),Ot(),$("#luckysheet-cell-main .luckysheet-pivotTable-selection-set div").show(),$("#luckysheet-data-pivotTable-selection").hide(),ye.changeSheetExec(n.pivotSheetIndex),n.luckysheet_pivotTable_select_state=!1,rl()}),$("#luckysheet-pivotTable-selection-confirm").click(function(){let p=$("#luckysheet-pivotTable-range-selection-input"),v=p.val();if($.trim(v).length==0||$.trim(v).toUpperCase()==n.jgridCurrentPivotInput.toUpperCase()){p.val(n.jgridCurrentPivotInput),$("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn").click();return}else{let y=v.split("!"),k="",b="",w=-1;if(y.length>1){k=y[0],b=y[1];for(let S in f.luckysheetfile)if(k==f.luckysheetfile[S].name){w=f.luckysheetfile[S].index;break}w==-1&&(w=0)}else{let S=Z(f.currentSheetIndex);k=f.luckysheetfile[S].name,w=f.luckysheetfile[S].index,b=y[0]}if(f.luckysheetfile[Z(w)].isPivotTable){he()?alert(l.errorNotAllowPivotData):W.info("",l.errorNotAllowPivotData),p.val(n.jgridCurrentPivotInput);return}if(b.indexOf(":")==-1){he()?alert(l.errorSelectionRange):W.info("",l.errorSelectionRange),p.val(n.jgridCurrentPivotInput);return}b=b.split(":");let x=[],C=[];if(x[0]=parseInt(b[0].replace(/[^0-9]/g,""))-1,x[1]=parseInt(b[1].replace(/[^0-9]/g,""))-1,x[0]>x[1]){he()?alert(l.errorSelectionRange):W.info("",l.errorSelectionRange),p.val(n.jgridCurrentPivotInput);return}if(C[0]=fl(b[0].replace(/[^A-Za-z]/g,"")),C[1]=fl(b[1].replace(/[^A-Za-z]/g,"")),C[0]>C[1]){he()?alert(l.errorSelectionRange):W.info(l.errorSelectionRange),p.val(n.jgridCurrentPivotInput);return}ye.changeSheetExec(n.pivotSheetIndex),n.setDatatojsfile("pivot_select_save",{row:x,column:C}),n.setDatatojsfile("pivotDataSheetIndex",w),n.getCellData(n.pivotSheetIndex,w,{row:x,column:C}),n.initialPivotManage(),$("#luckysheet-dialog-pivotTable-range").html(v),$("#luckysheet-modal-dialog-slider-pivot").show(),$("#luckysheet-data-pivotTable-selection").hide(),n.luckysheet_pivotTable_select_state=!1,n.refreshPivotTable(),Ot(),rl()}}),$("#luckysheet-modal-dialog-slider-pivot").on("mousedown",".luckysheet-slider-list-item-name, .luckysheet-modal-dialog-slider-config-item-txt",function(p){let v=$(p.target);n.movestate=!0,n.movesave.obj=v.parent(),n.movesave.name=v.data("name"),n.movesave.containerid=v.parent().parent().attr("id"),n.movesave.index=v.data("index"),$("#luckysheet-modal-dialog-slider-pivot-move").length==0&&$("body").append('<div id="luckysheet-modal-dialog-slider-pivot-move">'+n.movesave.name+"</div>"),n.movesave.width=$("#luckysheet-modal-dialog-slider-pivot-move").outerWidth(),n.movesave.height=$("#luckysheet-modal-dialog-slider-pivot-move").outerHeight(),$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default")}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").mousemove(function(p){if(n.movestate){n.moveitemposition.length==0&&(n.moveitemposition=[0],$(this).find(".luckysheet-modal-dialog-slider-config-item").each(function(C){let S=$(this),_=S.outerHeight();n.moveitemposition.push(n.moveitemposition[C]+_+2)}),$(this).append('<div id="luckysheet-modal-dialog-config-order-help" style="position:absolute;height:3px;width:100%;background:#007ACC;z-index:1;pointer-events: none;user-select:none;"></div>')),$("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#FD8585",color:"#fff",border:"1px solid #FD7070"});let v=event.pageX,y=event.pageY,k=$(this),b=y-k.offset().top+k.scrollTop(),w=n.moveitemposition,x=at(w,b);x==-1?$("#luckysheet-modal-dialog-config-order-help").css({top:w[w.length-1]}):b-w[x-1]>(w[x]-w[x-1])/2?$("#luckysheet-modal-dialog-config-order-help").css({top:w[x]}):$("#luckysheet-modal-dialog-config-order-help").css({top:w[x-1]})}}).mouseleave(function(){n.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#fff",color:"#000",border:"1px dotted #000"}),n.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove())}).mouseup(function(p){if(n.movestate){let v=$(this),y;if(n.movesave.containerid==v.attr("id"))y=n.movesave.obj.clone();else{let _=n.movesave.name,T="",F="";v.attr("id")=="luckysheet-modal-dialog-config-value"&&(n.pivot_data_type[n.movesave.index.toString()]=="num"?(_=l.valueStatisticsSUM+":"+_,T="data-sumtype='SUM'",F="data-nameindex='0'"):(_=l.valueStatisticsCOUNTA+":"+_,T="data-sumtype='COUNTA'",F="data-nameindex='0'"),$("#luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){if($(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()==_){let I=parseFloat($(this).data("nameindex"))+1;return _=_+I.toString(),$(this).data("nameindex",I),!1}})),y='<div title="'+_+'" class="luckysheet-modal-dialog-slider-config-item" '+F+" "+T+' data-index="'+n.movesave.index+'" data-name="'+n.movesave.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+F+" "+T+' data-index="'+n.movesave.index+'" data-name="'+n.movesave.name+'">'+_+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}let k=event.pageX,b=event.pageY,w=$(this),x=b-w.offset().top+w.scrollTop(),C=n.moveitemposition,S=at(C,x);(n.movesave.containerid=="luckysheet-modal-dialog-pivotTable-list"||n.movesave.containerid=="luckysheet-modal-dialog-config-value"&&n.movesave.containerid!=v.attr("id"))&&$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==n.movesave.index&&$(this).remove()}),S==-1?v.find(".luckysheet-modal-dialog-slider-config-item").length==0?v.append(y):v.find(".luckysheet-modal-dialog-slider-config-item").last().after(y):x-C[S-1]>(C[S]-C[S-1])/2?v.find(".luckysheet-modal-dialog-slider-config-item").eq(S-1).after(y):v.find(".luckysheet-modal-dialog-slider-config-item").eq(S-1).before(y),n.movesave.containerid=="luckysheet-modal-dialog-pivotTable-list"||n.movesave.containerid=="luckysheet-modal-dialog-config-value"&&n.movesave.containerid!=v.attr("id")||n.movesave.obj.remove(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){let _=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==n.movesave.index&&_.find("i").length==0&&_.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}),n.refreshPivotTable(),$("#luckysheet-modal-dialog-slider-pivot-move").remove(),n.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),n.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove(),n.showvaluecolrow(),p.stopPropagation()}}),$("#luckysheet-modal-dialog-pivotTable-list").on("click",".luckysheet-slider-list-item-selected",function(){let p=$(this),v=p.parent(),y=v.data("index"),k=v.data("name");if(p.find("i").length==0){p.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');let b=n.pivot_data_type[y.toString()],w;if(b=="num")w='<div title="'+k+'" class="luckysheet-modal-dialog-slider-config-item" data-nameindex="0" data-sumtype="SUM" data-index="'+y+'" data-name="'+k+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-nameindex="0" data-sumtype="SUM" data-index="'+y+'" data-name="'+k+'">\u6C42\u548C:'+k+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>',$("#luckysheet-modal-dialog-config-value").append(w);else{w='<div title="'+k+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+y+'" data-name="'+k+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+y+'" data-name="'+k+'">'+k+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';let x=$("#luckysheet-modal-dialog-config-column"),C=$("#luckysheet-modal-dialog-config-row"),S=x.find(".luckysheet-modal-dialog-slider-config-item"),_=C.find(".luckysheet-modal-dialog-slider-config-item");S.length<2?x.append(w):_.length<2?C.append(w):x.append(w)}}else p.find("i").remove(),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==y&&($(this).parent().attr("id")=="luckysheet-modal-dialog-config-value"&&n.resetOrderby($(this)),$(this).remove())});n.refreshPivotTable(),n.showvaluecolrow()}),$("#luckysheet-dialog-pivotTable-clearitem").click(function(){$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).remove()}),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),n.refreshPivotTable(),n.showvaluecolrow()})}e==null&&(e=!1),n.celldata.length<=1&&n.celldata[0].length<=1&&(he()?alert(l.errorIncreaseRange):W.info("",l.errorIncreaseRange));let s="",u=1,h={},d=1;for(let m=0;m<n.celldata[0].length;m++){let p;!!n.celldata[0][m]&&!!n.celldata[0][m].m?p=n.celldata[0][m].m:p=Le(0,m,n.celldata),p!=null&&(p=p.toString()),(p==null||$.trim(p.toString()).length==0)&&(p=l.titleColumn+" "+d),d++,p in h&&(p=p+u++,p in h&&(p=p+u++,p in h&&(p=p+u++))),h[p]=1;let v="",y="";if(e&&n.filterparm!=null&&n.filterparm[m.toString()]!=null){let k=n.filterparm[m.toString()];if(k.rowhidden!=null&&(v+="data-rowhidden='"+JSON.stringify(k.rowhidden)+"'"),k.selected!=null&&(v+="data-selected='"+JSON.stringify(k.selected)+"'"),k.caljs!=null){let b=k.caljs;b.value!=null&&(v+="data-byconditionvalue='"+b.value+"'"),b.type!=null&&(v+="data-byconditiontype='"+b.type+"'"),b.text!=null&&(v+="data-byconditiontext='"+b.text+"'"),b.value1!=null&&(v+="data-byconditionvalue1='"+b.value1+"'"),b.value2!=null&&(v+="data-byconditionvalue2='"+b.value2+"'")}}v.length>0&&(y="display:block;"),s+='<div class="luckysheet-modal-dialog-slider-list-item" '+v+' data-index="'+m+'" data-name="'+p+'"><div title="'+l.titleAddColumn+'" class="luckysheet-slider-list-item-selected"><div></div></div><div title="'+l.titleMoveColumn+'" class="luckysheet-slider-list-item-name" '+v+' data-index="'+m+'" data-name="'+p+'">'+p+'</div><div title="'+l.titleClearColumnFilter+'" class="luckysheet-slider-list-item-filtered" style="'+y+'"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i><i class="fa fa-times" aria-hidden="true"></i></div><div title="'+l.titleFilterColumn+'" class="luckysheet-slider-list-item-filter"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}if($("#luckysheet-modal-dialog-pivotTable-list").html(s),$("#luckysheetpivottablevaluecolrowshow").hide(),$("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").empty(),e){if(n.filter!=null&&n.filter.length>0)for(let m=0;m<n.filter.length;m++){let p=n.filter[m],v='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+p.index+'" data-name="'+p.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+p.index+'" data-name="'+p.name+'">'+p.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-filter").append(v);let y=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(p.index).find(".luckysheet-slider-list-item-selected");y.find("i").length==0&&y.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.row!=null&&n.row.length>0)for(let m=0;m<n.row.length;m++){let p=n.row[m],v="";p.order!=null&&(v+="data-order = '"+p.order+"'"),p.orderby!=null&&(v+="data-orderby = '"+p.orderby+"'"),p.order!=null&&(v+="data-stastic = '"+p.stastic+"'");let y='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+v+' data-index="'+p.index+'" data-name="'+p.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+v+' data-index="'+p.index+'" data-name="'+p.name+'">'+p.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-row").append(y);let k=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(p.index).find(".luckysheet-slider-list-item-selected");k.find("i").length==0&&k.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.column!=null&&n.column.length>0)for(let m=0;m<n.column.length;m++){let p=n.column[m],v="";p.order!=null&&(v+="data-order = '"+p.order+"'"),p.orderby!=null&&(v+="data-orderby = '"+p.orderby+"'"),p.order!=null&&(v+="data-stastic = '"+p.stastic+"'");let y='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+v+' data-index="'+p.index+'" data-name="'+p.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+v+' data-index="'+p.index+'" data-name="'+p.name+'">'+p.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-column").append(y);let k=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(p.index).find(".luckysheet-slider-list-item-selected");k.find("i").length==0&&k.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.values!=null&&n.values.length>0){for(let m=0;m<n.values.length;m++){let p=n.values[m],v="";p.sumtype!=null&&(v+="data-sumtype = '"+p.sumtype+"'"),p.nameindex!=null&&(v+="data-nameindex = '"+p.nameindex+"'");let y='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+v+' data-index="'+p.index+'" data-name="'+p.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+v+' data-index="'+p.index+'" data-name="'+p.name+'">'+n.getSumTypeName(p.sumtype)+":"+p.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-value").append(y);let k=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(p.index).find(".luckysheet-slider-list-item-selected");k.find("i").length==0&&k.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}n.values.length>=2&&($("#luckysheetpivottablevaluecolrowshow").show(),n.showType=="column"?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active")))}}$("#luckysheet-dialog-pivotTable-range").html(Mt(n.pivotDataSheetIndex,n.pivot_select_save)),$("#luckysheet-modal-dialog-slider-pivot").show(),Ot(!1)},getComposeArray:function(e){if(e.length==0)return[];let n=[];for(let t=0;t<e.length;t++){let l="";for(let o=0;o<=t;o++)!!e[o]&&!!e[o].m?l+=e[o].m:l+=Le(o,null,e);n.push(l)}return n},getnameArray:function(e,n){if(e.length==0)return[];if(n.length==0)return[];let t=[];for(let l=0;l<n.length;l++){let o;!!e[n[l].index]&&!!e[n[l].index].m?o=e[n[l].index].m:o=Le(n[l].index,null,e),t.push(o)}return t},getTitleFromGroup:function(e,n,t){let l=this,o=l.orderbygroup(e,n,t);return l.generategrouparraymain(o,n)},orderbygroup:function(e,n,t){let l=this,o=[];if(e.length==0)return[];o=e;let a=null,s=o.length,u=o.length,h=0;for(;s!=0;)if(a=o[h++],s--,a.children!=null&&a.children.length>0){a.children=l.orderbygroupchildren(a.children,n[a.index].orderby,n[a.index].order,t);for(let d=0;d<a.children.length;d++)o.push(a.children[d]),s++}return e.splice(0,u)},orderbygroupchildren:function(e,n,t,l){if(e.length==0)return[];let o=!1;(t==null||t=="asc")&&(o=!0);let s=Q().filter,u=function(d,m){let p=null,v=null;if(n=="self"||n==null){if(d.name==null?p=s.valueBlank:p=d.name.toString(),m.name==null?v=s.valueBlank:v=m.name.toString(),zt(p)&&zt(v))return ul(p,v)}else p=parseFloat(l[d.orderby].result),v=parseFloat(l[m.orderby].result);if(!isNaN(p)&&!isNaN(v))return(0,Mo.default)(p).value()-(0,Mo.default)(v).value();if(isNaN(p)&&isNaN(v))return p.localeCompare(v);if(isNaN(p))return 1;if(isNaN(v))return-1},h=function(d,m){let p=null,v=null;if(n=="self"||n==null){if(d.name==null?p=s.valueBlank:p=d.name.toString(),m.name==null?v=s.valueBlank:v=m.name.toString(),zt(p)&&zt(v))return ul(p,v)}else p=parseFloat(l[d.orderby].result),v=parseFloat(l[m.orderby].result);if(!isNaN(p)&&!isNaN(v))return(0,Mo.default)(v).value()-(0,Mo.default)(p).value();if(isNaN(p)&&isNaN(v))return v.localeCompare(p);if(isNaN(p))return-1;if(isNaN(v))return 1};return o?e.sort(u):e.sort(h)},generategroupaddstatic:function(e,n){let t=[],o=Q().pivotTable;for(let a=0;a<e[0].length;a++)a==0?n==o.valueSum?t.push(n):t.push({name:n,issum:!0}):t.push("");return t},generategrouparraymain:function(e,n){let t=this,l=[];for(let o=0;o<e.length;o++){let a=e[o].name,s=t.generategrouparray(e[o].children,n,1);(n[0].stastic=="1"||n[0].stastic==null)&&s.push(t.generategroupaddstatic(s,a)),l=l.concat(s)}return l},generategrouparray:function(e,n,t){let l=this,o=[];for(let a=0;a<e.length;a++){let s=e[a].name,u;if(e[a].children==0||e[a].children.length==0)u=[s],o.push(u);else{u=l.generategrouparray(e[a].children,n,t+1);for(let h=0;h<u.length;h++)u[h].unshift(s);(n[t].stastic=="1"||n[t].stastic==null)&&u.push(l.generategroupaddstatic(u,s)),o=o.concat(u)}}return o},addStatisticsData:function(e,n,t,l){if(e[t]==null&&(e[t]={data:[],count:0,max:-Infinity,min:Infinity,counta:0,countunique:0,countuniquedata:{},sum:0,digitaldata:[],sumtype:n.sumtype,index:n.index,name:n.fullname,acc:0}),Nn(l).num===!0){let o=Il(l,6);e[t].digitaldata.push(o),e[t].count+=1,e[t].sum+=o,o>e[t].max&&(e[t].max=o),o<e[t].min&&(e[t].min=o);let a=Ks(o);a>e[t].acc&&(e[t].acc=a)}l!=""&&(e[t].data.push(l),e[t].counta+=1,l in e[t].countuniquedata||(e[t].countuniquedata[l]=1,e[t].countunique+=1))},dataHandler:function(e,n,t,l,o){let a=this,s=Q(),u=s.filter,h=s.pivotTable;if(l==null&&(l="column"),e.length==0&&n.length==0&&t.length==0||o.length==0)return a.pivotDatas=[],[];let d={},m=o,p=[],v=[],y={},k=0,b=[],w=[],x={},C=0;for(let O=1;O<m.length;O++){let M=m[O],A="",z="",L="",E=[],V=[],q="",G=[],X=[];V=a.getnameArray(M,n),X=a.getnameArray(M,e),E=a.getComposeArray(V),G=a.getComposeArray(X),E.length>0&&E.unshift(h.valueSum),G.length>0&&G.unshift(h.valueSum);let ee=y,le=v;for(let fe=0;fe<E.length;fe++){let ce=E[fe],K=fe==0?h.valueSum:V[fe-1];if(ee[fe.toString()]!=null&&ee[fe.toString()][ce]!=null)le=le[ee[fe.toString()][ce]].children;else{let U=fe==0?"self":n[fe-1].orderby=="self"||n[fe-1].orderby==null?ce:l=="column"?ce+t[parseInt(n[fe-1].orderby)].fullname:ce+h.valueSum;K==null&&(K=u.valueBlank),le.push({name:K,fullname:ce,index:fe,orderby:U,children:[]}),ee[fe.toString()]==null&&(ee[fe.toString()]={}),ee[fe.toString()][ce]==null&&(ee[fe.toString()][ce]=le.length-1),le=le[le.length-1].children}}let se=x,ae=w;for(let fe=0;fe<G.length;fe++){let ce=G[fe],K=fe==0?h.valueSum:X[fe-1];if(se[fe.toString()]!=null&&se[fe.toString()][ce]!=null)ae=ae[se[fe.toString()][ce]].children;else{let U=fe==0?"self":e[fe-1].orderby=="self"||e[fe-1].orderby==null?ce:l=="column"?h.valueSum+ce:t[parseInt(e[fe-1].orderby)].fullname+ce;K==null&&(K=u.valueBlank),ae.push({name:K,fullname:ce,index:fe,orderby:U,children:[]}),se[fe.toString()]==null&&(se[fe.toString()]={}),se[fe.toString()][ce]==null&&(se[fe.toString()][ce]=ae.length-1),ae=ae[ae.length-1].children}}let ue="";for(let fe=0;fe<t.length;fe++){let ce=Le(t[fe].index,null,M),K=[].concat(G),U=[].concat(E);l=="column"?K.length>0?(K.push(""),K=K.join(t[fe].fullname+"|||").split("|||").slice(0,K.length-1)):K.push(t[fe].fullname):U.length>0?(U.push(""),U=U.join(t[fe].fullname+"|||").split("|||").slice(0,U.length-1)):U.push(t[fe].fullname),K.length==0&&K.push(""),U.length==0&&U.push("");for(let te=0;te<U.length;te++)for(let ge=0;ge<K.length;ge++){let ie=U[te]+K[ge];a.addStatisticsData(d,t[fe],ie,ce)}}}for(let O in d){let M=d[O];if(M.sumtype=="SUM")M.result=M.sum;else if(M.sumtype=="COUNT")M.result=M.count;else if(M.sumtype=="COUNTA")M.result=M.counta;else if(M.sumtype=="COUNTUNIQUE")M.result=M.countunique;else if(M.sumtype=="AVERAGE")M.result=Il(M.sum/M.count);else if(M.sumtype=="MAX")M.result=M.max;else if(M.sumtype=="MIN")M.result=M.min;else if(M.sumtype=="MEDIAN"){let z=M.digitaldata.sort(function(V,q){return V-q}),L=z.length,E=parseInt(L/2);L%2==0?M.result=(z[E-1]+z[E])/2:M.result=z[E]}else if(M.sumtype=="PRODUCT")M.result=new Function("return "+M.digitaldata.join("*"))();else if(M.sumtype=="STDEV"){let z=M.sum/M.count;M.result=Do.STDEV(z,M.digitaldata)}else if(M.sumtype=="STDEVP"){let z=M.sum/M.count;M.result=Do.STDEVP(z,M.digitaldata)}else if(M.sumtype=="let"){let z=M.sum/M.count;M.result=Do.let(z,M.digitaldata)}else if(M.sumtype=="VARP"){let z=M.sum/M.count;M.result=Do.VARP(z,M.digitaldata)}let A=Ks(M.result);A>M.acc&&(M.acc=A),M.result=Il(M.result,M.acc)}if(p=a.getTitleFromGroup(v,n,d),b=a.getTitleFromGroup(w,e,d),l=="column")if(b.length>0&&b[0].length>0)b=a.addValuesToTitle(b,t);else for(let O=0;O<t.length;O++)b.push([t[O].fullname]);else if(p.length>0&&p[0].length>0)p=a.addValuesToTitle(p,t);else for(let O=0;O<t.length;O++)p.push([t[O].fullname]);let S=b;b=qh.transpose(b,!1);let _=t.length==0?0:1,T=(b.length==0?_:b.length)+(p.length==0?_:p.length),F=(b.length==0?_:b[0].length)+(p.length==0?_:p[0].length),R=b.length,I=p.length==0?0:p[0].length,P=[];for(let O=0;O<T;O++){P[O]=new Array(F);for(let M=0;M<F;M++){let A=p[O-R];if(O<R&&M<I)P[O][M]="";else if(O<R&&M>=I)b[O]!=null?N(b[O][M-I])=="object"?P[O][M]=b[O][M-I].name+h.valueSum:P[O][M]=b[O][M-I]:P[O][M]="";else if(O>=R&&M<I)A!=null?N(A[M])=="object"?P[O][M]=A[M].name+h.valueSum:P[O][M]=A[M]:P[O][M]="";else{let z="";if(A!=null)if(!(A instanceof Array)||A.length==1)A instanceof Array?z=A[0]:z=A;else for(let q=0;q<A.length;q++)N(A[q])=="object"?z+=A[q].name:z+=A[q];let L="",E=S[M-I];if(E!=null)if(!(E instanceof Array)||E.length==1)E instanceof Array?L=E[0]:L=E;else for(let q=0;q<E.length;q++)N(E[q])=="object"?L+=E[q].name:L+=E[q];let V=z;z!=""&&L!=""?V=z+L:z==""&&(V=L),d[V]==null?P[O][M]="":P[O][M]=d[V].result}}}if(t.length==1&&e.length>0&&n.length>0)P[0][0]=t[0].fullname,P.splice(e.length,1);else if(t.length==1&&e.length>0){let O=P.splice(e.length,1),M=[];for(let A=0;A<P.length;A++){let z=[];A==P.length-1?z.push(O[0][0]):z.push("");for(let L=0;L<P[A].length-1;L++)z.push(P[A][L]);M.push(z)}P=M}return a.pivotDatas=P,P},drillDown:function(e,n){if(!Tt(f.currentSheetIndex,"usePivotTablereports"))return;let t=this,l=t.pivotDatas[e][n],o=$.extend(!0,[],ye.nulldata),a=Q(),s=a.filter,u=a.pivotTable,h=1;for(let p=0;p<t.celldata[0].length;p++){let v;!!t.celldata[0][p]&&!!t.celldata[0][p].m?v=t.celldata[0][p].m:v=Le(0,p,t.celldata),v!=null&&(v=v.toString()),(v==null||$.trim(v.toString()).length==0)&&(v=u.titleColumn+" "+h),h++,o[0][p]=v}let d={};if(t.row!=null&&t.row.length>0)for(let p=0;p<t.row.length;p++)d[t.row[p].index]=t.pivotDatas[e][p];if(t.column!=null&&t.column.length>0)for(let p=0;p<t.column.length;p++)d[t.column[p].index]=t.pivotDatas[p][n];let m=[];for(let p=1;p<t.celldata.length;p++){let v=!0;for(let y in d){let k;if(!!t.celldata[p][y]&&!!t.celldata[p][y].m?k=t.celldata[p][y].m:k=Le(p,y,t.celldata),k!=null?k=k.toString():k=s.valueBlank,k!=d[y]){v=!1;break}}v&&m.push(p)}for(let p=0;p<m.length;p++)for(let v=0;v<t.celldata[0].length;v++){let y;!!t.celldata[m[p]][v]&&!!t.celldata[m[p]][v].m?y=t.celldata[m[p]][v].m:y=Le(m[p],v,t.celldata),y!=null?y=y.toString():y="",o[p+1][v]=y}f.luckysheet_select_save=[{row:[0,m.length],column:[0,t.celldata[0].length-1]}],f.clearjfundo=!1,Ze(o,f.luckysheet_select_save),lt(),f.clearjfundo=!0}},Oe=Uh});var Gh,$v,Ao,Zs,Js,Qs,ya,Yh,Tv,Sv,zo,Ir,Xh,Iv,Rv,Jl,ec=Me(()=>{Ke();Gh=function(){let e,n;return e=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(e.prototype=$.extend(new arguments[0],arguments[arguments.length-1]),e._super=arguments[0].prototype):e.prototype=arguments[arguments.length-1],arguments.length>2&&(n=Array.prototype.slice.call(arguments,1,-1),n.unshift(e.prototype),$.extend.apply($,n))):e.prototype=arguments[0],e.prototype.cls=e,e},$v=Gh({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(e,n){this.format=e,this.fclass=n},render:function(e,n,t){let l=this,o=e,a,s,u,h,d;return this.format.replace(this.fre,function(){let m;return s=arguments[1],u=arguments[3],a=l.precre.exec(s),a?(d=a[2],s=a[1]):d=!1,h=o[s],h===void 0?"":u&&n&&n[u]?(m=n[u],m.get?n[u].get(h)||h:n[u][h]||h):(Tv(h)&&(t.get("numberFormatter")?h=t.get("numberFormatter")(h):h=Sv(h,d,t.get("numberDigitGroupCount"),t.get("numberDigitGroupSep"),t.get("numberDecimalMark"))),h)})}});$.spformat=function(e,n){return new $v(e,n)};Ao=function(e,n,t){return e<n?n:e>t?t:e},Zs=function(e,n){let t;return n===2?(t=Math.floor(e.length/2),e.length%2?e[t]:(e[t-1]+e[t])/2):e.length%2?(t=(e.length*n+n)/4,t%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1]):(t=(e.length*n+2)/4,t%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1])},Js=function(e){let n;switch(e){case"undefined":e=void 0;break;case"null":e=null;break;case"true":e=!0;break;case"false":e=!1;break;default:n=parseFloat(e),e==n&&(e=n)}return e},Qs=function(e){let n,t=[];for(n=e.length;n--;)t[n]=Js(e[n]);return t},ya=function(e,n,t){let l;for(l=n.length;l--;)if(!(t&&n[l]===null)&&n[l]!==e)return!1;return!0},Yh=function(e,n){let t,l,o=[];for(t=0,l=e.length;t<l;t++)e[t]!==n&&o.push(e[t]);return o},Tv=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},Sv=function(e,n,t,l,o){let a,s;for(e=(n===!1?parseFloat(e).toString():e.toFixed(n)).split(""),a=(a=$.inArray(".",e))<0?e.length:a,a<e.length&&(e[a]=o),s=a-t;s>0;s-=t)e.splice(s,0,l);return e.join("")},zo=Gh({init:function(e){let n,t,l=[];for(n in e)e.hasOwnProperty(n)&&typeof n=="string"&&n.indexOf(":")>-1&&(t=n.split(":"),t[0]=t[0].length===0?-Infinity:parseFloat(t[0]),t[1]=t[1].length===0?Infinity:parseFloat(t[1]),t[2]=e[n],l.push(t));this.map=e,this.rangelist=l||!1},get:function(e){let n=this.rangelist,t,l,o;if((o=this.map[e])!==void 0)return o;if(n){for(t=n.length;t--;)if(l=n[t],l[0]<=e&&l[1]>=e)return l[2]}}});$.range_map=function(e){return new zo(e)};Ir={defaultOption:{common:{type:"line",lineColor:"#2ec7c9",fillColor:"#CCF3F4",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!0,disableInteraction:!0,offsetX:0,offsetY:0},line:{spotColor:0,highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:0,maxSpotColor:0,lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!0,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0},bar:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},column:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},tristate:{barWidth:4,barSpacing:1,posBarColor:"#fc5c5c",negBarColor:"#97b552",zeroBarColor:"#999",colorMap:{}},discrete:{lineHeight:"auto",thresholdColor:"#fc5c5c",thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff","#6D87FF","#5876FF","#4465FF","#2F54FF","#1A43FF","#0532FF"],base:void 0},pie:{offset:0,sliceColors:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],borderWidth:0,borderColor:"#000"},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#5E5E5E",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0}},line:{type:"line",init:function(e,n,t,l,o){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null},getRegion:function(e,n,t){let l,o=this.regionMap;for(l=o.length;l--;)if(o[l]!==null&&n>=o[l][0]&&n<=o[l][1])return o[l][2]},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.yvalues[e]===null,x:this.xvalues[e],y:this.yvalues[e],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:e}},renderHighlight:function(){let e=this.currentRegion,n=this.target,t=this.vertices[e],l=this.options,o=l.get("spotRadius"),a=l.get("highlightSpotColor"),s=l.get("highlightLineColor"),u,h;!t||(o&&a&&(u=n.drawCircle(t[0],t[1],o,void 0,a),this.highlightSpotId=u.id,n.insertAfterShape(this.lastShapeId,u)),s&&(h=n.drawLine(t[0],this.canvasTop,t[0],this.canvasTop+this.canvasHeight,s),this.highlightLineId=h.id,n.insertAfterShape(this.lastShapeId,h)))},removeHighlight:function(){let e=this.target;this.highlightSpotId&&(e.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(e.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){let e=this.values,n=e.length,t=this.xvalues,l=this.yvalues,o=this.yminmax,a,s,u,h,d;for(a=0;a<n;a++)s=e[a],u=typeof e[a]=="string",h=typeof e[a]=="object"&&e[a]instanceof Array,d=u&&e[a].split(":"),u&&d.length===2?(t.push(Number(d[0])),l.push(Number(d[1])),o.push(Number(d[1]))):h?(t.push(s[0]),l.push(s[1]),o.push(s[1])):(t.push(a),e[a]===null||e[a]==="null"?l.push(null):(l.push(Number(s)),o.push(Number(s))));this.options.get("xvalues")&&(t=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,o),this.miny=this.minyorg=Math.min.apply(Math,o),this.maxx=Math.max.apply(Math,t),this.minx=Math.min.apply(Math,t),this.xvalues=t,this.yvalues=l,this.yminmax=o},processRangeOptions:function(){let e=this.options,n=e.get("normalRangeMin"),t=e.get("normalRangeMax");n!==void 0&&(n<this.miny&&(this.miny=n),t>this.maxy&&(this.maxy=t)),e.get("chartRangeMin")!==void 0&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)&&(this.miny=e.get("chartRangeMin")),e.get("chartRangeMax")!==void 0&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)&&(this.maxy=e.get("chartRangeMax")),e.get("chartRangeMinX")!==void 0&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)&&(this.minx=e.get("chartRangeMinX")),e.get("chartRangeMaxX")!==void 0&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)&&(this.maxx=e.get("chartRangeMaxX"))},drawNormalRange:function(e,n,t,l,o){let a=this.options.get("normalRangeMin"),s=this.options.get("normalRangeMax"),u=n+Math.round(t-t*((s-this.miny)/o)),h=Math.round(t*(s-a)/o);h==0&&a==s&&(h=1),this.target.drawRect(e,u,l,h,void 0,this.options.get("normalRangeColor")).append()},render:function(e,n){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.values=n;let t=this.options,l=this.target,o=e.mergedOptions.width,a=e.mergedOptions.height,s=this.vertices,u=t.get("spotRadius"),h=this.regionMap,d,m,p,v,y,k,b,w,x,C,S,_,T,F,R,I,P,O,M,A,z,L,E,V,q;if(this.scanValues(),this.processRangeOptions(),E=this.xvalues,V=this.yvalues,!(!this.yminmax.length||this.yvalues.length<2)){for(v=y=0,d=this.maxx-this.minx==0?1:this.maxx-this.minx,m=this.maxy-this.miny==0?1:this.maxy-this.miny,p=this.yvalues.length-1,u&&(o<u*4||a<u*4)&&(u=0),u&&(z=t.get("highlightSpotColor")&&!t.get("disableInteraction"),(z||t.get("minSpotColor")||t.get("spotColor")&&V[p]===this.miny)&&(a-=Math.ceil(u)),(z||t.get("maxSpotColor")||t.get("spotColor")&&V[p]===this.maxy)&&(a-=Math.ceil(u),v+=Math.ceil(u)),(z||(t.get("minSpotColor")||t.get("maxSpotColor"))&&(V[0]===this.miny||V[0]===this.maxy))&&(y+=Math.ceil(u),o-=Math.ceil(u)),(z||t.get("spotColor")||t.get("minSpotColor")||t.get("maxSpotColor")&&(V[p]===this.miny||V[p]===this.maxy))&&(o-=Math.ceil(u))),a--,t.get("normalRangeMin")!==void 0&&!t.get("drawNormalOnTop")&&this.drawNormalRange(y,v,a,o,m),b=[],w=[b],F=R=null,I=V.length,q=0;q<I;q++)x=E[q],S=E[q+1],C=V[q],_=y+Math.round((x-this.minx)*(o/d)),T=q<I-1?y+Math.round((S-this.minx)*(o/d)):o,R=_+(T-_)/2,h[q]=[F||0,R,q],F=R,C===null?q&&(V[q-1]!==null&&(b=[],w.push(b)),s.push(null)):(C<this.miny&&(C=this.miny),C>this.maxy&&(C=this.maxy),b.length||b.push([_,v+a]),k=[_,v+Math.round(a-a*((C-this.miny)/m))],b.push(k),s.push(k));for(P=[],O=[],M=w.length,q=0;q<M;q++)b=w[q],b.length&&(t.get("fillColor")&&(b.push([b[b.length-1][0],v+a]),O.push(b.slice(0)),b.pop()),b.length>2&&(b[0]=[b[0][0],b[1][1]]),P.push(b));for(M=O.length,q=0;q<M;q++)l.drawShape(O[q],t.get("fillColor"),t.get("fillColor")).append();for(M=P.length,q=0;q<M;q++)l.drawShape(P[q],t.get("lineColor"),void 0,t.get("lineWidth")).append();if(t.get("normalRangeMin")!==void 0&&t.get("drawNormalOnTop")&&this.drawNormalRange(y,v,a,o,m),u&&t.get("valueSpots"))for(A=t.get("valueSpots"),A.get===void 0&&(A=new zo(A)),q=0;q<I;q++)L=A.get(V[q]),L&&l.drawCircle(y+Math.round((E[q]-this.minx)*(o/d)),v+Math.round(a-a*((V[q]-this.miny)/m)),u,void 0,L).append();u&&t.get("spotColor")&&V[p]!==null&&l.drawCircle(y+Math.round((E[E.length-1]-this.minx)*(o/d)),v+Math.round(a-a*((V[p]-this.miny)/m)),u,void 0,t.get("spotColor")).append(),this.maxy!==this.minyorg&&(u&&t.get("minSpotColor")&&(x=E[$.inArray(this.minyorg,V)],l.drawCircle(y+Math.round((x-this.minx)*(o/d)),v+Math.round(a-a*((this.minyorg-this.miny)/m)),u,void 0,t.get("minSpotColor")).append()),u&&t.get("maxSpotColor")&&(x=E[$.inArray(this.maxyorg,V)],l.drawCircle(y+Math.round((x-this.minx)*(o/d)),v+Math.round(a-a*((this.maxyorg-this.miny)/m)),u,void 0,t.get("maxSpotColor")).append()))}}},bar:{type:"bar",init:function(e,n){let t=this.options,l=e.mergedOptions.height,o=e.mergedOptions.width;this.canvasWidth=e.mergedOptions.height,this.canvasHeight=e.mergedOptions.width;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10),u=t.get("chartRangeMin"),h=t.get("chartRangeMax"),d=t.get("chartRangeClip"),m=Infinity,p=-Infinity,v,y,k,b,w,x,C,S,_,T,F,R,I,P,O,M,A,z,L,E,V,q,G;for(this.values=n,x=0,C=n.length;x<C;x++)E=n[x],v=typeof E=="string"&&E.indexOf(":")>-1,(v||$.isArray(E))&&(O=!0,v&&(E=n[x]=Qs(E.split(":"))),E=Yh(E,null),y=Math.min.apply(Math,E),k=Math.max.apply(Math,E),y<m&&(m=y),k>p&&(p=k));this.stacked=O,this.regionShapes={},this.barWidth=Math.floor(l/n.length)-s,this.barSpacing=s,this.totalBarWidth=this.barWidth+s,this.width=l,d&&(I=u===void 0?-Infinity:u,P=h===void 0?Infinity:h),w=[],b=O?[]:w;let X=[],ee=[];for(x=0,C=n.length;x<C;x++)if(O)for(M=n[x],n[x]=L=[],X[x]=0,b[x]=ee[x]=0,A=0,z=M.length;A<z;A++)E=L[A]=d?Ao(M[A],I,P):M[A],E!==null&&(E>0&&(X[x]+=E),m<0&&p>0?E<0?ee[x]+=Math.abs(E):b[x]+=E:b[x]+=Math.abs(E),w.push(E));else E=d?Ao(n[x],I,P):n[x],E=n[x]=Js(E),E!==null&&w.push(E);this.max=R=Math.max.apply(Math,w),this.min=F=Math.min.apply(Math,w),this.stackMax=p=O?Math.max.apply(Math,X):R,this.stackMin=m=O?Math.min.apply(Math,w):F,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<F)&&(F=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>R)&&(R=t.get("chartRangeMax")),this.zeroAxis=_=t.get("zeroAxis",!0),F<=0&&R>=0&&_?T=0:_==!1?T=F:F>0?T=0:T=R,this.xaxisOffset=T,S=O?Math.max.apply(Math,b)+Math.max.apply(Math,ee):R-T,this.canvasHeightEf=_&&F<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,F<T?(V=Math.floor(this.canvasHeight/2),this.isNeg=!0,V!==Math.ceil(V)&&(this.canvasHeightEf-=2,V=Math.ceil(V))):V=0,this.yoffset=V,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new zo(this.colorMapByValue))),this.range=S},getRegion:function(e,n,t){let l=Math.floor(n/this.totalBarWidth);return l<0||l>=this.values.length?void 0:l},getCurrentRegionFields:function(){let e=this.currentRegion,n=ensureArray(this.values[e]),t=[],l,o;for(o=n.length;o--;)l=n[o],t.push({isNull:l===null,value:l,color:this.calcColor(o,l,e),offset:e});return t},calcColor:function(e,n,t){let l=this.colorMapByIndex,o=this.colorMapByValue,a=this.options,s,u;return this.stacked?s=a.get("stackedBarColor"):s=n<0?a.get("negBarColor"):a.get("barColor"),n===0&&a.get("zeroColor")!==void 0&&(s=a.get("zeroColor")),o&&(u=o.get(n))?s=u:l&&l.length>t&&(s=l[t]),$.isArray(s)?s[e%s.length]:s},renderRegion:function(e,n){let t=this.values[e],l=this.options,o=this.xaxisOffset,a=[],s=this.range,u=this.stacked,h=this.target,d=e*this.totalBarWidth,m=this.canvasHeightEf,p=this.yoffset,v,y,k,b,w,x,C,S,_,T;if(t=$.isArray(t)?t:[t],C=t.length,S=t[0],b=ya(null,t),T=ya(o,t,!0),b)return l.get("nullColor")?(k=n?l.get("nullColor"):this.calcHighlightColor(l.get("nullColor"),l),v=p>0?p-1:p,h.drawRect(v,d,0,this.barWidth-1,k,k)):void 0;for(w=p,this.isNeg&&(m=Math.floor(m/2)),x=0;x<C;x++){if(S=t[x],u&&S===o){if(!T||_)continue;_=!0}s>0?y=Math.floor(m*(Math.abs(S-o)/s)):y=m,S<o||S===o&&p===0?(v=w-y,w+=y):u?(v=p,p+=y):(v=p,p-=y),k=this.calcColor(x,S,e),n&&(k=this.calcHighlightColor(k,l)),a.push(h.drawRect(v,d,y-1,this.barWidth-1,k,k))}return a.length===1?a[0]:a}},column:{type:"column",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10),u=t.get("chartRangeMin"),h=t.get("chartRangeMax"),d=t.get("chartRangeClip"),m=Infinity,p=-Infinity,v,y,k,b,w,x,C,S,_,T,F,R,I,P,O,M,A,z,L,E,V,q,G;for(this.values=n,x=0,C=n.length;x<C;x++)E=n[x],v=typeof E=="string"&&E.indexOf(":")>-1,(v||$.isArray(E))&&(O=!0,v&&(E=n[x]=Qs(E.split(":"))),E=Yh(E,null),y=Math.min.apply(Math,E),k=Math.max.apply(Math,E),y<m&&(m=y),k>p&&(p=k));this.stacked=O,this.regionShapes={},this.barWidth=Math.floor(l/n.length)-s,this.barSpacing=s,this.totalBarWidth=this.barWidth+s,this.width=l,d&&(I=u===void 0?-Infinity:u,P=h===void 0?Infinity:h),w=[],b=O?[]:w;let X=[],ee=[];for(x=0,C=n.length;x<C;x++)if(O)for(M=n[x],n[x]=L=[],X[x]=0,b[x]=ee[x]=0,A=0,z=M.length;A<z;A++)E=L[A]=d?Ao(M[A],I,P):M[A],E!==null&&(E>0&&(X[x]+=E),m<0&&p>0?E<0?ee[x]+=Math.abs(E):b[x]+=E:b[x]+=Math.abs(E),w.push(E));else E=d?Ao(n[x],I,P):n[x],E=n[x]=Js(E),E!==null&&w.push(E);this.max=R=Math.max.apply(Math,w),this.min=F=Math.min.apply(Math,w),this.stackMax=p=O?Math.max.apply(Math,X):R,this.stackMin=m=O?Math.min.apply(Math,w):F,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<F)&&(F=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>R)&&(R=t.get("chartRangeMax")),this.zeroAxis=_=t.get("zeroAxis",!0),F<=0&&R>=0&&_?T=0:_==!1?T=F:F>0?T=0:T=R,this.xaxisOffset=T,S=O?Math.max.apply(Math,b)+Math.max.apply(Math,ee):R-T,this.canvasHeightEf=_&&F<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,F<T?(V=Math.floor(this.canvasHeight/2),this.isNeg=!0,V!==Math.ceil(V)&&(this.canvasHeightEf-=2,V=Math.ceil(V))):V=this.canvasHeight,this.yoffset=V,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new zo(this.colorMapByValue))),this.range=S},getRegion:function(e,n,t){let l=Math.floor(n/this.totalBarWidth);return l<0||l>=this.values.length?void 0:l},getCurrentRegionFields:function(){let e=this.currentRegion,n=ensureArray(this.values[e]),t=[],l,o;for(o=n.length;o--;)l=n[o],t.push({isNull:l===null,value:l,color:this.calcColor(o,l,e),offset:e});return t},calcColor:function(e,n,t){let l=this.colorMapByIndex,o=this.colorMapByValue,a=this.options,s,u;return this.stacked?s=a.get("stackedBarColor"):s=n<0?a.get("negBarColor"):a.get("barColor"),n===0&&a.get("zeroColor")!==void 0&&(s=a.get("zeroColor")),o&&(u=o.get(n))?s=u:l&&l.length>t&&(s=l[t]),$.isArray(s)?s[e%s.length]:s},renderRegion:function(e,n){let t=this.values[e],l=this.options,o=this.xaxisOffset,a=[],s=this.range,u=this.stacked,h=this.target,d=e*this.totalBarWidth,m=this.canvasHeightEf,p=this.yoffset,v,y,k,b,w,x,C,S,_,T;if(t=$.isArray(t)?t:[t],C=t.length,S=t[0],b=ya(null,t),T=ya(o,t,!0),b)return l.get("nullColor")?(k=n?l.get("nullColor"):this.calcHighlightColor(l.get("nullColor"),l),v=p>0?p-1:p,h.drawRect(d,v,this.barWidth-1,0,k,k)):void 0;for(w=p,this.isNeg&&(m=Math.floor(m/2)),x=0;x<C;x++){if(S=t[x],u&&S===o){if(!T||_)continue;_=!0}s>0?y=Math.floor(m*(Math.abs(S-o)/s)):y=m,S<o||S===o&&p===0?(v=w,w+=y):(v=p-y,p-=y),k=this.calcColor(x,S,e),n&&(k=this.calcHighlightColor(k,l)),a.push(h.drawRect(d,v,this.barWidth-1,y-1,k,k))}return a.length===1?a[0]:a}},tristate:{type:"tristate",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10);this.regionShapes={},this.barWidth=a,this.barSpacing=s,this.totalBarWidth=a+s,this.values=$.map(n,Number),this.width=l=n.length*a+(n.length-1)*s,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new zo(this.colorMapByValue)))},getRegion:function(e,n,t){return Math.floor(n/this.totalBarWidth)},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],color:this.calcColor(this.values[e],e),offset:e}},calcColor:function(e,n){let t=this.values,l=this.options,o=this.colorMapByIndex,a=this.colorMapByValue,s,u;return a&&(u=a.get(e))?s=u:o&&o.length>n?s=o[n]:t[n]<0?s=l.get("negBarColor"):t[n]>0?s=l.get("posBarColor"):s=l.get("zeroBarColor"),s},renderRegion:function(e,n){let t=this.values,l=this.options,o=this.target,a,s,u,h,d,m;if(a=this.canvasHeight,u=Math.round(a/2),h=e*this.totalBarWidth,t[e]<0?(d=u,s=u-1):t[e]>0?(d=0,s=u-1):(d=u-1,s=2),m=this.calcColor(t[e],e),m!==null)return n&&(m=this.calcHighlightColor(m,l)),o.drawRect(h,d,this.barWidth-1,s-1,m,m)}},discrete:{type:"discrete",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.regionShapes={},this.values=n=$.map(n,Number),this.min=Math.min.apply(Math,n),this.max=Math.max.apply(Math,n),this.range=this.max-this.min,this.width=l,this.interval=Math.floor(l/n.length),this.itemWidth=l/n.length,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.min)&&(this.min=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.max)&&(this.max=t.get("chartRangeMax")),this.target&&(this.lineHeight=t.get("lineHeight")==="auto"?Math.round(this.canvasHeight*.3):t.get("lineHeight"))},getRegion:function(e,n,t){return Math.floor(n/this.itemWidth)},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],offset:e}},renderRegion:function(e,n){let t=this.values,l=this.options,o=this.min,a=this.max,s=this.range,u=this.interval,h=this.target,d=this.canvasHeight,m=this.lineHeight,p=d-m,v,y,k,b;return y=Ao(t[e],o,a),b=e*u,v=Math.round(p-p*((y-o)/s)),k=l.get("thresholdColor")&&y<l.get("thresholdValue")?l.get("thresholdColor"):l.get("lineColor"),n&&(k=this.calcHighlightColor(k,l)),this.target.drawRect(b,v,u<=2?1:u-2,m,k,k)}},bullet:{type:"bullet",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a,s,u;this.values=n=Qs(n),u=n.slice(),u[0]=u[0]===null?u[2]:u[0],u[1]=n[1]===null?u[2]:u[1],a=Math.min.apply(Math,n),s=Math.max.apply(Math,n),t.get("base")===void 0?a=a<0?a:0:a=t.get("base"),this.min=a,this.max=s,this.range=s-a,this.shapes={},this.valueShapes={},this.regiondata={},this.width=l,n.length||(this.disabled=!0)},getRegion:function(e,n,t){let l=this.target.getShapeAt(e,n,t);return l!==void 0&&this.shapes[l]!==void 0?this.shapes[l]:void 0},getCurrentRegionFields:function(){let e=this.currentRegion;return{fieldkey:e.substr(0,1),value:this.values[e.substr(1)],region:e}},changeHighlight:function(e){let n=this.currentRegion,t=this.valueShapes[n],l;switch(delete this.shapes[t],n.substr(0,1)){case"r":l=this.renderRange(n.substr(1),e);break;case"p":l=this.renderPerformance(e);break;case"t":l=this.renderTarget(e);break}this.valueShapes[n]=l.id,this.shapes[l.id]=n,this.target.replaceWithShape(t,l)},renderRange:function(e,n){let t=this.values[e],l=Math.round(this.canvasWidth*((t-this.min)/this.range)),o=this.options.get("rangeColors")[e-2];return n&&(o=this.calcHighlightColor(o,this.options)),this.target.drawRect(0,0,l-1,this.canvasHeight-1,o,o)},renderPerformance:function(e){let n=this.values[1],t=Math.round(this.canvasWidth*((n-this.min)/this.range)),l=this.options.get("performanceColor");return e&&(l=this.calcHighlightColor(l,this.options)),this.target.drawRect(0,Math.round(this.canvasHeight*.3),t-1,Math.round(this.canvasHeight*.4)-1,l,l)},renderTarget:function(e){let n=this.values[0],t=Math.round(this.canvasWidth*((n-this.min)/this.range)-this.options.get("targetWidth")/2),l=Math.round(this.canvasHeight*.1),o=this.canvasHeight-l*2,a=this.options.get("targetColor");return e&&(a=this.calcHighlightColor(a,this.options)),this.target.drawRect(t,l,this.options.get("targetWidth")-1,o-1,a,a)},render:function(e,n){this.init(e,n);let t=this.values.length,l=this.target,o,a;for(o=2;o<t;o++)a=this.renderRange(o).append(),this.shapes[a.id]="r"+o,this.valueShapes["r"+o]=a.id;this.values[1]!==null&&(a=this.renderPerformance().append(),this.shapes[a.id]="p1",this.valueShapes.p1=a.id),this.values[0]!==null&&(a=this.renderTarget().append(),this.shapes[a.id]="t0",this.valueShapes.t0=a.id)}},pie:{type:"pie",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=0,s;if(this.shapes={},this.valueShapes={},this.values=n=$.map(n,Number),t.get("width")==="auto"&&(this.width=this.height),n.length>0)for(s=n.length;s--;)a+=n[s];this.total=a,this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(e,n,t){let l=this.target.getShapeAt(e,n,t);return l!==void 0&&this.shapes[l]!==void 0?this.shapes[l]:void 0},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],percent:this.values[e]/this.total*100,color:this.options.get("sliceColors")[e%this.options.get("sliceColors").length],offset:e}},changeHighlight:function(e){let n=this.currentRegion,t=this.renderSlice(n,e),l=this.valueShapes[n];delete this.shapes[l],this.target.replaceWithShape(l,t),this.valueShapes[n]=t.id,this.shapes[t.id]=n},renderSlice:function(e,n){let t=this.target,l=this.options,o=this.radius,a=l.get("borderWidth"),s=l.get("offset"),u=2*Math.PI,h=this.values,d=this.total,m=s?2*Math.PI*(s/360):0,p,v,y,k,b;for(k=h.length,y=0;y<k;y++){if(p=m,v=m,d>0&&(v=m+u*(h[y]/d)),e===y)return b=l.get("sliceColors")[y%l.get("sliceColors").length],n&&(b=this.calcHighlightColor(b,l)),t.drawPieSlice(o,o,o-a,p,v,void 0,b);m=v}},render:function(e,n){this.init(e,n);let t=this.target,l=this.values,o=this.options,a=this.radius,s=o.get("borderWidth"),u,h;for(s&&t.drawCircle(a,a,Math.floor(a-s/2),o.get("borderColor"),void 0,s).append(),h=l.length;h--;)l[h]&&(u=this.renderSlice(h).append(),this.valueShapes[h]=u.id,this.shapes[u.id]=h)}},box:{type:"box",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=$.map(n,Number),this.width=t.get("width")==="auto"?"4.0em":l,this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){let e=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==void 0&&e.push({field:"lo",value:this.loutlier}),this.routlier!==void 0&&e.push({field:"ro",value:this.routlier}),this.lwhisker!==void 0&&e.push({field:"lw",value:this.lwhisker}),this.rwhisker!==void 0&&e.push({field:"rw",value:this.rwhisker}),e},render:function(e,n){this.init(e,n);let t=this.target,l=this.values,o=l.length,a=this.options,s=this.canvasWidth,u=this.canvasHeight,h=a.get("chartRangeMin")===void 0?Math.min.apply(Math,l):a.get("chartRangeMin"),d=a.get("chartRangeMax")===void 0?Math.max.apply(Math,l):a.get("chartRangeMax"),m=0,p,v,y,k,b,w,x,C,S,_,T;if(a.get("raw"))a.get("showOutliers")&&l.length>5?(v=l[0],p=l[1],k=l[2],b=l[3],w=l[4],x=l[5],C=l[6]):(p=l[0],k=l[1],b=l[2],w=l[3],x=l[4]);else if(l.sort(function(F,R){return F-R}),k=Zs(l,1),b=Zs(l,2),w=Zs(l,3),y=w-k,a.get("showOutliers")){for(p=x=void 0,S=0;S<o;S++)p===void 0&&l[S]>k-y*a.get("outlierIQR")&&(p=l[S]),l[S]<w+y*a.get("outlierIQR")&&(x=l[S]);v=l[0],C=l[o-1]}else p=l[0],x=l[o-1];this.quartiles=[k,b,w],this.lwhisker=p,this.rwhisker=x,this.loutlier=v,this.routlier=C,T=s/(d-h+1),a.get("showOutliers")&&(m=Math.ceil(a.get("spotRadius")),s-=2*Math.ceil(a.get("spotRadius")),T=s/(d-h+1),v<p&&t.drawCircle((v-h)*T+m,u/2,a.get("spotRadius"),a.get("outlierLineColor"),a.get("outlierFillColor")).append(),C>x&&t.drawCircle((C-h)*T+m,u/2,a.get("spotRadius"),a.get("outlierLineColor"),a.get("outlierFillColor")).append()),t.drawRect(Math.round((k-h)*T+m),Math.round(u*.1),Math.round((w-k)*T),Math.round(u*.8),a.get("boxLineColor"),a.get("boxFillColor")).append(),t.drawLine(Math.round((p-h)*T+m),Math.round(u/2),Math.round((k-h)*T+m),Math.round(u/2),a.get("lineColor")).append(),t.drawLine(Math.round((p-h)*T+m),Math.round(u/4),Math.round((p-h)*T+m),Math.round(u-u/4),a.get("whiskerColor")).append(),t.drawLine(Math.round((x-h)*T+m),Math.round(u/2),Math.round((w-h)*T+m),Math.round(u/2),a.get("lineColor")).append(),t.drawLine(Math.round((x-h)*T+m),Math.round(u/4),Math.round((x-h)*T+m),Math.round(u-u/4),a.get("whiskerColor")).append(),t.drawLine(Math.round((b-h)*T+m),Math.round(u*.1),Math.round((b-h)*T+m),Math.round(u*.9),a.get("medianColor")).append(),a.get("target")&&(_=Math.ceil(a.get("spotRadius")),t.drawLine(Math.round((a.get("target")-h)*T+m),Math.round(u/2-_),Math.round((a.get("target")-h)*T+m),Math.round(u/2+_),a.get("targetColor")).append(),t.drawLine(Math.round((a.get("target")-h)*T+m-_),Math.round(u/2),Math.round((a.get("target")-h)*T+m+_),Math.round(u/2),a.get("targetColor")).append())}},shapeCount:0,shapes:{},shapeseq:[],lastShapeId:null,mergedOptions:null,init:function(e,n){let t,l,o;n=n||{};let a=this;return l=this.defaultOption,o=l.common,t=l[n.type||o.type],a.shapeCount=0,a.shapes={},a.shapeseq=[],a.lastShapeId=null,a.mergedOptions=$.extend({},o,t,n),a.mergedOptions.width=a.mergedOptions.width,a.mergedOptions.height=a.mergedOptions.height,a[a.mergedOptions.type].render(a,e),{shapes:a.shapes,shapeseq:a.shapeseq,offsetX:a.mergedOptions.offsetX,offsetY:a.mergedOptions.offsetY,pixelWidth:a.mergedOptions.width,pixelHeight:a.mergedOptions.height}},_getContext:function(e,n,t){let l;return this.ctx!=null?l=this.ctx:l=$("#"+this._canvasID).get(0).getContext("2d"),e!==void 0&&(l.strokeStyle=e),l.lineWidth=t===void 0?1:t,n!==void 0&&(l.fillStyle=n),l},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(e,n,t,l,o){let a=this._getContext(t,l,o),s,u;for(a.beginPath(),a.moveTo(n[0][0]+.5+this.offsetX,n[0][1]+.5+this.offsetY),s=1,u=n.length;s<u;s++)a.lineTo(n[s][0]+.5+this.offsetX,n[s][1]+.5+this.offsetY);t!==void 0&&a.stroke(),l!==void 0&&a.fill(),this.targetX!==void 0&&this.targetY!==void 0&&a.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawCircle:function(e,n,t,l,o,a,s){let u=this._getContext(o,a,s);u.beginPath(),n+=this.offsetX,t+=this.offsetY,u.arc(n,t,l,0,2*Math.PI,!1),this.targetX!==void 0&&this.targetY!==void 0&&u.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e),o!==void 0&&u.stroke(),a!==void 0&&u.fill()},_drawPieSlice:function(e,n,t,l,o,a,s,u){let h=this._getContext(s,u);n+=this.offsetX,t+=this.offsetY,h.beginPath(),h.moveTo(n,t),h.arc(n,t,l,o,a,!1),h.lineTo(n,t),h.closePath(),s!==void 0&&h.stroke(),u&&h.fill(),this.targetX!==void 0&&this.targetY!==void 0&&h.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawRect:function(e,n,t,l,o,a,s){return this._drawShape(e,[[n,t],[n+l,t],[n+l,t+o],[n,t+o],[n,t]],a,s)},appendShape:function(e){return this.shapes[e.id]=e,this.shapeseq.push(e.id),this.lastShapeId=e.id,e.id},replaceWithShape:function(e,n){let t=this.shapeseq,l;for(this.shapes[n.id]=n,l=t.length;l--;)t[l]==e&&(t[l]=n.id);delete this.shapes[e]},replaceWithShapes:function(e,n){let t=this.shapeseq,l={},o,a,s;for(a=e.length;a--;)l[e[a]]=!0;for(a=t.length;a--;)o=t[a],l[o]&&(t.splice(a,1),delete this.shapes[o],s=a);for(a=n.length;a--;)t.splice(s,0,n[a].id),this.shapes[n[a].id]=n[a]},insertAfterShape:function(e,n){let t=this.shapeseq,l;for(l=t.length;l--;)if(t[l]===e){t.splice(l+1,0,n.id),this.shapes[n.id]=n;return}},removeShapeId:function(e){let n=this.shapeseq,t;for(t=n.length;t--;)if(n[t]===e){n.splice(t,1);break}delete this.shapes[e]},getShapeAt:function(e,n,t){return this.targetX=n,this.targetY=t,this.render(),this.currentTargetShapeId},_canvasID:"luckysheetTableContent",render:function(e,n,t,l,o,a,s,u){s==null&&(s="luckysheetTableContent"),this._canvasID=s,u!=null&&(this.ctx=u);let h=e.length,d=this._getContext(),m,p,v;for(this.offsetX=t,this.offsetY=l,this.pixelWidth=o,this.pixelHeight=a,v=0;v<h;v++)m=e[v],p=n[m],this["_draw"+p.type].apply(this,p.args)},drawLine:function(e,n,t,l,o,a){return this.drawShape([[e,n],[t,l]],o,a)},drawShape:function(e,n,t,l){return this._genShape("Shape",[e,n,t,l])},drawCircle:function(e,n,t,l,o,a){return this._genShape("Circle",[e,n,t,l,o,a])},drawPieSlice:function(e,n,t,l,o,a,s){return this._genShape("PieSlice",[e,n,t,l,o,a,s])},drawRect:function(e,n,t,l,o,a){return this._genShape("Rect",[e,n,t,l,o,a])},_genShape:function(e,n){let t=this.shapeCount++;n.unshift(t);let l={id:t,type:e,args:n};return this.shapes[t]=l,this.shapeseq.push(t),this.lastShapeId=t,{append:function(){return l},get:function(){return t}}}},Xh={changeHighlight:function(e){let n=this.currentRegion,t=this.target,l=this.regionShapes[n],o;l&&(o=this.renderRegion(n,e),$.isArray(o)||$.isArray(l)?(t.replaceWithShapes(l,o),this.regionShapes[n]=$.map(o,function(a){return a.id})):(t.replaceWithShape(l,o),this.regionShapes[n]=o.id))},render:function(e,n){this.init(e,n);let t=this.values,l=this.target,o=this.regionShapes,a,s,u,h;for(u=t.length;u--;)if(a=this.renderRegion(u),a)if($.isArray(a)){for(s=[],h=a.length;h--;)a[h].append(),s.push(a[h].id);o[u]=s}else a.append(),o[u]=a.id;else o[u]=null}},Iv={get:function(e){return Ir.mergedOptions[e]}},Rv={drawLine:function(e,n,t,l,o,a){return Ir.drawLine(e,n,t,l,o,a)},drawShape:function(e,n,t,l){return Ir.drawShape(e,n,t,l)},drawCircle:function(e,n,t,l,o,a){return Ir.drawCircle(e,n,t,l,o,a)},drawPieSlice:function(e,n,t,l,o,a,s){return Ir.drawPieSlice(e,n,t,l,o,a,s)},drawRect:function(e,n,t,l,o,a){return Ir.drawRect(e,n,t,l,o,a)}};for(let e in Ir)e in{line:null,bar:null,column:null,tristate:null,discrete:null,bullet:null,pie:null,box:null}&&(Ir[e].options=Iv,Ir[e].target=Rv),e in{bar:null,column:null,tristate:null,discrete:null}&&(Ir[e].changeHighlight=Xh.changeHighlight,Ir[e].render=Xh.render);Jl=Ir});function mi(e,n,t){e==null&&(e=$("#luckysheet-cell-main").scrollTop()),n==null&&(n=f.luckysheetTableContentHW[1]),t==null&&(t=f.columnHeaderHeight);let l=$("#luckysheetTableContent").get(0).getContext("2d");l.save(),l.scale(f.devicePixelRatio,f.devicePixelRatio),l.clearRect(0,t,f.rowHeaderWidth-1,n),l.font=Yn(),l.textBaseline=Tl.textBaseline,l.fillStyle=Tl.fillStyle;let o,a;o=at(f.visibledatarow,e),a=at(f.visibledatarow,e+n),o==-1&&(o=0),a==-1&&(a=f.visibledatarow.length-1),l.save(),l.beginPath(),l.rect(0,t-1,f.rowHeaderWidth-1,n-2),l.clip();let s,u,h=.5,d;for(let m=o;m<=a;m++){m==0?u=-e-1:u=f.visibledatarow[m-1]-e-1,s=f.visibledatarow[m]-e;let p=o==m?-2:0,v=a==m?-2:0;if(!!Je.createHookFunction("rowTitleCellRenderBefore",m+1,{r:m,top:u+t+p,width:f.rowHeaderWidth-1,height:s-u+1+v-p},l)){if(!(f.config.rowhidden!=null&&f.config.rowhidden[m]!=null)){l.fillStyle="#ffffff",l.fillRect(0,u+t+p,f.rowHeaderWidth-1,s-u+1+v-p),l.fillStyle="#000000",l.save(),l.scale(f.zoomRatio,f.zoomRatio);let y=Er(m+1,l),k=(f.rowHeaderWidth-y.width)/2,b=u+(s-u)/2+t;l.fillText(m+1,k/f.zoomRatio,b/f.zoomRatio),l.restore()}l.beginPath(),l.moveTo(f.rowHeaderWidth-2+h,u+t-2),l.lineTo(f.rowHeaderWidth-2+h,s+t-2),l.lineWidth=1,l.strokeStyle=Tl.strokeStyle,l.stroke(),l.closePath(),f.config.rowhidden!=null&&f.config.rowhidden[m]==null&&f.config.rowhidden[m+1]!=null?(l.beginPath(),l.moveTo(-1,s+t-4+h),l.lineTo(f.rowHeaderWidth-1,s+t-4+h),l.closePath(),l.stroke()):(f.config.rowhidden==null||f.config.rowhidden[m]==null)&&(l.beginPath(),l.moveTo(-1,s+t-2+h),l.lineTo(f.rowHeaderWidth-1,s+t-2+h),l.closePath(),l.stroke()),f.config.rowhidden!=null&&f.config.rowhidden[m-1]!=null&&d!=null&&(l.beginPath(),l.moveTo(-1,d+t+h),l.lineTo(f.rowHeaderWidth-1,d+t+h),l.closePath(),l.stroke()),d=s,Je.createHookFunction("rowTitleCellRenderAfter",m+1,{r:m,top:u+t+p,width:f.rowHeaderWidth-1,height:s-u+1+v-p},l)}}l.restore(),l.restore()}function gi(e,n,t){e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=f.luckysheetTableContentHW[0]),t==null&&(t=f.rowHeaderWidth);let l=$("#luckysheetTableContent").get(0).getContext("2d");l.save(),l.scale(f.devicePixelRatio,f.devicePixelRatio),l.clearRect(t,0,n,f.columnHeaderHeight-1),l.font=Yn(),l.textBaseline=Tl.textBaseline,l.fillStyle=Tl.fillStyle;let o,a;o=at(f.visibledatacolumn,e),a=at(f.visibledatacolumn,e+n),o==-1&&(o=0),a==-1&&(a=f.visibledatacolumn.length-1),l.save(),l.beginPath(),l.rect(t-1,0,n,f.columnHeaderHeight-1),l.clip();let s,u,h=.5,d;for(let m=o;m<=a;m++){m==0?u=-e:u=f.visibledatacolumn[m-1]-e,s=f.visibledatacolumn[m]-e;let p=tt(m);if(!!Je.createHookFunction("columnTitleCellRenderBefore",p,{c:m,left:u+t-1,width:s-u,height:f.columnHeaderHeight-1},l)){if(!(f.config.colhidden!=null&&f.config.colhidden[m]!=null)){l.fillStyle="#ffffff",l.fillRect(u+t-1,0,s-u,f.columnHeaderHeight-1),l.fillStyle="#000000",l.save(),l.scale(f.zoomRatio,f.zoomRatio);let v=Er(p,l),y=Math.round(u+(s-u)/2+t-v.width/2),k=Math.round(f.columnHeaderHeight/2);l.fillText(p,y/f.zoomRatio,k/f.zoomRatio),l.restore()}f.config.colhidden!=null&&f.config.colhidden[m]==null&&f.config.colhidden[m+1]!=null?(l.beginPath(),l.moveTo(s+t-4+h,0),l.lineTo(s+t-4+h,f.columnHeaderHeight-2),l.lineWidth=1,l.strokeStyle=Tl.strokeStyle,l.closePath(),l.stroke()):(f.config.colhidden==null||f.config.colhidden[m]==null)&&(l.beginPath(),l.moveTo(s+t-2+h,0),l.lineTo(s+t-2+h,f.columnHeaderHeight-2),l.lineWidth=1,l.strokeStyle=Tl.strokeStyle,l.closePath(),l.stroke()),f.config.colhidden!=null&&f.config.colhidden[m-1]!=null&&d!=null&&(l.beginPath(),l.moveTo(d+t+h,0),l.lineTo(d+t+h,f.columnHeaderHeight-2),l.closePath(),l.stroke()),l.beginPath(),l.moveTo(u+t-1,f.columnHeaderHeight-2+h),l.lineTo(s+t-1,f.columnHeaderHeight-2+h),l.stroke(),l.closePath(),d=s,Je.createHookFunction("columnTitleCellRenderAfter",p,{c:m,left:u+t-1,width:s-u,height:f.columnHeaderHeight-1},l)}}l.restore(),l.restore()}function nr(e,n,t,l,o,a,s,u,h){if(f.flowdata==null)return;let d=ye.getSheetByIndex();clearTimeout(f.measureTextCacheTimeOut),e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=$("#luckysheet-cell-main").scrollTop()),t==null&&(t=f.luckysheetTableContentHW[0]),l==null&&(l=f.luckysheetTableContentHW[1]),o==null&&(o=f.rowHeaderWidth),a==null&&(a=f.columnHeaderHeight),s==null&&(s=0),u==null&&(u=0);let m=null;if(h==null)m=$("#luckysheetTableContent").get(0).getContext("2d");else if(N(h)=="object")try{m=h.get(0).getContext("2d")}catch(A){m=h}else m=$("#"+h).get(0).getContext("2d");m.save(),m.scale(f.devicePixelRatio,f.devicePixelRatio),m.clearRect(0,0,f.luckysheetTableContentHW[0],f.luckysheetTableContentHW[1]);let p,v,y,k;p=at(f.visibledatarow,n),v=at(f.visibledatarow,n+l),p==-1&&(p=0),p+=u,v==-1&&(v=f.visibledatarow.length-1),v+=u,v>=f.visibledatarow.length&&(v=f.visibledatarow.length-1),y=at(f.visibledatacolumn,e),k=at(f.visibledatacolumn,e+t),y==-1&&(y=0),y+=s,k==-1&&(k=f.visibledatacolumn.length-1),k+=s,k>=f.visibledatacolumn.length&&(k=f.visibledatacolumn.length-1);let b,w,x,C;p==0?b=0:b=f.visibledatarow[p-1],w=f.visibledatarow[v],y==0?x=0:x=f.visibledatacolumn[y-1],C=f.visibledatacolumn[k],m.fillStyle="#ffffff",m.fillRect(o-1,a-1,C-e,w-n),m.font=Yn(),m.fillStyle=Tl.fillStyle;let S=[],_={},T={},F=.5;Je.createHookFunction("cellAllRenderBefore",f.flowdata,d,m);for(let A=p;A<=v;A++){let z;A==0?z=-n-1:z=f.visibledatarow[A-1]-n-1;let L=f.visibledatarow[A]-n;if(!(f.config.rowhidden!=null&&f.config.rowhidden[A]!=null))for(let E=y;E<=k;E++){let V;E==0?V=-e:V=f.visibledatacolumn[E-1]-e;let q=f.visibledatacolumn[E]-e;if(f.config.colhidden!=null&&f.config.colhidden[E]!=null)continue;let G=f.defaultcollen;if(f.config.columnlen!=null&&f.config.columnlen[E]!=null&&(G=f.config.columnlen[E]),f.flowdata[A]!=null&&f.flowdata[A][E]!=null){let X=f.flowdata[A][E];if(N(X)=="object"&&"mc"in X)if(T[A+"_"+E]={start_r:z,start_c:V,end_r:L,end_c:q},"rs"in X.mc){let ee="r"+A+"c"+E;_[ee]=S.length}else{let ee="r"+X.mc.r+"c"+X.mc.c,le=S[_[ee]];le==null?(_[ee]=S.length,S.push({r:A,c:E,start_c:V,start_r:z,end_r:L,end_c:q,firstcolumnlen:G})):(le.c==E&&(le.end_r+=L-z-1),le.r==A&&(le.end_c+=q-V,le.firstcolumnlen+=G));continue}}S.push({r:A,c:E,start_r:z,start_c:V,end_r:L,end_c:q,firstcolumnlen:G}),T[A+"_"+E]={start_r:z,start_c:V,end_r:L,end_c:q}}}let R=xo(f.luckysheetfile[Z(f.currentSheetIndex)].dynamicArray),I=el.getComputeMap(),P=Se.getComputeMap(),O=Fv(m,y,k,p,v),M=[];for(let A=0;A<S.length;A++){let z=S[A],L=z.r,E=z.c,V=z.start_r,q=z.start_c,G=z.end_r,X=z.end_c,ee=z.firstcolumnlen;if(f.flowdata[L]!=null)if(f.flowdata[L][E]==null)tc(L,E,V,q,G,X,m,I,P,o,a,R,O,y,k,n,e,F);else{let le=f.flowdata[L][E],se=null;if(typeof le=="object"&&"mc"in le?M.push(S[A]):se=Fs(L,E),se==null||se.toString().length==0){tc(L,E,V,q,G,X,m,I,P,o,a,R,O,y,k,n,e,F);let ae=be.borderfix(f.flowdata,L,E),ue=[q+o+ae[0],V+a+ae[1],X-q-3+ae[2],G-V-3-1+ae[3]];Kh(L,E,ue[0],ue[1],"luckysheetTableContent",m)}else L+"_"+E in R&&(se=R[L+"_"+E].v),Zh(L,E,V,q,G,X,se,m,I,P,o,a,R,O,y,k,n,e,F)}}for(let A=0;A<M.length;A++){let z=M[A],L=z.r,E=z.c,V=z.start_r,q=z.start_c,G=z.end_r-1,X=z.end_c-1,ee=z.firstcolumnlen,le=f.flowdata[L][E],se=null,ae=le.mc;se=Fs(ae.r,ae.c),L=ae.r,E=ae.c;let ue=f.flowdata[L][E];if(E==0?q=-e:q=f.visibledatacolumn[E-1]-e,L==0?V=-n-1:V=f.visibledatarow[L-1]-n-1,G=f.visibledatarow[L+ue.mc.rs-1]-n,X=f.visibledatacolumn[E+ue.mc.cs-1]-e,se==null||se.toString().length==0){tc(L,E,V,q,G,X,m,I,P,o,a,R,O,y,k,n,e,F,!0);let fe=be.borderfix(f.flowdata,L,E),ce=[q+o+fe[0],V+a+fe[1],X-q-3+fe[2],G-V-3-1+fe[3]];Kh(L,E,ce[0],ce[1],"luckysheetTableContent",m)}else L+"_"+E in R&&(se=R[L+"_"+E].v),Zh(L,E,V,q,G,X,se,m,I,P,o,a,R,O,y,k,n,e,F,!0)}for(let A=p;A<=v;A++){let z;A==0?z=-n-1:z=f.visibledatarow[A-1]-n-1;let L=f.visibledatarow[A]-n;for(let E=y;E<=k;E++){let V;E==0?V=-e:V=f.visibledatacolumn[E-1]-e;let q=f.visibledatacolumn[E]-e;!!f.luckysheetcurrentisPivotTable&&Oe.drawPivotTable?((E==0||E==5)&&A<=11&&(m.beginPath(),m.moveTo(q-2+F+o,z+a),m.lineTo(q-2+F+o,L-2+F+a),m.lineWidth=1,m.strokeStyle="#000000",m.closePath(),m.stroke()),(A==2||A==11)&&E<=5&&(m.beginPath(),m.moveTo(V-1+o,L-2+F+a),m.lineTo(q-2+F+o,L-2+F+a),m.lineWidth=1,m.strokeStyle="#000000",m.closePath(),m.stroke()),A==6&&E==3&&(m.save(),m.font="bold 30px Arial",m.fillStyle="#626675",m.textAlign="center",m.fillText(Q().pivotTable.title,V+(q-V)/2+4+o,z+(L-z)/2-1+a),m.restore())):f.luckysheetcurrentisPivotTable&&E<Oe.pivotTableBoundary[1]&&A<Oe.pivotTableBoundary[0]&&(m.beginPath(),m.moveTo(q-2+F+o,z+a),m.lineTo(q-2+F+o,L-2+F+a),m.lineWidth=1,m.strokeStyle="#000000",m.closePath(),m.stroke(),m.beginPath(),m.moveTo(V-1+o,L-2+F+a),m.lineTo(q-2+o,L-2+F+a),m.lineWidth=1,m.strokeStyle="#000000",m.closePath(),m.stroke())}}if(f.config.borderInfo!=null&&f.config.borderInfo.length>0){let A=function(q,G,X,ee,le,se,ae,ue,fe){let ce=q,K=ee-2+F+ae,U=X+ue-1,te=ee-2+F+ae,ge=le-2+F+ue;fe.save(),be.setLineDash(fe,ce,"v",K,U,te,ge),fe.strokeStyle=G,fe.stroke(),fe.closePath(),fe.restore()},z=function(q,G,X,ee,le,se,ae,ue,fe){let ce=q,K=se-2+F+ae,U=X+ue-1,te=se-2+F+ae,ge=le-2+F+ue;fe.save(),be.setLineDash(fe,ce,"v",K,U,te,ge),fe.strokeStyle=G,fe.stroke(),fe.closePath(),fe.restore()},L=function(q,G,X,ee,le,se,ae,ue,fe){let ce=q,K=ee-2+F+ae,U=le-2+F+ue,te=se-2+F+ae,ge=le-2+F+ue;fe.save(),be.setLineDash(fe,ce,"h",K,U,te,ge),fe.strokeStyle=G,fe.stroke(),fe.closePath(),fe.restore()},E=function(q,G,X,ee,le,se,ae,ue,fe){let ce=q,K=ee-2+F+ae,U=X-1+F+ue,te=se-2+F+ae,ge=X-1+F+ue;fe.save(),be.setLineDash(fe,ce,"h",K,U,te,ge),fe.strokeStyle=G,fe.stroke(),fe.closePath(),fe.restore()},V=Ls(p,v,y,k);for(let q in V){let G=q.substr(0,q.indexOf("_")),X=q.substr(q.indexOf("_")+1);if(T[G+"_"+X]){let ee=T[G+"_"+X].start_r,le=T[G+"_"+X].start_c,se=T[G+"_"+X].end_r,ae=T[G+"_"+X].end_c,ue=lc(O,G,X,y,k),fe=V[q].l;fe!=null&&(!ue.colIn||ue.stc==X)&&A(fe.style,fe.color,ee,le,se,ae,o,a,m);let ce=V[q].r;ce!=null&&(!ue.colIn||ue.colLast)&&z(ce.style,ce.color,ee,le,se,ae,o,a,m);let K=V[q].t;K!=null&&E(K.style,K.color,ee,le,se,ae,o,a,m);let U=V[q].b;U!=null&&L(U.style,U.color,ee,le,se,ae,o,a,m)}}}k==f.visibledatacolumn.length-1&&m.clearRect(C-e+o-1,a-1,f.ch_width-f.visibledatacolumn[k],w-n),m.restore(),f.measureTextCacheTimeOut=setTimeout(()=>{f.measureTextCache={},f.measureTextCellInfoCache={},f.cellOverflowMapCache={}},100)}function Fv(e,n,t,l,o){let a={},s=f.flowdata;for(let u=l;u<=o;u++){if(s[u]==null)continue;if(f.cellOverflowMapCache[u]!=null){a[u]=f.cellOverflowMapCache[u];continue}let h=!1;for(let d=0;d<s[u].length;d++){let m=s[u][d];if(!(f.config.colhidden!=null&&f.config.colhidden[d]!=null)&&m!=null&&(!me(m.v)||_l(m))&&m.mc==null&&m.tb=="1"){let p=be.checkstatus(s,u,d,"ht"),v=Cr(m,e,{r:u,c:d}),y=0;v!=null&&(y=v.textWidthAll);let k=d-1<0?0:f.visibledatacolumn[d-1],b=f.visibledatacolumn[d],w,x;if(b-k<y){if(p=="0"){let C=Vi(u,d,d-1,"forward",p,y),S=Vi(u,d,d+1,"backward",p,y);C.success?w=C.c:w=C.c+1,S.success?x=S.c:x=S.c-1}else if(p=="1"){let C=Vi(u,d,d+1,"backward",p,y);w=d,C.success?x=C.c:x=C.c-1}else if(p=="2"){let C=Vi(u,d,d-1,"forward",p,y);x=d,C.success?w=C.c:w=C.c+1}}else w=d,x=d;if((w<=t||x>=n)&&w<x){let C={r:u,stc:w,edc:x};a[u]==null&&(a[u]={}),a[u][d]=C,h=!0}}}h&&(f.cellOverflowMapCache[u]=a[u])}return a}function Vi(e,n,t,l,o,a){let s=f.flowdata;if(l=="forward"&&t<0)return{success:!1,r:e,c:t};if(l=="backward"&&t>s[e].length-1)return{success:!1,r:e,c:t};let u=s[e][t];if(u!=null&&(!me(u.v)||u.mc!=null))return{success:!1,r:e,c:t};let h=n-1<0?0:f.visibledatacolumn[n-1],d=f.visibledatacolumn[n],m=a-(d-h);o=="0"?(h-=m/2,d+=m/2):o=="1"?d+=m:o=="2"&&(h-=m);let p=t-1<0?0:f.visibledatacolumn[t-1],v=f.visibledatacolumn[t];if(l=="forward")return h<p?Vi(e,n,t-1,l,o,a):h<v?{success:!0,r:e,c:t}:{success:!1,r:e,c:t};if(l=="backward")return d>v?Vi(e,n,t+1,l,o,a):d>p?{success:!0,r:e,c:t}:{success:!1,r:e,c:t}}function lc(e,n,t,l,o){let a=!1,s=!1,u,h,d,m;for(let p in e){for(let v in e[p]){u=p,h=v;let y=e[p][v];if(d=y.stc,m=y.edc,u==n&&t>=d&&t<=m&&(a=!0,t==m||t==o)){s=!0;break}}if(s)break}return{colIn:a,colLast:s,rowIndex:u,colIndex:h,stc:d,edc:m}}function Qh(e,n,t){if(e==null)return;let l=e.values,o=t.pos_x,a=t.pos_y;if(l!=null){e.rotate!=0&&e.type!="verticalWrap"&&(n.save(),n.translate((o+e.textLeftAll)/f.zoomRatio,(a+e.textTopAll)/f.zoomRatio),n.rotate(-e.rotate*Math.PI/180),n.translate(-(e.textLeftAll+o)/f.zoomRatio,-(a+e.textTopAll)/f.zoomRatio));for(let s=0;s<l.length;s++){let u=l[s];u.inline===!0&&u.style!=null?(n.font=u.style.fontset,n.fillStyle=u.style.fc):n.font=u.style;let h=typeof u.content=="object"?u.content.m:u.content;if(n.fillText(h,(o+u.left)/f.zoomRatio,(a+u.top)/f.zoomRatio),u.cancelLine!=null){let d=u.cancelLine;n.beginPath(),n.moveTo(Math.floor((o+d.startX)/f.zoomRatio)+.5,Math.floor((a+d.startY)/f.zoomRatio)+.5),n.lineTo(Math.floor((o+d.endX)/f.zoomRatio)+.5,Math.floor((a+d.endY)/f.zoomRatio)+.5),n.lineWidth=Math.floor(d.fs/9),n.strokeStyle=n.fillStyle,n.stroke(),n.closePath()}if(u.underLine!=null){let d=u.underLine;for(let m=0;m<d.length;m++){let p=d[m];n.beginPath(),n.moveTo(Math.floor((o+p.startX)/f.zoomRatio)+.5,Math.floor((a+p.startY)/f.zoomRatio)),n.lineTo(Math.floor((o+p.endX)/f.zoomRatio)+.5,Math.floor((a+p.endY)/f.zoomRatio)+.5),n.lineWidth=Math.floor(p.fs/9),n.strokeStyle=n.fillStyle,n.stroke(),n.closePath()}}}e.rotate!=0&&e.type!="verticalWrap"&&n.restore()}}var Kh,tc,Zh,Jh,ka=Me(()=>{nn();mr();Ei();ec();ol();gr();Wt();Nr();sa();xi();Nt();dr();Kt();Bi();Et();ht();mn();Nl();Ke();kt();dl();Kh=function(e,n,t,l,o,a){if(f.flowdata[e]==null||f.flowdata[e][n]==null)return;let s=f.flowdata[e][n].spl;if(s!=null){if(typeof s=="string"&&(s=new Function("return "+s)()),N(s)=="object"){let u=s,h=u.offsetX,d=u.offsetY;h=h==null?0:h,d=d==null?0:d,Jl.render(u.shapeseq,u.shapes,t+h,l+d,u.pixelWidth,u.pixelHeight,o,a)}else if(N(s)=="array"&&N(s[0])=="object")for(let u=0;u<s.length;u++){let h=s[u],d=h.offsetX,m=h.offsetY;d=d==null?0:d,m=m==null?0:m,Jl.render(h.shapeseq,h.shapes,t+d,l+m,h.pixelWidth,h.pixelHeight,o,a)}}},tc=function(e,n,t,l,o,a,s,u,h,d,m,p,v,y,k,b,w,x,C){let S=el.checksAF(e,n,u),_=Se.checksCF(e,n,h),T=be.borderfix(f.flowdata,e,n),F=be.checkstatus(f.flowdata,e,n,"bg");S!=null&&S[1]!=null&&(F=S[1]),_!=null&&_.cellColor!=null&&(F=_.cellColor),f.flowdata[e][n]!=null&&f.flowdata[e][n].tc!=null&&(F=f.flowdata[e][n].tc),F==null?s.fillStyle="#FFFFFF":s.fillStyle=F;let R=[l+d+T[0]+1,t+m+T[1]+1,a-l+T[2]-(C?1:0)-1,o-t+T[3]-1];if(!Je.createHookFunction("cellRenderBefore",f.flowdata[e][n],{r:e,c:n,start_r:R[1],start_c:R[0],end_r:R[3]+R[1],end_c:R[2]+R[0]},ye.getSheetByIndex(),s))return;if(s.fillRect(R[0],R[1],R[2],R[3]),e+"_"+n in p){let P=p[e+"_"+n].v;s.fillStyle="#000000";let O=Yn();s.font=O;let M=l+4+d,A=fr.luckysheetrefreshfixed(),z=o+m-2;s.textBaseline="bottom",s.fillText(P==null?"":P,M,z)}if(f.flowdata[e][n]!=null&&f.flowdata[e][n].ps!=null){let P=8*f.zoomRatio,O=8*f.zoomRatio;s.beginPath(),s.moveTo(a+d-1-P,t+m),s.lineTo(a+d-1,t+m),s.lineTo(a+d-1,t+m+O),s.fillStyle="#FC6666",s.fill(),s.closePath()}let I=lc(v,e,n,y,k);I.colLast&&Jh(I.rowIndex,I.colIndex,I.stc,I.edc,s,b,w,d,m,u,h),(!I.colIn||I.colLast)&&!f.luckysheetcurrentisPivotTable&&f.showGridLines&&(s.beginPath(),s.moveTo(a+d-2+x,t+m),s.lineTo(a+d-2+x,o+m),s.lineWidth=1,s.strokeStyle=Tl.strokeStyle,s.stroke(),s.closePath()),!f.luckysheetcurrentisPivotTable&&f.showGridLines&&(s.beginPath(),s.moveTo(l+d-1,o+m-2+x),s.lineTo(a+d-1,o+m-2+x),s.lineWidth=1,s.strokeStyle=Tl.strokeStyle,s.stroke(),s.closePath()),Je.createHookFunction("cellRenderAfter",f.flowdata[e][n],{r:e,c:n,start_r:R[1],start_c:R[0],end_r:R[3]+R[1],end_c:R[2]+R[0]},ye.getSheetByIndex(),s)},Zh=function(e,n,t,l,o,a,s,u,h,d,m,p,v,y,k,b,w,x,C,S){let _=f.flowdata[e][n],T=a-l-2,F=o-t-2,R=2,I=2,P=be.checkstatus(f.flowdata,e,n,"ht"),O=be.checkstatus(f.flowdata,e,n,"vt"),M=el.checksAF(e,n,h),A=Se.checksCF(e,n,d),z=be.checkstatus(f.flowdata,e,n,"bg");M!=null&&M[1]!=null&&(z=M[1]),A!=null&&A.cellColor!=null&&(z=A.cellColor),z==null?u.fillStyle="#FFFFFF":u.fillStyle=z;let L=be.borderfix(f.flowdata,e,n),E=[l+m+L[0]+1,t+p+L[1]+1,a-l+L[2]-(S?1:0)-1,o-t+L[3]+1];if(!Je.createHookFunction("cellRenderBefore",f.flowdata[e][n],{r:e,c:n,start_r:E[1],start_c:E[0],end_r:E[3]+E[1],end_c:E[2]+E[0]},ye.getSheetByIndex(),u))return;u.fillRect(E[0],E[1],E[2],E[3]);let V=Ye.dataVerification;if(V!=null&&V[e+"_"+n]!=null&&!Ye.validateCellData(s,V[e+"_"+n])){let X=5*f.zoomRatio,ee=5*f.zoomRatio;u.beginPath(),u.moveTo(l+m,t+p),u.lineTo(l+m+X,t+p),u.lineTo(l+m,t+p+ee),u.fillStyle="#FC6666",u.fill(),u.closePath()}if(_.ps!=null){let X=8*f.zoomRatio,ee=8*f.zoomRatio;u.beginPath(),u.moveTo(a+m-X,t+p),u.lineTo(a+m,t+p),u.lineTo(a+m,t+p+ee),u.fillStyle="#FC6666",u.fill(),u.closePath()}if(_.qp==1&&B(_.v)){let X=6*f.zoomRatio,ee=6*f.zoomRatio;u.beginPath(),u.moveTo(l+m+X-1,t+p),u.lineTo(l+m-1,t+p),u.lineTo(l+m-1,t+p+ee),u.fillStyle="#487f1e",u.fill(),u.closePath()}let q=!0,G=lc(y,e,n,k,b);if(_.tb=="1"&&G.colIn)G.colLast?Jh(G.rowIndex,G.colIndex,G.stc,G.edc,u,w,x,m,p,h,d):q=!1;else if(V!=null&&V[e+"_"+n]!=null&&V[e+"_"+n].type=="checkbox"){let X=l+m,ee=t+p+1;u.save(),u.beginPath(),u.rect(X,ee,T,F),u.clip(),u.scale(f.zoomRatio,f.zoomRatio);let le=Er(s,u),se=le.width+14,ae=le.actualBoundingBoxDescent+le.actualBoundingBoxAscent,ue=X+R;P=="0"?ue=X+T/2-se/2:P=="2"&&(ue=X+T-R-se);let fe=F>ae?F:ae,ce=ee+fe-I;u.textBaseline="bottom";let K=ce-13*f.zoomRatio;O=="0"?(ce=ee+fe/2,u.textBaseline="middle",K=ce-6*f.zoomRatio):O=="1"&&(ce=ee+I,u.textBaseline="top",K=ce+1*f.zoomRatio),ue=ue/f.zoomRatio,ce=ce/f.zoomRatio,K=K/f.zoomRatio,u.lineWidth=1,u.strokeStyle="#000",u.strokeRect(ue,K,10,10),V[e+"_"+n].checked&&(u.beginPath(),u.lineTo(ue+1,K+6),u.lineTo(ue+4,K+9),u.lineTo(ue+9,K+2),u.stroke(),u.closePath()),u.fillStyle=be.checkstatus(f.flowdata,e,n,"fc"),u.fillText(s==null?"":s,ue+14,ce),u.restore()}else{if(A!=null&&A.dataBar!=null&&A.dataBar.valueLen&&A.dataBar.valueLen.toString()!=="NaN"){let se=l+m+R,ae=t+p+I,ue=T-R*2,fe=F-I*2,ce=A.dataBar.valueType,K=A.dataBar.valueLen,U=A.dataBar.format;if(ce=="minus"){let te=A.dataBar.minusLen;if(U.length>1){let ge=u.createLinearGradient(se+ue*te*(1-K),ae,se+ue*te,ae);ge.addColorStop(0,"#ffffff"),ge.addColorStop(1,"#ff0000"),u.fillStyle=ge}else u.fillStyle="#ff0000";u.fillRect(se+ue*te*(1-K),ae,ue*te*K,fe),u.beginPath(),u.moveTo(se+ue*te*(1-K),ae),u.lineTo(se+ue*te*(1-K),ae+fe),u.lineTo(se+ue*te,ae+fe),u.lineTo(se+ue*te,ae),u.lineTo(se+ue*te*(1-K),ae),u.lineWidth=1,u.strokeStyle="#ff0000",u.stroke(),u.closePath()}else if(ce=="plus"){let te=A.dataBar.plusLen;if(te==1){if(U.length>1){let ge=u.createLinearGradient(se,ae,se+ue*K,ae);ge.addColorStop(0,U[0]),ge.addColorStop(1,U[1]),u.fillStyle=ge}else u.fillStyle=U[0];u.fillRect(se,ae,ue*K,fe),u.beginPath(),u.moveTo(se,ae),u.lineTo(se,ae+fe),u.lineTo(se+ue*K,ae+fe),u.lineTo(se+ue*K,ae),u.lineTo(se,ae),u.lineWidth=1,u.strokeStyle=U[0],u.stroke(),u.closePath()}else{let ge=A.dataBar.minusLen;if(U.length>1){let ie=u.createLinearGradient(se+ue*ge,ae,se+ue*ge+ue*te*K,ae);ie.addColorStop(0,U[0]),ie.addColorStop(1,U[1]),u.fillStyle=ie}else u.fillStyle=U[0];u.fillRect(se+ue*ge,ae,ue*te*K,fe),u.beginPath(),u.moveTo(se+ue*ge,ae),u.lineTo(se+ue*ge,ae+fe),u.lineTo(se+ue*ge+ue*te*K,ae+fe),u.lineTo(se+ue*ge+ue*te*K,ae),u.lineTo(se+ue*ge,ae),u.lineWidth=1,u.strokeStyle=U[0],u.stroke(),u.closePath()}}}let X=l+m,ee=t+p+1;u.save(),u.beginPath(),u.rect(X,ee,T,F),u.clip(),u.scale(f.zoomRatio,f.zoomRatio);let le=Cr(_,u,{cellWidth:T,cellHeight:F,space_width:R,space_height:I,r:e,c:n});if(A!=null&&A.icons!=null&&le.type=="plain"){let se=A.icons.left,ae=A.icons.top,ue=le.values[0],fe=X+ue.left,ce=ee+ue.top-le.textHeightAll;O=="0"?ce=ee+F/2-le.textHeightAll/2:O=="1"?ce=ee:O=="2"&&(ce=ce-le.desc),ce=ce/f.zoomRatio,fe=fe/f.zoomRatio,u.drawImage(wi,se*42,ae*32,32,32,X/f.zoomRatio,ce,le.textHeightAll/f.zoomRatio,le.textHeightAll/f.zoomRatio),P!="0"&&P!="2"&&(fe=fe+le.textHeightAll/f.zoomRatio)}u.fillStyle=be.checkstatus(f.flowdata,e,n,"fc"),M!=null&&M[0]!=null&&(u.fillStyle=M[0]),A!=null&&A.textColor!=null&&(u.fillStyle=A.textColor),_.ct&&_.ct.fa&&_.ct.fa.indexOf("[Red]")>-1&&_.ct.t=="n"&&_.v<0&&(u.fillStyle="#ff0000"),Qh(le,u,{pos_x:X,pos_y:ee}),u.restore()}q&&!f.luckysheetcurrentisPivotTable&&f.showGridLines&&(u.beginPath(),u.moveTo(a+m-2+C,t+p),u.lineTo(a+m-2+C,o+p),u.lineWidth=1,u.strokeStyle=Tl.strokeStyle,u.stroke(),u.closePath()),!f.luckysheetcurrentisPivotTable&&f.showGridLines&&(u.beginPath(),u.moveTo(l+m-1,o+p-2+C),u.lineTo(a+m-1,o+p-2+C),u.lineWidth=1,u.strokeStyle=Tl.strokeStyle,u.stroke(),u.closePath()),Je.createHookFunction("cellRenderAfter",f.flowdata[e][n],{r:e,c:n,start_r:E[1],start_c:E[0],end_r:E[3]+E[1],end_c:E[2]+E[0]},ye.getSheetByIndex(),u)},Jh=function(e,n,t,l,o,a,s,u,h,d,m){let p;e==0?p=-a-1:p=f.visibledatarow[e-1]-a-1;let v=f.visibledatarow[e]-a,y;t==0?y=-s:y=f.visibledatacolumn[t-1]-s;let k=f.visibledatacolumn[l]-s,b=f.flowdata[e][n],w=k-y-2,x=v-p-2,C=2,S=2,_=y+u,T=p+h+1,F=oi(b);o.font=F,o.save(),o.beginPath(),o.rect(_,T,w,x),o.clip(),o.scale(f.zoomRatio,f.zoomRatio);let R=Cr(b,o,{cellWidth:w,cellHeight:x,space_width:C,space_height:S,r:e,c:n}),I=el.checksAF(e,n,d),P=Se.checksCF(e,n,m);o.fillStyle=be.checkstatus(f.flowdata,e,n,"fc"),I!=null&&I[0]!=null&&(o.fillStyle=I[0]),P!=null&&P.textColor!=null&&(o.fillStyle=P.textColor),Qh(R,o,{pos_x:_,pos_y:T}),o.restore()}});var Dv,Cl,qi=Me(()=>{ht();Kt();Yt();Zl();Ut();ll();Jt();Wt();Zt();Qt();dl();Hl();ol();Et();kt();Ke();Dv={item:{linkType:"external",linkAddress:"",linkTooltip:""},hyperlink:null,createDialog:function(){let e=this,n=Q(),t=n.insertLink,l=n.toolbar,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-insertLink-dialog").remove();let a="";f.luckysheetfile.forEach(k=>{a+=`<option value="${k.name}">${k.name}</option>`});let s=`<div class="box">
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkText">${t.linkText}\uFF1A</label>
                                <input type="text" id="luckysheet-insertLink-dialog-linkText"/>
                            </div>
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkType">${t.linkType}\uFF1A</label>
                                <select id="luckysheet-insertLink-dialog-linkType">
                                    <option value="external">${t.external}</option>
                                    <option value="internal">${t.internal}</option>
                                </select>
                            </div>
                            <div class="show-box show-box-external">
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkAddress">${t.linkAddress}\uFF1A</label>
                                    <input type="text" id="luckysheet-insertLink-dialog-linkAddress" placeholder="${t.placeholder1}" />
                                </div>
                            </div>
                            <div class="show-box show-box-internal">
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkSheet">${t.linkSheet}\uFF1A</label>
                                    <select id="luckysheet-insertLink-dialog-linkSheet">
                                        ${a}
                                    </select>
                                </div>
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkCell">${t.linkCell}\uFF1A</label>
                                    <input type="text" id="luckysheet-insertLink-dialog-linkCell" value="A1" placeholder="${t.placeholder2}" />
                                </div>
                            </div>
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkTooltip">${t.linkTooltip}\uFF1A</label>
                                <input type="text" id="luckysheet-insertLink-dialog-linkTooltip" placeholder="${t.placeholder3}" />
                            </div>
                        </div>`;$("body").append(_e(dt,{id:"luckysheet-insertLink-dialog",addclass:"luckysheet-insertLink-dialog",title:l.insertLink,content:s,botton:`<button id="luckysheet-insertLink-dialog-confirm" class="btn btn-primary">${o.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"}));let u=$("#luckysheet-insertLink-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),h=u.outerHeight(),d=u.outerWidth(),m=$(window).width(),p=$(window).height(),v=$(document).scrollLeft(),y=$(document).scrollTop();$("#luckysheet-insertLink-dialog").css({left:(m+v-d)/2,top:(p+y-h)/3}).show(),e.dataAllocation()},init:function(){let e=this,t=Q().insertLink;$(document).off("change.linkType").on("change.linkType","#luckysheet-insertLink-dialog-linkType",function(l){let o=this.value;$("#luckysheet-insertLink-dialog .show-box").hide(),$("#luckysheet-insertLink-dialog .show-box-"+o).show()}),$(document).off("click.confirm").on("click.confirm","#luckysheet-insertLink-dialog-confirm",function(l){let o=f.luckysheet_select_save[f.luckysheet_select_save.length-1],a=o.row_focus||o.row[0],s=o.column_focus||o.column[0],u=$("#luckysheet-insertLink-dialog-linkText").val(),h=$("#luckysheet-insertLink-dialog-linkType").val(),d=$("#luckysheet-insertLink-dialog-linkAddress").val(),m=$("#luckysheet-insertLink-dialog-linkSheet").val(),p=$("#luckysheet-insertLink-dialog-linkCell").val(),v=$("#luckysheet-insertLink-dialog-linkTooltip").val();if(h=="external"){if(/^http[s]?:\/\//.test(d)||(d="https://"+d),!/^http[s]?:\/\/([\w\-\.]+)+[\w-]*([\w\-\.\/\?%&=]+)?$/ig.test(d)){W.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo1);return}}else{if(!g.iscelldata(p)){W.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo2);return}d=m+"!"+p}(u==null||u.replace(/\s/g,"")=="")&&(u=d);let y={linkType:h,linkAddress:d,linkTooltip:v},k=$.extend(!0,{},e.hyperlink),b=$.extend(!0,{},e.hyperlink);b[a+"_"+s]=y;let w=xe.deepCopyFlowData(f.flowdata),x=w[a][s];x==null&&(x={}),x.fc="rgb(0, 0, 255)",x.un=1,x.v=x.m=u,w[a][s]=x,e.ref(k,b,f.currentSheetIndex,w,[{row:[a,a],column:[s,s]}]),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-insertLink-dialog").hide()})},dataAllocation:function(){let e=this,n=f.luckysheet_select_save[f.luckysheet_select_save.length-1],t=n.row_focus||n.row[0],l=n.column_focus||n.column[0],a=(e.hyperlink||{})[t+"_"+l]||{},s=Le(t,l,null,"m");$("#luckysheet-insertLink-dialog-linkText").val(s);let u=a.linkType||"external";$("#luckysheet-insertLink-dialog-linkType").val(u),$("#luckysheet-insertLink-dialog .show-box").hide(),$("#luckysheet-insertLink-dialog .show-box-"+u).show();let h=a.linkAddress||"";if(u=="external")$("#luckysheet-insertLink-dialog-linkAddress").val(h);else if(g.iscelldata(h)){let m=h.split("!")[0],p=h.split("!")[1];$("#luckysheet-insertLink-dialog-linkSheet").val(m),$("#luckysheet-insertLink-dialog-linkCell").val(p)}let d=a.linkTooltip||"";$("#luckysheet-insertLink-dialog-linkTooltip").val(d)},cellFocus:function(e,n){let t=this;if(t.hyperlink==null||t.hyperlink[e+"_"+n]==null)return;let l=t.hyperlink[e+"_"+n];if(l.linkType=="external")window.open(l.linkAddress);else{let o=g.getcellrange(l.linkAddress),a=o.sheetIndex,s=[{row:o.row,column:o.column}];a!=f.currentSheetIndex&&($("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),ye.changeSheet(a)),f.luckysheet_select_save=s,lt(!0);let u=o.row[0]-1==-1?0:f.visibledatarow[o.row[0]-1],h=o.column[0]-1==-1?0:f.visibledatacolumn[o.column[0]-1];$("#luckysheet-scrollbar-x").scrollLeft(h),$("#luckysheet-scrollbar-y").scrollTop(u)}},overshow:function(e){let n=this;if($("#luckysheet-hyperlink-overshow").remove(),$(e.target).closest("#luckysheet-cell-main").length==0)return;let t=ut(e.pageX,e.pageY),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").scrollTop(),a=t[0]+l,s=t[1]+o;if(Y.freezenverticaldata!=null&&t[0]<Y.freezenverticaldata[0]-Y.freezenverticaldata[2]||Y.freezenhorizontaldata!=null&&t[1]<Y.freezenhorizontaldata[0]-Y.freezenhorizontaldata[2])return;let u=$t(s)[2],h=_t(a)[2],d=be.mergeborer(f.flowdata,u,h);if(d&&(u=d.row[2],h=d.column[2]),n.hyperlink==null||n.hyperlink[u+"_"+h]==null)return;let m=n.hyperlink[u+"_"+h],p=m.linkTooltip;(p==null||p.replace(/\s/g,"")=="")&&(p=m.linkAddress);let v=f.visibledatarow[u],y=u-1==-1?0:f.visibledatarow[u-1],k=f.visibledatacolumn[h],b=h-1==-1?0:f.visibledatacolumn[h-1];d&&(v=d.row[1],y=d.row[0],k=d.column[1],b=d.column[0]);let w=`<div id="luckysheet-hyperlink-overshow" style="background:#fff;padding:5px 10px;border:1px solid #000;box-shadow:2px 2px #999;position:absolute;left:${b}px;top:${v+5}px;z-index:100;">
                        <div>${p}</div>
                        <div>\u5355\u51FB\u9F20\u6807\u53EF\u4EE5\u8FFD\u8E2A</div>
                    </div>`;$(w).appendTo($("#luckysheet-cell-main"))},ref:function(e,n,t,l,o){let a=this;if(f.clearjfundo){f.jfundo.length=0;let s={};s.type="updateHyperlink",s.sheetIndex=t,s.historyHyperlink=e,s.currentHyperlink=n,s.data=f.flowdata,s.curData=l,s.range=o,f.jfredo.push(s)}a.hyperlink=n,f.luckysheetfile[Z(t)].hyperlink=n,f.flowdata=l,xe.webWorkerFlowDataCache(f.flowdata),f.luckysheetfile[Z(t)].data=f.flowdata,ne.allowUpdate&&(ne.saveParam("all",t,n,{k:"hyperlink"}),ne.historyParam(f.flowdata,t,o[0])),setTimeout(function(){Be()},1)}},Cl=Dv});function rc(e,n,t){g.execFunctionExist=[];for(let l=0;l<e.length;l++)for(let o=e[l].row[0];o<=e[l].row[1];o++)for(let a=e[l].column[0];a<=e[l].column[1];a++)g.execFunctionExist.push({r:o,c:a,i:n});g.execFunctionExist.reverse(),g.execFunctionGroup(null,null,null,null,t),g.execFunctionGlobalData=null}function Ze(e,n,t,l=!0,o=!0){e==null&&(e=f.flowdata),n==null&&(n=f.luckysheet_select_save),n=JSON.parse(JSON.stringify(n)),clearTimeout(Rr),t==null&&(t={});let a=t.cfg,s=t.RowlChange,u=t.cdformat,h=t.dataVerification,d=t.dynamicArray,m=t.hyperlink,p=f.luckysheetfile[Z(f.currentSheetIndex)];if(f.clearjfundo){f.jfundo.length=0;let v;a==null?v=$.extend(!0,{},f.config):v=$.extend(!0,{},a);let y;u==null?y=$.extend(!0,[],p.luckysheet_conditionformat_save):y=u;let k;h==null?k=$.extend(!0,{},p.dataVerification):k=h;let b;d==null?b=$.extend(!0,[],p.dynamicArray):b=d,f.jfredo.push({type:"datachange",data:f.flowdata,curdata:e,sheetIndex:f.currentSheetIndex,config:$.extend(!0,{},f.config),curConfig:v,cdformat:$.extend(!0,[],p.luckysheet_conditionformat_save),curCdformat:y,RowlChange:s,dataVerification:$.extend(!0,[],p.dataVerification),curDataVerification:k,dynamicArray:$.extend(!0,[],p.dynamicArray),curDynamicArray:b,hyperlink:m&&$.extend(!0,{},p.hyperlink),curHyperlink:m,range:n,dataRange:[...p.luckysheet_select_save]})}f.flowdata=e,xe.webWorkerFlowDataCache(f.flowdata),p.data=f.flowdata,a!=null&&(f.config=a,p.config=f.config,ne.saveParam("all",f.currentSheetIndex,a,{k:"config"}),s!=null&&Ct(f.flowdata.length,f.flowdata[0].length)),u!=null&&u.length!==0&&(p.luckysheet_conditionformat_save=u,ne.saveParam("all",f.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})),h!=null&&Object.keys(h).length!==0&&(Ye.dataVerification=h,p.dataVerification=h,ne.saveParam("all",f.currentSheetIndex,h,{k:"dataVerification"})),d!=null&&(p.dynamicArray=d,ne.saveParam("all",f.currentSheetIndex,d,{k:"dynamicArray"})),m!=null&&(p.hyperlink=m,Cl.hyperlink=m,ne.saveParam("all",f.currentSheetIndex,m,{k:"hyperlink"}));for(let v=0;v<n.length;v++){let y=n[v].row[0],k=n[v].column[0];if(f.flowdata[y][k]!=null&&f.flowdata[y][k].spl!=null){window.luckysheetCurrentRow=y,window.luckysheetCurrentColumn=k,window.luckysheetCurrentFunction=f.flowdata[y][k].f;let b=$.trim(g.functionParserExe(f.flowdata[y][k].f)),w=new Function("return "+b)();f.flowdata[y][k].spl=w}ne.allowUpdate&&ne.historyParam(f.flowdata,f.currentSheetIndex,n[v]),typeof f.chartparam.jfrefreshchartall=="function"&&f.chartparam.jfrefreshchartall(f.flowdata,n[v].row[0],n[v].row[1],n[v].column[0],n[v].column[1])}l&&rc(n,f.currentSheetIndex,e),o&&(Rr=setTimeout(function(){Be()},1)),lt(),window.luckysheet_getcelldata_cache=null}function Kl(e,n,t,l,o,a,s,u,h=!0){let d={},m=!1;if(clearTimeout(Rr),a=="cellRowChange"){d.type="cellRowChange",d.config=$.extend(!0,{},f.config),d.curconfig=$.extend(!0,{},l),d.range=$.extend(!0,[],f.luckysheet_select_save),d.currange=o,d.ctrlType=a,d.ctrlValue=s;let p=l.rowlen;p==null&&(p={}),ne.saveParam("cg",f.currentSheetIndex,p,{k:"rowlen"})}else if(a=="resizeC"){d.type="resize",d.config=$.extend(!0,{},f.config),d.curconfig=$.extend(!0,{},l),d.range=$.extend(!0,[],f.luckysheet_select_save),d.currange=o,d.ctrlType=a,d.ctrlValue=s;let p=l.columnlen;p==null&&(p={}),ne.saveParam("cg",f.currentSheetIndex,p,{k:"columnlen"})}else if(a.indexOf("extend")>-1)d.type="extend",d.config=$.extend(!0,{},f.config),d.curconfig=$.extend(!0,{},l),d.range=$.extend(!0,[],f.luckysheet_select_save),d.currange=o,d.ctrlType=a,d.ctrlValue=s,ne.saveParam("arc",f.currentSheetIndex,{index:s.index,len:s.len,direction:s.direction,mc:l.merge},{rc:s.type});else if(a.indexOf("dele")>-1)d.type="dele",d.config=$.extend(!0,{},f.config),d.curconfig=$.extend(!0,{},l),d.range=$.extend(!0,[],f.luckysheet_select_save),d.currange=o,d.ctrlType=a,d.ctrlValue=s,ne.saveParam("drc",f.currentSheetIndex,{index:s.index,len:s.len,mc:l.merge,borderInfo:l.borderInfo},{rc:s.type});else{d.type="datachangeAll",d.range=$.extend(!0,[],f.luckysheet_select_save),d.currange=o,d.ctrlType=a,d.ctrlValue=s,m=!0;for(let p=0;p<o.length;p++)ne.historyParam(t,f.currentSheetIndex,o[p])}f.clearjfundo&&(f.jfundo.length=0,d.data=f.flowdata,d.curdata=t,d.sheetIndex=f.currentSheetIndex,d.cdformat=$.extend(!0,[],f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save),d.curCdformat=u,f.jfredo.push(d)),f.flowdata=t,xe.webWorkerFlowDataCache(t),f.luckysheetfile[Z(f.currentSheetIndex)].data=f.flowdata,l!=null&&(f.config=l,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("all",f.currentSheetIndex,l,{k:"config"})),u!=null&&(f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save=u,ne.saveParam("all",f.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})),f.luckysheet_select_save=$.extend(!0,[],o),f.luckysheet_select_save.length>0&&lt(),m&&rc(o,f.currentSheetIndex,t),Ct(n,e),h&&(Rr=setTimeout(function(){Be()},1)),ye.storeSheetParamALL(),window.luckysheet_getcelldata_cache=null}function zi(e,n,t){clearTimeout(Rr),f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"rangechange",data:f.flowdata,curdata:e,range:n,sheetIndex:f.currentSheetIndex,cdformat:$.extend(!0,[],f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save),curCdformat:t})),f.flowdata=e,xe.webWorkerFlowDataCache(f.flowdata),f.luckysheetfile[Z(f.currentSheetIndex)].data=f.flowdata,t!=null&&(f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save=t),rc(n,f.currentSheetIndex,e),Rr=setTimeout(function(){Be()},1);for(let l=0;l<n.length;l++)ne.historyParam(f.flowdata,f.currentSheetIndex,n[l])}function Hn(e,n,t,l,o,a,s,u,h,d,m){let p=f.luckysheetfile[Z(f.currentSheetIndex)];qn();let v=[];for(let x in n.merge){let C=n.merge[x];for(let S=C.r;S<=C.r+C.rs-1;S++)for(let _=C.c;_<=C.c+C.cs-1;_++)e[S][_]==null&&(e[S][_]={}),S==C.r&&_==C.c?e[S][_].mc=C:e[S][_].mc={r:C.r,c:C.c},v.push({r:S,c:_})}let y=[];f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:t,sheetIndex:f.currentSheetIndex,data:f.flowdata,curData:e,config:$.extend(!0,{},f.config),curConfig:n,ctrlValue:l,mcData:v,calc:$.extend(!0,[],p.calcChain),curCalc:o,funcData:y,filterObj:{filter_select:$.extend(!0,{},p.filter_select),filter:$.extend(!0,{},p.filter)},curFilterObj:a,cf:$.extend(!0,[],p.luckysheet_conditionformat_save),curCf:s,af:$.extend(!0,[],p.luckysheet_alternateformat_save),curAf:u,freezen:{freezenhorizontaldata:Y.freezenhorizontaldata,freezenverticaldata:Y.freezenverticaldata},curFreezen:h,dataVerification:$.extend(!0,{},p.dataVerification),curDataVerification:d,hyperlink:$.extend(!0,{},p.hyperlink),curHyperlink:m,range:p.luckysheet_select_save,dataRange:[...p.luckysheet_select_save]}));let k=l.index,b=l.len,w=l.rc;if(t=="addRC"){let x=l.direction,C=l.restore,S=[];if(C){if(w=="r"){let _;x=="lefttop"?_=k:x=="rightbottom"&&(_=k+1);let T=_+b-1;for(let F=_;F<=T;F++){let R=[];for(let I=0;I<e[0].length;I++){let P=e[F][I];R.push(P)}S.push(R)}}else if(w=="c"){let _;x=="lefttop"?_=k:x=="rightbottom"&&(_=k+1);let T=_+b-1;for(let F=0;F<e.length;F++){let R=[];for(let I=_;I<=T;I++){let P=e[F][I];R.push(P)}S.push(R)}}}ne.saveParam("arc",f.currentSheetIndex,{index:k,len:b,direction:x,data:S},{rc:w})}else t=="delRC"&&ne.saveParam("drc",f.currentSheetIndex,{index:k,len:b},{rc:w});f.flowdata=e,xe.webWorkerFlowDataCache(f.flowdata),p.data=e,f.config=n,p.config=f.config,ne.saveParam("all",f.currentSheetIndex,n,{k:"config"});for(let x=0;x<v.length;x++){let C=v[x].r,S=v[x].c;ne.saveParam("v",f.currentSheetIndex,f.flowdata[C][S],{r:C,c:S})}if(o.length>0)for(let x=0;x<o.length;x++){let C=o[x],S=C.r,_=C.c,T=C.index,F=Ll(S,_,T,e),R=g.execfunction(F,S,_,T,null,!0);C.func=R,e[S][_].f==F&&Ht(S,_,e,R[1])}p.calcChain=o,ne.saveParam("all",f.currentSheetIndex,o,{k:"calcChain"});for(let x=0;x<y.length;x++){let C=y[x].r,S=y[x].c;ne.saveParam("v",f.currentSheetIndex,f.flowdata[C][S],{r:C,c:S})}a!=null?(p.filter_select=a.filter_select,p.filter=a.filter):(p.filter_select=null,p.filter=null),Dl(p.filter_select,p.filter),ne.saveParam("all",f.currentSheetIndex,p.filter_select,{k:"filter_select"}),ne.saveParam("all",f.currentSheetIndex,p.filter,{k:"filter"}),p.luckysheet_conditionformat_save=s,ne.saveParam("all",f.currentSheetIndex,p.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),p.luckysheet_alternateformat_save=u,ne.saveParam("all",f.currentSheetIndex,p.luckysheet_alternateformat_save,{k:"luckysheet_alternateformat_save"}),h!=null?(Y.freezenhorizontaldata=h.freezenhorizontaldata,Y.freezenverticaldata=h.freezenverticaldata):(Y.freezenhorizontaldata=null,Y.freezenverticaldata=null),Ye.dataVerification=d,p.dataVerification=d,ne.saveParam("all",f.currentSheetIndex,p.dataVerification,{k:"dataVerification"}),Cl.hyperlink=m,p.hyperlink=m,ne.saveParam("all",f.currentSheetIndex,p.hyperlink,{k:"hyperlink"}),Ct(f.flowdata.length,f.flowdata[0].length)}function Ro(e,n,t,l,o,a,s,u){let h=f.luckysheetfile[Z(f.currentSheetIndex)];clearTimeout(Rr),qn();let d=[];if(JSON.stringify(n.merge)=="{}")for(let p=0;p<e.length;p++)for(let v=0;v<e[0].length;v++){let y=e[p][v];y!=null&&y.mc!=null&&(delete y.mc,d.push({r:p,c:v}))}else for(let p in n.merge){let v=n.merge[p];for(let y=v.r;y<=v.r+v.rs-1;y++)for(let k=v.c;k<=v.c+v.cs-1;k++)if(e[y][k]==null&&(e[y][k]={}),y==v.r&&k==v.c)JSON.stringify(e[y][k].mc)!=JSON.stringify(v)&&(e[y][k].mc=v,d.push({r:y,c:k}));else{let b={r:v.r,c:v.c};JSON.stringify(e[y][k].mc)!=JSON.stringify(b)&&(e[y][k].mc=b,d.push({r:y,c:k}))}}let m=[];if(f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"deleteCell",sheetIndex:f.currentSheetIndex,ctrl:t,data:f.flowdata,curData:e,config:$.extend(!0,{},f.config),curConfig:n,mcData:d,calc:$.extend(!0,[],h.calcChain),curCalc:l,funcData:m,filterObj:{filter_select:$.extend(!0,{},h.filter_select),filter:$.extend(!0,{},h.filter)},curFilterObj:o,cf:$.extend(!0,[],h.luckysheet_conditionformat_save),curCf:a,dataVerification:$.extend(!0,{},h.dataVerification),curDataVerification:s,hyperlink:$.extend(!0,{},h.hyperlink),curHyperlink:u,range:h.luckysheet_select_save,dataRange:[...h.luckysheet_select_save]})),f.flowdata=e,xe.webWorkerFlowDataCache(f.flowdata),h.data=e,ne.allowUpdate){let p=t.type,v=t.str,y=t.edr,k=t.stc,b=t.edc,w;p=="moveUp"?w={row:[v,e.length-1],column:[k,b]}:p=="moveLeft"&&(w={row:[v,y],column:[k,e[0].length-1]}),ne.historyParam(f.flowdata,f.currentSheetIndex,w)}f.config=n,h.config=f.config,ne.saveParam("all",f.currentSheetIndex,n,{k:"config"});for(let p=0;p<d.length;p++){let v=d[p].r,y=d[p].c;ne.saveParam("v",f.currentSheetIndex,f.flowdata[v][y],{r:v,c:y})}if(l.length>0)for(let p=0;p<l.length;p++){let v=l[p],y=v.r,k=v.c,b=v.index,w=Ll(y,k,b,e),x=g.execfunction(w,y,k,b,null,!0);v.func=x,e[y][k].f==w&&Ht(y,k,e,x[1])}h.calcChain=l,ne.saveParam("all",f.currentSheetIndex,l,{k:"calcChain"});for(let p=0;p<m.length;p++){let v=m[p].r,y=m[p].c;ne.saveParam("v",f.currentSheetIndex,f.flowdata[v][y],{r:v,c:y})}o!=null?(h.filter_select=o.filter_select,h.filter=o.filter):(h.filter_select=null,h.filter=null),Dl(h.filter_select,h.filter),ne.saveParam("all",f.currentSheetIndex,h.filter_select,{k:"filter_select"}),ne.saveParam("all",f.currentSheetIndex,h.filter,{k:"filter"}),h.luckysheet_conditionformat_save=a,ne.saveParam("all",f.currentSheetIndex,h.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),Ye.dataVerification=s,h.dataVerification=s,ne.saveParam("all",f.currentSheetIndex,h.dataVerification,{k:"dataVerification"}),Cl.hyperlink=u,h.hyperlink=u,ne.saveParam("all",f.currentSheetIndex,h.hyperlink,{k:"hyperlink"}),Rr=setTimeout(function(){Be()},1)}function ji(e,n,t){let l={};g.execFunctionExist=[],clearTimeout(Rr);for(let u=e.range.row[0];u<=e.range.row[1];u++)for(let h=e.range.column[0];h<=e.range.column[1];h++)u+"_"+h+"_"+e.sheetIndex in l||(l[u+"_"+h+"_"+e.sheetIndex]=0,g.execFunctionExist.push({r:u,c:h,i:e.sheetIndex}));for(let u=n.range.row[0];u<=n.range.row[1];u++)for(let h=n.range.column[0];h<=n.range.column[1];h++)u+"_"+h+"_"+n.sheetIndex in l||(l[u+"_"+h+"_"+n.sheetIndex]=0,g.execFunctionExist.push({r:u,c:h,i:n.sheetIndex}));f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"pasteCut",source:e,target:n,RowlChange:t}));let o;if(f.currentSheetIndex==e.sheetIndex?(f.config=e.curConfig,o=e.curData.length,f.luckysheetfile[Z(n.sheetIndex)].config=n.curConfig):f.currentSheetIndex==n.sheetIndex&&(f.config=n.curConfig,o=n.curData.length,f.luckysheetfile[Z(e.sheetIndex)].config=e.curConfig),t){f.visibledatarow=[],f.rh_height=0;for(let u=0;u<o;u++){let h=f.defaultrowlen;if(f.config.rowlen!=null&&f.config.rowlen[u]!=null&&(h=f.config.rowlen[u]),f.config.rowhidden!=null&&f.config.rowhidden[u]!=null){h=f.config.rowhidden[u],f.visibledatarow.push(f.rh_height);continue}else f.rh_height+=h+1;f.visibledatarow.push(f.rh_height)}if(f.rh_height+=80,f.currentSheetIndex==e.sheetIndex){let u=fa(n.curData.length,n.curConfig);f.luckysheetfile[Z(n.sheetIndex)].visibledatarow=u}else if(f.currentSheetIndex==n.sheetIndex){let u=fa(e.curData.length,e.curConfig);f.luckysheetfile[Z(e.sheetIndex)].visibledatarow=u}}f.currentSheetIndex==e.sheetIndex?(f.flowdata=e.curData,f.luckysheetfile[Z(n.sheetIndex)].data=n.curData):f.currentSheetIndex==n.sheetIndex&&(f.flowdata=n.curData,f.luckysheetfile[Z(e.sheetIndex)].data=e.curData),xe.webWorkerFlowDataCache(f.flowdata),f.luckysheetfile[Z(f.currentSheetIndex)].data=f.flowdata,f.currentSheetIndex==n.sheetIndex?f.luckysheet_select_save=[{row:n.range.row,column:n.range.column}]:f.luckysheet_select_save=[{row:e.range.row,column:e.range.column}],f.luckysheet_select_save.length>0&&lt(),f.luckysheetfile[Z(e.sheetIndex)].luckysheet_conditionformat_save=e.curCdformat,f.luckysheetfile[Z(n.sheetIndex)].luckysheet_conditionformat_save=n.curCdformat,f.currentSheetIndex==e.sheetIndex?Ye.dataVerification=e.curDataVerification:f.currentSheetIndex==n.sheetIndex&&(Ye.dataVerification=n.curDataVerification),f.luckysheetfile[Z(e.sheetIndex)].dataVerification=e.curDataVerification,f.luckysheetfile[Z(n.sheetIndex)].dataVerification=n.curDataVerification,g.execFunctionExist.reverse(),g.execFunctionGroup(null,null,null,null,n.curData),g.execFunctionGlobalData=null;let a=Z(f.currentSheetIndex),s=f.luckysheetfile[a];s.scrollTop=$("#luckysheet-cell-main").scrollTop(),s.scrollLeft=$("#luckysheet-cell-main").scrollLeft(),ye.showSheet(),Rr=setTimeout(function(){Be()},1),ye.storeSheetParamALL(),ne.saveParam("all",e.sheetIndex,e.curConfig,{k:"config"}),ne.saveParam("all",n.sheetIndex,n.curConfig,{k:"config"}),ne.historyParam(e.curData,e.sheetIndex,{row:e.range.row,column:e.range.column}),ne.historyParam(n.curData,n.sheetIndex,{row:n.range.row,column:n.range.column}),ne.saveParam("all",e.sheetIndex,e.curCdformat,{k:"luckysheet_conditionformat_save"}),ne.saveParam("all",n.sheetIndex,n.curCdformat,{k:"luckysheet_conditionformat_save"}),ne.saveParam("all",e.sheetIndex,e.curDataVerification,{k:"dataVerification"}),ne.saveParam("all",n.sheetIndex,n.curDataVerification,{k:"dataVerification"})}function Ct(e,n,t=!0){gn(e,n),clearTimeout(Rr),ye.storeSheetParam();let l=f.luckysheetfile[Z(f.currentSheetIndex)].calcChain;if(l!=null&&l.length>0){f.config.rowlen==null&&(f.config.rowlen={}),f.config.columnlen==null&&(f.config.columnlen={});for(let o=0;o<l.length;o++){let a=l[o].r,s=l[o].c;if(l[o].index==f.currentSheetIndex&&f.flowdata[a][s]!=null&&f.flowdata[a][s].spl!=null&&(a in f.config.rowlen||s in f.config.columnlen)){window.luckysheetCurrentRow=a,window.luckysheetCurrentColumn=s,window.luckysheetCurrentFunction=f.flowdata[a][s].f;let h=$.trim(g.functionParserExe(f.flowdata[a][s].f)),d=new Function("return "+h)();f.flowdata[a][s].spl=d,ne.saveParam("v",f.currentSheetIndex,f.flowdata[a][s],{r:a,c:s})}}f.luckysheetfile[Z(f.currentSheetIndex)].data=f.flowdata}if(He.positionSync(),lt(),qn(),$(".luckysheet-selection-copy").is(":visible")&&Pt(),$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove(),Y.freezenhorizontaldata!=null&&Y.freezenverticaldata!=null){let o=Y.freezenhorizontaldata[1]-1,a=Y.freezenverticaldata[1]-1,s=Y.freezenhorizontaldata[2],u=Y.freezenverticaldata[2],h=f.visibledatarow[o]-2-s+f.columnHeaderHeight,d=[f.visibledatarow[o],o+1,s,Y.cutVolumn(f.visibledatarow,o+1),h],m=f.visibledatacolumn[a]-2-u+f.rowHeaderWidth,p=[f.visibledatacolumn[a],a+1,u,Y.cutVolumn(f.visibledatacolumn,a+1),m];Y.saveFreezen(d,h,p,m),Y.createFreezenHorizontal(d,h),Y.createFreezenVertical(p,m),Y.createAssistCanvas()}else if(Y.freezenhorizontaldata!=null){let o=Y.freezenhorizontaldata[1]-1,a=Y.freezenhorizontaldata[2],s=f.visibledatarow[o]-2-a+f.columnHeaderHeight,u=[f.visibledatarow[o],o+1,a,Y.cutVolumn(f.visibledatarow,o+1),s];Y.saveFreezen(u,s,null,null),Y.createFreezenHorizontal(u,s),Y.createAssistCanvas()}else if(Y.freezenverticaldata!=null){let o=Y.freezenverticaldata[1]-1,a=Y.freezenverticaldata[2],s=f.visibledatacolumn[o]-2-a+f.rowHeaderWidth,u=[f.visibledatacolumn[o],o+1,a,Y.cutVolumn(f.visibledatacolumn,o+1),s];Y.saveFreezen(null,null,u,s),Y.createFreezenVertical(u,s),Y.createAssistCanvas()}else $("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").length>0&&$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").each(function(o,a){let s=$(a).data("str"),u=$(a).data("cindex"),h=f.visibledatacolumn[u]-20,d=s-1==-1?0:f.visibledatarow[s-1];$(a).css({left:h,top:d})});if($("#luckysheet-filter-selected-sheet"+f.currentSheetIndex).length>0){let o=f.luckysheetfile[Z(f.currentSheetIndex)].filter_select,a=o.row[0],s=o.row[1],u=o.column[0],h=o.column[1],d=f.visibledatarow[s],m=a-1==-1?0:f.visibledatarow[a-1],p=f.visibledatacolumn[h],v=u-1==-1?0:f.visibledatacolumn[u-1];$("#luckysheet-filter-selected-sheet"+f.currentSheetIndex).css({left:v,width:p-v-1,top:m,height:d-m-1})}ye.showSheet(),t&&(Rr=setTimeout(function(){Be()},1))}function Be(e,n){if(g.groupValuesRefresh(),e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=$("#luckysheet-cell-main").scrollTop()),Y.freezenverticaldata!=null||Y.freezenhorizontaldata!=null){let t,l,o,a,s,u,h=f.luckysheetTableContentHW[0],d=f.luckysheetTableContentHW[1];Y.freezenverticaldata!=null&&Y.freezenhorizontaldata!=null?(t=Y.freezenhorizontaldata[0],l=Y.freezenhorizontaldata[1],o=Y.freezenhorizontaldata[2],a=Y.freezenverticaldata[0],s=Y.freezenverticaldata[1],u=Y.freezenverticaldata[2],nr(u,o,a,t,1,1,null,null,"freezen_3"),nr(e+a-u,o,h-a+u,t,1,1,null,null,"freezen_4"),nr(u,n+t-o,a,d-t+o,1,1,null,null,"freezen_7"),nr(e+a-u,n+t-o,h-a+u,d-t+o,a-u+f.rowHeaderWidth,t-o+f.columnHeaderHeight),gi(u,a,f.rowHeaderWidth),gi(e+a-u,h-a+u,a-u+f.rowHeaderWidth),mi(o,t,f.columnHeaderHeight),mi(n+t-o,d-t+o,t-o+f.columnHeaderHeight)):Y.freezenhorizontaldata!=null?(t=Y.freezenhorizontaldata[0],l=Y.freezenhorizontaldata[1],o=Y.freezenhorizontaldata[2],nr(e,o,h,t,1,1,null,null,"freezen_h"),nr(e,n+t-o,h,d-t+o,null,t-o+f.columnHeaderHeight),gi(e,h,null),mi(o,t,f.columnHeaderHeight),mi(n+t-o,d-t+o,t-o+f.columnHeaderHeight)):Y.freezenverticaldata!=null&&(a=Y.freezenverticaldata[0],s=Y.freezenverticaldata[1],u=Y.freezenverticaldata[2],nr(u,n,a,d,1,1,null,null,"freezen_v"),nr(e+a-u,n,h-a+u,d,a-u+f.rowHeaderWidth,null),mi(n,d,null),gi(u,a,f.rowHeaderWidth),gi(e+a-u,h-a+u,a-u+f.rowHeaderWidth))}else{if($("#luckysheetTableContent").length==0)return;let t=$("#luckysheetTableContent").get(0).getContext("2d");nr(e,n),gi(e),mi(n),t.clearRect(0,0,f.rowHeaderWidth*f.devicePixelRatio-1,f.columnHeaderHeight*f.devicePixelRatio-1)}}var Rr,Yt=Me(()=>{To();Ut();Jt();$r();Kt();dr();ka();Hl();Qt();dl();Wr();gr();qi();Zt();yn();Et();Ke();Rr=null});function ed(e,n,t){return new Promise((l,o)=>{let a=new XMLHttpRequest||new ActiveXObject("Microsoft.XMLHTTP");a.open(e,n),a.send(JSON.stringify(t)),a.onreadystatechange=function(){a.readyState==4&&(a.status==200?l(a.responseText):o("error"))}})}var td=Me(()=>{});var nc,Po,pi,ne,Qt=Me(()=>{nc=El(oh());Ss();Yt();Jt();Wt();dl();ol();yn();Hl();Wr();qr();gr();qi();ht();Et();Ke();Zt();kt();Po=El(pn());Li();xl();td();Nl();pi={gridKey:null,loadUrl:null,updateUrl:null,updateImageUrl:null,title:null,loadSheetUrl:null,retryTimer:null,allowUpdate:!1,historyParam:function(e,n,t){let l=this,o=t.row[0],a=t.row[1],s=t.column[0],u=t.column[1];if(o==a&&s==u){let h=e[o][s];l.saveParam("v",n,h,{r:o,c:s})}else{let h=a-o+1,d=u-s+1,m=Math.floor(1e3/d),p=Math.ceil(h/m);for(let v=0;v<p;v++){let y=o+m*v,k;v==p-1?k=a:k=o+m*(v+1)-1;let b=[];for(let w=y;w<=k;w++){let x=[];for(let C=s;C<=u;C++)e[w]==null?x.push(null):x.push(e[w][C]);b.push(x)}l.saveParam("rv",n,b,{range:{row:[y,k],column:[s,u]}}),v==p-1&&l.saveParam("rv_end",n,null)}}},saveParam:function(e,n,t,l){let o=this;if(!o.allowUpdate)return;t==null&&(t=null);let a={};if(a.t=e,a.i=n,a.v=t,e==="shs")return;e=="rv"?a.range=l.range:e=="v"||e=="fu"||e=="fm"?(a.r=l.r,a.c=l.c):e=="fc"?(a.op=l.op,a.pos=l.pos):e=="drc"||e=="arc"||e=="h"||e=="wh"?a.rc=l.rc:e=="c"?(a.cid=l.cid,a.op=l.op):e=="f"?(a.op=l.op,a.pos=l.pos):e=="s"||(e=="sh"?(a.op=l.op,l.cur!=null&&(a.cur=l.cur)):(e=="cg"||e=="all")&&(a.k=l.k));let s=de.imageUpdateMethodConfig;if(JSON.stringify(s)!=="{}")if(a.k!="images"){let u=nc.default.gzip(encodeURIComponent(JSON.stringify(a)),{to:"string"});o.websocket!=null&&o.websocket.send(u)}else ed(s.method,s.url,a).then(u=>{console.log(u)}).catch(u=>{console.log(u)});else{let u=nc.default.gzip(encodeURIComponent(JSON.stringify(a)),{to:"string"});o.websocket!=null&&o.websocket.send(u)}},websocket:null,wxErrorCount:0,openWebSocket:function(){let e=this;if("WebSocket"in window){let n=e.updateUrl+"?t=111&g="+encodeURIComponent(e.gridKey);e.updateUrl.indexOf("?")>-1&&(n=e.updateUrl+"&t=111&g="+encodeURIComponent(e.gridKey)),e.websocket=new WebSocket(n),e.websocket.onopen=function(){console.info(Q().websocket.success),wo(),e.wxErrorCount=0,e.retryTimer=setInterval(function(){e.websocket.send("rub")},6e4)},e.websocket.onmessage=function(t){f.result=t;let l=new Function("return "+t.data)();Je.createHookFunction("cooperativeMessage",l),console.info(l);let o=l.type,{message:a,id:s}=l;if(a==="\u7528\u6237\u9000\u51FA"&&($("#luckysheet-multipleRange-show-"+s).hide(),f.cooperativeEdit.changeCollaborationSize=f.cooperativeEdit.changeCollaborationSize.filter(u=>u.id!=s),f.cooperativeEdit.checkoutData=f.cooperativeEdit.checkoutData.filter(u=>u.id!=s)),o==1){let u=l.data.v.index,h=f.luckysheetfile.filter(d=>d.index===u)[0];h!==null&&setTimeout(()=>{let d=l.data.i;h.index=d,f.currentSheetIndex=d,$(`#luckysheet-sheets-item${u}`).attr("data-index",d),$(`#luckysheet-sheets-item${u}`).prop("id",`luckysheet-sheets-item${d}`),$(`#luckysheet-datavisual-selection-set-${u}`).prop("id",`luckysheet-datavisual-selection-set-${d}`)},1)}else if(o==2){let u=JSON.parse(l.data);e.wsUpdateMsg(u);let h=JSON.parse(l.data);h.k=="columnlen"?qn(h.v,null):h.k=="rowlen"&&qn(null,h.v)}else if(o==3){let u=l.id,h=l.username,d=JSON.parse(l.data),m=d.t,p=d.i,v=d.v;f.cooperativeEdit.changeCollaborationSize.length===0&&f.cooperativeEdit.changeCollaborationSize.push({id:u,v:d.v[0],i:p}),f.cooperativeEdit.changeCollaborationSize.some(x=>x.id==u)?f.cooperativeEdit.changeCollaborationSize.forEach(x=>{x.id==u&&(x.v=d.v[0]||d.range[0],x.i=p)}):f.cooperativeEdit.changeCollaborationSize.push({id:u,v:d.v[0],i:p}),N(v)!="array"&&N(v)!=="object"&&(v=JSON.parse(v));let k=0,b=0;if(p==f.currentSheetIndex?N(v)==="object"&&v.op==="enterEdit"?(k=v.range[v.range.length-1].row[0],b=v.range[v.range.length-1].column[0],e.multipleRangeShow(u,h,k,b,v.op)):(k=v[v.length-1].row[0],b=v[v.length-1].column[0],e.multipleRangeShow(u,h,k,b)):N(v)==="object"&&v.op==="enterEdit"?(k=v.range[v.range.length-1].row[0],b=v.range[v.range.length-1].column[0]):(k=v[v.length-1].row[0],b=v[v.length-1].column[0]),f.cooperativeEdit.checkoutData.length===0&&(v.op?f.cooperativeEdit.checkoutData.push({id:u,username:h,r:k,c:b,op:v.op,index:p}):f.cooperativeEdit.checkoutData.push({id:u,username:h,r:k,c:b,index:p})),f.cooperativeEdit.checkoutData.some(x=>x.id==u)?f.cooperativeEdit.checkoutData.forEach(x=>{x.id==u&&(x.username=h,x.r=k,x.c=b,x.index=p,v.op==="enterEdit"&&(x.op=v.op))}):v.op==="enterEdit"?f.cooperativeEdit.checkoutData.push({id:u,username:h,r:k,c:b,op:v.op,index:p}):f.cooperativeEdit.checkoutData.push({id:u,username:h,r:k,c:b,index:p}),f.cooperativeEdit.checkoutData.forEach(x=>{x.index!=f.currentSheetIndex&&($("#luckysheet-multipleRange-show-"+x.id).hide(),x.op=="")}),$("#luckysheet-multipleRange-show-"+u)[0]){let x=$("#luckysheet-multipleRange-show-"+u)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+u+">.username").css({bottom:x+"px"})}}else if(o==4){let u=l.data===""?l.data:JSON.parse(l.data);for(let h=0;h<u.length;h++)e.wsUpdateMsg(item[h])}else o==5?Ai(l.data):o==6&&wo()},e.websocket.onerror=function(){e.wxErrorCount++,e.wxErrorCount>3?Ai(Q().websocket.refresh):(Ai(Q().websocket.wait),e.openWebSocket())},e.websocket.onclose=function(t){console.info(Q().websocket.close),t.code===1e3?(clearInterval(e.retryTimer),e.retryTimer=null):alert(Q().websocket.contact)}}else alert(Q().websocket.support)},wsUpdateMsg:function(e){let n=e.t,t=e.i,l=e.v,o=f.luckysheetfile[Z(t)];if(!(["v","rv","cg","all","fc","drc","arc","f","fsc","fsr","sh","c"].includes(n)&&o==null))if(n=="v"){if(o.data==null||o.data.length==0)return;let a=e.r,s=e.c;o.data[a][s]=l,t==f.currentSheetIndex&&(f.flowdata=o.data,xe.webWorkerFlowDataCache(f.flowdata),l!=null&&l.ps!=null?He.buildPs(a,s,l.ps):He.buildPs(a,s,null),setTimeout(function(){Be()},1))}else if(n=="rv"){if(Object.keys(e.range).length>0&&(f.cooperativeEdit.merge_range=e.range,f.cooperativeEdit.merge_range.v=e.v,qn()),o.data==null||o.data.length==0)return;let a=e.range.row[0],s=e.range.row[1],u=e.range.column[0],h=e.range.column[1];for(let d=a;d<=s;d++)for(let m=u;m<=h;m++)o.data[d][m]=l[d-a][m-u];if(t==f.currentSheetIndex){f.flowdata=o.data,xe.webWorkerFlowDataCache(f.flowdata);for(let d=a;d<=s;d++)for(let m=u;m<=h;m++)l[d-a][m-u]!=null&&l[d-a][m-u].ps!=null?He.buildPs(d,m,l[d-a][m-u].ps):He.buildPs(d,m,null);setTimeout(function(){Be()},1)}}else if(n=="cg"){let a=e.k;a=="borderInfo"?o.config.borderInfo=l:(a in o.config||(o.config[a]={}),l&&typeof l=="object"&&(o.config[a]=l)),t==f.currentSheetIndex&&(f.config=o.config,(a=="rowlen"||a=="columnlen"||a=="rowhidden")&&Ct(f.flowdata.length,f.flowdata[0].length),setTimeout(function(){Be()},1))}else if(n=="all"){let a=e.k;if(o[a]=l,a=="name")$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+t).find("span.luckysheet-sheets-item-name").html(l);else if(a=="color"){let s=$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+t);s.find(".luckysheet-sheets-item-color").remove(),(l!=null||l!="")&&s.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+l+';"></div>')}else if(a!="pivotTable")if(a=="frozen"){if(Y.frozenTofreezen(),t==f.currentSheetIndex){let u=Q().freezen;o.freezen.horizontal==null?($("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> '+u.freezenRow),Y.freezenhorizontaldata=null,$("#luckysheet-freezebar-horizontal").hide()):Y.createFreezenHorizontal(o.freezen.horizontal.freezenhorizontaldata,o.freezen.horizontal.top),o.freezen.vertical==null?($("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+u.freezenColumn),Y.freezenverticaldata=null,$("#luckysheet-freezebar-vertical").hide()):Y.createFreezenVertical(o.freezen.vertical.freezenverticaldata,o.freezen.vertical.left),Y.createAssistCanvas()}}else a=="filter_select"?t==f.currentSheetIndex&&Dl(l):a=="filter"?t==f.currentSheetIndex&&Dl(o.filter_select,l):a=="luckysheet_conditionformat_save"?t==f.currentSheetIndex&&setTimeout(function(){Be()},1):a=="luckysheet_alternateformat_save"?t==f.currentSheetIndex&&setTimeout(function(){Be()},1):a=="config"?t==f.currentSheetIndex&&(f.config=l,Ct(f.flowdata.length,f.flowdata[0].length)):a=="dynamicArray"?t==f.currentSheetIndex&&setTimeout(function(){Be()},1):a=="images"?t==f.currentSheetIndex&&(Ie.images=l,Ie.allImagesShow(),Ie.init()):a=="dataVerification"?t==f.currentSheetIndex&&(Ye.dataVerification=l,Ye.init()):a=="hyperlink"&&t==f.currentSheetIndex&&(Cl.hyperlink=l,Cl.init())}else if(n=="fc"){let a=e.op,s=e.pos;N(l)!="object"&&(l=new Function("return "+l)());let u=l.r,h=l.c,d=o.calcChain==null?[]:o.calcChain;if(a=="add")d.push(l);else if(a=="del")for(let m=0;m<d.length;m++)u==d[m].r&&h==d[m].c&&t==d[m].index&&d.splice(m,1);setTimeout(function(){Be()},1)}else if(n=="drc"){if(o.data==null||o.data.length==0)return;let a=e.rc,s=l.index,u=l.len,h=l.mc,d=l.borderInfo,m=o.data;if(a=="r"){o.row-=u,m.splice(s,u);let p=[];for(let v=0;v<m[0].length;v++)p.push(null);for(let v=0;v<u;v++)m.push(p)}else{o.column-=u;let p=[];for(let v=0;v<u;v++)p.push(null);for(let v=0;v<m.length;v++)m[v].splice(s,u),m[v]=m[v].concat(p)}for(let p in h){let v=h[p].r,y=h[p].c;m[v][y].mc=h[p]}o.config.merge=h,o.config.borderInfo=d,t==f.currentSheetIndex&&(f.flowdata=m,xe.webWorkerFlowDataCache(f.flowdata),f.config.merge=h,f.config.borderInfo=d,setTimeout(function(){Be()},1))}else if(n=="arc"){if(o.data==null||o.data.length==0)return;let a=e.rc,s=l.index,u=l.len,h=l.data,d=l.direction,m=l.mc,p=l.borderInfo,v=$.extend(!0,[],o.data);if(a=="r"){o.row+=u;let y=[];for(let b=0;b<v[0].length;b++)y.push(null);let k=[];for(let b=0;b<u;b++)h[b]==null?k.push(JSON.stringify(y)):k.push(JSON.stringify(h[b]));d=="lefttop"?s==0?new Function("data","return data.unshift("+k.join(",")+")")(v):new Function("data","return data.splice("+s+", 0, "+k.join(",")+")")(v):new Function("data","return data.splice("+(s+1)+", 0, "+k.join(",")+")")(v)}else{o.column+=u;for(let y=0;y<v.length;y++)for(let k=0;k<u;k++)d=="lefttop"?v[y].splice(s,0,h[k]):v[y].splice(s+1,0,h[k])}for(let y in m){let k=m[y].r,b=m[y].c;v[k][b].mc=m[y]}o.data=v,o.config.merge=m,o.config.borderInfo=p,t==f.currentSheetIndex&&(f.flowdata=v,xe.webWorkerFlowDataCache(f.flowdata),f.config.merge=m,f.config.borderInfo=p,setTimeout(function(){Be()},1))}else if(n=="f"){let a=e.op,s=e.pos,u=o.filter;u==null&&(u={}),a=="upOrAdd"?u[s]=l:a=="del"&&delete u[s],t==f.currentSheetIndex&&Dl(o.filter_select,u)}else if(n=="fsc")o.filter=null,o.filter_select=null,t==f.currentSheetIndex&&($("#luckysheet-filter-selected-sheet"+f.currentSheetIndex+", #luckysheet-filter-options-sheet"+f.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide());else if(n=="fsr")o.filter=l.filter,o.filter_select=l.filter_select,t==f.currentSheetIndex&&Dl(o.filter_select,o.filter);else if(n=="sha"){f.luckysheetfile.push(l);let a="";l.color!=null&&(a='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+l.color+';"></div>'),$("#luckysheet-sheet-container-c").append(_e(Ql,{index:l.index,active:"",name:l.name,style:"",colorset:a})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+l.index+'" class="luckysheet-datavisual-selection-set"></div>'),ye.locationSheet()}else if(n=="shc"){let a=l.copyindex,s=l.name,u=Z(a),h=$.extend(!0,{},f.luckysheetfile[u]);h.index=t,h.name=s,f.luckysheetfile.splice(u+1,0,h);let d=$("#luckysheet-sheets-item"+a);$("#luckysheet-sheet-container-c").append(_e(Ql,{index:h.index,active:"",name:h.name,style:"",colorset:""})),$("#luckysheet-sheets-item"+h.index).insertAfter(d),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+h.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if(n=="shd"){for(let a=0;a<f.luckysheetfile.length;a++)if(f.luckysheetfile[a].index==l.deleIndex){if(f.currentSheetIndex===l.deleIndex){let s=l.deleIndex;f.luckysheetfile[ye.getSheetIndex(s)].hide=1;let u=$("#luckysheet-sheets-item"+s);u.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");let h=u.nextAll(":visible");u.nextAll(":visible").length>0?h=h.eq(0).data("index"):h=u.prevAll(":visible").eq(0).data("index"),$("#luckysheet-sheets-item"+h).addClass("luckysheet-sheets-item-active"),ye.changeSheetExec(h)}pi.sheetDeleSave.push(f.luckysheetfile[a]),f.luckysheetfile.splice(a,1);break}$("#luckysheet-sheets-item"+l.deleIndex).remove(),$("#luckysheet-datavisual-selection-set-"+l.deleIndex).remove(),ye.locationSheet()}else if(n=="shr")for(let a in l)f.luckysheetfile[Z(a)].order=l[a];else if(n=="shre"){for(let a=0;a<pi.sheetDeleSave.length;a++)if(pi.sheetDeleSave[a].index==l.reIndex){let s=pi.sheetDeleSave[a];f.luckysheetfile.push(s);let u="";l.color!=null&&(u='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+s.color+';"></div>'),$("#luckysheet-sheet-container-c").append(_e(Ql,{index:s.index,active:"",name:s.name,style:"",colorset:u})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+s.index+'" class="luckysheet-datavisual-selection-set"></div>');break}}else if(n=="sh"){let a=e.op,s=e.cur;a=="hide"?(o.hide=1,$("#luckysheet-sheets-item"+t).hide(),t==f.currentSheetIndex&&($("#luckysheet-sheets-item"+s).addClass("luckysheet-sheets-item-active"),ye.changeSheetExec(s))):a=="show"&&(o.hide=0,$("#luckysheet-sheets-item"+t).show()),ye.locationSheet()}else if(n=="c"){let a=e.op,s=e.cid;if(a=="add")o.chart.push(l),luckysheet.insertChartTosheet(l.sheetIndex,l.dataSheetIndex,l.option,l.chartType,l.selfOption,l.defaultOption,l.row,l.column,l.chart_selection_color,l.chart_id,l.chart_selection_id,l.chartStyle,l.rangeConfigCheck,l.rangeRowCheck,l.rangeColCheck,l.chartMarkConfig,l.chartTitleConfig,l.winWidth,l.winHeight,l.scrollLeft1,l.scrollTop1,l.chartTheme,l.myWidth,l.myHeight,l.myLeft,l.myTop,l.myindexrank1,!0);else if(a=="xy"||a=="wh"||a=="update")for(let u=0;u<o.chart.length;u++){let h=o.chart[u];if(h.chart_id==s){for(let d in h)for(let m in l)d==m&&(h[d]=l[m]);ye.saveChart(h);return}}else if(a=="del"){for(let u=0;u<o.chart.length;u++)if(o.chart[u].chart_id==s){o.chart.splice(u,1),$("#"+s).remove(),ye.delChart($("#"+s).attr("chart_id"),$("#"+s).attr("sheetIndex"));return}}}else n=="na"&&$("#luckysheet_info_detail_input").val(l).css("width",vi(l)*10)},multipleIndex:0,multipleRangeShow:function(e,n,t,l,o){let a=this,s=n,u=f.visibledatarow[t],h=t-1==-1?0:f.visibledatarow[t-1],d=f.visibledatacolumn[l],m=l-1==-1?0:f.visibledatacolumn[l-1],p=be.mergeborer(f.flowdata,t,l);if(p&&(u=p.row[1],h=p.row[0],d=p.column[1],m=p.column[0]),m<=0&&(m+=1),h<=0&&(h+=1),vi(n)>16&&(n=vi(n,16)+"..."),o==="enterEdit"&&(n+=" "+Q().edit.typing),$("#luckysheet-multipleRange-show-"+e).length>0)$("#luckysheet-multipleRange-show-"+e).css({position:"absolute",left:m-1,width:d-m-1,top:h-1,height:u-h-1}),$("#luckysheet-multipleRange-show-"+e+" .username").text(n),$("#luckysheet-multipleRange-show-"+e+" .username").show(),f.cooperativeEdit.usernameTimeout["user"+e]!=null&&clearTimeout(f.cooperativeEdit.usernameTimeout["user"+e]),f.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(()=>{clearTimeout(f.cooperativeEdit.usernameTimeout["user"+e]),f.cooperativeEdit.usernameTimeout["user"+e]=null},10*1e3);else{let v=`<div
								id="luckysheet-multipleRange-show-${e}"
								class="luckysheet-multipleRange-show"
								data-color="${Gl[a.multipleIndex]}"
								title="${s}"
								style="position: absolute;left: ${m-1}px;width: ${d-m-1}px;top: ${h-1}px;height: ${u-h-1}px;border: 1px solid ${Gl[a.multipleIndex]};z-index: 15;">

								<div class="username" style="height: 19px;line-height:19px;width: max-content;position: absolute;bottom: ${u-h-1}px;right: 0;background-color: ${Gl[a.multipleIndex]};color:#ffffff;padding:0 10px;">
								${n}
								</div>

								<div style="width: 100%;height: 100%;position: absolute;top: 0;right: 0;bottom: 0;left: 0;opacity: 0.03;background-color: ${Gl[a.multipleIndex]}">
								</div>

							</div>`;$(v).appendTo($("#luckysheet-cell-main #luckysheet-multipleRange-show")),a.multipleIndex++,f.cooperativeEdit.usernameTimeout["user"+e]!=null&&clearTimeout(f.cooperativeEdit.usernameTimeout["user"+e]),f.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(()=>{clearTimeout(f.cooperativeEdit.usernameTimeout["user"+e]),f.cooperativeEdit.usernameTimeout["user"+e]=null},10*1e3)}},sheetDeleSave:[],submitInterval:1e3,imagesubmitInterval:5e3,submitdatalimit:50,submitcompresslimit:1e3,checksubmit:function(e){let n=this;n.submitTimeout(),clearTimeout(n.imageRequestTimeout),n.imageRequestTimeout=setTimeout(function(){n.imageRequest()},n.imagesubmitInterval)},submitTimeout:function(){let e=this;clearTimeout(e.requestTimeOut),!e.requestLock&&e.requestlast!=null&&e.requestlast.clone().add(1,"seconds").isBefore((0,Po.default)())&&e.request(),e.requestTimeOut=setTimeout(function(){e.submitTimeout()},e.submitInterval)},requestLock:!1,requestlast:null,firstchange:!0,requestTimeOut:null,request:function(){let e=this,t=this.gridKey+"__qkcache";e.cachelocaldata(function(l,o){if(o.length==0)return;o=encodeURIComponent(JSON.stringify(o));let a=o.length,s=!1;e.requestLock=!0,e.updateUrl!=""&&$.post(e.updateUrl,{compress:s,gridKey:e.gridKey,data:o},function(u){new Function("return "+u)().status?($("#luckysheet_info_detail_update").html("\u6700\u8FD1\u5B58\u6863\u65F6\u95F4:"+(0,Po.default)().format("M-D H:m:s")),$("#luckysheet_info_detail_save").html("\u540C\u6B65\u6210\u529F"),e.clearcachelocaldata()):($("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>\u540C\u6B65\u5931\u8D25</span>"),e.restorecachelocaldata()),e.requestlast=(0,Po.default)(),e.requestLock=!1})})},imageRequestLast:null,imageRequestLock:!1,imageRequestTimeout:null,imageRequest:function(){let e=this;html2canvas($("#"+container).find(".luckysheet-grid-window").get(0),{onrendered:function(n){let t=$(n).appendTo("body");t.hide();let l=t.width(),o=t.height(),a=t.get(0).getContext("2d").getImageData(0,0,l,o),s=l,u=o;s*.54>u?s=u/.54:u=s*.54;let h=$("<canvas>").attr("width",s).attr("height",u)[0];h.getContext("2d").putImageData(a,0,0),t.attr("width",350),t.attr("height",189),t.get(0).getContext("2d").drawImage(h,0,0,350,189);let d=t.get(0).toDataURL("image/jpeg",.9),m=luckysheet.sheetmanage.getCurSheetnoset();e.imageRequestLock=!0;let p=encodeURIComponent(JSON.stringify({t:"thumb",img:d,curindex:m}));t.remove(),e.updateImageUrl!=""&&$.post(e.updateImageUrl,{compress:!1,gridKey:e.gridKey,data:p},function(v){new Function("return "+v)().status?imageRequestLast=(0,Po.default)():$("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>\u7F51\u7EDC\u4E0D\u7A33\u5B9A</span>"),e.imageRequestLock=!0})}})},localdata:[],matchOpt:function(e,n){for(let t in e){if(t=="t"&&e.t in{drc:1,arc:1,sha:1,shc:1,shd:1})return!1;if(t!="v"&&(!(t in n)||n[t]!=e[t]))return!1}return!0},deleteRepeatOpt:function(e,n){let t=e,l=this;if(n instanceof Array)for(let a=0;a<n.length;a++){let s=n[a];for(let u=0;u<t.length;u++){let h=e[a];l.matchOpt(s,h)&&delete t[u]}}else for(let a=0;a<t.length;a++){let s=t[a];l.matchOpt(n,s)&&delete t[a]}let o=[];for(let a=0;a<t.length;a++)t[a]!=null&&o.push(t[a]);return o},setlocaldata:function(e,n){let t=this.gridKey,l=this;l.getlocaldata(function(o){o==null&&(o=[]),e instanceof Array?o=o.concat(e):o.push(e),l.localdata=o,n(l.localdata)})},getlocaldata:function(e){let n=this.gridKey;e(this.localdata)},clearlocaldata:function(e){let n=this.gridKey;this.localdata=[],e()},cachelocaldata:function(e){let n=this.gridKey,t=this,l=n+"__qkcache",o=t.localdata,a=o.length;if(a>1){let s=[];s[0]=o[0];for(let u=1;u<a;u++){let h=o[u],d=!0;for(let m=0;m<s.length;m++){let p=s[m];if(t.matchOpt(h,p)){s.splice(m,1,h),d=!1;break}}d&&(s=s.concat(h))}o=s}o==null||o.length==0||t.clearlocaldata(function(){localforage.setItem(l,o).then(function(){e(l,o)})})},clearcachelocaldata:function(e){let t=this.gridKey+"__qkcache";localforage.removeItem(t,function(l,o){e&&typeof e=="function"&&e()})},restorecachelocaldata:function(e){let t=this.gridKey+"__qkcache",l=this;localforage.getItem(t).then(function(o){let a=o;l.getlocaldata(function(s){s==null&&(s=[]);let u=a.concat(s);l.localdata=u,e instanceof Function&&e(l.localdata)})})},keepHighLightBox:function(){f.cooperativeEdit.checkoutData.forEach(e=>{e.index==f.currentSheetIndex&&(e.op==="enterEdit"?pi.multipleRangeShow(e.id,e.username,e.r,e.c,e.op):pi.multipleRangeShow(e.id,e.username,e.r,e.c))})}},ne=pi});var Mv,W,ll=Me(()=>{Wt();xi();ht();kt();Qt();Mv={info:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-info").remove();let l=Q().button;$("body").append(_e(dt,{id:"luckysheet-info",addclass:"",title:e,content:n,botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+l.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));let o=$("#luckysheet-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-info").css({left:(u+d-s)/2,top:(h+m-a)/3}).show()},confirm:function(e,n,t,l,o,a){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove();let u=Q().button;o==null&&(o=u.confirm),a==null&&(a=u.cancel),$("body").append(_e(dt,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:n,botton:'<button class="btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+o+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+a+"&nbsp;&nbsp;</button>"}));let h=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),d=h.outerHeight(),m=h.outerWidth(),p=$(window).width(),v=$(window).height(),y=$(document).scrollLeft(),k=$(document).scrollTop();$("#luckysheet-confirm").css({left:(p+y-m)/2,top:(v+k-d)/3}).show(),h.find(".luckysheet-model-conform-btn").click(function(){typeof t=="function"&&t(),ne.keepHighLightBox(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),h.find(".luckysheet-model-cancel-btn").click(function(){typeof l=="function"&&l(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()})},screenshot:function(e,n,t){let o=Q().screenshot;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove(),$("body").append(_e(dt,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:n,botton:'<a style="text-decoration:none;color:#fff;" class="download btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+o.downLoadBtn+'&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class="btn btn-primary luckysheet-model-copy-btn">&nbsp;&nbsp;'+o.downLoadCopy+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+o.downLoadClose+"&nbsp;&nbsp;</button>"}));let a=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),s=a.outerHeight(),u=a.outerWidth(),h=$(window).width(),d=$(window).height(),m=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-confirm").css({left:(h+m-u)/2,top:(d+p-s)/3}).show(),a.find(".luckysheet-model-conform-btn").click(function(){fr.isIE()=="1"?alert(o.browserNotTip):(!!window.ActiveXObject||"ActiveXObject"in window)&&($("#IframeReportImg").length===0&&$('<iframe style="display:none;" id="IframeReportImg" name="IframeReportImg" onload="downloadImg();" width="0" height="0" src="about:blank"></iframe>').appendTo("body"),$("#IframeReportImg").attr("src")!=t?$("#IframeReportImg").attr("src",t):$("#IframeReportImg").src!="about:blank"&&window.frames.IframeReportImg.document.execCommand("SaveAs"))}),a.find(".luckysheet-model-cancel-btn").click(function(){$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#luckysheet-confirm .luckysheet-model-copy-btn").click(function(){let v=new clipboard.DT;v.setData("text/html","<img src='"+t+"'>"),fr.isIE()=="1"?alert(o.rightclickTip):(clipboard.write(v),alert(o.successTip))})},chartPointConfig:function(e,n,t){$("body").append(_e(dt,{id:e,addclass:"luckysheet-chart-point-config-c",title:"\u6570\u636E\u70B9\u6279\u91CF\u8BBE\u7F6E",content:du,botton:'<button class="btn btn-danger luckysheet-model-save-btn">&nbsp;&nbsp;\u4FDD\u5B58\u8BBE\u7F6E&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;\u53D6\u6D88&nbsp;&nbsp;</button>',style:"z-index:100003;height:80%;width:80%;top:10%;left:10%;"})),$("#luckysheet-modal-dialog-mask").show();let l=$(window).width(),o=$(window).height();$("#"+e).find(".luckysheet-chart-point-config").css("height",o-160),$("#"+e).css({height:o-90,width:l-100,left:7,top:14}).show().find(".luckysheet-model-save-btn").click(function(){typeof n=="function"&&n(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#"+e).find(".luckysheet-model-save-btn").click(function(){typeof t=="function"&&t(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()})},sheetConfig:function(){},hoverTipshowState:!1,hoverTipshowTimeOut:null,createHoverTip:function(e,n){let t=this;$(e).on("mouseover",n,function(l){t.hoverTipshowState||(clearTimeout(t.hoverTipshowTimeOut),t.hoverTipshowTimeOut=setTimeout(function(){let o=$(l.currentTarget),a=o.offset(),s=$("#luckysheet-tooltip-up"),u=o.data("tips");if((u==null||u.length==0)&&(u=o.prev().data("tips"),u==null||u.length==0))return;s.length==0&&($("body").append(mu),s=$("#luckysheet-tooltip-up")),s.removeClass("jfk-tooltip-hide").find("div.jfk-tooltip-contentId").html(u);let h=s.outerWidth();s.find("div.jfk-tooltip-arrow").css("left",h/2);let d=a.left+(o.outerWidth()-h)/2;d<2&&(d=2,s.find("div.jfk-tooltip-arrow").css("left",o.outerWidth()/2)),s.css({top:a.top+o.outerHeight()+1,left:d})},300))}).on("mouseout",n,function(l){t.hoverTipshowState=!1,clearTimeout(t.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")}).on("click",n,function(l){t.hoverTipshowState=!0,clearTimeout(t.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")})},popover:function(e,n,t,l,o,a){let s=Q(),u=s.button,h=s.paint;o==null&&(o=u.close);let d='<div id="luckysheetpopover" class="luckysheetpopover"><div class="luckysheetpopover-content">'+h.start+'</div><div class="luckysheetpopover-btn">'+o+"</div></div>";$("#luckysheetpopover").remove(),$("body").append(d),$("#luckysheetpopover .luckysheetpopover-content").html(e);let m=$("#luckysheetpopover").outerWidth(),p=$("#luckysheetpopover").outerHeight(),v={};n=="topLeft"?(v.top="20px",v.left="20px"):n=="topCenter"?(v.top="20px",v.left="50%",v["margin-left"]=-m/2):n=="topRight"?(v.top="20px",v.right="20px"):n=="midLeft"?(v.top="50%",v["margin-top"]=-p/2,v.left="20px"):n=="center"?(v.top="50%",v["margin-top"]=-p/2,v.left="50%",v["margin-left"]=-m/2):n=="midRight"?(v.top="50%",v["margin-top"]=-p/2,v.right="20px"):n=="bottomLeft"?(v.bottom="20px",v.left="20px"):n=="bottomCenter"?(v.bottom="20px",v.left="50%",v["margin-left"]=-m/2):n=="bottomRight"?(v.bottom="20px",v.right="20px"):(v.top="20px",v.left="50%",v["margin-left"]=-m/2),l=="white"&&(v.background="rgba(255, 255, 255, 0.65)",v.color="#000",$("#luckysheetpopover .luckysheetpopover-btn").css({border:"1px solid #000"})),setTimeout(function(){$("#luckysheetpopover .luckysheetpopover-content").css({"margin-left":-$("#luckysheetpopover .luckysheetpopover-btn").outerWidth()/2})},1),$("#luckysheetpopover").css(v).fadeIn(),$("#luckysheetpopover .luckysheetpopover-btn").click(function(){typeof a=="function"&&a()}),t!=null&&typeof t=="number"&&setTimeout(function(){$("#luckysheetpopover").fadeOut().remove(),typeof a=="function"&&a()},t)}},W=Mv});var ba,Av,Se,mr=Me(()=>{Et();ht();Ut();Nt();ll();Yt();Kt();Fl();Wt();Qt();Zt();dl();kt();Ml();Ke();ba=El(pn()),Av={fileClone:[],editorRule:null,ruleTypeHtml:function(){let e=Q().conditionformat;return`<div class="ruleTypeBox">
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem1}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem2}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem3}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem4}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem5}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem6}</span>
                    </div>
                </div>`},textCellColorHtml:function(){let e=Q().conditionformat;return`<div id="textCellColor">
                    <div class="colorbox">
                        <input id="checkTextColor" type="checkbox" checked="checked">
                        <label for="checkTextColor">${e.textColor}\uFF1A</label>
                        <input id="textcolorshow" data-tips="${e.textColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#9c0006" style="display: none;">
                    </div>
                    <div class="colorbox">
                        <input id="checkCellColor" type="checkbox" checked="checked">
                        <label for="checkCellColor">${e.cellColor}\uFF1A</label>
                        <input id="cellcolorshow" data-tips="${e.cellColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#ffc7ce" style="display: none;">
                    </div>
                </div>`},selectRange:[],selectStatus:!1,dataBarList:[{format:["#638ec6","#ffffff"]},{format:["#63c384","#ffffff"]},{format:["#ff555a","#ffffff"]},{format:["#ffb628","#ffffff"]},{format:["#008aef","#ffffff"]},{format:["#d6007b","#ffffff"]},{format:["#638ec6"]},{format:["#63c384"]},{format:["#ff555a"]},{format:["#ffb628"]},{format:["#008aef"]},{format:["#d6007b"]}],colorGradationList:[{format:["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(255, 235, 132)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(90, 138, 198)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(90, 138, 198)"]},{format:["rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)"]},{format:["rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(255, 235, 132)"]},{format:["rgb(255, 235, 132)","rgb(99, 190, 123)"]}],init:function(){let e=this,n=Q().conditionformat;$(document).off("change.CFchooseSheet").on("change.CFchooseSheet","#luckysheet-administerRule-dialog .chooseSheet",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();e.getConditionRuleList(t)}),$(document).off("click.CFadministerRuleItem").on("click.CFadministerRuleItem","#luckysheet-administerRule-dialog .ruleList .listBox .item",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.CFadministerRuleConfirm").on("click.CFadministerRuleConfirm","#luckysheet-administerRule-dialog-confirm",function(){if(!Sr(f.currentSheetIndex))return;let t=$.extend(!0,[],f.luckysheetfile),l=e.getHistoryRules(t),o=$.extend(!0,[],e.fileClone);for(let u=0;u<o.length;u++){let h=o[u].index;f.luckysheetfile[Z(h)].luckysheet_conditionformat_save=o[Z(h)].luckysheet_conditionformat_save}let a=$.extend(!0,[],f.luckysheetfile),s=e.getCurrentRules(a);if(e.ref(l,s),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),ne.allowUpdate){let u=$.extend(!0,[],f.luckysheetfile);for(let h=0;h<u.length;h++)ne.saveParam("all",u[h].index,u[h].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}}),$(document).off("click.CFadministerRuleClose").on("click.CFadministerRuleClose","#luckysheet-administerRule-dialog-close",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),e.fileClone=[]}),$(document).off("click.CFadministerRuleFa").on("click.CFadministerRuleFa","#luckysheet-administerRule-dialog .item .fa-table",function(){$(this).parents("#luckysheet-administerRule-dialog").hide();let t=$("#luckysheet-administerRule-dialog .chooseSheet select option:selected").val();t!=f.currentSheetIndex&&ye.changeSheetExec(t);let l=$(this).siblings("input").val().trim(),o=$(this).parents(".item").attr("data-item");e.multiRangeDialog(o,l),e.selectRange=[];let a=e.getRangeByTxt(l);if(a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],h=a[s].row[1],d=a[s].column[0],m=a[s].column[1],p=f.visibledatarow[h],v=u-1==-1?0:f.visibledatarow[u-1],y=f.visibledatacolumn[m],k=d-1==-1?0:f.visibledatacolumn[d-1];e.selectRange.push({left:k,width:y-k-1,top:v,height:p-v-1,left_move:k,width_move:y-k-1,top_move:v,height_move:p-v-1,row:[u,h],column:[d,m],row_focus:u,column_focus:d})}Pt(e.selectRange)}),$(document).off("click.CFmultiRangeConfirm").on("click.CFmultiRangeConfirm","#luckysheet-multiRange-dialog-confirm",function(){$(this).parents("#luckysheet-multiRange-dialog").hide();let t=$(this).attr("data-item"),l=$(this).parents("#luckysheet-multiRange-dialog").find("input").val();$("#luckysheet-administerRule-dialog .item[data-item="+t+"] input").val(l);let o=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();e.fileClone[Z(o)].luckysheet_conditionformat_save[t].cellrange=e.getRangeByTxt(l),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),Pt([])}),$(document).off("click.CFmultiRangeClose").on("click.CFmultiRangeClose","#luckysheet-multiRange-dialog-close",function(){$(this).parents("#luckysheet-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),Pt([])}),$(document).off("click.CFnewConditionRule").on("click.CFnewConditionRule","#newConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!!Sr(t)){if(f.luckysheet_select_save.length==0){he()?alert(n.pleaseSelectRange):W.info(n.pleaseSelectRange,"");return}e.newConditionRuleDialog(1)}}),$(document).off("click.CFnewConditionRuleConfirm").on("click.CFnewConditionRuleConfirm","#luckysheet-newConditionRule-dialog-confirm",function(){if(!Sr(f.currentSheetIndex))return;let t=$("#luckysheet-newConditionRule-dialog .ruleTypeItem.on").index(),l=$("#luckysheet-newConditionRule-dialog #type1 option:selected").val(),o=$("#luckysheet-newConditionRule-dialog ."+l+"Box #type2 option:selected").val(),a,s;if(t==0){if(l=="dataBar"){let h=$(this).parents("#luckysheet-newConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString();o=="gradient"?a=[h,"#ffffff"]:o=="solid"&&(a=[h]),s={type:"dataBar",cellrange:$.extend(!0,[],f.luckysheet_select_save),format:a}}else if(l=="colorGradation"){let h=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),d=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),m=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString();o=="threeColor"?a=[h,d,m]:o=="twoColor"&&(a=[h,m]),s={type:"colorGradation",cellrange:$.extend(!0,[],f.luckysheet_select_save),format:a}}else if(l=="icons"){let h=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-len"),d=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),m=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-top");a={len:h,leftMin:d,top:m},s={type:"icons",cellrange:$.extend(!0,[],f.luckysheet_select_save),format:a}}}else{let h="",d=[],m=[];if(t==1){if(l=="number")if(h=o,o=="betweenness"){let y=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),k=$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val().trim(),b=e.getRangeByTxt(y);if(b.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(b.length==1){let x=b[0].row[0],C=b[0].row[1],S=b[0].column[0],_=b[0].column[1];if(x==C&&S==_)y=Le(x,S,f.flowdata),d.push({row:b[0].row,column:b[0].column}),m.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(b.length==0)if(isNaN(y)||y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else m.push(y);let w=e.getRangeByTxt(k);if(w.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(w.length==1){let x=w[0].row[0],C=w[0].row[1],S=w[0].column[0],_=w[0].column[1];if(x==C&&S==_)k=Le(x,S,f.flowdata),d.push({row:w[0].row,column:w[0].column}),m.push(k);else{e.infoDialog(n.onlySingleCell,"");return}}else if(w.length==0)if(isNaN(k)||k==""){e.infoDialog(n.conditionValueCanOnly,"");return}else m.push(k)}else{let y=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),k=e.getRangeByTxt(y);if(k.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(k.length==1){let b=k[0].row[0],w=k[0].row[1],x=k[0].column[0],C=k[0].column[1];if(b==w&&x==C)y=Le(b,x,f.flowdata),d.push({row:k[0].row,column:k[0].column}),m.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(k.length==0)if(isNaN(y)||y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else m.push(y)}else if(l=="text"){h="textContains";let y=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),k=e.getRangeByTxt(y);if(k.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(k.length==1){let b=k[0].row[0],w=k[0].row[1],x=k[0].column[0],C=k[0].column[1];if(b==w&&x==C)y=Le(b,x,f.flowdata),d.push({row:k[0].row,column:k[0].column}),m.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(k.length==0)if(y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else m.push(y)}else if(l=="date"){h="occurrenceDate";let y=$("#luckysheet-newConditionRule-dialog #daterange-btn").val();if(y==""||y==null){e.infoDialog(n.pleaseSelectADate,"");return}m.push(y)}}else if(t==2){l=="top"?$("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?h="top10%":h="top10":l=="last"&&($("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?h="last10%":h="last10");let y=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim();if(parseInt(y)!=y||parseInt(y)<1||parseInt(y)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}m.push(parseInt(y))}else if(t==3)l=="AboveAverage"?(h="AboveAverage",m.push("AboveAverage")):l=="SubAverage"&&(h="SubAverage",m.push("SubAverage"));else if(t==4)h="duplicateValue",m.push(l);else if(t==5){h="formula";let y=$("#luckysheet-newConditionRule-dialog #formulaConditionVal input").val().trim();if(y==""){e.infoDialog("Condition value cannot be empty!","");return}m.push(y)}let p;$("#luckysheet-newConditionRule-dialog #checkTextColor").is(":checked")?p=$("#luckysheet-newConditionRule-dialog #textcolorshow").spectrum("get").toHexString():p=null;let v;$("#luckysheet-newConditionRule-dialog #checkCellColor").is(":checked")?v=$("#luckysheet-newConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():v=null,a={textColor:p,cellColor:v},s={type:"default",cellrange:$.extend(!0,[],f.luckysheet_select_save),format:a,conditionName:h,conditionRange:d,conditionValue:m}}$("#luckysheet-newConditionRule-dialog").hide();let u=$(this).attr("data-source");if(u==0){$("#luckysheet-modal-dialog-mask").hide();let h=$.extend(!0,[],f.luckysheetfile),d=e.getHistoryRules(h),m=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save==null?[]:f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save;m.push(s),f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save=m;let p=$.extend(!0,[],f.luckysheetfile),v=e.getCurrentRules(p);e.ref(d,v),ne.allowUpdate&&ne.saveParam("all",f.currentSheetIndex,m,{k:"luckysheet_conditionformat_save"})}else if(u==1){let h=e.fileClone[Z(f.currentSheetIndex)].luckysheet_conditionformat_save?e.fileClone[Z(f.currentSheetIndex)].luckysheet_conditionformat_save:[];h.push(s),e.fileClone[Z(f.currentSheetIndex)].luckysheet_conditionformat_save=h,e.administerRuleDialog()}}),$(document).off("click.CFnewConditionRuleClose").on("click.CFnewConditionRuleClose","#luckysheet-newConditionRule-dialog-close",function(){let t=$(this).attr("data-source");t==0&&$("#luckysheet-modal-dialog-mask").hide(),t==1&&$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-newConditionRule-dialog").hide(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFeditorConditionRule").on("click.CFeditorConditionRule","#editorConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!Sr(t))return;let l=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item"),o={sheetIndex:t,itemIndex:l,data:e.fileClone[Z(t)].luckysheet_conditionformat_save[l]};e.editorRule=o,e.editorConditionRuleDialog()}),$(document).off("click.CFeditorConditionRuleConfirm").on("click.CFeditorConditionRuleConfirm","#luckysheet-editorConditionRule-dialog-confirm",function(){let t=$("#luckysheet-editorConditionRule-dialog .ruleTypeItem.on").index(),l=$("#luckysheet-editorConditionRule-dialog #type1 option:selected").val(),o=$("#luckysheet-editorConditionRule-dialog ."+l+"Box #type2 option:selected").val(),a=e.editorRule.data.cellrange,s,u;if(t==0){if(l=="dataBar"){let m=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString();o=="gradient"?s=[m,"#ffffff"]:o=="solid"&&(s=[m]),u={type:"dataBar",cellrange:a,format:s}}else if(l=="colorGradation"){let m=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),p=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),v=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString();o=="threeColor"?s=[m,p,v]:o=="twoColor"&&(s=[m,v]),u={type:"colorGradation",cellrange:a,format:s}}else if(l=="icons"){let m=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-len"),p=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),v=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-top");s={len:m,leftMin:p,top:v},u={type:"icons",cellrange:a,format:s}}}else{let m="",p=[],v=[];if(t==1){if(l=="number")if(m=o,o=="betweenness"){let b=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),w=$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val().trim(),x=e.getRangeByTxt(b);if(x.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(x.length==1){let S=x[0].row[0],_=x[0].row[1],T=x[0].column[0],F=x[0].column[1];if(S==_&&T==F)b=Le(S,T,f.flowdata),p.push({row:x[0].row,column:x[0].column}),v.push(b);else{e.infoDialog(n.onlySingleCell,"");return}}else if(x.length==0)if(isNaN(b)||b==""){e.infoDialog(n.conditionValueCanOnly,"");return}else v.push(b);let C=e.getRangeByTxt(w);if(C.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(C.length==1){let S=C[0].row[0],_=C[0].row[1],T=C[0].column[0],F=C[0].column[1];if(S==_&&T==F)w=Le(S,T,f.flowdata),p.push({row:C[0].row,column:C[0].column}),v.push(w);else{e.infoDialog(n.onlySingleCell,"");return}}else if(C.length==0)if(isNaN(w)||w==""){e.infoDialog(n.conditionValueCanOnly,"");return}else v.push(w)}else{let b=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),w=e.getRangeByTxt(b);if(w.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(w.length==1){let x=w[0].row[0],C=w[0].row[1],S=w[0].column[0],_=w[0].column[1];if(x==C&&S==_)b=Le(x,S,f.flowdata),p.push({row:w[0].row,column:w[0].column}),v.push(b);else{e.infoDialog(n.onlySingleCell,"");return}}else if(w.length==0)if(isNaN(b)||b==""){e.infoDialog(n.conditionValueCanOnly,"");return}else v.push(b)}else if(l=="text"){m="textContains";let b=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),w=e.getRangeByTxt(b);if(w.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(w.length==1){let x=w[0].row[0],C=w[0].row[1],S=w[0].column[0],_=w[0].column[1];if(x==C&&S==_)b=Le(x,S,f.flowdata),p.push({row:w[0].row,column:w[0].column}),v.push(b);else{e.infoDialog(n.onlySingleCell,"");return}}else if(w.length==0)if(isNaN(b)||b==""){e.infoDialog(n.conditionValueCanOnly,"");return}else v.push(b)}else if(l=="date"){m="occurrenceDate";let b=$("#luckysheet-editorConditionRule-dialog #daterange-btn").val();if(b==""||b==null){e.infoDialog(n.pleaseSelectADate,"");return}v.push(b)}}else if(t==2){l=="top"?$("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?m="top10%":m="top10":l=="last"&&($("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?m="last10%":m="last10");let b=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim();if(parseInt(b)!=b||parseInt(b)<1||parseInt(b)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}v.push(b)}else if(t==3)l=="AboveAverage"?(m="AboveAverage",v.push("AboveAverage")):l=="SubAverage"&&(m="SubAverage",v.push("SubAverage"));else if(t==4)m="duplicateValue",v.push(l);else if(t==5){m="formula";let b=$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val().trim();if(console.log(b),b==""){e.infoDialog("Condition value cannot be empty!","");return}v.push(b)}let y;$("#luckysheet-editorConditionRule-dialog #checkTextColor").is(":checked")?y=$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("get").toHexString():y=null;let k;$("#luckysheet-editorConditionRule-dialog #checkCellColor").is(":checked")?k=$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():k=null,s={textColor:y,cellColor:k},u={type:"default",cellrange:a,format:s,conditionName:m,conditionRange:p,conditionValue:v}}let h=e.editorRule.sheetIndex,d=e.editorRule.itemIndex;e.fileClone[Z(h)].luckysheet_conditionformat_save[d]=u,$("#luckysheet-editorConditionRule-dialog").hide(),e.administerRuleDialog()}),$(document).off("click.CFeditorConditionRuleClose").on("click.CFeditorConditionRuleClose","#luckysheet-editorConditionRule-dialog-close",function(){$("#luckysheet-editorConditionRule-dialog").hide(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFnewEditorRuleItem").on("click.CFnewEditorRuleItem",".luckysheet-newEditorRule-dialog .ruleTypeItem",function(){$(this).addClass("on").siblings().removeClass("on");let t=$(this).index();$(this).parents(".luckysheet-newEditorRule-dialog").find(".ruleExplainBox").html(e.getRuleExplain(t)),e.colorSelectInit()}),$(document).off("change.CFnewEditorRuleType1").on("change.CFnewEditorRuleType1",".luckysheet-newEditorRule-dialog #type1",function(){let t=$(this).find("option:selected").val();(t=="dataBar"||t=="colorGradation"||t=="icons"||t=="number"||t=="text"||t=="date")&&$(this).parents(".luckysheet-newEditorRule-dialog").find("."+t+"Box").show().siblings().hide(),t=="date"&&e.daterangeInit($(this).parents(".luckysheet-newEditorRule-dialog").attr("id"))}),$(document).off("change.CFnewEditorRuleType2").on("change.CFnewEditorRuleType2",".luckysheet-newEditorRule-dialog #type2",function(){let t=$(this).parents(".luckysheet-newEditorRule-dialog").find("#type1 option:selected").val();t=="colorGradation"?$(this).find("option:selected").val()=="threeColor"?$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").show():$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").hide():t=="number"&&($(this).find("option:selected").val()=="betweenness"?($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").show(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").show()):($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").hide(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").hide()))}),$(document).off("click.CFiconsShowbox").on("click.CFiconsShowbox",".luckysheet-newEditorRule-dialog .iconsBox .showbox",function(){$(this).parents(".iconsBox").find("ul").toggle()}),$(document).off("click.CFiconsLi").on("click.CFiconsLi",".luckysheet-newEditorRule-dialog .iconsBox li",function(){let t=$(this).find("div").attr("data-len"),l=$(this).find("div").attr("data-leftmin"),o=$(this).find("div").attr("data-top"),a=$(this).find("div").attr("title"),s=$(this).find("div").css("background-position");$(this).parents(".iconsBox").find(".showbox .model").css("background-position",s),$(this).parents(".iconsBox").find(".showbox .model").attr("data-len",t),$(this).parents(".iconsBox").find(".showbox .model").attr("data-leftmin",l),$(this).parents(".iconsBox").find(".showbox .model").attr("data-top",o),$(this).parents(".iconsBox").find(".showbox .model").attr("title",a),$(this).parents("ul").hide()}),$(document).off("click.CFdeleteConditionRule").on("click.CFdeleteConditionRule","#deleteConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!Sr(t))return;let l=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item");e.fileClone[Z(t)].luckysheet_conditionformat_save.splice(l,1),e.administerRuleDialog()}),$(document).off("click.CFdefault").on("click.CFdefault","#luckysheet-conditionformat-dialog-confirm",function(){if(!Sr(f.currentSheetIndex))return;let t=$("#luckysheet-conditionformat-dialog .box").attr("data-itemvalue"),l=[],o=[];if(t=="greaterThan"||t=="lessThan"||t=="equal"||t=="textContains"){let y=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),k=e.getRangeByTxt(y);if(k.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(k.length==1){let b=k[0].row[0],w=k[0].row[1],x=k[0].column[0],C=k[0].column[1];if(b==w&&x==C)y=Le(b,x,f.flowdata),l.push({row:k[0].row,column:k[0].column}),o.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(k.length==0)if(isNaN(y)||y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(y)}else if(t=="betweenness"){let y=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),k=$("#luckysheet-conditionformat-dialog #conditionVal2").val().trim(),b=e.getRangeByTxt(y);if(b.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(b.length==1){let x=b[0].row[0],C=b[0].row[1],S=b[0].column[0],_=b[0].column[1];if(x==C&&S==_)y=Le(x,S,f.flowdata),l.push({row:b[0].row,column:b[0].column}),o.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(b.length==0)if(isNaN(y)||y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(y);let w=e.getRangeByTxt(k);if(w.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(w.length==1){let x=w[0].row[0],C=w[0].row[1],S=w[0].column[0],_=w[0].column[1];if(x==C&&S==_)k=Le(x,S,f.flowdata),l.push({row:w[0].row,column:w[0].column}),o.push(k);else{e.infoDialog(n.onlySingleCell,"");return}}else if(w.length==0)if(isNaN(k)||k==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(k)}else if(t=="occurrenceDate"){let y=$("#luckysheet-conditionformat-dialog #daterange-btn").val();if(y==""||y==null){e.infoDialog(n.pleaseSelectADate,"");return}o.push(y)}else if(t=="duplicateValue")o.push($("#luckysheet-conditionformat-dialog #conditionVal option:selected").val());else if(t=="top10"||t=="top10%"||t=="last10"||t=="last10%"){let y=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim();if(parseInt(y)!=y||parseInt(y)<1||parseInt(y)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}o.push(y)}else t=="AboveAverage"?o.push("AboveAverage"):t=="SubAverage"&&o.push("SubAverage");let a;$("#checkTextColor").is(":checked")?a=$("#textcolorshow").spectrum("get").toHexString():a=null;let s;$("#checkCellColor").is(":checked")?s=$("#cellcolorshow").spectrum("get").toHexString():s=null;let u=$.extend(!0,[],f.luckysheetfile),h=e.getHistoryRules(u),d={type:"default",cellrange:$.extend(!0,[],f.luckysheet_select_save),format:{textColor:a,cellColor:s},conditionName:t,conditionRange:l,conditionValue:o},m=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save==null?[]:f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save;m.push(d),f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save=m;let p=$.extend(!0,[],f.luckysheetfile),v=e.getCurrentRules(p);e.ref(h,v),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-conditionformat-dialog").hide(),ne.allowUpdate&&ne.saveParam("all",f.currentSheetIndex,m,{k:"luckysheet_conditionformat_save"})}),$(document).off("click.CFicons").on("click.CFicons","#luckysheet-CFicons-dialog .item",function(){if($("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-CFicons-dialog").hide(),f.luckysheet_select_save.length>0){let t=$.extend(!0,[],f.luckysheet_select_save),l={len:$(this).attr("data-len"),leftMin:$(this).attr("data-leftMin"),top:$(this).attr("data-top")};e.updateItem("icons",t,l)}}),$(document).on("click",".range .fa-table",function(){let t=$(this).parents(".luckysheet-modal-dialog").attr("id");$("#"+t).hide();let l;if(t=="luckysheet-conditionformat-dialog")$(this).siblings("input").attr("id")=="conditionVal"?l="0_1":l="0_2";else if(t=="luckysheet-newConditionRule-dialog"){let a=$(this).parents(".range").attr("id");a=="formulaConditionVal"?l="1_0":a=="conditionVal"?l="1_1":l="1_2"}else if(t=="luckysheet-editorConditionRule-dialog"){let a=$(this).parents(".range").attr("id");a=="formulaConditionVal"?l="2_0":a=="conditionVal"?l="2_1":l="2_2"}let o=$(this).siblings("input").val();e.singleRangeDialog(l,o),Pt(e.getRangeByTxt(o))}),$(document).on("click","#luckysheet-singleRange-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();let t=$(this).attr("data-source"),l=$(this).parents("#luckysheet-singleRange-dialog").find("input").val();t=="0_1"?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal").val(l)):t=="0_2"?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal2").val(l)):t=="1_0"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #formulaConditionVal input").val(l)):t=="1_1"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal input").val(l)):t=="1_2"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val(l)):t=="2_0"?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val(l)):t=="2_1"?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal input").val(l)):t=="2_2"&&($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val(l)),Pt([])}),$(document).on("click","#luckysheet-singleRange-dialog-close",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();let t=$(this).attr("data-source");t=="0_1"||t=="0_2"?$("#luckysheet-conditionformat-dialog").show():t=="1_0"||t=="1_1"||t=="1_2"?$("#luckysheet-newConditionRule-dialog").show():(t=="2_0"||t=="2_1"||t=="2_2")&&$("#luckysheet-editorConditionRule-dialog").show(),Pt([])}),$(document).on("click",".luckysheet-modal-dialog-title-close",function(){let t=$(this).parents(".luckysheet-modal-dialog").attr("id");if(t=="luckysheet-newConditionRule-dialog"&&$("#"+t).find("#luckysheet-newConditionRule-dialog-close").attr("data-source")==1&&$("#luckysheet-administerRule-dialog").show(),t=="luckysheet-editorConditionRule-dialog"&&$("#luckysheet-administerRule-dialog").show(),t=="luckysheet-singleRange-dialog"){$("#luckysheet-modal-dialog-mask").show();let l=$(this).parents("#luckysheet-singleRange-dialog").find("#luckysheet-singleRange-dialog-confirm").attr("data-source");l=="0_1"||l=="0_2"?$("#luckysheet-conditionformat-dialog").show():l=="1_1"||l=="1_2"?$("#luckysheet-newConditionRule-dialog").show():(l=="2_1"||l=="2_2")&&$("#luckysheet-editorConditionRule-dialog").show(),Pt([])}t=="luckysheet-multiRange-dialog"&&($("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),Pt([])),t=="luckysheet-conditionformat-info-dialog"&&$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-conditionformat-info-dialog-close",function(){$(this).parents("#luckysheet-conditionformat-info-dialog").hide()})},singleRangeDialog:function(e,n){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-singleRange-dialog").remove();let t=Q().conditionformat;$("body").append(_e(dt,{id:"luckysheet-singleRange-dialog",addclass:"luckysheet-singleRange-dialog",title:t.selectCell,content:`<input readonly="readonly" placeholder="${t.pleaseSelectCell}" value="${n}"/>`,botton:`<button id="luckysheet-singleRange-dialog-confirm" class="btn btn-primary" data-source="${e}">${t.confirm}</button>
                        <button id="luckysheet-singleRange-dialog-close" class="btn btn-default" data-source="${e}">${t.cancel}</button>`,style:"z-index:100003"}));let l=$("#luckysheet-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),h=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-singleRange-dialog").css({left:(s+h-a)/2,top:(u+d-o)/3}).show()},multiRangeDialog:function(e,n){let t=this;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-multiRange-dialog").remove();let l=Q().conditionformat;$("body").append(_e(dt,{id:"luckysheet-multiRange-dialog",addclass:"luckysheet-multiRange-dialog",title:l.selectRange,content:`<input readonly="readonly" placeholder="${l.pleaseSelectRange}" value="${n}"/>`,botton:`<button id="luckysheet-multiRange-dialog-confirm" class="btn btn-primary" data-item="${e}">${l.confirm}</button>
                        <button id="luckysheet-multiRange-dialog-close" class="btn btn-default">${l.cancel}</button>`,style:"z-index:100003"}));let o=$("#luckysheet-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-multiRange-dialog").css({left:(u+d-s)/2,top:(h+m-a)/3}).show(),Pt(t.getRangeByTxt(n))},getTxtByRange:function(e){if(e.length>0){let n=[];for(let t=0;t<e.length;t++){let l=e[t].row[0],o=e[t].row[1],a=e[t].column[0],s=e[t].column[1];n.push(Mt(f.currentSheetIndex,{row:[l,o],column:[a,s]},f.currentSheetIndex))}return n.join(",")}},getRangeByTxt:function(e){let n=[];if(e=e.toString(),e.indexOf(",")!=-1){let t=e.split(",");for(let l=0;l<t.length;l++)if(g.iscelldata(t[l]))n.push(g.getcellrange(t[l]));else{n=[];break}}else g.iscelldata(e)&&n.push(g.getcellrange(e));return n},colorSelectInit:function(){let e=Q().conditionformat;$(".luckysheet-conditionformat-config-color").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:e.cancel,chooseText:e.confirmColor,togglePaletteMoreText:"\u81EA\u5B9A\u4E49",togglePaletteLessText:"\u6536\u8D77",togglePaletteOnly:!0,clearText:e.clearColorSelect,noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",localStorageKey:"spectrum.textcolor"+ne.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(n){n!=null&&(n=n.toHexString())}})},conditionformatDialog:function(e,n){let t=this;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-dialog").remove();let l=Q().conditionformat;$("body").append(_e(dt,{id:"luckysheet-conditionformat-dialog",addclass:"luckysheet-conditionformat-dialog",title:e,content:n,botton:`<button id="luckysheet-conditionformat-dialog-confirm" class="btn btn-primary">${l.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:9999"}));let o=$("#luckysheet-conditionformat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-conditionformat-dialog").css({left:(u+d-s)/2,top:(h+m-a)/3}).show(),t.init(),t.colorSelectInit(),e==Q().conditionformat.conditionformat_occurrenceDate&&t.daterangeInit("luckysheet-conditionformat-dialog")},CFiconsDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-CFicons-dialog").remove();let e=Q().conditionformat,n=`<div class="box">
                            <div style="margin-bottom: 10px;">${e.pleaseSelectIcon}</div>
                            <div class="title">${e.direction}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="0" title="${e.threeWayArrow}(${e.multicolor})"><div style="background-position:0 0;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="1" title="${e.threeTriangles}"><div style="background-position:0 -20px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="0" data-top="2" title="${e.fourWayArrow}(${e.multicolor})"><div style="background-position:0 -40px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="3" title="${e.fiveWayArrow}(${e.multicolor})"><div style="background-position:0 -60px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="0" title="${e.threeWayArrow}(${e.grayColor})"><div style="background-position:-131px 0;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="5" data-top="1" title="${e.fourWayArrow}(${e.grayColor})"><div style="background-position:-131px -20px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="5" data-top="2" title="${e.fiveWayArrow}(${e.grayColor})"><div style="background-position:-131px -40px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.shape}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="4" title="${e.threeColorTrafficLight}(${e.rimless})"><div style="background-position:0 -80px;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="5" title="${e.threeSigns}"><div style="background-position:0 -100px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="0" data-top="6" title="${e.greenRedBlackGradient}"><div style="background-position:0 -120px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="4" title="${e.threeColorTrafficLight}(${e.bordered})"><div style="background-position:-131px -80px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="5" data-top="5" title="${e.fourColorTrafficLight}"><div style="background-position:-131px -100px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.mark}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="7" title="${e.threeSymbols}(${e.circled})"><div style="background-position:0 -140px;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="8" title="${e.tricolorFlag}"><div style="background-position:0 -160px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="7" title="${e.threeSymbols}(${e.noCircle})"><div style="background-position:-131px -140px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.grade}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="9" title="${e.threeStars}"><div style="background-position:0 -180px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="10" title="${e.fiveQuadrantDiagram}"><div style="background-position:0 -200px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="11" title="${e.fiveBoxes}"><div style="background-position:0 -220px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="4" data-leftMin="5" data-top="9" title="${e.grade4}"><div style="background-position:-131px -180px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="5" data-top="10" title="${e.grade5}"><div style="background-position:-131px -200px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                        </div>`;$("body").append(_e(dt,{id:"luckysheet-CFicons-dialog",addclass:"luckysheet-CFicons-dialog",title:e.icons,content:n,botton:`<button class="btn btn-default luckysheet-model-close-btn">${e.close}</button>`,style:"z-index:100003"}));let t=$("#luckysheet-CFicons-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),h=$(document).scrollTop();$("#luckysheet-CFicons-dialog").css({left:(a+u-o)/2,top:(s+h-l)/3}).show()},administerRuleDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").remove();let e=Q().conditionformat,n="";for(let p=0;p<f.luckysheetfile.length;p++)f.luckysheetfile[p].status=="1"?n+=`<option value="${f.luckysheetfile[p].index}" selected="selected">
                                ${e.currentSheet}\uFF1A${f.luckysheetfile[p].name}
                            </option>`:n+=`<option value="${f.luckysheetfile[p].index}">
                                ${e.sheet}\uFF1A${f.luckysheetfile[p].name}
                            </option>`;let t=`<div class="chooseSheet">
                            <label>${e.showRules}\uFF1A</label>
                            <select>${n}</select>
                        </div>
                        <div class="ruleBox">
                            <div class="ruleBtn">
                                <button id="newConditionRule" class="btn btn-default">${e.newRule}</button>
                                <button id="editorConditionRule" class="btn btn-default">${e.editRule}</button>
                                <button id="deleteConditionRule" class="btn btn-default">${e.deleteRule}</button>
                            </div>
                            <div class="ruleList">
                                <div class="listTitle">
                                    <span>${e.rule}</span>
                                    <span>${e.format}</span>
                                    <span>${e.applyRange}</span>
                                </div>
                                <div class="listBox"></div>
                            </div>
                        </div>`;$("body").append(_e(dt,{id:"luckysheet-administerRule-dialog",addclass:"luckysheet-administerRule-dialog",title:e.conditionformatManageRules,content:t,botton:`<button id="luckysheet-administerRule-dialog-confirm" class="btn btn-primary">${e.confirm}</button>
                        <button id="luckysheet-administerRule-dialog-close" class="btn btn-default">${e.close}</button>`,style:"z-index:100003"}));let l=$("#luckysheet-administerRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),h=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-administerRule-dialog").css({left:(s+h-a)/2,top:(u+d-o)/3}).show();let m=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();this.getConditionRuleList(m)},getConditionRuleList:function(e){let n=this;$("#luckysheet-administerRule-dialog .ruleList .listBox").empty();let t=n.fileClone[Z(e)].luckysheet_conditionformat_save;if(t!=null&&t.length>0){let l=Q().conditionformat;for(let o=0;o<t.length;o++){let a=t[o].type,s=t[o].format,u=t[o].cellrange,h,d="";a=="dataBar"?(h=l.dataBar,d='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):a=="colorGradation"?(h=l.colorGradation,d='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):a=="icons"?(h=l.icons,d='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):(h=n.getConditionRuleName(t[o].conditionName,t[o].conditionRange,t[o].conditionValue),s.textColor!=null&&(d+='<span class="colorbox" title="'+l.textColor+'" style="background-color:'+s.textColor+'"></span>'),s.cellColor!=null&&(d+='<span class="colorbox" title="'+l.cellColor+'" style="background-color:'+s.cellColor+'"></span>'));let m=[];for(let v=0;v<u.length;v++){let y=u[v].row[0],k=u[v].row[1],b=u[v].column[0],w=u[v].column[1];m.push(tt(b)+(y+1)+":"+tt(w)+(k+1))}let p='<div class="item" data-item="'+o+'"><div class="ruleName" title="'+h+'">'+h+'</div><div class="format">'+d+'</div><div class="ruleRange"><input class="formulaInputFocus" readonly="true" value="'+m.join(",")+'"/><i class="fa fa-table" aria-hidden="true" title="'+l.selectRange+'"></i></div></div>';$("#luckysheet-administerRule-dialog .ruleList .listBox").prepend(p)}$("#luckysheet-administerRule-dialog .ruleList .listBox .item canvas").each(function(o){let a=$(this).closest(".item").attr("data-item"),s=t[a].type,u=t[a].format,h=$(this).get(0).getContext("2d");if(s=="dataBar")if(u.length==2){let d=h.createLinearGradient(0,0,46,0);d.addColorStop(0,u[0]),d.addColorStop(1,u[1]),h.fillStyle=d,h.fillRect(0,0,46,18),h.beginPath(),h.moveTo(0,0),h.lineTo(0,18),h.lineTo(46,18),h.lineTo(46,0),h.lineTo(0,0),h.lineWidth=f.devicePixelRatio,h.strokeStyle=u[0],h.stroke(),h.closePath()}else u.length==1&&(h.fillStyle=u[0],h.fillRect(0,0,46,18),h.beginPath(),h.moveTo(0,0),h.lineTo(0,18),h.lineTo(46,18),h.lineTo(46,0),h.lineTo(0,0),h.lineWidth=f.devicePixelRatio,h.strokeStyle=u[0],h.stroke(),h.closePath());else if(s=="colorGradation"){let d=h.createLinearGradient(0,0,46,0);u.length==3?(d.addColorStop(0,u[0]),d.addColorStop(.5,u[1]),d.addColorStop(1,u[2])):u.length==2&&(d.addColorStop(0,u[0]),d.addColorStop(1,u[1])),h.fillStyle=d,h.fillRect(0,0,46,18)}else if(s=="icons"){let d=u.len,m=u.leftMin,p=u.top,v=32*d+10*(d-1),y=32,k=46,b=46*32/v;m=="0"?h.drawImage(wi,0,p*32,v,y,0,(18-b)/2,k,b):m=="5"&&h.drawImage(wi,210,p*32,v,y,0,(18-b)/2,k,b)}}),$("#luckysheet-administerRule-dialog .ruleList .listBox .item").eq(0).addClass("on")}},getConditionRuleName:function(e,n,t){let l;n[0]!=null?l=tt(n[0].column[0])+(n[0].row[0]+1):l=t[0];let o=Q().conditionformat;if(e=="greaterThan")return o.cellValue+" > "+l;if(e=="lessThan")return o.cellValue+" < "+l;if(e=="betweenness"){let a;return n[1]!=null?a=tt(n[1].column[0])+(n[1].row[0]+1):a=t[1],o.cellValue+" "+o.between+" "+l+" "+o.in+" "+a+" "+o.between2}else{if(e=="equal")return o.cellValue+" = "+l;if(e=="textContains")return o.cellValue+o.contain+" ="+l;if(e=="occurrenceDate")return t;if(e=="duplicateValue"){if(t=="0")return o.duplicateValue;if(t=="1")return o.uniqueValue}else{if(e=="top10")return o.top+" "+l+" "+o.oneself;if(e=="top10%")return o.top+" "+l+"% "+o.oneself;if(e=="last10")return o.last+" "+l+" "+o.oneself;if(e=="last10%")return o.last+" "+l+"% "+o.oneself;if(e=="AboveAverage")return o.aboveAverage;if(e=="SubAverage")return o.belowAverage;if(e=="formula")return l.slice(0,1)!="="&&(l="="+l),o.formula+": "+l}}},newConditionRuleDialog:function(e){let n=this,t=Q().conditionformat,l=n.getRuleExplain(0);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-newConditionRule-dialog").remove();let o='<div><div class="boxTitle">'+t.chooseRuleType+"\uFF1A</div>"+n.ruleTypeHtml()+'<div class="boxTitle">'+t.editRuleDescription+'\uFF1A</div><div class="ruleExplainBox">'+l+"</div></div>";$("body").append(_e(dt,{id:"luckysheet-newConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:t.newFormatRule,content:o,botton:`<button id="luckysheet-newConditionRule-dialog-confirm" class="btn btn-primary" data-source="${e}">${t.confirm}</button>
                        <button id="luckysheet-newConditionRule-dialog-close" class="btn btn-default" data-source="${e}">${t.cancel}</button>`,style:"z-index:100003"}));let a=$("#luckysheet-newConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),s=a.outerHeight(),u=a.outerWidth(),h=$(window).width(),d=$(window).height(),m=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-newConditionRule-dialog").css({left:(h+m-u)/2,top:(d+p-s)/3}).show(),$("#luckysheet-newConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq(0)").addClass("on").siblings().removeClass("on"),n.colorSelectInit()},editorConditionRuleDialog:function(){let e=this,n=Q().conditionformat,t=e.editorRule.data;if(t==null)return;let l=t.type,o=t.format,a=t.conditionName,s,u;l=="dataBar"||l=="colorGradation"||l=="icons"?(s=0,u=l):a=="greaterThan"||a=="lessThan"||a=="betweenness"||a=="equal"||a=="textContains"||a=="occurrenceDate"?(s=1,a=="greaterThan"||a=="lessThan"||a=="betweenness"||a=="equal"?u="number":a=="textContains"?u="text":a=="occurrenceDate"&&(u="date")):a=="top10"||a=="top10%"||a=="last10"||a=="last10%"?(s=2,a=="top10"||a=="top10%"?u="top":(a=="last10"||a=="last10%")&&(u="last")):a=="AboveAverage"||a=="SubAverage"?(s=3,u=a):a=="duplicateValue"?(s=4,u=t.conditionValue):a=="formula"&&(s=5);let h=e.getRuleExplain(s);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-editorConditionRule-dialog").remove();let d='<div><div class="boxTitle">'+n.chooseRuleType+"\uFF1A</div>"+e.ruleTypeHtml()+'<div class="boxTitle">'+n.editRuleDescription+'\uFF1A</div><div class="ruleExplainBox">'+h+"</div></div>";$("body").append(_e(dt,{id:"luckysheet-editorConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:n.editFormatRule,content:d,botton:`<button id="luckysheet-editorConditionRule-dialog-confirm" class="btn btn-primary">${n.confirm}</button>
                        <button id="luckysheet-editorConditionRule-dialog-close" class="btn btn-default">${n.cancel}</button>`,style:"z-index:100003"}));let m=$("#luckysheet-editorConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),p=m.outerHeight(),v=m.outerWidth(),y=$(window).width(),k=$(window).height(),b=$(document).scrollLeft(),w=$(document).scrollTop();if($("#luckysheet-editorConditionRule-dialog").css({left:(y+b-v)/2,top:(k+w-p)/3}).show(),e.colorSelectInit(),$("#luckysheet-editorConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq("+s+")").addClass("on").siblings().removeClass("on"),$("#luckysheet-editorConditionRule-dialog #type1").val(u),(u=="dataBar"||u=="colorGradation"||u=="icons"||u=="number"||u=="text"||u=="date")&&($("#luckysheet-editorConditionRule-dialog ."+u+"Box").show(),$("#luckysheet-editorConditionRule-dialog ."+u+"Box").siblings().hide()),u=="date"&&e.daterangeInit("luckysheet-editorConditionRule-dialog"),l=="dataBar"||l=="colorGradation"||l=="icons"){if(u=="dataBar")o.length==2?$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("gradient"):o.length==1&&$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("solid"),$("#luckysheet-editorConditionRule-dialog .dataBarBox .luckysheet-conditionformat-config-color").spectrum("set",o[0]);else if(u=="colorGradation")o.length==3?($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("threeColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").show(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",o[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("set",o[1]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",o[2])):o.length==2&&($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("twoColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").hide(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",o[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",o[1]));else if(u=="icons"){let x=o.len,C=o.leftMin,S=o.top;$("#luckysheet-editorConditionRule-dialog .iconsBox li").each(function(_,T){if($(T).find("div").attr("data-len")==x&&$(T).find("div").attr("data-leftmin")==C&&$(T).find("div").attr("data-top")==S)return $("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").css("background-position",$(T).find("div").css("background-position")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-len",$(T).find("div").attr("data-len")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-leftmin",$(T).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-top",$(T).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("title",$(T).find("div").attr("title")),!0})}}else{if(u=="number"){$("#luckysheet-editorConditionRule-dialog .numberBox #type2").val(a);let x;if(t.conditionRange[0]!=null?x=Mt(f.currentSheetIndex,{row:t.conditionRange[0].row,column:t.conditionRange[0].column},f.currentSheetIndex):x=t.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal input").val(x),a=="betweenness"){$("#luckysheet-editorConditionRule-dialog .numberBox .txt").show(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").show();let C;t.conditionRange[1]!=null?C=Mt(f.currentSheetIndex,{row:t.conditionRange[1].row,column:t.conditionRange[1].column},f.currentSheetIndex):C=t.conditionValue[1],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2 input").val(C)}else $("#luckysheet-editorConditionRule-dialog .numberBox .txt").hide(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").hide()}else if(u=="text"){let x;t.conditionRange[0]!=null?x=Mt(f.currentSheetIndex,{row:t.conditionRange[0].row,column:t.conditionRange[0].column},f.currentSheetIndex):x=t.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .textBox #conditionVal input").val(x)}else if(u=="date"){e.daterangeInit("luckysheet-editorConditionRule-dialog");let x=t.conditionValue[0];$("#luckysheet-editorConditionRule-dialog .dateBox #daterange-btn").val(x)}else if(u=="top"||u=="last"){let x=t.conditionValue[0];(a=="top10%"||a=="last10%")&&$("#luckysheet-editorConditionRule-dialog #isPercent").attr("checked","checked")}else if(a=="formula"){let x=t.conditionValue[0];$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val(x)}$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("set",o.textColor),$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("set",o.cellColor)}},infoDialog:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-info-dialog").remove(),$("body").append(_e(dt,{id:"luckysheet-conditionformat-info-dialog",addclass:"",title:e,content:n,botton:`<button id="luckysheet-conditionformat-info-dialog-close" class="btn btn-default">${Q().conditionformat.close}</button>`,style:"z-index:100003"}));let t=$("#luckysheet-conditionformat-info-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),h=$(document).scrollTop();$("#luckysheet-conditionformat-info-dialog").css({left:(a+u-o)/2,top:(s+h-l)/3}).show()},getRuleExplain:function(e){let n=Q().conditionformat,t=this.textCellColorHtml(),l;switch(e){case 0:l=`<div class="title">${n.ruleTypeItem1}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 5px;">
                                        <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.formatStyle}\uFF1A</label>
                                        <select id="type1">
                                            <option value="dataBar">${n.dataBar}</option>
                                            <option value="colorGradation">${n.colorGradation}</option>
                                            <option value="icons">${n.icons}</option>
                                        </select>
                                    </div>
                                    <div>
                                        <div class="type1Box dataBarBox">
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.fillType}\uFF1A</label>
                                                <select id="type2">
                                                    <option value="gradient">${n.gradient}</option>
                                                    <option value="solid">${n.solid}</option>
                                                </select>
                                            </div>
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.color}\uFF1A</label>
                                                <input data-tips="${n.dataBarColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#638ec6" style="display: none;"> 
                                            </div>
                                        </div>
                                        <div class="type1Box colorGradationBox" style="display: none;">
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.fillType}\uFF1A</label>
                                                <select id="type2">
                                                    <option value="threeColor">${n.tricolor}</option>
                                                    <option value="twoColor">${n.twocolor}</option>
                                                </select>
                                            </div>
                                            <div class="maxVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.maxValue}\uFF1A</label>
                                                <input data-tips="${n.maxValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(99, 190, 123)" style="display: none;">
                                            </div>
                                            <div class="midVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.medianValue}\uFF1A</label>
                                                <input data-tips="${n.medianValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(255, 235, 132)" style="display: none;">
                                            </div>
                                            <div class="minVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.minValue}\uFF1A</label>
                                                <input data-tips="${n.minValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(248, 105, 107)" style="display: none;">
                                            </div>
                                        </div>
                                        <div class="type1Box iconsBox" style="display: none;">
                                            <label>${n.fillType}\uFF1A</label>
                                            <div class="showbox">
                                                <div class="model" data-len="3" data-leftmin="0" data-top="0" title="${n.threeWayArrow}(${n.multicolor})" style="background-position: 0 0;"></div>
                                                <span class="ui-selectmenu-icon ui-icon ui-icon-triangle-1-s" style="margin-top: 2px;"></span>
                                            </div>
                                            <ul>
                                                <li><div data-len="3" data-leftmin="0" data-top="0" title="${n.threeWayArrow}(${n.multicolor})" style="background-position: 0 0;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="0" title="${n.threeWayArrow}(${n.grayColor})" style="background-position: -131px 0;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="1" title="${n.threeTriangles}" style="background-position: 0 -20px;"></div></li>
                                                <li><div data-len="4" data-leftmin="0" data-top="2" title="${n.fourWayArrow}(${n.multicolor})" style="background-position: 0 -40px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="1" title="${n.fourWayArrow}(${n.grayColor})" style="background-position: -131px -20px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="3" title="${n.fiveWayArrow}(${n.multicolor})" style="background-position: 0 -60px;"></div></li>
                                                <li><div data-len="5" data-leftmin="5" data-top="2" title="${n.fiveWayArrow}(${n.grayColor})" style="background-position: -131px -40px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="4" title="${n.threeColorTrafficLight}(${n.rimless})" style="background-position: 0 -80px;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="4" title="${n.threeColorTrafficLight}(${n.bordered})" style="background-position: -131px -80px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="5" title="${n.threeSigns}" style="background-position: 0 -100px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="5" title="${n.fourColorTrafficLight}" style="background-position: -131px -100px;"></div></li>
                                                <li><div data-len="4" data-leftmin="0" data-top="6" title="${n.greenRedBlackGradient}" style="background-position: 0 -120px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="7" title="${n.threeSymbols}(${n.circled})" style="background-position: 0 -140px;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="7" title="${n.threeSymbols}(${n.noCircle})" style="background-position: -131px -140px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="8" title="${n.tricolorFlag}" style="background-position: 0 -160px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="9" title="${n.threeStars}" style="background-position: 0 -180px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="10" title="${n.fiveQuadrantDiagram}" style="background-position: 0 -200px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="11" title="${n.fiveBoxes}" style="background-position: 0 -220px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="9" title="${n.grade4}" style="background-position: -131px -180px;"></div></li>
                                                <li><div data-len="5" data-leftmin="5" data-top="10" title="${n.grade5}" style="background-position: -131px -200px;"></div></li>
                                            </ul>
                                        </div>
                                    </div>`;break;case 1:l=`<div class="title">${n.ruleTypeItem2_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="number">${n.cellValue}</option>
                                            <option value="text">${n.specificText}</option>
                                            <option value="date">${n.occurrence}</option>
                                        </select>
                                        <div>
                                            <div class="type1Box numberBox">
                                                <select id="type2">
                                                    <option value="greaterThan">${n.greaterThan}</option>
                                                    <option value="lessThan">${n.lessThan}</option>
                                                    <option value="betweenness">${n.between}</option>
                                                    <option value="equal">${n.equal}</option>
                                                </select>
                                                <div class="inpbox range" id="conditionVal">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                                </div>
                                                <span class="txt" style="display: none;">${n.in}</span>
                                                <div class="inpbox range" id="conditionVal2" style="display: none;">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectDataRange}"></i>
                                                </div>
                                            </div>
                                            <div class="type1Box textBox" style="display: none;">
                                                <select id="type2">
                                                    <option value="">${n.contain}</option>
                                                </select>
                                                <div class="inpbox range" id="conditionVal">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                                </div>
                                            </div>
                                            <div class="type1Box dateBox" style="display: none;">
                                                <div style="width: 162px;" class="inpbox">
                                                    <input style="width: 150px;" id="daterange-btn" readonly="readonly" placeholder="${n.pleaseSelectADate}"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="title">${n.setFormat}: </div>${t}`;break;case 2:l=`<div class="title">${n.ruleTypeItem3_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="top">${n.top}</option>
                                            <option value="last">${n.last}</option>
                                        </select>
                                        <div class="inpbox" id="conditionVal">
                                            <input class="formulaInputFocus" type="number" value="10"/>
                                        </div>
                                        <input id="isPercent" type="checkbox"/>
                                        <label for="isPercent" class="txt">${n.selectRange_percent}</label>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 3:l=`<div class="title">${n.ruleTypeItem4_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="AboveAverage">${n.above}</option>
                                            <option value="SubAverage">${n.below}</option>
                                        </select>
                                        <span class="txt">${n.selectRange_average}</span>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 4:l=`<div class="title">${n.all}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="0">${n.duplicateValue}</option>
                                            <option value="1">${n.uniqueValue}</option>
                                        </select>
                                        <span class="txt">${n.selectRange_value}</span>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 5:l=`<div class="title">${n.ruleTypeItem2_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <div class="inpbox range" id="formulaConditionVal" style="width: 250px;">
                                            <input class="formulaInputFocus" style="width: 200px;"/>
                                            <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                        </div>
                                    </div>
                                    <div class="title">${n.setFormat}: </div>${t}`;break}return l},daterangeInit:function(e){let n=Q().conditionformat;$(".ranges_1 ul").remove(),$("#"+e).find("#daterange-btn").flatpickr({mode:"range",onChange:function(t,l){let[o,a]=t,s=[n.yesterday,n.today],u=[n.lastWeek,n.thisWeek,n.lastMonth,n.thisMonth,n.lastYear,n.thisYear,n.last7days,n.last30days];l==n.all?$("#daterange-btn").val(""):s.indexOf(l)>-1?$("#daterange-btn").val((0,ba.default)(o).format("YYYY/MM/DD")):u.indexOf(l)>-1&&$("#daterange-btn").val((0,ba.default)(o).format("YYYY/MM/DD")+"-"+(0,ba.default)(a).format("YYYY/MM/DD"))}})},CFSplitRange:function(e,n,t,l){let o=[],a=t.row[0]-n.row[0],s=t.column[0]-n.column[0],u=e.row[0],h=e.row[1],d=e.column[0],m=e.column[1];return u>=n.row[0]&&h<=n.row[1]&&d>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u+a,h+a],column:[d+s,m+s]}]:l=="restPart"?o=[]:l=="operatePart"&&(o=[{row:[u+a,h+a],column:[d+s,m+s]}]):u>=n.row[0]&&u<=n.row[1]&&d>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[n.row[1]+1,h],column:[d,m]},{row:[u+a,n.row[1]+a],column:[d+s,m+s]}]:l=="restPart"?o=[{row:[n.row[1]+1,h],column:[d,m]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[d+s,m+s]}]):h>=n.row[0]&&h<=n.row[1]&&d>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0]+a,h+a],column:[d+s,m+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[d,m]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,h+a],column:[d+s,m+s]}]):u<n.row[0]&&h>n.row[1]&&d>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[1]+1,h],column:[d,m]},{row:[n.row[0]+a,n.row[1]+a],column:[d+s,m+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[1]+1,h],column:[d,m]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[d+s,m+s]}]):d>=n.column[0]&&d<=n.column[1]&&u>=n.row[0]&&h<=n.row[1]?l=="allPart"?o=[{row:[u,h],column:[n.column[1]+1,m]},{row:[u+a,h+a],column:[d+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,h],column:[n.column[1]+1,m]}]:l=="operatePart"&&(o=[{row:[u+a,h+a],column:[d+s,n.column[1]+s]}]):m>=n.column[0]&&m<=n.column[1]&&u>=n.row[0]&&h<=n.row[1]?l=="allPart"?o=[{row:[u,h],column:[d,n.column[0]-1]},{row:[u+a,h+a],column:[n.column[0]+s,m+s]}]:l=="restPart"?o=[{row:[u,h],column:[d,n.column[0]-1]}]:l=="operatePart"&&(o=[{row:[u+a,h+a],column:[n.column[0]+s,m+s]}]):d<n.column[0]&&m>n.column[1]&&u>=n.row[0]&&h<=n.row[1]?l=="allPart"?o=[{row:[u,h],column:[d,n.column[0]-1]},{row:[u,h],column:[n.column[1]+1,m]},{row:[u+a,h+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,h],column:[d,n.column[0]-1]},{row:[u,h],column:[n.column[1]+1,m]}]:l=="operatePart"&&(o=[{row:[u+a,h+a],column:[n.column[0]+s,n.column[1]+s]}]):u>=n.row[0]&&u<=n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[n.column[1]+1,m]},{row:[n.row[1]+1,h],column:[d,m]},{row:[u+a,n.row[1]+a],column:[d+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[n.column[1]+1,m]},{row:[n.row[1]+1,h],column:[d,m]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[d+s,n.column[1]+s]}]):u>=n.row[0]&&u<=n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[d,n.column[0]-1]},{row:[n.row[1]+1,h],column:[d,m]},{row:[u+a,n.row[1]+a],column:[n.column[0]+s,m+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[d,n.column[0]-1]},{row:[n.row[1]+1,h],column:[d,m]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[n.column[0]+s,m+s]}]):h>=n.row[0]&&h<=n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],h],column:[n.column[1]+1,m]},{row:[n.row[0]+a,h+a],column:[d+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],h],column:[n.column[1]+1,m]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,h+a],column:[d+s,n.column[1]+s]}]):h>=n.row[0]&&h<=n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],h],column:[d,n.column[0]-1]},{row:[n.row[0]+a,h+a],column:[n.column[0]+s,m+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],h],column:[d,n.column[0]-1]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,h+a],column:[n.column[0]+s,m+s]}]):u<n.row[0]&&h>n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,m]},{row:[n.row[1]+1,h],column:[d,m]},{row:[n.row[0]+a,n.row[1]+a],column:[d+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,m]},{row:[n.row[1]+1,h],column:[d,m]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[d+s,n.column[1]+s]}]):u<n.row[0]&&h>n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],n.row[1]],column:[d,n.column[0]-1]},{row:[n.row[1]+1,h],column:[d,m]},{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,m+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],n.row[1]],column:[d,n.column[0]-1]},{row:[n.row[1]+1,h],column:[d,m]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,m+s]}]):d<n.column[0]&&m>n.column[1]&&u>=n.row[0]&&u<=n.row[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[d,n.column[0]-1]},{row:[u,n.row[1]],column:[n.column[1]+1,m]},{row:[n.row[1]+1,h],column:[d,m]},{row:[u+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[d,n.column[0]-1]},{row:[u,n.row[1]],column:[n.column[1]+1,m]},{row:[n.row[1]+1,h],column:[d,m]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]):d<n.column[0]&&m>n.column[1]&&h>=n.row[0]&&h<=n.row[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],h],column:[d,n.column[0]-1]},{row:[n.row[0],h],column:[n.column[1]+1,m]},{row:[n.row[0]+a,h+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],h],column:[d,n.column[0]-1]},{row:[n.row[0],h],column:[n.column[1]+1,m]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,h+a],column:[n.column[0]+s,n.column[1]+s]}]):u<n.row[0]&&h>n.row[1]&&d<n.column[0]&&m>n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],n.row[1]],column:[d,n.column[0]-1]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,m]},{row:[n.row[1]+1,h],column:[d,m]},{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[d,m]},{row:[n.row[0],n.row[1]],column:[d,n.column[0]-1]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,m]},{row:[n.row[1]+1,h],column:[d,m]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]):l=="allPart"?o=[{row:[u,h],column:[d,m]}]:l=="restPart"?o=[{row:[u,h],column:[d,m]}]:l=="operatePart"&&(o=[]),o},getcolorGradation:function(e,n,t,l,o){let a=e.split(","),s=parseInt(a[0].split("(")[1]),u=parseInt(a[1]),h=parseInt(a[2].split(")")[0]),d=n.split(","),m=parseInt(d[0].split("(")[1]),p=parseInt(d[1]),v=parseInt(d[2].split(")")[0]),y=Math.round(s-(s-m)/(t-l)*(t-o)),k=Math.round(u-(u-p)/(t-l)*(t-o)),b=Math.round(h-(h-v)/(t-l)*(t-o));return"rgb("+y+", "+k+", "+b+")"},getCFPartRange:function(e,n,t){let l=[],o=f.luckysheetfile[Z(e)].luckysheet_conditionformat_save;if(o!=null&&o.length>0){e:for(let a=0;a<o.length;a++){let s=o[a].cellrange;for(let u=0;u<s.length;u++){let h=s[u].row[0],d=s[u].row[1],m=s[u].column[0],p=s[u].column[1];for(let v=0;v<range.length;v++)if(range[v].row[0]>=h&&range[v].row[0]<=d||range[v].row[1]>=h&&range[v].row[1]<=d||range[v].column[0]>=m&&range[v].column[0]<=p||range[v].column[1]>=m&&range[v].column[1]<=p){l.push(o[a]);continue e}}}}return l},checksCF:function(e,n,t){return t!=null&&e+"_"+n in t?t[e+"_"+n]:null},getComputeMap:function(e){let n=Z(f.currentSheetIndex);e!=null&&(n=Z(e));let t=f.luckysheetfile[n].luckysheet_conditionformat_save,l=f.luckysheetfile[n].data;return l==null?null:this.compute(t,l)},compute:function(e,n){let t=this;e==null&&(e=[]);let l={};if(e.length>0)for(let o=0;o<e.length;o++){let a=e[o].type,s=e[o].cellrange,u=e[o].format;if(a=="dataBar"){let h=null,d=null;for(let m=0;m<s.length;m++)for(let p=s[m].row[0];p<=s[m].row[1];p++)for(let v=s[m].column[0];v<=s[m].column[1];v++){if(n[p]==null||n[p][v]==null)continue;let y=n[p][v];N(y)=="object"&&y.ct!=null&&y.ct.t=="n"&&y.v!=null&&((h==null||parseInt(y.v)>h)&&(h=parseInt(y.v)),(d==null||parseInt(y.v)<d)&&(d=parseInt(y.v)))}if(h!=null&&d!=null)if(d<0){let m=Math.round(h/(h-d)*10)/10,p=Math.round(Math.abs(d)/(h-d)*10)/10;for(let v=0;v<s.length;v++)for(let y=s[v].row[0];y<=s[v].row[1];y++)for(let k=s[v].column[0];k<=s[v].column[1];k++){if(n[y]==null||n[y][k]==null)continue;let b=n[y][k];if(N(b)=="object"&&b.ct!=null&&b.ct.t=="n"&&b.v!=null){if(parseInt(b.v)<0){let w=Math.round(Math.abs(parseInt(b.v))/Math.abs(d)*100)/100;y+"_"+k in l?l[y+"_"+k].dataBar={valueType:"minus",minusLen:p,valueLen:w,format:u}:l[y+"_"+k]={dataBar:{valueType:"minus",minusLen:p,valueLen:w,format:u}}}if(parseInt(b.v)>0){let w=Math.round(parseInt(b.v)/h*100)/100;y+"_"+k in l?l[y+"_"+k].dataBar={valueType:"plus",plusLen:m,minusLen:p,valueLen:w,format:u}:l[y+"_"+k]={dataBar:{valueType:"plus",plusLen:m,minusLen:p,valueLen:w,format:u}}}}}}else{let m=1;for(let p=0;p<s.length;p++)for(let v=s[p].row[0];v<=s[p].row[1];v++)for(let y=s[p].column[0];y<=s[p].column[1];y++){if(n[v]==null||n[v][y]==null)continue;let k=n[v][y];if(N(k)=="object"&&k.ct!=null&&k.ct.t=="n"&&k.v!=null){let b;h==0?b=1:b=Math.round(parseInt(k.v)/h*100)/100,v+"_"+y in l?l[v+"_"+y].dataBar={valueType:"plus",plusLen:m,valueLen:b,format:u}:l[v+"_"+y]={dataBar:{valueType:"plus",plusLen:m,valueLen:b,format:u}}}}}}else if(a=="colorGradation"){let h=null,d=null,m=0,p=0;for(let v=0;v<s.length;v++)for(let y=s[v].row[0];y<=s[v].row[1];y++)for(let k=s[v].column[0];k<=s[v].column[1];k++){if(n[y]==null||n[y][k]==null)continue;let b=n[y][k];N(b)=="object"&&b.ct!=null&&b.ct.t=="n"&&b.v!=null&&(p++,m+=parseInt(b.v),(h==null||parseInt(b.v)>h)&&(h=parseInt(b.v)),(d==null||parseInt(b.v)<d)&&(d=parseInt(b.v)))}if(h!=null&&d!=null){if(u.length==3){let v=Math.floor(m/p);for(let y=0;y<s.length;y++)for(let k=s[y].row[0];k<=s[y].row[1];k++)for(let b=s[y].column[0];b<=s[y].column[1];b++){if(n[k]==null||n[k][b]==null)continue;let w=n[k][b];N(w)=="object"&&w.ct!=null&&w.ct.t=="n"&&w.v!=null&&(parseInt(w.v)==d?k+"_"+b in l?l[k+"_"+b].cellColor=u[2]:l[k+"_"+b]={cellColor:u[2]}:parseInt(w.v)>d&&parseInt(w.v)<v?k+"_"+b in l?l[k+"_"+b].cellColor=t.getcolorGradation(u[2],u[1],d,v,parseInt(w.v)):l[k+"_"+b]={cellColor:t.getcolorGradation(u[2],u[1],d,v,parseInt(w.v))}:parseInt(w.v)==v?k+"_"+b in l?l[k+"_"+b].cellColor=u[1]:l[k+"_"+b]={cellColor:u[1]}:parseInt(w.v)>v&&parseInt(w.v)<h?k+"_"+b in l?l[k+"_"+b].cellColor=t.getcolorGradation(u[1],u[0],v,h,parseInt(w.v)):l[k+"_"+b]={cellColor:t.getcolorGradation(u[1],u[0],v,h,parseInt(w.v))}:parseInt(w.v)==h&&(k+"_"+b in l?l[k+"_"+b].cellColor=u[0]:l[k+"_"+b]={cellColor:u[0]}))}}else if(u.length==2)for(let v=0;v<s.length;v++)for(let y=s[v].row[0];y<=s[v].row[1];y++)for(let k=s[v].column[0];k<=s[v].column[1];k++){if(n[y]==null||n[y][k]==null)continue;let b=n[y][k];N(b)=="object"&&b.ct!=null&&b.ct.t=="n"&&b.v!=null&&(parseInt(b.v)==d?y+"_"+k in l?l[y+"_"+k].cellColor=u[1]:l[y+"_"+k]={cellColor:u[1]}:parseInt(b.v)>d&&parseInt(b.v)<h?y+"_"+k in l?l[y+"_"+k].cellColor=t.getcolorGradation(u[1],u[0],d,h,parseInt(b.v)):l[y+"_"+k]={cellColor:t.getcolorGradation(u[1],u[0],d,h,parseInt(b.v))}:parseInt(b.v)==h&&(y+"_"+k in l?l[y+"_"+k].cellColor=u[0]:l[y+"_"+k]={cellColor:u[0]}))}}}else if(a=="icons"){let h=parseInt(u.len),d=parseInt(u.leftMin),m=parseInt(u.top),p=null,v=null;for(let y=0;y<s.length;y++)for(let k=s[y].row[0];k<=s[y].row[1];k++)for(let b=s[y].column[0];b<=s[y].column[1];b++){if(n[k]==null||n[k][b]==null)continue;let w=n[k][b];N(w)=="object"&&w.ct!=null&&w.ct.t=="n"&&w.v!=null&&((p==null||parseInt(w.v)>p)&&(p=parseInt(w.v)),(v==null||parseInt(w.v)<v)&&(v=parseInt(w.v)))}if(p!=null&&v!=null){let y=Math.floor((p-v+1)/h),k=(p-v+1)%h;if(h==3){let b,w,x;k==2?(b=[v,v+y],w=[v+y+1,v+y*2],x=[v+y*2+1,p]):(b=[v,v+y-1],w=[v+y,v+y*2-1],x=[v+y*2,p]);for(let C=0;C<s.length;C++)for(let S=s[C].row[0];S<=s[C].row[1];S++)for(let _=s[C].column[0];_<=s[C].column[1];_++){if(n[S]==null||n[S][_]==null)continue;let T=n[S][_];N(T)=="object"&&T.ct!=null&&T.ct.t=="n"&&T.v!=null&&(parseInt(T.v)>=b[0]&&parseInt(T.v)<=b[1]?S+"_"+_ in l?l[S+"_"+_].icons={left:d+2,top:m}:l[S+"_"+_]={icons:{left:d+2,top:m}}:parseInt(T.v)>=w[0]&&parseInt(T.v)<=w[1]?S+"_"+_ in l?l[S+"_"+_].icons={left:d+1,top:m}:l[S+"_"+_]={icons:{left:d+1,top:m}}:parseInt(T.v)>=x[0]&&parseInt(T.v)<=x[1]&&(S+"_"+_ in l?l[S+"_"+_].icons={left:d,top:m}:l[S+"_"+_]={icons:{left:d,top:m}}))}}else if(h==4){let b,w,x,C;k==2?(b=[v,v+y],w=[v+y+1,v+y*2],x=[v+y*2+1,v+y*3],C=[v+y*3+1,p]):k==3?(b=[v,v+y],w=[v+y+1,v+y*2],x=[v+y*2+1,v+y*3+1],C=[v+y*3+2,p]):(b=[v,v+y-1],w=[v+y,v+y*2-1],x=[v+y*2,v+y*3-1],C=[v+y*3,p]);for(let S=0;S<s.length;S++)for(let _=s[S].row[0];_<=s[S].row[1];_++)for(let T=s[S].column[0];T<=s[S].column[1];T++){if(n[_]==null||n[_][T]==null)continue;let F=n[_][T];N(F)=="object"&&F.ct!=null&&F.ct.t=="n"&&F.v!=null&&(parseInt(F.v)>=b[0]&&parseInt(F.v)<=b[1]?_+"_"+T in l?l[_+"_"+T].icons={left:d+3,top:m}:l[_+"_"+T]={icons:{left:d+3,top:m}}:parseInt(F.v)>=w[0]&&parseInt(F.v)<=w[1]?_+"_"+T in l?l[_+"_"+T].icons={left:d+2,top:m}:l[_+"_"+T]={icons:{left:d+2,top:m}}:parseInt(F.v)>=x[0]&&parseInt(F.v)<=x[1]?_+"_"+T in l?l[_+"_"+T].icons={left:d+1,top:m}:l[_+"_"+T]={icons:{left:d+1,top:m}}:parseInt(F.v)>=C[0]&&parseInt(F.v)<=C[1]&&(_+"_"+T in l?l[_+"_"+T].icons={left:d,top:m}:l[_+"_"+T]={icons:{left:d,top:m}}))}}else if(h==5){let b,w,x,C,S;k==2?(b=[v,v+y],w=[v+y+1,v+y*2],x=[v+y*2+1,v+y*3],C=[v+y*3+1,v+y*4],S=[v+y*4+1,p]):k==3?(b=[v,v+y],w=[v+y+1,v+y*2],x=[v+y*2+1,v+y*3+1],C=[v+y*3+2,v+y*4+1],S=[v+y*4+2,p]):k==4?(b=[v,v+y],w=[v+y+1,v+y*2+1],x=[v+y*2+2,v+y*3+1],C=[v+y*3+2,v+y*4+2],S=[v+y*4+3,p]):(b=[v,v+y-1],w=[v+y,v+y*2-1],x=[v+y*2,v+y*3-1],C=[v+y*3,v+y*4-1],S=[v+y*4,p]);for(let _=0;_<s.length;_++)for(let T=s[_].row[0];T<=s[_].row[1];T++)for(let F=s[_].column[0];F<=s[_].column[1];F++){if(n[T]==null||n[T][F]==null)continue;let R=n[T][F];N(R)=="object"&&R.ct!=null&&R.ct.t=="n"&&R.v!=null&&(parseInt(R.v)>=b[0]&&parseInt(R.v)<=b[1]?T+"_"+F in l?l[T+"_"+F].icons={left:d+4,top:m}:l[T+"_"+F]={icons:{left:d+4,top:m}}:parseInt(R.v)>=w[0]&&parseInt(R.v)<=w[1]?T+"_"+F in l?l[T+"_"+F].icons={left:d+3,top:m}:l[T+"_"+F]={icons:{left:d+3,top:m}}:parseInt(R.v)>=x[0]&&parseInt(R.v)<=x[1]?T+"_"+F in l?l[T+"_"+F].icons={left:d+2,top:m}:l[T+"_"+F]={icons:{left:d+2,top:m}}:parseInt(R.v)>=C[0]&&parseInt(R.v)<=C[1]?T+"_"+F in l?l[T+"_"+F].icons={left:d+1,top:m}:l[T+"_"+F]={icons:{left:d+1,top:m}}:parseInt(R.v)>=S[0]&&parseInt(R.v)<=S[1]&&(T+"_"+F in l?l[T+"_"+F].icons={left:d,top:m}:l[T+"_"+F]={icons:{left:d,top:m}}))}}}}else{let h=e[o].conditionName,d=e[o].conditionValue[0],m=e[o].conditionValue[1],p=u.textColor,v=u.cellColor;for(let y=0;y<s.length;y++)if(h=="greaterThan"||h=="lessThan"||h=="equal"||h=="textContains")for(let k=s[y].row[0];k<=s[y].row[1];k++)for(let b=s[y].column[0];b<=s[y].column[1];b++){if(n[k]==null||n[k][b]==null)continue;let w=n[k][b];N(w)!="object"||me(w.v)||(h=="greaterThan"&&w.v>d?k+"_"+b in l?(l[k+"_"+b].textColor=p,l[k+"_"+b].cellColor=v):l[k+"_"+b]={textColor:p,cellColor:v}:h=="lessThan"&&w.v<d?k+"_"+b in l?(l[k+"_"+b].textColor=p,l[k+"_"+b].cellColor=v):l[k+"_"+b]={textColor:p,cellColor:v}:h=="equal"&&w.v==d?k+"_"+b in l?(l[k+"_"+b].textColor=p,l[k+"_"+b].cellColor=v):l[k+"_"+b]={textColor:p,cellColor:v}:h=="textContains"&&w.v.toString().indexOf(d)!=-1&&(k+"_"+b in l?(l[k+"_"+b].textColor=p,l[k+"_"+b].cellColor=v):l[k+"_"+b]={textColor:p,cellColor:v}))}else if(h=="betweenness"){let k,b;d>m?(k=d,b=m):(k=m,b=d);for(let w=s[y].row[0];w<=s[y].row[1];w++)for(let x=s[y].column[0];x<=s[y].column[1];x++){if(n[w]==null||n[w][x]==null)continue;let C=n[w][x];N(C)!="object"||me(C.v)||C.v>=b&&C.v<=k&&(w+"_"+x in l?(l[w+"_"+x].textColor=p,l[w+"_"+x].cellColor=v):l[w+"_"+x]={textColor:p,cellColor:v})}}else if(h=="occurrenceDate"){let k,b;if(d.toString().indexOf("-")==-1)k=nt(d)[2],b=nt(d)[2];else{let w=d.toString().split("-");k=nt(w[1].trim())[2],b=nt(w[0].trim())[2]}for(let w=s[y].row[0];w<=s[y].row[1];w++)for(let x=s[y].column[0];x<=s[y].column[1];x++)if(!(n[w]==null||n[w][x]==null)&&n[w][x].ct!=null&&n[w][x].ct.t=="d"){let C=Le(w,x,n);C>=b&&C<=k&&(w+"_"+x in l?(l[w+"_"+x].textColor=p,l[w+"_"+x].cellColor=v):l[w+"_"+x]={textColor:p,cellColor:v})}}else if(h=="duplicateValue"){let k={};for(let b=s[y].row[0];b<=s[y].row[1];b++)for(let w=s[y].column[0];w<=s[y].column[1];w++){let x=Le(b,w,n);x in k||(k[x]=[]),k[x].push({r:b,c:w})}if(d=="0"){for(let b in k)if(b!="null"&&b!="undefined"&&k[b].length>1)for(let w=0;w<k[b].length;w++)k[b][w].r+"_"+k[b][w].c in l?(l[k[b][w].r+"_"+k[b][w].c].textColor=p,l[k[b][w].r+"_"+k[b][w].c].cellColor=v):l[k[b][w].r+"_"+k[b][w].c]={textColor:p,cellColor:v}}if(d=="1")for(let b in k)b!="null"&&b!="undefined"&&k[b].length==1&&(k[b][0].r+"_"+k[b][0].c in l?(l[k[b][0].r+"_"+k[b][0].c].textColor=p,l[k[b][0].r+"_"+k[b][0].c].cellColor=v):l[k[b][0].r+"_"+k[b][0].c]={textColor:p,cellColor:v})}else if(h=="top10"||h=="top10%"||h=="last10"||h=="last10%"||h=="AboveAverage"||h=="SubAverage"){let k=[];for(let b=s[y].row[0];b<=s[y].row[1];b++)for(let w=s[y].column[0];w<=s[y].column[1];w++)n[b]==null||n[b][w]==null||n[b][w].ct!=null&&n[b][w].ct.t=="n"&&k.push(Le(b,w,n));if(h=="top10"||h=="top10%"||h=="last10"||h=="last10%"){for(let w=0;w<k.length;w++)for(let x=0;x<k.length-1-w;x++)if(k[x]<k[x+1]){let C=k[x];k[x]=k[x+1],k[x+1]=C}let b;h=="top10"?b=k.slice(0,d):h=="top10%"?b=k.slice(0,Math.floor(d*k.length/100)):h=="last10"?b=k.slice(k.length-d,k.length):h=="last10%"&&(b=k.slice(k.length-Math.floor(d*k.length/100),k.length));for(let w=s[y].row[0];w<=s[y].row[1];w++)for(let x=s[y].column[0];x<=s[y].column[1];x++){if(n[w]==null||n[w][x]==null)continue;let C=Le(w,x,n);b.indexOf(C)!=-1&&(w+"_"+x in l?(l[w+"_"+x].textColor=p,l[w+"_"+x].cellColor=v):l[w+"_"+x]={textColor:p,cellColor:v})}}else if(h=="AboveAverage"||h=="SubAverage"){let b=0;for(let x=0;x<k.length;x++)b+=k[x];let w=b/k.length;if(h=="AboveAverage")for(let x=s[y].row[0];x<=s[y].row[1];x++)for(let C=s[y].column[0];C<=s[y].column[1];C++){if(n[x]==null||n[x][C]==null)continue;Le(x,C,n)>w&&(x+"_"+C in l?(l[x+"_"+C].textColor=p,l[x+"_"+C].cellColor=v):l[x+"_"+C]={textColor:p,cellColor:v})}else if(h=="SubAverage")for(let x=s[y].row[0];x<=s[y].row[1];x++)for(let C=s[y].column[0];C<=s[y].column[1];C++){if(n[x]==null||n[x][C]==null)continue;Le(x,C,n)<w&&(x+"_"+C in l?(l[x+"_"+C].textColor=p,l[x+"_"+C].cellColor=v):l[x+"_"+C]={textColor:p,cellColor:v})}}}else if(h=="formula"){let k=s[y].row[0],b=s[y].row[1],w=s[y].column[0],x=s[y].column[1],C=d;d.toString().slice(0,1)!="="&&(C="="+d);for(let S=k;S<=b;S++)for(let _=w;_<=x;_++){let T=C,F=S-k,R=_-w;F>0&&(T="="+g.functionCopy(T,"down",F)),R>0&&(T="="+g.functionCopy(T,"right",R));let P=g.execfunction(T)[1];typeof P!="boolean"&&(P=!!Number(P)),!!P&&(S+"_"+_ in l?(l[S+"_"+_].textColor=p,l[S+"_"+_].cellColor=v):l[S+"_"+_]={textColor:p,cellColor:v})}}}}return l},updateItem:function(e,n,t){if(!Sr(f.currentSheetIndex))return;let l=this,o=Z(f.currentSheetIndex),a=$.extend(!0,[],f.luckysheetfile),s=l.getHistoryRules(a),u;if(e=="delSheet")u=[];else{let m={type:e,cellrange:n,format:t};u=f.luckysheetfile[o].luckysheet_conditionformat_save==null?[]:f.luckysheetfile[o].luckysheet_conditionformat_save,u.push(m)}f.luckysheetfile[o].luckysheet_conditionformat_save=u;let h=$.extend(!0,[],f.luckysheetfile),d=l.getCurrentRules(h);l.ref(s,d),ne.allowUpdate&&ne.saveParam("all",f.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})},getHistoryRules:function(e){let n=[];for(let t=0;t<e.length;t++)n.push({sheetIndex:e[t].index,luckysheet_conditionformat_save:e[t].luckysheet_conditionformat_save});return n},getCurrentRules:function(e){let n=[];for(let t=0;t<e.length;t++)n.push({sheetIndex:e[t].index,luckysheet_conditionformat_save:e[t].luckysheet_conditionformat_save});return n},ref:function(e,n){if(f.clearjfundo){f.jfundo.length=0;let t={};t.type="updateCF",t.data={historyRules:e,currentRules:n},f.jfredo.push(t)}setTimeout(function(){Be()},1)}},Se=Av});var zv,wt,Wi=Me(()=>{Zt();ol();mr();Ml();Jt();ll();Ut();Bi();Kt();dr();Nt();Yt();Fl();Et();ht();Ke();kt();qr();zv={clearcopy:function(e){let n=window.clipboardData;n||e&&(n=e.originalEvent.clipboardData);let t=" ";if(f.luckysheet_selection_range=[],Pt(),n)return n.setData("Text",t),!1;{let l=$("#luckysheet-copy-content").css("visibility","hidden");l.val(t),l.focus(),l.select(),setTimeout(function(){l.blur().css("visibility","visible")},10)}},getHtmlBorderStyle:function(e,n){let t="";return e={"0":"none","1":"Thin","2":"Hair","3":"Dotted","4":"Dashed","5":"DashDot","6":"DashDotDot","7":"Double","8":"Medium","9":"MediumDashed","10":"MediumDashDot","11":"MediumDashDotDot","12":"SlantedDashDot","13":"Thick"}[e.toString()],e.indexOf("Medium")>-1?t+="1pt ":e=="Thick"?t+="1.5pt ":t+="0.5pt ",e=="Hair"?t+="double ":e.indexOf("DashDotDot")>-1?t+="dotted ":e.indexOf("DashDot")>-1?t+="dashed ":e.indexOf("Dotted")>-1?t+="dotted ":e.indexOf("Dashed")>-1?t+="dashed ":t+="solid ",t+n+";"},copy:function(e){let n=window.clipboardData;n||(n=e.originalEvent.clipboardData),f.luckysheet_selection_range=[];let t=[],l=[],o=[],a=!1,s=!1;for(let v=0;v<f.luckysheet_select_save.length;v++){let y=f.luckysheet_select_save[v],k=y.row[0],b=y.row[1],w=y.column[0],x=y.column[1];for(let C=k;C<=b;C++)if(!(f.config.rowhidden!=null&&f.config.rowhidden[C]!=null)){t.includes(C)||t.push(C),f.config.rowlen!=null&&C in f.config.rowlen&&(a=!0);for(let S=w;S<=x;S++){if(f.config.colhidden!=null&&f.config.colhidden[S]!=null)continue;l.includes(S)||l.push(S);let _=f.flowdata[C][S];N(_)=="object"&&"mc"in _&&_.mc.rs!=null&&(s=!0)}}f.luckysheet_selection_range.push({row:y.row,column:y.column}),o.push({row:y.row,column:y.column})}Pt(),f.luckysheet_copy_save={dataSheetIndex:f.currentSheetIndex,copyRange:o,RowlChange:a,HasMC:s};let u=this,h;f.config.borderInfo&&f.config.borderInfo.length>0&&(h=Ur());let d="",m=xe.deepCopyFlowData(f.flowdata),p="";for(let v=0;v<t.length;v++){let y=t[v];if(!(f.config.rowhidden!=null&&f.config.rowhidden[y]!=null)){f.config==null||f.config.rowlen==null||f.config.rowlen[y.toString()]==null?d+='<tr height="19">':d+=`<tr height="${f.config.rowlen[y.toString()]}">`;for(let k=0;k<l.length;k++){let b=l[k];if(y==t[0]&&(f.config==null||f.config.columnlen==null||f.config.columnlen[b.toString()]==null?p+='<col width="72px"></col>':p+='<col width="'+f.config.columnlen[b.toString()]+'px"></col>'),f.config.colhidden!=null&&f.config.colhidden[b]!=null)continue;let w='<td ${span} style="${style}">';if(m[y]!=null&&m[y][b]!=null){let x="",C="",S=/^(w|W)((0?)|(0\.0+))$/,_;if(m[y][b].ct!=null&&m[y][b].ct.fa!=null&&m[y][b].ct.fa.match(S)?_=Le(y,b,m):_=Le(y,b,m,"m"),x+=be.getStyleByCell(m,y,b),N(m[y][b])=="object"&&"mc"in m[y][b])if("rs"in m[y][b].mc){if(C='rowspan="'+m[y][b].mc.rs+'" colspan="'+m[y][b].mc.cs+'"',h&&h[y+"_"+b]){let T={color:{},style:{}},F={color:{},style:{}},R={color:{},style:{}},I={color:{},style:{}};for(let M=y;M<y+m[y][b].mc.rs;M++)for(let A=b;A<b+m[y][b].mc.cs;A++){if(M==y&&h[M+"_"+A]&&h[M+"_"+A].t){let z=h[M+"_"+A].t.style,L=h[M+"_"+A].t.color;R.style[z]==null?R.style[z]=1:R.style[z]=R.style[z]+1,R.color[L]==null?R.color[L]=1:R.color[L]=R.color[L]+1}if(M==y+m[y][b].mc.rs-1&&h[M+"_"+A]&&h[M+"_"+A].b){let z=h[M+"_"+A].b.style,L=h[M+"_"+A].b.color;I.style[z]==null?I.style[z]=1:I.style[z]=I.style[z]+1,I.color[L]==null?I.color[L]=1:I.color[L]=I.color[L]+1}if(A==b&&h[M+"_"+A]&&h[M+"_"+A].l){let z=h[y+"_"+b].l.style,L=h[M+"_"+A].l.color;T.style[z]==null?T.style[z]=1:T.style[z]=T.style[z]+1,T.color[L]==null?T.color[L]=1:T.color[L]=T.color[L]+1}if(A==b+m[y][b].mc.cs-1&&h[M+"_"+A]&&h[M+"_"+A].r){let z=h[M+"_"+A].r.style,L=h[M+"_"+A].r.color;F.style[z]==null?F.style[z]=1:F.style[z]=F.style[z]+1,F.color[L]==null?F.color[L]=1:F.color[L]=F.color[L]+1}}let P=m[y][b].mc.rs,O=m[y][b].mc.cs;if(JSON.stringify(T).length>23){let M=null,A=null;for(let z in T.color)T.color[z]>=P/2&&(M=z);for(let z in T.style)T.style[z]>=P/2&&(A=z);M!=null&&A!=null&&(x+="border-left:"+u.getHtmlBorderStyle(A,M))}if(JSON.stringify(F).length>23){let M=null,A=null;for(let z in F.color)F.color[z]>=P/2&&(M=z);for(let z in F.style)F.style[z]>=P/2&&(A=z);M!=null&&A!=null&&(x+="border-right:"+u.getHtmlBorderStyle(A,M))}if(JSON.stringify(R).length>23){let M=null,A=null;for(let z in R.color)R.color[z]>=O/2&&(M=z);for(let z in R.style)R.style[z]>=O/2&&(A=z);M!=null&&A!=null&&(x+="border-top:"+u.getHtmlBorderStyle(A,M))}if(JSON.stringify(I).length>23){let M=null,A=null;for(let z in I.color)I.color[z]>=O/2&&(M=z);for(let z in I.style)I.style[z]>=O/2&&(A=z);M!=null&&A!=null&&(x+="border-bottom:"+u.getHtmlBorderStyle(A,M))}}}else continue;else if(h&&h[y+"_"+b]){if(h[y+"_"+b].l){let T=h[y+"_"+b].l.style,F=h[y+"_"+b].l.color;x+="border-left:"+u.getHtmlBorderStyle(T,F)}if(h[y+"_"+b].r){let T=h[y+"_"+b].r.style,F=h[y+"_"+b].r.color;x+="border-right:"+u.getHtmlBorderStyle(T,F)}if(h[y+"_"+b].b){let T=h[y+"_"+b].b.style,F=h[y+"_"+b].b.color;x+="border-bottom:"+u.getHtmlBorderStyle(T,F)}if(h[y+"_"+b].t){let T=h[y+"_"+b].t.style,F=h[y+"_"+b].t.color;x+="border-top:"+u.getHtmlBorderStyle(T,F)}}w=_e(w,{style:x,span:C}),_==null&&(_=Le(y,b,m)),_==null&&m[y][b]&&m[y][b].ct&&m[y][b].ct.t=="inlineStr"&&(_=m[y][b].ct.s.map(T=>{let F=$('<br style="mso-data-placement:same-cell;">');return T.v.split(`\r
`).map(I=>{if(!I)return"";let P=$("<font></font>");return T.fs&&P.css("font-size",`${T.fs}pt`),T.bl&&P.css("font-weight","bold"),T.it&&P.css("font-style","italic"),T.un&&P.css("text-decoration","underline"),T.fc&&P.css("color",T.fc),T.cl?P.append(`<s>${I}</s>`):P.text(I),P[0].outerHTML}).join(F[0].outerHTML)}).join("")),_==null&&(_=""),_=g.ltGtSignDeal(_),w+=_}else{let x="";if(h&&h[y+"_"+b]){if(h[y+"_"+b].l){let C=h[y+"_"+b].l.style,S=h[y+"_"+b].l.color;x+="border-left:"+u.getHtmlBorderStyle(C,S)}if(h[y+"_"+b].r){let C=h[y+"_"+b].r.style,S=h[y+"_"+b].r.color;x+="border-right:"+u.getHtmlBorderStyle(C,S)}if(h[y+"_"+b].b){let C=h[y+"_"+b].b.style,S=h[y+"_"+b].b.color;x+="border-bottom:"+u.getHtmlBorderStyle(C,S)}if(h[y+"_"+b].t){let C=h[y+"_"+b].t.style,S=h[y+"_"+b].t.color;x+="border-top:"+u.getHtmlBorderStyle(C,S)}}w+="",w=_e(w,{style:x,span:""}),w+=""}w+="</td>",d+=w}d+="</tr>"}}if(d=`<table data-type="luckysheet_copy_action_table"><colgroup>${p}</colgroup>`+d+"</table>",f.iscopyself=!0,n)return n.setData("Text",d),!1;{let v=$("#luckysheet-copy-content");v.html(d),v.focus(),v.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#luckysheet-copy-content").blur()},10)}},copybyformat:function(e,n){let t=window.clipboardData;t||(t=e.originalEvent&&e.originalEvent.clipboardData),f.luckysheet_selection_range=[{row:f.luckysheet_select_save[0].row,column:f.luckysheet_select_save[0].column}],Pt();let l=n;if(f.iscopyself=!0,t)return t.setData("Text",l),!1;{let o=$("#luckysheet-copy-content");o.text(l),o.focus(),o.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){o.blur()},10)}},isPasteAction:!1,paste:function(e,n){let t=this;if(f.allowEdit===!1)return;let o=Q().drag,a=$("#luckysheet-copy-content");a.focus(),a.select(),setTimeout(function(){let s=a.html();s.indexOf("luckysheet_copy_action_table")>-1&&f.luckysheet_copy_save.copyRange!=null&&f.luckysheet_copy_save.copyRange.length>0?f.luckysheet_paste_iscut?(f.luckysheet_paste_iscut=!1,t.pasteHandlerOfCutPaste(f.luckysheet_copy_save),t.clearcopy(e)):t.pasteHandlerOfCopyPaste(f.luckysheet_copy_save):s.indexOf("luckysheet_copy_action_image")>-1?Ie.pasteImgItem():n!="btn"?t.pasteHandler(s):he()?alert(o.pasteMustKeybordAlert):W.info(o.pasteMustKeybordAlertHTMLTitle,o.pasteMustKeybordAlertHTML)},10)},pasteHandler:function(e,n){if(!pr(f.luckysheet_select_save,f.currentSheetIndex)||f.allowEdit===!1)return;let l=Q().paste;if(f.luckysheet_select_save.length>1&&(he()?alert(l.errorNotAllowMulti):W.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMulti)),typeof e=="object"){if(e.length==0)return;let o=$.extend(!0,{},f.config);o.merge==null&&(o.merge={}),JSON.stringify(n).length>2&&o.borderInfo==null&&(o.borderInfo=[]);let a=e.length,s=e[0].length,u=f.luckysheet_select_save[0].row[0],h=u+a-1,d=f.luckysheet_select_save[0].column[0],m=d+s-1,p=!1;if(o.merge!=null&&(p=Dt(o,u,h,d,m)),p){he()?alert(l.errorNotAllowMerged):W.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMerged);return}let v=xe.deepCopyFlowData(f.flowdata),y=v.length,k=v[0].length,b=h-y+1,w=m-k+1;(b>0||w>0)&&(v=cl([].concat(v),b,w,!0)),o.rowlen==null&&(o.rowlen={});let x=!1,C={};for(let S=u;S<=h;S++){let _=[].concat(v[S]),T=f.defaultrowlen;o.rowlen[S]!=null&&(T=o.rowlen[S]);for(let F=d;F<=m;F++){N(_[F])=="object"&&"mc"in _[F]&&("rs"in _[F].mc&&delete o.merge[_[F].mc.r+"_"+_[F].mc.c],delete _[F].mc);let R=null;if(e[S-u]!=null&&e[S-u][F-d]!=null&&(R=e[S-u][F-d]),_[F]=$.extend(!0,{},R),R!=null&&"mc"in _[F]&&(_[F].mc.rs!=null?(_[F].mc.r=S,_[F].mc.c=F,o.merge[_[F].mc.r+"_"+_[F].mc.c]=_[F].mc,C[R.mc.r+"_"+R.mc.c]=[_[F].mc.r,_[F].mc.c]):_[F]={mc:{r:C[R.mc.r+"_"+R.mc.c][0],c:C[R.mc.r+"_"+R.mc.c][1]}}),n[S-u+"_"+(F-d)]){let O={rangeType:"cell",value:{row_index:S,col_index:F,l:n[S-u+"_"+(F-d)].l,r:n[S-u+"_"+(F-d)].r,t:n[S-u+"_"+(F-d)].t,b:n[S-u+"_"+(F-d)].b}};o.borderInfo.push(O)}let I=oi(_[F]),P=be.getTextSize("\u7530",I)[1];P>T&&(T=P,x=!0)}v[S]=_,T!=f.defaultrowlen&&(o.rowlen[S]=T)}if(f.luckysheet_select_save=[{row:[u,h],column:[d,m]}],b>0||w>0||x){let S={cfg:o,RowlChange:!0};Ze(v,f.luckysheet_select_save,S)}else{let S={cfg:o};Ze(v,f.luckysheet_select_save,S),lt()}}else{e=e.replace(/\r/g,"");let o=[],a=e.split(`
`),s=a[0].split("	").length;for(let w=0;w<a.length;w++)a[w].split("	").length<s||o.push(a[w].split("	"));let u=xe.deepCopyFlowData(f.flowdata),h=f.luckysheet_select_save[f.luckysheet_select_save.length-1],d=h.row==null?0:h.row[0],m=h.column==null?0:h.column[0],p=o.length,v=o[0].length,y=!1;if(f.config.merge!=null&&(y=Dt(f.config,d,d+p-1,m,m+v-1)),y){he()?alert(l.errorNotAllowMerged):W.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMerged);return}let k=d+p-u.length,b=m+v-u[0].length;(k>0||b>0)&&(u=cl([].concat(u),k,b,!0));for(let w=0;w<p;w++){let x=[].concat(u[w+d]);for(let C=0;C<v;C++){let S=x[C+m],_=o[w][C];if(B(_)&&(S&&S.ct&&S.ct.fa==="@"?_=String(_):_=parseFloat(_)),S instanceof Object)S.v=_,S.ct!=null&&S.ct.fa!=null?S.m=mt(S.ct.fa,_):S.m=_,S.f!=null&&S.f.length>0&&(S.f="",g.delFunctionGroup(w+d,C+m,f.currentSheetIndex));else{let T={},F=nt(_);T.v=F[2],T.ct=F[1],T.m=F[0],x[C+m]=T}}u[w+d]=x}if(h.row=[d,d+p-1],h.column=[m,m+v-1],k>0||b>0){let w={RowlChange:!0};Ze(u,f.luckysheet_select_save,w)}else Ze(u,f.luckysheet_select_save),lt()}},pasteHandlerOfCutPaste:function(e){if(!pr(f.luckysheet_select_save,f.currentSheetIndex)||f.allowEdit===!1)return;let t=Q().paste,l=$.extend(!0,{},f.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],h=e.copyRange[0].row[1],d=e.copyRange[0].column[0],m=e.copyRange[0].column[1],p=$.extend(!0,[],Bt({row:[u,h],column:[d,m]},s)),v=p.length,y=p[0].length,k=f.luckysheet_select_save[f.luckysheet_select_save.length-1],b=k.row_focus,w=b+v-1,x=k.column_focus,C=x+y-1,S=!1;if(l.merge!=null&&(S=Dt(l,b,w,x,C)),S){he()?alert(t.errorNotAllowMerged):W.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}let _=xe.deepCopyFlowData(f.flowdata),T=_.length,F=_[0].length,R=v+b-T,I=y+x-F;(R>0||I>0)&&(_=cl([].concat(_),R,I,!0));let P=Ur(s),O=$.extend(!0,{},f.luckysheetfile[Z(s)].dataVerification),M=$.extend(!0,{},f.luckysheetfile[Z(f.currentSheetIndex)].dataVerification);if(f.currentSheetIndex==s){for(let E=u;E<=h;E++)for(let V=d;V<=m;V++){let q=_[E][V];N(q)=="object"&&"mc"in q&&("rs"in q.mc&&delete l.merge[q.mc.r+"_"+q.mc.c],delete q.mc),_[E][V]=null,delete M[E+"_"+V]}if(l.borderInfo&&l.borderInfo.length>0){let E=[];for(let V=0;V<l.borderInfo.length;V++){let q=l.borderInfo[V].rangeType;if(q=="range"){let G=l.borderInfo[V].range,X=[];for(let ee=0;ee<G.length;ee++)X=X.concat(Se.CFSplitRange(G[ee],{row:[u,h],column:[d,m]},{row:[b,w],column:[x,C]},"restPart"));l.borderInfo[V].range=X,E.push(l.borderInfo[V])}else if(q=="cell"){let G=l.borderInfo[V].value.row_index,X=l.borderInfo[V].value.col_index;G>=u&&G<=h&&X>=d&&X<=m||E.push(l.borderInfo[V])}}l.borderInfo=E}}let A={};for(let E=b;E<=w;E++){let V=[].concat(_[E]);for(let q=x;q<=C;q++){if(P[u+E-b+"_"+(d+q-x)]){let X={rangeType:"cell",value:{row_index:E,col_index:q,l:P[u+E-b+"_"+(d+q-x)].l,r:P[u+E-b+"_"+(d+q-x)].r,t:P[u+E-b+"_"+(d+q-x)].t,b:P[u+E-b+"_"+(d+q-x)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(X)}else if(P[E+"_"+q]){let X={rangeType:"cell",value:{row_index:E,col_index:q,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(X)}O[u+E-b+"_"+(d+q-x)]&&(M[E+"_"+q]=O[u+E-b+"_"+(d+q-x)]),N(V[q])=="object"&&"mc"in V[q]&&("rs"in V[q].mc&&delete l.merge[V[q].mc.r+"_"+V[q].mc.c],delete V[q].mc);let G=null;p[E-b]!=null&&p[E-b][q-x]!=null&&(G=p[E-b][q-x]),V[q]=$.extend(!0,{},G),G!=null&&o&&"mc"in V[q]&&(V[q].mc.rs!=null?(V[q].mc.r=E,V[q].mc.c=q,l.merge[V[q].mc.r+"_"+V[q].mc.c]=V[q].mc,A[G.mc.r+"_"+G.mc.c]=[V[q].mc.r,V[q].mc.c]):V[q]={mc:{r:A[G.mc.r+"_"+G.mc.c][0],c:A[G.mc.r+"_"+G.mc.c][1]}})}_[E]=V}k.row=[b,w],k.column=[x,C],a&&(f.currentSheetIndex!=s?l=pl(_,b,w,l):(l=pl(_,u,h,l),l=pl(_,b,w,l)));let z,L;if(f.currentSheetIndex!=s){let E=$.extend(!0,[],f.luckysheetfile[Z(s)].data),V=$.extend(!0,{},f.luckysheetfile[Z(s)].config),q=$.extend(!0,[],E),G=$.extend(!0,{},V);G.merge==null&&(G.merge={});for(let ue=u;ue<=h;ue++)for(let fe=d;fe<=m;fe++){let ce=q[ue][fe];N(ce)=="object"&&"mc"in ce&&("rs"in ce.mc&&delete G.merge[ce.mc.r+"_"+ce.mc.c],delete ce.mc),q[ue][fe]=null}if(a&&(G=pl(q,u,h,G)),G.borderInfo&&G.borderInfo.length>0){let ue=[];for(let fe=0;fe<G.borderInfo.length;fe++){let ce=G.borderInfo[fe].rangeType;if(ce=="range"){let K=G.borderInfo[fe].range,U=[];for(let te=0;te<K.length;te++)U=U.concat(Se.CFSplitRange(K[te],{row:[u,h],column:[d,m]},{row:[b,w],column:[x,C]},"restPart"));G.borderInfo[fe].range=U,ue.push(G.borderInfo[fe])}else if(ce=="cell"){let K=G.borderInfo[fe].value.row_index,U=G.borderInfo[fe].value.col_index;K>=u&&K<=h&&U>=d&&U<=m||ue.push(G.borderInfo[fe])}}G.borderInfo=ue}let X=$.extend(!0,[],f.luckysheetfile[Z(s)].luckysheet_conditionformat_save),ee=$.extend(!0,[],X),le=[];if(ee!=null&&ee.length>0)for(let ue=0;ue<ee.length;ue++){let fe=ee[ue].cellrange,ce=[],K=[];for(let U=0;U<fe.length;U++){let te=Se.CFSplitRange(fe[U],{row:[u,h],column:[d,m]},{row:[b,w],column:[x,C]},"restPart");ce=ce.concat(te);let ge=Se.CFSplitRange(fe[U],{row:[u,h],column:[d,m]},{row:[b,w],column:[x,C]},"operatePart");ge.length>0&&(K=K.concat(ge))}if(ee[ue].cellrange=ce,K.length>0){let U=$.extend(!0,{},ee[ue]);U.cellrange=K,le.push(U)}}let se=$.extend(!0,[],f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save),ae=$.extend(!0,[],se);le.length>0&&(ae=ae.concat(le));for(let ue=u;ue<=h;ue++)for(let fe=d;fe<=m;fe++)delete O[ue+"_"+fe];z={sheetIndex:s,data:E,curData:q,config:V,curConfig:G,cdformat:X,curCdformat:ee,dataVerification:$.extend(!0,{},f.luckysheetfile[Z(s)].dataVerification),curDataVerification:O,range:{row:[u,h],column:[d,m]}},L={sheetIndex:f.currentSheetIndex,data:f.flowdata,curData:_,config:$.extend(!0,{},f.config),curConfig:l,cdformat:se,curCdformat:ae,dataVerification:$.extend(!0,{},f.luckysheetfile[Z(f.currentSheetIndex)].dataVerification),curDataVerification:M,range:{row:[b,w],column:[x,C]}}}else{let E=$.extend(!0,[],f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save),V=$.extend(!0,[],E);if(V!=null&&V.length>0)for(let q=0;q<V.length;q++){let G=V[q].cellrange,X=[];for(let ee=0;ee<G.length;ee++){let le=Se.CFSplitRange(G[ee],{row:[u,h],column:[d,m]},{row:[b,w],column:[x,C]},"allPart");X=X.concat(le)}V[q].cellrange=X}z={sheetIndex:f.currentSheetIndex,data:f.flowdata,curData:_,config:$.extend(!0,{},f.config),curConfig:l,cdformat:E,curCdformat:V,dataVerification:$.extend(!0,{},f.luckysheetfile[Z(f.currentSheetIndex)].dataVerification),curDataVerification:M,range:{row:[u,h],column:[d,m]}},L={sheetIndex:f.currentSheetIndex,data:f.flowdata,curData:_,config:$.extend(!0,{},f.config),curConfig:l,cdformat:E,curCdformat:V,dataVerification:$.extend(!0,{},f.luckysheetfile[Z(f.currentSheetIndex)].dataVerification),curDataVerification:M,range:{row:[b,w],column:[x,C]}}}R>0||I>0?ji(z,L,!0):ji(z,L,a)},pasteHandlerOfCopyPaste:function(e){if(!pr(f.luckysheet_select_save,f.currentSheetIndex))return;let t=Q().paste,l=$.extend(!0,{},f.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],h=e.copyRange[0].row[1],d=e.copyRange[0].column[0],m=e.copyRange[0].column[1],p=[],v=!1;for(let ae=0;ae<e.copyRange.length;ae++){let ue=Bt({row:e.copyRange[ae].row,column:e.copyRange[ae].column},s);e.copyRange.length>1?u==e.copyRange[1].row[0]&&h==e.copyRange[1].row[1]?(ue=ue[0].map(function(fe,ce){return ue.map(function(K){return K[ce]})}),p=p.concat(ue),v=!0):d==e.copyRange[1].column[0]&&m==e.copyRange[1].column[1]&&(p=p.concat(ue)):p=ue}v&&(p=p[0].map(function(ae,ue){return p.map(function(fe){return fe[ue]})}));let y=$.extend(!0,[],p);if(e.copyRange.length>1)for(let ae=0;ae<y.length;ae++)for(let ue=0;ue<y[ae].length;ue++)y[ae][ue]!=null&&y[ae][ue].f!=null&&(delete y[ae][ue].f,delete y[ae][ue].spl);let k=y.length,b=y[0].length,w=f.luckysheet_select_save[f.luckysheet_select_save.length-1],x=w.row[0],C=w.row[1],S=w.column[0],_=w.column[1],T=(C-x+1)%k,F=(_-S+1)%b;(T!=0||F!=0)&&(C=x+k-1,_=S+b-1);let R=!1;if(l.merge!=null&&(R=Dt(l,x,C,S,_)),R){he()?alert(t.errorNotAllowMerged):W.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}let I=(C-x+1)/k,P=(_-S+1)/b,O=xe.deepCopyFlowData(f.flowdata),M=O.length,A=O[0].length,z=k+x-M,L=b+S-A;(z>0||L>0)&&(O=cl([].concat(O),z,L,!0));let E=Ur(s),V=$.extend(!0,{},f.luckysheetfile[Z(s)].dataVerification),q=null,G=0,X=0,ee=0,le=0;for(let ae=1;ae<=I;ae++)for(let ue=1;ue<=P;ue++){G=x+(ae-1)*k,X=S+(ue-1)*b,le=x+ae*k,ee=S+ue*b;let fe=G-u,ce=X-d,K={};for(let U=G;U<le;U++){let te=[].concat(O[U]);for(let ge=X;ge<ee;ge++){if(E[u+U-G+"_"+(d+ge-X)]){let $e={rangeType:"cell",value:{row_index:U,col_index:ge,l:E[u+U-G+"_"+(d+ge-X)].l,r:E[u+U-G+"_"+(d+ge-X)].r,t:E[u+U-G+"_"+(d+ge-X)].t,b:E[u+U-G+"_"+(d+ge-X)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push($e)}else if(E[U+"_"+ge]){let $e={rangeType:"cell",value:{row_index:U,col_index:ge,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push($e)}V[u+U-G+"_"+(d+ge-X)]&&(q==null&&(q=$.extend(!0,{},f.luckysheetfile[Z(f.currentSheetIndex)].dataVerification)),q[U+"_"+ge]=V[u+U-G+"_"+(d+ge-X)]),N(te[ge])=="object"&&"mc"in te[ge]&&("rs"in te[ge].mc&&delete l.merge[te[ge].mc.r+"_"+te[ge].mc.c],delete te[ge].mc);let ie=null;if(y[U-G]!=null&&y[U-G][ge-X]!=null&&(ie=$.extend(!0,{},y[U-G][ge-X])),ie!=null&&ie.f!=null){let $e=ie.f;fe>0&&($e="="+g.functionCopy($e,"down",fe)),fe<0&&($e="="+g.functionCopy($e,"up",Math.abs(fe))),ce>0&&($e="="+g.functionCopy($e,"right",ce)),ce<0&&($e="="+g.functionCopy($e,"left",Math.abs(ce)));let oe=g.execfunction($e,U,ge,void 0,!0);ie.spl!=null?(ie.f=oe[2],ie.v=oe[1],ie.spl=oe[3].data):(ie.f=oe[2],ie.v=oe[1],ie.ct!=null&&ie.ct.fa!=null&&(ie.m=mt(ie.ct.fa,oe[1])))}te[ge]=$.extend(!0,{},ie),ie!=null&&o&&"mc"in te[ge]&&(te[ge].mc.rs!=null?(te[ge].mc.r=U,te[ge].mc.c=ge,l.merge[te[ge].mc.r+"_"+te[ge].mc.c]=te[ge].mc,K[ie.mc.r+"_"+ie.mc.c]=[te[ge].mc.r,te[ge].mc.c]):te[ge]={mc:{r:K[ie.mc.r+"_"+ie.mc.c][0],c:K[ie.mc.r+"_"+ie.mc.c][1]}})}O[U]=te}}let se=null;if(e.copyRange.length==1){let ae=f.luckysheetfile[Z(s)],ue=f.luckysheetfile[Z(f.currentSheetIndex)],fe=$.extend(!0,[],ae.luckysheet_conditionformat_save);if(fe!=null&&fe.length>0){se=$.extend(!0,[],ue.luckysheet_conditionformat_save);for(let ce=0;ce<fe.length;ce++){let K=fe[ce].cellrange,U=[];for(let te=1;te<=I;te++)for(let ge=1;ge<=P;ge++){G=x+(te-1)*k,X=S+(ge-1)*b,le=x+te*k,ee=S+ge*b;for(let ie=0;ie<K.length;ie++){let $e=Se.CFSplitRange(K[ie],{row:[u,h],column:[d,m]},{row:[G,le-1],column:[X,ee-1]},"operatePart");$e.length>0&&(U=U.concat($e))}}U.length>0&&(fe[ce].cellrange=U,se.push(fe[ce]))}}}if(w.row=[x,C],w.column=[S,_],a||z>0||L>0){l=pl(O,x,C,l);let ae={cfg:l,RowlChange:!0,cdformat:se,dataVerification:q};Ze(O,f.luckysheet_select_save,ae)}else{let ae={cfg:l,cdformat:se,dataVerification:q};Ze(O,f.luckysheet_select_save,ae),lt()}},pasteHandlerOfPaintModel:function(e){if(!pr(f.luckysheet_select_save,f.currentSheetIndex))return;let t=Q().paste,l=$.extend(!0,{},f.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],h=e.copyRange[0].row[1],d=e.copyRange[0].column[0],m=e.copyRange[0].column[1],p=$.extend(!0,[],Bt({row:[u,h],column:[d,m]},s)),v=f.luckysheet_select_save[f.luckysheet_select_save.length-1],y=v.row[0],k=v.row[1],b=v.column[0],w=v.column[1],x=p.length,C=p[0].length;if(y==k&&b==w){let q=!1;if(l.merge!=null&&(q=Dt(l,y,y+x-1,b,b+C-1)),q){he()?alert(t.errorNotAllowMerged):W.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}k=y+x-1,w=b+C-1}let S=Math.ceil((k-y+1)/x),_=Math.ceil((w-b+1)/C),T=xe.deepCopyFlowData(f.flowdata),F=T[0].length,R=T.length,I=Ur(s),P=$.extend(!0,{},f.luckysheetfile[Z(s)].dataVerification),O=null,M=0,A=0,z=0,L=0;for(let q=1;q<=S;q++)for(let G=1;G<=_;G++){M=y+(q-1)*x,A=b+(G-1)*C,L=y+q*x>R?R:y+q*x,L>k+1&&(L=k+1),z=b+G*C>F?F:b+G*C,z>w+1&&(z=w+1);let X={};for(let ee=M;ee<L;ee++){let le=[].concat(T[ee]);for(let se=A;se<z;se++){if(I[u+ee-M+"_"+(d+se-A)]){let ue={rangeType:"cell",value:{row_index:ee,col_index:se,l:I[u+ee-M+"_"+(d+se-A)].l,r:I[u+ee-M+"_"+(d+se-A)].r,t:I[u+ee-M+"_"+(d+se-A)].t,b:I[u+ee-M+"_"+(d+se-A)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(ue)}else if(I[ee+"_"+se]){let ue={rangeType:"cell",value:{row_index:ee,col_index:se,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(ue)}P[u+ee-M+"_"+(d+se-A)]&&(O==null&&(O=$.extend(!0,{},f.luckysheetfile[Z(f.currentSheetIndex)].dataVerification)),O[ee+"_"+se]=P[u+ee-M+"_"+(d+se-A)]),N(le[se])=="object"&&"mc"in le[se]&&("rs"in le[se].mc&&delete l.merge[le[se].mc.r+"_"+le[se].mc.c],delete le[se].mc);let ae=null;if(p[ee-M]!=null&&p[ee-M][se-A]!=null&&(ae=p[ee-M][se-A]),ae!=null&&(delete ae.v,delete ae.m,delete ae.f,delete ae.spl,ae.ct&&ae.ct.t=="inlineStr"&&delete ae.ct,N(le[se])=="object"?le[se].ct&&le[se].ct.t==="inlineStr"?delete ae.ct:["bg","fc","ct","ht","vt","bl","it","cl","un","fs","ff","tb"].forEach(fe=>{Reflect.deleteProperty(le[se],fe)}):le[se]={v:le[se]},le[se]=$.extend(!0,le[se],ae),le[se].ct&&le[se].ct.t==="inlineStr"&&le[se].ct.s.forEach(ue=>ue=$.extend(!0,ue,ae)),o&&"mc"in le[se]&&(le[se].mc.rs!=null?(le[se].mc.r=ee,le[se].mc.rs+ee>=L&&(le[se].mc.rs=L-ee),le[se].mc.c=se,le[se].mc.cs+se>=z&&(le[se].mc.cs=z-se),l.merge[le[se].mc.r+"_"+le[se].mc.c]=le[se].mc,X[ae.mc.r+"_"+ae.mc.c]=[le[se].mc.r,le[se].mc.c]):le[se]={mc:{r:X[ae.mc.r+"_"+ae.mc.c][0],c:X[ae.mc.r+"_"+ae.mc.c][1]}}),le[se].v!=null&&ae.ct!=null&&ae.ct.fa!=null)){let ue=mt(ae.ct.fa,le[se].v);le[se].m=ue}}T[ee]=le}}let E=null,V=$.extend(!0,[],f.luckysheetfile[Z(s)].luckysheet_conditionformat_save);if(V!=null&&V.length>0){E=$.extend(!0,[],f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save);for(let q=0;q<V.length;q++){let G=V[q].cellrange,X=[];for(let ee=0;ee<G.length;ee++){let le=Se.CFSplitRange(G[ee],{row:[u,h],column:[d,m]},{row:[y,k],column:[b,w]},"operatePart");le.length>0&&(X=X.concat(le))}X.length>0&&(V[q].cellrange=[{row:[y,k],column:[b,w]}],E.push(V[q]))}}if(v.row=[y,k],v.column=[b,w],a){l=pl(T,y,k,l);let q={cfg:l,RowlChange:!0,cdformat:E,dataVerification:O};Ze(T,f.luckysheet_select_save,q)}else{k>=T.length&&(k=T.length-1),l=pl(T,y,k,l);let q={cfg:l,RowlChange:!0,cdformat:E,dataVerification:O};Ze(T,f.luckysheet_select_save,q),lt()}},matchcopy:function(e,n){let t=[],l=[],o,a;if(typeof e=="object")t=e;else{t=e.split(`
`);for(let s=0;s<t.length;s++)t[s]=t[s].split("	")}if(o=t.length,typeof n=="object")l=n;else{l=n.split(`
`);for(let s=0;s<l.length;s++)l[s]=l[s].split("	")}if(a=l.length,o!=a)return!1;for(let s=0;s<o;s++)if(!(f.config.rowhidden!=null&&f.config.rowhidden[s]!=null)){for(let u=0;u<a;u++)if(t[s].length!=l[u].length)return!1}for(let s=0;s<o;s++)if(!(f.config.rowhidden!=null&&f.config.rowhidden[s]!=null)){for(let u=0;u<t[0].length;u++)if(Le(s,u,t)!=Le(s,u,l))return!1}return!0}},wt=zv});function rl(e){$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cell-selected-boxs .luckysheet-cell-selected").hide(),$("#luckysheet-cols-h-selected .luckysheet-cols-h-selected").hide(),$("#luckysheet-rows-h-selected .luckysheet-rows-h-selected").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),e||wt.clearcopy(e),$("#luckysheet-dropCell-icon").is(":visible")&&e&&$("#luckysheet-dropCell-icon").remove(),be.luckysheetPaintModelOn&&!e&&be.cancelPaintModel()}var Vr=Me(()=>{Wi();ol()});function ic(e,n,t,l,o){let a=Qc();a=_e(a,{logotitle:o}),a=_e(a,{menu:gu()});let s=eu;f.config==null&&(f.config={}),gn(n,e);let h=Q().info,d='<button id="luckysheet-bottom-add-row" class="btn btn-default">'+h.add+'</button><input id="luckysheet-bottom-add-row-input" type="text" class="luckysheet-datavisual-config-input luckysheet-mousedown-cancel" placeholder="'+(de.addRowCount||100)+'"><span style="font-size: 14px;">'+h.row+'</span><span style="font-size: 14px;color: #9c9c9c;">('+h.addLast+")</span>",m=' <button id="luckysheet-bottom-bottom-top" class="btn btn-default" style="">'+h.backTop+"</button>",p=_e(h.pageInfo,{total:de.total?de.total:"",totalPage:de.pageInfo.totalPage?de.pageInfo.totalPage:"",currentPage:de.pageInfo.currentPage?de.pageInfo.currentPage:""}),v=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">'+p+'</span> <button id="luckysheet-bottom-page-next" class="btn btn-danger" style="">\u4E0B\u4E00\u9875</button>',y=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">'+p+"</span>",k="";de.enableAddRow&&(k+=d),de.enablePage&&(parseInt(de.pageInfo.totalPage)==1?k+=y:k+=v),de.enableAddBackTop&&(k+=m);let b=_e('<div id="luckysheetcoltable_0" class="luckysheet-cell-flow-col"> <div id ="luckysheet-sheettable_0" class="luckysheet-cell-sheettable" style="height:${height}px;width:${width}px;"></div><div id="luckysheet-bottom-controll-row" class="luckysheet-bottom-controll-row"> '+k+" </div> </div>",{height:f.rh_height,width:f.ch_width-1}),w=_e(iu,{width:f.ch_width,index:0,column:""});s=_e(s,{width:f.ch_width,flow:b,index:0}),a=_e(a,{flow:s,rowHeader:"<div style='height:"+f.rh_height+"px' id='luckysheetrowHeader_0' class='luckysheetsheetchange'></div>",columnHeader:w,functionButton:de.functionButton}),$("#"+f.container).append(a),$("#luckysheet-scrollbar-x div").width(f.ch_width),$("#luckysheet-scrollbar-y div").height(f.rh_height+f.columnHeaderHeight-f.cellMainSrollBarSize-3),$("body").append(cu),$("body").append(tu),$("body").append(lu()),$("body").append(su),$("body").append(_e(jo(),{menuid:"filter"})),$("body").append(_e(Wo(),{menuid:"filter"})),$("body").append(uu()),$("#luckysheet-rows-h").width(f.rowHeaderWidth-1.5),$("#luckysheet-cols-h-c").height(f.columnHeaderHeight-1.5),$("#luckysheet-left-top").css({width:f.rowHeaderWidth-1.5,height:f.columnHeaderHeight-1.5}),$("#luckysheet_info_detail_input").val(de.title)}var ld=Me(()=>{Wt();xl();Wr();Kt();Jt();To();ht();Ke();kt()});function wn(e){f.flowdata==null||f.flowdata.length==0||(clearTimeout(rd),rd=setTimeout(()=>{f.clearjfundo&&f.jfredo.push({type:"zoomChange",zoomRatio:f.zoomRatio,curZoomRatio:e,sheetIndex:f.currentSheetIndex}),Gr=null,f.zoomRatio=e;let n=ye.getSheetByIndex();He.buildAllPs(n.data),Ie.images=n.images,Ie.allImagesShow(),Ie.init(),n.config==null&&(n.config={}),n.config.sheetViewZoom==null&&(n.config.sheetViewZoom={});let t=n.config.curentsheetView;t==null&&(t="viewNormal"),n.config.sheetViewZoom[t+"ZoomScale"]=e,ne.saveParam("all",f.currentSheetIndex,f.zoomRatio,{k:"zoomRatio"}),ne.saveParam("cg",f.currentSheetIndex,n.config.sheetViewZoom,{k:"sheetViewZoom"}),Ui()},100))}function Ui(){Ct(f.flowdata.length,f.flowdata[0].length),Hs()}function nd(){let e=.02,n=.1,t=4,l=.1;$("#luckysheet-zoom-minus").click(function(){let o;f.zoomRatio==null?o=f.zoomRatio=1:o=Math.ceil(f.zoomRatio*10)/10,o=o-n,o==f.zoomRatio&&(o=o-n),o<=l&&(o=l),wn(o),ir(o)}),$("#luckysheet-zoom-plus").click(function(){let o;f.zoomRatio==null?o=f.zoomRatio=1:o=Math.floor(f.zoomRatio*10)/10,o=o+n,o==f.zoomRatio&&(o=o+n),o>=t&&(o=t),wn(o),ir(o)}),$("#luckysheet-zoom-slider").mousedown(function(o){let a=$(this).offset().left,s=o.pageX,u=id(s-a);wn(u),ir(u)}),$("#luckysheet-zoom-cursor").mousedown(function(o){let a=o.pageX,s=parseFloat($("#luckysheet-zoom-cursor").css("left"));$("#luckysheet-zoom-cursor").css("transition","none"),$(document).off("mousemove.zoomCursor").on("mousemove.zoomCursor",function(u){let d=u.pageX-a,m=s+d,p=id(m);p>t&&(p=t,m=100),p<l&&(p=l,m=0),wn(p);let v=Math.round(p*100)+"%";$("#luckysheet-zoom-ratioText").html(v),$("#luckysheet-zoom-cursor").css("left",m-4)}),$(document).off("mouseup.zoomCursor").on("mouseup.zoomCursor",function(u){$(document).off(".zoomCursor"),$("#luckysheet-zoom-cursor").css("transition","all 0.3s")}),o.stopPropagation()}).click(function(o){o.stopPropagation()}),$("#luckysheet-zoom-ratioText").click(function(){wn(1),ir(1)}),ir(f.zoomRatio),Gr=null,document.addEventListener("wheel",function(o){!o.ctrlKey||!o.deltaY||(Gr===null&&(Gr=f.zoomRatio||1),Gr+=o.deltaY<0?e:-e,Gr>=t?Gr=t:Gr<l&&(Gr=l),wn(Gr),ir(Gr),o.preventDefault(),o.stopPropagation())},{capture:!0,passive:!1}),document.addEventListener("keydown",function(o){if(!o.ctrlKey)return;let a=!1,s=f.zoomRatio||1;o.key==="-"||o.which===189?(s-=n,a=!0):o.key==="+"||o.which===187?(s+=n,a=!0):(o.key==="0"||o.which===48)&&(s=1,a=!0),a&&(o.preventDefault(),s>=t?s=t:s<l&&(s=l),wn(s),ir(s))},{capture:!0})}function id(e){let n=1;return e<50?n=Math.round((e*1.8/100+.1)*100)/100:e>50&&(n=Math.round(((e-50)*6/100+1)*100)/100),n}function Pv(e){let n=50;e<1?n=Math.round((e-.1)*100/.18)/10:e>1&&(n=Math.round((e-1)*100/.6)/10+50),$("#luckysheet-zoom-cursor").css("left",n-4)}function ir(e){let n=Math.round(e*100)+"%";$("#luckysheet-zoom-ratioText").html(n),Pv(e)}var rd,Gr,Gi=Me(()=>{Ke();kt();ht();dl();Br();Yt();Qt();Wr();qr();rd=null;Gr=null});var Nv,ye,dl=Me(()=>{Nt();Vr();Kt();$r();ld();ll();Ut();Yt();To();Jt();hi();Nt();ht();Wt();Qt();xl();nn();Br();Wr();qr();gr();qi();Hl();yn();Zt();Ke();kt();Br();Gi();ol();Nl();Nv={generateRandomSheetIndex:function(e){e==null&&(e="Sheet");let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="";for(let o=0;o<12;o++)t+=n[Math.round(Math.random()*(n.length-1))];let l=new Date().getTime();return e+"_"+t+"_"+l},generateRandomSheetName:function(e,n){let t=e.length,o=Q().pivotTable.title;for(let a=0;a<e.length;a++)if(e[a].name.indexOf("Sheet")>-1||e[a].name.indexOf(o)>-1){let s=parseFloat(e[a].name.replace("Sheet","").replace(o,""));s!="NaN"&&Math.ceil(s)>t&&(t=Math.ceil(s))}return n?o+(t+1):"Sheet"+(t+1)},generateCopySheetName:function(e,n){let l=Q().info,o="("+l.copy,a=n.toString().indexOf(o);~a&&(n=n.toString().substring(0,a));let s="",u=n+o,h=[];for(let m=0;m<e.length;m++){let p=e[m].name.toString();h.push(p);let v=p.indexOf(u);if(v===0){s=s||2;let y=p.indexOf(")",v+u.length),k=p.substring(v+u.length,y);B(k)&&parseInt(k)>=s&&(s=parseInt(k)+1)}}let d;do{let m=o+s+")",p=31-m.length;d=n,d.length>p&&(d=d.slice(0,p-1)+"\u2026"),d=d+m}while(~h.indexOf(d)&&(s=(s||1)+1));return d},getSheetByIndex:function(e){let n=this;e==null&&(e=f.currentSheetIndex);let t=n.getSheetIndex(e);return f.luckysheetfile[t]},getSheetByName:function(e){let n=this;if(e==null)return null;for(let t=0;t<f.luckysheetfile.length;t++){let l=f.luckysheetfile[t];if(l.name==e)return l}return null},getCurSheetnoset:function(){let e=0;for(let n=0;n<f.luckysheetfile.length;n++)if(f.luckysheetfile[n].status==1){e=f.luckysheetfile[n].index;break}return e},getCurSheet:function(){if(f.luckysheetfile.length){let e=!1,n=[];f.luckysheetfile.forEach(t=>{typeof t.index=="undefined"&&(t.index=this.generateRandomSheetIndex()),n.includes(t.index)?t.index=this.generateRandomSheetIndex():n.push(t.index),typeof t.status=="undefined"&&(t.status=0),t.status==1&&(e?t.status=0:e=!0)}),e||(f.luckysheetfile[0].status=1)}f.currentSheetIndex=f.luckysheetfile[0].index;for(let e=0;e<f.luckysheetfile.length;e++)if(f.luckysheetfile[e].status==1){f.currentSheetIndex=f.luckysheetfile[e].index;break}return f.currentSheetIndex},addNewSheet:function(e,n){if(he()||f.allowEdit===!1||!Je.createHookFunction("sheetCreateBefore"))return;let t=this,l=f.luckysheetfile.length,o=t.generateRandomSheetIndex(),a=t.generateRandomSheetName(f.luckysheetfile,n);$("#luckysheet-sheet-container-c").append(_e(Ql,{index:o,active:"",name:a,style:"",colorset:""}));let s={name:a,color:"",status:"0",order:l,index:o,celldata:[],row:f.defaultrowNum,column:f.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!!n};if(f.luckysheetfile.push(s),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+o).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>'),rl(e),ne.saveParam("sha",null,$.extend(!0,{},s)),f.clearjfundo){f.jfundo.length=0;let u={};u.type="addSheet",u.sheetconfig=$.extend(!0,{},s),u.index=o,u.currentSheetIndex=f.currentSheetIndex,f.jfredo.push(u)}t.changeSheetExec(o,n,!0)},setSheetHide:function(e,n){let t=this,l=t.getSheetIndex(e);if(!n&&!Je.createHookFunction("sheetHideBefore",{sheet:f.luckysheetfile[l]}))return;f.luckysheetfile[l].hide=1;let o=$("#luckysheet-sheets-item"+e);o.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");let a;if(de.showsheetbarConfig.sheet)a=o.nextAll(":visible"),o.nextAll(":visible").length>0?a=a.eq(0).data("index"):a=o.prevAll(":visible").eq(0).data("index");else{let s,u=[];f.luckysheetfile.forEach((d,m)=>{d.hide!==1&&u.push(m)});let h=u.length;h===1?s=u[0]:s=u[h-1]>l?u.find(d=>d>l):u[h-1],a=f.luckysheetfile[s].index}$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),t.changeSheetExec(a),t.locationSheet(),ne.saveParam("sh",o.data("index"),1,{op:"hide",cur:a}),n||Je.createHookFunction("sheetHideAfter",{sheet:f.luckysheetfile[l]})},setSheetShow:function(e){let n=this,t=f.luckysheetfile[n.getSheetIndex(e)];!Je.createHookFunction("sheetShowBefore",{sheet:t})||(t.hide=0,n.changeSheetExec(e),ne.saveParam("sh",e,0,{op:"show",cur:null}),Je.createHookFunction("sheetShowAfter",{sheet:t}))},sheetMaxIndex:0,ordersheet:function(e){return function(n,t){let l=n[e],o=t[e];return l-o}},getCurrentOrder:function(){let e={};return $("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(n){let t=$(this).data("index");for(let l=0;l<f.luckysheetfile.length;l++)if(f.luckysheetfile[l].index==t){e[t.toString()]=n;break}}),e},reOrderAllSheet:function(){let e={};$("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(n){let t=$(this).data("index");for(let l=0;l<f.luckysheetfile.length;l++)if(f.luckysheetfile[l].index==t){f.luckysheetfile[l].order=n,e[t.toString()]=n;break}}),ne.saveParam("shr",null,e),f.luckysheetfile.sort((n,t)=>{let l=n.order,o=t.order;return l!=null&&o!=null?l-o:l!=null?-1:(o!=null,1)})},createSheet:function(){let e=this,n=[];f.luckysheetfile.sort(e.ordersheet("order"));for(let t=0;t<f.luckysheetfile.length;t++){let l="",o=f.luckysheetfile[t].index,a="";f.luckysheetfile[t].color!=null&&(a='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+f.luckysheetfile[t].color+';"></div>'),f.currentSheetIndex==o?n.push(_e(Ql,{index:o,active:"luckysheet-sheets-item-active",name:f.luckysheetfile[t].name,style:"",colorset:a})):(f.luckysheetfile[t].hide==1?n.push(_e(Ql,{index:o,active:"",name:f.luckysheetfile[t].name,style:"display:none;",colorset:a})):n.push(_e(Ql,{index:o,active:"",name:f.luckysheetfile[t].name,style:"",colorset:a})),l="style='display:none;'"),$("#luckysheet-cell-main").append("<div "+l+' id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>')}$("#luckysheet-sheet-container-c").append(n.join("")),e.locationSheet()},locationSheet:function(){let e=$("#luckysheet-sheet-container-c"),n=$("#"+f.container).width(),t=$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item-active").eq(0),l=0,o=0;$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item:visible").each(function(){$(this).hasClass("luckysheet-sheets-item-active")&&(l=o),o+=$(this).outerWidth()}),setTimeout(function(){e.scrollLeft(l-10),de.showsheetbarConfig.sheet&&(o>=n*.7?($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show()):($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","none"),$("#luckysheet-sheet-container .docs-sheet-fade-left").hide()))},1)},copySheet:function(e,n){if(he()||f.allowEdit===!1)return;let t=this,l=f.luckysheetfile.length,o=t.generateRandomSheetIndex(),a=t.getSheetIndex(e),s=$.extend(!0,{},f.luckysheetfile[a]);if(s.order=l,s.index=o,s.name=t.generateCopySheetName(f.luckysheetfile,s.name),!Je.createHookFunction("sheetCopyBefore",{targetSheet:f.luckysheetfile[a],copySheet:s}))return;let u="";s.color!=null&&(u='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+s.color+';"></div>');let h=$("#luckysheet-sheets-item"+e);if($("#luckysheet-sheet-container-c").append(_e(Ql,{index:s.index,active:"",name:s.name,order:s.order,style:"",colorset:u})),$("#luckysheet-sheets-item"+s.index).insertAfter(h),f.luckysheetfile.splice(a+1,0,s),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+o).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>'),rl(n),ne.saveParam("shc",o,{copyindex:e,name:s.name}),t.changeSheetExec(o,void 0,void 0,!0),t.reOrderAllSheet(),f.clearjfundo)f.jfredo.push({type:"copySheet",copyindex:e,index:s.index,sheetIndex:s.index});else if(f.jfredo.length>0){let d=f.jfredo[f.jfredo.length-1];d.type=="copySheet"&&(d.index=s.index,d.sheetIndex=s.index)}},hasSheet:function(e){return!(e==null||(e=this.getSheetIndex(e),e==null))},createSheetbydata:function(e,n,t=!0){let l=this,o="";if(e.color!=null&&(o='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),$("#luckysheet-sheet-container-c").append(_e(Ql,{index:e.index,active:"",name:e.name,order:e.order,style:"",colorset:o})),t){let a=e.order;a>=f.luckysheetfile.length?(a=f.luckysheetfile.length-1,$("#luckysheet-sheets-item"+e.index).insertAfter($("#luckysheet-sheets-item"+f.luckysheetfile[a].index))):$("#luckysheet-sheets-item"+e.index).insertBefore($("#luckysheet-sheets-item"+f.luckysheetfile[a].index))}f.luckysheetfile.push(e),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+e.index).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+e.index+'" class="luckysheet-datavisual-selection-set"></div>'),rl(),n!=null?(ne.saveParam("shre",null,{reIndex:e.index}),e.hide=0,ne.saveParam("sh",e.index,0,{op:"show",cur:null})):ne.saveParam("sha",null,e),l.changeSheetExec(e.index,e.isPivotTable,!0),l.reOrderAllSheet()},deleteSheet:function(e){let n=this;if(f.allowEdit===!1)return;let t=n.getSheetIndex(e),l=f.luckysheetfile[t];if(!Je.createHookFunction("sheetDeleteBefore",{sheet:l}))return;n.setSheetHide(e,!0),$("#luckysheet-sheets-item"+e).remove(),$("#luckysheet-datavisual-selection-set-"+e).remove();let o=f.luckysheetfile.splice(t,1);n.reOrderAllSheet(),ne.saveParam("shd",null,{deleIndex:e}),f.clearjfundo&&(o[0].type="deleteSheet",f.jfredo.push(o[0])),Je.createHookFunction("sheetDeleteAfter",{sheet:l})},nulldata:null,getGridData:function(e){let n=[];for(let t=0;t<e.length;t++)for(let l=0;l<e[0].length;l++)e[t][l]!=null&&n.push({r:t,c:l,v:e[t][l]});return n},buildGridData:function(e){let n=e.row==null?f.defaultrowNum:e.row,t=e.column==null?f.defaultcolumnNum:e.column,l=e.data&&e.data.length>0?e.data:cl([],n,t),o=e.celldata;if(e.data&&e.data.length>0)for(let a=0;a<l.length;a++)for(let s=0;s<l[0].length;s++)Ht(a,s,l,l[a][s]);else if(o&&o.length>0)for(let a=0;a<o.length;a++){let s=o[a],u=s.r,h=s.c,d=s.v;u>=l.length&&(l=cl(l,u-l.length+1,0)),h>=l[0].length&&(l=cl(l,0,h-l[0].length+1)),Ht(u,h,l,d)}return de.autoFormatw=!1,de.accuracy=void 0,l},cutGridData:function(e){let n=0;for(let t=e.length-1;t>=0;t--){let l=!0;for(let o=0;o<e[0].length;o++){let a=Le(t,o);if(a!=null&&$.trim(a).length>0){l=!1;break}}if(l)n=t;else break}return e.slice(0,n)},addGridData:function(e,n,t){let l=cl([],n,t);if(e!=null)for(let o=0;o<e.length;o++){let a=e[o],s=a.r,u=a.c,h=a.v;s>=l.length&&(l=cl(l,s-l.length+1,0)),u>=l[0].length&&(l=cl(l,0,u-l[0].length+1)),Ht(s,u,l,h)}return l},sheetParamRestore:function(e,n){if(f.luckysheet_select_save=e.luckysheet_select_save,(f.luckysheet_select_save==null||f.luckysheet_select_save.length==0)&&(n[0]!=null&&n[0][0]!=null&&n[0][0].mc!=null?f.luckysheet_select_save=[{row:[0,n[0][0].mc.rs-1],column:[0,n[0][0].mc.cs-1]}]:f.luckysheet_select_save=[{row:[0,0],column:[0,0]}]),f.luckysheet_selection_range=e.luckysheet_selection_range==null?[]:e.luckysheet_selection_range,f.config=e.config==null?{}:e.config,f.zoomRatio=e.zoomRatio==null?1:e.zoomRatio,e.defaultRowHeight!=null?f.defaultrowlen=parseFloat(e.defaultRowHeight):f.defaultrowlen=de.defaultRowHeight,e.defaultColWidth!=null?f.defaultcollen=parseFloat(e.defaultColWidth):f.defaultcollen=de.defaultColWidth,e.showGridLines!=null){let t=e.showGridLines;t==0||t==!1?f.showGridLines=!1:f.showGridLines=!0}else f.showGridLines=!0},initialjfFile:function(e,n){let t=this;t.getCurSheet();let l=f.luckysheetfile[t.getSheetIndex(f.currentSheetIndex)];t.nulldata=cl([],f.defaultrowNum,f.defaultcolumnNum);let o=t.buildGridData(l),a=[];l.jfgird_select_save=l.jfgird_select_save||[],l.jfgird_select_save.forEach(m=>a.push({row:m.row,column:m.column})),l.luckysheet_select_save=a,this.sheetParamRestore(l,o);let s=f.luckysheet_select_save[0].row[1],u=f.luckysheet_select_save[0].column[1];if(f.luckysheet_select_save.length>1)for(let m=0;m<f.luckysheet_select_save.length;m++)f.luckysheet_select_save[m].row[1]>s&&(s=f.luckysheet_select_save[m].row[1]),f.luckysheet_select_save[m].column[1]>u&&(u=f.luckysheet_select_save[m].column[1]);be.fontInitial(f.fontList),l.data=o;let h=o.length;s>h-1&&(h=s+1);let d=o[0].length;u>d-1&&(d=u+1),typeof de.beforeCreateDom=="function"&&de.beforeCreateDom(luckysheet),typeof de.workbookCreateBefore=="function"&&de.workbookCreateBefore(luckysheet),ic(d,h,o,e,n),setTimeout(function(){W.createHoverTip("#luckysheet_info_detail",".luckysheet_info_detail_back, .luckysheet_info_detail_input, .luckysheet_info_detail_update"),W.createHoverTip("#luckysheet-wa-editor",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button"),f.luckysheetTableContentHW=[$("#luckysheet-cell-main").width()+f.rowHeaderWidth-f.cellMainSrollBarSize,$("#luckysheet-cell-main").height()+f.columnHeaderHeight-f.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(f.luckysheetTableContentHW[0]*f.devicePixelRatio),height:Math.ceil(f.luckysheetTableContentHW[1]*f.devicePixelRatio)}).css({width:f.luckysheetTableContentHW[0],height:f.luckysheetTableContentHW[1]}).get(0).getContext("2d");let m=Q().info,v=ne.gridKey+"__qkcache",y=function(){l.load="1",t.createSheet();let k=function(){t.mergeCalculation(l.index),t.setSheetParam(!1),t.storeSheetParam(),t.restoreselect(),t.CacheNotLoadControll=[],t.restoreCache(),g.execFunctionGroupForce(de.forceCalculation),t.restoreSheetAll(f.currentSheetIndex),$("#luckysheet_info_detail_save").html(m.detailSave),l.isPivotTable?f.luckysheetcurrentisPivotTable=!0:(f.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide()),Mh(),Ot(),l.scrollLeft!=null&&l.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(l.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),l.scrollTop!=null&&l.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(l.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0),od(f.asyncLoad,"core"),de.pointEdit?setTimeout(function(){f.loadingObj.close()},0):setTimeout(function(){f.loadingObj.close()},500)},b=ne.loadSheetUrl;if(b=="")t.loadOtherFile(l),k();else{let w=t.checkLoadSheetIndex(l),x=[];for(let C=0;C<w.length;C++){let S=w[C];S!=l.index&&x.push(S)}if(x.length===0){k();return}$.post(b,{gridKey:ne.gridKey,index:x.join(",")},function(C){let S=new Function("return "+C)();for(let _ in S){if(_==l.index)continue;let T=f.luckysheetfile[t.getSheetIndex(_)];(T.load==null||T.load=="0")&&(T.celldata=S[_.toString()],T.data=t.buildGridData(T),T.load="1")}k()})}};try{localforage.getItem(v).then(function(k){k!=null&&(t.CacheNotLoadControll=k),ne.clearcachelocaldata(function(){y()})})}catch(k){y(),console.log("\u7F13\u5B58\u64CD\u4F5C\u5931\u8D25")}},1)},storeSheetParam:function(){let e=this.getSheetIndex(f.currentSheetIndex),n=f.luckysheetfile[e];n.config=f.config,n.visibledatarow=f.visibledatarow,n.visibledatacolumn=f.visibledatacolumn,n.ch_width=f.ch_width,n.rh_height=f.rh_height,n.luckysheet_select_save=$.extend(!0,[],f.luckysheet_select_save),n.luckysheet_selection_range=$.extend(!0,[],f.luckysheet_selection_range),$("#luckysheet-scrollbar-x")[0].scrollWidth>$("#luckysheet-scrollbar-x")[0].offsetWidth&&(n.scrollLeft=$("#luckysheet-scrollbar-x").scrollLeft()),$("#luckysheet-scrollbar-y")[0].scrollHeight>$("#luckysheet-scrollbar-y")[0].offsetHeight&&(n.scrollTop=$("#luckysheet-scrollbar-y").scrollTop()),n.zoomRatio=f.zoomRatio},setSheetParam:function(e=!0){let n=this.getSheetIndex(f.currentSheetIndex),t=f.luckysheetfile[n];f.flowdata=t.data,xe.webWorkerFlowDataCache(f.flowdata),g.execFunctionGlobalData=null,window.luckysheet_getcelldata_cache=null,this.sheetParamRestore(t,f.flowdata),t.freezen==null?(Y.freezenhorizontaldata=null,Y.freezenverticaldata=null):(Y.freezenhorizontaldata=t.freezen.horizontal==null?null:t.freezen.horizontal.freezenhorizontaldata,Y.freezenverticaldata=t.freezen.vertical==null?null:t.freezen.vertical.freezenverticaldata),e&&gn(f.flowdata.length,f.flowdata[0].length),He.buildAllPs(f.flowdata),Ie.currentImgId=null,Ie.images=t.images,Ie.allImagesShow(),Ie.init(),Ye.dataVerification=t.dataVerification,Ye.init(),Cl.hyperlink=t.hyperlink,Cl.init(),Dl(t.filter_select,t.filter)},restoreselect:function(){let e=this.getSheetIndex(f.currentSheetIndex),n=f.luckysheetfile[e];lt(!0),Pt(),n.scrollLeft!=null&&n.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),n.scrollTop!=null&&n.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0)},storeSheetParamALL:function(){let e=this;e.storeSheetParam();let n=e.getSheetIndex(f.currentSheetIndex);f.luckysheetfile[n].data=f.flowdata,f.luckysheetfile[n].config=$.extend(!0,{},f.config)},mergeCalculationSheet:{},mergeCalculation:function(e){let n=f.luckysheetfile[this.getSheetIndex(e)],t=n.config,l=n.data;if(t==null)return;let o=t.merge;if(!(o==null||e in this.mergeCalculationSheet||n.autoCalculationMerge===!1)){this.mergeCalculationSheet[e]=1;for(let a in o){let s=parseInt(a.substr(0,a.indexOf("_"))),u=parseInt(a.substr(a.indexOf("_")+1)),h=o[a];l[s][u]==null&&(l[s][u]={}),l[s][u].mc={r:s,c:u,rs:h.rs,cs:h.cs};for(let d=s;d<s+h.rs;d++)for(let m=u;m<u+h.cs;m++)d==s&&m==u||(l[d][m]==null&&(l[d][m]={}),l[d][m].mc={r:s,c:u})}}},loadOtherFile:function(e){let n=this;for(let t=0;t<f.luckysheetfile.length;t++){let l=f.luckysheetfile[t];l.index!=e.index&&(l.load==null||l.load=="0")&&(l.data=n.buildGridData(l),l.load="1")}},changeSheet:function(e,n,t,l){if(he())return;let o=this;if(e==f.currentSheetIndex)return;ne.allowUpdate&&($("#luckysheet-cell-main #luckysheet-multipleRange-show").empty(),ne.multipleIndex=0);let a=f.luckysheetfile[o.getSheetIndex(e)];if(t&&Je.createHookFunction("sheetCreateAfter",{sheet:a}),l&&Je.createHookFunction("sheetCopyAfter",{sheet:a}),Je.createHookFunction("sheetActivate",e,n,t),$("#luckysheet-filter-selected-sheet"+f.currentSheetIndex+", #luckysheet-filter-options-sheet"+f.currentSheetIndex).hide(),$("#luckysheet-filter-selected-sheet"+e+", #luckysheet-filter-options-sheet"+e).show(),o.storeSheetParamALL(),o.setCurSheet(e),a.isPivotTable?(f.luckysheetcurrentisPivotTable=!0,n||Oe.changePivotTable(e)):(f.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),Ot(!1)),a.load!=null){let u=o.buildGridData(a);a.data=u,o.mergeCalculation(e),o.setSheetParam(!0),o.showSheet(),setTimeout(function(){g.execFunctionGroup(),Be(),ne.saveParam("shs",null,f.currentSheetIndex)},1)}else{let u=ne.loadSheetUrl;if(u==""||f.luckysheetcurrentisPivotTable||!!t){let h=o.buildGridData(a);a.data=h,a.load="1",o.mergeCalculation(e),o.setSheetParam(),o.showSheet(),setTimeout(function(){o.restoreCache(),g.execFunctionGroupForce(de.forceCalculation),o.restoreSheetAll(f.currentSheetIndex),Be()},1),ne.saveParam("shs",null,f.currentSheetIndex)}else{$("#luckysheet-grid-window-1").append(Ar());let h=o.checkLoadSheetIndex(a);$.post(u,{gridKey:ne.gridKey,index:h.join(",")},function(d){let m=new Function("return "+d)();a.celldata=m[e.toString()];let p=o.buildGridData(a);setTimeout(function(){f.loadingObj.close()},500);for(let v in m){if(v==e)continue;let y=f.luckysheetfile[o.getSheetIndex(v)];(y.load==null||y.load=="0")&&(y.celldata=m[v.toString()],y.data=o.buildGridData(y),y.load="1")}a.data=p,a.load="1",o.mergeCalculation(e),o.setSheetParam(),o.showSheet(),setTimeout(function(){o.restoreCache(),g.execFunctionGroupForce(de.forceCalculation),o.restoreSheetAll(f.currentSheetIndex),Be()},1),ne.saveParam("shs",null,f.currentSheetIndex)})}}$("#luckysheet-cell-main .luckysheet-datavisual-selection-set").hide(),$("#luckysheet-datavisual-selection-set-"+e).show(),Y.initialFreezen(e),o.restoreselect()},checkLoadSheetIndexToDataIndex:{},checkLoadSheetIndex:function(e){let n=g.getAllFunctionGroup(),t=e.chart,l=e.pivotTable,o=[],a={};if(e.index in this.checkLoadSheetIndexToDataIndex)return[];if(o.push(e.index),a[e.index.toString()]=1,this.checkLoadSheetIndexToDataIndex[e.index]=1,n!=null){let s={};for(let u=0;u<n.length;u++){let h=n[u],d=h.index,m=Ll(h.r,h.c,d);if(m==null){let p=f.luckysheetfile[this.getSheetIndex(d)];if(p.data=this.buildGridData(p),m=Ll(h.r,h.c,d),m==null)continue}if(m.indexOf("!")==-1)g.addToSheetIndexList(m,d);else if(g.formulaContainSheetList!=null&&g.formulaContainSheetList[m]!=null)for(let p in g.formulaContainSheetList[m])s[p]=1;else g.functionParser(m,p=>{if(g.addToCellList(m,p),p.indexOf("!")>-1){let v=p.substr(0,p.indexOf("!")),y=this.getSheetByName(v);if(y!=null){let k=y.index;s[k]=1,g.addToSheetIndexList(m,k)}}}),g.formulaContainSheetList[m]==null&&g.addToSheetIndexList(m,d);d!=null}for(let u in s){let h=u;a[h.toString()]==null&&(o.push(h),a[h.toString()]=1,this.checkLoadSheetIndexToDataIndex[h]=1)}}if(t!=null)for(let s=0;s<t.length;s++){let h=t[s].dataSheetIndex;h!=null&&a[h.toString()]==null&&(o.push(h),a[h.toString()]=1)}if(l!=null){let s=l.pivotDataSheetIndex;s!=null&&a[s.toString()]==null&&(o.push(s),a[s.toString()]=1)}return o},showSheet:function(){$("#luckysheet-cell-flow_0").css({width:f.ch_width,top:"-1px"}),$("#luckysheet-sheettable_0").css({width:f.ch_width-1,height:f.rh_height}),$("#luckysheetrowHeader_0").css("height",f.rh_height),$("#luckysheet-cols-h-cells_0").css("width",f.ch_width),$("#luckysheet-scrollbar-x div").width(f.ch_width),$("#luckysheet-scrollbar-y div").height(f.rh_height+f.columnHeaderHeight-f.cellMainSrollBarSize-3);let e=this.getSheetIndex(f.currentSheetIndex),n=f.luckysheetfile[e];f.scrollRefreshSwitch=!1,n.scrollLeft!=null&&n.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft*f.zoomRatio):$("#luckysheet-scrollbar-x").scrollLeft(0),n.scrollTop!=null&&n.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop*f.zoomRatio):$("#luckysheet-scrollbar-y").scrollTop(0),setTimeout(()=>{f.scrollRefreshSwitch=!0},0),ir(f.zoomRatio)},setCurSheet:function(e){for(let n=0;n<f.luckysheetfile.length;n++)f.luckysheetfile[n].index==e?f.luckysheetfile[n].status=1:f.luckysheetfile[n].status=0;f.currentSheetIndex=e},getSheetIndex:function(e){for(let n=0;n<f.luckysheetfile.length;n++)if(f.luckysheetfile[n].index==e)return n;return null},changeSheetExec:function(e,n,t,l){let o=$("#luckysheet-sheets-item"+e);window.luckysheet_getcelldata_cache=null,$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),o.addClass("luckysheet-sheets-item-active").show(),rl(),this.changeSheet(e,n,t,l),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),g.rangestart&&g.createRangeHightlight(),this.sheetBarShowAndHide(e)},sheetArrowShowAndHide(){let e=$("#luckysheet-sheet-container-c");if(!!e.length){var n=e[0].scrollWidth,t=Math.ceil(e.width());n>t?de.showsheetbarConfig.sheet&&($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show()):($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","none"),$("#luckysheet-sheet-container .docs-sheet-fade-left").hide())}},sheetBarShowAndHide(e){let n=$("#luckysheet-sheet-container-c");if(e!=null){let a=$("#luckysheet-sheets-item"+e);n.scrollLeft(a.offset().left)}let t=n.width(),l=n[0].scrollWidth,o=n.scrollLeft();o<=0?$("#luckysheet-sheet-container .docs-sheet-fade-left").hide():$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),t+o>=l?$("#luckysheet-sheet-container .docs-sheet-fade-right").hide():$("#luckysheet-sheet-container .docs-sheet-fade-right").show()},delChart:function(e,n){let t=this.getSheetIndex(n),l=f.luckysheetfile[t];if(l.chart==null)l.chart=[];else for(let o=0;o<l.chart.length;o++)if(l.chart[o].chart_id==e){f.luckysheetfile[t].chart.splice(o,1);break}},saveChart:function(e){let n=this.getSheetIndex(e.sheetIndex),t=f.luckysheetfile[n];if(t.chart==null)t.chart=[],t.chart.push(e);else{for(let l=0;l<t.chart.length;l++)if(t.chart[l].chart_id==e.chart_id){let o=$.extend(!0,{},t.chart[l]);t.chart[l]=$.extend(!0,{},o,e);return}t.chart.push(e)}},getChart:function(e,n){let t=this.getSheetIndex(e),l=f.luckysheetfile[t];if(l.chart==null)return null;for(let o=0;o<l.chart.length;o++)if(l.chart[o].chart_id==n)return l.chart[o];return null},getRangetxt:function(e,n,t){let l="";t==null&&(t=f.currentSheetIndex),e!=t&&(l=f.luckysheetfile[this.getSheetIndex(e)].name+"!");let o=n.row[0],a=n.row[1],s=n.column[0],u=n.column[1];return o==null&&a==null?l+tt(s)+":"+tt(u):s==null&&u==null?l+(o+1)+":"+(a+1):s==u&&o==a?l+tt(s)+(o+1):l+tt(s)+(o+1)+":"+tt(u)+(a+1)},getSheetName:function(e){return e==null&&(e=f.currentSheetIndex),f.luckysheetfile[this.getSheetIndex(e)].name},getSheetMerge:function(){return f.config.merge==null?null:f.config.merge},getSheetData:function(e){return e==null&&(e=f.currentSheetIndex),f.luckysheetfile[this.getSheetIndex(e)].data},getSheetConfig:function(e){let n=this;return e==null&&(e=f.currentSheetIndex),f.luckysheetfile[n.getSheetIndex(e)].config==null&&(f.luckysheetfile[n.getSheetIndex(e)].config={}),f.luckysheetfile[n.getSheetIndex(e)].config},restoreFilter:function(e){let n=this.getSheetIndex(e),t=f.luckysheetfile[n];if(N(t.filter_select)=="string"&&(t.filter_select=JSON.parse(t.filter_select)),t.filter_select==null||t.filter_select.row==null||t.filter_select.column==null)return;Dl(t.filter_select),N(t.filter)!="object"&&t.filter!=null&&N(t.filter)=="string"&&(t.filter=JSON.parse(t.filter));let l={};t.config!=null&&t.config.rowhidden!=null&&(l=t.config.rowhidden),$("#luckysheet-filter-options-sheet"+e+" .luckysheet-filter-options").each(function(o){if(t.filter==null)return!1;let a=$(this),s=t.filter[o];if(s==null)return!0;N(s)!="object"&&(s=JSON.parse(s)),On(a,s.optionstate,s.rowhidden,s.caljs,!1,s.st_r,s.ed_r,s.cindex,s.st_c,s.ed_c),l=$.extend(!0,l,s.rowhidden)}),t.config==null&&(t.config={}),t.config.rowhidden=l,f.config=t.config,Ct(f.flowdata.length,f.flowdata[0].length,!1)},restorePivot:function(e){let n=this.getSheetIndex(e);!f.luckysheetfile[n].isPivotTable||(Oe.getCellData(e),Oe.initialPivotManage(!0),Oe.refreshPivotTable(!1))},restoreSheetAll:function(e){let n=this;n.restorePivot(e),n.restoreFilter(e),n.restoreFreezen(e)},restoreFreezen:function(e){Y.initialFreezen(e)},restoreCache:function(){let e=this,n=e.CacheNotLoadControll;if(e.CacheNotLoadControll=[],n.length!=0)for(let t=0;t<n.length;t++){let l=n[t];e.execCache(l)}},CacheNotLoadControll:[],execCache:function(e){let n=this,t=e.t,l=e.i,o=e.v,a=f.luckysheetfile[n.getSheetIndex(l)];if(t=="sha")f.luckysheetfile.push(o);else if(t=="shc"){let s=$.extend(!0,{},f.luckysheetfile[n.getSheetIndex(o.copyindex)]);s.index=l,f.luckysheetfile.push(s)}else if(t=="shd")f.luckysheetfile.splice(o.deleIndex,1);else if(t=="shr")for(let s in o)f.luckysheetfile[n.getSheetIndex(s)].order=o[s];if((a==null||a.load!="1")&&!(t in{sha:0,shc:0,shd:0,shr:0})){n.CacheNotLoadControll.push(e);return}if(t=="v"){let s=e.r,u=e.c,h=e.v,d=n.getSheetData(l);a.data[s][u]=h}else if(t=="fc"){let s=e.op,u=e.pos;N(o)!="object"&&(o=new Function("return "+o)());let h=o.r,d=o.c;s=="del"?g.delFunctionGroup(h,d,l):g.insertUpdateFunctionGroup(h,d,l)}else if(t=="cg"){let s=o,u=e.k,h=n.getSheetConfig(l);u in h||(h[u]={});for(let d in s)h[u][d]=s[d];f.config=h}else if(t=="f"){let s=o,u=e.op,h=e.pos,d=a.filter;d==null&&(d={}),u=="upOrAdd"?d[h]=s:u=="del"&&delete d[h]}else if(t=="fsc")a.filter=null,a.filter_select=null;else if(t=="fsr"){let s=o;a.filter=s.filter,a.filter_select=s.filter_select}else if(t=="sh"){let s=e.op,u=e.cur,h=o;if(s=="hide")a.status=0,f.luckysheetfile[n.getSheetIndex(u)].status=1;else if(s=="show"){for(let d=0;d<f.luckysheetfile.length;d++)f.luckysheetfile[d].status=0;a.status=1}}else if(t=="all"){let s=e.k;e.s&&N(o)!="object"?a[s]=JSON.stringify(o):a[s]=o}else if(t=="c"){let s=e.op,u=e.cid;if(s=="add")a.chart.push(o);else if(s=="xy"||s=="wh"||s=="update"){for(let h=0;h<a.chart.length;h++)if(a.chart[h].chart_id==u){for(let d in a.chart[h])for(let m in o)d==m&&(a.chart[h][d]=o[m]);return}}else if(s=="del"){for(let h=0;h<a.chart.length;h++)if(a.chart[h].chart_id==u){a.chart.splice(h,1);return}}}else if(t=="drc"){let s=e.rc,u=o.index,h=o.len,d=a.celldata;if(s=="r"){for(let k=0;d.length==0;k++){let b=d[k];b.r>=u&&b.r<u+h?delete d[k]:b.r>=u+h&&(b.r-=h)}a.row-=h}else{for(let k=0;d.length==0;k++){let b=d[k];b.c>=u&&b.c<u+h?delete d[k]:b.c>=u+h&&(b.c-=h)}a.column-=h}let m=[];for(let k=0;k<d.length;k++)d[k]!=null&&m.push(d[k]);a.celldata=m;let p,v,y;s=="r"?p="row":p="column",v=u,y=u+h-1,Bn(p,v,y,!0)}else if(t=="arc"){let s=e.rc,u=o.index,h=o.len,d=a.celldata;if(s=="r"){for(let p=0;p<d.length;p++){let v=d[p];v.r>u&&(v.r+=h)}a.row+=h}else{for(let p=0;p<d.length;p++){let v=d[p];v.c>u&&(v.c+=h)}a.column+=h}let m;s=="r"?m="row":m="column",Tr(m,u,h,!0)}else t=="na"?ne.saveParam("na",null,o):t=="thumb"&&setTimeout(function(){n.imageRequest()},2e3)}},ye=Nv});var vr,xn,Ev,D,No=Me(()=>{ht();Nt();Fl();Ut();vr=El(pn()),xn={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},Ev={getCellDataArr:function(e,n,t){let l=[];if(e.data==null)t||(n==="number"?l.push(0):n==="text"&&l.push(""));else if(N(e.data)==="array")for(let o=0;o<e.data.length;o++)for(let a=0;a<e.data[o].length;a++){let s=e.data[o][a],u=s;N(s)==="object"&&(u=s.v),u==null?t||(n==="number"?u=0:n==="text"&&(u=""),l.push(u)):l.push(u)}else me(e.data.v)?t||(n=="number"?l.push(0):n=="text"&&l.push("")):l.push(e.data.v);return l},getCellDataDyadicArr:function(e,n){let t=[];if(e.data==null){let l=[];n=="number"?l.push(0):n=="text"&&l.push(""),t.push(l)}else if(N(e.data)=="array")for(let l=0;l<e.data.length;l++){let o=[];for(let a=0;a<e.data[l].length;a++){let s=e.data[l][a],u=s;N(s)==="object"&&(u=s.v),u==null&&(n==="number"?u=0:n==="text"&&(u="")),o.push(u)}t.push(o)}else{let l=[],o=e.data.v;me(o)&&(n=="number"?o=0:n=="text"&&(o="")),l.push(o),t.push(l)}return t},getDataArr:function(e,n){let t=[];if(n==null&&(n=!1),N(e[0])=="array")for(let l=0;l<e.length;l++)for(let o=0;o<e[l].length;o++)n&&!B(e[l][o])||t.push(e[l][o]);else for(let l=0;l<e.length;l++)n&&!B(e[l])||t.push(e[l]);return t},getDataDyadicArr:function(e){let n=[];if(N(e[0])=="array")for(let t=0;t<e.length;t++){let l=[];for(let o=0;o<e[t].length;o++)l.push(e[t][o]);n.push(l)}else{let t=[];for(let l=0;l<e.length;l++)t.push(e[l]);n.push(t)}return n},isDyadicArr:function(e){let n=!0;if(e.length>1){let t=e[0].length;for(let l=1;l<e.length;l++)if(e[l].length!=t){n=!1;break}}return n},getFirstValue:function(e,n){let t=this;n==null&&(n="number");let l;if(N(e)=="array")if(N(e[0])=="array"){if(!t.isDyadicArr(e))return xn.v;l=e[0][0]}else l=e[0];else if(N(e)=="object"&&e.startCell!=null)if(e.data==null)n=="number"?l=0:n=="text"&&(l="");else{let o=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn;if(e.rowl==1&&e.coll==1)l=e.data,l==null||me(l.v)?n=="number"?l=0:n=="text"&&(l=""):l=l.v;else if(e.data[0][0].mc!=null&&e.data[0][0].mc.rs==e.rowl&&e.data[0][0].mc.cs==e.coll)l=e.data[0][0],l==null||me(l.v)?n=="number"?l=0:n=="text"&&(l=""):l=l.v;else if(e.rowl==1||e.coll==1){let s=g.getcellrange(e.startCell),u=s.row[0],h=u+e.rowl-1,d=s.column[0],m=d+e.coll-1;if(e.rowl==1){if(a<d||a>m)return xn.v;l=e.data[0][a-d]}else if(e.coll==1){if(o<u||o>h)return xn.v;l=e.data[o-u][0]}l==null||me(l.v)||l.mc!=null?n=="number"?l=0:n=="text"&&(l=""):l=l.v}else return xn.v}else l=e;return l},getCellBoolen:function(e){let t=this.getFirstValue(e);if(H(t))return t;if(N(t)!="boolean")if(N(t)=="string"&&(t.toLowerCase()=="true"||t.toLowerCase()=="false"))t.toLowerCase()=="true"?t=!0:t.toLowerCase()=="false"&&(t=!1);else if(B(t))t=parseFloat(t),t=t!=0;else return xn.v;return t},getCellDate:function(e){let n=this,t;if(N(e)=="array")if(N(e[0])=="array"){if(!n.isDyadicArr(e))return xn.v;t=e[0][0]}else t=e[0];else if(N(e)=="object"&&e.startCell!=null){if(e.data==null||N(e.data)=="array"||me(e.data.v))return xn.v;t=e.data.v,e.data.ct!=null&&e.data.ct.t=="d"&&(t=mt("YYYY-MM-DD h:mm:ss",t))}else t=e;return t},getCellrangeDate:function(e){let n=this,t=[];if(N(e)=="array"){if(N(e[0])=="array"&&!n.isDyadicArr(e))return xn.v;t=t.concat(n.getDataArr(e,!1))}else if(N(e)=="object"&&e.startCell!=null)if(e.data==null)t.push(0);else if(N(e.data)=="array")for(let l=0;l<e.data.length;l++)for(let o=0;o<e.data[l].length;o++)if(e.data[l][o]!=null&&!me(e.data[l][o].v)){let a=e.data[l][o].v;e.data[l][o].ct!=null&&e.data[l][o].ct.t=="d"&&(a=mt("YYYY-MM-DD h:mm:ss",a)),t.push(a)}else t.push(0);else{let l=e.data.v;e.data.ct!=null&&e.data.ct.t=="d"&&(l=mt("YYYY-MM-DD h:mm:ss",l)),t.push(l)}else t.push(e);return t},getRegExpStr:function(e){return e.replace("~*","\\*").replace("~?","\\?").replace(".","\\.").replace("*",".*").replace("?",".")},factorial:function(e){return e==0||e==1?1:e*this.factorial(e-1)},factorialDouble:function(e){return e<=0?1:e*this.factorialDouble(e-2)},variance:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return o/t},variance_s:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return o/(t-1)},standardDeviation:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return Math.sqrt(o/t)},standardDeviation_s:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return Math.sqrt(o/(t-1))},isLeapYear:function(e){return new Date(e,1,29).getMonth()===1},feb29Between:function(e,n){let t=this,l=(0,vr.default)(e).year(),o=(0,vr.default)().set({year:l,month:2,date:1});if(t.isLeapYear(l)&&(0,vr.default)(e)<(0,vr.default)(o)&&(0,vr.default)(n)>=(0,vr.default)(o))return!0;let a=(0,vr.default)(n).year(),s=(0,vr.default)().set({year:a,month:2,date:1});return t.isLeapYear(a)&&(0,vr.default)(n)>=(0,vr.default)(s)&&(0,vr.default)(e)<(0,vr.default)(s)},findResultIndex:function(e,n){let t={};for(let a=1;a<e[0].length;++a)t[a]=!0;let l=n[0].length;for(i=1;i<n.length;++i)n[i].length>l&&(l=n[i].length);for(let a=1;a<e.length;++a)for(let s=1;s<e[a].length;++s){let u=!1,h=!1;for(let d=0;d<n.length;++d){let m=n[d];if(m.length<l)continue;let p=m[0];if(e[a][0]===p){h=!0;for(let v=1;v<m.length;++v)u=u||new Function("return "+e[a][s]+m[v])()}}h&&(t[s]=t[s]&&u)}let o=[];for(let a=0;a<e[0].length;++a)t[a]&&o.push(a-1);return o},findField:function(e,n){let t=null;for(let l=0;l<e.length;l++)if(e[l][0]==n){t=l;break}return t==null?xn.v:t},rest:function(e,n){return n=n||1,!e||typeof e.slice!="function"?e:e.slice(n)},compact:function(e){if(!e)return e;let n=[];for(let t=0;t<e.length;++t)!e[t]||n.push(e[t]);return n}},D=Ev});function wa(e){var n=ad.sylvester_matrix.create(e);return n.inverse().elements}var ad,Lv,oc=Me(()=>{ad={},Lv=function(n){var t=function(){};t.precision=1e-6,t.create=function(o){var a=new t;return a.setElements(o)};var l=t.create;t.I=function(o){for(var a=[],s=o,u;s--;)for(u=o,a[s]=[];u--;)a[s][u]=s===u?1:0;return t.create(a)},t.prototype={e:function(o,a){return o<1||o>this.elements.length||a<1||a>this.elements[0].length?null:this.elements[o-1][a-1]},dimensions:function(){var o=this.elements.length===0?0:this.elements[0].length;return{rows:this.elements.length,cols:o}},rows:function(){return this.elements.length},cols:function(){return this.elements.length===0?0:this.elements[0].length},eql:function(o){var a=o.elements||o;if((!a[0]||typeof a[0][0]=="undefined")&&(a=t.create(a).elements),this.elements.length===0||a.length===0)return this.elements.length===a.length;if(this.elements.length!==a.length||this.elements[0].length!==a[0].length)return!1;for(var s=this.elements.length,u=this.elements[0].length,h;s--;)for(h=u;h--;)if(Math.abs(this.elements[s][h]-a[s][h])>t.precision)return!1;return!0},dup:function(){return t.create(this.elements)},map:function(o,a){if(this.elements.length===0)return t.create([]);for(var s=[],u=this.elements.length,h=this.elements[0].length,d;u--;)for(d=h,s[u]=[];d--;)s[u][d]=o.call(a,this.elements[u][d],u+1,d+1);return t.create(s)},isSameSizeAs:function(o){var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.elements.length===0?a.length===0:this.elements.length===a.length&&this.elements[0].length===a[0].length},add:function(o){if(this.elements.length===0)return this.map(function(s){return s});var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.isSameSizeAs(a)?this.map(function(s,u,h){return s+a[u-1][h-1]}):null},subtract:function(o){if(this.elements.length===0)return this.map(function(s){return s});var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.isSameSizeAs(a)?this.map(function(s,u,h){return s-a[u-1][h-1]}):null},canMultiplyFromLeft:function(o){if(this.elements.length===0)return!1;var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.elements[0].length===a.length},multiply:function(o){if(this.elements.length===0)return null;if(!o.elements)return this.map(function(k){return k*o});var a=!!o.modulus,s=o.elements||o;if(typeof s[0][0]=="undefined"&&(s=t.create(s).elements),!this.canMultiplyFromLeft(s))return null;for(var u=this.elements.length,h=s[0].length,d,m=this.elements[0].length,p,v=[],y;u--;)for(d=h,v[u]=[];d--;){for(p=m,y=0;p--;)y+=this.elements[u][p]*s[p][d];v[u][d]=y}var s=t.create(v);return a?s.col(1):s},minor:function(o,a,s,u){if(this.elements.length===0)return null;for(var h=[],d=s,m,p,v,y=this.elements.length,k=this.elements[0].length;d--;)for(m=s-d-1,h[m]=[],p=u;p--;)v=u-p-1,h[m][v]=this.elements[(o+m-1)%y][(a+v-1)%k];return t.create(h)},transpose:function(){if(this.elements.length===0)return t.create([]);for(var o=this.elements.length,a,s=this.elements[0].length,u,h=[],a=s;a--;)for(u=o,h[a]=[];u--;)h[a][u]=this.elements[u][a];return t.create(h)},isSquare:function(){var o=this.elements.length===0?0:this.elements[0].length;return this.elements.length===o},max:function(){if(this.elements.length===0)return null;for(var o=0,a=this.elements.length,s=this.elements[0].length,u;a--;)for(u=s;u--;)Math.abs(this.elements[a][u])>Math.abs(o)&&(o=this.elements[a][u]);return o},indexOf:function(o){if(this.elements.length===0)return null;var a=null,s=this.elements.length,u,h=this.elements[0].length,d;for(u=0;u<s;u++)for(d=0;d<h;d++)if(this.elements[u][d]===o)return{i:u+1,j:d+1};return null},diagonal:function(){if(!this.isSquare)return null;for(var o=[],a=this.elements.length,s=0;s<a;s++)o.push(this.elements[s][s]);return t.create(o)},toRightTriangular:function(){if(this.elements.length===0)return t.create([]);var o=this.dup(),a,s=this.elements.length,u,h,d=this.elements[0].length,m;for(u=0;u<s;u++){if(o.elements[u][u]===0){for(h=u+1;h<s;h++)if(o.elements[h][u]!==0){for(a=[],m=0;m<d;m++)a.push(o.elements[u][m]+o.elements[h][m]);o.elements[u]=a;break}}if(o.elements[u][u]!==0)for(h=u+1;h<s;h++){var p=o.elements[h][u]/o.elements[u][u];for(a=[],m=0;m<d;m++)a.push(m<=u?0:o.elements[h][m]-o.elements[u][m]*p);o.elements[h]=a}}return o},determinant:function(){if(this.elements.length===0)return 1;if(!this.isSquare())return null;for(var o=this.toRightTriangular(),a=o.elements[0][0],s=o.elements.length,u=1;u<s;u++)a=a*o.elements[u][u];return a},isSingular:function(){return this.isSquare()&&this.determinant()===0},trace:function(){if(this.elements.length===0)return 0;if(!this.isSquare())return null;for(var o=this.elements[0][0],a=this.elements.length,s=1;s<a;s++)o+=this.elements[s][s];return o},rank:function(){if(this.elements.length===0)return 0;for(var o=this.toRightTriangular(),a=0,s=this.elements.length,u=this.elements[0].length,h;s--;)for(h=u;h--;)if(Math.abs(o.elements[s][h])>t.precision){a++;break}return a},augment:function(o){if(this.elements.length===0)return this.dup();var a=o.elements||o;typeof a[0][0]=="undefined"&&(a=t.create(a).elements);var s=this.dup(),u=s.elements[0].length,h=s.elements.length,d=a[0].length,m;if(h!==a.length)return null;for(;h--;)for(m=d;m--;)s.elements[h][u+m]=a[h][m];return s},inverse:function(){if(this.elements.length===0||!this.isSquare()||this.isSingular())return null;for(var o=this.elements.length,a=o,s,u=this.augment(t.I(o)).toRightTriangular(),h=u.elements[0].length,d,m,p,v=[],y;a--;){for(m=[],v[a]=[],p=u.elements[a][a],d=0;d<h;d++)y=u.elements[a][d]/p,m.push(y),d>=o&&v[a].push(y);for(u.elements[a]=m,s=a;s--;){for(m=[],d=0;d<h;d++)m.push(u.elements[s][d]-u.elements[a][d]*u.elements[s][a]);u.elements[s]=m}}return t.create(v)},round:function(){return this.map(function(o){return Math.round(o)})},snapTo:function(o){return this.map(function(a){return Math.abs(a-o)<=t.precision?o:a})},setElements:function(o){var a,s,u=o.elements||o;if(u[0]&&typeof u[0][0]!="undefined"){for(a=u.length,this.elements=[];a--;)for(s=u[a].length,this.elements[a]=[];s--;)this.elements[a][s]=u[a][s];return this}var h=u.length;for(this.elements=[],a=0;a<h;a++)this.elements.push([u[a]]);return this}},n.sylvester_matrix=t};Lv(ad)});function Yi(){let e=arguments[1],n=arguments[0],t;N(n)=="object"&&n.startCell!=null?(e=="&"?t=D.getCellDataDyadicArr(n,"text"):t=D.getCellDataDyadicArr(n,"number"),t.length==1&&t[0].length==1&&(t=t[0][0])):t=n;let l=arguments[2],o;if(N(l)=="object"&&l.startCell!=null?(e=="&"?o=D.getCellDataDyadicArr(l,"text"):o=D.getCellDataDyadicArr(l,"number"),o.length==1&&o[0].length==1&&(o=o[0][0])):o=l,H(t))return t;if(H(o))return o;if(N(t)=="array"&&N(t[0])=="array"&&!D.isDyadicArr(t))return De.v;if(N(o)=="array"&&N(o[0])=="array"&&!D.isDyadicArr(o))return De.v;if(e=="<>"&&(e="!="),e=="="&&(e="=="),t==null&&o==null)return"#INVERSE!";if(t=="#INVERSE!")t=0,e=="-"?e="+":e=="+"&&(e="-");else if(e=="-"&&t==null)t=0;else if(e=="/"&&(o==0||o==null))return De.d;function a(u,h,d){if(B(u)&&(u=parseFloat(u)),B(d)&&(d=parseFloat(d)),h=="==")return u==d;if(h=="!=")return u!=d;if(h==">=")return u>=d;if(h=="<=")return u<=d;if(h==">")return u>d;if(h=="<")return u<d}function s(u){return u==null?u:u.toString().toLowerCase()=="true"?1:u.toString().toLowerCase()=="false"?0:u}if(e=="*")if(N(t)=="array"&&N(o)=="array"){let u=[];if(N(t[0])=="array"&&N(o[0])=="array")if(t.length==o.length&&t[0].length==o[0].length)for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]),o[h][m]=s(o[h][m]);let p;B(t[h][m])&&B(o[h][m])?p=xt(t[h][m],e,o[h][m]):p=De.v,d.push(p)}u.push(d)}else if(t[0].length==o.length){let h=t.length,d=o[0].length;for(let m=0;m<h;m++){let p=[];for(let v=0;v<d;v++){let y=0;for(let k=0;k<t[0].length;k++)t[m][k]=s(t[m][k]),o[k][v]=s(o[k][v]),B(t[m][k])&&B(o[k][v])?y+=xt(t[m][k],e,o[k][v]):y+=De.v;y.toString()=="NaN"&&(y=De.v),p.push(y)}u.push(p)}}else if(t.length==o[0].length){let h=o.length,d=t[0].length;for(let m=0;m<h;m++){let p=[];for(let v=0;v<d;v++){let y=0;for(let k=0;k<o[0].length;k++)t[k][v]=s(t[k][v]),o[m][k]=s(o[m][k]),B(o[m][k])&&B(t[k][v])?y+=xt(t[k][v],e,o[m][k]):y+=De.v;y.toString()=="NaN"&&(y=De.v),p.push(y)}u.push(p)}}else return De.na;else if(N(t[0])=="array")if(t[0].length==o.length)for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]),o[m]=s(o[m]);let p;B(t[h][m])&&B(o[m])?p=xt(t[h][m],e,o[m]):p=De.v,d.push(p)}u.push(d)}else if(t[0].length==1){let h=t.length,d=o.length;for(let m=0;m<h;m++){let p=[];for(let v=0;v<d;v++){t[m][0]=s(t[m][0]),o[v]=s(o[v]);let y;B(t[m][0])&&B(o[v])?y=xt(t[m][0],e,o[v]):y=De.v,p.push(y)}u.push(p)}}else return De.na;else if(N(o[0])=="array")if(o[0].length==t.length)for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){t[m]=s(t[m]),o[h][m]=s(o[h][m]);let p;B(t[m])&&B(o[h][m])?p=xt(t[m],e,o[h][m]):p=De.v,d.push(p)}u.push(d)}else if(o[0].length==1){let h=o.length,d=t.length;for(let m=0;m<h;m++){let p=[];for(let v=0;v<d;v++){t[v]=s(t[v]),o[m][0]=s(o[m][0]);let y;B(t[v])&&B(o[m][0])?y=xt(t[v],e,o[m][0]):y=De.v,p.push(y)}u.push(p)}}else return De.na;else{if(t.length!=o.length)return De.na;for(let h=0;h<t.length;h++){t[h]=s(t[h]),o[h]=s(o[h]);let d;B(t[h])&&B(o[h])?d=xt(t[h],e,o[h]):d=De.v,u.push(d)}}return u}else if(N(t)=="array"){o=s(o);let u=[];if(N(t[0])=="array")for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]);let p;B(t[h][m])&&B(o)?p=xt(t[h][m],e,o):p=De.v,d.push(p)}u.push(d)}else for(let h=0;h<t.length;h++){t[h]=s(t[h]);let d;B(t[h])&&B(o)?d=xt(t[h],e,o):d=De.v,u.push(d)}return u}else if(N(o)=="array"){t=s(t);let u=[];if(N(o[0])=="array")for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){o[h][m]=s(o[h][m]);let p;B(t)&&B(o[h][m])?p=xt(t,e,o[h][m]):p=De.v,d.push(p)}u.push(d)}else for(let h=0;h<o.length;h++){o[h]=s(o[h]);let d;B(t)&&B(o[h])?d=xt(t,e,o[h]):d=De.v,u.push(d)}return u}else{t=s(t),o=s(o);let u;return B(t)&&B(o)?u=xt(t,e,o):u=De.v,u}else if(e=="/")if(N(t)=="array"&&N(o)=="array"){let u=[];if(N(t[0])=="array"&&N(o[0])=="array")if(t.length==o.length&&t[0].length==o[0].length)for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]),o[h][m]=s(o[h][m]);let p;B(t[h][m])&&B(o[h][m])?parseFloat(o[h][m])==0?p=De.d:p=xt(t[h][m],e,o[h][m]):p=De.v,d.push(p)}u.push(d)}else if(t[0].length==o.length){let h=wa(o),d=t.length,m=h[0].length;for(let p=0;p<d;p++){let v=[];for(let y=0;y<m;y++){let k=0;for(let b=0;b<t[0].length;b++)t[p][b]=s(t[p][b]),h[b][y]=s(h[b][y]),B(t[p][b])&&B(h[b][y])?k+=xt(t[p][b],"*",h[b][y]):k+=De.v;k.toString()=="NaN"&&(k=De.v),v.push(k)}u.push(v)}}else return De.na;else if(N(t[0])=="array")if(t[0].length==o.length)for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]),o[m]=s(o[m]);let p;B(t[h][m])&&B(o[m])?parseFloat(o[m])==0?p=De.d:p=xt(t[h][m],e,o[m]):p=De.v,d.push(p)}u.push(d)}else if(t[0].length==1){let h=t.length,d=o.length;for(let m=0;m<h;m++){let p=[];for(let v=0;v<d;v++){t[m][0]=s(t[m][0]),o[v]=s(o[v]);let y;B(t[m][0])&&B(o[v])?parseFloat(o[v])==0?y=De.d:y=xt(t[m][0],e,o[v]):y=De.v,p.push(y)}u.push(p)}}else return De.na;else if(N(o[0])=="array")if(o[0].length==t.length)for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){t[m]=s(t[m]),o[h][m]=s(o[h][m]);let p;B(t[m])&&B(o[h][m])?parseFloat(o[h][m])==0?p=De.d:p=xt(t[m],e,o[h][m]):p=De.v,d.push(p)}u.push(d)}else if(o[0].length==1){let h=o.length,d=t.length;for(let m=0;m<h;m++){let p=[];for(let v=0;v<d;v++){t[v]=s(t[v]),o[m][0]=s(o[m][0]);let y;B(t[v])&&B(o[m][0])?parseFloat(o[m][0])==0?y=De.d:y=xt(t[v],e,o[m][0]):y=De.v,p.push(y)}u.push(p)}}else return De.na;else{if(t.length!=o.length)return De.na;for(let h=0;h<t.length;h++){t[h]=s(t[h]),o[h]=s(o[h]);let d;B(t[h])&&B(o[h])?parseFloat(o[h])==0?d=De.d:d=xt(t[h],e,o[h]):d=De.v,u.push(d)}}return u}else if(N(t)=="array"){o=s(o);let u=[];if(N(t[0])=="array")for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]);let p;B(t[h][m])&&B(o)?parseFloat(o)==0?p=De.d:p=xt(t[h][m],e,o):p=De.v,d.push(p)}u.push(d)}else for(let h=0;h<t.length;h++){t[h]=s(t[h]);let d;B(t[h])&&B(o)?parseFloat(o)==0?d=De.d:d=xt(t[h],e,o):d=De.v,u.push(d)}return u}else if(N(o)=="array"){t=s(t);let u=[];if(N(o[0])=="array")for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){o[h][m]=s(o[h][m]);let p;B(t)&&B(o[h][m])?parseFloat(o[h][m])==0?p=De.d:p=xt(t,e,o[h][m]):p=De.v,d.push(p)}u.push(d)}else for(let h=0;h<o.length;h++){o[h]=s(o[h]);let d;B(t)&&B(o[h])?parseFloat(o[h])==0?d=De.d:d=xt(t,e,o[h]):d=De.v,u.push(d)}return u}else{t=s(t),o=s(o);let u;return B(t)&&B(o)?parseFloat(o)==0?u=De.d:u=xt(t,e,o):u=De.v,u}else if(e=="+"||e=="-"||e=="%")if(N(t)=="array"&&N(o)=="array"){let u=[];if(N(t[0])=="array"&&N(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return De.na;for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]),o[h][m]=s(o[h][m]);let p;B(t[h][m])&&B(o[h][m])?e=="%"&&parseFloat(o[h][m])==0?p=De.d:p=xt(t[h][m],e,o[h][m]):p=De.v,d.push(p)}u.push(d)}}else if(N(t[0])=="array"){if(t[0].length!=o.length)return De.na;for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]),o[m]=s(o[m]);let p;B(t[h][m])&&B(o[m])?e=="%"&&parseFloat(o[m])==0?p=De.d:p=xt(t[h][m],e,o[m]):p=De.v,d.push(p)}u.push(d)}}else if(N(o[0])=="array"){if(o[0].length!=t.length)return De.na;for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){t[m]=s(t[m]),o[h][m]=s(o[h][m]);let p;B(t[m])&&B(o[h][m])?e=="%"&&parseFloat(o[h][m])==0?p=De.d:p=xt(t[m],e,o[h][m]):p=De.v,d.push(p)}u.push(d)}}else{if(t.length!=o.length)return De.na;for(let h=0;h<t.length;h++){t[h]=s(t[h]),o[h]=s(o[h]);let d;B(t[h])&&B(o[h])?e=="%"&&parseFloat(o[h])==0?d=De.d:d=xt(t[h],e,o[h]):d=De.v,u.push(d)}}return u}else if(N(t)=="array"){o=s(o);let u=[];if(N(t[0])=="array")for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]);let p;B(t[h][m])&&B(o)?e=="%"&&parseFloat(o)==0?p=De.d:p=xt(t[h][m],e,o):p=De.v,d.push(p)}u.push(d)}else for(let h=0;h<t.length;h++){t[h]=s(t[h]);let d;B(t[h])&&B(o)?e=="%"&&parseFloat(o)==0?d=De.d:d=xt(t[h],e,o):d=De.v,u.push(d)}return u}else if(N(o)=="array"){t=s(t);let u=[];if(N(o[0])=="array")for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){o[h][m]=s(o[h][m]);let p;B(t)&&B(o[h][m])?e=="%"&&parseFloat(o[h][m])==0?p=De.d:p=xt(t,e,o[h][m]):p=De.v,d.push(p)}u.push(d)}else for(let h=0;h<o.length;h++){o[h]=s(o[h]);let d;B(t)&&B(o[h])?e=="%"&&parseFloat(o[h])==0?d=De.d:d=xt(t,e,o[h]):d=De.v,u.push(d)}return u}else{t=s(t),o=s(o);let u;return B(t)&&B(o)?e=="%"&&parseFloat(o)==0?u=De.d:u=xt(t,e,o):u=De.v,u}else if(e=="=="||e=="!="||e==">="||e=="<="||e==">"||e=="<")if(N(t)=="array"&&N(o)=="array"){let u=[];if(N(t[0])=="array"&&N(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return De.na;for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){let p=a(t[h][m],e,o[h][m]);d.push(p)}u.push(d)}}else if(N(t[0])=="array"){if(t[0].length!=o.length)return De.na;for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){let p=a(t[h][m],e,o[m]);d.push(p)}u.push(d)}}else if(N(o[0])=="array"){if(o[0].length!=t.length)return De.na;for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){let p=a(t[m],e,o[h][m]);d.push(p)}u.push(d)}}else{if(t.length!=o.length)return De.na;for(let h=0;h<t.length;h++){let d=a(t[h],e,o[h]);u.push(d)}}return u}else if(N(t)=="array"){let u=[];if(N(t[0])=="array")for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){let p=a(t[h][m],e,o);d.push(p)}u.push(d)}else for(let h=0;h<t.length;h++){let d=a(t[h],e,o);u.push(d)}return u}else if(N(o)=="array"){let u=[];if(N(o[0])=="array")for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){let p=a(t,e,o[h][m]);d.push(p)}u.push(d)}else for(let h=0;h<o.length;h++){let d=a(t,e,o[h]);u.push(d)}return u}else return a(t,e,o);else if(e=="&")if(N(t)=="array"&&N(o)=="array"){let u=[];if(N(t[0])=="array"&&N(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return De.na;for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++)d.push(t[h][m]+""+o[h][m]);u.push(d)}}else if(N(t[0])=="array"){if(t[0].length!=o.length)return De.na;for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++)d.push(t[h][m]+""+o[m]);u.push(d)}}else if(N(o[0])=="array"){if(o[0].length!=t.length)return De.na;for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++)d.push(t[m]+""+o[h][m]);u.push(d)}}else{if(t.length!=o.length)return De.na;for(let h=0;h<t.length;h++)u.push(t[h]+""+o[h])}return u}else if(N(t)=="array"){let u=[];if(N(t[0])=="array")for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++)d.push(t[h][m]+""+o);u.push(d)}else for(let h=0;h<t.length;h++)u.push(t[h]+""+o);return u}else if(N(o)=="array"){let u=[];if(N(o[0])=="array")for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++)d.push(t+""+o[h][m]);u.push(d)}else for(let h=0;h<o.length;h++)u.push(t+""+o[h]);return u}else return t+""+o;else if(e=="^")if(N(t)=="array"&&N(o)=="array"){let u=[];if(N(t[0])=="array"&&N(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return De.na;for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]),o[h][m]=s(o[h][m]);let p;B(t[h][m])&&B(o[h][m])?p=Math.pow(parseFloat(t[h][m]),parseFloat(o[h][m])):p=De.v,d.push(p)}u.push(d)}}else if(N(t[0])=="array"){if(t[0].length!=o.length)return De.na;for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]),o[m]=s(o[m]);let p;B(t[h][m])&&B(o[m])?p=Math.pow(parseFloat(t[h][m]),parseFloat(o[m])):p=De.v,d.push(p)}u.push(d)}}else if(N(o[0])=="array"){if(o[0].length!=t.length)return De.na;for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){t[m]=s(t[m]),o[h][m]=s(o[h][m]);let p;B(t[m])&&B(o[h][m])?p=Math.pow(parseFloat(t[m]),parseFloat(o[h][m])):p=De.v,d.push(p)}u.push(d)}}else{if(t.length!=o.length)return De.na;for(let h=0;h<t.length;h++){t[h]=s(t[h]),o[h]=s(o[h]);let d;B(t[h])&&B(o[h])?d=Math.pow(parseFloat(t[h]),parseFloat(o[h])):d=De.v,u.push(d)}}return u}else if(N(t)=="array"){o=s(o);let u=[];if(N(t[0])=="array")for(let h=0;h<t.length;h++){let d=[];for(let m=0;m<t[h].length;m++){t[h][m]=s(t[h][m]);let p;B(t[h][m])&&B(o)?p=Math.pow(parseFloat(t[h][m]),parseFloat(o)):p=De.v,d.push(p)}u.push(d)}else for(let h=0;h<t.length;h++){t[h]=s(t[h]);let d;B(t[h])&&B(o)?d=Math.pow(parseFloat(t[h]),parseFloat(o)):d=De.v,u.push(d)}return u}else if(N(o)=="array"){t=s(t);let u=[];if(N(o[0])=="array")for(let h=0;h<o.length;h++){let d=[];for(let m=0;m<o[h].length;m++){o[h][m]=s(o[h][m]);let p;B(t)&&B(o[h][m])?p=Math.pow(parseFloat(t),parseFloat(o[h][m])):p=De.v,d.push(p)}u.push(d)}else for(let h=0;h<o.length;h++){o[h]=s(o[h]);let d;B(t)&&B(o[h])?d=Math.pow(parseFloat(t),parseFloat(o[h])):d=De.v,u.push(d)}return u}else{t=s(t),o=s(o);let u;return B(t)&&B(o)?u=Math.pow(parseFloat(t),parseFloat(o)):u=De.v,u}}function ac(){let e=arguments[0];e=e.replace("{","").replace("}","").replace(/\"/g,"");let n=[];if(e.indexOf(";")>-1){n=e.split(";");for(let t=0;t<n.length;t++)n[t]=n[t].split(",")}else n=e.split(",");return n}function xt(e,n,t){let l;return n=="+"?l=(0,Eo.default)(e).add(t).value():n=="-"?l=(0,Eo.default)(e).subtract(t).value():n=="%"?l=new Function("return "+parseFloat(e)+n+"("+parseFloat(t)+")")():n=="/"?l=(0,Eo.default)(e).divide(t).value():n=="*"&&(l=(0,Eo.default)(e).multiply(t).value()),l}function Fr(e){if(window.luckysheet_getcelldata_cache==null&&(window.luckysheet_getcelldata_cache={}),e in window.luckysheet_getcelldata_cache)return window.luckysheet_getcelldata_cache[e];let n=At(),t=e.split("!"),l="",o="",a=-1,s=null;if(t.length>1){l=t[0].replace(/''/g,"'"),o=t[1],l.substr(0,1)=="'"&&l.substr(l.length-1,1)=="'"&&(l=l.substring(1,l.length-1));for(let u in n)if(l==n[u].name){a=n[u].index,s=n[u].data;break}a==-1&&(a=0)}else{let u=Z(f.calculateSheetIndex);l=n[u].name,a=n[u].index,s=n[u].data,o=t[0]}if(o.indexOf(":")==-1){let u=parseInt(o.replace(/[^0-9]/g,""))-1,h=fl(o.replace(/[^A-Za-z]/g,""));if(!isNaN(u)&&!isNaN(h)){let d=Co(s,{row:[u,u],column:[h,h]})[0][0];if(g.execFunctionGlobalData!=null){let y=g.execFunctionGlobalData[u+"_"+h+"_"+a];y!=null&&(d=y)}let v={sheetName:l,startCell:o,rowl:1,coll:1,data:d};return window.luckysheet_getcelldata_cache[e]=v,v}else return[]}else{o=o.split(":");let u=[],h=[];if(u[0]=parseInt(o[0].replace(/[^0-9]/g,""))-1,u[1]=parseInt(o[1].replace(/[^0-9]/g,""))-1,isNaN(u[0])&&(u[0]=0),isNaN(u[1])&&(u[1]=s.length-1),u[0]>u[1])return W.info("\u9009\u62E9\u5931\u8D25","\u8F93\u5165\u8303\u56F4\u9519\u8BEF\uFF01"),[];if(h[0]=fl(o[0].replace(/[^A-Za-z]/g,"")),h[1]=fl(o[1].replace(/[^A-Za-z]/g,"")),isNaN(h[0])&&(h[0]=0),isNaN(h[1])&&(h[1]=s[0].length-1),h[0]>h[1])return W.info("\u9009\u62E9\u5931\u8D25","\u8F93\u5165\u8303\u56F4\u9519\u8BEF\uFF01"),[];let d=Co(s,{row:u,column:h});if(g.execFunctionGlobalData!=null)for(let y=u[0];y<=u[1];y++)for(let k=h[0];k<=h[1];k++){let b=g.execFunctionGlobalData[y+"_"+k+"_"+a];b!=null&&(d[y-u[0]][k-h[0]]=b)}let m=u[1]-u[0]+1,p=h[1]-h[0]+1,v={sheetName:l,startCell:o[0],rowl:m,coll:p,data:d};return window.luckysheet_getcelldata_cache[e]=v,v}}function Xi(e){if(typeof e=="object")return e==null?"":Array.isArray(e)?nt(e[0])[2]:Array.isArray(e.data)?De.v:e.data.v===void 0?"":e.data.v;if(g.isCompareOperator(e).flag){if(typeof e=="string"||typeof e=="number")return e}else return nt(e)[2];return De.v}function jn(){let e=arguments[0];for(let n=0;n<e.length;n++){let t=e[n];typeof t=="object"?t==null?t="":Array.isArray(t)?t=nt(t[0])[2]:Array.isArray(t.data)?t=t.data:t.data.v===void 0?t="":t=t.data.v:g.isCompareOperator(t).flag||(t=nt(t)[2]),e[n]=t}}function sc(){let e=arguments[0];return e==null||e.length==0?null:e}function cc(e){return e}function uc(){if(!(N(arguments[0])=="object"&&arguments[0].startCell!=null))return g.error.v;var e=arguments[0].startCell,n=D.getFirstValue(arguments[1]);if(H(n))return n;if(!B(n))return g.error.v;n=parseInt(n);var t=D.getFirstValue(arguments[2]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=arguments[0].rowl;if(arguments.length>=4){if(l=D.getFirstValue(arguments[3]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}var o=arguments[0].coll;if(arguments.length==5){if(o=D.getFirstValue(arguments[4]),H(o))return o;if(!B(o))return g.error.v;o=parseInt(o)}if(l<1||o<1)return g.error.r;var a=g.getcellrange(e),s=a.row[0],u=a.column[0];s+=n,u+=t;var h=s+l-1,d=u+o-1;return s<0||h>=f.flowdata.length||u<0||d>=f.flowdata[0].length?g.error.r:Mt(f.calculateSheetIndex,{row:[s,h],column:[u,d]})}function fc(e,n,t){let l,o;if(e?(o=n,l=t):(l=n,o=t),l.startCell.indexOf(":")>-1||o.indexOf(":")>-1)return De.v;if(e)return Fr(o+":"+l.startCell);{let a=o,s="";if(o.indexOf("!")>-1){let u=o.split("!");s=u[0]+"!",a=u[1]}return Fr(s+l.startCell+":"+a)}}var Eo,xa=Me(()=>{No();Ut();ll();Nt();Kt();Fl();oc();Et();ht();Ke();Eo=El(ai())});var Ov,g,Ut=Me(()=>{ht();Et();Zn();Wt();dl();ol();Qt();Hl();Ml();gr();Zt();Nt();Lr();dr();Kt();$r();Fl();Jt();ll();Zl();dn();Yt();mn();xa();Ke();kt();Li();Nl();Ov={error:{v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},errorInfo:function(e){return e},errorParamCheck:function(e,n,t){let l,o,s=Q().formulaMore;return t<e.length?(l=e[t].type,o=e[t].require):(l=e[e.length-1].type,o=e[e.length-1].require),o=="o"&&(n==null||n=="")?[!0,s.tipSuccessText]:l.indexOf("all")>-1?[!0,s.tipSuccessText]:l.indexOf("range")>-1&&(N(n)=="object"||N(n)=="array")?[!0,s.tipSuccessText]:l.indexOf("number")>-1&&(B(n)||N(n)=="boolean")?[!0,s.tipSuccessText]:l.indexOf("string")>-1&&N(n)=="string"?[!0,s.tipSuccessText]:l.indexOf("date")>-1&&zt(n)?[!0,s.tipSuccessText]:[!1,s.tipParamErrorText]},getPureValueByData:function(e){if(e.length==0)return[];let n=[];if(N(e)=="array")if(N(e[0])=="array")for(let t=0;t<e.length;t++){let l=[];for(let o=0;o<e[0].length;o++){let a=e[t][o];N(a)=="object"?l.push(a.v):l.push(a)}n.push(l)}else for(let t=0;t<e.length;t++){let l=e[t];N(l)=="object"?n.push(l.v):n.push(l)}else{let t=e;N(t)=="object"?n.push(t.v):n.push(t)}return n},readCellDataToOneArray:function(e){let n=this;if(e==null)return[];if(N(e)!="object")return[e];let t=[],l=[];if(e!=null&&e.data!=null)l=e.data;else return e!=null&&!me(e.v)?[e.v]:[];if(N(l)=="array")l=n.getPureValueByData(l);else{if(N(l)=="object")return l=l.v,[l];/\{.*?\}/.test(l)&&(l=l.replace(/\{/g,"[").replace(/\}/g,"]")),l=new Function("return "+l)()}if(N(l[0])=="array")for(let o=0;o<l.length;o++)t=t.concat(l[o]);else t=l;return t},getValueByFuncData:function(e,n){if(e==null)return null;let t=this;return N(e)=="array"?n=="avg"?luckysheet_function.AVERAGE.f.apply(luckysheet_function.AVERAGE,e):n=="sum"?luckysheet_function.SUM.f.apply(luckysheet_function.SUM,e):N(e[0])=="object"?luckysheet.mask.getValueByFormat(e[0]):e[0]:N(e)=="object"?luckysheet.mask.getValueByFormat(e):e},sparklinesColorMap:function(e,n){let t=this,l=null;n==null&&(n=5);let o=0;if(e.length>n)for(let a=n;a<e.length;a++){let s=e[a],u=t.readCellDataToOneArray(s);for(let h=0;h<u.length;h++){let d=u[h];if(d.indexOf(":")>-1){l||(l={});let m=d.split(":");m.length==2?l[m[0]]=m[1]:m.length>1&&(l[m[0]+":"+m[1]]=m[2])}else l||(l=[]),l.push(d)}o++}return l},colorList:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],classlist:{province:{11:"\u5317\u4EAC",12:"\u5929\u6D25",13:"\u6CB3\u5317",14:"\u5C71\u897F",15:"\u5185\u8499\u53E4",21:"\u8FBD\u5B81",22:"\u5409\u6797",23:"\u9ED1\u9F99\u6C5F",31:"\u4E0A\u6D77",32:"\u6C5F\u82CF",33:"\u6D59\u6C5F",34:"\u5B89\u5FBD",35:"\u798F\u5EFA",36:"\u6C5F\u897F",37:"\u5C71\u4E1C",41:"\u6CB3\u5357",42:"\u6E56\u5317",43:"\u6E56\u5357",44:"\u5E7F\u4E1C",45:"\u5E7F\u897F",46:"\u6D77\u5357",50:"\u91CD\u5E86",51:"\u56DB\u5DDD",52:"\u8D35\u5DDE",53:"\u4E91\u5357",54:"\u897F\u85CF",61:"\u9655\u897F",62:"\u7518\u8083",63:"\u9752\u6D77",64:"\u5B81\u590F",65:"\u65B0\u7586",71:"\u53F0\u6E7E",81:"\u9999\u6E2F",82:"\u6FB3\u95E8",91:"\u56FD\u5916"}},oldvalue:null,dontupdate:function(){let e=this;f.luckysheetCellUpdate.length=0,$("#luckysheet-functionbox-cell, #luckysheet-rich-text-editor").html(e.oldvalue),e.cancelNormalSelected(),e.rangetosheet!=f.currentSheetIndex&&ye.changeSheetExec(e.rangetosheet)},xssDeal:function(e){return typeof e!="string"?e:e.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")},ltGtSignDeal:function(e){return typeof e!="string"||e.substr(0,5)==="<span"||e.startsWith("=")?e:e.replace(/</g,"&lt;").replace(/>/g,"&gt;")},fucntionboxshow:function(e,n){if(!va(e,n,f.currentSheetIndex)){$("#luckysheet-functionbox-cell").html("");return}let t=this,l=f.flowdata,o="";if(l[e]!=null&&l[e][n]!=null){let a=$.extend(!0,{},l[e][n]);_l(a)?o=wh(e,n):a.f!=null?o=Le(e,n,l,"f"):o=vn(e,n,l)}o=this.xssDeal(o),t.oldvalue=o,$("#luckysheet-functionbox-cell").html(o)},cellOffset:function(e,n,t,l,o){let a=e.startCell,s=e.rowl,u=e.coll,h=parseInt(a.replace(/[^0-9]/g,"")),d=fl(a.replace(/[^A-Za-z]/g,"")),m=[],p=[],v;m[0]=h+n,p[0]=d+t,m[1]=m[0]+l-1,p[1]=p[0]+o-1,p[0]=tt(p[0]),p[1]=tt(p[1]);let y=p[0]+m[0],k=p[1]+m[1];return y==k?v=e.sheetName+"!"+y:v=e.sheetName+"!"+y+":"+k,v},parseDatetoNum:function(e){let n=this;if(typeof e=="object"&&typeof e.v=="number")e=e.v;else if(tr(e)=="num")e=parseFloat(e);else if(tr(e)=="date")e=nt(e)[2];else return n.error.v;return e},getRangeArray:function(e){let n=[],t="General";if(e.length==1)for(let l=0;l<e[0].length;l++)if(e[0][l]!=null&&e[0][l].v){n.push(e[0][l].v);let o=e[0][l].ct.fa;t=t=="General"?o:t}else n.push(null);else if(e[0].length==1)for(let l=0;l<e.length;l++)if(e[l][0]!=null&&e[l][0].v){n.push(e[l][0].v);let o=e[l][0].ct.fa;t=t=="General"?o:t}else n.push(null);else for(let l=0;l<e.length;l++)for(let o=0;o<e[l].length;o++)if(e[l][o]!=null&&e[l][o].v){n.push(e[l][o].v);let a=e[l][o].ct.fa;t=t=="General"?a:t}else n.push(null);return e=n,[e,t]},getRangeArrayTwo:function(e){let n=$.extend(!0,[],e);if(n.length==1)for(let t=0;t<n[0].length;t++)n[0][t]instanceof Object&&(n[0][t]!=null&&n[0][t]instanceof Object&&!!n[0][t].m?n[0][t]=n[0][t].m:n[0][t]!=null&&n[0][t]instanceof Object&&!!n[0][t].v?n[0][t]=n[0][t].v:n[0][t]=null);else if(n[0].length==1)for(let t=0;t<n.length;t++)n[t][0]instanceof Object&&(n[t][0]!=null&&n[t][0]instanceof Object&&!!n[t][0].m?n[t][0]=n[t][0].m:n[t][0]!=null&&n[t][0]instanceof Object&&!!n[t][0].v?n[t][0]=n[t][0].v:n[t][0]=null);else for(let t=0;t<n.length;t++)for(let l=0;l<n[t].length;l++)n[t][l]instanceof Object&&(n[t][l]!=null&&n[t][l]instanceof Object&&!!n[t][l].m?n[t][l]=n[t][l].m:n[t][l]!=null&&n[t][l]instanceof Object&&!!n[t][l].v?n[t][l]=n[t][l].v:n[t][l]=null);return n},isWildcard:function(e,n){let t=this;e=e.toString(),n=n.toString(),t.isCompareOperator(n).flag&&(n=t.isCompareOperator(n).num);let l="";for(let a=0;a<n.length;a++){let s=n.charAt(a);s=="*"?l+=".*":s=="?"?l+=".":s=="~"?n.charAt(a+1)=="*"?(l+="\\*",a++):n.charAt(a+1)=="?"?(l+="\\?",a++):l+="~":l+=s}let o=new RegExp("^"+l+"$","g");return!!e.match(o)},isCompareOperator:function(e){e=e.toString();let n="",t="",l=e.substr(0,1),o=e.substr(1,1),a=!1,s;return l==">"?o=="="?(n=e.substr(0,2),t=e.substr(2),a=!0):o!="="&&(n=e.substr(0,1),t=e.substr(1),a=!0):l=="<"?o=="="||o==">"?(n=e.substr(0,2),t=e.substr(2),a=!0):o!="="&&o!=">"&&(n=e.substr(0,1),t=e.substr(1),a=!0):l=="="&&o!="="&&(n=e.substr(0,1),t=e.substr(1),a=!0),s={flag:a,ope:n,num:t},s},acompareb:function(e,n){let t=this,l=!1;if(B(n))l=Yi(e,"==",n);else if(typeof n=="string"){if(n.indexOf("*")!=-1||n.indexOf("?")!=-1)return t.isWildcard(e,n);if(t.isCompareOperator(n).flag){let o=t.isCompareOperator(n).ope,a=t.isCompareOperator(n).num;l=Yi(e,o,a)}else l=Yi(e,"==",n)}return l},compareParams:function(e,n,t){let l=!1,o=toString.call(e),a=toString.call(n);if((t==">"&&e>n||t==">="&&e>=n||t=="<"&&e<n||t=="<="&&e<=n||t=="="&&e==n||t=="<>"&&e!=n)&&(l=!0),o=="[object Object]"&&a=="[object Object]"){let s=Object.getOwnPropertyNames(e),u=Object.getOwnPropertyNames(n);if(s.length!=u.length)return!1;for(let h=0;h<s.length;h++){let d=s[h];if(e[d]!==n[d])return!1}return!0}return o=="[object Array]"&&a=="[object Array]"?e.toString()==n.toString():l},parseDecimal:function(e){e=parseFloat(e);let n=parseInt(e,10);return n==0||(e=e%n),e},getcellrange:function(e,n){if(e==null||e.length==0)return;let t="",l="",o=null,a=null,s=At();if(e.indexOf("!")>-1){if(e in this.cellTextToIndexList)return this.cellTextToIndexList[e];let u=e.split("!");t=u[0],l=u[1],t=t.replace(/\\'/g,"'").replace(/''/g,"'"),t.substr(0,1)=="'"&&t.substr(t.length-1,1)=="'"&&(t=t.substring(1,t.length-1));for(let h in s)if(t==s[h].name){o=s[h].index,a=s[h].data;break}}else{let u=n;if(u==null&&(u=f.currentSheetIndex),e+"_"+u in this.cellTextToIndexList)return this.cellTextToIndexList[e+"_"+u];let h=Z(u);t=s[h].name,o=s[h].index,a=f.flowdata,l=e}if(l.indexOf(":")==-1){let u=parseInt(l.replace(/[^0-9]/g,""))-1,h=fl(l.replace(/[^A-Za-z]/g,""));if(!isNaN(u)&&!isNaN(h)){let d={row:[u,u],column:[h,h],sheetIndex:o};return this.addToCellIndexList(e,d),d}else return null}else{l=l.split(":");let u=[],h=[];if(u[0]=parseInt(l[0].replace(/[^0-9]/g,""))-1,u[1]=parseInt(l[1].replace(/[^0-9]/g,""))-1,isNaN(u[0])&&(u[0]=0),isNaN(u[1])&&(u[1]=a.length-1),u[0]>u[1]||(h[0]=fl(l[0].replace(/[^A-Za-z]/g,"")),h[1]=fl(l[1].replace(/[^A-Za-z]/g,"")),isNaN(h[0])&&(h[0]=0),isNaN(h[1])&&(h[1]=a[0].length-1),h[0]>h[1]))return null;let d={row:u,column:h,sheetIndex:o};return this.addToCellIndexList(e,d),d}},rangeHightlightHTML:'<div id="luckysheet-formula-functionrange-highlight-${id}" rangeindex="${id}"  class="luckysheet-selection-highlight luckysheet-formula-functionrange-highlight"><div data-type="top" class="luckysheet-selection-copy-top luckysheet-copy"></div><div data-type="right" class="luckysheet-selection-copy-right luckysheet-copy"></div><div data-type="bottom" class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div data-type="left" class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div><div data-type="lt" class="luckysheet-selection-highlight-topleft luckysheet-highlight"></div><div data-type="rt" class="luckysheet-selection-highlight-topright luckysheet-highlight"></div><div data-type="lb" class="luckysheet-selection-highlight-bottomleft luckysheet-highlight"></div><div data-type="rb" class="luckysheet-selection-highlight-bottomright luckysheet-highlight"></div></div>',createRangeHightlight:function(){let e=this,n=$("#luckysheet-rich-text-editor").find("span.luckysheet-formula-functionrange-cell");$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),n.each(function(){let t=$(this).attr("rangeindex"),l=$(this).text();$("#luckysheet-formula-functionrange").append(_e(e.rangeHightlightHTML,{id:t}));let o=e.getcellrange(l),a="luckysheet-formula-functionrange-highlight-"+t;o==null||(o.sheetIndex==f.currentSheetIndex||o.sheetIndex==-1&&e.rangetosheet==f.currentSheetIndex)&&($("#"+a).data("range",o).find(".luckysheet-copy").css({background:Gl[t]}).end().find(".luckysheet-highlight").css({background:Gl[t]}).end().find(".luckysheet-selection-copy-hc").css({background:Gl[t]}),sd(a,o.row[0],o.row[1],o.column[0],o.column[1]))}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").show()},searchHTML:'<div id="luckysheet-formula-search-c" class="luckysheet-formula-search-c"></div>',helpHTML:'<div id="luckysheet-formula-help-c" class="luckysheet-formula-help-c"> <div class="luckysheet-formula-help-close" title="${helpClose}"><i class="fa fa-times" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-collapse" title="${helpCollapse}"><i class="fa fa-angle-up" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-title"><div class="luckysheet-formula-help-title-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div></div> <div class="luckysheet-formula-help-content"> <div class="luckysheet-formula-help-content-example"> <div class="luckysheet-arguments-help-section-title">${helpExample}</div> <div class="luckysheet-arguments-help-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div> </div> <div class="luckysheet-formula-help-content-detail"> <div class="luckysheet-arguments-help-section"> <div class="luckysheet-arguments-help-section-title luckysheet-arguments-help-parameter-name">${helpAbstract}</div> <span class="luckysheet-arguments-help-parameter-content">${helpAbstract}</span> </div> </div> <div class="luckysheet-formula-help-content-param"> ${param} </div> </div> <div class="luckysheet-formula-help-foot"></div></div>',getrangeseleciton:function(){let e=window.getSelection(),n=$(e.anchorNode),t=e.anchorOffset;if(n.parent().is("span")&&t!=0){let l=$.trim(n.text()),o="";if(l.length==0&&n.parent().prev().length>0){let a=n.parent().prev();return l=$.trim(a.text()),o=l.substr(l.length-1,1),a}else return o=l.substr(t-1,1),n.parent()}else if(n.is("#luckysheet-rich-text-editor")||n.is("#luckysheet-functionbox-cell")){let l=$.trim(n.find("span").last().text());if(l.length==0&&n.find("span").length>1){let o=n.find("span");return l=$.trim(o.eq(o.length-2).text()),o}else return n.find("span").last()}else if((n.parent().is("#luckysheet-rich-text-editor")||n.parent().is("#luckysheet-functionbox-cell")||t==0)&&(t==0&&(n=n.parent()),n.prev().length>0)){let l=$.trim(n.prev().text()),o=l.substr(l.length-1,1);return n.prev()}return null},searchFunctionPosition:function(e,n,t,l,o){let a=$(window).height(),s=$(window).width(),u=e.outerWidth(),h=e.outerHeight();o==null&&(o=!1);let d=t;t+u>s?d=t-u+n.outerWidth():d=t;let m=l;l+h>a?m=l-h:(m=l+n.outerHeight(),o||e.html(e.find(".luckysheet-formula-search-item").get().reverse())),m<0&&(m=0),d<0&&(d=0),e.css({top:m,left:d}).show()},searchFunctionCell:null,searchFunction:function(e){let n=this,t=f.functionlist,l=n.getrangeseleciton();if(n.searchFunctionCell=l,l==null||e==null)return;let o=e.text(),a=l.text().toUpperCase();if(!/^[a-zA-Z]|[a-zA-Z_]+$/.test(a)||o.substr(0,1)!="=")return;let u={f:[],s:[],t:[]},h=0;for(let y=0;y<t.length;y++){let k=t[y],b=k.n;if(b==a?(u.f.unshift(k),h++):b.substr(0,a.length)==a?(u.s.unshift(k),h++):b.indexOf(a)>-1&&(u.t.unshift(k),h++),h>=10)break}let d=u.t.concat(u.s.concat(u.f));if(d.length<=0)return;let m=n.searchFunctionHTML(d);$("#luckysheet-formula-search-c").html(m).show(),$("#luckysheet-formula-help-c").hide();let p=e.parent(),v=p.offset();n.searchFunctionPosition($("#luckysheet-formula-search-c"),p,v.left,v.top)},searchFunctionEnter:function(e){let n=this,t=e.data("func");n.searchFunctionCell.text(t).after('<span dir="auto" class="luckysheet-formula-text-color">(</span>'),n.setCaretPosition(n.searchFunctionCell.next().get(0),0,1),$("#luckysheet-formula-search-c").hide(),n.helpFunctionExe(n.searchFunctionCell.closest("div"),n.searchFunctionCell.next())},searchFunctionHTML:function(e){let n=this;$("#luckysheet-formula-search-c").length==0&&($("body").append(n.searchHTML),$("#luckysheet-formula-search-c").on("mouseover",".luckysheet-formula-search-item",function(){$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),$(this).addClass("luckysheet-formula-search-item-active")}).on("mouseout",".luckysheet-formula-search-item",function(){}).on("click",".luckysheet-formula-search-item",function(){n.searchFunctionCell!=null&&n.searchFunctionEnter($(this))}));let t='<div data-func="${n}" class="luckysheet-formula-search-item ${class}"><div class="luckysheet-formula-search-func">${n}</div><div class="luckysheet-formula-search-detail">${a}</div></div>',l="";for(let o=0;o<e.length;o++){let a=e[o];o==e.length-1?l+=_e(t,{class:"luckysheet-formula-search-item-active",n:a.n,a:a.a}):l+=_e(t,{class:"",n:a.n,a:a.a})}return l},functionlistPosition:{},helpFunction:function(e,n,t){let l=this,a=f.functionlist[l.functionlistPosition[$.trim(n).toUpperCase()]];if(a==null)return;let u=Q().formulaMore;$("#luckysheet-formula-help-c .luckysheet-arguments-help-function-name").html(a.n),$("#luckysheet-formula-help-c .luckysheet-arguments-help-parameter-content").html(a.d);let h='<span class="luckysheet-arguments-help-function-name">${name}</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> ${param} </span> <span class="luckysheet-arguments-paren">)</span>',d='<span class="luckysheet-arguments-help-parameter" dir="auto">${param}</span>',m='<div class="luckysheet-arguments-help-section"><div class="luckysheet-arguments-help-section-title">${param}</div><span class="luckysheet-arguments-help-parameter-content">${content}</span></div>',p="",v="",y="";for(let w=0;w<a.p.length;w++){let x=a.p[w],C=x.name,S=x.name;x.repeat=="y"&&(C+=", ...",S+='<span class="luckysheet-arguments-help-argument-info">...-'+u.allowRepeatText+"</span>"),x.require=="o"&&(C="["+C+"]",S+='<span class="luckysheet-arguments-help-argument-info">-['+u.allowOptionText+"]</span>"),p+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+C+"</span>, ",v+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+x.example+"</span>, ",y+=_e(m,{param:S,content:x.detail})}if(p=p.substr(0,p.length-2),v=v.substr(0,v.length-2),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder").html(p),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder").html(v),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param").html(y),t==null)$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","bold");else{$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","normal");let w=t>=a.p.length?a.p.length-1:t;$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(w).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(w).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").eq(w).addClass("luckysheet-arguments-help-parameter-active")}let k=e.parent(),b=k.offset();l.searchFunctionPosition($("#luckysheet-formula-help-c"),k,b.left,b.top,!0)},helpFunctionExe:function(e,n){let t=this,l=f.functionlist,a=Q().formulaMore;if($("#luckysheet-formula-help-c").length==0){$("body").after(_e(t.helpHTML,{helpClose:a.helpClose,helpCollapse:a.helpCollapse,helpExample:a.helpExample,helpAbstract:a.helpAbstract})),$("#luckysheet-formula-help-c .luckysheet-formula-help-close").click(function(){$("#luckysheet-formula-help-c").hide()}),$("#luckysheet-formula-help-c .luckysheet-formula-help-collapse").click(function(){let y=$("#luckysheet-formula-help-c .luckysheet-formula-help-content");y.slideToggle(100,function(){let k=t.rangeResizeTo.parent(),b=k.offset();t.searchFunctionPosition($("#luckysheet-formula-help-c"),k,b.left,b.top,!0)}),y.is(":hidden")?$(this).html('<i class="fa fa-angle-up" aria-hidden="true"></i>'):$(this).html('<i class="fa fa-angle-down" aria-hidden="true"></i>')});for(let y=0;y<l.length;y++)t.functionlistPosition[l[y].n]=y}if(!n)return;let s=n,u=e.length,h=e.find("span"),d=n.index(),m=d;if(s==null)return;let p=null,v=null;if(h.eq(m).is(".luckysheet-formula-text-func"))p=h.eq(m).text();else{let y=null,k=[-1,-1];for(;--m>0;)if(y=h.eq(m),y.is(".luckysheet-formula-text-func")||$.trim(y.text()).toUpperCase()in t.functionlistPosition){p=y.text(),v=null;let b=!0;for(let w=m;w<=d;w++)if(v||(v=0),!(w>=k[0]&&w<=k[1])){if(y=h.eq(w),y.is(".luckysheet-formula-text-rpar")){k=[m,w],p=null,b=!1;break}y.is(".luckysheet-formula-text-comma")&&v++}if(b)break}}p!=null&&t.helpFunction(e,p,v)},rangeHightlightselected:function(e,n){let t=this,l=t.getrangeseleciton();if($("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight .luckysheet-selection-copy-hc").css("opacity","0.03"),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),t.helpFunctionExe(e,l),$(l).closest(".luckysheet-formula-functionrange-cell").length==0){t.searchFunction(e);return}let a=$(l).closest(".luckysheet-formula-functionrange-cell").attr("rangeindex"),s="luckysheet-formula-functionrange-highlight-"+a;$("#"+s).find(".luckysheet-selection-copy-hc").css({opacity:"0.13"})},updatecell:function(e,n,t,l=!0){let o=this,a=$("#luckysheet-rich-text-editor"),s=a.text(),u=a.html();if(o.rangetosheet!=null&&o.rangetosheet!=f.currentSheetIndex&&ye.changeSheetExec(o.rangetosheet),!kn(e,n,f.currentSheetIndex))return;if(Ye.dataVerification!=null){let _=Ye.dataVerification[e+"_"+n];if(_!=null&&_.prohibitInput&&!Ye.validateCellData(s,_)){let T=Ye.getFailureText(_);W.info(T,""),o.cancelNormalSelected();return}}let h=f.flowdata[e][n],d=JSON.stringify(h),m=_l(h),p=s.slice(0,1)!="="&&u.substr(0,5)=="<span",v=!1;if(!p&&s&&s.length>0){let _=s.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_").split("_x000D_");_.length>1&&(v=!0,p=!0,s=_.join(`\r
`))}if(!t&&!p&&m?(delete h.ct.s,h.ct.t="g",h.ct.fa="General",t=""):p&&(N(h)!="object"&&(h={}),delete h.f,delete h.v,delete h.m,h.ct==null&&(h.ct={},h.ct.fa="General"),h.ct.t="inlineStr",h.ct.s=vh(a.find("span")),v&&(h.ct.s=[{v:s}])),t=t||a.text(),!Je.createHookFunction("cellUpdateBefore",e,n,t,l)){o.cancelNormalSelected();return}if(!p){if(me(t)&&!m){if(h==null||me(h.v)&&h.spl==null&&h.f==null){o.cancelNormalSelected();return}}else if(h!=null&&h.qp!=1){if(N(h)=="object"&&(t==h.f||t==h.v||t==h.m)){o.cancelNormalSelected();return}else if(t==h){o.cancelNormalSelected();return}}N(t)=="string"&&t.slice(0,1)=="="&&t.length>1||N(h)=="object"&&h.ct!=null&&h.ct.fa!=null&&h.ct.fa!="@"&&!me(t)&&(delete h.m,h.f!=null&&(delete h.f,delete h.spl))}window.luckysheet_getcelldata_cache=null;let y=!0,k=xe.deepCopyFlowData(f.flowdata),b=null;if(N(h)=="object"){if(!p)if(N(t)=="string"&&t.slice(0,1)=="="&&t.length>1){let _=o.execfunction(t,e,n,void 0,!0);if(y=!1,h=$.extend(!0,{},k[e][n]),h.v=_[1],h.f=_[2],_.length==4&&_[3].type=="sparklines"){delete h.m,delete h.v;let T=_[3].data;N(T)=="array"&&N(T[0])!="object"?h.v=T[0]:h.spl=_[3].data}else _.length==4&&_[3].type=="dynamicArrayItem"&&(b=_[3].data)}else if(N(t)=="object"){let _=t.f;if(N(_)=="string"&&_.slice(0,1)=="="&&_.length>1){let T=o.execfunction(_,e,n,void 0,!0);if(y=!1,h=$.extend(!0,{},k[e][n]),h.v=T[1],h.f=T[2],T.length==4&&T[3].type=="sparklines"){delete h.m,delete h.v;let F=T[3].data;N(F)=="array"&&N(F[0])!="object"?h.v=F[0]:h.spl=T[3].data}else T.length==4&&T[3].type=="dynamicArrayItem"&&(b=T[3].data)}else for(let T in t)h[T]=t[T]}else o.delFunctionGroup(e,n),o.execFunctionGroup(e,n,t),y=!1,h=$.extend(!0,{},k[e][n]),h.v=t,delete h.f,delete h.spl,h.qp==1&&(""+t).substr(0,1)!="'"&&(h.qp=0,h.ct!=null&&(h.ct.fa="General",h.ct.t="n"));t=h}else if(N(t)=="string"&&t.slice(0,1)=="="&&t.length>1){let _=o.execfunction(t,e,n,void 0,!0);if(y=!1,t={v:_[1],f:_[2]},_.length==4&&_[3].type=="sparklines"){let T=_[3].data;N(T)=="array"&&N(T[0])!="object"?t.v=T[0]:t.spl=_[3].data}else _.length==4&&_[3].type=="dynamicArrayItem"&&(b=_[3].data)}else if(N(t)=="object"){let _=t.f;if(N(_)=="string"&&_.slice(0,1)=="="&&_.length>1){let T=o.execfunction(_,e,n,void 0,!0);if(y=!1,t.v=T[1],t.f=T[2],T.length==4&&T[3].type=="sparklines"){let F=T[3].data;N(F)=="array"&&N(F[0])!="object"?t.v=F[0]:t.spl=T[3].data}else T.length==4&&T[3].type=="dynamicArrayItem"&&(b=T[3].data)}else{let T=h;t.v==null&&(t.v=T)}}else o.delFunctionGroup(e,n),o.execFunctionGroup(e,n,t),y=!1;Ht(e,n,k,t),o.cancelNormalSelected();let w=!1,x=$.extend(!0,{},At()[Z(f.currentSheetIndex)].config);if(x.rowlen==null&&(x.rowlen={}),k[e][n].tb=="2"&&k[e][n].v!=null||_l(k[e][n])&&typeof k[e][n].mc=="undefined"){let _=f.defaultrowlen,T=$("#luckysheetTableContent").get(0).getContext("2d");if(!(x.customHeight&&x.customHeight[e]==1)){let F=Rt(n)[1]-Rt(n)[0]-2,R=Cr(k[e][n],T,{r:e,c:n,cellWidth:F}),I=_;R!=null&&(I=R.textHeightAll+2),I>_&&(x.rowlen[e]=I,w=!0)}}let C=null;b&&(C=$.extend(!0,[],this.insertUpdateDynamicArray(b)));let S={dynamicArray:C};if(w&&(S={cfg:x,dynamicArray:C,RowlChange:w}),setTimeout(()=>{Je.createHookFunction("cellUpdated",e,n,JSON.parse(d),f.flowdata[e][n],l)},0),l)Ze(k,[{row:[e,e],column:[n,n]}],S,y),o.execFunctionGlobalData=null;else return{data:k,allParam:S}},cancelNormalSelected:function(){let e=this;e.canceFunctionrangeSelected(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-input-box-index").hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").removeClass("luckysheet-wa-calculate-active"),e.rangestart=!1,e.rangedrag_column_start=!1,e.rangedrag_row_start=!1},canceFunctionrangeSelected:function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide()},iscellformat:function(e){let n=/[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ][123456789]/},iscelldata:function(e){let n=e.split("!"),t;n.length>1?t=n[1]:t=n[0];let l=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(t.indexOf(":")==-1){let a=parseInt(t.replace(/[^0-9]/g,""))-1,s=fl(t.replace(/[^A-Za-z]/g,""));return!isNaN(a)&&!isNaN(s)&&t.toString().match(l)?!0:(isNaN(a)&&isNaN(s),!1)}else{o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,t=t.split(":");let a=[],s=[];return a[0]=parseInt(t[0].replace(/[^0-9]/g,""))-1,a[1]=parseInt(t[1].replace(/[^0-9]/g,""))-1,a[0]>a[1]||(s[0]=fl(t[0].replace(/[^A-Za-z]/g,"")),s[1]=fl(t[1].replace(/[^A-Za-z]/g,"")),s[0]>s[1])?!1:!!(t[0].toString().match(o)&&t[1].toString().match(o))}},operator:"==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",operatorjson:null,functionCopy:function(e,n,t){let l=this;if(l.operatorjson==null){let m=l.operator.split("|"),p={};for(let v=0;v<m.length;v++)p[m[v].toString()]=1;l.operatorjson=p}n==null&&(n="down"),t==null&&(t=1),e.substr(0,1)=="="&&(e=e.substr(1));let o=e.split(""),a=0,s="",u="",h=!0,d={bracket:0,comma:0,squote:0,dquote:0};for(;a<o.length;){let m=o[a];if(m=="("&&d.dquote==0)d.bracket+=1,s.length>0?u+=s+"(":u+="(",s="";else if(m==")"&&d.dquote==0)d.bracket-=1,u+=l.functionCopy(s,n,t)+")",s="";else if(m=='"'&&d.squote==0)d.dquote>0?(u+=s+'"',d.dquote-=1,s=""):(d.dquote+=1,s+='"');else if(m==","&&d.dquote==0)u+=l.functionCopy(s,n,t)+",",s="";else if(m=="&"&&d.dquote==0)s.length>0?(u+=l.functionCopy(s,n,t)+"&",s=""):u+="&";else if(m in l.operatorjson&&d.dquote==0){let p="";a+1<o.length&&(p=o[a+1]);let v=a-1,y=null;if(v>=0)do y=o[v--];while(v>=0&&y==" ");m+p in l.operatorjson?(s.length>0?(u+=l.functionCopy(s,n,t)+m+p,s=""):u+=m+p,a++):!/[^0-9]/.test(p)&&m=="-"&&(y=="("||y==null||y==","||y==" "||y in l.operatorjson)?s+=m:s.length>0?(u+=l.functionCopy(s,n,t)+m,s=""):u+=m}else s+=m;a==o.length-1&&(l.iscelldata($.trim(s))?n=="down"?u+=l.downparam($.trim(s),t):n=="up"?u+=l.upparam($.trim(s),t):n=="left"?u+=l.leftparam($.trim(s),t):n=="right"&&(u+=l.rightparam($.trim(s),t)):u+=$.trim(s)),a++}return u},isfreezonFuc:function(e){let n=e.replace(/[^0-9]/g,""),t=e.replace(/[^A-Za-z]/g,""),l=e.substr(e.indexOf(n)-1,1),o=e.substr(e.indexOf(t)-1,1),a=[!1,!1];return l=="$"&&(a[0]=!0),o=="$"&&(a[1]=!0),a},setfreezonFuceExe:function(e){let n=parseInt(e.replace(/[^0-9]/g,"")),t=fl(e.replace(/[^A-Za-z]/g,"")),l="$",o="$";return!isNaN(n)&&!isNaN(t)?o+tt(t)+l+n:isNaN(n)?isNaN(t)?e:o+tt(t):l+n},setfreezonFuc:function(e){let n=this,t=n.getrangeseleciton();if(!n.iscelldata(t.text()))return;let l=t.text(),o=window.getSelection().anchorOffset,a=l.split("!"),s,u="";a.length>1?(s=a[1],u=a[0]+"!"):s=a[0];let h="",d="",m=s.indexOf(":");if(m==-1)h=u+n.setfreezonFuceExe(s),d=h.length;else if(s=s.split(":"),o>m){let p=u+s[0]+":"+n.setfreezonFuceExe(s[1]);h=p,d=p.length}else{let p=u+n.setfreezonFuceExe(s[0]);h=p+":"+s[1],d=p.length}t.text(u+h),n.setCaretPosition(t.get(0),0,d)},updateparam:function(e,n,t){let l=this,o=n.split("!"),a,s="";if(o.length>1?(a=o[1],s=o[0]+"!"):a=o[0],a.indexOf(":")==-1){let u=parseInt(a.replace(/[^0-9]/g,"")),h=fl(a.replace(/[^A-Za-z]/g,"")),d=l.isfreezonFuc(a),m=d[0]?"$":"",p=d[1]?"$":"";return e=="u"&&!d[0]?u-=t:e=="r"&&!d[1]?h+=t:e=="l"&&!d[1]?h-=t:e=="d"&&!d[0]&&(u+=t),u[0]<0||h[0]<0?l.error.r:!isNaN(u)&&!isNaN(h)?s+p+tt(h)+m+u:isNaN(u)?isNaN(h)?n:s+p+tt(h):s+m+u}else{a=a.split(":");let u=[],h=[];if(u[0]=parseInt(a[0].replace(/[^0-9]/g,"")),u[1]=parseInt(a[1].replace(/[^0-9]/g,"")),u[0]>u[1]||(h[0]=fl(a[0].replace(/[^A-Za-z]/g,"")),h[1]=fl(a[1].replace(/[^A-Za-z]/g,"")),h[0]>h[1]))return n;let d=l.isfreezonFuc(a[0]),m=l.isfreezonFuc(a[1]),p=d[0]?"$":"",v=d[1]?"$":"",y=m[0]?"$":"",k=m[1]?"$":"";return e=="u"?(d[0]||(u[0]-=t),m[0]||(u[1]-=t)):e=="r"?(d[1]||(h[0]+=t),m[1]||(h[1]+=t)):e=="l"?(d[1]||(h[0]-=t),m[1]||(h[1]-=t)):e=="d"&&(d[0]||(u[0]+=t),m[0]||(u[1]+=t)),u[0]<0||h[0]<0?l.error.r:isNaN(h[0])&&isNaN(h[1])?s+p+u[0]+":"+y+u[1]:isNaN(u[0])&&isNaN(u[1])?s+v+tt(h[0])+":"+k+tt(h[1]):s+v+tt(h[0])+p+u[0]+":"+k+tt(h[1])+y+u[1]}},downparam:function(e,n){return this.updateparam("d",e,n)},upparam:function(e,n){return this.updateparam("u",e,n)},leftparam:function(e,n){return this.updateparam("l",e,n)},rightparam:function(e,n){return this.updateparam("r",e,n)},functionStrChange:function(e,n,t,l,o,a){let s=this;if(s.operatorjson==null){let y=s.operator.split("|"),k={};for(let b=0;b<y.length;b++)k[y[b].toString()]=1;s.operatorjson=k}e.substr(0,1)=="="&&(e=e.substr(1));let u=e.split(""),h=0,d="",m="",p=!0,v={bracket:0,comma:0,squote:0,dquote:0};for(;h<u.length;){let y=u[h];if(y=="("&&v.dquote==0)v.bracket+=1,d.length>0?m+=d+"(":m+="(",d="";else if(y==")"&&v.dquote==0)v.bracket-=1,m+=s.functionStrChange(d,n,t,l,o,a)+")",d="";else if(y=='"'&&v.squote==0)v.dquote>0?(m+=d+'"',v.dquote-=1,d=""):(v.dquote+=1,d+='"');else if(y==","&&v.dquote==0)m+=s.functionStrChange(d,n,t,l,o,a)+",",d="";else if(y=="&"&&v.dquote==0)d.length>0?(m+=s.functionStrChange(d,n,t,l,o,a)+"&",d=""):m+="&";else if(y in s.operatorjson&&v.dquote==0){let k="";h+1<u.length&&(k=u[h+1]);let b=h-1,w=null;if(b>=0)do w=u[b--];while(b>=0&&w==" ");y+k in s.operatorjson?(d.length>0?(m+=s.functionStrChange(d,n,t,l,o,a)+y+k,d=""):m+=y+k,h++):!/[^0-9]/.test(k)&&y=="-"&&(w=="("||w==null||w==","||w==" "||w in s.operatorjson)?d+=y:d.length>0?(m+=s.functionStrChange(d,n,t,l,o,a)+y,d=""):m+=y}else d+=y;h==u.length-1&&(s.iscelldata($.trim(d))?m+=s.functionStrChange_range($.trim(d),n,t,l,o,a):m+=$.trim(d)),h++}return m},functionStrChange_range:function(e,n,t,l,o,a){let s=this,u=e.split("!"),h,d="";u.length>1?(h=u[1],d=u[0]+"!"):h=u[0];let m,p,v,y,k,b,w,x;if(h.indexOf(":")==-1){m=p=parseInt(h.replace(/[^0-9]/g,""))-1,v=y=fl(h.replace(/[^A-Za-z]/g,""));let C=s.isfreezonFuc(h);k=b=C[0]?"$":"",w=x=C[1]?"$":""}else{if(h=h.split(":"),m=parseInt(h[0].replace(/[^0-9]/g,""))-1,p=parseInt(h[1].replace(/[^0-9]/g,""))-1,m>p||(v=fl(h[0].replace(/[^A-Za-z]/g,"")),y=fl(h[1].replace(/[^A-Za-z]/g,"")),v>y))return e;let C=s.isfreezonFuc(h[0]);k=C[0]?"$":"",w=C[1]?"$":"";let S=s.isfreezonFuc(h[1]);b=S[0]?"$":"",x=S[1]?"$":""}if(n=="del"){if(t=="row"){if(m>=o&&p<=o+a-1)return s.error.r;m>o+a-1?m-=a:m>=o&&(m=o),p>o+a-1?p-=a:p>=o&&(p=o-1),m<0&&(m=0),p<m&&(p=m)}else if(t=="col"){if(v>=o&&y<=o+a-1)return s.error.r;v>o+a-1?v-=a:v>=o&&(v=o),y>o+a-1?y-=a:y>=o&&(y=o-1),v<0&&(v=0),y<v&&(y=v)}return m==p&&v==y?!isNaN(m)&&!isNaN(v)?d+w+tt(v)+k+(m+1):isNaN(m)?isNaN(v)?e:d+w+tt(v):d+k+(m+1):isNaN(v)&&isNaN(y)?d+k+(m+1)+":"+b+(p+1):isNaN(m)&&isNaN(p)?d+w+tt(v)+":"+x+tt(y):d+w+tt(v)+k+(m+1)+":"+x+tt(y)+b+(p+1)}else if(n=="add")return t=="row"?l=="lefttop"?(m>=o&&(m+=a),p>=o&&(p+=a)):l=="rightbottom"&&(m>o&&(m+=a),p>o&&(p+=a)):t=="col"&&(l=="lefttop"?(v>=o&&(v+=a),y>=o&&(y+=a)):l=="rightbottom"&&(v>o&&(v+=a),y>o&&(y+=a))),m==p&&v==y?!isNaN(m)&&!isNaN(v)?d+w+tt(v)+k+(m+1):isNaN(m)?isNaN(v)?e:d+w+tt(v):d+k+(m+1):isNaN(v)&&isNaN(y)?d+k+(m+1)+":"+b+(p+1):isNaN(m)&&isNaN(p)?d+w+tt(v)+":"+x+tt(y):d+w+tt(v)+k+(m+1)+":"+x+tt(y)+b+(p+1)},israngeseleciton:function(e){let n=this;if(n.operatorjson==null){let a=n.operator.split("|"),s={};for(let u=0;u<a.length;u++)s[a[u].toString()]=1;n.operatorjson=s}e==null&&(e=!1);let t=window.getSelection(),l=$(t.anchorNode),o=t.anchorOffset;if(l.parent().is("span")&&o!=0){let a=$.trim(l.text()),s="";if(a.length==0&&l.parent().prev().length>0){let u=l.parent().prev();a=$.trim(u.text()),s=a.substr(a.length-1,1),n.rangeSetValueTo=u}else s=a.substr(o-1,1),n.rangeSetValueTo=l.parent();if(e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}else if(l.is("#luckysheet-rich-text-editor")||l.is("#luckysheet-functionbox-cell")){let a=$.trim(l.find("span").last().text()),s;if(n.rangeSetValueTo=l.find("span").last(),a.length==0&&l.find("span").length>1){let u=l.find("span");a=$.trim(u.eq(u.length-2).text()),n.rangeSetValueTo=u}if(s=a.substr(a.length-1,1),e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}else if((l.parent().is("#luckysheet-rich-text-editor")||l.parent().is("#luckysheet-functionbox-cell")||o==0)&&(o==0&&(l=l.parent()),l.prev().length>0)){let a=$.trim(l.prev().text()),s=a.substr(a.length-1,1);if(n.rangeSetValueTo=l.prev(),e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}return!1},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangeSetValue:function(e,n){let t=this,l="",o=e.row[0],a=e.column[0];f.config.merge!=null&&o+"_"+a in f.config.merge?l=Mt(f.currentSheetIndex,{column:[a,a],row:[o,o]},t.rangetosheet):l=Mt(f.currentSheetIndex,e,t.rangetosheet);let s;if(t.rangestart||t.rangedrag_column_start||t.rangedrag_row_start)if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")){s=$("#luckysheet-rich-text-editor"),$("#luckysheet-search-formula-parm-select-input").val(l),$("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".txt input").val(l);let u=Fr(l).data;if(u instanceof Array){let y=[];for(let k=0;k<u.length;k++)for(let b=0;b<u[k].length;b++)u[k][b]==null?y.push(null):y.push(u[k][b].v);$("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".val").text(" = {"+y.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".val").text(" = {"+u.v+"}");let h=!0,d=[],m=-1;$("#luckysheet-search-formula-parm .parmBox").each(function(y,k){let b=$(k).find(".txt input").val();b==""&&$(k).find(".txt input").attr("data_parm_require")=="m"&&(h=!1),b!=""&&(m=y)});let p;if(m==-1)p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(m==0)p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(let y=0;y<=m;y++)d.push($("#luckysheet-search-formula-parm .parmBox").eq(y).find(".txt input").val());p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+d.join(",")+")"}let v=t.functionHTMLGenerate(p);if($("#luckysheet-rich-text-editor").html(v),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),h){let y=$.trim(t.functionParserExe($("#luckysheet-rich-text-editor").text())),k=new Function("return "+y)();$("#luckysheet-search-formula-parm .result span").text(k)}}else{let h=window.getSelection().anchorNode;s=$(h).closest("div");let d=s.find("span[rangeindex='"+t.rangechangeindex+"']").html(l);t.setCaretPosition(d.get(0),0,l.length)}else{let u='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+t.functionHTMLIndex+'" dir="auto" style="color:'+Gl[t.functionHTMLIndex]+';">'+l+"</span>",h=$(u).insertAfter(t.rangeSetValueTo);t.rangechangeindex=t.functionHTMLIndex,s=$(t.rangeSetValueTo).closest("div"),t.setCaretPosition(s.find("span[rangeindex='"+t.rangechangeindex+"']").get(0),0,l.length),t.functionHTMLIndex++}s.attr("id")=="luckysheet-rich-text-editor"?$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()):$("#luckysheet-rich-text-editor").html($("#luckysheet-functionbox-cell").html())},rangedrag:function(e){let n=this,t=ut(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=$t(o),s=a[1],u=a[0],h=a[2],d=_t(l),m=d[1],p=d[0],v=d[2],y=0,k=0,b=[];n.func_selectedrange.top>u?(y=u,k=n.func_selectedrange.top+n.func_selectedrange.height-u,b=[h,n.func_selectedrange.row[1]]):n.func_selectedrange.top==u?(y=u,k=n.func_selectedrange.top+n.func_selectedrange.height-u,b=[h,n.func_selectedrange.row[0]]):(y=n.func_selectedrange.top,k=s-n.func_selectedrange.top-1,b=[n.func_selectedrange.row[0],h]);let w=0,x=0,C=[];n.func_selectedrange.left>p?(w=p,x=n.func_selectedrange.left+n.func_selectedrange.width-p,C=[v,n.func_selectedrange.column[1]]):n.func_selectedrange.left==p?(w=p,x=n.func_selectedrange.left+n.func_selectedrange.width-p,C=[v,n.func_selectedrange.column[0]]):(w=n.func_selectedrange.left,x=m-n.func_selectedrange.left-1,C=[n.func_selectedrange.column[0],v]),b[0]=Y.changeFreezenIndex(b[0],"h"),b[1]=Y.changeFreezenIndex(b[1],"h"),C[0]=Y.changeFreezenIndex(C[0],"v"),C[1]=Y.changeFreezenIndex(C[1],"v");let S=be.mergeMoveMain(C,b,n.func_selectedrange,y,k,w,x);if(S!=null&&(C=S[0],b=S[1],y=S[2],k=S[3],w=S[4],x=S[5]),n.func_selectedrange.row=b,n.func_selectedrange.column=C,n.func_selectedrange.left_move=w,n.func_selectedrange.width_move=x,n.func_selectedrange.top_move=y,n.func_selectedrange.height_move=k,or(w,y,x,k,b,C),$("#luckysheet-formula-functionrange-select").css({left:w,width:x,top:y,height:k}).show(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let _=Mt(f.currentSheetIndex,{row:b,column:C},f.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(_)}else n.rangeSetValue({row:b,column:C});Y.scrollFreezen(b,C)},rangedrag_column_start:!1,rangedrag_row_start:!1,rangedrag_column:function(e){let n=this,t=ut(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=f.visibledatarow,s=a.length-1,u=a[s],h=0,d=_t(l),m=d[1],p=d[0],v=d[2],y=0,k=0,b=[];n.func_selectedrange.left>p?(y=p,k=n.func_selectedrange.left+n.func_selectedrange.width-p,b=[v,n.func_selectedrange.column[1]]):n.func_selectedrange.left==p?(y=p,k=n.func_selectedrange.left+n.func_selectedrange.width-p,b=[v,n.func_selectedrange.column[0]]):(y=n.func_selectedrange.left,k=m-n.func_selectedrange.left-1,b=[n.func_selectedrange.column[0],v]),b[0]=Y.changeFreezenIndex(b[0],"v"),b[1]=Y.changeFreezenIndex(b[1],"v");let w=be.mergeMoveMain(b,[0,s],n.func_selectedrange,h,u-h-1,y,k);w!=null&&(b=w[0],y=w[4],k=w[5]),n.func_selectedrange.column=b,n.func_selectedrange.left_move=y,n.func_selectedrange.width_move=k,or(y,h,k,u-h-1,[0,s],b),n.rangeSetValue({row:[null,null],column:b}),$("#luckysheet-formula-functionrange-select").css({left:y,width:k,top:h,height:u-h-1}).show(),Y.scrollFreezen([0,s],b)},rangedrag_row:function(e){let n=this,t=ut(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=$t(o),s=a[1],u=a[0],h=a[2],d=f.visibledatacolumn,m=d.length-1,p=d[m],v=0,y=0,k=0,b=[];n.func_selectedrange.top>u?(y=u,k=n.func_selectedrange.top+n.func_selectedrange.height-u,b=[h,n.func_selectedrange.row[1]]):n.func_selectedrange.top==u?(y=u,k=n.func_selectedrange.top+n.func_selectedrange.height-u,b=[h,n.func_selectedrange.row[0]]):(y=n.func_selectedrange.top,k=s-n.func_selectedrange.top-1,b=[n.func_selectedrange.row[0],h]),b[0]=Y.changeFreezenIndex(b[0],"h"),b[1]=Y.changeFreezenIndex(b[1],"h");let w=be.mergeMoveMain([0,m],b,n.func_selectedrange,y,k,v,p-v-1);w!=null&&(b=w[1],y=w[2],k=w[3]),n.func_selectedrange.row=b,n.func_selectedrange.top_move=y,n.func_selectedrange.height_move=k,or(v,y,p-v-1,k,b,[0,m]),n.rangeSetValue({row:b,column:[null,null]}),$("#luckysheet-formula-functionrange-select").css({left:v,width:p-v-1,top:y,height:k}).show(),Y.scrollFreezen(b,[0,m])},rangedragged:function(){},rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeResizeDraging:function(e,n,t,l,o,a,s,u){let h=this,d=$("#luckysheet-scrollbar-y").scrollTop(),m=$("#luckysheet-scrollbar-x").scrollLeft(),p=ut(e.pageX,e.pageY),v=p[0]+m,y=p[1]+d,k=$t(y),b=k[1],w=k[0],x=k[2],C=_t(v),S=C[1],_=C[0],T=C[2];if(v<0||y<0)return!1;let F=w-t[1],R=_-t[0],I=t[5],P=t[3],O=t[4],M=t[2];if(l=="lt"||l=="lb"){if(t[0]+t[2]<_)return;O=_,M=t[2]-R,O>t[2]+t[4]-S+_?(O=t[2]+t[4]-S+_,M=t[2]-(t[2]+t[4]-S+_-t[0])):O<=0&&(O=0,M=t[2]+t[0])}if(l=="rt"||l=="rb"){if(t[6]-t[2]>S)return;M=t[2]+S-t[6],M<S-_-1?M=S-_-1:M>=s-O&&(M=s-O)}if(l=="lt"||l=="rt"){if(t[1]+t[3]<w)return;I=w,P=t[3]-F,I>t[3]+t[5]-b+w?(I=t[3]+t[5]-b+w,P=t[3]-(t[3]+t[5]-b+w-t[1])):I<=0&&(I=0,P=t[3]+t[1])}if(l=="lb"||l=="rb"){if(t[7]-t[3]>b)return;P=t[3]+b-t[7],P<b-w-1?P=b-w-1:P>=u-I&&(P=u-I)}let A=h.rangeResizeIndex,z={top:I,left:O,height:P,width:M},L=h.getSelectedFromRange(z),E=Mt(f.currentSheetIndex,L,h.rangetosheet),V=h.rangeResizeTo.find("span[rangeindex='"+A+"']").html(E);wr(h.rangeResizeTo[0]),n.css(z).data("range",L)},getSelectedFromRange:function(e){let n=e.top+2,t=e.top+e.height-2,l=e.left+2,o=e.left+e.width-2;return{row:[$t(n)[2],$t(t)[2]],column:[_t(l)[2],_t(o)[2]]}},rangeResizeDragged:function(e,n,t,l,o,a){let s=this;s.rangeResize=null,$("#luckysheet-formula-functionrange-highlight-"+s.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.03)},rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,rangeMoveDraging:function(e,n,t,l,o,a){let s=this,u=ut(e.pageX,e.pageY),h=$("#luckysheet-scrollbar-x").scrollLeft(),d=$("#luckysheet-scrollbar-y").scrollTop(),m=u[0]+h,p=u[1]+d,v=$(window).height()+d-o-a,y=$(window).width()+h,k=n[0],b=n[1],w=t.row[0]-k+$t(p)[2],x=t.row[1]-k+$t(p)[2],C=t.column[0]-b+_t(m)[2],S=t.column[1]-b+_t(m)[2];(w<0||p<0)&&(w=0,x=t.row[1]-t.row[0]),(C<0||m<0)&&(C=0,S=t.column[1]-t.column[0]);let _=f.visibledatarow;(x>=_[_.length-1]||p>v)&&(w=_.length-1-t.row[1]+t.row[0],x=_.length-1);let T=f.visibledatacolumn;(S>=T[T.length-1]||m>y)&&(C=T.length-1-t.column[1]+t.column[0],S=T.length-1);let F=C-1==-1?0:T[C-1],R=T[S],I=w-1==-1?0:_[w-1],P=_[x],O=s.rangeMoveIndex,M={left:F,width:R-F-2,top:I,height:P-I-2,display:"block"},A=s.getSelectedFromRange(M),z=Mt(f.currentSheetIndex,A,s.rangetosheet),L=s.rangeResizeTo.find("span[rangeindex='"+O+"']").html(z);wr(s.rangeResizeTo[0]),s.rangeMoveRangedata=A,l.css(M)},rangeMoveDragged:function(e){let n=this;n.rangeMove=!1,$("#luckysheet-formula-functionrange-highlight-"+n.rangeMoveIndex).data("range",n.rangeMoveRangedata).find(".luckysheet-selection-copy-hc").css("opacity",.03)},functionHTMLIndex:0,functionRangeIndex:null,findrangeindex:function(e,n){let t=this,l=/<span.*?>/g,o=e.replace(l,""),a=n.replace(l,"");o=o.split("</span>"),a=a.split("</span>"),o.pop(),a.pop();let s=t.functionRangeIndex,u=0,h=a.length>o.length?o.length:a.length,d=a.length,m=o.length;if(d==m){let p=s[0],v=a[p],y=o[p];if(v==null)return a.length<=p?s=[a.length-1,a.length-1]:o.length<=p&&(s=[o.length-1,o.length-1]),s;if(v.length==y.length)return a[p+1]!=null&&o[p+1]!=null&&a[p+1].length<o[p+1].length&&(s[0]=s[0]+1,s[1]=1),s;if(v.length>y.length)return v!=null&&o[p+1]!=null&&o[p+1].substr(0,1)=='"'&&(v.indexOf("{")>-1||v.indexOf("}")>-1)&&(s[0]=s[0]+1,s[1]=1),s;if(v.length<y.length)return s[1]>y.length&&(s[1]=y.length),s}else if(d>m){let p=s[0],v=a[p],y=o[p];if(y==null)if(o[p-1].indexOf("{")>-1){s[0]=s[0]-1;let k=o[p-1].search("{");s[1]=s[1]+k}else s[0]=0,s[1]=0;else{if(v.length==y.length)return o[p+1]!=null&&(o[p+1].substr(0,1)=='"'||o[p+1].substr(0,1)=="{"||o[p+1].substr(0,1)=="}")?(s[0]=s[0]+1,s[1]=1):v!=null&&v.length>2&&v.substr(0,1)=='"'&&v.substr(v.length-1,1)=='"'||(o[p]!=null&&o[p]=='")'||o[p]!=null&&o[p]=='"}'||o[p]!=null&&o[p]=="{)"?s[1]=1:s[1]=y.length),s;if(v.length>y.length)return o[p+1]!=null&&(o[p+1].substr(0,1)=='"'||o[p+1].substr(0,1)=="{"||o[p+1].substr(0,1)=="}")&&(s[0]=s[0]+1,s[1]=1),s;if(v.length<y.length)return s}return s}else if(d<m){let p=s[0],v=a[p],y=o[p];if(v==null)s[0]=o.length-1,y!=null?s[1]=y.length:s[1]=1;else{if(v.length==y.length)return a[p+1]!=null&&(a[p+1].substr(0,1)=='"'||a[p+1].substr(0,1)=="{"||a[p+1].substr(0,1)=="}")?s[1]=y.length:o[p+1]!=null&&o[p+1].substr(0,1)=='"'&&(o[p+1].substr(0,1)=="{"||o[p+1].substr(0,1)=="}")?(s[0]=s[0]+1,s[1]=1):y!=null&&y.substr(0,1)=='"'&&y.substr(y.length-1,1)=='"'&&v.substr(0,1)=='"'&&v.substr(v.length-1,1)==")"||y!=null&&y.substr(0,1)=="{"&&y.substr(y.length-1,1)=="}"&&v.substr(0,1)=="{"&&v.substr(v.length-1,1)==")"?s[1]=y.length:(s[0]=s[0]+m-d,o.length>a.length?s[1]=o[p+1].length:s[1]=1),s;if(v.length>y.length)return v!=null&&v.substr(0,1)=='"'?s[1]=y.length:o[p+1]!=null&&/{.*?}/.test(o[p+1])?(s[0]=s[0]+1,s[1]=o[p+1].length):v!=null&&o[p+1].substr(0,1)=='"'&&(v.indexOf("{")>-1||v.indexOf("}")>-1)?(s[0]=s[0]+1,s[1]=1):v!=null&&(v.indexOf("{")>-1||v.indexOf("}")>-1)||(s[0]=s[0]+m-d-1,s[1]=o[p-1].length),s;if(v.length<y.length)return s}return s}return null},setCaretPosition:function(e,n,t){try{let l=e,o=document.createRange(),a=window.getSelection();o.setStart(l.childNodes[n],t),o.collapse(!0),a.removeAllRanges(),a.addRange(o),l.focus()}catch(l){wr(this.rangeResizeTo[0])}},functionRange:function(e,n,t){let l=this;if(window.getSelection){let o=window.getSelection(),a=l.findrangeindex(n,t);a==null?(o.selectAllChildren(e.get(0)),o.collapseToEnd()):l.setCaretPosition(e.find("span").get(a[0]),0,a[1])}else document.selection&&(l.functionRangeIndex.moveToElementText(e),l.functionRangeIndex.collapse(!1),l.functionRangeIndex.select())},functionInputHanddler:function(e,n,t){if(he())return;let l=this,o=e,a=n,s=a.html(),u=a.text(),h=this.xssDeal;setTimeout(function(){let d=a.text(),m=d;if(d=h(d),d.length>0&&d.substr(0,1)=="="&&(t!=229||d.length==1)){if(d=l.functionHTMLGenerate(d),s=l.functionHTMLGenerate(u),window.getSelection){let p=window.getSelection();if($(p.anchorNode).is("div")){let v=$("#luckysheet-rich-text-editor span").length;l.functionRangeIndex=[v-1,$("#luckysheet-rich-text-editor").find("span").eq(v-1).text().length]}else l.functionRangeIndex=[$(p.anchorNode).parent().index(),p.anchorOffset]}else{let p=document.selection.createRange();l.functionRangeIndex=p}a.html(d),l.functionRange(a,d,s),l.canceFunctionrangeSelected(),t!=46&&l.createRangeHightlight(),o.html(d),l.rangestart=!1,l.rangedrag_column_start=!1,l.rangedrag_row_start=!1,l.rangeHightlightselected(a,t)}else u.substr(0,1)!="="&&(o.attr("id")=="luckysheet-rich-text-editor"&&o.html().substr(0,5)=="<span"||(d=l.ltGtSignDeal(d),o.html(d)))},1)},functionHTMLGenerate:function(e){let n=this;return e.length==0||e.substr(0,1)!="="?e:(n.functionHTMLIndex=0,'<span dir="auto" class="luckysheet-formula-text-color">=</span>'+n.functionHTML(e))},functionHTML:function(e){let n=this;if(n.operatorjson==null){let h=n.operator.split("|"),d={};for(let m=0;m<h.length;m++)d[h[m].toString()]=1;n.operatorjson=d}e.substr(0,1)=="="&&(e=e.substr(1));let t=e.split(""),l=0,o="",a="",s=!0,u={bracket:0,comma:0,squote:0,dquote:0,braces:0};for(;l<t.length;){let h=t[l];if(h=="("&&u.squote==0&&u.dquote==0&&u.braces==0)u.bracket+=1,o.length>0?a+='<span dir="auto" class="luckysheet-formula-text-func">'+o+'</span><span dir="auto" class="luckysheet-formula-text-lpar">(</span>':a+='<span dir="auto" class="luckysheet-formula-text-lpar">(</span>',o="";else if(h==")"&&u.squote==0&&u.dquote==0&&u.braces==0)u.bracket-=1,a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-rpar">)</span>',o="";else if(h=="{"&&u.squote==0&&u.dquote==0)o+="{",u.braces+=1;else if(h=="}"&&u.squote==0&&u.dquote==0)o+="}",u.braces-=1;else if(h=='"'&&u.squote==0)u.dquote>0?(o.length>0?a+=o+'"</span>':a+='"</span>',u.dquote-=1,o=""):(u.dquote+=1,o.length>0?a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-string">"':a+='<span dir="auto" class="luckysheet-formula-text-string">"',o="");else if(h=="'"&&u.dquote==0)o+="'",u.squote=u.squote==0?1:0;else if(h==","&&u.squote==0&&u.dquote==0&&u.braces==0)a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-comma">,</span>',o="";else if(h=="&"&&u.squote==0&&u.dquote==0&&u.braces==0)o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">&</span>',o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">&</span>';else if(h in n.operatorjson&&u.squote==0&&u.dquote==0&&u.braces==0){let d="";l+1<t.length&&(d=t[l+1]);let m=l-1,p=null;if(m>=0)do p=t[m--];while(m>=0&&p==" ");h+d in n.operatorjson?(o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">'+h+d+"</span>",o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">'+h+d+"</span>",l++):!/[^0-9]/.test(d)&&h=="-"&&(p=="("||p==null||p==","||p==" "||p in n.operatorjson)?o+=h:o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">'+h+"</span>",o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">'+h+"</span>"}else o+=h;if(l==t.length-1){if(n.iscelldata($.trim(o)))a+='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+n.functionHTMLIndex+'" dir="auto" style="color:'+Gl[n.functionHTMLIndex]+';">'+o+"</span>",n.functionHTMLIndex++;else if(u.dquote>0)a+=o+"</span>";else if(o.indexOf("</span>")==-1&&o.length>0){let d=/{.*?}/;if(d.test($.trim(o))){let m=d.exec(o)[0],p=o.search(d),v="";p>0&&(v+='<span dir="auto" class="luckysheet-formula-text-color">'+o.substr(0,p)+"</span>"),v+='<span dir="auto" style="color:#959a05" class="luckysheet-formula-text-array">'+m+"</span>",p+m.length<o.length&&(v+='<span dir="auto" class="luckysheet-formula-text-color">'+o.substr(p+m.length,o.length)+"</span>"),a+=v}else a+='<span dir="auto" class="luckysheet-formula-text-color">'+o+"</span>"}}l++}return a},getfunctionParam:function(e){let n=this;if(n.operatorjson==null){let m=n.operator.split("|"),p={};for(let v=0;v<m.length;v++)p[m[v].toString()]=1;n.operatorjson=p}e.substr(0,1)=="="&&(e=e.substr(1));let t=e.split(""),l=0,o="",a="",s={bracket:0,comma:0,squote:0,dquote:0,compare:0},u=null,h=[],d=[];for(;l<t.length;){let m=t[l];if(m=="("&&s.dquote==0)o.length>0&&d.length==0?(u=o.toUpperCase(),d.push(1),o=""):d.length==0?(d.push(0),o=""):(d.push(0),o+=m);else if(m==")"&&s.dquote==0){let p=d.pop();d.length==0?(h.push(o),o=""):o+=m}else if(m=='"')o+='"',s.dquote>0?(s.dquote-=1,o=""):s.dquote+=1;else if(m==","&&s.dquote==0)d.length<=1?(h.push(o),o=""):o+=",";else if(m in n.operatorjson&&s.dquote==0){let p="";l+1<t.length&&(p=t[l+1]);let v=l-1,y=null;if(v>=0)do y=t[v--];while(v>=0&&y==" ");!/[^0-9]/.test(p)&&m=="-"&&(y=="("||y==null||y==","||y==" "||y in n.operatorjson)?s.dquote==0?o+=$.trim(m):o+=m:(a="",o="")}else s.dquote==0?o+=$.trim(m):o+=m;l++}return{fn:u,param:h}},calPostfixExpression:function(e){if(e.length==0)return"";let n=[];for(let t=e.length-1;t>=0;t--){let l=e[t];if(l in this.operatorjson){let o=n.pop(),a=n.pop(),s="luckysheet_compareWith("+a+",'"+l+"', "+o+")";n.push(s)}else n.push(l)}return n.length>0?n[0]:""},checkBracketNum:function(e){let n=e.match(/\(/g),t=e.match(/\)/g),l=e.match(/(['"])(?:(?!\1).)*?\1/g),o=e.match(/(['"])(?:(?!\1).)*?\1/g),a=0,s=0;n!=null&&(a+=n.length),t!=null&&(s+=t.length);let u=0,h=0;if(l!=null)for(let d=0;d<l.length;d++){let m=l[d].match(/\(/g);m!=null&&(u+=m.length)}if(o!=null)for(let d=0;d<o.length;d++){let m=o[d].match(/\)/g);m!=null&&(h+=m.length)}return a-=u,s-=h,a==s},operatorPriority:{"^":0,"%":1,"*":1,"/":1,"+":2,"-":2},functionParserExe:function(e){let n=this;return this.functionParser(e)},functionParser:function(e,n){let t=this;if(t.operatorjson==null){let v=t.operator.split("|"),y={};for(let k=0;k<v.length;k++)y[v[k].toString()]=1;t.operatorjson=y}if(e==null)return"";e.substr(0,2)=="=+"?e=e.substr(2):e.substr(0,1)=="="&&(e=e.substr(1));let l=e.split(""),o=0,a="",s="",u={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},h=[],d=[],m=[],p=-1;for(;o<l.length;){let v=l[o];if(v=="("&&u.squote==0&&u.dquote==0&&u.braces==0)if(a.length>0&&m.length==0){if(a=a.toUpperCase(),a.indexOf(":")>-1){let y=a.split(":");s+="luckysheet_getSpecialReference(true,'"+$.trim(y[0]).replace(/'/g,"\\'")+"', luckysheet_function."+y[1]+".f(#lucky#"}else s+="luckysheet_function."+a+".f(";m.push(1),a=""}else m.length==0?(s+="(",m.push(0),a=""):(m.push(0),a+=v);else if(v==")"&&u.squote==0&&u.dquote==0&&u.braces==0){let y=m.pop();if(m.length==0){let k=t.functionParser(a,n);k.indexOf("#lucky#")>-1&&(k=k.replace(/#lucky#/g,"")+")"),s+=k+")",a=""}else a+=v}else if(v=="{"&&u.squote==0&&u.dquote==0)a+="{",u.braces+=1;else if(v=="}"&&u.squote==0&&u.dquote==0)a+="}",u.braces-=1;else if(v=='"'&&u.squote==0)u.dquote>0?o<l.length-1&&l[o+1]=='"'?(o++,a+="\x7F"):(u.dquote-=1,a+='"'):(u.dquote+=1,a+='"');else if(v=="'"&&u.dquote==0)if(a+="'",u.squote>0){if(p==o-1)return"";if(o<l.length-1&&l[o+1]=="'")o++,a+="'";else{if(l[o-1]=="'")return"";u.squote-=1}}else u.squote+=1,p=o;else if(v==","&&u.squote==0&&u.dquote==0&&u.braces==0)if(m.length<=1){let y=t.functionParser(a,n);y.indexOf("#lucky#")>-1&&(y=y.replace(/#lucky#/g,"")+")"),s+=y+",",a=""}else a+=",";else if(v in t.operatorjson&&u.squote==0&&u.dquote==0&&u.braces==0){let y="",k=t.operatorPriority;if(o+1<l.length&&(y=l[o+1]),v+y in t.operatorjson){if(m.length==0){if($.trim(a).length>0?d.unshift(t.functionParser($.trim(a),n)):$.trim(s).length>0&&d.unshift($.trim(s)),h[0]in t.operatorjson){let b=k[h[0]];for(;h.length>0&&b!=null;)d.unshift(h.shift()),b=k[h[0]]}h.unshift(v+y),s="",a=""}else a+=v+y;o++}else if(m.length==0){if($.trim(a).length>0?d.unshift(t.functionParser($.trim(a),n)):$.trim(s).length>0&&d.unshift($.trim(s)),h[0]in t.operatorjson){let b=k[h[0]];b=b==null?1e3:b;let w=k[v];for(w=w==null?1e3:w;h.length>0&&w>=b;)d.unshift(h.shift()),b=k[h[0]],b=b==null?1e3:b}h.unshift(v),s="",a=""}else a+=v}else u.dquote==0&&u.squote==0,a+=v;if(o==l.length-1){let y="",k=$.trim(a).replace(/'/g,"\\'");if(t.iscelldata(k)&&k.substr(0,1)!=":")y="luckysheet_getcelldata('"+k+"')",typeof n=="function"&&n(k);else if(k.substr(0,1)==":")k=k.substr(1),t.iscelldata(k)&&(y="luckysheet_getSpecialReference(false,"+s+",'"+k+"')");else{a=$.trim(a);let b=/{.*?}/;if(b.test(a)&&a.substr(0,1)!='"'&&a.substr(a.length-1,1)!='"'){let w=b.exec(a)[0],x=a.search(b),C="";x>0&&(y+=a.substr(0,x)),y+="luckysheet_getarraydata('"+w+"')",x+w.length<a.length&&(y+=a.substr(x+w.length,a.length))}else y=a}if(y.length>0&&d.unshift(y),h.length>0)for(s.length>0&&(d.unshift(s),s="");h.length>0;)d.unshift(h.shift());d.length>0?s=t.calPostfixExpression(d):s+=y}o++}return s},insertUpdateDynamicArray:function(e){let n=e.r,t=e.c,l=e.index;l==null&&(l=f.currentSheetIndex);let s=At()[Z(l)].dynamicArray;s==null&&(s=[]);for(let u=0;u<s.length;u++){let h=s[u];if(h.r==n&&h.c==t&&h.index==l)return h.data=e.data,h.f=e.f,s}return s.push(e),s},addFunctionGroup:function(e,n,t,l){l==null&&(l=f.currentSheetIndex);let o=At(),a=o[Z(l)];a.calcChain==null&&(a.calcChain=[]);let s={r:e,c:n,index:l,func:t};a.calcChain.push(s),ne.saveParam("fc",l,JSON.stringify(s),{op:"add",pos:a.calcChain.length-1}),Kn(o)},getAllFunctionGroup:function(){let e=At(),n=[];for(let t=0;t<e.length;t++){let l=e[t],o=l.calcChain;if(o){let s=[];o.forEach((u,h)=>{typeof u=="string"?s.push(JSON.parse(u)):s.push(u)}),o=l.calcChain=s}let a=l.dynamicArray_compute;o==null&&(o=[]),a==null&&(a=[]),n=n.concat(o);for(let s=0;s<a.length;s++){let u=a[0];n.push({r:u.r,c:u.c,index:u.index})}}return n},getFunctionGroup:function(e){e==null&&(e=f.currentSheetIndex);let t=At()[Z(e)];return t.calcChain==null?[]:t.calcChain},updateFunctionGroup:function(e,n,t){t==null&&(t=f.currentSheetIndex);let l=At(),a=l[Z(t)].calcChain;if(a!=null)for(let s=0;s<a.length;s++){let u=a[s];if(u.r==e&&u.c==n&&u.index==t){ne.saveParam("fc",t,JSON.stringify(u),{op:"update",pos:s});break}}Kn(l)},insertUpdateFunctionGroup:function(e,n,t){t==null&&(t=f.currentSheetIndex);let l=At(),o=l[Z(t)],a=o.calcChain;a==null&&(a=[]);for(let u=0;u<a.length;u++){let h=a[u];if(h.r==e&&h.c==n&&h.index==t){ne.saveParam("fc",t,JSON.stringify(h),{op:"update",pos:u});return}}let s={r:e,c:n,index:t};a.push(s),o.calcChain=a,ne.saveParam("fc",t,JSON.stringify(s),{op:"add",pos:o.calcChain.length-1}),Kn(l)},isFunctionRangeSave:!1,isFunctionRangeSimple:function(e,n,t,l,o){if(e==null||e.length==0)return;let a=e.split(/==|!=|<>|<=|>=|[,()=+-\/*%&^><]/g);if(a.length>0)for(let s=0;s<a.length;s++){let u=a[s];u.length<=1||u.substr(0,1)=='"'&&u.substr(u.length-1,1)=='"'||this.isFunctionRangeSaveChange(u,n,t,l,o)}},isFunctionRangeSimple1:function(e,n,t,l,o){let a=this;if(a.operatorjson==null){let y=a.operator.split("|"),k={};for(let b=0;b<y.length;b++)k[y[b].toString()]=1;a.operatorjson=k}e.substr(0,1)=="="&&(e=e.substr(1));let s=e.split(""),u=0,h="",d="",m=!0,p={bracket:0,comma:0,squote:0,dquote:0},v=At();for(;u<s.length;){let y=s[u];if(y=="("&&p.dquote==0)p.bracket+=1,h.length>0?d+="luckysheet_function."+h.toUpperCase()+".f(":d+="(",h="";else if(y==")"&&p.dquote==0)p.bracket-=1,d+=a.isFunctionRangeSimple(h,n,t,l,o)+")",h="";else if(y==","&&p.dquote==0)d+=a.isFunctionRangeSimple(h,n,t,l,o)+",",h="";else if(y in a.operatorjson&&p.dquote==0){let k="";u+1<s.length&&(k=s[u+1]),y+k in a.operatorjson?(h.length>0?(d+=a.isFunctionRangeSimple(h,n,t,l,o)+y+k,h=""):d+=y+k,u++):h.length>0?(d+=a.isFunctionRangeSimple(h,n,t,l,o)+y,h=""):d+=y}else h+=y;u==s.length-1&&a.iscelldata($.trim(h))&&a.isFunctionRangeSaveChange(h,n,t,l,o),u++}return d},isFunctionRangeSelect:function(e,n,t,l,o){if(e==null||e=="")return;l==null&&(l=f.currentSheetIndex),o==null&&(o={});let a=this,s=e.toUpperCase(),u=s.indexOf("INDIRECT(")>-1||s.indexOf("OFFSET(")>-1||s.indexOf("INDEX(")>-1;if(e in this.formulaContainCellList){let h=this.formulaContainCellList[e];if(u)if(h.__LuckyisOff__==!0)for(let m in h)m!="__LuckyisOff__"&&this.isFunctionRangeSaveChange(m,n,t,l,o);else this.isFunctionRange(e,n,t,l,o,function(m){a.addToCellList(e,m)}),h.__LuckyisOff__=!0;else for(let d in h)d!="__LuckyisOff__"&&this.isFunctionRangeSaveChange(d,n,t,l,o);return}u?this.isFunctionRange(e,n,t,l,o):this.isFunctionRangeSimple(e,n,t,l,o)},isFunctionRange:function(e,n,t,l,o,a){let s=this;if(s.operatorjson==null){let x=s.operator.split("|"),C={};for(let S=0;S<x.length;S++)C[x[S].toString()]=1;s.operatorjson=C}e.substr(0,1)=="="&&(e=e.substr(1));let u=e.split(""),h=0,d="",m="",p=!0,v={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},y=[],k=[],b=[],w=-1;for(;h<u.length;){let x=u[h];if(x=="("&&v.squote==0&&v.dquote==0&&v.braces==0)if(d.length>0&&b.length==0){if(d=d.toUpperCase(),d.indexOf(":")>-1){let C=d.split(":");m+="luckysheet_getSpecialReference(true,'"+$.trim(C[0]).replace(/'/g,"\\'")+"', luckysheet_function."+C[1]+".f(#lucky#"}else m+="luckysheet_function."+d+".f(";b.push(1),d=""}else b.length==0?(m+="(",b.push(0),d=""):(b.push(0),d+=x);else if(x==")"&&v.squote==0&&v.dquote==0&&v.braces==0){let C=b.pop();if(b.length==0){let S=s.isFunctionRange(d,n,t,l,o,a);S.indexOf("#lucky#")>-1&&(S=S.replace(/#lucky#/g,"")+")"),m+=S+")",d=""}else d+=x}else if(x=="{"&&v.squote==0&&v.dquote==0)d+="{",v.braces+=1;else if(x=="}"&&v.squote==0&&v.dquote==0)d+="}",v.braces-=1;else if(x=='"'&&v.squote==0)v.dquote>0?h<u.length-1&&u[h+1]=='"'?(h++,d+="\x7F"):(v.dquote-=1,d+='"'):(v.dquote+=1,d+='"');else if(x=="'"&&v.dquote==0)d+="'",v.squote>0?h<u.length-1&&u[h+1]=="'"?(h++,d+="'"):v.squote-=1:(v.squote+=1,w=h);else if(x==","&&v.squote==0&&v.dquote==0&&v.braces==0)if(b.length<=1){let C=s.isFunctionRange(d,n,t,l,o,a);C.indexOf("#lucky#")>-1&&(C=C.replace(/#lucky#/g,"")+")"),m+=C+",",d=""}else d+=",";else if(x in s.operatorjson&&v.squote==0&&v.dquote==0&&v.braces==0){let C="",S=s.operatorPriority;if(h+1<u.length&&(C=u[h+1]),x+C in s.operatorjson){if(b.length==0){if($.trim(d).length>0?k.unshift(s.isFunctionRange($.trim(d),n,t,l,o,a)):$.trim(m).length>0&&k.unshift($.trim(m)),y[0]in s.operatorjson){let _=S[y[0]];for(;y.length>0&&_!=null;)k.unshift(y.shift()),_=S[y[0]]}y.unshift(x+C),m="",d=""}else d+=x+C;h++}else if(b.length==0){if($.trim(d).length>0?k.unshift(s.isFunctionRange($.trim(d),n,t,l,o,a)):$.trim(m).length>0&&k.unshift($.trim(m)),y[0]in s.operatorjson){let _=S[y[0]];_=_==null?1e3:_;let T=S[x];for(T=T==null?1e3:T;y.length>0&&T>=_;)k.unshift(y.shift()),_=S[y[0]],_=_==null?1e3:_}y.unshift(x),m="",d=""}else d+=x}else v.dquote==0&&v.squote==0?d+=$.trim(x):d+=x;if(h==u.length-1){let C="",S=$.trim(d).replace(/'/g,"\\'");if(s.iscelldata(S)&&S.substr(0,1)!=":")C="luckysheet_getcelldata('"+S+"')",s.isFunctionRangeSaveChange(d,n,t,l,o);else if(S.substr(0,1)==":")S=S.substr(1),s.iscelldata(S)&&(C="luckysheet_getSpecialReference(false,"+m+",'"+S+"')");else{d=$.trim(d);let _=/{.*?}/;if(_.test(d)&&d.substr(0,1)!='"'&&d.substr(d.length-1,1)!='"'){let T=_.exec(d)[0],F=d.search(_),R="";F>0&&(C+=d.substr(0,F)),C+="luckysheet_getarraydata('"+T+"')",F+T.length<d.length&&(C+=d.substr(F+T.length,d.length))}else C=d}if(C.length>0&&k.unshift(C),y.length>0)for(m.length>0&&(k.unshift(m),m="");y.length>0;)k.unshift(y.shift());k.length>0?m=s.calPostfixExpression(k):m+=C}h++}return s.checkSpecialFunctionRange(m,n,t,l,o,a),m},isFunctionRangeSaveChange:function(e,n,t,l,o){let a=this;if(n!=null&&t!=null){let s=a.getcellrange($.trim(e),l);if(s==null)return;let u=s.row,h=s.column,d=s.sheetIndex;if(n+"_"+t in o&&(l==d||l==null)){let m=!1;for(let p=u[0];p<=u[1];p++)for(let v=h[0];v<=h[1];v++)p+"_"+v in o&&o[p+"_"+v].r==n&&o[p+"_"+v].c==t&&(m=!0);m?a.isFunctionRangeSave=a.isFunctionRangeSave||!0:a.isFunctionRangeSave=a.isFunctionRangeSave||!1}else n>=u[0]&&n<=u[1]&&t>=h[0]&&t<=h[1]&&(l==d||l==null)?a.isFunctionRangeSave=a.isFunctionRangeSave||!0:a.isFunctionRangeSave=a.isFunctionRangeSave||!1}else a.isFunctionRangeSave=a.isFunctionRangeSave||!1},checkSpecialFunctionRange:function(e,n,t,l,o,a){if(e.substr(0,30)=="luckysheet_getSpecialReference"||e.substr(0,20)=="luckysheet_function."){if(e.substr(0,20)=="luckysheet_function."){let s=e.split(".")[1];if(s!=null&&(s=s.toUpperCase(),s!="INDIRECT"&&s!="OFFSET"&&s!="INDEX"))return}try{f.calculateSheetIndex=l;let s=new Function("return "+e)();s instanceof Object&&s.startCell!=null&&(s=s.startCell);let u=$.trim(s);this.iscelldata(u)&&typeof a=="function"&&a(u)}catch(s){}}},execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},formulaContainCellList:{},cellTextToIndexList:{},addToCellList:function(e,n){e==null||e.length==0||n==null||n.length==0||(this.formulaContainCellList==null&&(this.formulaContainCellList={}),this.formulaContainCellList[e]==null&&(this.formulaContainCellList[e]={}),this.formulaContainCellList[e][n]=1)},addToCellIndexList:function(e,n){e==null||e.length==0||n==null||(this.cellTextToIndexList==null&&(this.cellTextToIndexList={}),e.indexOf("!")>-1?(e=e.replace(/\\'/g,"'").replace(/''/g,"'"),this.cellTextToIndexList[e]=n):this.cellTextToIndexList[e+"_"+n.sheetIndex]=n)},addToSheetIndexList:function(e,n,t){e==null||e.length==0||((n==null||n.length==0)&&(n=f.currentSheetIndex),(t==null||t.length==0)&&(t=""),this.formulaContainSheetList==null&&(this.formulaContainSheetList={}),this.formulaContainSheetList[e]==null&&(this.formulaContainSheetList[e]={}),this.formulaContainSheetList[e][n]=t)},execFunctionGlobalData:{},execFunctionGroupForce:function(e){e?this.execFunctionGroup(void 0,void 0,void 0,void 0,void 0,!0):this.execFunctionGroup()},execFunctionGroup:function(e,n,t,l,o,a=!1){let s=this;if(o==null&&(o=f.flowdata),window.luckysheet_compareWith||(window.luckysheet_compareWith=Yi,window.luckysheet_getarraydata=ac,window.luckysheet_getcelldata=Fr,window.luckysheet_parseData=Xi,window.luckysheet_getValue=jn,window.luckysheet_indirect_check=sc,window.luckysheet_indirect_check_return=cc,window.luckysheet_offset_check=uc,window.luckysheet_calcADPMM=xt,window.luckysheet_getSpecialReference=fc),s.execFunctionGlobalData==null&&(s.execFunctionGlobalData={}),l==null&&(l=f.currentSheetIndex),t!=null){let _=[[{v:null}]];Ht(0,0,_,t),s.execFunctionGlobalData[e+"_"+n+"_"+l]=_[0][0]}let u=s.getAllFunctionGroup(),h={},d=At(),m={};for(let _=0;_<d.length;_++){let T=d[_];m[T.index]=T.data}let p={},v=[];if(s.execFunctionExist==null){let _="r"+e+"c"+n+"i"+l;p[_]=1}else for(let _=0;_<s.execFunctionExist.length;_++){let T=s.execFunctionExist[_],F="r"+T.r+"c"+T.c+"i"+T.i;p[F]=1}let y={},k=function(_,T,F,R){for(let I=0;I<_.length;I++){let P=_[I],O="r"+P.row[0]+""+P.row[1]+"c"+P.column[0]+""+P.column[1]+"index"+P.sheetIndex;if(O in y)y[O].forEach(A=>{R(A.key,A.r,A.c,A.sheetIndex)});else{let M=[];for(let A=P.row[0];A<=P.row[1];A++)for(let z=P.column[0];z<=P.column[1];z++){let L="r"+A+"c"+z+"i"+P.sheetIndex;R(L,A,z,P.sheetIndex),(T&&L in T||F&&L in F)&&M.push({key:L,r:A,c:z,sheetIndex:P.sheetIndex})}(T||F)&&(y[O]=M)}}},b={},w=0;for(let _=0;_<u.length;_++){let T=u[_],F="r"+T.r+"c"+T.c+"i"+T.index,R=Ll(T.r,T.c,T.index);if(R==null)continue;let I=R.toUpperCase(),P=I.indexOf("INDIRECT(")>-1||I.indexOf("OFFSET(")>-1||I.indexOf("INDEX(")>-1,O=[];if(P)this.isFunctionRange(R,null,null,T.index,null,function(A){let z=s.getcellrange($.trim(A),T.index);z!=null&&O.push(z)});else if(!(R.substr(0,2)=='="'&&R.substr(R.length-1,1)=='"')){let A=0,z=-1,L=-1,E=[],V=[],q=R.length;for(let G=0;G<q;G++){let X=R.charAt(G);X=="'"&&L==-1&&(z==-1?(A!=G&&E.push(...R.substring(A,G).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/)),z=G,A=G):G<q-1&&R.charAt(G+1)=="'"?G++:(A=G+1,E.push(R.substring(z,A)),V.push(E.length-1),z=-1)),X=='"'&&z==-1&&(L==-1?(A!=G&&E.push(...R.substring(A,G).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/)),L=G,A=G):G<q-1&&R.charAt(G+1)=='"'?G++:(A=G+1,E.push(R.substring(L,A)),L=-1))}A!=q&&E.push(...R.substring(A,q).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/));for(let G=V.length-1;G>=0;G--)V[G]!=E.length-1&&(E[V[G]]=E[V[G]]+E[V[G]+1],E.splice(V[G]+1,1));for(let G=0;G<E.length;G++){let X=E[G];if(X.length<=1||X.substr(0,1)=='"'&&X.substr(X.length-1,1)=='"'&&!s.iscelldata(X))continue;let ee=s.getcellrange($.trim(X),T.index);ee!=null&&O.push(ee)}}let M={formulaArray:O,calc_funcStr:R,key:F,r:T.r,c:T.c,index:T.index,parents:{},chidren:{},color:"w"};h[F]=M}Object.keys(h).forEach(_=>{let T=h[_];k(T.formulaArray,h,p,function(F){if(F in h){let R=h[F];T.chidren[F]=1,R.parents[_]=1}!a&&F in p&&v.push(T)}),a&&v.push(T)});let x=[],C=v,S={};for(;C.length>0;){let _=C.pop();if(_==null||_.key in S)continue;if(_.color=="b"){x.push(_),S[_.key]=1;continue}let T=[];Object.keys(_.parents).forEach(F=>{let R=h[F];R!=null&&T.push(R)}),w++,T.length==0?(x.push(_),S[_.key]=1):(_.color="b",C.push(_),C=C.concat(T))}x.reverse();for(let _=0;_<x.length;_++){let T=x[_];if(T.level==Math.max)continue;window.luckysheet_getcelldata_cache=null;let F=T.calc_funcStr,R=s.execfunction(F,T.r,T.c,T.index);s.groupValuesRefreshData.push({r:T.r,c:T.c,v:R[1],f:R[2],spe:R[3],index:T.index}),s.execFunctionGlobalData[T.r+"_"+T.c+"_"+T.index]={v:R[1],f:R[2]}}s.execFunctionExist=null},execFunctionGroup1:function(e,n,t,l,o,a=!1){let s=this;o==null&&(o=f.flowdata),window.luckysheet_compareWith||(window.luckysheet_compareWith=Yi,window.luckysheet_getarraydata=ac,window.luckysheet_getcelldata=Fr,window.luckysheet_parseData=Xi,window.luckysheet_getValue=jn,window.luckysheet_indirect_check=sc,window.luckysheet_indirect_check_return=cc,window.luckysheet_offset_check=uc,window.luckysheet_calcADPMM=xt,window.luckysheet_getSpecialReference=fc),s.execFunctionGlobalData==null&&(s.execFunctionGlobalData={});let u=At(),h=u[Z(f.currentSheetIndex)].dynamicArray_compute==null?{}:u[Z(f.currentSheetIndex)].dynamicArray_compute;if(l==null&&(l=f.currentSheetIndex),t!=null){let k=[[{v:null}]];Ht(0,0,k,t),s.execFunctionGlobalData[e+"_"+n+"_"+l]=k[0][0]}let d=s.getAllFunctionGroup(),m={},p=[],v=0;if(s.execvertex={},s.execFunctionExist==null)for(let k=0;k<d.length;k++){let b=d[k],w=u[Z(b.index)];if(w==null)continue;let x=w.data[b.r][b.c],C=Ll(b.r,b.c,b.index);x!=null&&x.f!=null&&x.f==C&&(b instanceof Object||(b=new Function("return "+b)()),b.color="w",b.parent=null,b.chidren={},b.times=0,m["r"+b.r+"c"+b.c+"i"+b.index]=b,s.isFunctionRangeSave=!1,a?s.isFunctionRangeSave=!0:e!=null&&n!=null&&s.isFunctionRangeSelect(C,e,n,l,h),s.isFunctionRangeSave&&(p.push(b),s.execvertex["r"+b.r+"c"+b.c+"i"+b.index]=b,v++))}else for(let k=0;k<s.execFunctionExist.length;k++){let b=s.execFunctionExist[k];if(!("r"+b.r+"c"+b.c+"i"+b.i in m))for(let w=0;w<d.length;w++){let x=d[w],C=Ll(x.r,x.c,x.index);x.color="w",x.parent=null,x.chidren={},x.times=0,m["r"+x.r+"c"+x.c+"i"+x.index]=x,s.isFunctionRangeSave=!1,a?s.isFunctionRangeSave=!0:s.isFunctionRangeSelect(C,b.r,b.c,b.i,h),s.isFunctionRangeSave&&(p.push(x),s.execvertex["r"+x.r+"c"+x.c+"i"+x.index]=x,v++)}}for(;p.length>0;){let k=p.shift(),b={};s.getChildrenVertex(k,m,b);for(let w in m){let x=m[w];if(x==null)continue;let C="r"+k.r+"c"+k.c+"i"+k.index;if(w in b)continue;s.isFunctionRangeSave=!1;let S=Ll(x.r,x.c,x.index);s.isFunctionRangeSelect(S,k.r,k.c,k.index,h),s.isFunctionRangeSave&&(w in s.execvertex||(p.push(x),s.execvertex[w]=x),v++,s.execvertex[w].chidren[C]=1)}}s.groupValuesRefreshData=[];let y=0;for(;y<v;)for(let k in s.execvertex){let b=s.execvertex[k];b.color=="w"?s.functionDFS(b):b.color=="b"&&y++}s.execFunctionExist=null},getChildrenVertex:function(e,n,t){let l="r"+e.r+"c"+e.c+"i"+e.index;if(t[l]=1,e.chidren!=null)for(let o in e.chidren)n[o]&&!(o in t)&&this.getChildrenVertex(n[o],n,t)},functionDFS:function(e){let n=this;e.color="g",e.times+=1;for(let o in e.chidren){let a=n.execvertex[o];a.color=="w"&&(a.parent="r"+e.r.toString()+"c"+e.c.toString()+"i"+e.index,n.functionDFS(a))}e.color="b",window.luckysheet_getcelldata_cache=null;let t=Ll(e.r,e.c,e.index),l=n.execfunction(t,e.r,e.c,e.index);n.groupValuesRefreshData.push({r:e.r,c:e.c,v:l[1],f:l[2],spe:l[3],index:e.index}),n.execFunctionGlobalData[e.r+"_"+e.c+"_"+e.index]={v:l[1],f:l[2]}},groupValuesRefreshData:[],groupValuesRefresh:function(){let e=this,n=At();if(e.groupValuesRefreshData.length>0){for(let t=0;t<e.groupValuesRefreshData.length;t++){let l=e.groupValuesRefreshData[t],o=n[Z(l.index)],a=o.data;if(a==null)continue;let s={};l.spe!=null&&(l.spe.type=="sparklines"?s.spl=l.spe.data:l.spe.type=="dynamicArrayItem"&&(o.dynamicArray=e.insertUpdateDynamicArray(l.spe.data))),s.v=l.v,s.f=l.f,Ht(l.r,l.c,a,s),ne.saveParam("v",l.index,l.v,{r:l.r,c:l.c})}xe.webWorkerFlowDataCache(f.flowdata),e.groupValuesRefreshData=[]}},delFunctionGroup:function(e,n,t){t==null&&(t=f.currentSheetIndex);let l=At(),o=l[Z(t)],a=o.calcChain;if(a!=null)for(let u=0;u<a.length;u++){let h=a[u];if(h.r==e&&h.c==n&&h.index==t){a.splice(u,1),ne.saveParam("fc",t,null,{op:"del",pos:u});break}}let s=o.dynamicArray;if(s!=null)for(let u=0;u<s.length;u++){let h=s[u];if(h.r==e&&h.c==n&&(h.index==null||h.index==t)){s.splice(u,1),ne.saveParam("ac",t,null,{op:"del",pos:u});break}}Kn(l)},execfunction:function(e,n,t,l,o,a){let s=this,h=Q().formulaMore;if(e.indexOf(s.error.r)>-1)return[!1,s.error.r,e];s.checkBracketNum(e)||(e+=")"),l==null&&(l=f.currentSheetIndex),f.calculateSheetIndex=l;let d=$.trim(s.functionParserExe(e));if((d.substr(0,20)=="luckysheet_function."||d.substr(0,22)=="luckysheet_compareWith")&&(s.functionHTMLIndex=0),!s.testFunction(e,d)||d=="")return W.info("",h.execfunctionError),[!1,s.error.n,e];let m=null;window.luckysheetCurrentRow=n,window.luckysheetCurrentColumn=t,window.luckysheetCurrentIndex=l,window.luckysheetCurrentFunction=e;let p=null;try{if(d.indexOf("luckysheet_getcelldata")>-1){let y=d.split("luckysheet_getcelldata('");for(let k=1;k<y.length;k++){let b=y[k].split("')")[0],w=s.getcellrange(b);if(w.row[0]<0||w.column[0]<0)return[!0,s.error.r,e];if(w.sheetIndex==f.calculateSheetIndex&&n>=w.row[0]&&n<=w.row[1]&&t>=w.column[0]&&t<=w.column[1])return he()?alert(h.execfunctionSelfError):W.info("",h.execfunctionSelfErrorResult),[!1,0,e]}}m=new Function("return "+d)(),typeof m=="string"&&(m=m.replace(/\x7F/g,'"')),d.indexOf("SPLINES")>-1&&(p=m,m="")}catch(y){let k=y;console.log(y,d),k=s.errorInfo(k),m=[s.error.n,k]}N(m)=="object"&&m.startCell!=null&&(N(m.data)=="array"?m=s.error.v:N(m.data)=="object"&&!me(m.data.v)?m=m.data.v:me(m.data)?m=0:m.cell>1||m.rowl>1?m=m.data:m=0);let v=null;if(N(m)=="array"){let y=!1;N(m[0])!="array"&&m.length==2&&(y=H(m[0])),y?m=m[0]:N(m[0])=="array"&&m.length==1&&m[0].length==1?m=m[0][0]:(v={r:n,c:t,f:e,index:l,data:m},m="")}return window.luckysheetCurrentRow=null,window.luckysheetCurrentColumn=null,window.luckysheetCurrentIndex=null,window.luckysheetCurrentFunction=null,n!=null&&t!=null&&(o&&s.execFunctionGroup(n,t,m,l),a||s.insertUpdateFunctionGroup(n,t,l)),p?[!0,m,e,{type:"sparklines",data:p}]:v?[!0,m,e,{type:"dynamicArrayItem",data:v}]:[!0,m,e]},testFunction:function(e,n){return e.substr(0,1)=="="},execstringformula:function(e,n,t,l){let o=this;return this.execfunction(e,n,t,l)},functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},g=Ov});function _a(e,n="redo"){if(e==null)return;let t=e.data;n=="undo"&&(t=e.curdata);for(let l=0;l<e.range.length;l++){let o=e.range[l].row[0],a=e.range[l].row[1],s=e.range[l].column[0],u=e.range[l].column[1];for(let h=o;h<a+1;h++)for(let d=s;d<u+1&&!(h>t.length-1);d++)t[h][d]==null||t[h][d].f==null||t[h][d].f==""?g.delFunctionGroup(h,d,e.sheetIndex):t[h][d]!=null&&t[h][d].f!=null&&t[h][d].f.length>0&&g.insertUpdateFunctionGroup(h,d,e.sheetIndex)}}var Bv,_n,Ca=Me(()=>{dl();Qt();nn();mr();Wr();qr();gr();qi();Gi();yn();Ut();Li();Vr();Yt();Et();Ke();Zt();Nl();Bv={redo:function(e){if(f.jfredo.length==0)return;let n=f.jfredo.pop();if(f.jfundo.push(n),f.clearjfundo=!1,ye.hasSheet(n.sheetIndex)&&f.currentSheetIndex!=n.sheetIndex&&ye.changeSheetExec(n.sheetIndex),n.type=="datachange"){_a(n);let l={cfg:n.config,RowlChange:n.RowlChange,cdformat:n.cdformat,dataVerification:n.dataVerification,dynamicArray:n.dynamicArray,hyperlink:n.hyperlink};Ze(n.data,n.dataRange,l)}else if(n.type=="pasteCut"){let l={sheetIndex:n.source.sheetIndex,data:n.source.curData,curData:n.source.data,config:n.source.curConfig,curConfig:n.source.config,cdformat:n.source.curCdformat,curCdformat:n.source.cdformat,dataVerification:n.source.curDataVerification,curDataVerification:n.source.dataVerification,range:n.source.range},o={sheetIndex:n.target.sheetIndex,data:n.target.curData,curData:n.target.data,config:n.target.curConfig,curConfig:n.target.config,cdformat:n.target.curCdformat,curCdformat:n.target.cdformat,dataVerification:n.target.curDataVerification,curDataVerification:n.target.dataVerification,range:n.target.range};ji(l,o,n.RowlChange)}else if(n.type=="rangechange")_a(n),zi(n.data,n.range,n.cdformat);else if(n.type=="resize"){f.config=n.config,f.luckysheetfile[Z(n.sheetIndex)].config=f.config,n.ctrlType=="resizeR"?ne.saveParam("cg",n.sheetIndex,n.config.rowlen,{k:"rowlen"}):n.ctrlType=="resizeC"&&ne.saveParam("cg",n.sheetIndex,n.config.columnlen,{k:"columnlen"});let l=$.extend(!0,{},n.images);f.luckysheetfile[Z(n.sheetIndex)].images=l,ne.saveParam("all",n.sheetIndex,l,{k:"images"}),Ie.images=l,Ie.allImagesShow(),Ct(f.flowdata.length,f.flowdata[0].length)}else if(n.type=="cellRowChange")Kl(n.data[0].length,n.data.length,n.data,n.config,n.range,n.ctrlType,n.ctrlValue,n.cdformat);else if(n.type=="extend")Kl(n.data[0].length,n.data.length,n.data,n.config,n.range,"dele",n.ctrlValue);else if(n.type=="dele"){let l=$.extend(!0,{},n.ctrlValue);l.restore=!0,Kl(n.data[0].length,n.data.length,n.data,n.config,n.range,"extend",l)}else if(n.type=="addRC"){let l=$.extend(!0,{},n.ctrlValue);l.direction=="rightbottom"&&(l.index=l.index+1),Hn(n.data,n.config,"delRC",l,n.calc,n.filterObj,n.cf,n.af,n.freezen,n.dataVerification,n.hyperlink)}else if(n.type=="delRC"){let l=$.extend(!0,{},n.ctrlValue);l.restore=!0,l.direction="lefttop",Hn(n.data,n.config,"addRC",l,n.calc,n.filterObj,n.cf,n.af,n.freezen,n.dataVerification,n.hyperlink)}else if(n.type=="deleteCell")Ro(n.data,n.config,n.ctrl,n.calc,n.filterObj,n.cf,n.dataVerification,n.hyperlink);else if(n.type=="showHidRows")f.config=n.config,f.luckysheetfile[Z(n.sheetIndex)].config=n.config,ne.saveParam("cg",n.sheetIndex,n.config.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length);else if(n.type=="showHidCols")f.config=n.config,f.luckysheetfile[Z(n.sheetIndex)].config=n.config,ne.saveParam("cg",n.sheetIndex,n.config.colhidden,{k:"colhidden"}),Ct(f.flowdata.length,f.flowdata[0].length);else if(n.type=="datachangeAll")g.execFunctionGroup(),Kl(n.data[0].length,n.data.length,n.data,null,n.range,"datachangeAll",n.ctrlValue);else if(n.type=="datachangeAll_filter_clear")Dl(n.filter_save),$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").each(function(l){let o=$(this),a=n.optiongroups[l];On(o,a.optionstate,a.rowhidden,a.caljs,!1,a.st_r,a.ed_r,a.cindex,a.st_c,a.ed_c)}),ne.saveParam("fsr",f.currentSheetIndex,{filter:n.optiongroups,filter_select:n.filter_save}),f.config=n.config,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,f.config.rowhidden==null&&(f.config.rowhidden={}),ne.saveParam("cg",f.currentSheetIndex,f.config.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if(n.type=="datachangeAll_filter"){let l=$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").eq(n.optionsindex),o=l.data("str"),a=l.data("edr"),s=l.data("cindex"),u=l.data("stc"),h=l.data("edc");On(l,Ln.hasKey(n.rowhidenPre),n.rowhidenPre,n.caljs,!0,o,a,s,u,h),f.config=n.config,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,f.config.rowhidden==null&&(f.config.rowhidden={}),ne.saveParam("cg",f.currentSheetIndex,f.config.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if(n.type=="filtershow")$("#luckysheet-filter-selected-sheet"+n.sheetIndex+", #luckysheet-filter-options-sheet"+n.sheetIndex).remove(),ne.allowUpdate&&ne.saveParam("all",n.sheetIndex,null,{k:"filter_select"});else if(n.type=="pivotTable_change")f.luckysheetfile[Z(n.sheetIndex)].pivotTable=n.pivotTable,Oe.getCellData(n.sheetIndex),Oe.initialPivotManage(!0),Oe.refreshPivotTable();else if(n.type=="addSheet")ye.deleteSheet(n.index),ye.changeSheetExec(n.currentSheetIndex),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(n.type=="copySheet")ye.deleteSheet(n.index),ye.changeSheetExec(n.copyindex);else if(n.type=="deleteSheet"){let l=!1;for(let o=0;o<f.luckysheetfile.length;o++)f.luckysheetfile[o].name==n.name&&(l=!0);l||(ye.createSheetbydata(n,"isrenew"),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide())}else if(n.type=="sheetName")f.luckysheetfile[Z(n.sheetIndex)].name=n.oldtxt,$("#luckysheet-sheets-item"+n.sheetIndex).find(".luckysheet-sheets-item-name").html(n.oldtxt),ne.saveParam("all",n.sheetIndex,n.oldtxt,{k:"name"});else if(n.type=="sheetColor"){f.luckysheetfile[Z(n.sheetIndex)].color=n.oldcolor;let l=$("#luckysheet-sheets-item"+n.sheetIndex);l.find(".luckysheet-sheets-item-color").remove(),n.oldcolor!=null&&l.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+n.oldcolor+';"></div>'),ne.saveParam("all",n.sheetIndex,n.oldcolor,{k:"color"})}else if(n.type=="mergeChange"){let l={cfg:n.config};Ze(n.data,n.range,l)}else if(n.type=="updateDataVerification")Ye.ref(n.currentDataVerification,n.historyDataVerification,n.sheetIndex);else if(n.type=="updateDataVerificationOfCheckbox")Ye.refOfCheckbox(n.currentDataVerification,n.historyDataVerification,n.sheetIndex,n.data,n.range);else if(n.type=="updateHyperlink")Cl.ref(n.currentHyperlink,n.historyHyperlink,n.sheetIndex,n.data,n.range);else if(n.type=="updateCF"){let l=n.data.historyRules;for(let o=0;o<l.length;o++){let a=l[o].sheetIndex;f.luckysheetfile[Z(a)].luckysheet_conditionformat_save=l[o].luckysheet_conditionformat_save,ne.allowUpdate&&ne.saveParam("all",a,l[o].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}Se.ref()}else if(n.type=="updateAF"){let l=n.data.historyRules,o=Z(n.sheetIndex);f.luckysheetfile[o].luckysheet_alternateformat_save=$.extend(!0,[],l),setTimeout(function(){Be()},1)}else if(n.type=="borderChange")n.config.borderInfo==null?ne.saveParam("cg",n.sheetIndex,[],{k:"borderInfo"}):ne.saveParam("cg",n.sheetIndex,n.config.borderInfo,{k:"borderInfo"}),f.config=n.config,f.luckysheetfile[Z(n.sheetIndex)].config=f.config,setTimeout(function(){Be()},1);else if(n.type=="postil"){He.ref(n.data,n.rc);for(let l=0;l<n.rc.length;l++){let o=n.rc[l].split("_")[0],a=n.rc[l].split("_")[1];n.data[o][a]!=null&&n.data[o][a].ps!=null?He.buildPs(o,a,n.data[o][a].ps):He.buildPs(o,a,null)}}else n.type=="imageCtrl"?(Ie.images=$.extend(!0,{},n.images),Ie.allImagesShow(),Ie.ref()):n.type=="zoomChange"&&(f.zoomRatio=n.zoomRatio,ne.saveParam("all",n.currentSheetIndex,n.zoomRatio,{k:"zoomRatio"}),ir(),Ui());rl(e),n.range&&(f.luckysheet_select_save=n.range,lt()),f.clearjfundo=!0;let t=Wc(We({},n),{data:n.curdata,curdata:n.data});Je.createHookFunction("updated",t)},undo:function(){if(f.jfundo.length==0)return;let e=f.jfundo.pop();if(f.jfredo.push(e),f.clearjfundo=!1,ye.hasSheet(e.sheetIndex)&&f.currentSheetIndex!=e.sheetIndex&&ye.changeSheetExec(e.sheetIndex),e.type=="datachange"){g.execFunctionGroup();let n={cfg:e.curConfig,RowlChange:e.RowlChange,cdformat:e.curCdformat,dataVerification:e.curDataVerification,dynamicArray:e.curDynamicArray,hyperlink:e.curHyperlink};_a(e,"undo"),Ze(e.curdata,e.range,n)}else if(e.type=="pasteCut")ji(e.source,e.target,e.RowlChange);else if(e.type=="rangechange")_a(e,"undo"),zi(e.curdata,e.range,e.curCdformat);else if(e.type=="resize"){f.config=e.curconfig,f.luckysheetfile[Z(e.sheetIndex)].config=f.config,e.ctrlType=="resizeR"?ne.saveParam("cg",e.sheetIndex,e.curconfig.rowlen,{k:"rowlen"}):e.ctrlType=="resizeC"&&ne.saveParam("cg",e.sheetIndex,e.curconfig.columnlen,{k:"columnlen"});let n=$.extend(!0,{},e.curImages);f.luckysheetfile[Z(e.sheetIndex)].images=n,ne.saveParam("all",e.sheetIndex,n,{k:"images"}),Ie.images=n,Ie.allImagesShow(),Ct(f.flowdata.length,f.flowdata[0].length)}else if(e.type=="cellRowChange")Kl(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue,e.curCdformat);else if(e.type=="extend")Kl(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue);else if(e.type=="dele"){let n=$.extend(!0,{},e.ctrlValue);n.restore=!0,Kl(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue)}else if(e.type=="addRC")Hn(e.curData,e.curConfig,"addRC",e.ctrlValue,e.curCalc,e.curFilterObj,e.curCf,e.curAf,e.curFreezen,e.curDataVerification,e.curHyperlink);else if(e.type=="delRC")Hn(e.curData,e.curConfig,"delRC",e.ctrlValue,e.curCalc,e.curFilterObj,e.curCf,e.curAf,e.curFreezen,e.curDataVerification,e.curHyperlink);else if(e.type=="deleteCell")Ro(e.curData,e.curConfig,e.ctrl,e.curCalc,e.curFilterObj,e.curCf,e.curDataVerification,e.curHyperlink);else if(e.type=="showHidRows")f.config=e.curconfig,f.luckysheetfile[Z(e.sheetIndex)].config=e.curconfig,ne.saveParam("cg",e.sheetIndex,e.curconfig.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length);else if(e.type=="showHidCols")f.config=e.curconfig,f.luckysheetfile[Z(e.sheetIndex)].config=e.curconfig,ne.saveParam("cg",e.sheetIndex,e.curconfig.colhidden,{k:"colhidden"}),Ct(f.flowdata.length,f.flowdata[0].length);else if(e.type=="datachangeAll")g.execFunctionGroup(),Kl(e.curdata[0].length,e.curdata.length,e.curdata,null,e.currange,"datachangeAll",e.ctrlValue);else if(e.type=="datachangeAll_filter_clear")ne.saveParam("fsc",f.currentSheetIndex,null),f.config=e.curconfig,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,{},{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text("\u65E0"),$("#luckysheet-filter-selected-sheet"+f.currentSheetIndex+", #luckysheet-filter-options-sheet"+f.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if(e.type=="datachangeAll_filter"){let n=$("#luckysheet-filter-options-sheet"+f.currentSheetIndex+" .luckysheet-filter-options").eq(e.optionsindex),t=n.data("str"),l=n.data("edr"),o=n.data("cindex"),a=n.data("stc"),s=n.data("edc");On(n,Ln.hasKey(e.rowhidden),e.rowhidden,e.caljs,!0,t,l,o,a,s),f.config=e.curconfig,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,f.config.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if(e.type=="filtershow")f.luckysheet_select_save=[e.filter_save],f.filterchage=!1,Io(),f.filterchage=!0,ne.saveParam("all",e.sheetIndex,e.filter_save,{k:"filter_select"});else if(e.type=="pivotTable_change")f.luckysheetfile[Z(e.sheetIndex)].pivotTable=e.pivotTablecur,Oe.getCellData(e.sheetIndex),Oe.initialPivotManage(!0),Oe.refreshPivotTable();else if(e.type=="addSheet")ye.createSheetbydata(e.sheetconfig),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(e.type=="copySheet")ye.copySheet(e.copyindex);else if(e.type=="deleteSheet")ye.deleteSheet(e.index),e.order==0?ye.changeSheetExec(f.luckysheetfile[0].index):ye.changeSheetExec(f.luckysheetfile[e.order-1].index),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(e.type=="sheetName")f.luckysheetfile[Z(e.sheetIndex)].name=e.txt,$("#luckysheet-sheets-item"+e.sheetIndex).find(".luckysheet-sheets-item-name").html(e.txt),ne.saveParam("all",e.sheetIndex,e.txt,{k:"name"});else if(e.type=="sheetColor"){f.luckysheetfile[Z(e.sheetIndex)].color=e.color;let n=$("#luckysheet-sheets-item"+e.sheetIndex);n.find(".luckysheet-sheets-item-color").remove(),e.color!=null&&n.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),ne.saveParam("all",e.sheetIndex,e.color,{k:"color"})}else if(e.type=="mergeChange"){let n={cfg:e.curConfig};Ze(e.curData,e.range,n)}else if(e.type=="updateDataVerification")Ye.ref(e.historyDataVerification,e.currentDataVerification,e.sheetIndex);else if(e.type=="updateDataVerificationOfCheckbox")Ye.refOfCheckbox(e.historyDataVerification,e.currentDataVerification,e.sheetIndex,e.curData,e.range);else if(e.type=="updateHyperlink")Cl.ref(e.historyHyperlink,e.currentHyperlink,e.sheetIndex,e.curData,e.range);else if(e.type=="updateCF"){let n=e.data.currentRules;for(let t=0;t<n.length;t++){let l=n[t].sheetIndex;f.luckysheetfile[Z(l)].luckysheet_conditionformat_save=n[t].luckysheet_conditionformat_save,ne.allowUpdate&&ne.saveParam("all",l,n[t].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}Se.ref()}else if(e.type=="updateAF"){let n=e.data.currentRules,t=Z(e.sheetIndex);f.luckysheetfile[t].luckysheet_alternateformat_save=$.extend(!0,[],n),setTimeout(function(){Be()},1)}else if(e.type=="borderChange")ne.saveParam("cg",e.sheetIndex,e.curconfig.borderInfo,{k:"borderInfo"}),f.config=e.curconfig,f.luckysheetfile[Z(e.sheetIndex)].config=f.config,setTimeout(function(){Be()},1);else if(e.type=="postil"){He.ref(e.curdata,e.rc);for(let n=0;n<e.rc.length;n++){let t=e.rc[n].split("_")[0],l=e.rc[n].split("_")[1];e.curdata[t][l]!=null&&e.curdata[t][l].ps!=null?He.buildPs(t,l,e.curdata[t][l].ps):He.buildPs(t,l,null)}}else e.type=="imageCtrl"?(Ie.images=$.extend(!0,{},e.curImages),Ie.allImagesShow(),Ie.ref()):e.type=="zoomChange"&&(f.zoomRatio=e.curZoomRatio,ne.saveParam("all",e.currentSheetIndex,e.curZoomRatio,{k:"zoomRatio"}),ir(),Ui());e.range&&(f.luckysheet_select_save=e.range,lt()),f.clearjfundo=!0}},_n=Bv});var $a,Wn,hc=Me(()=>{$a=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],Wn={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(e){return typeof console!="undefined"&&console.warn(e)},getWeek:function(e){var n=new Date(e.getTime());n.setHours(0,0,0,0),n.setDate(n.getDate()+3-(n.getDay()+6)%7);var t=new Date(n.getFullYear(),0,4);return 1+Math.round(((n.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1}});var Ta,Sa,dc=Me(()=>{Ta={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(e){var n=e%100;if(n>3&&n<21)return"th";switch(n%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Sa=Ta});function mc(e,n){var t;return function(){var l=this,o=arguments;clearTimeout(t),t=setTimeout(function(){return e.apply(l,o)},n)}}var Vl,ar,Ia,gc=Me(()=>{Vl=function(e,n){return n===void 0&&(n=2),("000"+e).slice(n*-1)},ar=function(e){return e===!0?1:0};Ia=function(e){return e instanceof Array?e:[e]}});function ql(e,n,t){if(t===!0)return e.classList.add(n);e.classList.remove(n)}function Xt(e,n,t){var l=window.document.createElement(e);return n=n||"",t=t||"",l.className=n,t!==void 0&&(l.textContent=t),l}function Lo(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function pc(e,n){if(n(e))return e;if(e.parentNode)return pc(e.parentNode,n)}function Oo(e,n){var t=Xt("div","numInputWrapper"),l=Xt("input","numInput "+e),o=Xt("span","arrowUp"),a=Xt("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?l.type="number":(l.type="text",l.pattern="\\d*"),n!==void 0)for(var s in n)l.setAttribute(s,n[s]);return t.appendChild(l),t.appendChild(o),t.appendChild(a),t}function sr(e){try{if(typeof e.composedPath=="function"){var n=e.composedPath();return n[0]}return e.target}catch(t){return e.target}}var cd=Me(()=>{});var vc,Bo,ud,Cn,Ki,yc=Me(()=>{gc();vc=function(){},Bo=function(e,n,t){return t.months[n?"shorthand":"longhand"][e]},ud={D:vc,F:function(e,n,t){e.setMonth(t.months.longhand.indexOf(n))},G:function(e,n){e.setHours((e.getHours()>=12?12:0)+parseFloat(n))},H:function(e,n){e.setHours(parseFloat(n))},J:function(e,n){e.setDate(parseFloat(n))},K:function(e,n,t){e.setHours(e.getHours()%12+12*ar(new RegExp(t.amPM[1],"i").test(n)))},M:function(e,n,t){e.setMonth(t.months.shorthand.indexOf(n))},S:function(e,n){e.setSeconds(parseFloat(n))},U:function(e,n){return new Date(parseFloat(n)*1e3)},W:function(e,n,t){var l=parseInt(n),o=new Date(e.getFullYear(),0,2+(l-1)*7,0,0,0,0);return o.setDate(o.getDate()-o.getDay()+t.firstDayOfWeek),o},Y:function(e,n){e.setFullYear(parseFloat(n))},Z:function(e,n){return new Date(n)},d:function(e,n){e.setDate(parseFloat(n))},h:function(e,n){e.setHours((e.getHours()>=12?12:0)+parseFloat(n))},i:function(e,n){e.setMinutes(parseFloat(n))},j:function(e,n){e.setDate(parseFloat(n))},l:vc,m:function(e,n){e.setMonth(parseFloat(n)-1)},n:function(e,n){e.setMonth(parseFloat(n)-1)},s:function(e,n){e.setSeconds(parseFloat(n))},u:function(e,n){return new Date(parseFloat(n))},w:vc,y:function(e,n){e.setFullYear(2e3+parseFloat(n))}},Cn={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},Ki={Z:function(e){return e.toISOString()},D:function(e,n,t){return n.weekdays.shorthand[Ki.w(e,n,t)]},F:function(e,n,t){return Bo(Ki.n(e,n,t)-1,!1,n)},G:function(e,n,t){return Vl(Ki.h(e,n,t))},H:function(e){return Vl(e.getHours())},J:function(e,n){return n.ordinal!==void 0?e.getDate()+n.ordinal(e.getDate()):e.getDate()},K:function(e,n){return n.amPM[ar(e.getHours()>11)]},M:function(e,n){return Bo(e.getMonth(),!0,n)},S:function(e){return Vl(e.getSeconds())},U:function(e){return e.getTime()/1e3},W:function(e,n,t){return t.getWeek(e)},Y:function(e){return Vl(e.getFullYear(),4)},d:function(e){return Vl(e.getDate())},h:function(e){return e.getHours()%12?e.getHours()%12:12},i:function(e){return Vl(e.getMinutes())},j:function(e){return e.getDate()},l:function(e,n){return n.weekdays.longhand[e.getDay()]},m:function(e){return Vl(e.getMonth()+1)},n:function(e){return e.getMonth()+1},s:function(e){return e.getSeconds()},u:function(e){return e.getTime()},w:function(e){return e.getDay()},y:function(e){return String(e.getFullYear()).substring(2)}}});function cr(e,n,t){return t===void 0&&(t=!0),t!==!1?new Date(e.getTime()).setHours(0,0,0,0)-new Date(n.getTime()).setHours(0,0,0,0):e.getTime()-n.getTime()}function Da(e){var n=e.defaultHour,t=e.defaultMinute,l=e.defaultSeconds;if(e.minDate!==void 0){var o=e.minDate.getHours(),a=e.minDate.getMinutes(),s=e.minDate.getSeconds();n<o&&(n=o),n===o&&t<a&&(t=a),n===o&&t===a&&l<s&&(l=e.minDate.getSeconds())}if(e.maxDate!==void 0){var u=e.maxDate.getHours(),h=e.maxDate.getMinutes();n=Math.min(n,u),n===u&&(t=Math.min(h,t)),n===u&&t===h&&(l=e.maxDate.getSeconds())}return{hours:n,minutes:t,seconds:l}}var kc,Ra,fd,Fa,hd,dd,md=Me(()=>{yc();hc();dc();kc=function(e){var n=e.config,t=n===void 0?Wn:n,l=e.l10n,o=l===void 0?Ta:l,a=e.isMobile,s=a===void 0?!1:a;return function(u,h,d){var m=d||o;return t.formatDate!==void 0&&!s?t.formatDate(u,h,m):h.split("").map(function(p,v,y){return Ki[p]&&y[v-1]!=="\\"?Ki[p](u,m,t):p!=="\\"?p:""}).join("")}},Ra=function(e){var n=e.config,t=n===void 0?Wn:n,l=e.l10n,o=l===void 0?Ta:l;return function(a,s,u,h){if(!(a!==0&&!a)){var d=h||o,m,p=a;if(a instanceof Date)m=new Date(a.getTime());else if(typeof a!="string"&&a.toFixed!==void 0)m=new Date(a);else if(typeof a=="string"){var v=s||(t||Wn).dateFormat,y=String(a).trim();if(y==="today")m=new Date,u=!0;else if(t&&t.parseDate)m=t.parseDate(a,v);else if(/Z$/.test(y)||/GMT$/.test(y))m=new Date(a);else{for(var k=void 0,b=[],w=0,x=0,C="";w<v.length;w++){var S=v[w],_=S==="\\",T=v[w-1]==="\\"||_;if(Cn[S]&&!T){C+=Cn[S];var F=new RegExp(C).exec(a);F&&(k=!0)&&b[S!=="Y"?"push":"unshift"]({fn:ud[S],val:F[++x]})}else _||(C+=".")}m=!t||!t.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),b.forEach(function(R){var I=R.fn,P=R.val;return m=I(m,P,d)||m}),m=k?m:void 0}}if(!(m instanceof Date&&!isNaN(m.getTime()))){t.errorHandler(new Error("Invalid date provided: "+p));return}return u===!0&&m.setHours(0,0,0,0),m}}};fd=function(e,n,t){return e>Math.min(n,t)&&e<Math.max(n,t)},Fa=function(e,n,t){return e*3600+n*60+t},hd=function(e){var n=Math.floor(e/3600),t=(e-n*3600)/60;return[n,t,e-n*3600-t*60]},dd={DAY:864e5}});var gd=Me(()=>{"use strict";typeof Object.assign!="function"&&(Object.assign=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];if(!e)throw TypeError("Cannot convert undefined or null to object");for(var l=function(u){u&&Object.keys(u).forEach(function(h){return e[h]=u[h]})},o=0,a=n;o<a.length;o++){var s=a[o];l(s)}return e})});function Vv(e,n){var t={config:jl(jl({},Wn),$l.defaultConfig),l10n:Sa};t.parseDate=Ra({config:t.config,l10n:t.l10n}),t._handlers=[],t.pluginElements=[],t.loadedPlugins=[],t._bind=b,t._setHoursFromDate=v,t._positionCalendar=Pe,t.changeMonth=le,t.changeYear=K,t.clear=se,t.close=ae,t.onMouseOver=$e,t._createElement=Xt,t.createDay=F,t.destroy=ue,t.isEnabled=U,t.jumpToDate=C,t.updateValue=Wl,t.open=ze,t.redraw=St,t.set=Te,t.setDate=Ae,t.toggle=Ft;function l(){t.utils={getDaysInMonth:function(J,re){return J===void 0&&(J=t.currentMonth),re===void 0&&(re=t.currentYear),J===1&&(re%4==0&&re%100!=0||re%400==0)?29:t.l10n.daysInMonth[J]}}}function o(){t.element=t.input=e,t.isOpen=!1,Ce(),Ue(),ft(),ke(),l(),t.isMobile||T(),x(),(t.selectedDates.length||t.config.noCalendar)&&(t.config.enableTime&&v(t.config.noCalendar?t.latestSelectedDateObj:void 0),Wl(!1)),u();var J=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!t.isMobile&&J&&Pe(),pt("onReady")}function a(){var J;return((J=t.calendarContainer)===null||J===void 0?void 0:J.getRootNode()).activeElement||document.activeElement}function s(J){return J.bind(t)}function u(){var J=t.config;J.weekNumbers===!1&&J.showMonths===1||J.noCalendar!==!0&&window.requestAnimationFrame(function(){if(t.calendarContainer!==void 0&&(t.calendarContainer.style.visibility="hidden",t.calendarContainer.style.display="block"),t.daysContainer!==void 0){var re=(t.days.offsetWidth+1)*J.showMonths;t.daysContainer.style.width=re+"px",t.calendarContainer.style.width=re+(t.weekWrapper!==void 0?t.weekWrapper.offsetWidth:0)+"px",t.calendarContainer.style.removeProperty("visibility"),t.calendarContainer.style.removeProperty("display")}})}function h(J){if(t.selectedDates.length===0){var re=t.config.minDate===void 0||cr(new Date,t.config.minDate)>=0?new Date:new Date(t.config.minDate.getTime()),pe=Da(t.config);re.setHours(pe.hours,pe.minutes,pe.seconds,re.getMilliseconds()),t.selectedDates=[re],t.latestSelectedDateObj=re}J!==void 0&&J.type!=="blur"&&Gn(J);var we=t._input.value;p(),Wl(),t._input.value!==we&&t._debouncedChange()}function d(J,re){return J%12+12*ar(re===t.l10n.amPM[1])}function m(J){switch(J%24){case 0:case 12:return 12;default:return J%12}}function p(){if(!(t.hourElement===void 0||t.minuteElement===void 0)){var J=(parseInt(t.hourElement.value.slice(-2),10)||0)%24,re=(parseInt(t.minuteElement.value,10)||0)%60,pe=t.secondElement!==void 0?(parseInt(t.secondElement.value,10)||0)%60:0;t.amPM!==void 0&&(J=d(J,t.amPM.textContent));var we=t.config.minTime!==void 0||t.config.minDate&&t.minDateHasTime&&t.latestSelectedDateObj&&cr(t.latestSelectedDateObj,t.config.minDate,!0)===0,Ve=t.config.maxTime!==void 0||t.config.maxDate&&t.maxDateHasTime&&t.latestSelectedDateObj&&cr(t.latestSelectedDateObj,t.config.maxDate,!0)===0;if(t.config.maxTime!==void 0&&t.config.minTime!==void 0&&t.config.minTime>t.config.maxTime){var Qe=Fa(t.config.minTime.getHours(),t.config.minTime.getMinutes(),t.config.minTime.getSeconds()),It=Fa(t.config.maxTime.getHours(),t.config.maxTime.getMinutes(),t.config.maxTime.getSeconds()),ct=Fa(J,re,pe);if(ct>It&&ct<Qe){var Lt=hd(Qe);J=Lt[0],re=Lt[1],pe=Lt[2]}}else{if(Ve){var st=t.config.maxTime!==void 0?t.config.maxTime:t.config.maxDate;J=Math.min(J,st.getHours()),J===st.getHours()&&(re=Math.min(re,st.getMinutes())),re===st.getMinutes()&&(pe=Math.min(pe,st.getSeconds()))}if(we){var vt=t.config.minTime!==void 0?t.config.minTime:t.config.minDate;J=Math.max(J,vt.getHours()),J===vt.getHours()&&re<vt.getMinutes()&&(re=vt.getMinutes()),re===vt.getMinutes()&&(pe=Math.max(pe,vt.getSeconds()))}}y(J,re,pe)}}function v(J){var re=J||t.latestSelectedDateObj;re&&re instanceof Date&&y(re.getHours(),re.getMinutes(),re.getSeconds())}function y(J,re,pe){t.latestSelectedDateObj!==void 0&&t.latestSelectedDateObj.setHours(J%24,re,pe||0,0),!(!t.hourElement||!t.minuteElement||t.isMobile)&&(t.hourElement.value=Vl(t.config.time_24hr?J:(12+J)%12+12*ar(J%12==0)),t.minuteElement.value=Vl(re),t.amPM!==void 0&&(t.amPM.textContent=t.l10n.amPM[ar(J>=12)]),t.secondElement!==void 0&&(t.secondElement.value=Vl(pe)))}function k(J){var re=sr(J),pe=parseInt(re.value)+(J.delta||0);(pe/1e3>1||J.key==="Enter"&&!/[^\d]/.test(pe.toString()))&&K(pe)}function b(J,re,pe,we){if(re instanceof Array)return re.forEach(function(Ve){return b(J,Ve,pe,we)});if(J instanceof Array)return J.forEach(function(Ve){return b(Ve,re,pe,we)});J.addEventListener(re,pe,we),t._handlers.push({remove:function(){return J.removeEventListener(re,pe,we)}})}function w(){pt("onChange")}function x(){if(t.config.wrap&&["open","close","toggle","clear"].forEach(function(pe){Array.prototype.forEach.call(t.element.querySelectorAll("[data-"+pe+"]"),function(we){return b(we,"click",t[pe])})}),t.isMobile){Ne();return}var J=mc(oe,50);if(t._debouncedChange=mc(w,Hv),t.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&b(t.daysContainer,"mouseover",function(pe){t.config.mode==="range"&&$e(sr(pe))}),b(t._input,"keydown",ie),t.calendarContainer!==void 0&&b(t.calendarContainer,"keydown",ie),!t.config.inline&&!t.config.static&&b(window,"resize",J),window.ontouchstart!==void 0?b(window.document,"touchstart",ce):b(window.document,"mousedown",ce),b(window.document,"focus",ce,{capture:!0}),t.config.clickOpens===!0&&(b(t._input,"focus",t.open),b(t._input,"click",t.open)),t.daysContainer!==void 0&&(b(t.monthNav,"click",Ul),b(t.monthNav,["keyup","increment"],k),b(t.daysContainer,"click",bt)),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0){var re=function(pe){return sr(pe).select()};b(t.timeContainer,["increment"],h),b(t.timeContainer,"blur",h,{capture:!0}),b(t.timeContainer,"click",S),b([t.hourElement,t.minuteElement],["focus","click"],re),t.secondElement!==void 0&&b(t.secondElement,"focus",function(){return t.secondElement&&t.secondElement.select()}),t.amPM!==void 0&&b(t.amPM,"click",function(pe){h(pe)})}t.config.allowInput&&b(t._input,"blur",ge)}function C(J,re){var pe=J!==void 0?t.parseDate(J):t.latestSelectedDateObj||(t.config.minDate&&t.config.minDate>t.now?t.config.minDate:t.config.maxDate&&t.config.maxDate<t.now?t.config.maxDate:t.now),we=t.currentYear,Ve=t.currentMonth;try{pe!==void 0&&(t.currentYear=pe.getFullYear(),t.currentMonth=pe.getMonth())}catch(Qe){Qe.message="Invalid date supplied: "+pe,t.config.errorHandler(Qe)}re&&t.currentYear!==we&&(pt("onYearChange"),z()),re&&(t.currentYear!==we||t.currentMonth!==Ve)&&pt("onMonthChange"),t.redraw()}function S(J){var re=sr(J);~re.className.indexOf("arrow")&&_(J,re.classList.contains("arrowUp")?1:-1)}function _(J,re,pe){var we=J&&sr(J),Ve=pe||we&&we.parentNode&&we.parentNode.firstChild,Qe=al("increment");Qe.delta=re,Ve&&Ve.dispatchEvent(Qe)}function T(){var J=window.document.createDocumentFragment();if(t.calendarContainer=Xt("div","flatpickr-calendar"),t.calendarContainer.tabIndex=-1,!t.config.noCalendar){if(J.appendChild(V()),t.innerContainer=Xt("div","flatpickr-innerContainer"),t.config.weekNumbers){var re=ee(),pe=re.weekWrapper,we=re.weekNumbers;t.innerContainer.appendChild(pe),t.weekNumbers=we,t.weekWrapper=pe}t.rContainer=Xt("div","flatpickr-rContainer"),t.rContainer.appendChild(G()),t.daysContainer||(t.daysContainer=Xt("div","flatpickr-days"),t.daysContainer.tabIndex=-1),A(),t.rContainer.appendChild(t.daysContainer),t.innerContainer.appendChild(t.rContainer),J.appendChild(t.innerContainer)}t.config.enableTime&&J.appendChild(q()),ql(t.calendarContainer,"rangeMode",t.config.mode==="range"),ql(t.calendarContainer,"animate",t.config.animate===!0),ql(t.calendarContainer,"multiMonth",t.config.showMonths>1),t.calendarContainer.appendChild(J);var Ve=t.config.appendTo!==void 0&&t.config.appendTo.nodeType!==void 0;if((t.config.inline||t.config.static)&&(t.calendarContainer.classList.add(t.config.inline?"inline":"static"),t.config.inline&&(!Ve&&t.element.parentNode?t.element.parentNode.insertBefore(t.calendarContainer,t._input.nextSibling):t.config.appendTo!==void 0&&t.config.appendTo.appendChild(t.calendarContainer)),t.config.static)){var Qe=Xt("div","flatpickr-wrapper");t.element.parentNode&&t.element.parentNode.insertBefore(Qe,t.element),Qe.appendChild(t.element),t.altInput&&Qe.appendChild(t.altInput),Qe.appendChild(t.calendarContainer)}!t.config.static&&!t.config.inline&&(t.config.appendTo!==void 0?t.config.appendTo:window.document.body).appendChild(t.calendarContainer)}function F(J,re,pe,we){var Ve=U(re,!0),Qe=Xt("span",J,re.getDate().toString());return Qe.dateObj=re,Qe.$i=we,Qe.setAttribute("aria-label",t.formatDate(re,t.config.ariaDateFormat)),J.indexOf("hidden")===-1&&cr(re,t.now)===0&&(t.todayDateElem=Qe,Qe.classList.add("today"),Qe.setAttribute("aria-current","date")),Ve?(Qe.tabIndex=-1,sl(re)&&(Qe.classList.add("selected"),t.selectedDateElem=Qe,t.config.mode==="range"&&(ql(Qe,"startRange",t.selectedDates[0]&&cr(re,t.selectedDates[0],!0)===0),ql(Qe,"endRange",t.selectedDates[1]&&cr(re,t.selectedDates[1],!0)===0),J==="nextMonthDay"&&Qe.classList.add("inRange")))):Qe.classList.add("flatpickr-disabled"),t.config.mode==="range"&&Vt(re)&&!sl(re)&&Qe.classList.add("inRange"),t.weekNumbers&&t.config.showMonths===1&&J!=="prevMonthDay"&&we%7==6&&t.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+t.config.getWeek(re)+"</span>"),pt("onDayCreate",Qe),Qe}function R(J){J.focus(),t.config.mode==="range"&&$e(J)}function I(J){for(var re=J>0?0:t.config.showMonths-1,pe=J>0?t.config.showMonths:-1,we=re;we!=pe;we+=J)for(var Ve=t.daysContainer.children[we],Qe=J>0?0:Ve.children.length-1,It=J>0?Ve.children.length:-1,ct=Qe;ct!=It;ct+=J){var Lt=Ve.children[ct];if(Lt.className.indexOf("hidden")===-1&&U(Lt.dateObj))return Lt}}function P(J,re){for(var pe=J.className.indexOf("Month")===-1?J.dateObj.getMonth():t.currentMonth,we=re>0?t.config.showMonths:-1,Ve=re>0?1:-1,Qe=pe-t.currentMonth;Qe!=we;Qe+=Ve)for(var It=t.daysContainer.children[Qe],ct=pe-t.currentMonth===Qe?J.$i+re:re<0?It.children.length-1:0,Lt=It.children.length,st=ct;st>=0&&st<Lt&&st!=(re>0?Lt:-1);st+=Ve){var vt=It.children[st];if(vt.className.indexOf("hidden")===-1&&U(vt.dateObj)&&Math.abs(J.$i-st)>=Math.abs(re))return R(vt)}t.changeMonth(Ve),O(I(Ve),0)}function O(J,re){var pe=a(),we=te(pe||document.body),Ve=J!==void 0?J:we?pe:t.selectedDateElem!==void 0&&te(t.selectedDateElem)?t.selectedDateElem:t.todayDateElem!==void 0&&te(t.todayDateElem)?t.todayDateElem:I(re>0?1:-1);Ve===void 0?t._input.focus():we?P(Ve,re):R(Ve)}function M(J,re){for(var pe=(new Date(J,re,1).getDay()-t.l10n.firstDayOfWeek+7)%7,we=t.utils.getDaysInMonth((re-1+12)%12,J),Ve=t.utils.getDaysInMonth(re,J),Qe=window.document.createDocumentFragment(),It=t.config.showMonths>1,ct=It?"prevMonthDay hidden":"prevMonthDay",Lt=It?"nextMonthDay hidden":"nextMonthDay",st=we+1-pe,vt=0;st<=we;st++,vt++)Qe.appendChild(F("flatpickr-day "+ct,new Date(J,re-1,st),st,vt));for(st=1;st<=Ve;st++,vt++)Qe.appendChild(F("flatpickr-day",new Date(J,re,st),st,vt));for(var il=Ve+1;il<=42-pe&&(t.config.showMonths===1||vt%7!=0);il++,vt++)Qe.appendChild(F("flatpickr-day "+Lt,new Date(J,re+1,il%Ve),il,vt));var Zr=Xt("div","dayContainer");return Zr.appendChild(Qe),Zr}function A(){if(t.daysContainer!==void 0){Lo(t.daysContainer),t.weekNumbers&&Lo(t.weekNumbers);for(var J=document.createDocumentFragment(),re=0;re<t.config.showMonths;re++){var pe=new Date(t.currentYear,t.currentMonth,1);pe.setMonth(t.currentMonth+re),J.appendChild(M(pe.getFullYear(),pe.getMonth()))}t.daysContainer.appendChild(J),t.days=t.daysContainer.firstChild,t.config.mode==="range"&&t.selectedDates.length===1&&$e()}}function z(){if(!(t.config.showMonths>1||t.config.monthSelectorType!=="dropdown")){var J=function(we){return t.config.minDate!==void 0&&t.currentYear===t.config.minDate.getFullYear()&&we<t.config.minDate.getMonth()?!1:!(t.config.maxDate!==void 0&&t.currentYear===t.config.maxDate.getFullYear()&&we>t.config.maxDate.getMonth())};t.monthsDropdownContainer.tabIndex=-1,t.monthsDropdownContainer.innerHTML="";for(var re=0;re<12;re++)if(!!J(re)){var pe=Xt("option","flatpickr-monthDropdown-month");pe.value=new Date(t.currentYear,re).getMonth().toString(),pe.textContent=Bo(re,t.config.shorthandCurrentMonth,t.l10n),pe.tabIndex=-1,t.currentMonth===re&&(pe.selected=!0),t.monthsDropdownContainer.appendChild(pe)}}}function L(){var J=Xt("div","flatpickr-month"),re=window.document.createDocumentFragment(),pe;t.config.showMonths>1||t.config.monthSelectorType==="static"?pe=Xt("span","cur-month"):(t.monthsDropdownContainer=Xt("select","flatpickr-monthDropdown-months"),t.monthsDropdownContainer.setAttribute("aria-label",t.l10n.monthAriaLabel),b(t.monthsDropdownContainer,"change",function(It){var ct=sr(It),Lt=parseInt(ct.value,10);t.changeMonth(Lt-t.currentMonth),pt("onMonthChange")}),z(),pe=t.monthsDropdownContainer);var we=Oo("cur-year",{tabindex:"-1"}),Ve=we.getElementsByTagName("input")[0];Ve.setAttribute("aria-label",t.l10n.yearAriaLabel),t.config.minDate&&Ve.setAttribute("min",t.config.minDate.getFullYear().toString()),t.config.maxDate&&(Ve.setAttribute("max",t.config.maxDate.getFullYear().toString()),Ve.disabled=!!t.config.minDate&&t.config.minDate.getFullYear()===t.config.maxDate.getFullYear());var Qe=Xt("div","flatpickr-current-month");return Qe.appendChild(pe),Qe.appendChild(we),re.appendChild(Qe),J.appendChild(re),{container:J,yearElement:Ve,monthElement:pe}}function E(){Lo(t.monthNav),t.monthNav.appendChild(t.prevMonthNav),t.config.showMonths&&(t.yearElements=[],t.monthElements=[]);for(var J=t.config.showMonths;J--;){var re=L();t.yearElements.push(re.yearElement),t.monthElements.push(re.monthElement),t.monthNav.appendChild(re.container)}t.monthNav.appendChild(t.nextMonthNav)}function V(){return t.monthNav=Xt("div","flatpickr-months"),t.yearElements=[],t.monthElements=[],t.prevMonthNav=Xt("span","flatpickr-prev-month"),t.prevMonthNav.innerHTML=t.config.prevArrow,t.nextMonthNav=Xt("span","flatpickr-next-month"),t.nextMonthNav.innerHTML=t.config.nextArrow,E(),Object.defineProperty(t,"_hidePrevMonthArrow",{get:function(){return t.__hidePrevMonthArrow},set:function(J){t.__hidePrevMonthArrow!==J&&(ql(t.prevMonthNav,"flatpickr-disabled",J),t.__hidePrevMonthArrow=J)}}),Object.defineProperty(t,"_hideNextMonthArrow",{get:function(){return t.__hideNextMonthArrow},set:function(J){t.__hideNextMonthArrow!==J&&(ql(t.nextMonthNav,"flatpickr-disabled",J),t.__hideNextMonthArrow=J)}}),t.currentYearElement=t.yearElements[0],Kr(),t.monthNav}function q(){t.calendarContainer.classList.add("hasTime"),t.config.noCalendar&&t.calendarContainer.classList.add("noCalendar");var J=Da(t.config);t.timeContainer=Xt("div","flatpickr-time"),t.timeContainer.tabIndex=-1;var re=Xt("span","flatpickr-time-separator",":"),pe=Oo("flatpickr-hour",{"aria-label":t.l10n.hourAriaLabel});t.hourElement=pe.getElementsByTagName("input")[0];var we=Oo("flatpickr-minute",{"aria-label":t.l10n.minuteAriaLabel});if(t.minuteElement=we.getElementsByTagName("input")[0],t.hourElement.tabIndex=t.minuteElement.tabIndex=-1,t.hourElement.value=Vl(t.latestSelectedDateObj?t.latestSelectedDateObj.getHours():t.config.time_24hr?J.hours:m(J.hours)),t.minuteElement.value=Vl(t.latestSelectedDateObj?t.latestSelectedDateObj.getMinutes():J.minutes),t.hourElement.setAttribute("step",t.config.hourIncrement.toString()),t.minuteElement.setAttribute("step",t.config.minuteIncrement.toString()),t.hourElement.setAttribute("min",t.config.time_24hr?"0":"1"),t.hourElement.setAttribute("max",t.config.time_24hr?"23":"12"),t.hourElement.setAttribute("maxlength","2"),t.minuteElement.setAttribute("min","0"),t.minuteElement.setAttribute("max","59"),t.minuteElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(pe),t.timeContainer.appendChild(re),t.timeContainer.appendChild(we),t.config.time_24hr&&t.timeContainer.classList.add("time24hr"),t.config.enableSeconds){t.timeContainer.classList.add("hasSeconds");var Ve=Oo("flatpickr-second");t.secondElement=Ve.getElementsByTagName("input")[0],t.secondElement.value=Vl(t.latestSelectedDateObj?t.latestSelectedDateObj.getSeconds():J.seconds),t.secondElement.setAttribute("step",t.minuteElement.getAttribute("step")),t.secondElement.setAttribute("min","0"),t.secondElement.setAttribute("max","59"),t.secondElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(Xt("span","flatpickr-time-separator",":")),t.timeContainer.appendChild(Ve)}return t.config.time_24hr||(t.amPM=Xt("span","flatpickr-am-pm",t.l10n.amPM[ar((t.latestSelectedDateObj?t.hourElement.value:t.config.defaultHour)>11)]),t.amPM.title=t.l10n.toggleTitle,t.amPM.tabIndex=-1,t.timeContainer.appendChild(t.amPM)),t.timeContainer}function G(){t.weekdayContainer?Lo(t.weekdayContainer):t.weekdayContainer=Xt("div","flatpickr-weekdays");for(var J=t.config.showMonths;J--;){var re=Xt("div","flatpickr-weekdaycontainer");t.weekdayContainer.appendChild(re)}return X(),t.weekdayContainer}function X(){if(!!t.weekdayContainer){var J=t.l10n.firstDayOfWeek,re=pd(t.l10n.weekdays.shorthand);J>0&&J<re.length&&(re=pd(re.splice(J,re.length),re.splice(0,J)));for(var pe=t.config.showMonths;pe--;)t.weekdayContainer.children[pe].innerHTML=`
      <span class='flatpickr-weekday'>
        `+re.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function ee(){t.calendarContainer.classList.add("hasWeeks");var J=Xt("div","flatpickr-weekwrapper");J.appendChild(Xt("span","flatpickr-weekday",t.l10n.weekAbbreviation));var re=Xt("div","flatpickr-weeks");return J.appendChild(re),{weekWrapper:J,weekNumbers:re}}function le(J,re){re===void 0&&(re=!0);var pe=re?J:J-t.currentMonth;pe<0&&t._hidePrevMonthArrow===!0||pe>0&&t._hideNextMonthArrow===!0||(t.currentMonth+=pe,(t.currentMonth<0||t.currentMonth>11)&&(t.currentYear+=t.currentMonth>11?1:-1,t.currentMonth=(t.currentMonth+12)%12,pt("onYearChange"),z()),A(),pt("onMonthChange"),Kr())}function se(J,re){if(J===void 0&&(J=!0),re===void 0&&(re=!0),t.input.value="",t.altInput!==void 0&&(t.altInput.value=""),t.mobileInput!==void 0&&(t.mobileInput.value=""),t.selectedDates=[],t.latestSelectedDateObj=void 0,re===!0&&(t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth()),t.config.enableTime===!0){var pe=Da(t.config),we=pe.hours,Ve=pe.minutes,Qe=pe.seconds;y(we,Ve,Qe)}t.redraw(),J&&pt("onChange")}function ae(){t.isOpen=!1,t.isMobile||(t.calendarContainer!==void 0&&t.calendarContainer.classList.remove("open"),t._input!==void 0&&t._input.classList.remove("active")),pt("onClose")}function ue(){t.config!==void 0&&pt("onDestroy");for(var J=t._handlers.length;J--;)t._handlers[J].remove();if(t._handlers=[],t.mobileInput)t.mobileInput.parentNode&&t.mobileInput.parentNode.removeChild(t.mobileInput),t.mobileInput=void 0;else if(t.calendarContainer&&t.calendarContainer.parentNode)if(t.config.static&&t.calendarContainer.parentNode){var re=t.calendarContainer.parentNode;if(re.lastChild&&re.removeChild(re.lastChild),re.parentNode){for(;re.firstChild;)re.parentNode.insertBefore(re.firstChild,re);re.parentNode.removeChild(re)}}else t.calendarContainer.parentNode.removeChild(t.calendarContainer);t.altInput&&(t.input.type="text",t.altInput.parentNode&&t.altInput.parentNode.removeChild(t.altInput),delete t.altInput),t.input&&(t.input.type=t.input._type,t.input.classList.remove("flatpickr-input"),t.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(pe){try{delete t[pe]}catch(we){}})}function fe(J){return t.calendarContainer.contains(J)}function ce(J){if(t.isOpen&&!t.config.inline){var re=sr(J),pe=fe(re),we=re===t.input||re===t.altInput||t.element.contains(re)||J.path&&J.path.indexOf&&(~J.path.indexOf(t.input)||~J.path.indexOf(t.altInput)),Ve=!we&&!pe&&!fe(J.relatedTarget),Qe=!t.config.ignoredFocusElements.some(function(It){return It.contains(re)});Ve&&Qe&&(t.config.allowInput&&t.setDate(t._input.value,!1,t.config.altInput?t.config.altFormat:t.config.dateFormat),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0&&t.input.value!==""&&t.input.value!==void 0&&h(),t.close(),t.config&&t.config.mode==="range"&&t.selectedDates.length===1&&t.clear(!1))}}function K(J){if(!(!J||t.config.minDate&&J<t.config.minDate.getFullYear()||t.config.maxDate&&J>t.config.maxDate.getFullYear())){var re=J,pe=t.currentYear!==re;t.currentYear=re||t.currentYear,t.config.maxDate&&t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth=Math.min(t.config.maxDate.getMonth(),t.currentMonth):t.config.minDate&&t.currentYear===t.config.minDate.getFullYear()&&(t.currentMonth=Math.max(t.config.minDate.getMonth(),t.currentMonth)),pe&&(t.redraw(),pt("onYearChange"),z())}}function U(J,re){var pe;re===void 0&&(re=!0);var we=t.parseDate(J,void 0,re);if(t.config.minDate&&we&&cr(we,t.config.minDate,re!==void 0?re:!t.minDateHasTime)<0||t.config.maxDate&&we&&cr(we,t.config.maxDate,re!==void 0?re:!t.maxDateHasTime)>0)return!1;if(!t.config.enable&&t.config.disable.length===0)return!0;if(we===void 0)return!1;for(var Ve=!!t.config.enable,Qe=(pe=t.config.enable)!==null&&pe!==void 0?pe:t.config.disable,It=0,ct=void 0;It<Qe.length;It++){if(ct=Qe[It],typeof ct=="function"&&ct(we))return Ve;if(ct instanceof Date&&we!==void 0&&ct.getTime()===we.getTime())return Ve;if(typeof ct=="string"){var Lt=t.parseDate(ct,void 0,!0);return Lt&&Lt.getTime()===we.getTime()?Ve:!Ve}else if(typeof ct=="object"&&we!==void 0&&ct.from&&ct.to&&we.getTime()>=ct.from.getTime()&&we.getTime()<=ct.to.getTime())return Ve}return!Ve}function te(J){return t.daysContainer!==void 0?J.className.indexOf("hidden")===-1&&J.className.indexOf("flatpickr-disabled")===-1&&t.daysContainer.contains(J):!1}function ge(J){var re=J.target===t._input,pe=t._input.value.trimEnd()!==Un();re&&pe&&!(J.relatedTarget&&fe(J.relatedTarget))&&t.setDate(t._input.value,!0,J.target===t.altInput?t.config.altFormat:t.config.dateFormat)}function ie(J){var re=sr(J),pe=t.config.wrap?e.contains(re):re===t._input,we=t.config.allowInput,Ve=t.isOpen&&(!we||!pe),Qe=t.config.inline&&pe&&!we;if(J.keyCode===13&&pe){if(we)return t.setDate(t._input.value,!0,re===t.altInput?t.config.altFormat:t.config.dateFormat),t.close(),re.blur();t.open()}else if(fe(re)||Ve||Qe){var It=!!t.timeContainer&&t.timeContainer.contains(re);switch(J.keyCode){case 13:It?(J.preventDefault(),h(),ot()):bt(J);break;case 27:J.preventDefault(),ot();break;case 8:case 46:pe&&!t.config.allowInput&&(J.preventDefault(),t.clear());break;case 37:case 39:if(!It&&!pe){J.preventDefault();var ct=a();if(t.daysContainer!==void 0&&(we===!1||ct&&te(ct))){var Lt=J.keyCode===39?1:-1;J.ctrlKey?(J.stopPropagation(),le(Lt),O(I(1),0)):O(void 0,Lt)}}else t.hourElement&&t.hourElement.focus();break;case 38:case 40:J.preventDefault();var st=J.keyCode===40?1:-1;t.daysContainer&&re.$i!==void 0||re===t.input||re===t.altInput?J.ctrlKey?(J.stopPropagation(),K(t.currentYear-st),O(I(1),0)):It||O(void 0,st*7):re===t.currentYearElement?K(t.currentYear-st):t.config.enableTime&&(!It&&t.hourElement&&t.hourElement.focus(),h(J),t._debouncedChange());break;case 9:if(It){var vt=[t.hourElement,t.minuteElement,t.secondElement,t.amPM].concat(t.pluginElements).filter(function(ur){return ur}),il=vt.indexOf(re);if(il!==-1){var Zr=vt[il+(J.shiftKey?-1:1)];J.preventDefault(),(Zr||t._input).focus()}}else!t.config.noCalendar&&t.daysContainer&&t.daysContainer.contains(re)&&J.shiftKey&&(J.preventDefault(),t._input.focus());break;default:break}}if(t.amPM!==void 0&&re===t.amPM)switch(J.key){case t.l10n.amPM[0].charAt(0):case t.l10n.amPM[0].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[0],p(),Wl();break;case t.l10n.amPM[1].charAt(0):case t.l10n.amPM[1].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[1],p(),Wl();break}(pe||fe(re))&&pt("onKeyDown",J)}function $e(J,re){if(re===void 0&&(re="flatpickr-day"),!(t.selectedDates.length!==1||J&&(!J.classList.contains(re)||J.classList.contains("flatpickr-disabled")))){for(var pe=J?J.dateObj.getTime():t.days.firstElementChild.dateObj.getTime(),we=t.parseDate(t.selectedDates[0],void 0,!0).getTime(),Ve=Math.min(pe,t.selectedDates[0].getTime()),Qe=Math.max(pe,t.selectedDates[0].getTime()),It=!1,ct=0,Lt=0,st=Ve;st<Qe;st+=dd.DAY)U(new Date(st),!0)||(It=It||st>Ve&&st<Qe,st<we&&(!ct||st>ct)?ct=st:st>we&&(!Lt||st<Lt)&&(Lt=st));var vt=Array.from(t.rContainer.querySelectorAll("*:nth-child(-n+"+t.config.showMonths+") > ."+re));vt.forEach(function(il){var Zr=il.dateObj,ur=Zr.getTime(),to=ct>0&&ur<ct||Lt>0&&ur>Lt;if(to){il.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(bi){il.classList.remove(bi)});return}else if(It&&!to)return;["startRange","inRange","endRange","notAllowed"].forEach(function(bi){il.classList.remove(bi)}),J!==void 0&&(J.classList.add(pe<=t.selectedDates[0].getTime()?"startRange":"endRange"),we<pe&&ur===we?il.classList.add("startRange"):we>pe&&ur===we&&il.classList.add("endRange"),ur>=ct&&(Lt===0||ur<=Lt)&&fd(ur,we,pe)&&il.classList.add("inRange"))})}}function oe(){t.isOpen&&!t.config.static&&!t.config.inline&&Pe()}function ze(J,re){if(re===void 0&&(re=t._positionElement),t.isMobile===!0){if(J){J.preventDefault();var pe=sr(J);pe&&pe.blur()}t.mobileInput!==void 0&&(t.mobileInput.focus(),t.mobileInput.click()),pt("onOpen");return}else if(t._input.disabled||t.config.inline)return;var we=t.isOpen;t.isOpen=!0,we||(t.calendarContainer.classList.add("open"),t._input.classList.add("active"),pt("onOpen"),Pe(re)),t.config.enableTime===!0&&t.config.noCalendar===!0&&t.config.allowInput===!1&&(J===void 0||!t.timeContainer.contains(J.relatedTarget))&&setTimeout(function(){return t.hourElement.select()},50)}function je(J){return function(re){var pe=t.config["_"+J+"Date"]=t.parseDate(re,t.config.dateFormat),we=t.config["_"+(J==="min"?"max":"min")+"Date"];pe!==void 0&&(t[J==="min"?"minDateHasTime":"maxDateHasTime"]=pe.getHours()>0||pe.getMinutes()>0||pe.getSeconds()>0),t.selectedDates&&(t.selectedDates=t.selectedDates.filter(function(Ve){return U(Ve)}),!t.selectedDates.length&&J==="min"&&v(pe),Wl()),t.daysContainer&&(St(),pe!==void 0?t.currentYearElement[J]=pe.getFullYear().toString():t.currentYearElement.removeAttribute(J),t.currentYearElement.disabled=!!we&&pe!==void 0&&we.getFullYear()===pe.getFullYear())}}function Ce(){var J=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],re=jl(jl({},JSON.parse(JSON.stringify(e.dataset||{}))),n),pe={};t.config.parseDate=re.parseDate,t.config.formatDate=re.formatDate,Object.defineProperty(t.config,"enable",{get:function(){return t.config._enable},set:function(vt){t.config._enable=ve(vt)}}),Object.defineProperty(t.config,"disable",{get:function(){return t.config._disable},set:function(vt){t.config._disable=ve(vt)}});var we=re.mode==="time";if(!re.dateFormat&&(re.enableTime||we)){var Ve=$l.defaultConfig.dateFormat||Wn.dateFormat;pe.dateFormat=re.noCalendar||we?"H:i"+(re.enableSeconds?":S":""):Ve+" H:i"+(re.enableSeconds?":S":"")}if(re.altInput&&(re.enableTime||we)&&!re.altFormat){var Qe=$l.defaultConfig.altFormat||Wn.altFormat;pe.altFormat=re.noCalendar||we?"h:i"+(re.enableSeconds?":S K":" K"):Qe+(" h:i"+(re.enableSeconds?":S":"")+" K")}Object.defineProperty(t.config,"minDate",{get:function(){return t.config._minDate},set:je("min")}),Object.defineProperty(t.config,"maxDate",{get:function(){return t.config._maxDate},set:je("max")});var It=function(vt){return function(il){t.config[vt==="min"?"_minTime":"_maxTime"]=t.parseDate(il,"H:i:S")}};Object.defineProperty(t.config,"minTime",{get:function(){return t.config._minTime},set:It("min")}),Object.defineProperty(t.config,"maxTime",{get:function(){return t.config._maxTime},set:It("max")}),re.mode==="time"&&(t.config.noCalendar=!0,t.config.enableTime=!0),Object.assign(t.config,pe,re);for(var ct=0;ct<J.length;ct++)t.config[J[ct]]=t.config[J[ct]]===!0||t.config[J[ct]]==="true";$a.filter(function(vt){return t.config[vt]!==void 0}).forEach(function(vt){t.config[vt]=Ia(t.config[vt]||[]).map(s)}),t.isMobile=!t.config.disableMobile&&!t.config.inline&&t.config.mode==="single"&&!t.config.disable.length&&!t.config.enable&&!t.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var ct=0;ct<t.config.plugins.length;ct++){var Lt=t.config.plugins[ct](t)||{};for(var st in Lt)$a.indexOf(st)>-1?t.config[st]=Ia(Lt[st]).map(s).concat(t.config[st]):typeof re[st]=="undefined"&&(t.config[st]=Lt[st])}re.altInputClass||(t.config.altInputClass=Ee().className+" "+t.config.altInputClass),pt("onParseConfig")}function Ee(){return t.config.wrap?e.querySelector("[data-input]"):e}function Ue(){typeof t.config.locale!="object"&&typeof $l.l10ns[t.config.locale]=="undefined"&&t.config.errorHandler(new Error("flatpickr: invalid locale "+t.config.locale)),t.l10n=jl(jl({},$l.l10ns.default),typeof t.config.locale=="object"?t.config.locale:t.config.locale!=="default"?$l.l10ns[t.config.locale]:void 0),Cn.D="("+t.l10n.weekdays.shorthand.join("|")+")",Cn.l="("+t.l10n.weekdays.longhand.join("|")+")",Cn.M="("+t.l10n.months.shorthand.join("|")+")",Cn.F="("+t.l10n.months.longhand.join("|")+")",Cn.K="("+t.l10n.amPM[0]+"|"+t.l10n.amPM[1]+"|"+t.l10n.amPM[0].toLowerCase()+"|"+t.l10n.amPM[1].toLowerCase()+")";var J=jl(jl({},n),JSON.parse(JSON.stringify(e.dataset||{})));J.time_24hr===void 0&&$l.defaultConfig.time_24hr===void 0&&(t.config.time_24hr=t.l10n.time_24hr),t.formatDate=kc(t),t.parseDate=Ra({config:t.config,l10n:t.l10n})}function Pe(J){if(typeof t.config.position=="function")return void t.config.position(t,J);if(t.calendarContainer!==void 0){pt("onPreCalendarPosition");var re=J||t._positionElement,pe=Array.prototype.reduce.call(t.calendarContainer.children,function(Am,zm){return Am+zm.offsetHeight},0),we=t.calendarContainer.offsetWidth,Ve=t.config.position.split(" "),Qe=Ve[0],It=Ve.length>1?Ve[1]:null,ct=re.getBoundingClientRect(),Lt=window.innerHeight-ct.bottom,st=Qe==="above"||Qe!=="below"&&Lt<pe&&ct.top>pe,vt=window.pageYOffset+ct.top+(st?-pe-2:re.offsetHeight+2);if(ql(t.calendarContainer,"arrowTop",!st),ql(t.calendarContainer,"arrowBottom",st),!t.config.inline){var il=window.pageXOffset+ct.left,Zr=!1,ur=!1;It==="center"?(il-=(we-ct.width)/2,Zr=!0):It==="right"&&(il-=we-ct.width,ur=!0),ql(t.calendarContainer,"arrowLeft",!Zr&&!ur),ql(t.calendarContainer,"arrowCenter",Zr),ql(t.calendarContainer,"arrowRight",ur);var to=window.document.body.offsetWidth-(window.pageXOffset+ct.right),bi=il+we>window.document.body.offsetWidth,Tm=to+we>window.document.body.offsetWidth;if(ql(t.calendarContainer,"rightMost",bi),!t.config.static)if(t.calendarContainer.style.top=vt+"px",!bi)t.calendarContainer.style.left=il+"px",t.calendarContainer.style.right="auto";else if(!Tm)t.calendarContainer.style.left="auto",t.calendarContainer.style.right=to+"px";else{var Va=et();if(Va===void 0)return;var Sm=window.document.body.offsetWidth,Im=Math.max(0,Sm/2-we/2),Rm=".flatpickr-calendar.centerMost:before",Fm=".flatpickr-calendar.centerMost:after",Dm=Va.cssRules.length,Mm="{left:"+ct.left+"px;right:auto;}";ql(t.calendarContainer,"rightMost",!1),ql(t.calendarContainer,"centerMost",!0),Va.insertRule(Rm+","+Fm+Mm,Dm),t.calendarContainer.style.left=Im+"px",t.calendarContainer.style.right="auto"}}}}function et(){for(var J=null,re=0;re<document.styleSheets.length;re++){var pe=document.styleSheets[re];if(!!pe.cssRules){try{pe.cssRules}catch(we){continue}J=pe;break}}return J!=null?J:yt()}function yt(){var J=document.createElement("style");return document.head.appendChild(J),J.sheet}function St(){t.config.noCalendar||t.isMobile||(z(),Kr(),A())}function ot(){t._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(t.close,0):t.close()}function bt(J){J.preventDefault(),J.stopPropagation();var re=function(vt){return vt.classList&&vt.classList.contains("flatpickr-day")&&!vt.classList.contains("flatpickr-disabled")&&!vt.classList.contains("notAllowed")},pe=pc(sr(J),re);if(pe!==void 0){var we=pe,Ve=t.latestSelectedDateObj=new Date(we.dateObj.getTime()),Qe=(Ve.getMonth()<t.currentMonth||Ve.getMonth()>t.currentMonth+t.config.showMonths-1)&&t.config.mode!=="range";if(t.selectedDateElem=we,t.config.mode==="single")t.selectedDates=[Ve];else if(t.config.mode==="multiple"){var It=sl(Ve);It?t.selectedDates.splice(parseInt(It),1):t.selectedDates.push(Ve)}else t.config.mode==="range"&&(t.selectedDates.length===2&&t.clear(!1,!1),t.latestSelectedDateObj=Ve,t.selectedDates.push(Ve),cr(Ve,t.selectedDates[0],!0)!==0&&t.selectedDates.sort(function(vt,il){return vt.getTime()-il.getTime()}));if(p(),Qe){var ct=t.currentYear!==Ve.getFullYear();t.currentYear=Ve.getFullYear(),t.currentMonth=Ve.getMonth(),ct&&(pt("onYearChange"),z()),pt("onMonthChange")}if(Kr(),A(),Wl(),!Qe&&t.config.mode!=="range"&&t.config.showMonths===1?R(we):t.selectedDateElem!==void 0&&t.hourElement===void 0&&t.selectedDateElem&&t.selectedDateElem.focus(),t.hourElement!==void 0&&t.hourElement!==void 0&&t.hourElement.focus(),t.config.closeOnSelect){var Lt=t.config.mode==="single"&&!t.config.enableTime,st=t.config.mode==="range"&&t.selectedDates.length===2&&!t.config.enableTime;(Lt||st)&&ot()}w()}}var qe={locale:[Ue,X],showMonths:[E,u,G],minDate:[C],maxDate:[C],positionElement:[Fe],clickOpens:[function(){t.config.clickOpens===!0?(b(t._input,"focus",t.open),b(t._input,"click",t.open)):(t._input.removeEventListener("focus",t.open),t._input.removeEventListener("click",t.open))}]};function Te(J,re){if(J!==null&&typeof J=="object"){Object.assign(t.config,J);for(var pe in J)qe[pe]!==void 0&&qe[pe].forEach(function(we){return we()})}else t.config[J]=re,qe[J]!==void 0?qe[J].forEach(function(we){return we()}):$a.indexOf(J)>-1&&(t.config[J]=Ia(re));t.redraw(),Wl(!0)}function Xe(J,re){var pe=[];if(J instanceof Array)pe=J.map(function(we){return t.parseDate(we,re)});else if(J instanceof Date||typeof J=="number")pe=[t.parseDate(J,re)];else if(typeof J=="string")switch(t.config.mode){case"single":case"time":pe=[t.parseDate(J,re)];break;case"multiple":pe=J.split(t.config.conjunction).map(function(we){return t.parseDate(we,re)});break;case"range":pe=J.split(t.l10n.rangeSeparator).map(function(we){return t.parseDate(we,re)});break;default:break}else t.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(J)));t.selectedDates=t.config.allowInvalidPreload?pe:pe.filter(function(we){return we instanceof Date&&U(we,!1)}),t.config.mode==="range"&&t.selectedDates.sort(function(we,Ve){return we.getTime()-Ve.getTime()})}function Ae(J,re,pe){if(re===void 0&&(re=!1),pe===void 0&&(pe=t.config.dateFormat),J!==0&&!J||J instanceof Array&&J.length===0)return t.clear(re);Xe(J,pe),t.latestSelectedDateObj=t.selectedDates[t.selectedDates.length-1],t.redraw(),C(void 0,re),v(),t.selectedDates.length===0&&t.clear(!1),Wl(re),re&&pt("onChange")}function ve(J){return J.slice().map(function(re){return typeof re=="string"||typeof re=="number"||re instanceof Date?t.parseDate(re,void 0,!0):re&&typeof re=="object"&&re.from&&re.to?{from:t.parseDate(re.from,void 0),to:t.parseDate(re.to,void 0)}:re}).filter(function(re){return re})}function ke(){t.selectedDates=[],t.now=t.parseDate(t.config.now)||new Date;var J=t.config.defaultDate||((t.input.nodeName==="INPUT"||t.input.nodeName==="TEXTAREA")&&t.input.placeholder&&t.input.value===t.input.placeholder?null:t.input.value);J&&Xe(J,t.config.dateFormat),t._initialDate=t.selectedDates.length>0?t.selectedDates[0]:t.config.minDate&&t.config.minDate.getTime()>t.now.getTime()?t.config.minDate:t.config.maxDate&&t.config.maxDate.getTime()<t.now.getTime()?t.config.maxDate:t.now,t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth(),t.selectedDates.length>0&&(t.latestSelectedDateObj=t.selectedDates[0]),t.config.minTime!==void 0&&(t.config.minTime=t.parseDate(t.config.minTime,"H:i")),t.config.maxTime!==void 0&&(t.config.maxTime=t.parseDate(t.config.maxTime,"H:i")),t.minDateHasTime=!!t.config.minDate&&(t.config.minDate.getHours()>0||t.config.minDate.getMinutes()>0||t.config.minDate.getSeconds()>0),t.maxDateHasTime=!!t.config.maxDate&&(t.config.maxDate.getHours()>0||t.config.maxDate.getMinutes()>0||t.config.maxDate.getSeconds()>0)}function ft(){if(t.input=Ee(),!t.input){t.config.errorHandler(new Error("Invalid input element specified"));return}t.input._type=t.input.type,t.input.type="text",t.input.classList.add("flatpickr-input"),t._input=t.input,t.config.altInput&&(t.altInput=Xt(t.input.nodeName,t.config.altInputClass),t._input=t.altInput,t.altInput.placeholder=t.input.placeholder,t.altInput.disabled=t.input.disabled,t.altInput.required=t.input.required,t.altInput.tabIndex=t.input.tabIndex,t.altInput.type="text",t.input.setAttribute("type","hidden"),!t.config.static&&t.input.parentNode&&t.input.parentNode.insertBefore(t.altInput,t.input.nextSibling)),t.config.allowInput||t._input.setAttribute("readonly","readonly"),Fe()}function Fe(){t._positionElement=t.config.positionElement||t._input}function Ne(){var J=t.config.enableTime?t.config.noCalendar?"time":"datetime-local":"date";t.mobileInput=Xt("input",t.input.className+" flatpickr-mobile"),t.mobileInput.tabIndex=1,t.mobileInput.type=J,t.mobileInput.disabled=t.input.disabled,t.mobileInput.required=t.input.required,t.mobileInput.placeholder=t.input.placeholder,t.mobileFormatStr=J==="datetime-local"?"Y-m-d\\TH:i:S":J==="date"?"Y-m-d":"H:i:S",t.selectedDates.length>0&&(t.mobileInput.defaultValue=t.mobileInput.value=t.formatDate(t.selectedDates[0],t.mobileFormatStr)),t.config.minDate&&(t.mobileInput.min=t.formatDate(t.config.minDate,"Y-m-d")),t.config.maxDate&&(t.mobileInput.max=t.formatDate(t.config.maxDate,"Y-m-d")),t.input.getAttribute("step")&&(t.mobileInput.step=String(t.input.getAttribute("step"))),t.input.type="hidden",t.altInput!==void 0&&(t.altInput.type="hidden");try{t.input.parentNode&&t.input.parentNode.insertBefore(t.mobileInput,t.input.nextSibling)}catch(re){}b(t.mobileInput,"change",function(re){t.setDate(sr(re).value,!1,t.mobileFormatStr),pt("onChange"),pt("onClose")})}function Ft(J){if(t.isOpen===!0)return t.close();t.open(J)}function pt(J,re){if(t.config!==void 0){var pe=t.config[J];if(pe!==void 0&&pe.length>0)for(var we=0;pe[we]&&we<pe.length;we++)pe[we](t.selectedDates,t.input.value,t,re);J==="onChange"&&(t.input.dispatchEvent(al("change")),t.input.dispatchEvent(al("input")))}}function al(J){var re=document.createEvent("Event");return re.initEvent(J,!0,!0),re}function sl(J){for(var re=0;re<t.selectedDates.length;re++){var pe=t.selectedDates[re];if(pe instanceof Date&&cr(pe,J)===0)return""+re}return!1}function Vt(J){return t.config.mode!=="range"||t.selectedDates.length<2?!1:cr(J,t.selectedDates[0])>=0&&cr(J,t.selectedDates[1])<=0}function Kr(){t.config.noCalendar||t.isMobile||!t.monthNav||(t.yearElements.forEach(function(J,re){var pe=new Date(t.currentYear,t.currentMonth,1);pe.setMonth(t.currentMonth+re),t.config.showMonths>1||t.config.monthSelectorType==="static"?t.monthElements[re].textContent=Bo(pe.getMonth(),t.config.shorthandCurrentMonth,t.l10n)+" ":t.monthsDropdownContainer.value=pe.getMonth().toString(),J.value=pe.getFullYear().toString()}),t._hidePrevMonthArrow=t.config.minDate!==void 0&&(t.currentYear===t.config.minDate.getFullYear()?t.currentMonth<=t.config.minDate.getMonth():t.currentYear<t.config.minDate.getFullYear()),t._hideNextMonthArrow=t.config.maxDate!==void 0&&(t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth+1>t.config.maxDate.getMonth():t.currentYear>t.config.maxDate.getFullYear()))}function Un(J){var re=J||(t.config.altInput?t.config.altFormat:t.config.dateFormat);return t.selectedDates.map(function(pe){return t.formatDate(pe,re)}).filter(function(pe,we,Ve){return t.config.mode!=="range"||t.config.enableTime||Ve.indexOf(pe)===we}).join(t.config.mode!=="range"?t.config.conjunction:t.l10n.rangeSeparator)}function Wl(J){J===void 0&&(J=!0),t.mobileInput!==void 0&&t.mobileFormatStr&&(t.mobileInput.value=t.latestSelectedDateObj!==void 0?t.formatDate(t.latestSelectedDateObj,t.mobileFormatStr):""),t.input.value=Un(t.config.dateFormat),t.altInput!==void 0&&(t.altInput.value=Un(t.config.altFormat)),J!==!1&&pt("onValueUpdate")}function Ul(J){var re=sr(J),pe=t.prevMonthNav.contains(re),we=t.nextMonthNav.contains(re);pe||we?le(pe?-1:1):t.yearElements.indexOf(re)>=0?re.select():re.classList.contains("arrowUp")?t.changeYear(t.currentYear+1):re.classList.contains("arrowDown")&&t.changeYear(t.currentYear-1)}function Gn(J){J.preventDefault();var re=J.type==="keydown",pe=sr(J),we=pe;t.amPM!==void 0&&pe===t.amPM&&(t.amPM.textContent=t.l10n.amPM[ar(t.amPM.textContent===t.l10n.amPM[0])]);var Ve=parseFloat(we.getAttribute("min")),Qe=parseFloat(we.getAttribute("max")),It=parseFloat(we.getAttribute("step")),ct=parseInt(we.value,10),Lt=J.delta||(re?J.which===38?1:-1:0),st=ct+It*Lt;if(typeof we.value!="undefined"&&we.value.length===2){var vt=we===t.hourElement,il=we===t.minuteElement;st<Ve?(st=Qe+st+ar(!vt)+(ar(vt)&&ar(!t.amPM)),il&&_(void 0,-1,t.hourElement)):st>Qe&&(st=we===t.hourElement?st-Qe-ar(!t.amPM):Ve,il&&_(void 0,1,t.hourElement)),t.amPM&&vt&&(It===1?st+ct===23:Math.abs(st-ct)>It)&&(t.amPM.textContent=t.l10n.amPM[ar(t.amPM.textContent===t.l10n.amPM[0])]),we.value=Vl(st)}}return o(),t}function Zi(e,n){for(var t=Array.prototype.slice.call(e).filter(function(s){return s instanceof HTMLElement}),l=[],o=0;o<t.length;o++){var a=t[o];try{if(a.getAttribute("data-fp-omit")!==null)continue;a._flatpickr!==void 0&&(a._flatpickr.destroy(),a._flatpickr=void 0),a._flatpickr=Vv(a,n||{}),l.push(a._flatpickr)}catch(s){console.error(s)}}return l.length===1?l[0]:l}var jl,pd,Hv,$l,vd,yd=Me(()=>{hc();dc();gc();cd();md();yc();gd();jl=function(){return jl=Object.assign||function(e){for(var n,t=1,l=arguments.length;t<l;t++){n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},jl.apply(this,arguments)},pd=function(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;for(var l=Array(e),o=0,n=0;n<t;n++)for(var a=arguments[n],s=0,u=a.length;s<u;s++,o++)l[o]=a[s];return l},Hv=300;typeof HTMLElement!="undefined"&&typeof HTMLCollection!="undefined"&&typeof NodeList!="undefined"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return Zi(this,e)},HTMLElement.prototype.flatpickr=function(e){return Zi([this],e)});$l=function(e,n){return typeof e=="string"?Zi(window.document.querySelectorAll(e),n):e instanceof Node?Zi([e],n):Zi(e,n)};$l.defaultConfig={};$l.l10ns={en:jl({},Sa),default:jl({},Sa)};$l.localize=function(e){$l.l10ns.default=jl(jl({},$l.l10ns.default),e)};$l.setDefaults=function(e){$l.defaultConfig=jl(jl({},$l.defaultConfig),e)};$l.parseDate=Ra({});$l.formatDate=kc({});$l.compareDates=cr;typeof jQuery!="undefined"&&typeof jQuery.fn!="undefined"&&(jQuery.fn.flatpickr=function(e){return Zi(this,e)});Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof e=="string"?parseInt(e,10):e))};typeof window!="undefined"&&(window.flatpickr=$l);vd=$l});var Ma,qv,jv,kd,bd=Me(()=>{ol();Ut();Ke();yd();Ma=El(pn());Fl();yi();qv=e=>{let n=e.replace(/y/g,"Y");return n=n.replace(/d/g,"D"),n=n.replace(/h/g,"H"),n=n.replace(/\//g,"A"),n=n.replace(//g,"A"),n=n.replace(//g,"A"),n=n.replace(/AM\/PM/g,"A"),n=n.replace(/AM/g,"A"),n=n.replace(/PM/g,"A"),n=n.replace(/\"/g,""),n.includes("A")&&(n=n.replace(/H/g,"h")),n},jv={cellFocus:function(e,n,t){let l=f.visibledatarow[e],o=e==0?0:f.visibledatarow[e-1],a=f.visibledatacolumn[n],s=n==0?0:f.visibledatacolumn[n-1],u=be.mergeborer(f.flowdata,e,n),h=t.ct.fa||"YYYY-MM-DD",d=mt("yyyy-MM-dd hh:mm:ss",t.v),m=qv(h),p=!1,v=!1,y=!1,k=!0,b=!1;u&&(l=u.row[1],o=u.row[0],a=u.column[1],s=u.column[0]),$(".cell-date-picker").show().css({width:a-s+1,height:l-o+1,left:s,top:o}),/[]/.test(h)&&(b=!0),/[Hhms]/.test(m)&&(p=!0),/[YMD]/.test(m)||(v=!0),/s/.test(m)&&(y=!0),/A/.test(m)&&(k=!1);let w=vd("#luckysheet-input-box",{allowInput:!1,noCalendar:v,enableSeconds:y,enableTime:p,dateFormat:m,time_24hr:k,defaultDate:d,onClose(){setTimeout(()=>{w.destroy()},0)},parseDate:(x,C)=>(0,Ma.default)(x).toDate(),formatDate:(x,C,S)=>b?(0,Ma.default)(x).format(C).replace("AM","\u4E0A\u5348").replace("PM","\u4E0B\u5348"):(0,Ma.default)(x).format(C),onChange:function(x,C){let S=zs(new Date(x));$("#luckysheet-rich-text-editor").html(C),Ji(e,n,S,{isRefresh:!1}),bc(e,n,"ct",t.ct),p||g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1])}});$("#luckysheet-input-box").click()}},kd=jv});function Rl(e,n,t,l,o){if(!kn(e,n,f.currentSheetIndex)){$("#luckysheet-functionbox-cell").blur();return}if(he()||f.allowEdit===!1||!Je.createHookFunction("cellEditBefore",f.luckysheet_select_save))return;if(ne.saveParam("mv",f.currentSheetIndex,{op:"enterEdit",range:f.luckysheet_select_save}),Ye.dataVerification!=null&&Ye.dataVerification[e+"_"+n]!=null){let O=Ye.dataVerification[e+"_"+n];if(O.type=="dropdown")Ye.dropdownListShow();else if(O.type=="checkbox")return}let a=xd(e,n,t),s=a.row,u=a.row_pre,h=a.col,d=a.col_pre,m=a.row_index,p=a.col_index;$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove();let v=$(window).height(),y=$(window).width(),k=$("#"+f.container).offset(),b=$("#luckysheet-cell-main").scrollLeft(),w=$("#luckysheet-cell-main").scrollTop();if(Oe.isPivotRange(m,p))return;let x=d+k.left+f.rowHeaderWidth-b-2;Y.freezenverticaldata!=null&&n<=Y.freezenverticaldata[1]&&(x=d+k.left+f.rowHeaderWidth-2);let C=u+k.top+f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight-w-2;Y.freezenhorizontaldata!=null&&e<=Y.freezenhorizontaldata[1]&&(C=u+k.top+f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight-2);let S={"min-width":h-d+1-8,"min-height":s-u+1-4,"max-width":y+b-d-20-f.rowHeaderWidth,"max-height":v+w-u-20-15-f.toolbarHeight-f.infobarHeight-f.calculatebarHeight-f.sheetBarHeight-f.statisticBarHeight,left:x,top:C},_={transform:"scale("+f.zoomRatio+")","transform-origin":"left top",width:100/f.zoomRatio+"%",height:100/f.zoomRatio+"%"};f.luckysheetCellUpdate=[m,p],o||$("#luckysheet-rich-text-editor").focus().select(),$("#luckysheet-input-box").removeAttr("style").css({"background-color":"rgb(255, 255, 255)",padding:"0px 2px","font-size":`${f.defaultFontSize}pt`,right:"auto","overflow-y":"auto","box-sizing":"initial",display:"flex"}),(Y.freezenverticaldata!=null||Y.freezenhorizontaldata!=null)&&$("#luckysheet-input-box").css("z-index",10002),$("#luckysheet-input-box-index").html(tt(p)+(m+1)).hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").addClass("luckysheet-wa-calculate-active");let T="",F=!1;if(t[m]!=null&&t[m][p]!=null){let O=t[m][p],M=O.ht,A="left",z="top";M=="0"?(S={"min-width":h-d+1-8,"min-height":s-u+1-4,"max-width":y*2/3,"max-height":v+w-u-20-15-f.toolbarHeight-f.infobarHeight-f.calculatebarHeight-f.sheetBarHeight-f.statisticBarHeight,left:d+k.left+f.rowHeaderWidth-b-2,top:u+k.top+f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight-w-2},f.zoomRatio<1&&(A="center"),F=!0):M=="2"&&(S={"min-width":h-d+1-8,"min-height":s-u+1-4,"max-width":h+k.left-b-8,"max-height":v+w-u-20-15-f.toolbarHeight-f.infobarHeight-f.calculatebarHeight-f.sheetBarHeight-f.statisticBarHeight,right:y-(k.left+(f.rowHeaderWidth-1)-b)-h,top:u+k.top+f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight-w-2},f.zoomRatio<1&&(A="right")),O.vt=="0"?z="center":O.vt=="2"&&(z="bottom"),_["transform-origin"]=A+" "+z,l||(_l(O)?T=xh(m,p,t):O.f!=null?T=Le(m,p,t,"f"):(T=vn(m,p,t),O.qp=="1"&&(T=T&&""+T)));let L=be.getStyleByCell(t,m,p);L=$("#luckysheet-input-box").get(0).style.cssText+L,$("#luckysheet-input-box").get(0).style.cssText=L,$("#luckysheet-input-box").get(0).style.backgroundColor=="rgba(0, 0, 0, 0)"&&($("#luckysheet-input-box").get(0).style.background="rgb(255,255,255)")}else{let O=el.getComputeMap();var R=el.checksAF(m,p,O),I=Se.getComputeMap(),P=Se.checksCF(m,p,I);P!=null&&P.cellColor!=null?$("#luckysheet-input-box").get(0).style.background=P.cellColor:R!=null&&($("#luckysheet-input-box").get(0).style.background=R[1])}if(S["min-height"]>S["max-height"]&&(S["min-height"]=S["max-height"]),S["min-width"]>S["max-width"]&&(S["min-width"]=S["max-width"]),T=g.xssDeal(T),!va(m,p,f.currentSheetIndex)&&T.length>0&&T.substr(0,63)=='<span dir="auto" class="luckysheet-formula-text-color">=</span>'?$("#luckysheet-rich-text-editor").html(""):(T=g.ltGtSignDeal(T),$("#luckysheet-rich-text-editor").html(T),o||wr($("#luckysheet-rich-text-editor")[0])),F){let O=$("#luckysheet-input-box").width();O>S["max-width"]&&(O=S["max-width"]),O<S["min-width"]&&(O=S["min-width"]);let M=S.left-O/2+(h-d)/2;M<2&&(M=2),S.left=M-2}$("#luckysheet-input-box").css(S),$("#luckysheet-rich-text-editor").css(_),t[e][n]&&t[e][n].ct&&t[e][n].ct.t=="d"&&kd.cellFocus(e,n,t[e][n]),g.rangetosheet=f.currentSheetIndex,g.createRangeHightlight(),g.rangeResizeTo=$("#luckysheet-rich-text-editor"),rl()}function wd(e,n,t){if(e==null||n==null)return;let l=t[e][n];if(l==null)return;let o=l.ht;if(l!=null&&o!="0")return;let a=xd(e,n,t),s=a.row,u=a.row_pre,h=a.col,d=a.col_pre,m=$(window).height(),p=$(window).width(),v=$("#"+f.container).offset(),y=$("#luckysheet-cell-main").scrollLeft(),k=$("#luckysheet-cell-main").scrollTop(),b={"min-width":h-d+1-8,"max-width":p*2/3,left:d+v.left+f.rowHeaderWidth-y-2},w=$("#luckysheet-input-box").width();w>b["max-width"]&&(w=b["max-width"]),w<b["min-width"]&&(w=b["min-width"]);let x=b.left-w/2+(h-d)/2;x<2&&(x=2),b.left=x-2,$("#luckysheet-input-box").css(b)}function xd(e,n,t){let l=f.visibledatarow[e],o=e-1==-1?0:f.visibledatarow[e-1],a=f.visibledatacolumn[n],s=n-1==-1?0:f.visibledatacolumn[n-1];t==null&&(t=f.flowdata);let u=be.mergeborer(t,e,n);return u&&(l=u.row[1],o=u.row[0],e=u.row[2],a=u.column[1],s=u.column[0],n=u.column[2]),{row:l,row_pre:o,row_index:e,col:a,col_pre:s,col_index:n}}var ki=Me(()=>{nn();Hl();ol();mr();Ei();bd();gr();Ml();ht();Nt();Kt();Fl();Ut();dn();Vr();mn();Ke();Qt();Nl()});var Fc={};qm(Fc,{cancelFrozen:()=>Pa,cancelRangeMerge:()=>Id,checkTheStatusOfTheSelectedCells:()=>Qi,clearCell:()=>Uv,clearRange:()=>zy,closeWebsocket:()=>v0,deleteCell:()=>Gv,deleteColumn:()=>iy,deleteDataVerification:()=>f0,deleteImage:()=>d0,deleteRange:()=>Py,deleteRangeConditionalFormat:()=>Ay,deleteRow:()=>ny,deleteRowOrColumn:()=>_c,enterEditMode:()=>Kv,exitEditMode:()=>Xv,find:()=>_d,frozenColumnRange:()=>$d,frozenFirstColumn:()=>za,frozenFirstRow:()=>Aa,frozenRowRange:()=>Cd,getAllSheets:()=>Rd,getCellValue:()=>Wv,getColumnWidth:()=>dy,getConfig:()=>a0,getDefaultColWidth:()=>gy,getDefaultRowHeight:()=>my,getImageOption:()=>m0,getLuckysheetfile:()=>c0,getRange:()=>Td,getRangeArray:()=>by,getRangeAxis:()=>vy,getRangeBoolean:()=>_y,getRangeByTxt:()=>y0,getRangeDiagonal:()=>xy,getRangeHtml:()=>ky,getRangeJson:()=>wy,getRangeValue:()=>yy,getRangeValuesWithFlatte:()=>py,getRangeWithFlatten:()=>Tc,getRowHeight:()=>hy,getScreenshot:()=>e0,getSheet:()=>i0,getSheetData:()=>o0,getTxtByRange:()=>k0,getWorkbookName:()=>l0,hideColumn:()=>sy,hideGridLines:()=>Ky,hideRow:()=>oy,hideRowOrColumn:()=>Cc,insertColumn:()=>ly,insertColumnRight:()=>ry,insertImage:()=>h0,insertRow:()=>ey,insertRowBottom:()=>ty,insertRowBottomOrColumnRight:()=>xc,insertRowOrColumn:()=>wc,matrixCalculation:()=>Ey,matrixOperation:()=>Ny,pagerInit:()=>Ic,redo:()=>n0,refresh:()=>Zy,refreshFormula:()=>b0,refreshMenuButtonFocus:()=>Rc,replace:()=>Yv,resize:()=>Qy,scroll:()=>Jy,setBothFrozen:()=>Qv,setCellFormat:()=>bc,setCellValue:()=>Ji,setColumnWidth:()=>fy,setConfig:()=>s0,setDataVerification:()=>u0,setHorizontalFrozen:()=>Zv,setRangeConditionalFormat:()=>My,setRangeConditionalFormatDefault:()=>Dy,setRangeFilter:()=>Sy,setRangeFormat:()=>Ty,setRangeMerge:()=>Iy,setRangeShow:()=>Cy,setRangeSort:()=>Ry,setRangeSortMulti:()=>Fy,setRangeValue:()=>$y,setRowHeight:()=>uy,setSheetActive:()=>qy,setSheetAdd:()=>Ly,setSheetColor:()=>Wy,setSheetCopy:()=>By,setSheetDelete:()=>Oy,setSheetHide:()=>Hy,setSheetMove:()=>Uy,setSheetName:()=>jy,setSheetOrder:()=>Gy,setSheetShow:()=>Vy,setSheetZoom:()=>Yy,setSingleRangeFormat:()=>Sd,setVerticalFrozen:()=>Jv,setWorkbookName:()=>t0,showColumn:()=>cy,showGridLines:()=>Xy,showRow:()=>ay,showRowOrColumn:()=>$c,toJson:()=>Sc,transToCellData:()=>g0,transToData:()=>p0,undo:()=>r0,updataSheet:()=>w0});function Wv(e,n,t={}){if(!B(e)||!B(n))return W.info("Arguments row or column cannot be null or undefined.","");let l=Z(f.currentSheetIndex),{type:o="v",order:a=l}=We({},t),u=f.luckysheetfile[a].data[e][n],h;if(N(u)=="object"){if(h=u[o],o=="f"&&h!=null)h=g.functionHTMLGenerate(h);else if(o=="f")h=u.v;else if(u&&u.ct){if(u.ct.fa=="yyyy-MM-dd")h=u.m;else if(u.ct.hasOwnProperty("t")&&u.ct.t==="inlineStr"){let d=u.ct.s;d&&(h=d.map(m=>m.v).join(""))}}}return h==null&&(h=null),h}function Ji(e,n,t,l={}){let o=f.flowdata[e][n],a=JSON.stringify(o);if(!B(e)||!B(n))return W.info("The row or column parameter is invalid.","");let{order:s=Z(f.currentSheetIndex),isRefresh:u=!0,success:h}=We({},l),d=f.luckysheetfile[s];if(d==null)return W.info("The order parameter is invalid.","");if(!Je.createHookFunction("cellUpdateBefore",e,n,t,u))return;let m=d.data;u&&(m=$.extend(!0,[],d.data)),m.length==0&&(m=ye.buildGridData(d));let p={bg:1,ff:1,fc:1,bl:1,it:1,fs:1,cl:1,un:1,vt:1,ht:1,mc:1,tr:1,tb:1,rt:1,qp:1};if(t==null||t.toString().length==0)g.delFunctionGroup(e,n),Ht(e,n,m,t);else if(t instanceof Object){let v={};me(m[e][n])&&(m[e][n]={});let y=m[e][n];t.f!=null&&t.v==null?(v.f=t.f,t.ct!=null&&(v.ct=t.ct),m=g.updatecell(e,n,v,!1).data):(t.ct!=null&&(v.ct=t.ct),t.f!=null&&(v.f=t.f),t.v!=null?v.v=t.v:v.v=y.v,t.m!=null&&(v.m=t.m),g.delFunctionGroup(e,n),Ht(e,n,m,v));for(let k in t){let b=t[k];k in p?be.updateFormatCell(m,k,b,e,e,n,n):y[k]=b}m[e][n]=y}else t.toString().substr(0,1)=="="||t.toString().substr(0,5)=="<span"?m=g.updatecell(e,n,t,!1).data:(g.delFunctionGroup(e,n),Ht(e,n,m,t));setTimeout(()=>{Je.createHookFunction("cellUpdated",e,n,JSON.parse(a),f.flowdata[e][n],u)},0),d.index==f.currentSheetIndex&&u?Ze(m,[{row:[e,e],column:[n,n]}]):d.data=m,h&&typeof h=="function"&&h(m)}function Uv(e,n,t={}){if(!B(e)||!B(n))return W.info("Arguments row and column cannot be null or undefined.","");let l=Z(f.currentSheetIndex),{order:o=l,success:a}=We({},t),s=$.extend(!0,[],f.luckysheetfile[o].data),u=s[e][n];N(u)=="object"?(delete u.m,delete u.v,u.f!=null&&(delete u.f,g.delFunctionGroup(e,n,o),delete u.spl)):u=null,o===l?Ze(s,[{row:[e,e],column:[n,n]}]):f.luckysheetfile[o].data=s,a&&typeof a=="function"&&a(u)}function Gv(e,n,t,l={}){if(!e||["left","up"].indexOf(e)<0)return W.info("Arguments move cannot be null or undefined and its value must be 'left' or 'up'","");if(!B(n)||!B(t))return W.info("Arguments row and column cannot be null or undefined.","");let a=Z(f.currentSheetIndex),{order:s=a,success:u}=We({},l),h="move"+e.replace(e[0],e[0].toUpperCase()),d;s&&f.luckysheetfile[s]&&(d=f.luckysheetfile[s].index),fi(h,n,n,t,t,d),u&&typeof u=="function"&&u()}function bc(e,n,t,l,o={}){if(!B(e)||!B(n))return W.info("Arguments row or column cannot be null or undefined.","");if(!t)return W.info("Arguments attr cannot be null or undefined.","");let a=Z(f.currentSheetIndex),{order:s=a,success:u}=We({},o),h=f.luckysheetfile[s];if(h==null)return W.info("The order parameter is invalid.","");let d=$.extend(!0,[],h.data);d.length==0&&(d=ye.buildGridData(h));let m=d[e][n]||{},p=$.extend(!0,{},h.config);if(t=="ct"&&(!l||!l.hasOwnProperty("fa")||!l.hasOwnProperty("t")))return new TypeError("While set attribute 'ct' to cell, the value must have property 'fa' and 't'");if(t=="bd"){p.borderInfo==null&&(p.borderInfo=[]);let v=We({rangeType:"range",borderType:"border-all",color:"#000",style:"1",range:[{column:[n,n],row:[e,e]}]},l);p.borderInfo.push(v)}else m[t]=l;d[e][n]=m,h.index==f.currentSheetIndex?(h.config=p,f.config=p,Ze(d,[{row:[e,e],column:[n,n]}])):(h.config=p,h.data=d),u&&typeof u=="function"&&u(m)}function _d(e,n={}){if(!e&&e!=0)return W.info("Search content cannot be null or empty","");let t=Z(f.currentSheetIndex),{isRegularExpression:l=!1,isWholeWord:o=!1,isCaseSensitive:a=!1,order:s=t,type:u="m"}=We({},n),h=f.luckysheetfile[s].data,d=[];for(let m=0;m<h.length;m++){let p=h[m];for(let v=0;v<p.length;v++){let y=p[v];if(!!y)if(y.row=m,y.column=v,o)a?e.toString()==y[u]&&d.push(y):y[u]&&e.toString().toLowerCase()==y[u].toLowerCase()&&d.push(y);else if(l){let k;a?k=new RegExp(D.getRegExpStr(e),"g"):k=new RegExp(D.getRegExpStr(e),"ig"),k.test(y[u])&&d.push(y)}else a?new RegExp(D.getRegExpStr(e),"g").test(y[u])&&d.push(y):new RegExp(D.getRegExpStr(e),"ig").test(y[u])&&d.push(y)}}return d}function Yv(e,n,t={}){let l=_d(e,t),o=Z(f.currentSheetIndex),{order:a=o}=We({},t),s=f.luckysheetfile[a];if(s==null)return W.info("The order parameter is invalid.","");let u=$.extend(!0,[],s.data);l.forEach(d=>{d.m=n,Ji(d.row,d.column,n,{order:a,isRefresh:!1})});let h=$.extend(!0,[],s.data);return s.data.length=0,s.data.push(...u),s.index==f.currentSheetIndex&&Ze(h,void 0,void 0,!0,!1),Be(),t.success&&typeof t.success=="function"&&t.success(l),l}function Xv(e={}){parseInt($("#luckysheet-input-box").css("top"))>0&&($("#luckysheet-formula-search-c").is(":visible")&&g.searchFunctionCell!=null?g.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),f.luckysheet_select_save=[{row:[f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[0]],column:[f.luckysheetCellUpdate[1],f.luckysheetCellUpdate[1]],row_focus:f.luckysheetCellUpdate[0],column_focus:f.luckysheetCellUpdate[1]}]),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide()),e.success&&typeof e.success=="function"&&e.success()}function Kv(e={}){if(!$("#luckysheet-conditionformat-dialog").is(":visible")){if($("#luckysheet-cell-selected").is(":visible")){let n=f.luckysheet_select_save[f.luckysheet_select_save.length-1],t=n.row_focus,l=n.column_focus;Rl(t,l,f.flowdata)}e.success&&typeof e.success=="function"&&e.success()}}function Aa(e){if(Y.saveFrozen("freezenRow",e),!e||e==Z(f.currentSheetIndex)){let n,t,l;if(Y.freezenRealFirstRowColumn){let o=0;l=f.visibledatarow[o]-2+f.columnHeaderHeight,n=[f.visibledatarow[o],o+1,0,Y.cutVolumn(f.visibledatarow,o+1),l]}else{let o=$("#luckysheet-cell-main").scrollTop();t=at(f.visibledatarow,o),t==-1&&(t=0),l=f.visibledatarow[t]-2-o+f.columnHeaderHeight,n=[f.visibledatarow[t],t+1,o,Y.cutVolumn(f.visibledatarow,t+1),l]}Y.saveFreezen(n,l,null,null),Y.freezenverticaldata!=null&&(Y.cancelFreezenVertical(),Y.createAssistCanvas(),Be()),Y.createFreezenHorizontal(n,l),Y.createAssistCanvas(),Be()}}function za(e){if(Y.saveFrozen("freezenColumn",e),!e||e==Z(f.currentSheetIndex)){let n,t,l;if(Y.freezenRealFirstRowColumn)t=0,l=f.visibledatacolumn[t]-2+f.rowHeaderWidth,n=[f.visibledatacolumn[t],t+1,0,Y.cutVolumn(f.visibledatacolumn,t+1),l];else{let o=$("#luckysheet-cell-main").scrollLeft();t=at(f.visibledatacolumn,o),t==-1&&(t=0),l=f.visibledatacolumn[t]-2-o+f.rowHeaderWidth,n=[f.visibledatacolumn[t],t+1,o,Y.cutVolumn(f.visibledatacolumn,t+1),l]}Y.saveFreezen(null,null,n,l),Y.freezenhorizontaldata!=null&&(Y.cancelFreezenHorizontal(),Y.createAssistCanvas(),Be()),Y.createFreezenVertical(n,l),Y.createAssistCanvas(),Be()}}function Cd(e,n){let t=Q().freezen;if(!e||!e.hasOwnProperty("row_focus")&&!g.iscelldata(e)){he()?alert(t.noSeletionError):W.info(t.noSeletionError,"");return}if(typeof e=="string"&&g.iscelldata(e)&&(e=g.getcellrange(e),e={row_focus:e.row[0],column_focus:e.column[0]}),Y.saveFrozen("freezenRowRange",n,e),!n||n==Z(f.currentSheetIndex)){let l=$("#luckysheet-cell-main").scrollTop(),o=at(f.visibledatarow,l),a=e.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=f.visibledatarow[o]-2-l+f.columnHeaderHeight,u=[f.visibledatarow[o],o+1,l,Y.cutVolumn(f.visibledatarow,o+1),s];Y.saveFreezen(u,s,null,null),Y.freezenverticaldata!=null&&(Y.cancelFreezenVertical(),Y.createAssistCanvas(),Be()),Y.createFreezenHorizontal(u,s),Y.createAssistCanvas(),Be()}}function $d(e,n){let t=Q().freezen,l=typeof e=="string"&&g.iscelldata(e);if(!e||!e.hasOwnProperty("column_focus")&&!l){he()?alert(t.noSeletionError):W.info(t.noSeletionError,"");return}if(l&&(e=g.getcellrange(e),e={row_focus:e.row[0],column_focus:e.column[0]}),Y.saveFrozen("freezenColumnRange",n,e),!n||n==Z(f.currentSheetIndex)){let o=$("#luckysheet-cell-main").scrollLeft(),a=at(f.visibledatacolumn,o),s=e.column_focus;s>a&&(a=s),a==-1&&(a=0);let u=f.visibledatacolumn[a]-2-o+f.rowHeaderWidth,h=[f.visibledatacolumn[a],a+1,o,Y.cutVolumn(f.visibledatacolumn,a+1),u];Y.saveFreezen(null,null,h,u),Y.freezenhorizontaldata!=null&&(Y.cancelFreezenHorizontal(),Y.createAssistCanvas(),Be()),Y.createFreezenVertical(h,u),Y.createAssistCanvas(),Be()}}function Pa(e){Y.saveFrozen("freezenCancel",e),(!e||e==Z(f.currentSheetIndex))&&(Y.freezenverticaldata!=null&&Y.cancelFreezenVertical(),Y.freezenhorizontaldata!=null&&Y.cancelFreezenHorizontal(),Y.createAssistCanvas(),Be())}function Zv(e,n={}){let t=Z(f.currentSheetIndex),{range:l,order:o=t,success:a}=We({},n);Pa(o),e?Cd(l,o):Aa(o),a&&typeof a=="function"&&a()}function Jv(e,n={}){let t=Z(f.currentSheetIndex),{range:l,order:o=t,success:a}=We({},n);Pa(o),e?$d(l,o):za(o),a&&typeof a=="function"&&a()}function Qv(e,n={}){let t=Z(f.currentSheetIndex),{range:l,order:o=t,success:a}=We({},n),s=!o||o==Z(f.currentSheetIndex),u=Q().freezen;if(Pa(o),e){Y.saveFrozen("freezenRCRange",o,l);let h=typeof l=="string"&&g.iscelldata(l);if(s){if((!l||!(l.hasOwnProperty("column_focus")&&l.hasOwnProperty("row_focus")))&&!h){he()?alert(u.noSeletionError):W.info(u.noSeletionError,"");return}h&&(l=g.getcellrange(l),l={row_focus:l.row[0],column_focus:l.column[0]});let d=$("#luckysheet-cell-main").scrollTop(),m=at(f.visibledatarow,d),p=l.row_focus;p>m&&(m=p),m==-1&&(m=0);let v=f.visibledatarow[m]-2-d+f.columnHeaderHeight,y=[f.visibledatarow[m],m+1,d,Y.cutVolumn(f.visibledatarow,m+1),v];Y.saveFreezen(y,v,null,null),Y.createFreezenHorizontal(y,v);let k=$("#luckysheet-cell-main").scrollLeft(),b=at(f.visibledatacolumn,k),w=l.column_focus;w>b&&(b=w),b==-1&&(b=0);let x=f.visibledatacolumn[b]-2-k+f.rowHeaderWidth,C=[f.visibledatacolumn[b],b+1,k,Y.cutVolumn(f.visibledatacolumn,b+1),x];Y.saveFreezen(null,null,C,x),Y.createFreezenVertical(C,x),Y.createAssistCanvas(),Be()}}else if(Y.saveFrozen("freezenRC",o),s){let h=$("#luckysheet-cell-main").scrollTop(),d=at(f.visibledatarow,h);d==-1&&(d=0);let m=f.visibledatarow[d]-2-h+f.columnHeaderHeight,p=[f.visibledatarow[d],d+1,h,Y.cutVolumn(f.visibledatarow,d+1),m];Y.saveFreezen(p,m,null,null),Y.createFreezenHorizontal(p,m);let v=$("#luckysheet-cell-main").scrollLeft(),y=at(f.visibledatacolumn,v);y==-1&&(y=0);let k=f.visibledatacolumn[y]-2-v+f.rowHeaderWidth,b=[f.visibledatacolumn[y],y+1,v,Y.cutVolumn(f.visibledatacolumn,y+1),k];Y.saveFreezen(null,null,b,k),Y.createFreezenVertical(b,k),Y.createAssistCanvas(),Be()}}function wc(e,n=0,t={}){if(!B(n))return W.info("The index parameter is invalid.","");let l=Z(f.currentSheetIndex),{number:o=1,order:a=l,success:s}=We({},t),h=Q().info;if(!B(o)){he()?alert(h.tipInputNumber):W.info(h.tipInputNumber,"");return}if(o=parseInt(o),o<1||o>100){he()?alert(h.tipInputNumberLimit):W.info(h.tipInputNumberLimit,"");return}let d;a&&f.luckysheetfile[a]&&(d=f.luckysheetfile[a].index),Tr(e,n,o,"lefttop",d),s&&typeof s=="function"&&s()}function xc(e,n=0,t={}){if(!B(n))return W.info("The index parameter is invalid.","");let l=Z(f.currentSheetIndex),{number:o=1,order:a=l,success:s}=We({},t),h=Q().info;if(!B(o)){he()?alert(h.tipInputNumber):W.info(h.tipInputNumber,"");return}if(o=parseInt(o),o<1||o>100){he()?alert(h.tipInputNumberLimit):W.info(h.tipInputNumberLimit,"");return}let d;a&&f.luckysheetfile[a]&&(d=f.luckysheetfile[a].index),Tr(e,n,o,"rightbottom",d),s&&typeof s=="function"&&s()}function ey(e=0,n={}){wc("row",e,n)}function ty(e=0,n={}){xc("row",e,n)}function ly(e=0,n={}){wc("column",e,n)}function ry(e=0,n={}){xc("column",e,n)}function _c(e,n,t,l={}){if(!B(n)||!B(t))return W.info("Please enter the index for deleting rows or columns correctly.","");let o=Z(f.currentSheetIndex),{order:a=o,success:s}=We({},l),u;a&&f.luckysheetfile[a]&&(u=f.luckysheetfile[a].index),Bn(e,n,t,u),s&&typeof s=="function"&&s()}function ny(e,n,t={}){_c("row",e,n,t)}function iy(e,n,t={}){_c("column",e,n,t)}function Cc(e,n,t,l={}){if(!B(n)||!B(t))return W.info("Please enter the index for deleting rows or columns correctly.","");let o=Z(f.currentSheetIndex),{order:a=o,saveParam:s=!0,success:u}=We({},l),h=f.luckysheetfile[a],d=e==="row"?"rowhidden":"colhidden",m=$.extend(!0,{},h.config);m[d]==null&&(m[d]={});for(let p=n;p<=t;p++)m[d][p]=0;if(f.clearjfundo){let p={};p.type=e==="row"?"showHidRows":"showHidCols",p.sheetIndex=h.index,p.config=$.extend(!0,{},h.config),p.curconfig=m,f.jfundo.length=0,f.jfredo.push(p)}f.luckysheetfile[a].config=m,s&&ne.saveParam("cg",h.index,m[d],{k:d}),a==o&&(f.config=m,Ct(f.flowdata.length,f.flowdata[0].length)),u&&typeof u=="function"&&u()}function $c(e,n,t,l={}){if(!B(n)||!B(t))return W.info("Please enter the index for deleting rows or columns correctly.","");let o=Z(f.currentSheetIndex),{order:a=o,saveParam:s=!0,success:u}=We({},l),h=f.luckysheetfile[a],d=e==="row"?"rowhidden":"colhidden",m=$.extend(!0,{},h.config);if(m[d]!=null){for(let p=n;p<=t;p++)delete m[d][p];if(f.clearjfundo){let p={};p.type=e==="row"?"showHidRows":"showHidCols",p.sheetIndex=h.index,p.config=$.extend(!0,{},h.config),p.curconfig=m,f.jfundo.length=0,f.jfredo.push(p)}f.luckysheetfile[a].config=f.config,s&&ne.saveParam("cg",h.index,m[d],{k:d}),a===o&&(f.config=m,Ct(f.flowdata.length,f.flowdata[0].length)),u&&typeof u=="function"&&u()}}function oy(e,n,t={}){Cc("row",e,n,t)}function ay(e,n,t={}){$c("row",e,n,t)}function sy(e,n,t={}){Cc("column",e,n,t)}function cy(e,n,t={}){$c("column",e,n,t)}function uy(e,n={}){if(N(e)!="object")return W.info("The rowInfo parameter is invalid.","");let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);a.rowlen==null&&(a.rowlen={});for(let s in e)if(parseInt(s)>=0){let u=e[s];u==="auto"?a.rowlen[parseInt(s)]=u:Number(u)>=0&&(a.rowlen[parseInt(s)]=Number(u))}o.config=a,ne.saveParam("cg",o.index,a.rowlen,{k:"rowlen"}),o.index==f.currentSheetIndex&&(f.config=a,Ct(f.flowdata.length,f.flowdata[0].length)),l&&typeof l=="function"&&l()}function fy(e,n={}){if(N(e)!="object")return W.info("The columnInfo parameter is invalid.","");let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);a.columnlen==null&&(a.columnlen={});for(let s in e)if(parseInt(s)>=0){let u=e[s];u==="auto"?a.columnlen[parseInt(s)]=u:Number(u)>=0&&(a.columnlen[parseInt(s)]=Number(u))}o.config=a,ne.saveParam("cg",o.index,a.columnlen,{k:"columnlen"}),o.index==f.currentSheetIndex&&(f.config=a,Ct(f.flowdata.length,f.flowdata[0].length)),l&&typeof l=="function"&&l()}function hy(e,n={}){if(N(e)!="array"||e.length==0)return W.info("The rowInfo parameter is invalid.","");let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let s=$.extend(!0,{},o.config).rowlen||{},u={};return e.forEach(h=>{if(parseInt(h)>=0){let d=s[parseInt(h)]||f.defaultrowlen;u[parseInt(h)]=d}}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function dy(e,n={}){if(N(e)!="array"||e.length==0)return W.info("The columnInfo parameter is invalid.","");let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let s=$.extend(!0,{},o.config).columnlen||{},u={};return e.forEach(h=>{if(parseInt(h)>=0){let d=s[parseInt(h)]||f.defaultcollen;u[parseInt(h)]=d}}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function my(e={}){let{order:n=Z(f.currentSheetIndex),success:t}=We({},e);return setTimeout(()=>{t&&typeof t=="function"&&t()},1),f.luckysheetfile[n].defaultRowHeight||f.defaultrowlen}function gy(e={}){let{order:n=Z(f.currentSheetIndex),success:t}=We({},e);return setTimeout(()=>{t&&typeof t=="function"&&t()},1),f.luckysheetfile[n].defaultColWidth||f.defaultcollen}function Td(){let e=JSON.parse(JSON.stringify(f.luckysheet_select_save)),n=[];for(let t=0;t<e.length;t++){let l=e[t],o={row:l.row,column:l.column};n.push(o)}return n}function Tc(e){e=e||Td();let n=[];return e.forEach(t=>{let l=t.row,o=t.column;for(let a=l[0];a<=l[1];a++)for(let s=o[0];s<=o[1];s++)n.push({r:a,c:s})}),n}function py(e){e=e||Tc();let n=[];return e.forEach(t=>{n.push(f.flowdata[t.r][t.c])}),n}function vy(){let e=[],n=JSON.parse(JSON.stringify(f.luckysheet_select_save)),t=f.currentSheetIndex;return n.forEach(l=>{let o=Mt(t,{column:l.column,row:l.row});e.push(o)}),e}function yy(e={}){let n=Z(f.currentSheetIndex),{range:t,order:l=n}=We({},e),o=f.luckysheetfile[l];if(!t||typeof t=="object")return Bt(t,o.index);if(typeof t=="string"){if(g.iscelldata(t))return Bt(g.getcellrange(t),o.index);W.info("The range is invalid, please check range parameter.","")}}function ky(e={}){let{range:n=f.luckysheet_select_save,order:t=Z(f.currentSheetIndex),success:l}=We({},e);if(n=JSON.parse(JSON.stringify(n)),N(n)=="string"){if(!g.iscelldata(n))return W.info("The range parameter is invalid.","");let y=g.getcellrange(n);n=[{row:y.row,column:y.column}]}else if(N(n)=="object"){if(n.row==null||n.column==null)return W.info("The range parameter is invalid.","");n=[{row:n.row,column:n.column}]}if(N(n)!="array")return W.info("The range parameter is invalid.","");let o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);if(a.merge!=null){let y=!1;for(let k=0;k<n.length;k++){let b=n[k].row[0],w=n[k].row[1],x=n[k].column[0],C=n[k].column[1];if(y=Dt(a,b,w,x,C),y)break}if(y)return W.info("Cannot perform this operation on partially merged cells","")}let s=$.extend(!0,[],o.luckysheet_conditionformat_save);if(n.length>1&&s.length>0){let y=!1,k=Se.getComputeMap(o.index);for(let b=0;b<n.length;b++){let w=n[b].row[0],x=n[b].row[1],C=n[b].column[0],S=n[b].column[1];for(let _=w;_<=x;_++){for(let T=C;T<=S;T++)if(Se.checksCF(_,T,k)!=null){y=!0;break}if(y)break}if(y)break}if(y)return W.info("Cannot perform this operation on multiple selection areas, please select a single area","")}if(n.length>1){let y=!0,k=n[0].row[0],b=n[0].row[1],w=!0,x=n[0].column[0],C=n[0].column[1];for(let S=1;S<n.length;S++)(n[S].row[0]!=k||n[S].row[1]!=b)&&(y=!1),(n[S].column[0]!=x||n[S].column[1]!=C)&&(w=!1);if(!y&&!w||Yr(n))return W.info("Cannot perform this operation on multiple selection areas, please select a single area","")}let u=[],h=[];for(let y=0;y<n.length;y++){let k=n[y].row[0],b=n[y].row[1],w=n[y].column[0],x=n[y].column[1];for(let C=k;C<=b;C++)if(!(a.rowhidden!=null&&a.rowhidden[C]!=null)){u.includes(C)||u.push(C);for(let S=w;S<=x;S++)a.colhidden!=null&&a.colhidden[S]!=null||h.includes(S)||h.push(S)}}let d;a.borderInfo&&a.borderInfo.length>0&&(d=Ur(o.index));let m=o.data;(m==null||m.length==0)&&(m=ye.buildGridData(o));let p="",v="";u=u.sort((y,k)=>y-k),h=h.sort((y,k)=>y-k);for(let y=0;y<u.length;y++){let k=u[y];if(!(a.rowhidden!=null&&a.rowhidden[k]!=null)){p+="<tr>";for(let b=0;b<h.length;b++){let w=h[b];if(a.colhidden!=null&&a.colhidden[w]!=null)continue;let x='<td ${span} style="${style}">';if(m[k]!=null&&m[k][w]!=null){let C="",S="";k==u[0]&&(a.columnlen==null||a.columnlen[w.toString()]==null?v+='<colgroup width="72px"></colgroup>':v+='<colgroup width="'+a.columnlen[w.toString()]+'px"></colgroup>'),w==h[0]&&(a.rowlen==null||a.rowlen[k.toString()]==null?C+="height:19px;":C+="height:"+a.rowlen[k.toString()]+"px;");let _=/^(w|W)((0?)|(0\.0+))$/,T;if(m[k][w].ct!=null&&m[k][w].ct.fa!=null&&m[k][w].ct.fa.match(_)?T=Le(k,w,m):T=Le(k,w,m,"m"),C+=be.getStyleByCell(m,k,w),N(m[k][w])=="object"&&"mc"in m[k][w])if("rs"in m[k][w].mc){if(S='rowspan="'+m[k][w].mc.rs+'" colspan="'+m[k][w].mc.cs+'"',d&&d[k+"_"+w]){let F={color:{},style:{}},R={color:{},style:{}},I={color:{},style:{}},P={color:{},style:{}};for(let A=k;A<k+m[k][w].mc.rs;A++)for(let z=w;z<w+m[k][w].mc.cs;z++){if(A==k&&d[A+"_"+z]&&d[A+"_"+z].t){let L=d[A+"_"+z].t.style,E=d[A+"_"+z].t.color;I.style[L]==null?I.style[L]=1:I.style[L]=I.style[L]+1,I.color[E]==null?I.color[E]=1:I.color[E]=I.color[E]+1}if(A==k+m[k][w].mc.rs-1&&d[A+"_"+z]&&d[A+"_"+z].b){let L=d[A+"_"+z].b.style,E=d[A+"_"+z].b.color;P.style[L]==null?P.style[L]=1:P.style[L]=P.style[L]+1,P.color[E]==null?P.color[E]=1:P.color[E]=P.color[E]+1}if(z==w&&d[A+"_"+z]&&d[A+"_"+z].l){let L=d[k+"_"+w].l.style,E=d[A+"_"+z].l.color;F.style[L]==null?F.style[L]=1:F.style[L]=F.style[L]+1,F.color[E]==null?F.color[E]=1:F.color[E]=F.color[E]+1}if(z==w+m[k][w].mc.cs-1&&d[A+"_"+z]&&d[A+"_"+z].r){let L=d[A+"_"+z].r.style,E=d[A+"_"+z].r.color;R.style[L]==null?R.style[L]=1:R.style[L]=R.style[L]+1,R.color[E]==null?R.color[E]=1:R.color[E]=R.color[E]+1}}let O=m[k][w].mc.rs,M=m[k][w].mc.cs;if(JSON.stringify(F).length>23){let A=null,z=null;for(let L in F.color)F.color[L]>=O/2&&(A=L);for(let L in F.style)F.style[L]>=O/2&&(z=L);A!=null&&z!=null&&(C+="border-left:"+wt.getHtmlBorderStyle(z,A))}if(JSON.stringify(R).length>23){let A=null,z=null;for(let L in R.color)R.color[L]>=O/2&&(A=L);for(let L in R.style)R.style[L]>=O/2&&(z=L);A!=null&&z!=null&&(C+="border-right:"+wt.getHtmlBorderStyle(z,A))}if(JSON.stringify(I).length>23){let A=null,z=null;for(let L in I.color)I.color[L]>=M/2&&(A=L);for(let L in I.style)I.style[L]>=M/2&&(z=L);A!=null&&z!=null&&(C+="border-top:"+wt.getHtmlBorderStyle(z,A))}if(JSON.stringify(P).length>23){let A=null,z=null;for(let L in P.color)P.color[L]>=M/2&&(A=L);for(let L in P.style)P.style[L]>=M/2&&(z=L);A!=null&&z!=null&&(C+="border-bottom:"+wt.getHtmlBorderStyle(z,A))}}}else continue;else if(d&&d[k+"_"+w]){if(d[k+"_"+w].l){let F=d[k+"_"+w].l.style,R=d[k+"_"+w].l.color;C+="border-left:"+wt.getHtmlBorderStyle(F,R)}if(d[k+"_"+w].r){let F=d[k+"_"+w].r.style,R=d[k+"_"+w].r.color;C+="border-right:"+wt.getHtmlBorderStyle(F,R)}if(d[k+"_"+w].b){let F=d[k+"_"+w].b.style,R=d[k+"_"+w].b.color;C+="border-bottom:"+wt.getHtmlBorderStyle(F,R)}if(d[k+"_"+w].t){let F=d[k+"_"+w].t.style,R=d[k+"_"+w].t.color;C+="border-top:"+wt.getHtmlBorderStyle(F,R)}}x=_e(x,{style:C,span:S}),T==null&&(T=Le(k,w,m)),T==null&&(T=" "),x+=T}else{let C="";if(d&&d[k+"_"+w]){if(d[k+"_"+w].l){let S=d[k+"_"+w].l.style,_=d[k+"_"+w].l.color;C+="border-left:"+wt.getHtmlBorderStyle(S,_)}if(d[k+"_"+w].r){let S=d[k+"_"+w].r.style,_=d[k+"_"+w].r.color;C+="border-right:"+wt.getHtmlBorderStyle(S,_)}if(d[k+"_"+w].b){let S=d[k+"_"+w].b.style,_=d[k+"_"+w].b.color;C+="border-bottom:"+wt.getHtmlBorderStyle(S,_)}if(d[k+"_"+w].t){let S=d[k+"_"+w].t.style,_=d[k+"_"+w].t.color;C+="border-top:"+wt.getHtmlBorderStyle(S,_)}}x+="",k==u[0]&&(a.columnlen==null||a.columnlen[w.toString()]==null?v+='<colgroup width="72px"></colgroup>':v+='<colgroup width="'+a.columnlen[w.toString()]+'px"></colgroup>'),w==h[0]&&(a.rowlen==null||a.rowlen[k.toString()]==null?C+="height:19px;":C+="height:"+a.rowlen[k.toString()]+"px;"),x=_e(x,{style:C,span:""}),x+=" "}x+="</td>",p+=x}p+="</tr>"}}return p='<table data-type="luckysheet_copy_action_table">'+v+p+"</table>",p}function by(e,n={}){if(!["oneDimensional","twoDimensional"].includes(e))return W.info("The dimensional parameter is invalid.","");let{range:l=f.luckysheet_select_save[f.luckysheet_select_save.length-1],order:o=Z(f.currentSheetIndex)}=We({},n),a=f.luckysheetfile[o];if(a==null)return W.info("The order parameter is invalid.","");if(N(l)=="string"){if(!g.iscelldata(l))return W.info("The range parameter is invalid.","");l=g.getcellrange(l)}if(N(l)!="object"||l.row==null||l.column==null)return W.info("The range parameter is invalid.","");let s=l.row[0],u=l.row[1],h=l.column[0],d=l.column[1],m=$.extend(!0,{},a.config);if(m.merge!=null&&Dt(m,s,u,h,d))return W.info("Cannot perform this operation on partially merged cells","");let p=a.data;(p==null||p.length==0)&&(p=ye.buildGridData(a));let v=[];if(e=="oneDimensional")for(let y=s;y<=u;y++)for(let k=h;k<=d;k++){let b=p[y][k];b==null||b.v==null?v.push(null):v.push(b.v)}else if(e=="twoDimensional")for(let y=s;y<=u;y++){let k=[];for(let b=h;b<=d;b++){let w=p[y][b];w==null||w.v==null?k.push(null):k.push(w.v)}v.push(k)}return v}function wy(e,n={}){let t=f.luckysheet_select_save[0],l=Z(f.currentSheetIndex),{range:o=t,order:a=l}=We({},n),s=f.luckysheetfile[a],u=s.config;if(o&&typeof o=="string"&&g.iscelldata(o)&&(o=g.getcellrange(o)),!o||o.length>1){he()?alert(locale_drag.noMulti):W.info(locale_drag.noMulti,"");return}if(u.merge!=null){let m=!1,p=o.row[0],v=o.row[1],y=o.column[0],k=o.column[1];if(m=Dt(u,p,v,y,k),m){he()?alert(Q().drag.noPartMerge):W.info(Q().drag.noPartMerge,"");return}}let h=Bt(o,s.index),d=[];if(h.length!==0){if(e)if(h.length===1){let m={};for(let p=0;p<h[0].length;p++)m[Le(0,p,h)]="";d.push(m)}else for(let m=1;m<h.length;m++){let p={};for(let v=0;v<h[0].length;v++)Le(0,v,h)==null?p[""]=Le(m,v,h):p[Le(0,v,h)]=Le(m,v,h);d.push(p)}else{let m=o.column[0];for(let p=0;p<h.length;p++){let v={};for(let y=0;y<h[0].length;y++)v[tt(y+m)]=Le(p,y,h);d.push(v)}}return d}}function xy(e,n={}){if(["normal","anti","offset"].indexOf(e)<0)return W.info("The type parameter must be included in ['normal', 'anti', 'offset']","");let l=Z(f.currentSheetIndex),o=JSON.parse(JSON.stringify(f.luckysheet_select_save)),{column:a=1,range:s=o,order:u=l}=We({},n),d=f.luckysheetfile[u].config;if(s&&typeof s=="string"&&g.iscelldata(s)&&(s=g.getcellrange(s)),!s||s.length>1){he()?alert(Q().drag.noMulti):W.info(Q().drag.noMulti,"");return}if(d.merge!=null){let y=!1,k=s[0].row[0],b=s[0].row[1],w=s[0].column[0],x=s[0].column[1];if(y=Dt(d,k,b,w,x),y){he()?alert(Q().drag.noPartMerge):W.info(Q().drag.noPartMerge,"");return}}let m=Bt(s,u),p=[];if(m.length===0)return;let v=m[0].length;switch(e){case"normal":for(let y=0;y<m.length&&!(y>=v);y++)p.push(m[y][y]);break;case"anti":for(let y=0;y<m.length&&!(y>=v);y++)p.push(m[y][v-y-1]);break;case"offset":if(a.toString()=="NaN"){he()?alert(Q().drag.inputCorrect):W.info(Q().drag.inputCorrect,"");return}if(a<0){he()?alert(Q().drag.offsetColumnLessZero):W.info(Q().drag.offsetColumnLessZero,"");return}for(let y=0;y<m.length&&!(y+a>=v);y++)p.push(m[y][y+a]);break}wt.copybyformat(new Event,JSON.stringify(p))}function _y(e={}){let n=Z(f.currentSheetIndex),t=JSON.parse(JSON.stringify(f.luckysheet_select_save)),{range:l=t,order:o=n}=We({},e),s=f.luckysheetfile[o].config;if(l&&typeof l=="string"&&g.iscelldata(l)&&(l=g.getcellrange(l)),!l||l.length>1){he()?alert(Q().drag.noMulti):W.info(Q().drag.noMulti,"");return}if(s.merge!=null){let d=!1,m=l[0].row[0],p=l[0].row[1],v=l[0].column[0],y=l[0].column[1];if(d=Dt(s,m,p,v,y),d){he()?alert(Q().drag.noPartMerge):W.info(Q().drag.noPartMerge,"");return}}let u=Bt(l,o),h=[];if(u.length!==0){for(let d=0;d<u.length;d++){let m=[];for(let p=0;p<u[0].length;p++){let v=!1,y;N(u[d][p])=="object"?y=u[d][p].v:y=u[d][p],y==null||y==""?v=!1:(y=parseInt(y),y==null||y>0?v=!0:v=!1),m.push(v)}h.push(m)}wt.copybyformat(event,JSON.stringify(h))}}function Cy(e,n={}){if(N(e)=="string"){if(!g.iscelldata(e))return W.info("The range parameter is invalid.","");let s=g.getcellrange(e);e=[{row:s.row,column:s.column}]}else if(N(e)=="object"){if(e.row==null||e.column==null)return W.info("The range parameter is invalid.","");e=[{row:e.row,column:e.column}]}if(N(e)=="array"){for(let s=0;s<e.length;s++)if(N(e[s])==="string"){if(!g.iscelldata(e[s]))return W.info("The range parameter is invalid.","");let u=g.getcellrange(e[s]);e[s]={row:u.row,column:u.column}}else if(N(e)=="object"){if(e.row==null||e.column==null)return W.info("The range parameter is invalid.","");e={row:e.row,column:e.column}}}if(N(e)!="array")return W.info("The range parameter is invalid.","");let{show:t=!0,order:l=Z(f.currentSheetIndex),success:o}=We({},n),a=f.luckysheetfile[l];if(a==null)return W.info("The order parameter is invalid.","");for(let s=0;s<e.length;s++){let u=be.mergeMoveMain(e[s].column,e[s].row,e[s]);u&&(e[s]={row:u[1],column:u[0]})}a.luckysheet_select_save=e,a.index==f.currentSheetIndex&&(f.luckysheet_select_save=e,lt(),t||($("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty())),o&&typeof o=="function"&&o()}function $y(e,n={}){let t=Z(f.currentSheetIndex),l=f.luckysheet_select_save[f.luckysheet_select_save.length-1],{range:o=l,isRefresh:a=!0,order:s=t,success:u}=We({},n);if(e==null)return W.info("The data which will be set to range cannot be null.","");if(o instanceof Array)return W.info("setRangeValue only supports a single selection.","");typeof o=="string"&&g.iscelldata(o)&&(o=g.getcellrange(o));let h=o.row[1]-o.row[0]+1,d=o.column[1]-o.column[0]+1;if(e.length!==h||e[0].length!==d)return W.info("The data to be set does not match the selection.","");let m=f.luckysheetfile[s];if(m==null)return W.info("The order parameter is invalid.","");let p=$.extend(!0,[],m.data);for(let y=0;y<h;y++)for(let k=0;k<d;k++){let b=o.row[0]+y,w=o.column[0]+k;Ji(b,w,e[y][k],{order:s,isRefresh:!1})}let v=$.extend(!0,[],m.data);m.data.length=0,m.data.push(...p),m.index==f.currentSheetIndex&&Ze(v,[{row:o.row,column:o.column}],void 0,!0,!1),a&&Be(),u&&typeof u=="function"&&u()}function Sd(e,n,t={}){let l=Z(f.currentSheetIndex),o=f.luckysheet_select_save[f.luckysheet_select_save.length-1],{range:a=o,order:s=l}=We({},t);if(!e)return W.info("Arguments attr cannot be null or undefined.",""),"error";if(a instanceof Array)return W.info("setRangeValue only supports a single selection.",""),"error";if(N(a)=="string"){if(!g.iscelldata(a))return W.info("The range parameter is invalid.",""),"error";a=g.getcellrange(a)}if(N(a)!="object"||a.row==null||a.column==null)return W.info("The range parameter is invalid.",""),"error";for(let u=a.row[0];u<=a.row[1];u++)for(let h=a.column[0];h<=a.column[1];h++)console.log("r",u),console.log("c",h),Ji(u,h,{[e]:n},{order:s,isRefresh:!1})}function Ty(e,n,t={}){let l=Z(f.currentSheetIndex),o=JSON.parse(JSON.stringify(f.luckysheet_select_save)),{range:a=o,order:s=l,success:u}=We({},t);if(N(a)=="string"){if(!g.iscelldata(a))return W.info("The range parameter is invalid.","");let p=g.getcellrange(a);a=[{row:p.row,column:p.column}]}else if(N(a)=="object"){if(a.row==null||a.column==null)return W.info("The range parameter is invalid.","");a=[{row:a.row,column:a.column}]}if(N(a)!="array")return W.info("The range parameter is invalid.","");let h=f.luckysheetfile[s],d=[];for(let p=0;p<a.length;p++)d.push(Sd(e,n,{range:a[p],order:s}));let m=$.extend(!0,[],h.data);if(d.some(p=>p==="error"))return h.data.length=0,h.data.push(...m),!1;h.data.length=0,h.data.push(...m),h.index==f.currentSheetIndex&&Ze(m,void 0,void 0,!0,!1),Be(),u&&typeof u=="function"}function Sy(e,n={}){if(!["open","close"].includes(e))return W.info("The type parameter is invalid.","");let{range:l=f.luckysheet_select_save[f.luckysheet_select_save.length-1],order:o=Z(f.currentSheetIndex),success:a}=We({},n),s=f.luckysheetfile[o];if(s==null)return W.info("The order parameter is invalid.","");if(N(l)=="string"){if(!g.iscelldata(l))return W.info("The range parameter is invalid.","");l=g.getcellrange(l)}if(N(l)!="object"||l.row==null||l.column==null)return W.info("The range parameter is invalid.","");if(setTimeout(()=>{a&&typeof a=="function"&&a()},1),e=="open")return s.filter_select=l,s.index==f.currentSheetIndex&&Dl(l,s.filter),{row:l.row,column:l.column};if(e=="close"){let u=$.extend(!0,{},s.filter_select);return s.filter_select=null,$("#luckysheet-filter-selected-sheet"+s.index).remove(),$("#luckysheet-filter-options-sheet"+s.index).remove(),{row:u.row,column:u.column}}}function Iy(e,n={}){if(["all","horizontal","vertical"].indexOf(e)<0)return W.info("The type parameter must be included in ['all', 'horizontal', 'vertical']","");let l=Z(f.currentSheetIndex),o=JSON.parse(JSON.stringify(f.luckysheet_select_save)),{range:a=o,order:s=l,success:u}=We({},n),h=f.luckysheetfile[s],d=$.extend(!0,{},h.config),m=$.extend(!0,[],h.data);if(m.length==0&&(m=$.extend(!0,[],ye.buildGridData(h))),N(a)=="string"){if(!g.iscelldata(a))return W.info("Incorrect selection format","");let v=g.getcellrange(a);a=[{row:v.row,column:v.column}]}else if(N(a)=="object"){if(!a.hasOwnProperty("row")||!a.hasOwnProperty("column"))return W.info("Incorrect selection format","");a=[{row:a.row,column:a.column}]}if(Yr(a))return W.info("Cannot merge overlapping range","");if(d.merge!=null){let v=!1;for(let y=0;y<a.length;y++){let k=a[y].row[0],b=a[y].row[1],w=a[y].column[0],x=a[y].column[1];if(v=Dt(d,k,b,w,x),v)break}if(v)return W.info("Cannot perform this operation on partially merged cells","")}else d.merge={};let p=!1;for(let v=0;v<a.length;v++){let y=a[v].row[0],k=a[v].row[1],b=a[v].column[0],w=a[v].column[1];for(let x=y;x<=k;x++){for(let C=b;C<=w;C++){let S=m[x][C];if(N(S)=="object"&&"mc"in S){p=!0;break}}if(p)break}}if(p)Id({range:a,order:s});else{for(let v=0;v<a.length;v++){let y=a[v].row[0],k=a[v].row[1],b=a[v].column[0],w=a[v].column[1];if(!(y==k&&b==w)){if(e=="all"){let x={},C=!1;for(let S=y;S<=k;S++)for(let _=b;_<=w;_++){let T=m[S][_];T!=null&&(!me(T.v)||T.f!=null)&&!C&&(x=$.extend(!0,{},T),C=!0),m[S][_]={mc:{r:y,c:b}}}m[y][b]=x,m[y][b].mc={r:y,c:b,rs:k-y+1,cs:w-b+1},d.merge[y+"_"+b]={r:y,c:b,rs:k-y+1,cs:w-b+1}}else if(e=="vertical")for(let x=b;x<=w;x++){let C={},S=!1;for(let _=y;_<=k;_++){let T=m[_][x];T!=null&&(!me(T.v)||T.f!=null)&&!S&&(C=$.extend(!0,{},T),S=!0),m[_][x]={mc:{r:y,c:x}}}m[y][x]=C,m[y][x].mc={r:y,c:x,rs:k-y+1,cs:1},d.merge[y+"_"+x]={r:y,c:x,rs:k-y+1,cs:1}}else if(e=="horizontal")for(let x=y;x<=k;x++){let C={},S=!1;for(let _=b;_<=w;_++){let T=m[x][_];T!=null&&(!me(T.v)||T.f!=null)&&!S&&(C=$.extend(!0,{},T),S=!0),m[x][_]={mc:{r:x,c:b}}}m[x][b]=C,m[x][b].mc={r:x,c:b,rs:1,cs:w-b+1},d.merge[x+"_"+b]={r:x,c:b,rs:1,cs:w-b+1}}}}s==l?(f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"mergeChange",sheetIndex:h.index,data:$.extend(!0,[],h.data),curData:m,range:a,config:$.extend(!0,{},h.config),curConfig:d})),f.clearjfundo=!1,Ze(m,a,{cfg:d}),f.clearjfundo=!0):(h.data=m,h.config=d)}u&&typeof u=="function"&&u()}function Id(e={}){let n=f.luckysheet_select_save,t=Z(f.currentSheetIndex),{range:l=n,order:o=t,success:a}=We({},e),s=f.luckysheetfile[o],u=$.extend(!0,{},s.config),h=$.extend(!0,[],s.data);if(h.length==0&&(h=$.extend(!0,[],ye.buildGridData(s))),N(l)=="string"){if(!g.iscelldata(l))return W.info("Incorrect selection format","");let d=g.getcellrange(l);l=[{row:d.row,column:d.column}]}else if(N(l)=="object"){if(!l.hasOwnProperty("row")||!l.hasOwnProperty("column"))return W.info("Incorrect selection format","");l=[{row:l.row,column:l.column}]}if(Yr(l))return W.info("Cannot merge overlapping range","");if(u.merge!=null){let d=!1;for(let m=0;m<l.length;m++){let p=l[m].row[0],v=l[m].row[1],y=l[m].column[0],k=l[m].column[1];if(d=Dt(u,p,v,y,k),d)break}if(d)return W.info("Cannot perform this operation on partially merged cells","")}for(let d=0;d<l.length;d++){let m=l[d].row[0],p=l[d].row[1],v=l[d].column[0],y=l[d].column[1];if(m==p&&v==y)continue;let k={};for(let b=m;b<=p;b++)for(let w=v;w<=y;w++){let x=h[b][w];if(x!=null&&x.mc!=null){let C=x.mc.r,S=x.mc.c;if("rs"in x.mc)delete x.mc,delete u.merge[C+"_"+S],k[C+"_"+S]=$.extend(!0,{},x);else{let _=JSON.parse(JSON.stringify(k[C+"_"+S]));delete _.v,delete _.m,delete _.ct,delete _.f,delete _.spl,h[b][w]=_}}}}o==t?(f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"mergeChange",sheetIndex:s.index,data:$.extend(!0,[],s.data),curData:h,range:l,config:$.extend(!0,{},s.config),curConfig:u})),f.clearjfundo=!1,Ze(h,l,{cfg:u}),f.clearjfundo=!0):(s.data=h,s.config=u)}function Ry(e,n={}){if(["asc","desc"].indexOf(e)<0)return W.info("The type parameter must be included in ['asc', 'desc'","");let l=Z(f.currentSheetIndex),o=f.luckysheet_select_save[0],{range:a=o,order:s=l,success:u}=We({},n),h=f.luckysheetfile[s],d=$.extend(!0,{},h.config),m=$.extend(!0,[],h.data);if(m.length==0&&(m=$.extend(!0,[],ye.buildGridData(h))),a instanceof Array&&a.length>1){W.info(Q().sort.noRangeError,"");return}a&&typeof a=="string"&&g.iscelldata(a)&&(a=g.getcellrange(a));let p=a.row[0],v=a.row[1],y=a.column[0],k=a.column[1],b=!1,w=[];for(let C=p;C<=v;C++){let S=[];for(let _=y;_<=k;_++){if(m[C][_]!=null&&m[C][_].mc!=null){b=!0;break}S.push(m[C][_])}w.push(S)}if(b){W.info(Q().sort.mergeError,"");return}w=Hr([].concat(w),0,e==="asc");for(let C=p;C<=v;C++)for(let S=y;S<=k;S++)m[C][S]=w[C-p][S-y];let x={};d.rowlen!=null&&(d=pl(m,p,v,d),x={cfg:d,RowlChange:!0}),h.index==f.currentSheetIndex?Ze(m,[{row:[p,v],column:[y,k]}],x):(h.data=m,h.config=d),u&&typeof u=="function"&&u()}function Fy(e,n,t={}){if(!n||!(n instanceof Array))return W.info("The sort parameter is invalid.","");let l=Z(f.currentSheetIndex),o=f.luckysheet_select_save[0],{range:a=o,order:s=l,success:u}=We({},t),h=f.luckysheetfile[s],d=$.extend(!0,{},h.config),m=$.extend(!0,[],h.data);if(m.length==0&&(m=$.extend(!0,[],ye.buildGridData(h))),a instanceof Array&&a.length>1){W.info(Q().sort.noRangeError,"");return}a&&typeof a=="string"&&g.iscelldata(a)&&(a=g.getcellrange(a));let p=a.row[0],v=a.row[1],y=a.column[0],k=a.column[1],b;e?b=p+1:b=p;let w=!1,x=[];for(let S=b;S<=v;S++){let _=[];for(let T=y;T<=k;T++){if(m[S][T]!=null&&m[S][T].mc!=null){w=!0;break}_.push(m[S][T])}x.push(_)}if(w){W.info(Q().sort.mergeError,"");return}n.forEach(S=>{let _=S.i;_-=y,x=Hr([].concat(x),_,S.sort==="asc")});for(let S=b;S<=v;S++)for(let _=y;_<=k;_++)m[S][_]=x[S-b][_-y];let C={};d.rowlen!=null&&(d=pl(m,b,v,d),C={cfg:d,RowlChange:!0}),h.index===f.currentSheetIndex?Ze(m,[{row:[b,v],column:[y,k]}],C):(h.data=m,h.config=d),u&&typeof u=="function"&&u()}function Dy(e,n,t={}){if(!e||!["greaterThan","lessThan","betweenness","equal","textContains","occurrenceDate","duplicateValue","top10","top10%","last10","last10%","AboveAverage","SubAverage"].includes(e))return W.info("The conditionName parameter is invalid.","");if(N(n)!="array"||n.length==0)return W.info("The conditionValue parameter is invalid.","");let{format:o={textColor:"#000000",cellColor:"#ff0000"},cellrange:a=f.luckysheet_select_save,order:s=Z(f.currentSheetIndex),success:u}=We({},t);a=JSON.parse(JSON.stringify(a));let h=f.luckysheetfile[s],d=h.data;if((d==null||d.length==0)&&(d=ye.buildGridData(h)),h==null)return W.info("Incorrect worksheet index","");let m=Q().conditionformat,p=[],v=[];if(e=="betweenness"){let S=n[0],_=n[1],T=Se.getRangeByTxt(S);if(T.length>1){Se.infoDialog(m.onlySingleCell,"");return}else if(T.length==1){let R=T[0].row[0],I=T[0].row[1],P=T[0].column[0],O=T[0].column[1];if(R==I&&P==O)S=Le(R,P,d),p.push({row:T[0].row,column:T[0].column}),v.push(S);else{Se.infoDialog(m.onlySingleCell,"");return}}else if(T.length==0)if(isNaN(S)||S==""){Se.infoDialog(m.conditionValueCanOnly,"");return}else v.push(S);let F=Se.getRangeByTxt(_);if(F.length>1){Se.infoDialog(m.onlySingleCell,"");return}else if(F.length==1){let R=F[0].row[0],I=F[0].row[1],P=F[0].column[0],O=F[0].column[1];if(R==I&&P==O)_=Le(R,P,d),p.push({row:F[0].row,column:F[0].column}),v.push(_);else{Se.infoDialog(m.onlySingleCell,"");return}}else if(F.length==0)if(isNaN(_)||_==""){Se.infoDialog(m.conditionValueCanOnly,"");return}else v.push(_)}else if(e=="greaterThan"||e=="lessThan"||e=="equal"){let S=n[0],_=Se.getRangeByTxt(S);if(_.length>1){Se.infoDialog(m.onlySingleCell,"");return}else if(_.length==1){let T=_[0].row[0],F=_[0].row[1],R=_[0].column[0],I=_[0].column[1];if(T==F&&R==I)S=Le(T,R,d),p.push({row:_[0].row,column:_[0].column}),v.push(S);else{Se.infoDialog(m.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(S)||S==""){Se.infoDialog(m.conditionValueCanOnly,"");return}else v.push(S)}else if(e=="textContains"){let S=n[0],_=Se.getRangeByTxt(S);if(_.length>1){Se.infoDialog(m.onlySingleCell,"");return}else if(_.length==1){let T=_[0].row[0],F=_[0].row[1],R=_[0].column[0],I=_[0].column[1];if(T==F&&R==I)S=Le(T,R,d),p.push({row:_[0].row,column:_[0].column}),v.push(S);else{Se.infoDialog(m.onlySingleCell,"");return}}else if(_.length==0)if(S==""){Se.infoDialog(m.conditionValueCanOnly,"");return}else v.push(S)}else if(e=="occurrenceDate"){let S=n[0],_=n[1];if(!zt(S)||!zt(_))return W.info("The conditionValue parameter is invalid.","");let T;ul(S,_)>0?T=(0,Ho.default)(_).format("YYYY/MM/DD")+"-"+(0,Ho.default)(S).format("YYYY/MM/DD"):T=(0,Ho.default)(S).format("YYYY/MM/DD")+"-"+(0,Ho.default)(_).format("YYYY/MM/DD"),v.push(T)}else if(e=="duplicateValue"){let S=n[0];if(S!="0"||S!="1")return W.info("The conditionValue parameter is invalid.","");v.push(S)}else if(e=="top10"||e=="top10%"||e=="last10"||e=="last10%"){let S=n[0];if(parseInt(S)!=S||parseInt(S)<1||parseInt(S)>1e3){Se.infoDialog(m.pleaseEnterInteger,"");return}v.push(parseInt(S))}else(e=="AboveAverage"||e=="SubAverage")&&v.push(e);if(!o.hasOwnProperty("textColor")||!o.hasOwnProperty("cellColor"))return W.info("The format parameter is invalid.","");if(N(a)=="string"?a=Se.getRangeByTxt(a):N(a)=="object"&&(a=[a]),N(a)!="array")return W.info("The cellrange parameter is invalid.","");let y={type:"default",cellrange:a,format:o,conditionName:e,conditionRange:p,conditionValue:v},k=$.extend(!0,[],f.luckysheetfile),b=Se.getHistoryRules(k),w=h.luckysheet_conditionformat_save||[];w.push(y),h.luckysheet_conditionformat_save=w;let x=$.extend(!0,[],f.luckysheetfile),C=Se.getCurrentRules(x);Se.ref(b,C),ne.allowUpdate&&ne.saveParam("all",h.index,w,{k:"luckysheet_conditionformat_save"}),u&&typeof u=="function"&&u()}function My(e,n={}){if(!e||!["dataBar","colorGradation","icons"].includes(e))return W.info("The type parameter is invalid.","");let{format:l,cellrange:o=f.luckysheet_select_save,order:a=Z(f.currentSheetIndex),success:s}=We({},n);o=JSON.parse(JSON.stringify(o));let u=f.luckysheetfile[a];if(u==null)return W.info("Incorrect worksheet index","");if(e=="dataBar"){if(l==null&&(l=["#638ec6","#ffffff"]),N(l)!="array"||l.length<1||l.length>2)return W.info("The format parameter is invalid.","")}else if(e=="colorGradation"){if(l==null&&(l=["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]),N(l)!="array"||l.length<2||l.length>3)return W.info("The format parameter is invalid.","")}else if(e=="icons"){l==null&&(l="threeWayArrowMultiColor");let k=["threeWayArrowMultiColor","threeTriangles","fourWayArrowMultiColor","fiveWayArrowMultiColor","threeWayArrowGrayColor","fourWayArrowGrayColor","fiveWayArrowGrayColor","threeColorTrafficLightRimless","threeSigns","greenRedBlackGradient","threeColorTrafficLightBordered","fourColorTrafficLight","threeSymbolsCircled","tricolorFlag","threeSymbolsnoCircle","threeStars","fiveQuadrantDiagram","fiveBoxes","grade4","grade5"];if(N(l)!="string"||!k.includes(l))return W.info("The format parameter is invalid.","");switch(l){case"threeWayArrowMultiColor":l={len:3,leftMin:0,top:0};break;case"threeTriangles":l={len:3,leftMin:0,top:1};break;case"fourWayArrowMultiColor":l={len:4,leftMin:0,top:2};break;case"fiveWayArrowMultiColor":l={len:5,leftMin:0,top:3};break;case"threeWayArrowGrayColor":l={len:3,leftMin:5,top:0};break;case"fourWayArrowGrayColor":l={len:4,leftMin:5,top:1};break;case"fiveWayArrowGrayColor":l={len:5,leftMin:5,top:2};break;case"threeColorTrafficLightRimless":l={len:3,leftMin:0,top:4};break;case"threeSigns":l={len:3,leftMin:0,top:5};break;case"greenRedBlackGradient":l={len:4,leftMin:0,top:6};break;case"threeColorTrafficLightBordered":l={len:3,leftMin:5,top:4};break;case"fourColorTrafficLight":l={len:4,leftMin:5,top:5};break;case"threeSymbolsCircled":l={len:3,leftMin:0,top:7};break;case"tricolorFlag":l={len:3,leftMin:0,top:8};break;case"threeSymbolsnoCircle":l={len:3,leftMin:5,top:7};break;case"threeStars":l={len:3,leftMin:0,top:9};break;case"fiveQuadrantDiagram":l={len:5,leftMin:0,top:10};break;case"fiveBoxes":l={len:5,leftMin:0,top:11};break;case"grade4":l={len:4,leftMin:5,top:9};break;case"grade5":l={len:5,leftMin:5,top:10};break}}if(N(o)=="string"?o=Se.getRangeByTxt(o):N(o)=="object"&&(o=[o]),N(o)!="array")return W.info("The cellrange parameter is invalid.","");let h={type:e,cellrange:o,format:l},d=$.extend(!0,[],f.luckysheetfile),m=Se.getHistoryRules(d),p=u.luckysheet_conditionformat_save||[];p.push(h),u.luckysheet_conditionformat_save=p;let v=$.extend(!0,[],f.luckysheetfile),y=Se.getCurrentRules(v);Se.ref(m,y),ne.allowUpdate&&ne.saveParam("all",u.index,p,{k:"luckysheet_conditionformat_save"}),s&&typeof s=="function"&&s()}function Ay(e,n={}){if(!B(e))return W.info("The itemIndex parameter is invalid.","");e=Number(e);let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let a=$.extend(!0,[],o.luckysheet_conditionformat_save);if(a.length==0)return W.info("This worksheet has no conditional format to delete","");if(a[e]==null)return W.info("The conditional format of the index cannot be found","");let s=a.splice(e,1),u=$.extend(!0,[],f.luckysheetfile),h=Se.getHistoryRules(u);o.luckysheet_conditionformat_save=a;let d=$.extend(!0,[],f.luckysheetfile),m=Se.getCurrentRules(d);return Se.ref(h,m),ne.allowUpdate&&ne.saveParam("all",o.index,ruleArr,{k:"luckysheet_conditionformat_save"}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),s}function zy(e={}){let{range:n=f.luckysheet_select_save,order:t=Z(f.currentSheetIndex),success:l}=We({},e);if(n=JSON.parse(JSON.stringify(n)),N(n)=="string"){if(!g.iscelldata(n))return W.info("The range parameter is invalid.","");let h=g.getcellrange(n);n=[{row:h.row,column:h.column}]}else if(N(n)=="object"){if(n.row==null||n.column==null)return W.info("The range parameter is invalid.","");n=[{row:n.row,column:n.column}]}if(N(n)!="array")return W.info("The range parameter is invalid.","");let o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config),s=!1;for(let h=0;h<n.length;h++){let d=n[h].row[0],m=n[h].row[1],p=n[h].column[0],v=n[h].column[1];if(s=Dt(a,d,m,p,v),s)break}if(s)return W.info("Cannot perform this operation on partially merged cells","");let u=$.extend(!0,[],o.data);u.length==0&&(u=$.extend(!0,[],ye.buildGridData(o)));for(let h=0;h<n.length;h++){let d=n[h].row[0],m=n[h].row[1],p=n[h].column[0],v=n[h].column[1];for(let y=d;y<=m;y++)for(let k=p;k<=v;k++){let b=u[y][k];N(b)=="object"?(delete b.m,delete b.v,b.f!=null&&(delete b.f,g.delFunctionGroup(y,k,o.index),delete b.spl),b.ct!=null&&b.ct.t=="inlineStr"&&delete b.ct):u[y][k]=null}}o.index==f.currentSheetIndex?Ze(u,n):o.data=u,l&&typeof l=="function"&&l()}function Py(e,n={}){if(!["left","up"].includes(e))return W.info("The move parameter is invalid.","");let{range:l=f.luckysheet_select_save[f.luckysheet_select_save.length-1],order:o=Z(f.currentSheetIndex),success:a}=We({},n);if(N(l)=="string"){if(!g.iscelldata(l))return W.info("The range parameter is invalid.","");let p=g.getcellrange(l);l={row:p.row,column:p.column}}if(N(l)!="object"||l.row==null||l.column==null)return W.info("The range parameter is invalid.","");if(f.luckysheetfile[o]==null)return W.info("The order parameter is invalid.","");let u=l.row[0],h=l.row[1],d=l.column[0],m=l.column[1];e=="left"?fi("moveLeft",u,h,d,m,o):e=="up"&&fi("moveUp",u,h,d,m,o),a&&typeof a=="function"&&a()}function Ny(e,n={}){if(!e||["flipUpDown","flipLeftRight","flipClockwise","flipCounterClockwise","transpose","deleteZeroByRow","deleteZeroByColumn","removeDuplicateByRow","removeDuplicateByColumn","newMatrix"].indexOf(e)<0)return W.info("The type parameter is invalid.","");let l=f.luckysheet_select_save[0],{range:o=l,success:a}=We({},n);if(o instanceof Array&&o.length>1){W.info(Q().drag.noMulti,"");return}o&&typeof o=="string"&&g.iscelldata(o)&&(o=g.getcellrange(o));let s=Bt(o),u=[];if(s.length===0)return;let h,d,m;switch(e){case"flipUpDown":for(let p=s.length-1;p>=0;p--){let v=[];for(let y=0;y<s[0].length;y++){let k="";s[p]!=null&&s[p][y]!=null&&(k=s[p][y]),v.push(k)}u.push(v)}break;case"flipLeftRight":for(let p=0;p<s.length;p++){let v=[];for(let y=s[0].length-1;y>=0;y--){let k="";s[p]!=null&&s[p][y]!=null&&(k=s[p][y]),v.push(k)}u.push(v)}break;case"flipClockwise":for(let p=0;p<s[0].length;p++){let v=[];for(let y=s.length-1;y>=0;y--){let k="";s[y]!=null&&s[y][p]!=null&&(k=s[y][p]),v.push(k)}u.push(v)}break;case"flipCounterClockwise":for(let p=s[0].length-1;p>=0;p--){let v=[];for(let y=0;y<s.length;y++){let k="";s[y]!=null&&s[y][p]!=null&&(k=s[y][p]),v.push(k)}u.push(v)}break;case"transpose":for(let p=0;p<s[0].length;p++){let v=[];for(let y=0;y<s.length;y++){let k="";s[y]!=null&&s[y][p]!=null&&(k=s[y][p]),v.push(k)}u.push(v)}break;case"deleteZeroByRow":h=s[0].length;for(let p=0;p<s.length;p++){let v=[],y=!0,k=!0;for(let w=0;w<h;w++){let x="";if(s[p]!=null&&s[p][w]!=null){if(x=s[p][w],(x.v=="0"||x.v==0)&&y)continue;y=!1}v.push(x)}let b=[];if(v.length==h)b=v;else{for(let x=v.length-1;x>=0;x--){let C="";if(v[x]!=null){if(C=v[x],(C.v=="0"||C.v==0)&&k)continue;k=!1}b.unshift(C)}let w=h-b.length;for(let x=0;x<w;x++)b.push("")}u.push(b)}break;case"deleteZeroByColumn":h=s.length,d=s[0].length;for(let p=0;p<d;p++){let v=[],y=!0,k=!0;for(let w=0;w<h;w++){let x="";if(s[w]!=null&&s[w][p]!=null){if(x=s[w][p],(x.v=="0"||x.v==0)&&y)continue;y=!1}v.push(x)}let b=[];if(v.length==h)b=v;else{for(let x=v.length-1;x>=0;x--){let C="";if(v[x]!=null){if(C=v[x],(C.v=="0"||C.v==0)&&k)continue;k=!1}b.unshift(C)}let w=h-b.length;for(let x=0;x<w;x++)b.push("")}u.push(b)}m=[];for(let p=0;p<u[0].length;p++){let v=[];for(let y=0;y<u.length;y++){let k="";u[y]!=null&&u[y][p]!=null&&(k=u[y][p]),v.push(k)}m.push(v)}break;case"removeDuplicateByRow":h=s[0].length;for(let p=0;p<s.length;p++){let v=[],y={};for(let b=0;b<h;b++){let w=null;s[p]!=null&&s[p][b]!=null&&(w=s[p][b],w.v in y||(y[w.v]=[]),y[w.v].push(w))}for(let b=0;b<h;b++){let w=null;s[p]!=null&&s[p][b]!=null&&(w=s[p][b],y[w.v].length==1&&v.push(w))}let k=h-v.length;for(let b=0;b<k;b++)v.push(null);u.push(v)}break;case"removeDuplicateByColumn":d=s[0].length,h=s.length;for(let p=0;p<d;p++){let v=[],y={};for(let b=0;b<h;b++){let w=null;s[b]!=null&&s[b][p]!=null&&(w=s[b][p],w.v in y||(y[w.v]=[]),y[w.v].push(w))}for(let b=0;b<h;b++){let w=null;s[b]!=null&&s[b][p]!=null&&(w=s[b][p],y[w.v].length==1&&v.push(w))}a1=v;let k=h-a1.length;for(let b=0;b<k;b++)a1.push(null);u.push(a1)}m=[];for(let p=0;p<u[0].length;p++){let v=[];for(let y=0;y<u.length;y++){let k=null;u[y]!=null&&u[y][p]!=null&&(k=u[y][p]),v.push(k)}m.push(v)}break;case"newMatrix":console.log("TODO");break}xe.controlHandler(u,o),a&&typeof a=="function"&&a()}function Ey(e,n,t={}){if(!e||["plus","minus","multiply","divided","power","root","log"].indexOf(e)<0)return W.info("The type parameter is invalid.","");if(!B(n))return W.info("The number parameter is invalid.","");let o=f.luckysheet_select_save[0],{range:a=o,success:s}=We({},t);if(a instanceof Array&&a.length>1){W.info(Q().drag.noMulti,"");return}a&&typeof a=="string"&&g.iscelldata(a)&&(a=g.getcellrange(a));let u=Bt(a);if(u.length==0)return;let h=[];for(let d=0;d<u.length;d++){let m=[];for(let p=0;p<u[0].length;p++){let v="";u[d]!=null&&u[d][p]!=null&&(v=u[d][p],parseInt(v)!=null&&u[d][p].ct!=null&&u[d][p].ct.t=="n"&&(e=="minus"?v.v=v.v-n:e=="multiply"?v.v=v.v*n:e=="divided"?v.v=numFormat(v.v/n,4):e=="power"?v.v=Math.pow(v.v,n):e=="root"?n==2?v.v=numFormat(Math.sqrt(v.v),4):n==3&&Math.cbrt?v.v=numFormat(Math.cbrt(v.v),4):v.v=numFormat(jfnqrt(v.v,n),4):e=="log"?v.v=numFormat(Math.log(v.v)*1e4/Math.log(Math.abs(n)),4):v.v=v.v+n,v.v==null?v.m="":v.m=v.v.toString())),m.push(v)}h.push(m)}xe.controlHandler(h,a),s&&typeof s=="function"&&s()}function Ly(e={}){let n=f.luckysheetfile.length-1,{sheetObject:t={},order:l=n,success:o}=We({},e);if(!B(l))return W.info("Parameter is not a table index","");l=Number(l);let a=ye.generateRandomSheetIndex();t.calcChain&&t.calcChain.length>0&&t.calcChain.forEach(d=>{d.index=a});let s=ye.generateRandomSheetName(f.luckysheetfile,!1);if(t.name){let d=!1;for(let m=0;m<f.luckysheetfile.length;m++)if(f.luckysheetfile[m].name==t.name){d=!0;break}d||(s=t.name)}$("#luckysheet-sheet-container-c").append(_e(Ql,{index:a,active:"",name:s,style:"",colorset:""}));let u={name:"",color:"",status:"0",order:"",index:"",celldata:[],row:f.defaultrowNum,column:f.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!1};if(u=$.extend(!0,u,t),u.index=a,u.name=s,u.order=l,l<=0){let d=f.luckysheetfile[0].index,m=$("#luckysheet-sheets-item"+d);$("#luckysheet-sheets-item"+a).insertBefore(m),f.luckysheetfile.splice(0,0,u)}else{l>f.luckysheetfile.length&&(l=f.luckysheetfile.length);let d=f.luckysheetfile[l-1].index,m=$("#luckysheet-sheets-item"+d);$("#luckysheet-sheets-item"+a).insertAfter(m),f.luckysheetfile.splice(l,0,u)}let h={};if(f.luckysheetfile.forEach((d,m,p)=>{p[m].order=m,h[d.index.toString()]=m}),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+a+'" class="luckysheet-datavisual-selection-set"></div>'),rl(!0),ne.saveParam("sha",null,$.extend(!0,{},u)),ne.saveParam("shr",null,h),f.clearjfundo){f.jfundo.length=0;let d={};d.type="addSheet",d.sheetconfig=$.extend(!0,{},u),d.index=a,d.currentSheetIndex=f.currentSheetIndex,f.jfredo.push(d)}return ye.changeSheetExec(a,!1,!0),o&&typeof o=="function"&&o(),u}function Oy(e={}){let{order:n=Z(f.currentSheetIndex),success:t}=We({},e),l=f.luckysheetfile[n];return l==null?W.info("The order parameter is invalid.",""):f.luckysheetfile.length===1?W.info(Q().sheetconfig.noMoreSheet,""):(ye.deleteSheet(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function By(e={}){let{targetOrder:n,order:t=Z(f.currentSheetIndex),success:l}=We({},e),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");if(n==null&&(n=t+1),!B(n))return W.info("The targetOrder parameter is invalid.","");let a=o.index,s=ye.generateRandomSheetIndex(),u=$.extend(!0,{},o);u.order=f.luckysheetfile.length,u.index=s,u.name=ye.generateCopySheetName(f.luckysheetfile,u.name);let h="";u.color!=null&&(h='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+u.color+';"></div>');let d=$("#luckysheet-sheets-item"+a);if(B(n)&&(d=$("#luckysheet-sheets-item"+f.luckysheetfile[n-1].index)),$("#luckysheet-sheet-container-c").append(_e(Ql,{index:u.index,active:"",name:u.name,order:u.order,style:"",colorset:h})),$("#luckysheet-sheets-item"+u.index).insertAfter(d),f.luckysheetfile.splice(n,0,u),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+s).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+s+'" class="luckysheet-datavisual-selection-set"></div>'),rl(!0),ne.saveParam("shc",s,{copyindex:a,name:u.name}),ye.changeSheetExec(s),ye.reOrderAllSheet(),f.clearjfundo)f.jfredo.push({type:"copySheet",copyindex:a,index:u.index,sheetIndex:u.index});else if(f.jfredo.length>0){let m=f.jfredo[f.jfredo.length-1];m.type=="copySheet"&&(m.index=u.index,m.sheetIndex=u.index)}return setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function Hy(e={}){let{order:n=Z(f.currentSheetIndex),success:t}=We({},e),l=f.luckysheetfile[n];return l==null?W.info("The order parameter is invalid.",""):(ye.setSheetHide(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function Vy(e={}){let{order:n=Z(f.currentSheetIndex),success:t}=We({},e),l=f.luckysheetfile[n];return l==null?W.info("The order parameter is invalid.",""):(ye.setSheetShow(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function qy(e,n={}){if(e==null||!B(e)||f.luckysheetfile[e]==null)return W.info("The order parameter is invalid.","");let t=f.luckysheetfile[e],{success:l}=We({},n);return $("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+t.index).addClass("luckysheet-sheets-item-active"),ye.changeSheet(t.index),setTimeout(()=>{l&&typeof l=="function"&&l()},1),ne.multipleRangeShow(),t}function jy(e,n={}){if(N(e)!="string"||e.toString().length==0)return W.info("The name parameter is invalid.","");let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let a=o.name;if(o.name=e,$("#luckysheet-sheets-item"+o.index+" .luckysheet-sheets-item-name").text(e),ne.saveParam("all",o.index,e,{k:"name"}),f.clearjfundo){let s={};s.type="sheetName",s.sheetIndex=o.index,s.oldtxt=a,s.txt=e,f.jfundo.length=0,f.jfredo.push(s)}l&&typeof l=="function"&&l()}function Wy(e,n={}){if(N(e)!="string"||e.toString().length==0)return W.info("The color parameter is invalid.","");let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let a=o.color;if(o.color=e,$("#luckysheet-sheets-item"+o.index).find(".luckysheet-sheets-item-color").remove(),$("#luckysheet-sheets-item"+o.index).append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e+';"></div>'),ne.saveParam("all",o.index,e,{k:"color"}),f.clearjfundo){let s={};s.type="sheetColor",s.sheetIndex=o.index,s.oldcolor=a,s.color=e,f.jfundo.length=0,f.jfredo.push(s)}l&&typeof l=="function"&&l()}function Uy(e,n={}){if(e!="left"&&e!="right"&&!B(e))return W.info("Type parameter not available","");B(e)&&(e=parseInt(e));let t=Z(f.currentSheetIndex),{order:l=t,success:o}=We({},n),a=f.luckysheetfile[l];if(a==null)return W.info("ncorrect worksheet index","");let s=a.index;if(e=="left"){if(l==0)return;let h=f.luckysheetfile[l-1].index;$("#luckysheet-sheets-item"+s).insertBefore($("#luckysheet-sheets-item"+h)),f.luckysheetfile.splice(l,1),f.luckysheetfile.splice(l-1,0,a)}else if(e=="right"){if(l==f.luckysheetfile.length-1)return;let h=f.luckysheetfile[l+1].index;$("#luckysheet-sheets-item"+s).insertAfter($("#luckysheet-sheets-item"+h)),f.luckysheetfile.splice(l,1),f.luckysheetfile.splice(l+1,0,a)}else{if(e<0&&(e=0),e>f.luckysheetfile.length-1&&(e=f.luckysheetfile.length-1),e==l)return;if(e<l){let h=f.luckysheetfile[e].index;$("#luckysheet-sheets-item"+s).insertBefore($("#luckysheet-sheets-item"+h))}else{let h=f.luckysheetfile[e].index;$("#luckysheet-sheets-item"+s).insertAfter($("#luckysheet-sheets-item"+h))}f.luckysheetfile.splice(l,1),f.luckysheetfile.splice(e,0,a)}let u={};f.luckysheetfile.forEach((h,d,m)=>{m[d].order=d,u[h.index.toString()]=d}),ne.saveParam("shr",null,u),o&&typeof o=="function"&&o()}function Gy(e,n={}){if(e==null||e.length==0)return W.info("Type orderList not available","");let t={};e.forEach(a=>{t[a.index.toString()]=a.order}),f.luckysheetfile.sort((a,s)=>{let u=t[a.index.toString()],h=t[s.index.toString()];return u!=null&&h!=null?u-h:u!=null?-1:(h!=null,1)});let l={};f.luckysheetfile.forEach((a,s,u)=>{if(u[s].order=s,l[a.index.toString()]=s,s>0){let h=u[s-1].index;$("#luckysheet-sheets-item"+a.index).insertAfter($("#luckysheet-sheets-item"+h))}}),ne.saveParam("shr",null,l);let{success:o}=We({},n);o&&typeof o=="function"&&o()}function Yy(e,n={}){if(!B(e)||e<.1||e>4)return W.info("The zoom parameter is invalid.","");let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");if(o.zoomRatio=e,ne.saveParam("all",o.index,e,{k:"zoomRatio"}),o.index==f.currentSheetIndex){f.zoomRatio=e;let a=ye.getSheetByIndex();Ie.images=a.images,Ie.allImagesShow(),Ie.init(),ir(),Ui()}l&&typeof l=="function"&&l()}function Xy(e={}){let{order:n=Z(f.currentSheetIndex),success:t}=We({},e),l=f.luckysheetfile[n];return l==null?W.info("The order parameter is invalid.",""):(l.showGridLines=!0,l.index==f.currentSheetIndex&&(f.showGridLines=!0,setTimeout(function(){Be()},1)),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function Ky(e={}){let{order:n=Z(f.currentSheetIndex),success:t}=We({},e),l=f.luckysheetfile[n];return l==null?W.info("The order parameter is invalid.",""):(l.showGridLines=!1,l.index==f.currentSheetIndex&&(f.showGridLines=!1,setTimeout(function(){Be()},1)),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function Zy(e={}){Ze();let{success:n}=We({},e);n&&typeof n=="function"&&n()}function Jy(e={}){let{scrollLeft:n,scrollTop:t,targetRow:l,targetColumn:o,success:a}=We({},e);if(n!=null){if(!B(n))return W.info("The scrollLeft parameter is invalid.","");$("#luckysheet-scrollbar-x").scrollLeft(n)}else if(o!=null){if(!B(o))return W.info("The targetColumn parameter is invalid.","");let s=f.visibledatacolumn[o],u=o<=0?0:f.visibledatacolumn[o-1];$("#luckysheet-scrollbar-x").scrollLeft(u)}if(t!=null){if(!B(t))return W.info("The scrollTop parameter is invalid.","");$("#luckysheet-scrollbar-y").scrollTop(t)}else if(l!=null){if(!B(l))return W.info("The targetRow parameter is invalid.","");let s=f.visibledatarow[l],u=l<=0?0:f.visibledatarow[l-1];$("#luckysheet-scrollbar-y").scrollTop(u)}a&&typeof a=="function"&&a()}function Qy(e={}){Ot();let{success:n}=We({},e);n&&typeof n=="function"&&n()}function e0(e={}){let{range:n=f.luckysheet_select_save[f.luckysheet_select_save.length-1]}=We({},e);if(N(n)=="string"){if(!g.iscelldata(n))return W.info("The range parameter is invalid.","");let w=g.getcellrange(n);n={row:w.row,column:w.column}}if(N(n)!="object"||n.row==null||n.column==null)return W.info("The range parameter is invalid.","");let t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1];if(Dt(f.config,t,l,o,a))return W.info("Cannot perform this operation on partially merged cells","");let u=f.visibledatarow,h=f.visibledatacolumn,d,m;t-1<0?(d=0,m=u[l]):(d=u[t-1],m=u[l]-u[t-1]);let p,v;o-1<0?(p=0,v=h[a]):(p=h[o-1],v=h[a]-h[o-1]);let y=$("<canvas>").attr({width:Math.ceil(v*f.devicePixelRatio),height:Math.ceil(m*f.devicePixelRatio)}).css({width:v,height:m});nr(p,d,v,m,1,1,null,null,y);let k=y.get(0).getContext("2d");return k.beginPath(),k.moveTo(0,0),k.lineTo(0,f.devicePixelRatio*m),k.lineWidth=f.devicePixelRatio*2,k.strokeStyle=Tl.strokeStyle,k.stroke(),k.closePath(),k.beginPath(),k.moveTo(0,0),k.lineTo(f.devicePixelRatio*v,0),k.lineWidth=f.devicePixelRatio*2,k.strokeStyle=Tl.strokeStyle,k.stroke(),k.closePath(),y.get(0).toDataURL("image/png")}function t0(e,n={}){if(e==null||e.toString().length==0)return W.info("The name parameter is invalid.","");$("#luckysheet_info_detail_input").val(e);let{success:t}=We({},n);t&&typeof t=="function"&&t()}function l0(e={}){let n="",t=$("#luckysheet_info_detail_input");if(t.length==0)return W.info("Failed to get workbook name, label loading failed!"),n;n=$.trim(t.val());let{success:l}=We({},e);return setTimeout(()=>{l&&typeof l=="function"&&l()},1),n}function r0(e={}){let n=$.extend(!0,{},f.jfredo[f.jfredo.length-1]);_n.redo(new Event("custom")),Dr();let{success:t}=We({},e);return setTimeout(()=>{t&&typeof t=="function"&&t()},1),n}function n0(e={}){let n=$.extend(!0,{},f.jfundo[f.jfundo.length-1]);_n.undo(new Event("custom")),Dr();let{success:t}=We({},e);return setTimeout(()=>{t&&typeof t=="function"&&t()},1),n}function Rd(){let e=$.extend(!0,[],f.luckysheetfile);return e.forEach((n,t,l)=>{n.data!=null&&n.data.length>0&&(n.celldata=ye.getGridData(n.data)),delete n.load,delete n.freezen}),e}function i0(e={}){let{index:n,order:t,name:l}=We({},e);return n!=null?ye.getSheetByIndex(n):t!=null?f.luckysheetfile[t]:l!=null?ye.getSheetByName(l):ye.getSheetByIndex()}function o0(e={}){let{order:n=Z(f.currentSheetIndex)}=We({},e),t=f.luckysheetfile[n];if(t==null)return W.info("The order parameter is invalid.","");let l=$.extend(!0,[],t.data);return(l==null||l.length==0)&&(l=$.extend(!0,[],ye.buildGridData(t))),l}function a0(e={}){let{order:n=Z(f.currentSheetIndex)}=We({},e),t=f.luckysheetfile[n];return t==null?W.info("The order parameter is invalid.",""):$.extend(!0,{},t.config)}function s0(e,n={}){if(N(e)!="object")return W.info("The cfg parameter is invalid.","");let{order:t=Z(f.currentSheetIndex),success:l}=We({},n),o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");o.config=e,o.index==f.currentSheetIndex&&(f.config=e,("rowhidden"in e||"colhidden"in e||"rowlen"in e||"columnlen"in e)&&Ct(f.flowdata.length,f.flowdata[0].length),setTimeout(function(){Be()},1)),l&&typeof l=="function"&&l()}function c0(){return At()}function u0(e,n={}){if(N(e)!="object")return W.info("The optionItem parameter is invalid.","");let{type:t,type2:l=null,value1:o="",value2:a="",remote:s=!1,prohibitInput:u=!1,hintShow:h=!1,hintText:d="",checked:m=!1}=We({},e),p=["dropdown","checkbox","number","number_integer","number_decimal","text_content","text_length","date","validity"],v=["bw","nb","eq","ne","gt","lt","gte","lte"],y=["include","exclude","equal"],k=["bw","nb","eq","ne","bf","nbf","af","naf"],b=["card","phone"];if(!p.includes(t))return W.info("The optionItem.type parameter is invalid.","");let w=Q().dataVerification;if(t=="dropdown"){if(o.length==0){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo1);return}}else if(t=="checkbox"){if(o.length==0||a.length==0){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo2);return}}else if(t=="number"||t=="number_integer"||t=="number_decimal"){if(!v.includes(l))return W.info("The optionItem.type2 parameter is invalid.","");if(!B(o)){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo3);return}if(l=="bw"||l=="nb"){if(!B(a)){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo3);return}if(Number(a)<Number(o)){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo4);return}}}else if(t=="text_content"){if(!y.includes(l))return W.info("The optionItem.type2 parameter is invalid.","");if(o.length==0){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo5);return}}else if(t=="text_length"){if(!v.includes(l))return W.info("The optionItem.type2 parameter is invalid.","");if(!B(o)){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo3);return}if(l=="bw"||l=="nb"){if(!B(a)){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo3);return}if(Number(a)<Number(o)){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo4);return}}}else if(t=="date"){if(!k.includes(l))return W.info("The optionItem.type2 parameter is invalid.","");if(!zt(o)){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo6);return}if(l=="bw"||l=="nb"){if(!zt(a)){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo6);return}if(ul(o,a)>0){W.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo7);return}}}else if(t=="validity"&&!b.includes(l))return W.info("The optionItem.type2 parameter is invalid.","");if(N(s)!="boolean")return W.info("The optionItem.remote parameter is invalid.","");if(N(u)!="boolean")return W.info("The optionItem.prohibitInput parameter is invalid.","");if(N(h)!="boolean")return W.info("The optionItem.hintShow parameter is invalid.","");let{range:x=f.luckysheet_select_save[f.luckysheet_select_save.length-1],order:C=Z(f.currentSheetIndex),success:S}=We({},n);if(N(x)=="string"){if(!g.iscelldata(x))return W.info("The range parameter is invalid.","");let A=g.getcellrange(x);x={row:A.row,column:A.column}}if(N(x)!="object"||x.row==null||x.column==null)return W.info("The range parameter is invalid.","");let _=f.luckysheetfile[C];if(_==null)return W.info("The order parameter is invalid.","");let T={type:t,type2:l,value1:o,value2:a,checked:m,remote:s,prohibitInput:u,hintShow:h,hintText:d},F=$.extend(!0,{},_.dataVerification),R=$.extend(!0,[],_.data);R.length==0&&(R=ye.buildGridData(_));let I=x.row[0],P=x.row[1],O=x.column[0],M=x.column[1];for(let A=I;A<=P;A++)for(let z=O;z<=M;z++)F[A+"_"+z]=T,t=="checkbox"&&(T.checked?Ht(A,z,R,T.value1):Ht(A,z,R,T.value2));if(_.index==f.currentSheetIndex){let A=$.extend(!0,{},_.dataVerification);t=="checkbox"?Ye.refOfCheckbox(A,F,f.currentSheetIndex,R,x):Ye.ref(A,F,f.currentSheetIndex)}else _.dataVerification=F,_.data=R;S&&typeof S=="function"&&S()}function f0(e={}){let{range:n=f.luckysheet_select_save[f.luckysheet_select_save.length-1],order:t=Z(f.currentSheetIndex),success:l}=We({},e);if(N(n)=="string"){if(!g.iscelldata(n))return W.info("The range parameter is invalid.","");let m=g.getcellrange(n);n={row:m.row,column:m.column}}if(N(n)!="object"||n.row==null||n.column==null)return W.info("The range parameter is invalid.","");let o=f.luckysheetfile[t];if(o==null)return W.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.dataVerification),s=n.row[0],u=n.row[1],h=n.column[0],d=n.column[1];for(let m=s;m<=u;m++)for(let p=h;p<=d;p++)delete a[m+"_"+p];if(o.index==f.currentSheetIndex){let m=$.extend(!0,{},o.dataVerification);Ye.ref(m,a,f.currentSheetIndex)}else o.dataVerification=a;l&&typeof l=="function"&&l()}function h0(e,n={}){let{order:t=Z(f.currentSheetIndex),rowIndex:l,colIndex:o,success:a}=We({},n),s=f.luckysheetfile[t];if(s==null)return W.info("The order parameter is invalid.","");if(s.index==f.currentSheetIndex){let u=f.luckysheet_select_save[f.luckysheet_select_save.length-1];l==null&&(l=u.row_focus||0),l<0&&(l=0),l>f.visibledatarow.length&&(l=f.visibledatarow.length),o==null&&(o=u.column_focus||0),o<0&&(o=0),o>f.visibledatacolumn.length&&(o=f.visibledatacolumn.length);let h=o==0?0:f.visibledatacolumn[o-1],d=l==0?0:f.visibledatarow[l-1],m=new Image;m.onload=function(){let p=m.width,v=m.height,y={src:e,left:h,top:d,originWidth:p,originHeight:v};Ie.addImgItem(y),a&&typeof a=="function"&&a()},m.src=e}else{let u=s.images||{},h=s.config,d=s.zoomRatio||1,m=s.row,p=s.visibledatarow||[];if(p.length===0){let x=0;for(let C=0;C<m;C++){let S=f.defaultrowlen;if(h.rowlen!=null&&h.rowlen[C]!=null&&(S=h.rowlen[C]),h.rowhidden!=null&&h.rowhidden[C]!=null){p.push(x);continue}x+=Math.round((S+1)*d),p.push(x)}}let v=s.column,y=s.visibledatacolumn||[];if(y.length===0){let x=0;for(let C=0;C<v;C++){let S=f.defaultcollen;if(h.columnlen!=null&&h.columnlen[C]!=null&&(S=h.columnlen[C]),h.colhidden!=null&&h.colhidden[C]!=null){y.push(x);continue}x+=Math.round((S+1)*d),y.push(x)}}l==null&&(l=0),l<0&&(l=0),l>p.length&&(l=p.length),o==null&&(o=0),o<0&&(o=0),o>y.length&&(o=y.length);let k=o==0?0:y[o-1],b=l==0?0:p[l-1],w=new Image;w.onload=function(){let x={src:e,left:k,top:b,originWidth:w.width,originHeight:w.height},C,S,_=400;x.originHeight<x.originWidth?(S=Math.round(x.originHeight*(_/x.originWidth)),C=_):(C=Math.round(x.originWidth*(_/x.originHeight)),S=_);let T=$.extend(!0,{},Ie.imgItem);T.src=x.src,T.originWidth=x.originWidth,T.originHeight=x.originHeight,T.default.width=C,T.default.height=S,T.default.left=x.left,T.default.top=x.top,T.crop.width=C,T.crop.height=S;let F=Ie.generateRandomId();u[F]=T,s.images=u,a&&typeof a=="function"&&a()},w.src=e}}function d0(e={}){let{order:n=Z(f.currentSheetIndex),idList:t="all",success:l}=We({},e),o=f.luckysheetfile[n];if(o==null)return W.info("The order parameter is invalid.","");let a=o.images;if(a==null)return W.info("The worksheet has no pictures to delete.","");if(t!="all"&&N(t)!="array")return W.info("The idList parameter is invalid.","");N(t)=="array"?t.forEach(s=>{delete a[s]}):a=null,o.images=a,o.index==f.currentSheetIndex&&(Ie.currentImgId!=null&&(t=="all"||t.includes(Ie.currentImgId))&&($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide()),Ie.images=a,Ie.allImagesShow(),Ie.init()),l&&typeof l=="function"&&l()}function m0(e={}){let{order:n=Z(f.currentSheetIndex),success:t}=We({},e),l=f.luckysheetfile[n];return l==null?W.info("The order parameter is invalid.",""):(setTimeout(function(){t&&typeof t=="function"&&t()},1),l.images)}function g0(e,n={}){let{success:t}=We({},n);return setTimeout(()=>{t&&typeof t=="function"&&t()},0),ye.getGridData(e)}function p0(e,n={}){let{success:t}=We({},n);return setTimeout(()=>{t&&typeof t=="function"&&t()},0),ye.buildGridData({celldata:e})}function Sc(){let e=f.toJsonOptions;return e.title=$("#luckysheet_info_detail_input").val(),e.data=Rd(),At().forEach((n,t)=>{n.data!=null&&(e.data[t].row=N(n.data)==="array"?n.data.length:0,e.data[t].column=N(n.data[0])==="array"?n.data[0].length:0)}),e}function v0(){ne.websocket!=null&&ne.websocket.close(1e3)}function y0(e){if(e==null)return{column:f.luckysheet_select_save[f.luckysheet_select_save.length-1].column,row:f.luckysheet_select_save[f.luckysheet_select_save.length-1].row};let n=Se.getRangeByTxt(e);return{column:n[0].column,row:n[0].row}}function k0(e=f.luckysheet_select_save){return N(e)==="object"&&(e=[e]),Se.getTxtByRange(e)}function Ic(e){let{prevPage:n,nextPage:t,total:l}=Q().button;$("#luckysheet-bottom-pager").remove(),$("#luckysheet-sheet-content").after('<div id="luckysheet-bottom-pager" style="font-size: 14px; margin-left: 10px; display: inline-block;"></div>'),$("#luckysheet-bottom-pager").sPage({page:e.pageIndex,total:e.total,selectOption:e.selectOption,pageSize:e.pageSize,showTotal:e.showTotal,showSkip:e.showSkip,showPN:e.showPN,prevPage:e.prevPage||n,nextPage:e.nextPage||t,totalTxt:e.totalTxt||l+e.total,backFun:function(o){o.pageIndex=o.page,!!Je.createHookFunction("onTogglePager",o)}})}function b0(e){g.execFunctionGroupForce(!0),Be(),setTimeout(()=>{e&&typeof e=="function"&&e()})}function w0(e={}){let{data:n,success:t}=e,l=f.luckysheetfile;for(let s=0;s<n.length;s++)for(let u=0;u<l.length;u++)l[u].index===n[s].index&&(l[u]=n[s]);let o=l[ye.getSheetIndex(f.currentSheetIndex)],a=ye.buildGridData(o);o.data=a,o.isPivotTable?(f.luckysheetcurrentisPivotTable=!0,isPivotInitial||Oe.changePivotTable(index)):(f.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),Ot(!1)),ye.mergeCalculation(o.index),ye.setSheetParam(),setTimeout(function(){ye.showSheet(),ye.restoreCache(),g.execFunctionGroupForce(de.forceCalculation),ye.restoreSheetAll(f.currentSheetIndex),Be(),t&&typeof t=="function"&&t()},1),ne.saveParam("shs",null,f.currentSheetIndex)}function Rc(e,n,t,l){if(e=e||f.flowdata,n==null&&t==null){let o=f.luckysheet_select_save[f.luckysheet_select_save.length-1];n=o.row_focus||o.row[0],t=o.column_focus||o.column[0]}be.menuButtonFocus(e,n,t),setTimeout(()=>{l&&typeof l=="function"&&l()})}function Qi(e,n){return Tc().every(({r:o,c:a})=>{let s=f.flowdata[o][a];return s==null?!1:s[e]==n})}var Ho,yi=Me(()=>{Ke();ht();Et();kt();Nl();Ut();No();ll();Li();Jt();Ut();Vr();Fl();$r();ui();dr();Kt();Yt();hi();Nt();Lr();Bi();ka();nn();Qt();ol();Wi();xl();Hl();Br();dl();mr();Nr();Zt();Wt();yn();Ca();Gi();gr();qr();Ho=El(pn());Et();ki()});function sd(e,n,t,l,o){let a=f.visibledatarow[t],s=n-1==-1?0:f.visibledatarow[n-1],u=f.visibledatacolumn[o],h=l-1==-1?0:f.visibledatacolumn[l-1];$("#"+e).css({left:h,width:u-h-1,top:s,height:a-s-1})}function lt(e=!1){if($("#luckysheet-cell-selected-boxs").show(),$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").siblings(".luckysheet-cell-selected").remove(),f.luckysheet_select_save.length>0){for(let t=0;t<f.luckysheet_select_save.length;t++){let l=f.luckysheet_select_save[t].row[0],o=f.luckysheet_select_save[t].row[1],a=f.luckysheet_select_save[t].column[0],s=f.luckysheet_select_save[t].column[1],u,h;f.luckysheet_select_save[t].row_focus==null?u=l:u=f.luckysheet_select_save[t].row_focus,f.luckysheet_select_save[t].column_focus==null?h=a:h=f.luckysheet_select_save[t].column_focus;let d=f.visibledatarow[o],m=l-1==-1?0:f.visibledatarow[l-1],p=f.visibledatacolumn[s],v=a-1==-1?0:f.visibledatacolumn[a-1],y=f.visibledatarow[u],k=u-1==-1?0:f.visibledatarow[u-1],b=f.visibledatacolumn[h],w=h-1==-1?0:f.visibledatacolumn[h-1],x=be.mergeborer(f.flowdata,u,h);x&&(y=x.row[1],k=x.row[0],b=x.column[1],w=x.column[0]),f.luckysheet_select_save[t].row=[l,o],f.luckysheet_select_save[t].column=[a,s],f.luckysheet_select_save[t].row_focus=u,f.luckysheet_select_save[t].column_focus=h,f.luckysheet_select_save[t].left=w,f.luckysheet_select_save[t].width=b-w-1,f.luckysheet_select_save[t].top=k,f.luckysheet_select_save[t].height=y-k-1,f.luckysheet_select_save[t].left_move=v,f.luckysheet_select_save[t].width_move=p-v-1,f.luckysheet_select_save[t].top_move=m,f.luckysheet_select_save[t].height_move=d-m-1,t==0?f.luckysheet_select_save.length==1?fr.mobilecheck()?$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:f.luckysheet_select_save[t].left_move,width:f.luckysheet_select_save[t].width_move,top:f.luckysheet_select_save[t].top_move,height:f.luckysheet_select_save[t].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","none").end().find(".luckysheet-cs-touchhandle").css("display","block"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:f.luckysheet_select_save[t].left_move,width:f.luckysheet_select_save[t].width_move,top:f.luckysheet_select_save[t].top_move,height:f.luckysheet_select_save[t].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","block").end().find(".luckysheet-cs-touchhandle").css("display","none"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:f.luckysheet_select_save[t].left_move,width:f.luckysheet_select_save[t].width_move,top:f.luckysheet_select_save[t].top_move,height:f.luckysheet_select_save[t].height_move,display:"block",border:"1px solid rgba(1, 136, 251, 0.15)"}).find(".luckysheet-cs-draghandle").css("display","none").end().find(".luckysheet-cs-fillhandle").css("display","none"):$("#luckysheet-cell-selected-boxs").append('<div class="luckysheet-cell-selected" style="left: '+f.luckysheet_select_save[t].left_move+"px; width: "+f.luckysheet_select_save[t].width_move+"px; top: "+f.luckysheet_select_save[t].top_move+"px; height: "+f.luckysheet_select_save[t].height_move+'px; border: 1px solid rgba(1, 136, 251, 0.15); display: block;"></div>'),t==f.luckysheet_select_save.length-1&&($("#luckysheet-cell-selected-focus").css({left:f.luckysheet_select_save[t].left,width:f.luckysheet_select_save[t].width,top:f.luckysheet_select_save[t].top,height:f.luckysheet_select_save[t].height,display:"block"}),or(f.luckysheet_select_save[t].left_move,f.luckysheet_select_save[t].top_move,f.luckysheet_select_save[t].width_move,f.luckysheet_select_save[t].height_move,[l,o],[a,s]),g.fucntionboxshow(u,h),Ye.cellFocus(u,h))}x0(f.luckysheet_select_save,e),Na(),f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]&&ah(f.luckysheet_select_save[0].row[0],f.luckysheet_select_save[0].column[0]),Rc()}f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_select_save=f.luckysheet_select_save;let n=JSON.stringify(f.luckysheet_select_save);f.luckysheet_select_save_previous==null|f.luckysheet_select_save_previous!==n&&Je.createHookFunction("rangeSelect",f.luckysheetfile[Z(f.currentSheetIndex)],f.luckysheet_select_save),f.luckysheet_select_save_previous=n}function x0(e,n=!1){let t=$.extend(!0,[],e),l={},o={};for(let u=0;u<t.length;u++){let h=t[u].row[0],d=t[u].row[1],m=t[u].column[0],p=t[u].column[1];l=Fd(l,h,d),o=Fd(o,m,p)}$("#luckysheet-rows-h-selected").empty();let a=Dd(l);for(let u=0;u<a.length;u++){let h=a[u][0],d=a[u][a[u].length-1],m=tl(d)[1],p=tl(h)[0];$("#luckysheet-rows-h-selected").append('<div class="luckysheet-rows-h-selected" style="top: '+p+"px; height: "+(m-p-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}$("#luckysheet-cols-h-selected").empty();let s=Dd(o);for(let u=0;u<s.length;u++){let h=s[u][0],d=s[u][s[u].length-1],m=Rt(d)[1],p=Rt(h)[0];$("#luckysheet-cols-h-selected").append('<div class="luckysheet-cols-h-selected" style="left: '+p+"px; width: "+(m-p-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}}function Fd(e,n,t){let l=$.extend(!0,{},e);for(let o=n;o<=t;o++)o in l||(l[o]=0);return l}function Dd(e){let n=[];for(let o in e)n.push(o);n.sort(function(o,a){return o-a});let t=[],l=[];if(n.length>1)for(let o=1;o<n.length;o++)n[o]-n[o-1]==1?(l.push(n[o-1]),o==n.length-1&&(l.push(n[o]),t.push(l))):o==1?o==n.length-1?(l.push(n[o-1]),t.push(l),t.push([n[o]])):t.push(n[0]):o==n.length-1?(l.push(n[o-1]),t.push(l),t.push([n[o]])):(l.push(n[o-1]),t.push(l),l=[]);else t.push([n[0]]);return t}function Yr(e){e==null&&(e=f.luckysheet_select_save),e=JSON.parse(JSON.stringify(e));let n=!1,t={};for(let l=0;l<e.length;l++){let o=e[l].row[0],a=e[l].row[1],s=e[l].column[0],u=e[l].column[1];for(let h=o;h<=a;h++)for(let d=s;d<=u;d++)if(h+"_"+d in t){n=!0;break}else t[h+"_"+d]=0}return n}function qn(){let e=f.visibledatacolumn,n=f.visibledatarow;f.cooperativeEdit.changeCollaborationSize.forEach(t=>{if(t.i==f.currentSheetIndex){let l=t.v.column,o=e[l[0]]-1;t.v.column[0]!==0&&(o=e[l[1]]-e[l[0]-1]-(l[1]-l[0]+1));let a=t.v.row,s=n[a[0]]-1;t.v.row[0]!==0&&(s=n[a[1]]-n[a[0]-1]-(a[1]-a[0]+1));let u=f.cooperativeEdit.merge_range,h=e[t.v.column[0]-1]-1,d=n[t.v.row[0]-1]-1;if(f.config.columnlen!==null){for(let y in f.config.columnlen)if(t.v.column[0]<=y&&y<=t.v.column[1]){f.luckysheet_cols_change_size_start[1]=y-0;break}}if(f.config.rowlen!==null){for(let y in f.config.rowlen)if(t.v.row[0]<=y&&y<=t.v.row[1]){f.luckysheet_rows_change_size_start[1]=y-0;break}}if(t.v.column[0]<=f.luckysheet_cols_change_size_start[1]&&f.luckysheet_cols_change_size_start[1]<=t.v.column[1])if(f.luckysheet_cols_change_size_start[1]==0)o=e[0]-1;else{let y=t.v.column;o=e[y[1]]-e[y[0]-1]-(y[1]-y[0]+1)}if(t.v.row[0]<=f.luckysheet_rows_change_size_start[1]&&f.luckysheet_rows_change_size_start[1]<=t.v.row[1])if(f.luckysheet_rows_change_size_start[1]==0)s=n[0]-1;else{let y=t.v.row;s=n[y[1]]-n[y[0]-1]-(y[1]-y[0]+1)}if(Object.keys(u).length>0){let y=!1;if(u.v.length>1&&(y=u.v[1][0]==null||Object.keys(u.v[1][0]).length>0),u.v[0].length>1&&(y=u.v[0][1]==null||Object.keys(u.v[0][1]).length>0),y){let k=u.column[0]<=t.v.column[0]&&u.column[1]>=t.v.column[1];if(h=e[u.column[0]-1]-1,d=n[u.row[0]-1]-1,o=e[u.column[1]]-1,s=n[u.row[1]]-1,k){if(u.column[0]!==0){let w=u.column;o=e[w[1]]-e[w[0]-1]-(w[1]-w[0]+1)}else h=0;t.v.column=u.column}if(u.row[0]<=t.v.row[0]&&u.row[1]>=t.v.row[1]){if(u.row[0]!==0){let w=u.row;s=n[w[1]]-n[w[0]-1]-(w[1]-w[0]+1)}else d=0;t.v.row=u.row}}else o=e[l[0]]-e[l[0]-1]-1,l[0]===0&&(o=e[l[0]]-1),s=n[a[0]]-n[a[0]-1]-1,a[0]===0&&(s=n[a[0]]-1)}$("#luckysheet-multipleRange-show-"+t.id).css({height:s,width:o,top:d+"px",left:h+"px"});let v=$("#luckysheet-multipleRange-show-"+t.id)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+t.id+">.username").css({bottom:v+"px"})}})}function Pt(e){if($("#luckysheet-selection-copy").empty(),e==null&&(e=f.luckysheet_selection_range),e=JSON.parse(JSON.stringify(e)),e.length>0)for(let n=0;n<e.length;n++){let t=e[n].row[0],l=e[n].row[1],o=e[n].column[0],a=e[n].column[1],s=f.visibledatarow[l],u=t-1==-1?0:f.visibledatarow[t-1],h=f.visibledatacolumn[a],d=o-1==-1?0:f.visibledatacolumn[o-1],m='<div class="luckysheet-selection-copy" style="display: block; left: '+d+"px; width: "+(h-d-1)+"px; top: "+u+"px; height: "+(s-u-1)+'px;"><div class="luckysheet-selection-copy-top luckysheet-copy"></div><div class="luckysheet-selection-copy-right luckysheet-copy"></div><div class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div></div>';$("#luckysheet-selection-copy").append(m)}}function or(e,n,t,l,o,a){let s=o[1]-o[0]+1,u=a[1]-a[0]+1,h=f.luckysheetTableContentHW[0],d=f.luckysheetTableContentHW[1],m=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),y=Q().info;if(s>=4){let k=e-25;k<0&&(k=e+5),k<m&&(k=m+10);let b=n+l/2;l>d&&(b=p+d/2),$("#luckysheet-row-count-show").css({left:k,top:b,display:"block",width:"11px"}).html("<div>"+s.toString().split("").join("</div><div>")+"</div><div>"+y.row+"</div>")}else $("#luckysheet-row-count-show").hide();if(u>=4){let k=n-25;k<0&&(k=n+5),k<p&&(k=p+10);let b=e+t/2;t>h&&(b=m+h/2),$("#luckysheet-column-count-show").css({left:b,top:k,display:"block"}).text(u+y.column)}else $("#luckysheet-column-count-show").hide()}function Na(){let e=f.luckysheet_select_save[f.luckysheet_select_save.length-1],n=e.row_focus,t=e.column_focus;f.config.merge!=null&&n+"_"+t in f.config.merge?$("#luckysheet-helpbox-cell").text(Mt(f.currentSheetIndex,{column:[t,t],row:[n,n]})):$("#luckysheet-helpbox-cell").text(Mt(f.currentSheetIndex,e))}var Zt=Me(()=>{ol();Ut();sa();Zl();xi();gr();Et();Ke();Nl();kt();yi()});var _0,Dc,Md=Me(()=>{ht();Wt();ol();Jt();ll();Nt();Ke();kt();_0={moneyFmtList:[{name:"\u4EBA\u6C11\u5E01",pos:"before",value:"\xA5"},{name:"\u7F8E\u5143",pos:"before",value:"$"},{name:"\u6B27\u5143",pos:"before",value:"\u20AC"},{name:"\u82F1\u9551",pos:"before",value:"\uFFE1"},{name:"\u6E2F\u5143",pos:"before",value:"$"},{name:"\u65E5\u5143",pos:"before",value:"\uFFE5"},{name:"\u963F\u5C14\u5DF4\u5C3C\u4E9A\u5217\u514B",pos:"before",value:"Lek"},{name:"\u963F\u5C14\u53CA\u5229\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u963F\u5BCC\u6C57\u5C3C",pos:"after",value:"Af"},{name:"\u963F\u6839\u5EF7\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u963F\u62C9\u4F2F\u8054\u5408\u914B\u957F\u56FD\u8FEA\u62C9\u59C6",pos:"before",value:"dh"},{name:"\u963F\u9C81\u5DF4\u5F17\u7F57\u6797",pos:"before",value:"Afl"},{name:"\u963F\u66FC\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u963F\u585E\u62DC\u7586\u9A6C\u7EB3\u7279",pos:"before",value:"?"},{name:"\u57C3\u53CA\u9551",pos:"before",value:"\uFFE1"},{name:"\u57C3\u585E\u4FC4\u6BD4\u4E9A\u6BD4\u5C14",pos:"before",value:"Birr"},{name:"\u5B89\u54E5\u62C9\u5BBD\u624E",pos:"before",value:"Kz"},{name:"\u6FB3\u5927\u5229\u4E9A\u5143",pos:"before",value:"$"},{name:"\u6FB3\u95E8\u5143",pos:"before",value:"MOP"},{name:"\u5DF4\u5DF4\u591A\u65AF\u5143",pos:"before",value:"$"},{name:"\u5DF4\u5E03\u4E9A\u65B0\u51E0\u5185\u4E9A\u57FA\u90A3",pos:"before",value:"PGK"},{name:"\u5DF4\u54C8\u9A6C\u5143",pos:"before",value:"$"},{name:"\u5DF4\u57FA\u65AF\u5766\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u5DF4\u62C9\u572D\u74DC\u62C9\u5C3C",pos:"after",value:"Gs"},{name:"\u5DF4\u6797\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u5DF4\u62FF\u9A6C\u5DF4\u6CE2\u4E9A",pos:"before",value:"B/"},{name:"\u5DF4\u897F\u91CC\u4E9A\u4F0A",pos:"before",value:"R$"},{name:"\u767D\u4FC4\u7F57\u65AF\u5362\u5E03",pos:"after",value:"\u0440"},{name:"\u767E\u6155\u5927\u5143",pos:"before",value:"$"},{name:"\u4FDD\u52A0\u5229\u4E9A\u5217\u5F17",pos:"before",value:"lev"},{name:"\u51B0\u5C9B\u514B\u6717",pos:"before",value:"kr"},{name:"\u6CE2\u9ED1\u53EF\u5151\u6362\u9A6C\u514B",pos:"before",value:"KM"},{name:"\u6CE2\u5170\u5179\u7F57\u63D0",pos:"after",value:"z?"},{name:"\u73BB\u5229\u7EF4\u4E9A\u8BFA",pos:"before",value:"Bs"},{name:"\u4F2F\u5229\u5179\u5143",pos:"before",value:"$"},{name:"\u535A\u8328\u74E6\u7EB3\u666E\u62C9",pos:"before",value:"P"},{name:"\u4E0D\u4E39\u52AA\u624E\u59C6",pos:"before",value:"Nu"},{name:"\u5E03\u9686\u8FEA\u6CD5\u90CE",pos:"before",value:"FBu"},{name:"\u671D\u9C9C\u5706",pos:"before",value:"?KP"},{name:"\u4E39\u9EA6\u514B\u6717",pos:"after",value:"kr"},{name:"\u4E1C\u52A0\u52D2\u6BD4\u5143",pos:"before",value:"$"},{name:"\u591A\u7C73\u5C3C\u52A0\u6BD4\u7D22",pos:"before",value:"RD$"},{name:"\u4FC4\u56FD\u5362\u5E03",pos:"after",value:"?"},{name:"\u5384\u7ACB\u7279\u91CC\u4E9A\u7EB3\u514B\u6CD5",pos:"before",value:"Nfk"},{name:"\u975E\u6D32\u91D1\u878D\u5171\u540C\u4F53\u6CD5\u90CE",pos:"before",value:"CFA"},{name:"\u83F2\u5F8B\u5BBE\u6BD4\u7D22",pos:"before",value:"?"},{name:"\u6590\u6D4E\u5143",pos:"before",value:"$"},{name:"\u4F5B\u5F97\u89D2\u57C3\u65AF\u5E93\u591A",pos:"before",value:"CVE"},{name:"\u798F\u514B\u5170\u7FA4\u5C9B\u9551",pos:"before",value:"\uFFE1"},{name:"\u5188\u6BD4\u4E9A\u8FBE\u62C9\u897F",pos:"before",value:"GMD"},{name:"\u521A\u679C\u6CD5\u90CE",pos:"before",value:"FrCD"},{name:"\u54E5\u4F26\u6BD4\u4E9A\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u54E5\u65AF\u8FBE\u9ECE\u52A0\u79D1\u6717",pos:"before",value:"?"},{name:"\u53E4\u5DF4\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u53E4\u5DF4\u53EF\u5151\u6362\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u572D\u4E9A\u90A3\u5143",pos:"before",value:"$"},{name:"\u54C8\u8428\u514B\u65AF\u5766\u575A\u6208",pos:"before",value:"?"},{name:"\u6D77\u5730\u53E4\u5FB7",pos:"before",value:"HTG"},{name:"\u97E9\u5143",pos:"before",value:"?"},{name:"\u8377\u5C5E\u5B89\u7684\u5217\u65AF\u76FE",pos:"before",value:"NAf."},{name:"\u6D2A\u90FD\u62C9\u65AF\u62C9\u4F26\u76AE\u62C9",pos:"before",value:"L"},{name:"\u5409\u5E03\u63D0\u6CD5\u90CE",pos:"before",value:"Fdj"},{name:"\u5409\u5C14\u5409\u65AF\u65AF\u5766\u7D22\u59C6",pos:"before",value:"KGS"},{name:"\u51E0\u5185\u4E9A\u6CD5\u90CE",pos:"before",value:"FG"},{name:"\u52A0\u62FF\u5927\u5143",pos:"before",value:"$"},{name:"\u52A0\u7EB3\u585E\u5730",pos:"before",value:"GHS"},{name:"\u67EC\u57D4\u5BE8\u745E\u5C14",pos:"before",value:"Riel"},{name:"\u6377\u514B\u514B\u6717",pos:"after",value:"K?"},{name:"\u6D25\u5DF4\u5E03\u97E6\u5143",pos:"before",value:"$"},{name:"\u5361\u5854\u5C14\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u5F00\u66FC\u7FA4\u5C9B\u5143",pos:"before",value:"$"},{name:"\u79D1\u6469\u7F57\u6CD5\u90CE",pos:"before",value:"CF"},{name:"\u79D1\u5A01\u7279\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u514B\u7F57\u5730\u4E9A\u5E93\u7EB3",pos:"before",value:"kn"},{name:"\u80AF\u5C3C\u4E9A\u5148\u4EE4",pos:"before",value:"Ksh"},{name:"\u83B1\u7D22\u6258\u6D1B\u8482",pos:"before",value:"LSL"},{name:"\u8001\u631D\u57FA\u666E",pos:"before",value:"?"},{name:"\u9ECE\u5DF4\u5AE9\u9551",pos:"before",value:"L\uFFE1"},{name:"\u7ACB\u9676\u5B9B\u7ACB\u7279",pos:"before",value:"Lt"},{name:"\u5229\u6BD4\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u5229\u6BD4\u4E9A\u5143",pos:"before",value:"$"},{name:"\u5362\u65FA\u8FBE\u6CD5\u90CE",pos:"before",value:"RF"},{name:"\u7F57\u9A6C\u5C3C\u4E9A\u5217\u4F0A",pos:"before",value:"RON"},{name:"\u9A6C\u8FBE\u52A0\u65AF\u52A0\u963F\u91CC\u4E9A\u91CC",pos:"before",value:"Ar"},{name:"\u9A6C\u5C14\u4EE3\u592B\u62C9\u83F2\u4E9A",pos:"before",value:"Rf"},{name:"\u9A6C\u62C9\u7EF4\u514B\u74E6\u67E5",pos:"before",value:"MWK"},{name:"\u9A6C\u6765\u897F\u4E9A\u6797\u5409\u7279",pos:"before",value:"RM"},{name:"\u9A6C\u5176\u987F\u6234\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u6BDB\u91CC\u6C42\u65AF\u5362\u6BD4",pos:"before",value:"MURs"},{name:"\u6BDB\u91CC\u5854\u5C3C\u4E9A\u4E4C\u5409\u4E9A",pos:"before",value:"MRO"},{name:"\u8499\u53E4\u56FE\u683C\u91CC\u514B",pos:"before",value:"?"},{name:"\u5B5F\u52A0\u62C9\u5854\u5361",pos:"before",value:"?"},{name:"\u79D8\u9C81\u65B0\u7D22\u5C14",pos:"before",value:"S/"},{name:"\u7F05\u7538\u5F00\u4E9A\u7279",pos:"before",value:"K"},{name:"\u6469\u5C14\u591A\u74E6\u5217\u4F0A",pos:"before",value:"MDL"},{name:"\u6469\u6D1B\u54E5\u8FEA\u62C9\u59C6",pos:"before",value:"dh"},{name:"\u83AB\u6851\u6BD4\u514B\u6885\u8482\u5361\u5C14",pos:"before",value:"MTn"},{name:"\u58A8\u897F\u54E5\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u7EB3\u7C73\u6BD4\u4E9A\u5143",pos:"before",value:"$"},{name:"\u5357\u975E\u5170\u7279",pos:"before",value:"R"},{name:"\u5357\u82CF\u4E39\u9551",pos:"before",value:"\uFFE1"},{name:"\u5C3C\u52A0\u62C9\u74DC\u79D1\u591A\u5DF4",pos:"before",value:"C$"},{name:"\u5C3C\u6CCA\u5C14\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u5C3C\u65E5\u5229\u4E9A\u5948\u62C9",pos:"before",value:"?"},{name:"\u632A\u5A01\u514B\u6717",pos:"after",value:"kr"},{name:"\u4E54\u6CBB\u4E9A\u62C9\u745E",pos:"before",value:"GEL"},{name:"\u4EBA\u6C11\u5E01\uFF08\u79BB\u5CB8\uFF09",pos:"before",value:"\uFFE5"},{name:"\u745E\u5178\u514B\u6717",pos:"after",value:"kr"},{name:"\u745E\u58EB\u6CD5\u90CE",pos:"before",value:"CHF"},{name:"\u585E\u5C14\u7EF4\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u585E\u62C9\u5229\u6602\u5229\u6602",pos:"before",value:"SLL"},{name:"\u585E\u820C\u5C14\u5362\u6BD4",pos:"before",value:"SCR"},{name:"\u6C99\u7279\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u5723\u591A\u7F8E\u591A\u5E03\u62C9",pos:"before",value:"Db"},{name:"\u5723\u8D6B\u52D2\u62FF\u7FA4\u5C9B\u78C5",pos:"before",value:"\uFFE1"},{name:"\u65AF\u91CC\u5170\u5361\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u65AF\u5A01\u58EB\u5170\u91CC\u5170\u5409\u5C3C",pos:"before",value:"SZL"},{name:"\u82CF\u4E39\u9551",pos:"before",value:"SDG"},{name:"\u82CF\u91CC\u5357\u5143",pos:"before",value:"$"},{name:"\u6240\u7F57\u95E8\u7FA4\u5C9B\u5143",pos:"before",value:"$"},{name:"\u7D22\u9A6C\u91CC\u5148\u4EE4",pos:"before",value:"SOS"},{name:"\u5854\u5409\u514B\u65AF\u5766\u7D22\u83AB\u5C3C",pos:"before",value:"Som"},{name:"\u592A\u5E73\u6D0B\u6CD5\u90CE",pos:"after",value:"FCFP"},{name:"\u6CF0\u56FD\u94E2",pos:"before",value:"?"},{name:"\u5766\u6851\u5C3C\u4E9A\u5148\u4EE4",pos:"before",value:"TSh"},{name:"\u6C64\u52A0\u6F58\u52A0",pos:"before",value:"T$"},{name:"\u7279\u7ACB\u5C3C\u8FBE\u548C\u591A\u5DF4\u54E5\u5143",pos:"before",value:"$"},{name:"\u7A81\u5C3C\u65AF\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u571F\u8033\u5176\u91CC\u62C9",pos:"before",value:"?"},{name:"\u74E6\u52AA\u963F\u56FE\u74E6\u56FE",pos:"before",value:"VUV"},{name:"\u5371\u5730\u9A6C\u62C9\u683C\u67E5\u5C14",pos:"before",value:"Q"},{name:"\u59D4\u5185\u745E\u62C9\u535A\u5229\u74E6",pos:"before",value:"Bs"},{name:"\u6587\u83B1\u5143",pos:"before",value:"$"},{name:"\u4E4C\u5E72\u8FBE\u5148\u4EE4",pos:"before",value:"UGX"},{name:"\u4E4C\u514B\u5170\u683C\u91CC\u592B\u5C3C\u4E9A",pos:"before",value:"\u0433\u0440\u043D."},{name:"\u4E4C\u62C9\u572D\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u4E4C\u5179\u522B\u514B\u65AF\u5766\u82CF\u59C6",pos:"before",value:"so?m"},{name:"\u897F\u8428\u6469\u4E9A\u5854\u62C9",pos:"before",value:"WST"},{name:"\u65B0\u52A0\u5761\u5143",pos:"before",value:"$"},{name:"\u65B0\u53F0\u5E01",pos:"before",value:"NT$"},{name:"\u65B0\u897F\u5170\u5143",pos:"before",value:"$"},{name:"\u5308\u7259\u5229\u798F\u6797",pos:"before",value:"Ft"},{name:"\u53D9\u5229\u4E9A\u9551",pos:"before",value:"\uFFE1"},{name:"\u7259\u4E70\u52A0\u5143",pos:"before",value:"$"},{name:"\u4E9A\u7F8E\u5C3C\u4E9A\u5FB7\u62C9\u59C6",pos:"before",value:"Dram"},{name:"\u4E5F\u95E8\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u4F0A\u62C9\u514B\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u4F0A\u6717\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u4EE5\u8272\u5217\u65B0\u8C22\u514B\u5C14",pos:"before",value:"?"},{name:"\u5370\u5EA6\u5362\u6BD4",pos:"before",value:"?"},{name:"\u5370\u5EA6\u5C3C\u897F\u4E9A\u5362\u6BD4",pos:"before",value:"Rp"},{name:"\u7EA6\u65E6\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u8D8A\u5357\u76FE",pos:"after",value:"?"},{name:"\u8D5E\u6BD4\u4E9A\u514B\u74E6\u67E5",pos:"before",value:"ZMW"},{name:"\u76F4\u5E03\u7F57\u9640\u9551",pos:"before",value:"\uFFE1"},{name:"\u667A\u5229\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u4E2D\u975E\u91D1\u878D\u5408\u4F5C\u6CD5\u90CE",pos:"before",value:"FCFA"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"1930\u5E748\u67085\u65E5",value:'yyyy"\u5E74"M"\u6708"d"\u65E5"'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"8\u67085\u65E5",value:'M"\u6708"d"\u65E5"'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"\u4E0B\u534801:30",value:"\u4E0A\u5348/\u4E0B\u5348 hh:mm"},{name:"\u4E0B\u53481:30",value:"\u4E0A\u5348/\u4E0B\u5348 h:mm"},{name:"\u4E0B\u53481:30:30",value:"\u4E0A\u5348/\u4E0B\u5348 h:mm:ss"},{name:"08-05 \u4E0B\u534801:30",value:"MM-dd \u4E0A\u5348/\u4E0B\u5348 hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],createDialog:function(e){let n=this,t=Q().currencyDetail,l=Q().format,o=Q().button;this.moneyFmtList=[{name:t.RMB,pos:"before",value:"\xA5"},{name:t.USdollar,pos:"before",value:"$"},{name:t.EUR,pos:"before",value:"\u20AC"},{name:t.GBP,pos:"before",value:"\uFFE1"},{name:t.HK,pos:"before",value:"$"},{name:t.JPY,pos:"before",value:"\uFFE5"},{name:t.AlbanianLek,pos:"before",value:"Lek"},{name:t.AlgerianDinar,pos:"before",value:"din"},{name:t.Afghani,pos:"after",value:"Af"},{name:t.ArgentinePeso,pos:"before",value:"$"},{name:t.UnitedArabEmiratesDirham,pos:"before",value:"dh"},{name:t.ArubanFlorin,pos:"before",value:"Afl"},{name:t.OmaniRial,pos:"before",value:"Rial"},{name:t.Azerbaijanimanat,pos:"before",value:"?"},{name:t.EgyptianPound,pos:"before",value:"\uFFE1"},{name:t.EthiopianBirr,pos:"before",value:"Birr"},{name:t.AngolaKwanza,pos:"before",value:"Kz"},{name:t.AustralianDollar,pos:"before",value:"$"},{name:t.Patacas,pos:"before",value:"MOP"},{name:t.BarbadosDollar,pos:"before",value:"$"},{name:t.PapuaNewGuineaKina,pos:"before",value:"PGK"},{name:t.BahamianDollar,pos:"before",value:"$"},{name:t.PakistanRupee,pos:"before",value:"Rs"},{name:t.ParaguayanGuarani,pos:"after",value:"Gs"},{name:t.BahrainiDinar,pos:"before",value:"din"},{name:t.PanamanianBalboa,pos:"before",value:"B/"},{name:t.Brazilianreal,pos:"before",value:"R$"},{name:t.Belarusianruble,pos:"after",value:"\u0440"},{name:t.BermudianDollar,pos:"before",value:"$"},{name:t.BulgarianLev,pos:"before",value:"lev"},{name:t.IcelandKrona,pos:"before",value:"kr"},{name:t.BosniaHerzegovinaConvertibleMark,pos:"before",value:"KM"},{name:t.PolishZloty,pos:"after",value:"z?"},{name:t.Boliviano,pos:"before",value:"Bs"},{name:t.BelizeDollar,pos:"before",value:"$"},{name:t.BotswanaPula,pos:"before",value:"P"},{name:t.NotDannuzhamu,pos:"before",value:"Nu"},{name:t.BurundiFranc,pos:"before",value:"FBu"},{name:t.NorthKoreanWon,pos:"before",value:"?KP"},{name:t.DanishKrone,pos:"after",value:"kr"},{name:t.EastCaribbeanDollar,pos:"before",value:"$"},{name:t.DominicaPeso,pos:"before",value:"RD$"},{name:t.RussianRuble,pos:"after",value:"?"},{name:t.EritreanNakfa,pos:"before",value:"Nfk"},{name:t.CFAfranc,pos:"before",value:"CFA"},{name:t.PhilippinePeso,pos:"before",value:"?"},{name:t.FijiDollar,pos:"before",value:"$"},{name:t.CapeVerdeEscudo,pos:"before",value:"CVE"},{name:t.FalklandIslandsPound,pos:"before",value:"\uFFE1"},{name:t.GambianDalasi,pos:"before",value:"GMD"},{name:t.Congolesefranc,pos:"before",value:"FrCD"},{name:t.ColombianPeso,pos:"before",value:"$"},{name:t.CostaRicanColon,pos:"before",value:"?"},{name:t.CubanPeso,pos:"before",value:"$"},{name:t.Cubanconvertiblepeso,pos:"before",value:"$"},{name:t.GuyanaDollar,pos:"before",value:"$"},{name:t.KazakhstanTenge,pos:"before",value:"?"},{name:t.Haitiangourde,pos:"before",value:"HTG"},{name:t.won,pos:"before",value:"?"},{name:t.NetherlandsAntillesGuilder,pos:"before",value:"NAf."},{name:t.Honduraslempiras,pos:"before",value:"L"},{name:t.DjiboutiFranc,pos:"before",value:"Fdj"},{name:t.KyrgyzstanSom,pos:"before",value:"KGS"},{name:t.GuineaFranc,pos:"before",value:"FG"},{name:t.CanadianDollar,pos:"before",value:"$"},{name:t.GhanaianCedi,pos:"before",value:"GHS"},{name:t.Cambodianriel,pos:"before",value:"Riel"},{name:t.CzechKoruna,pos:"after",value:"K?"},{name:t.ZimbabweDollar,pos:"before",value:"$"},{name:t.QatariRiyal,pos:"before",value:"Rial"},{name:t.CaymanIslandsDollar,pos:"before",value:"$"},{name:t.Comorianfranc,pos:"before",value:"CF"},{name:t.KuwaitiDinar,pos:"before",value:"din"},{name:t.CroatianKuna,pos:"before",value:"kn"},{name:t.KenyanShilling,pos:"before",value:"Ksh"},{name:t.LesothoLoti,pos:"before",value:"LSL"},{name:t.LaoKip,pos:"before",value:"?"},{name:t.LebanesePound,pos:"before",value:"L\uFFE1"},{name:t.Lithuanianlitas,pos:"before",value:"Lt"},{name:t.LibyanDinar,pos:"before",value:"din"},{name:t.LiberianDollar,pos:"before",value:"$"},{name:t.RwandaFranc,pos:"before",value:"RF"},{name:t.RomanianLeu,pos:"before",value:"RON"},{name:t.MalagasyAriary,pos:"before",value:"Ar"},{name:t.MaldivianRufiyaa,pos:"before",value:"Rf"},{name:t.MalawiKwacha,pos:"before",value:"MWK"},{name:t.MalaysianRinggit,pos:"before",value:"RM"},{name:t.MacedoniawearingDinar,pos:"before",value:"din"},{name:t.MauritiusRupee,pos:"before",value:"MURs"},{name:t.MauritanianOuguiya,pos:"before",value:"MRO"},{name:t.MongolianTugrik,pos:"before",value:"?"},{name:t.BangladeshiTaka,pos:"before",value:"?"},{name:t.PeruvianNuevoSol,pos:"before",value:"S/"},{name:t.MyanmarKyat,pos:"before",value:"K"},{name:t.MoldovanLeu,pos:"before",value:"MDL"},{name:t.MoroccanDirham,pos:"before",value:"dh"},{name:t.MozambiqueMetical,pos:"before",value:"MTn"},{name:t.MexicanPeso,pos:"before",value:"$"},{name:t.NamibianDollar,pos:"before",value:"$"},{name:t.SouthAfricanRand,pos:"before",value:"R"},{name:t.SouthSudanesePound,pos:"before",value:"\uFFE1"},{name:t.NicaraguaCordoba,pos:"before",value:"C$"},{name:t.NepaleseRupee,pos:"before",value:"Rs"},{name:t.NigerianNaira,pos:"before",value:"?"},{name:t.NorwegianKrone,pos:"after",value:"kr"},{name:t.GeorgianLari,pos:"before",value:"GEL"},{name:t.RenminbiOffshore,pos:"before",value:"\uFFE5"},{name:t.SwedishKrona,pos:"after",value:"kr"},{name:t.SwissFranc,pos:"before",value:"CHF"},{name:t.SerbianDinar,pos:"before",value:"din"},{name:t.SierraLeone,pos:"before",value:"SLL"},{name:t.SeychellesRupee,pos:"before",value:"SCR"},{name:t.SaudiRiyal,pos:"before",value:"Rial"},{name:t.SaoTomeDobra,pos:"before",value:"Db"},{name:t.SaintHelenapound,pos:"before",value:"\uFFE1"},{name:t.SriLankaRupee,pos:"before",value:"Rs"},{name:t.SwazilandLilangeni,pos:"before",value:"SZL"},{name:t.SudanesePound,pos:"before",value:"SDG"},{name:t.Surinamesedollar,pos:"before",value:"$"},{name:t.SolomonIslandsDollar,pos:"before",value:"$"},{name:t.SomaliShilling,pos:"before",value:"SOS"},{name:t.TajikistanSomoni,pos:"before",value:"Som"},{name:t.PacificFranc,pos:"after",value:"FCFP"},{name:t.ThaiBaht,pos:"before",value:"?"},{name:t.TanzanianShilling,pos:"before",value:"TSh"},{name:t.TonganPaanga,pos:"before",value:"T$"},{name:t.TrinidadandTobagoDollar,pos:"before",value:"$"},{name:t.TunisianDinar,pos:"before",value:"din"},{name:t.TurkishLira,pos:"before",value:"?"},{name:t.VanuatuVatu,pos:"before",value:"VUV"},{name:t.GuatemalanQuetzal,pos:"before",value:"Q"},{name:t.CommissionBolivar,pos:"before",value:"Bs"},{name:t.BruneiDollar,pos:"before",value:"$"},{name:t.UgandanShilling,pos:"before",value:"UGX"},{name:t.UkrainianHryvnia,pos:"before",value:"\u0433\u0440\u043D."},{name:t.UruguayanPeso,pos:"before",value:"$"},{name:t.Uzbekistansom,pos:"before",value:"so?m"},{name:t.WesternSamoaTala,pos:"before",value:"WST"},{name:t.SingaporeDollar,pos:"before",value:"$"},{name:t.NT,pos:"before",value:"NT$"},{name:t.NewZealandDollar,pos:"before",value:"$"},{name:t.HungarianForint,pos:"before",value:"Ft"},{name:t.SyrianPound,pos:"before",value:"\uFFE1"},{name:t.JamaicanDollar,pos:"before",value:"$"},{name:t.ArmenianDram,pos:"before",value:"Dram"},{name:t.YemeniRial,pos:"before",value:"Rial"},{name:t.IraqiDinar,pos:"before",value:"din"},{name:t.IranianRial,pos:"before",value:"Rial"},{name:t.NewIsraeliShekel,pos:"before",value:"?"},{name:t.IndianRupee,pos:"before",value:"?"},{name:t.IndonesianRupiah,pos:"before",value:"Rp"},{name:t.JordanianDinar,pos:"before",value:"din"},{name:t.VND,pos:"after",value:"?"},{name:t.ZambianKwacha,pos:"before",value:"ZMW"},{name:t.GibraltarPound,pos:"before",value:"\uFFE1"},{name:t.ChileanPeso,pos:"before",value:"$"},{name:t.CFAFrancBEAC,pos:"before",value:"FCFA"}],this.dateFmtList=Q().dateFmtList,this.numFmtList=[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-moreFormat-dialog").remove();let a="",s="";if(e=="morecurrency"){a=l.titleCurrency;let k="";for(let b=0;b<n.moneyFmtList.length;b++){let w=n.moneyFmtList[b].name,x=n.moneyFmtList[b].pos,C=n.moneyFmtList[b].value;k+='<div class="listItem"><div class="name">'+w+'</div><div class="value">'+C+'</div><input type="hidden" value="'+x+'"/></div>'}s='<div class="box" id="morecurrency"><div class="decimal"><label>'+l.decimalPlaces+'\uFF1A</label><input type="number" class="formulaInputFocus" value="2" min="0" max="9"/></div><div class="listbox">'+k+"</div></div>"}else if(e=="moredatetime"){a=l.titleDateTime;let k="";for(let b=0;b<n.dateFmtList.length;b++){let w=n.dateFmtList[b].name,x=n.dateFmtList[b].value;k+='<div class="listItem"><div class="name">'+w+'</div><div class="value">'+x+"</div></div>"}s='<div class="box" id="moredatetime"><div class="listbox">'+k+"</div></div>"}else if(e=="moredigit"){a=l.titleNumber;let k="";for(let b=0;b<n.numFmtList.length;b++){let w=n.numFmtList[b].name,x=n.numFmtList[b].value;k+='<div class="listItem"><div class="name">'+w+'</div><div class="value">'+x+"</div></div>"}s='<div class="box" id="moredigit"><div class="listbox">'+k+"</div></div>"}$("body").append(_e(dt,{id:"luckysheet-moreFormat-dialog",addclass:"luckysheet-moreFormat-dialog",title:a,content:s,botton:'<button id="luckysheet-moreFormat-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let u=$("#luckysheet-moreFormat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),h=u.outerHeight(),d=u.outerWidth(),m=$(window).width(),p=$(window).height(),v=$(document).scrollLeft(),y=$(document).scrollTop();$("#luckysheet-moreFormat-dialog").css({left:(m+v-d)/2,top:(p+y-h)/3}).show(),$("#luckysheet-moreFormat-dialog .listbox .listItem").eq(0).addClass("on")},init:function(){let e=this;$(document).on("click","#luckysheet-moreFormat-dialog .listbox .listItem",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.moreFormatConfirm").on("click.moreFormatConfirm","#luckysheet-moreFormat-dialog #luckysheet-moreFormat-dialog-confirm",function(){$("#luckysheet-moreFormat-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide();let n=xe.deepCopyFlowData(f.flowdata),t=$("#luckysheet-moreFormat-dialog .listbox .listItem.on .value").text(),l=$(this).parents("#luckysheet-moreFormat-dialog").find(".box").attr("id");if(l=="morecurrency"){if(t.indexOf("?")!=-1)return;let o=parseInt($("#luckysheet-moreFormat-dialog .decimal input").val().trim());if(o.toString()=="NaN"||o<0||o>9){he()?alert("\u5C0F\u6570\u4F4D\u6570\u5FC5\u987B\u57280-9\u4E4B\u95F4\uFF01"):W.info("\u5C0F\u6570\u4F4D\u6570\u5FC5\u987B\u57280-9\u4E4B\u95F4\uFF01","");return}let a="";if(o>0){for(let u=1;u<=o;u++)a+="0";a="0."+a}else a="#";let s=$("#luckysheet-moreFormat-dialog .listbox .listItem.on input:hidden").val();s=="before"?a='"'+t+'" '+a:s=="after"&&(a=a+' "'+t+'"'),be.updateFormat(n,"ct",a)}else l=="moredatetime"?be.updateFormat(n,"ct",t):l=="moredigit"&&be.updateFormat(n,"ct",t)})}},Dc=_0});var zd=wl((sF,Ad)=>{"use strict";var C0=/["'&<>]/;Ad.exports=$0;function $0(e){var n=""+e,t=C0.exec(n);if(!t)return n;var l,o="",a=0,s=0;for(a=t.index;a<n.length;a++){switch(n.charCodeAt(a)){case 34:l="&quot;";break;case 38:l="&amp;";break;case 39:l="&#39;";break;case 60:l="&lt;";break;case 62:l="&gt;";break;default:continue}s!==a&&(o+=n.substring(s,a)),s=a+1,o+=l}return s!==a?o+n.substring(s,a):o}});var Vo,T0,$n,Mc=Me(()=>{ht();Et();Wt();Zt();dl();Nt();Fl();$r();Yt();Jt();ll();No();Ke();kt();Ml();Vo=El(zd()),T0={createDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-replace").remove();let n=Q(),t=n.findAndReplace,l=n.button,o='<div class="tabBox"><span id="searchTab">'+t.find+'</span><span id="replaceTab">'+t.replace+'</span></div><div class="ctBox"><div class="inputBox"><div class="textboxs" id="searchInput">'+t.findTextbox+'\uFF1A<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="textboxs" id="replaceInput">'+t.replaceTextbox+'\uFF1A<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="checkboxs"><div id="regCheck"><input type="checkbox"/><span>'+t.regexTextbox+'</span></div><div id="wordCheck"><input type="checkbox"/><span>'+t.wholeTextbox+'</span></div><div id="caseCheck"><input type="checkbox"/><span>'+t.distinguishTextbox+'</span></div></div></div><div class="btnBox"><button id="replaceAllBtn" class="btn btn-default">'+t.allReplaceBtn+'</button><button id="replaceBtn" class="btn btn-default">'+t.replaceBtn+'</button><button id="searchAllBtn" class="btn btn-default">'+t.allFindBtn+'</button><button id="searchNextBtn" class="btn btn-default">'+t.findBtn+"</button></div></div>";$("body").append(_e(dt,{id:"luckysheet-search-replace",addclass:"luckysheet-search-replace",title:"",content:o,botton:'<button class="btn btn-default luckysheet-model-close-btn">'+l.close+"</button>",style:"z-index:100003",close:l.close}));let a=$("#luckysheet-search-replace").find(".luckysheet-modal-dialog-content").css("min-width",500).end(),s=a.outerHeight(),u=a.outerWidth(),h=$(window).width(),d=$(window).height(),m=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-search-replace").css({left:(h+m-u)/2,top:(d+p-s)/3}).show(),e=="0"?($("#luckysheet-search-replace #searchTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide()):e=="1"&&($("#luckysheet-search-replace #replaceTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show())},init:function(){let e=this;$(document).off("click.SRtabBoxspan").on("click.SRtabBoxspan","#luckysheet-search-replace .tabBox span",function(){$(this).addClass("on").siblings().removeClass("on");let n=$(this).attr("id");n=="searchTab"?($("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide(),$("#luckysheet-search-replace #searchInput input").focus()):n=="replaceTab"&&($("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show(),$("#luckysheet-search-replace #replaceInput input").focus())}),$(document).off("keyup.SRsearchInput").on("keyup.SRsearchInput","#luckysheet-search-replace #searchInput input",function(n){n.keyCode==it.ENTER&&e.searchNext()}),$(document).off("click.SRsearchNextBtn").on("click.SRsearchNextBtn","#luckysheet-search-replace #searchNextBtn",function(){e.searchNext()}),$(document).off("click.SRsearchAllBtn").on("click.SRsearchAllBtn","#luckysheet-search-replace #searchAllBtn",function(){e.searchAll()}),$(document).off("click.SRsearchAllboxItem").on("click.SRsearchAllboxItem","#luckysheet-search-replace #searchAllbox .boxItem",function(){$(this).addClass("on").siblings().removeClass("on");let n=$(this).attr("data-row"),t=$(this).attr("data-col"),l=$(this).attr("data-sheetIndex");l!=f.currentSheetIndex&&ye.changeSheetExec(l),f.luckysheet_select_save=[{row:[n,n],column:[t,t]}],lt();let o=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),s=$("#luckysheet-cell-main").height(),u=$("#luckysheet-cell-main").width(),h=f.visibledatarow[n],d=n-1==-1?0:f.visibledatarow[n-1],m=f.visibledatacolumn[t],p=t-1==-1?0:f.visibledatacolumn[t-1];m-o-u+20>0?$("#luckysheet-scrollbar-x").scrollLeft(m-u+20):p-o-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(p-20),h-a-s+20>0?$("#luckysheet-scrollbar-y").scrollTop(h-s+20):d-a-20<0&&$("#luckysheet-scrollbar-y").scrollTop(d-20)}),$(document).off("click.SRreplaceBtn").on("click.SRreplaceBtn","#luckysheet-search-replace #replaceBtn",function(){e.replace()}),$(document).off("click.SRreplaceAllBtn").on("click.SRreplaceAllBtn","#luckysheet-search-replace #replaceAllBtn",function(){e.replaceAll()})},searchNext:function(){let e=this,n=$("#luckysheet-search-replace #searchInput input").val();if(n==""||n==null)return;let l=Q().findAndReplace,o;f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]?o=[{row:[0,f.flowdata.length-1],column:[0,f.flowdata[0].length-1]}]:o=$.extend(!0,[],f.luckysheet_select_save);let a=e.getSearchIndexArr(n,o);if(a.length==0){he()?alert(l.noFindTip):W.info(l.noFindTip,"");return}let s=0;if(f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]){if(f.luckysheet_select_save.length==0)s=0;else for(let b=0;b<a.length;b++)if(a[b].r==f.luckysheet_select_save[0].row[0]&&a[b].c==f.luckysheet_select_save[0].column[0]){b==a.length-1?s=0:s=b+1;break}f.luckysheet_select_save=[{row:[a[s].r,a[s].r],column:[a[s].c,a[s].c]}]}else{let b=o[o.length-1].row_focus,w=o[o.length-1].column_focus;for(let x=0;x<a.length;x++)if(a[x].r==b&&a[x].c==w){x==a.length-1?s=0:s=x+1;break}for(let x=0;x<o.length;x++){let C=o[x].row[0],S=o[x].row[1],_=o[x].column[0],T=o[x].column[1];if(a[s].r>=C&&a[s].r<=S&&a[s].c>=_&&a[s].c<=T){let F=o[x];F.row_focus=a[s].r,F.column_focus=a[s].c,o.splice(x,1),o.push(F);break}}f.luckysheet_select_save=o}lt();let u=$("#luckysheet-cell-main").scrollLeft(),h=$("#luckysheet-cell-main").scrollTop(),d=$("#luckysheet-cell-main").height(),m=$("#luckysheet-cell-main").width(),p=f.visibledatarow[a[s].r],v=a[s].r-1==-1?0:f.visibledatarow[a[s].r-1],y=f.visibledatacolumn[a[s].c],k=a[s].c-1==-1?0:f.visibledatacolumn[a[s].c-1];y-u-m+20>0?$("#luckysheet-scrollbar-x").scrollLeft(y-m+20):k-u-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(k-20),p-h-d+20>0?$("#luckysheet-scrollbar-y").scrollTop(p-d+20):v-h-20<0&&$("#luckysheet-scrollbar-y").scrollTop(v-20),$("#searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox .boxItem").removeClass("on")},searchAll:function(){let e=this,t=Q().findAndReplace;$("#luckysheet-search-replace #searchAllbox").remove();let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null)return;let o;f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]?o=[{row:[0,f.flowdata.length-1],column:[0,f.flowdata[0].length-1]}]:o=$.extend(!0,[],f.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){he()?alert(t.noFindTip):W.info(t.noFindTip,"");return}let s="";for(let u=0;u<a.length;u++){let h=vn(a[u].r,a[u].c,f.flowdata).toString();h.indexOf("</")>-1&&h.indexOf(">")>-1?s+='<div class="boxItem" data-row="'+a[u].r+'" data-col="'+a[u].c+'" data-sheetIndex="'+f.currentSheetIndex+'"><span>'+(0,Vo.default)(f.luckysheetfile[Z(f.currentSheetIndex)].name)+"</span><span>"+tt(a[u].c)+(a[u].r+1)+"</span><span>"+(0,Vo.default)(h)+"</span></div>":s+='<div class="boxItem" data-row="'+a[u].r+'" data-col="'+a[u].c+'" data-sheetIndex="'+f.currentSheetIndex+'"><span>'+f.luckysheetfile[Z(f.currentSheetIndex)].name+"</span><span>"+tt(a[u].c)+(a[u].r+1)+'</span><span title="'+(0,Vo.default)(h)+'">'+(0,Vo.default)(h)+"</span></div>"}$(`<div id="searchAllbox"><div class="boxTitle"><span>${t.searchTargetSheet}</span><span>${t.searchTargetCell}</span><span>${t.searchTargetValue}</span></div><div class="boxMain">${s}</div></div>`).appendTo($("#luckysheet-search-replace")),$("#luckysheet-search-replace #searchAllbox .boxItem").eq(0).addClass("on").siblings().removeClass("on"),f.luckysheet_select_save=[{row:[a[0].r,a[0].r],column:[a[0].c,a[0].c]}],lt()},getSearchIndexArr:function(e,n){let t=[],l={},o=$("#luckysheet-search-replace"),a=p=>o.find(`#${p} input[type='checkbox']`).is(":checked"),s=a("regCheck"),u=a("wordCheck"),h=a("caseCheck"),d="g";h||(e=e.toLowerCase(),d+="i");let m=(p,v)=>{p+"_"+v in l||(l[p+"_"+v]=0,t.push({r:p,c:v}))};for(let p=0;p<n.length;p++){let v=n[p].row[0],y=n[p].row[1],k=n[p].column[0],b=n[p].column[1];for(let w=v;w<=y;w++)for(let x=k;x<=b;x++)if(f.flowdata[w][x]!=null){let S=vn(w,x,f.flowdata);if(S==0&&(S=S.toString()),S!=null&&S!=""){let _=!1;S=S.toString(),S=h?S:S.toLowerCase(),u?_=e==S:s?_=new RegExp(D.getRegExpStr(e),d).test(S):_=~S.indexOf(e),_&&m(w,x)}}}return t},replace:function(){let e=this,t=Q().findAndReplace;if(!f.allowEdit){W.info(t.modeTip,"");return}let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null){he()?alert(t.searchInputTip):W.info(t.searchInputTip,"");return}let o;f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]?o=[{row:[0,f.flowdata.length-1],column:[0,f.flowdata[0].length-1]}]:o=$.extend(!0,[],f.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){he()?alert(t.noReplceTip):W.info(t.noReplceTip,"");return}let s=null,u=f.luckysheet_select_save[f.luckysheet_select_save.length-1],h=u.row_focus,d=u.column_focus;for(let P=0;P<a.length;P++)if(a[P].r==h&&a[P].c==d){s=P;break}if(s==null)if(a.length==0){he()?alert(t.noMatchTip):W.info(t.noMatchTip,"");return}else s=0;let m=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(m=!0);let p=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(p=!0);let v=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(v=!0);let y=$("#luckysheet-search-replace #replaceInput input").val(),k=xe.deepCopyFlowData(f.flowdata),b,w;if(p){b=a[s].r,w=a[s].c;let P=y;if(!kn(b,w,f.currentSheetIndex))return;Ht(b,w,k,P)}else{let P;if(v?P=new RegExp(D.getRegExpStr(l),"g"):P=new RegExp(D.getRegExpStr(l),"ig"),b=a[s].r,w=a[s].c,!kn(b,w,f.currentSheetIndex))return;let O=vn(b,w,k).toString().replace(P,y);Ht(b,w,k,O)}f.luckysheet_select_save=[{row:[b,b],column:[w,w]}],$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),Ze(k,f.luckysheet_select_save),lt();let x=$("#luckysheet-cell-main").scrollLeft(),C=$("#luckysheet-cell-main").scrollTop(),S=$("#luckysheet-cell-main").height(),_=$("#luckysheet-cell-main").width(),T=f.visibledatarow[b],F=b-1==-1?0:f.visibledatarow[b-1],R=f.visibledatacolumn[w],I=w-1==-1?0:f.visibledatacolumn[w-1];R-x-_+20>0?$("#luckysheet-scrollbar-x").scrollLeft(R-_+20):I-x-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(I-20),T-C-S+20>0?$("#luckysheet-scrollbar-y").scrollTop(T-S+20):F-C-20<0&&$("#luckysheet-scrollbar-y").scrollTop(F-20)},replaceAll:function(){let e=this,t=Q().findAndReplace;if(!f.allowEdit){W.info(t.modeTip,"");return}let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null){he()?alert(t.searchInputTip):W.info(t.searchInputTip,"");return}let o;f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]?o=[{row:[0,f.flowdata.length-1],column:[0,f.flowdata[0].length-1]}]:o=$.extend(!0,[],f.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){he()?alert(t.noReplceTip):W.info(t.noReplceTip,"");return}let s=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(s=!0);let u=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(u=!0);let h=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(h=!0);let d=$("#luckysheet-search-replace #replaceInput input").val(),m=xe.deepCopyFlowData(f.flowdata),p=0;if(u)for(let y=0;y<a.length;y++){let k=a[y].r,b=a[y].c;if(!kn(k,b,f.currentSheetIndex,!1))continue;Ht(k,b,m,d),o.push({row:[k,k],column:[b,b]}),p++}else{let y;h?y=new RegExp(D.getRegExpStr(l),"g"):y=new RegExp(D.getRegExpStr(l),"ig");for(let k=0;k<a.length;k++){let b=a[k].r,w=a[k].c;if(!kn(b,w,f.currentSheetIndex,!1))continue;let x=vn(b,w,m).toString().replace(y,d);Ht(b,w,m,x),o.push({row:[b,b],column:[w,w]}),p++}}$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),Ze(m,o),f.luckysheet_select_save=$.extend(!0,[],o),lt();let v=_e(t.successTip,{xlength:p});he()?alert(v):W.info(v,"")}},$n=T0});var S0,Xr,Pd=Me(()=>{ht();Et();Nt();Nt();ll();Wt();Zt();mr();Ke();kt();S0={createDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-locationCell-dialog").remove();let e=Q(),n=e.findAndReplace,t=e.button,l='<div class="listbox"><div class="listItem"><input type="radio" name="locationType" checked="checked" id="locationConstant"><label for="locationConstant">'+n.locationConstant+'</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationConstantDate"><label for="locationConstantDate">'+n.locationDate+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationConstantNumber"><label for="locationConstantNumber">'+n.locationDigital+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationConstantString"><label for="locationConstantString">'+n.locationString+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationConstantBoolean"><label for="locationConstantBoolean">'+n.locationBool+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationConstantError"><label for="locationConstantError">'+n.locationBool+'</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationFormula"><label for="locationFormula">'+n.locationFormula+'</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationFormulaDate" disabled="true"><label for="locationFormulaDate" style="color: #666">'+n.locationDate+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationFormulaNumber" disabled="true"><label for="locationFormulaNumber" style="color: #666">'+n.locationDigital+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationFormulaString" disabled="true"><label for="locationFormulaString" style="color: #666">'+n.locationString+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationFormulaBoolean" disabled="true"><label for="locationFormulaBoolean" style="color: #666">'+n.locationBool+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationFormulaError" disabled="true"><label for="locationFormulaError" style="color: #666">'+n.locationError+'</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationNull"><label for="locationNull">'+n.locationNull+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationCF"><label for="locationCF">'+n.locationCondition+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepRow"><label for="locationStepRow">'+n.locationRowSpan+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepColumn"><label for="locationStepColumn">'+n.locationColumnSpan+"</label></div></div>";$("body").append(_e(dt,{id:"luckysheet-locationCell-dialog",addclass:"luckysheet-locationCell-dialog",title:n.location,content:l,botton:'<button id="luckysheet-locationCell-dialog-confirm" class="btn btn-primary">'+t.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+t.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-locationCell-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-locationCell-dialog").css({left:(u+d-s)/2,top:(h+m-a)/3}).show()},init:function(){let e=this,n=Q().findAndReplace;$(document).on("click","#luckysheet-locationCell-dialog .listItem input:radio",function(t){$("#luckysheet-locationCell-dialog .listItem input:checkbox").prop("disabled",!0),$("#luckysheet-locationCell-dialog .listItem .subbox label").css("color","#666"),$(this).siblings(".subbox").find("input:checkbox").removeAttr("disabled"),$(this).siblings(".subbox").find("label").css("color","#000")}),$(document).off("click.locationCellConfirm").on("click.locationCellConfirm","#luckysheet-locationCell-dialog #luckysheet-locationCell-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-locationCell-dialog").hide();let t=$("#luckysheet-locationCell-dialog .listItem input:radio:checked"),l=t.attr("id");if(l=="locationConstant"||l=="locationFormula"){let o=t.siblings(".subbox").find("input:checkbox:checked"),a;if(o.length==0)return;if(o.length==5)a="all";else{let u=[];for(let h=0;h<o.length;h++)$(o[h]).hasClass("date")?u.push("d"):$(o[h]).hasClass("number")?u.push("n"):$(o[h]).hasClass("string")?u.push("s,g"):$(o[h]).hasClass("boolean")?u.push("b"):$(o[h]).hasClass("error")&&u.push("e");a=u.join(",")}let s;f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]?s=[{row:[0,f.flowdata.length-1],column:[0,f.flowdata[0].length-1]}]:s=$.extend(!0,[],f.luckysheet_select_save),e.apply(s,l,a)}else if(l=="locationStepRow"){if(f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]){he()?alert(n.locationTiplessTwoRow):W.info("",n.locationTiplessTwoRow);return}let o=$.extend(!0,[],f.luckysheet_select_save);e.apply(o,"locationStepRow")}else if(l=="locationStepColumn"){if(f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]){he()?alert(n.locationTiplessTwoColumn):W.info("",n.locationTiplessTwoColumn);return}let o=$.extend(!0,[],f.luckysheet_select_save);e.apply(o,"locationStepColumn")}else{let o;f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]?o=[{row:[0,f.flowdata.length-1],column:[0,f.flowdata[0].length-1]}]:o=$.extend(!0,[],f.luckysheet_select_save),e.apply(o,l)}})},apply:function(e,n,t){let l=Q().findAndReplace,o=[];if(n=="locationFormula"||n=="locationConstant"||n=="locationNull"){let a=null,s=null,u=null,h=null,d={};for(let m=0;m<e.length;m++){let p=e[m].row[0],v=e[m].row[1],y=e[m].column[0],k=e[m].column[1];(a==null||a<p)&&(a=p),(s==null||s>v)&&(s=v),(u==null||u<y)&&(u=y),(h==null||h>k)&&(h=k);for(let b=p;b<=v;b++)for(let w=y;w<=k;w++){let x=f.flowdata[b][w];x!=null&&x.mc!=null&&(x=f.flowdata[x.mc.r][x.mc.c]),(n=="locationFormula"&&x!=null&&!me(x.v)&&x.f!=null&&(t=="all"||x.ct!=null&&t.indexOf(x.ct.t)>-1)||n=="locationConstant"&&x!=null&&!me(x.v)&&(t=="all"||x.ct!=null&&t.indexOf(x.ct.t)>-1)||n=="locationNull"&&(x==null||me(x.v)))&&(d[b+"_"+w]=0)}}o=this.getRangeArr(a,s,u,h,d,o)}else if(n=="locationCF"){let a=Z(f.currentSheetIndex),s=f.luckysheetfile[a].luckysheet_conditionformat_save,u=f.luckysheetfile[a].data;if(s==null||s.length==0){he()?alert(l.locationTipNotFindCell):W.info("",l.locationTipNotFindCell);return}if(computeMap=Se.compute(s,u),Object.keys(computeMap).length==0){he()?alert(l.locationTipNotFindCell):W.info("",l.locationTipNotFindCell);return}let h=null,d=null,m=null,p=null,v={};for(let y=0;y<e.length;y++){let k=e[y].row[0],b=e[y].row[1],w=e[y].column[0],x=e[y].column[1];(h==null||h<k)&&(h=k),(d==null||d>b)&&(d=b),(m==null||m<w)&&(m=w),(p==null||p>x)&&(p=x);for(let C=k;C<=b;C++)for(let S=w;S<=x;S++)C+"_"+S in computeMap&&(v[C+"_"+S]=0)}o=this.getRangeArr(h,d,m,p,v,o)}else if(n=="locationStepRow")for(let a=0;a<e.length;a++){if(e[a].row[0]==e[a].row[1])continue;let s=e[a].row[0],u=e[a].row[1],h=e[a].column[0],d=e[a].column[1];for(let m=s;m<=u;m++)(m-s)%2==0&&o.push({row:[m,m],column:[h,d]})}else if(n=="locationStepColumn")for(let a=0;a<e.length;a++){if(e[a].column[0]==e[a].column[1])continue;let s=e[a].row[0],u=e[a].row[1],h=e[a].column[0],d=e[a].column[1];for(let m=h;m<=d;m++)(m-h)%2==0&&o.push({row:[s,u],column:[m,m]})}if(o.length==0)he()?alert(l.locationTipNotFindCell):W.info("",l.locationTipNotFindCell);else{f.luckysheet_select_save=o,lt();let a=$("#luckysheet-cell-main").scrollLeft(),s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").height(),h=$("#luckysheet-cell-main").width(),d=f.luckysheet_select_save[0].row[0],m=f.luckysheet_select_save[0].row[1],p=f.luckysheet_select_save[0].column[0],v=f.luckysheet_select_save[0].column[1],y=f.visibledatarow[m],k=d-1==-1?0:f.visibledatarow[d-1],b=f.visibledatacolumn[v],w=p-1==-1?0:f.visibledatacolumn[p-1];b-a-h+20>0?$("#luckysheet-scrollbar-x").scrollLeft(b-h+20):w-a-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(w-20),y-s-u+20>0?$("#luckysheet-scrollbar-y").scrollTop(y-u+20):k-s-20<0&&$("#luckysheet-scrollbar-y").scrollTop(k-20)}},getRangeArr(e,n,t,l,o,a){if(Object.keys(o).length==0)return a;let s=this,u=null,h=null,d=null,m=null;for(let p=e;p<=n;p++)for(let v=t;v<=l;v++){let y=f.flowdata[p][v];if(p+"_"+v in o)if(y!=null&&y.mc!=null)if(d==null){let k={row:[y.mc.r,y.mc.r+y.mc.rs-1],column:[y.mc.c,y.mc.c+y.mc.cs-1]};return a.push(k),o=s.deleteCellInSave(o,k),s.getRangeArr(e,n,t,l,o,a)}else if(v<m){let k={row:[u,h],column:[d,m]};return a.push(k),o=s.deleteCellInSave(o,k),s.getRangeArr(e,n,t,l,o,a)}else break;else d==null?(d=v,m=v,u=p,h=p):v>m&&(m=v);else if(d!=null){if(y!=null&&y.mc!=null)break;if(!(v<d))if(v<=m){let k={row:[u,h],column:[d,m]};return a.push(k),o=s.deleteCellInSave(o,k),s.getRangeArr(e,n,t,l,o,a)}else h=p}}if(d!=null){let p={row:[u,h],column:[d,m]};return a.push(p),o=s.deleteCellInSave(o,p),s.getRangeArr(e,n,t,l,o,a)}},deleteCellInSave(e,n){for(let t=n.row[0];t<=n.row[1];t++)for(let l=n.column[0];l<=n.column[1];l++)delete e[t+"_"+l];return e}},Xr=S0});var I0,eo,Ac=Me(()=>{Ut();Jt();ki();Wt();ht();Ke();kt();I0={singleRangeFocus:!1,init:function(){let e=this,n=Q(),t=n.formula,l=n.button;$(document).off("focus.IFcompareValue").on("focus.IFcompareValue","#luckysheet-ifFormulaGenerator-dialog #compareValue",function(){$("#luckysheet-modal-dialog-mask").hide(),e.singleRangeFocus=!0}),$(document).off("click.IFsingRange").on("click.IFsingRange","#luckysheet-ifFormulaGenerator-dialog .singRange",function(){let o=$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val().trim();g.iscelldata(o)?e.singleRangeDialog(o):e.singleRangeDialog()}),$(document).off("click.IFsingRangeConfirm").on("click.IFsingRangeConfirm","#luckysheet-ifFormulaGenerator-singleRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();let o=$(this).parents("#luckysheet-ifFormulaGenerator-singleRange-dialog").find("input").val().trim();$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val(o),e.singleRangeFocus=!1}),$(document).off("click.IFsingRangeCancel").on("click.IFsingRangeCancel","#luckysheet-ifFormulaGenerator-singleRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),e.singleRangeFocus=!1}),$(document).off("click.IFsingRangeClose").on("click.IFsingRangeClose","#luckysheet-ifFormulaGenerator-singleRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),e.singleRangeFocus=!1}),$(document).off("click.IFmultiRange").on("click.IFmultiRange","#luckysheet-ifFormulaGenerator-dialog .multiRange",function(){e.multiRangeDialog(),e.singleRangeFocus=!1}),$(document).off("click.IFmultiRangeConfirm").on("click.IFmultiRangeConfirm","#luckysheet-ifFormulaGenerator-multiRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();let o=$(this).parents("#luckysheet-ifFormulaGenerator-multiRange-dialog").find("input").val().trim(),a=g.getcellrange(o),s=a.row[0],u=a.row[1],h=a.column[0],d=a.column[1],m=xe.deepCopyFlowData(f.flowdata),p=[];for(let k=s;k<=u;k++)for(let b=h;b<=d;b++)m[k]!=null&&m[k][b]!=null&&m[k][b].ct!=null&&m[k][b].ct.t=="n"&&p.push(m[k][b].v);for(let k=0;k<p.length;k++)for(let b=0;b<p.length-1-k;b++)if(p[b]<p[b+1]){let w=p[b];p[b]=p[b+1],p[b+1]=w}let v=p[0],y=p[p.length-1];$("#luckysheet-ifFormulaGenerator-dialog #smallRange").val(y),$("#luckysheet-ifFormulaGenerator-dialog #largeRange").val(v)}),$(document).off("click.IFmultiRangeCancel").on("click.IFmultiRangeCancel","#luckysheet-ifFormulaGenerator-multiRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).off("click.IFmultiRangeClose").on("click.IFmultiRangeClose","#luckysheet-ifFormulaGenerator-multiRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).on("change","#DivisionMethod",function(){$(this).find("option:selected").val()=="2"?$("#DivisionMethodVal").hide():$("#DivisionMethodVal").show(),$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty()}),$(document).off("click.IFcreateBtn").on("click.IFcreateBtn","#luckysheet-ifFormulaGenerator-dialog #createBtn",function(){let o=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#compareValue").val().trim();if(o==""){e.info(t.ifGenTipNotNullValue);return}let a=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethod option:selected").val();if(a=="2"){let s='<div class="item"><input type="number" class="smallNum formulaInputFocus"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+o+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus"/><span>'+t.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value=""><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(s)}else{let s=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#smallRange").val().trim(),u=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#largeRange").val().trim(),h=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethodVal").val().trim();if(s==""||u==""){e.info(t.ifGenTipRangeNotforNull);return}else if(h==""){e.info(t.ifGenTipCutValueNotforNull);return}e.getIfList(o,s,u,a,h)}}),$(document).on("click","#luckysheet-ifFormulaGenerator-dialog .item .fa-remove",function(){$(this).parents(".item").remove()}),$(document).off("click.IFconfirmBtn").on("click.IFconfirmBtn","#luckysheet-ifFormulaGenerator-dialog-confirm",function(){let o=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find(".ifList .item"),a="";if($(o.toArray().reverse()).each(function(d,m){let p=$(m).find(".smallNum").val().trim(),v=$(m).find(".largeNum").val().trim(),y=$(m).find(".operator option:selected").val(),k=$(m).find(".operator2 option:selected").val(),b=$(m).find(".compareValue").text(),w=$(m).find(".markText").val().trim();if(w==""&&(w=t.ifGenTipLableTitile+(d+1)),p==""&&v=="")return!0;let x;y=="0"?x=b+">="+p:x=b+">"+p;let C;k=="0"?C=b+"<="+v:C=b+"<"+v;let S;d==0&&v==""?S=x:d==o.length-1&&p==""?S=C:S="and("+x+","+C+")",d==0?a="if("+S+',"'+w+'")':a="if("+S+',"'+w+'",'+a+")"}),a.length==0){e.info(t.ifGenTipNotGenCondition);return}$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide();let s=f.luckysheet_select_save[f.luckysheet_select_save.length-1],u=s.row_focus,h=s.column_focus;Rl(u,h,f.flowdata),$("#luckysheet-rich-text-editor").html("="+a),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),$("#luckysheet-wa-functionbox-confirm").click()}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-model-close-btn",function(){$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-modal-dialog-mask").show()})},ifFormulaDialog:function(e){let n=this,t=Q(),l=t.formula,o=t.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").remove();let a="",s="";if(e){let b=e.split("if(");for(let w=1;w<b.length;w++){let C=b[w].replace("and(","").replace(/\)/g,"").replace(/\"/g,"").split(",");C=n.clearArr(C),a=n.splitTxt(C[0])[0];let S,_,T;C.length==3?(S=n.splitTxt(C[0])[1],_=n.splitTxt(C[1])[2],T=C[2]):(S=n.splitTxt(C[0])[1],_=n.splitTxt(C[0])[2],T=C[1]),s+='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+S+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+a+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+_+'"/><span>'+l.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value="'+T+'"><i class="fa fa-remove" aria-hidden="true"></i></div>'}}let u='<div class="ifAttr"><div class="attrBox"><label for="compareValue"> '+l.ifGenCompareValueTitle+' </label><div class="inpBox"><input id="compareValue" class="formulaInputFocus" value="'+a+'"/><i class="singRange fa fa-table" aria-hidden="true" title="'+l.ifGenSelectCellTitle+'"></i></div></div><div class="attrBox"><label for="smallRange"> '+l.ifGenRangeTitle+' </label><input type="number" id="smallRange" class="formulaInputFocus"/><span class="text"> '+l.ifGenRangeTo+' </span><input type="number" id="largeRange" class="formulaInputFocus"/><div id="rangeAssess"><span> '+l.ifGenRangeEvaluate+' </span><i class="multiRange fa fa-table" aria-hidden="true" title="'+l.ifGenSelectRangeTitle+'"></i></div></div><div class="attrBox"><label for="DivisionMethod"> '+l.ifGenCutWay+' </label><select id="DivisionMethod"><option value="0"> '+l.ifGenCutSame+' </option><option value="1"> '+l.ifGenCutNpiece+' </option><option value="2"> '+l.ifGenCutCustom+' </option></select><input id="DivisionMethodVal" class="formulaInputFocus"/><div id="createBtn"> '+l.ifGenCutSame+' </div></div></div><div class="ifList">'+s+"</div>";$("body").append(_e(dt,{id:"luckysheet-ifFormulaGenerator-dialog",addclass:"luckysheet-ifFormulaGenerator-dialog",title:l.ifGenerate,content:u,botton:'<button id="luckysheet-ifFormulaGenerator-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let h=$("#luckysheet-ifFormulaGenerator-dialog").find(".luckysheet-modal-dialog-content").css("min-width",590).end(),d=h.outerHeight(),m=h.outerWidth(),p=$(window).width(),v=$(window).height(),y=$(document).scrollLeft(),k=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-dialog").css({left:(p+y-m)/2,top:(v+k-d)/3}).show()},clearArr:function(e){for(let n=0;n<e.length;n++)(e[n]==""||e[n]==null||e[n]==null)&&e.splice(n,1);return e},splitTxt:function(e){let n,t,l;if(e.indexOf(">=")!=-1)return n=e.split(">=")[0],t=e.split(">=")[1],[n,t,l];if(e.indexOf(">")!=-1)return n=e.split(">")[0],t=e.split(">")[1],[n,t,l];if(e.indexOf("<=")!=-1)return n=e.split("<=")[0],l=e.split("<=")[1],[n,t,l];if(e.indexOf("<")!=-1)return n=e.split("<")[0],l=e.split("<")[1],[n,t,l]},singleRangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").remove();let n=Q(),t=n.formula,l=n.button;e==null&&(e=""),$("body").append(_e(dt,{id:"luckysheet-ifFormulaGenerator-singleRange-dialog",addclass:"luckysheet-ifFormulaGenerator-singleRange-dialog",title:t.ifGenTipSelectCell,content:'<input readonly="readonly" placeholder="'+t.ifGenTipSelectCellPlace+'" value="'+e+'">',botton:'<button id="luckysheet-ifFormulaGenerator-singleRange-confirm" class="btn btn-primary">'+l.confirm+'</button><button id="luckysheet-ifFormulaGenerator-singleRange-cancel" class="btn btn-default">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-ifFormulaGenerator-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-singleRange-dialog").css({left:(u+d-s)/2,top:(h+m-a)/3}).show()},multiRangeDialog:function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").remove();let e=Q(),n=e.formula,t=e.button;$("body").append(_e(dt,{id:"luckysheet-ifFormulaGenerator-multiRange-dialog",addclass:"luckysheet-ifFormulaGenerator-multiRange-dialog",title:n.ifGenTipSelectRange,content:'<input readonly="readonly" placeholder="'+n.ifGenTipSelectRangePlace+'" value="">',botton:'<button id="luckysheet-ifFormulaGenerator-multiRange-confirm" class="btn btn-primary">'+t.confirm+'</button><button id="luckysheet-ifFormulaGenerator-multiRange-cancel" class="btn btn-default">'+t.cancel+"</button>",style:"z-index:100003"}));let l=$("#luckysheet-ifFormulaGenerator-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),h=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-multiRange-dialog").css({left:(s+h-a)/2,top:(u+d-o)/3}).show()},getIfList:function(e,n,t,l,o){let a=Q().formula;$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty(),n=parseInt(n),t=parseInt(t),o=parseInt(o);let s=[];if(l=="0"){let u=Math.ceil((t-n)/o);for(let h=0;h<=u;h++){let d=n+o*h;h==0||d>=t?s.push(""):s.push(d)}}else if(l=="1"){let u=Math.ceil((t-n)/o);for(let h=0;h<=o;h++){let d=n+u*h;h==0||d>=t?s.push(""):s.push(d)}}for(let u=0;u<s.length-1;u++){let h;u==0?h="\u5C0F\u4E8E"+s[u+1]:u==s.length-2?h="\u5927\u4E8E\u7B49\u4E8E"+s[u]:h=s[u]+"\u5230"+s[u+1];let d='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+s[u]+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+e+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+s[u+1]+'"/><span>'+a.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value="'+h+'"><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(d)}},info:function(e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-info").remove();let t=Q().button;$("body").append(_e(dt,{id:"luckysheet-ifFormulaGenerator-info",addclass:"",title:e,content:"",botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+t.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));let l=$("#luckysheet-ifFormulaGenerator-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),h=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-info").css({left:(s+h-a)/2,top:(u+d-o)/3}).show()}},eo=I0});var R0,cn,zc=Me(()=>{xa();Ut();Nt();Wt();Zt();ht();Ke();kt();R0={init:function(){let e=this,n=Q(),t=n.formulaMore,l=n.button;$(document).off("keyup.fxSFLI").on("keyup.fxSFLI","#searchFormulaListInput",function(){$("#formulaTypeList").empty();let o=$(this).val().toUpperCase(),a=f.functionlist;if(o=="")e.formulaListByType($("#formulaTypeSelect option:selected").val());else for(let s=0;s<a.length;s++)/^[a-zA-Z]+$/.test(o)?a[s].n.indexOf(o)!="-1"&&$('<div class="listBox" name="'+a[s].n+'"><span>'+a[s].n+"</span><span>"+a[s].a+"</span></div>").appendTo($("#formulaTypeList")):a[s].a.indexOf(o)!="-1"&&$('<div class="listBox" name="'+a[s].n+'"><span>'+a[s].n+"</span><span>"+a[s].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")}),$(document).off("change.fxFormulaTS").on("change.fxFormulaTS","#formulaTypeSelect",function(){let o=$("#formulaTypeSelect option:selected").val();e.formulaListByType(o)}),$(document).off("click.fxListbox").on("click.fxListbox","#formulaTypeList .listBox",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.fxFormulaCf").on("click.fxFormulaCf","#luckysheet-search-formula-confirm",function(){let o=$("#luckysheet-search-formula .listBox.on").attr("name"),a='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(a),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),e.formulaParmDialog(o)}),$(document).off("focus.fxParamInput").on("focus.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){let o=$(this).parents(".parmBox").index();g.data_parm_index=o;let a=$(this).parents("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),s=f.luckysheet_function[a].p.length,u,h;o>=s?(u=f.luckysheet_function[a].p[s-1].detail,h=f.luckysheet_function[a].p[s-1].repeat):(u=f.luckysheet_function[a].p[o].detail,h=f.luckysheet_function[a].p[o].repeat),e.parmTxtShow($(this).val()),e.functionStrCompute(),$("#luckysheet-search-formula-parm .parmDetailsBox").empty();let d=$(this).parents(".parmBox").find(".name").text();if($("<span>"+d+":</span><span>"+u+"</span>").appendTo($("#luckysheet-search-formula-parm .parmDetailsBox")),h=="y"){let m=$("#luckysheet-search-formula-parm .parmBox").length;m<5&&o==m-1&&$('<div class="parmBox"><div class="name">'+t.valueTitle+""+(m+1)+'</div><div class="txt"><input class="formulaInputFocus" /><i class="fa fa-table" aria-hidden="true" title="'+t.tipSelectDataRange+'"></i></div><div class="val">=</div></div>').appendTo($("#luckysheet-search-formula-parm .parmListBox"))}}),$(document).off("blur.fxParamInput").on("blur.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){let o=$(this).val();g.getfunctionParam(o).fn==null&&!g.iscelldata(o)&&!B(o)&&o!=""&&o.length<=2&&o.indexOf('"')!=0&&o.lastIndexOf('"')!=0&&(o='"'+o+'"',$(this).val(o),e.parmTxtShow(o),e.functionStrCompute())}),$(document).off("keyup.fxParamInput").on("keyup.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){e.parmTxtShow($(this).val()),e.functionStrCompute()}),$(document).off("click.fxParamI").on("click.fxParamI","#luckysheet-search-formula-parm .parmBox i",function(){g.data_parm_index=$(this).parents(".parmBox").index(),$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm-select").remove(),$(this).parents(".parmBox").find(".txt input").val()==""?$("body").append(_e(dt,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:t.tipSelectDataRange,content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='"+t.tipDataRangeTile+"' readonly='true' placeholder='"+t.tipDataRangeTile+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">'+l.confirm+"</button>",style:"z-index:100003"})):$("body").append(_e(dt,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:t.tipSelectDataRange,content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='"+t.tipDataRangeTile+"' readonly='true' value='"+$(this).parents(".parmBox").find(".txt input").val()+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">'+l.confirm+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-search-formula-parm-select").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-search-formula-parm-select").css({left:(u+d-s)/2,top:(h+m-a)/3}).show(),e.parmTxtShow($(this).parents(".parmBox").find(".txt input").val())}),$(document).off("click.fxParamCf").on("click.fxParamCf","#luckysheet-search-formula-parm-confirm",function(){$("#luckysheet-wa-functionbox-confirm").click()}),$(document).off("click.fxParamSelectCf").on("click.fxParamSelectCf","#luckysheet-search-formula-parm-select-confirm",function(){let o=$("#luckysheet-search-formula-parm-select-input").attr("data_parm_index");$("#luckysheet-search-formula-parm-select").hide(),$("#luckysheet-search-formula-parm").show(),$("#luckysheet-search-formula-parm .parmBox").eq(o).find(".txt input").focus()})},formulaListDialog:function(){let e=this,n=Q(),t=n.formulaMore,l=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-search-formula").remove(),$("body").append(_e(dt,{id:"luckysheet-search-formula",addclass:"luckysheet-search-formula",title:"",content:"<div class='inpbox'><label for='searchFormulaListInput'>"+t.findFunctionTitle+"\uFF1A</label><input class='formulaInputFocus' id='searchFormulaListInput' placeholder='"+t.tipInputFunctionName+"' spellcheck='false'/></div><div class='selbox'><label>"+t.selectCategory+"\uFF1A</label><select id='formulaTypeSelect'><option value='0'>"+t.Math+"</option><option value='1'>"+t.Statistical+"</option><option value='2'>"+t.Lookup+"</option><option value='3'>"+t.luckysheet+"</option><option value='4'>"+t.dataMining+"</option><option value='5'>"+t.Database+"</option><option value='6'>"+t.Date+"</option><option value='7'>"+t.Filter+"</option><option value='8'>"+t.Financial+"</option><option value='9'>"+t.Engineering+"</option><option value='10'>"+t.Logical+"</option><option value='11'>"+t.Operator+"</option><option value='12'>"+t.Text+"</option><option value='13'>"+t.Parser+"</option><option value='14'>"+t.Array+"</option><option value='-1'>"+t.other+"</option></select></div><div class='listbox'><label>"+t.selectFunctionTitle+"\uFF1A</label><div id='formulaTypeList'></div></div>",botton:'<button id="luckysheet-search-formula-confirm" class="btn btn-primary">'+l.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-search-formula").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-search-formula").css({left:(u+d-s)/2,top:(h+m-a)/3,"user-select":"none"}).show(),e.formulaListByType("0"),$("#searchFormulaListInput").focus()},formulaListByType:function(e){$("#formulaTypeList").empty();let n=f.functionlist;for(let t=0;t<n.length;t++)(e=="-1"&&n[t].t>14||n[t].t==e)&&$('<div class="listBox" name="'+n[t].n+'"><span>'+n[t].n+"</span><span>"+n[t].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")},formulaParmDialog:function(e,n){let t="",l="",o="",a=Q(),s=a.formulaMore,u=a.button,h=f.functionlist;for(let w=0;w<h.length;w++)if(h[w].n==e.toUpperCase()){t=h[w].n;for(let x=0;x<h[w].p.length;x++)n==null?o+='<div class="parmBox"><div class="name">'+h[w].p[x].name+'</div><div class="txt"><input class="formulaInputFocus" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="'+s.tipSelectDataRange+'"></i></div><div class="val">=</div></div>':(n[x]==null&&(n[x]=""),o+='<div class="parmBox"><div class="name">'+h[w].p[x].name+'</div><div class="txt"><input class="formulaInputFocus" value="'+n[x]+'" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="'+s.tipSelectDataRange+'"></i></div><div class="val">=</div></div>');l='<div><div class="parmListBox">'+o+'</div><div class="formulaDetails">'+h[w].d+'</div><div class="parmDetailsBox"></div><div class="result">'+s.calculationResult+" = <span></span></div></div>"}$("#luckysheet-search-formula").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm").remove(),$("body").append(_e(dt,{id:"luckysheet-search-formula-parm",addclass:"luckysheet-search-formula-parm",title:t,content:l,botton:'<button id="luckysheet-search-formula-parm-confirm" class="btn btn-primary">'+u.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+u.cancel+"</button>",style:"z-index:100003"}));let d=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),m=d.outerHeight(),p=d.outerWidth(),v=$(window).width(),y=$(window).height(),k=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-search-formula-parm").css({left:(v+k-p)/2,top:(y+b-m)/3}).show(),$("#luckysheet-search-formula-parm .parmBox:eq(0) input").focus(),$("#luckysheet-search-formula-parm .parmBox").each(function(w,x){let C=$(x).find(".txt input").val();if(g.getfunctionParam(C).fn==null)if(g.iscelldata(C)){let S=Fr(C).data;if(N(S)=="array"){let _=[];for(let T=0;T<S.length;T++)for(let F=0;F<S[T].length;F++){let R=S[T][F];R==null||me(R.v)?_.push(null):_.push(R.v)}$("#luckysheet-search-formula-parm .parmBox").eq(w).find(".val").text(" = {"+_.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(w).find(".val").text(" = {"+S.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(w).find(".val").text(" = {"+C+"}");else $("#luckysheet-search-formula-parm .parmBox").eq(w).find(".val").text(" = {"+new Function("return "+$.trim(g.functionParserExe("="+C)))()+"}")}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),g.data_parm_index=0,g.rangestart=!0},parmTxtShow:function(e){if(g.getfunctionParam(e).fn==null)if(g.iscelldata(e)){let n=g.getcellrange(e),t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1],s=f.visibledatarow[l],u=t-1==-1?0:f.visibledatarow[t-1],h=f.visibledatacolumn[a],d=o-1==-1?0:f.visibledatacolumn[o-1];$("#luckysheet-formula-functionrange-select").css({left:d,width:h-d-1,top:u,height:s-u-1}).show(),$("#luckysheet-formula-help-c").hide(),or(d,u,h-d-1,s-u-1,n.row,n.column);let m=Fr(e).data;if(N(m)=="array"){let p=[];for(let v=0;v<m.length;v++)for(let y=0;y<m[v].length;y++){let k=m[v][y];k==null||me(k.v)?p.push(null):p.push(k.v)}$("#luckysheet-search-formula-parm .parmBox").eq(g.data_parm_index).find(".val").text(" = {"+p.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(g.data_parm_index).find(".val").text(" = {"+m.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(g.data_parm_index).find(".val").text(" = {"+e+"}"),$("#luckysheet-formula-functionrange-select").hide();else{let n;for(let p=0;p<g.getfunctionParam(e).param.length;p++)if(g.iscelldata(g.getfunctionParam(e).param[p])){n=g.getfunctionParam(e).param[p];break}let t=g.getcellrange(n),l=t.row[0],o=t.row[1],a=t.column[0],s=t.column[1],u=f.visibledatarow[o],h=l-1==-1?0:f.visibledatarow[l-1],d=f.visibledatacolumn[s],m=a-1==-1?0:f.visibledatacolumn[a-1];$("#luckysheet-formula-functionrange-select").css({left:m,width:d-m-1,top:h,height:u-h-1}).show(),$("#luckysheet-formula-help-c").hide(),or(m,h,d-m-1,u-h-1,t.row,t.column),$("#luckysheet-search-formula-parm .parmBox").eq(g.data_parm_index).find(".val").text(" = {"+new Function("return "+$.trim(g.functionParserExe("="+e)))()+"}")}},functionStrCompute:function(){let e=!0,n=[],t=-1,l=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),o=f.luckysheet_function[l].p;$("#luckysheet-search-formula-parm .parmBox").each(function(u,h){let d=$(h).find(".txt input").val(),m;u<o.length?m=o[u].require:m=o[o.length-1].require,d==""&&m=="m"&&(e=!1),d!=""&&(t=u)});let a;if(t==-1)a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(t==0)a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(let u=0;u<=t;u++)n.push($("#luckysheet-search-formula-parm .parmBox").eq(u).find(".txt input").val());a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+n.join(",")+")"}let s=g.functionHTMLGenerate(a);if($("#luckysheet-rich-text-editor").html(s),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),e){let u=$.trim(g.functionParserExe($("#luckysheet-rich-text-editor").text())),h=null;try{h=new Function("return "+u)()}catch(d){h=g.error.n}$("#luckysheet-search-formula-parm .result span").text(h)}}},cn=R0});var F0,be,ol=Me(()=>{Zt();Wt();xl();Md();Ei();mr();Qt();Nr();Hl();Br();yn();Mc();Pd();Ac();ki();zc();dl();Wr();Nt();ll();Jt();Fl();Yt();ui();Ut();Zl();Lr();dr();$r();Kt();Ni();dn();Et();Zn();mn();ht();Ml();Ke();kt();yi();F0={menu:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton ${subclass} luckysheet-mousedown-cancel" id="luckysheet-icon-${id}-menuButton">${item}</div>',item:'<div itemvalue="${value}" itemname="${name}" class="luckysheet-cols-menuitem ${sub} luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 0px 3px 1px;"><span style="margin-right:3px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span> ${name} <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel ${iconClass}" style="user-select: none;">${example}</span></div></div>',split:'<div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>',color:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel luckysheet-menuButton ${sub}" id="${id}"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-color-reset"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${resetColor}</div></div> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> ${coloritem}</div>',coloritem:'<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel ${class}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${name}</div></div>',subcolor:'<div id="luckysheet-icon-${id}-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-menuButton-sub luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div></div>',rightclickmenu:null,submenuhide:{},focus:function(e,n){e.attr("id")=="luckysheet-icon-font-family-menuButton"&&Nn(n).num&&(n=Q().fontarray[parseInt(n)],n==null&&(n=this.defualtFont[itemvalue])),e.find(".luckysheet-cols-menuitem").find("span.icon").html(""),n==null?e.find(".luckysheet-cols-menuitem").eq(0).find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'):e.find(".luckysheet-cols-menuitem[itemvalue='"+n+"']").find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')},createButtonMenu:function(e){let n="",t=this;for(let l=0;l<e.length;l++){let o=e[l];o.value=="split"?n+=t.split:o.example=="more"?n+=_e(t.item,{value:o.value,name:o.text,example:"",sub:"luckysheet-cols-submenu",iconClass:"iconfont luckysheet-iconfont-youjiantou"}):n+=_e(t.item,{value:o.value,name:o.text,example:o.example,sub:"",iconClass:""})}return n},cancelPaintModel:function(){let e=this;$("#luckysheet-sheettable_0").removeClass("luckysheetPaintCursor"),f.luckysheet_copy_save.dataSheetIndex==f.currentSheetIndex?(f.luckysheet_selection_range=[],Pt()):f.luckysheetfile[Z(f.luckysheet_copy_save.dataSheetIndex)].luckysheet_selection_range=[],f.luckysheet_copy_save={},e.luckysheetPaintModelOn=!1,$("#luckysheetpopover").fadeOut(200,function(){$("#luckysheetpopover").remove()})},luckysheetPaintModelOn:!1,luckysheetPaintSingle:!1,initialMenuButton:function(){let e=this;$("#luckysheet-icon-paintformat").click(function(t){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}t.stopPropagation();let l=Q(),o=l.paint;if(f.luckysheet_select_save==null||f.luckysheet_select_save.length==0){he()?alert(o.tipSelectRange):W.info("",o.tipSelectRange);return}else if(f.luckysheet_select_save.length>1){he()?alert(o.tipNotMulti):W.info("",o.tipNotMulti);return}let a=!1,s=f.luckysheet_select_save[0].row[0],u=f.luckysheet_select_save[0].row[1],h=f.luckysheet_select_save[0].column[0],d=f.luckysheet_select_save[0].column[1];if(a=Dt(f.config,s,u,h,d),a){W.info(l.merge.partiallyError,"");return}W.popover("<i class='fa fa-paint-brush'></i> "+o.start+"","topCenter",!0,null,o.end,function(){e.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),f.luckysheet_selection_range=[{row:f.luckysheet_select_save[0].row,column:f.luckysheet_select_save[0].column}],Pt();let m=!1,p=!1;for(let v=f.luckysheet_select_save[0].row[0];v<=f.luckysheet_select_save[0].row[1];v++)if(!(f.config.rowhidden!=null&&f.config.rowhidden[v]!=null)){f.config.rowlen!=null&&v in f.config.rowlen&&(m=!0);for(let y=f.luckysheet_select_save[0].column[0];y<=f.luckysheet_select_save[0].column[1];y++){let k=f.flowdata[v][y];N(k)=="object"&&"mc"in k&&k.mc.rs!=null&&(p=!0)}}f.luckysheet_copy_save={dataSheetIndex:f.currentSheetIndex,copyRange:[{row:f.luckysheet_select_save[0].row,column:f.luckysheet_select_save[0].column}],RowlChange:m,HasMC:p},e.luckysheetPaintModelOn=!0,e.luckysheetPaintSingle=!0}),$("#luckysheet-icon-paintformat").dblclick(function(){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}let l=Q().paint;if(f.luckysheet_select_save==null||f.luckysheet_select_save.length==0){he()?alert(l.tipSelectRange):W.info("",l.tipSelectRange);return}else if(f.luckysheet_select_save.length>1){he()?alert(l.tipNotMulti):W.info("",l.tipNotMulti);return}W.popover("<i class='fa fa-paint-brush'></i> "+l.start,"topCenter",!0,null,l.end,function(){e.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),f.luckysheet_selection_range=[{row:f.luckysheet_select_save[0].row,column:f.luckysheet_select_save[0].column}],Pt();let o=!1,a=!1;for(let s=f.luckysheet_select_save[0].row[0];s<=f.luckysheet_select_save[0].row[1];s++)if(!(f.config.rowhidden!=null&&f.config.rowhidden[s]!=null)){f.config.rowlen!=null&&s in f.config.rowlen&&(o=!0);for(let u=f.luckysheet_select_save[0].column[0];u<=f.luckysheet_select_save[0].column[1];u++){let h=f.flowdata[s][u];N(h)=="object"&&"mc"in h&&h.mc.rs!=null&&(a=!0)}}f.luckysheet_copy_save={dataSheetIndex:f.currentSheetIndex,copyRange:[{row:f.luckysheet_select_save[0].row,column:f.luckysheet_select_save[0].column}],RowlChange:o,HasMC:a},e.luckysheetPaintModelOn=!0,e.luckysheetPaintSingle=!1}),$("#luckysheet-icon-currency").click(function(){let t=xe.deepCopyFlowData(f.flowdata);e.updateFormat(t,"ct","\xA5 #.00")}),$("#luckysheet-icon-percent").click(function(){let t=xe.deepCopyFlowData(f.flowdata);e.updateFormat(t,"ct","0.00%")}),$("#luckysheet-icon-fmt-decimal-decrease").click(function(){let t=xe.deepCopyFlowData(f.flowdata),l=f.luckysheet_select_save[0].row_focus,o=f.luckysheet_select_save[0].column_focus,a=e.checkstatus(t,l,o,"ct"),s=t[l][o];if(a==null||a.t!="n")return;if(a.fa=="General"&&(a=nt(s.v)[1]),/^(w|W)((0?)|(0\.0+))$/.test(a.fa)){a.fa.indexOf(".")>-1?a.fa.substr(-2)==".0"?e.updateFormat(t,"ct",a.fa.split(".")[0]):e.updateFormat(t,"ct",a.fa.substr(0,a.fa.length-1)):e.updateFormat(t,"ct",a.fa);return}let h="",d="",m=[];if(a.fa.indexOf(".")>-1)m=a.fa.split("."),h=m[0],d=m[1];else return;m=d.split("");let p="";for(let y=m.length-1;y>=0;y--){let k=m[y];if(k!="#"&&k!="0"&&k!=","&&isNaN(parseInt(k)))p=k+p;else break}let v="";if(a.fa.indexOf(".")>-1){let y=d;p.length>0&&(y=d.replace(p,""));let k=y.replace(/#/g,"0");k=k.substr(0,k.length-1),k==""?v=h+p:v=h+"."+k+p}e.updateFormat(t,"ct",v)}),$("#luckysheet-icon-fmt-decimal-increase").click(function(){let t=xe.deepCopyFlowData(f.flowdata),l=f.luckysheet_select_save[0].row_focus,o=f.luckysheet_select_save[0].column_focus,a=e.checkstatus(t,l,o,"ct"),s=t[l][o];if(a==null||a.t!="n")return;if(a.fa=="General"&&(a=nt(s.v)[1]),a.fa=="General"){e.updateFormat(t,"ct","#.0");return}if(/^(w|W)((0?)|(0\.0+))$/.test(a.fa)){a.fa.indexOf(".")>-1?e.updateFormat(t,"ct",a.fa+"0"):a.fa.substr(-1)=="0"?e.updateFormat(t,"ct",a.fa+".0"):e.updateFormat(t,"ct",a.fa+"0.0");return}let h="",d="",m=[];a.fa.indexOf(".")>-1?(m=a.fa.split("."),h=m[0],d=m[1]):d=a.fa,m=d.split("");let p="";for(let y=m.length-1;y>=0;y--){let k=m[y];if(k!="#"&&k!="0"&&k!=","&&isNaN(parseInt(k)))p=k+p;else break}let v="";if(a.fa.indexOf(".")>-1){let y=d;p.length>0&&(y=d.replace(p,""));let k=y.replace(/#/g,"0");k+="0",v=h+"."+k+p}else p.length>0?v=d.replace(p,"")+".0"+p:v=d+".0"+p;e.updateFormat(t,"ct",v)}),$("#luckysheet-icon-fmt-other").click(function(){let t=Q(),l=t.format,o=t.defaultFmt,a=$(this).attr("id")+"-menuButton",s=$("#"+a);if(s.length==0){let m=o,p=e.createButtonMenu(m),v=_e(e.menu,{id:"fmt-other",item:p,subclass:"",sub:""}),y=[{text:l.moreCurrency+"...",value:"morecurrency",example:""},{text:l.moreDateTime+"...",value:"moredatetime",example:""},{text:l.moreNumber+"...",value:"moredigit",example:""}],k=e.createButtonMenu(y),b=_e(e.menu,{id:"fmtOtherSelf",item:k,subclass:"luckysheet-menuButton-sub"});$("body").append(v+b),s=$("#"+a).width(250),e.focus(s),s.find(".luckysheet-cols-menuitem").click(function(){s.hide(),rt();let w=$(this),x=w.attr("itemvalue"),C=w.attr("itemname");if($("#luckysheet-icon-fmt-other").find(".luckysheet-toolbar-menu-button-caption").html(" "+C+" "),x=="fmtOtherSelf")return;let S=xe.deepCopyFlowData(f.flowdata);e.focus(s,x),e.updateFormat(S,"ct",x)}),$("#luckysheet-icon-fmtOtherSelf-menuButton").find(".luckysheet-cols-menuitem").click(function(){s.hide(),$("#luckysheet-icon-fmtOtherSelf-menuButton").hide(),rt();let w=$(this).attr("itemvalue");Dc.createDialog(w),Dc.init()})}else{let m=$(this).find(".luckysheet-toolbar-menu-button-caption").text().trim(),p=o.find(v=>v.text===m);p&&e.focus(s,p.value)}let u=$(this).outerWidth(),h=s.outerWidth(),d=$(this).offset().left;h>u&&h+d>$("#"+f.container).width()&&(d=d-h+u),ml(s,d,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-font-family").mousedown(function(t){xr(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=e.createButtonMenu(e.fontSelectList),h=_e(e.menu,{id:"font-family",item:u,subclass:"",sub:""});$("body").append(h),l=$("#"+t).width(200),e.focus(l),l.on("click",".luckysheet-cols-menuitem",function(){l.hide(),rt();let d=$(this),m=d.attr("itemvalue"),p=d.attr("itemname");e.focus(l,m),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+p+" ");let v=xe.deepCopyFlowData(f.flowdata);e.updateFormat(v,"ff",m)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o),ml(l,s,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-text-color").mousedown(function(t){xr(t),t.stopPropagation()}).click(function(){let t=xe.deepCopyFlowData(f.flowdata),l=$(this).attr("color");l==null&&(l="#000000"),e.updateFormat(t,"fc",l)}),$("#luckysheet-icon-text-color-menu").mousedown(function(t){xr(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let h=Q(),d=h.toolbar,m=h.button,p=h.alternatingColors,v=[{name:d.alternatingColors+"...",id:"luckysheet-color-alternate",example:""}],y=e.createButtonMenu(v),k="text-color-self",b=_e(e.coloritem,{class:"luckysheet-icon-alternateformat",name:d.alternatingColors+"..."}),w=_e(e.color,{id:t,coloritem:b,colorself:k,sub:"",resetColor:d.resetColor});$("body").append(w),l=$("#"+t),$("#"+t).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:m.cancel,chooseText:m.confirm,togglePaletteMoreText:d.customColor,togglePaletteLessText:d.collapse,togglePaletteOnly:!0,clearText:d.clearText,color:de.defaultTextColor,noColorSelectedText:d.noColorSelectedText,localStorageKey:"spectrum.textcolor"+ne.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(x){let C=$(this);x!=null?x=x.toHexString():x="#000";let S=null;$("#luckysheet-icon-text-color .text-color-bar").css("background-color",x),$("#luckysheet-icon-text-color").attr("color",x);let _=xe.deepCopyFlowData(f.flowdata);e.updateFormat(_,"fc",x),l.hide(),rt()}}),l.find(".luckysheet-color-reset").click(function(){l.hide(),rt();let x=$("#"+t).find(".luckysheet-color-selected");x.val("#000000"),$("#luckysheet-icon-text-color").attr("color",null),x.spectrum("set","#000000"),$("#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#000000");let C=xe.deepCopyFlowData(f.flowdata);e.updateFormat(C,"fc",null)}),l.find(".luckysheet-icon-alternateformat").click(function(){if(l.hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(p.errorInfo):W.info(p.errorInfo,"");return}let x=$.extend(!0,{},f.luckysheet_select_save[0]);el.rangeIsExists(x)[0]||(el.modelfocusIndex=0,el.new(x)),el.init(),el.perfect()})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o);let u=$(this).offset().top+26;setTimeout(function(){let h=$("#"+t).find(".luckysheet-color-selected");h.spectrum("set",h.val()),ml(l,s-28,u,"lefttop")},1)}),$("#luckysheet-icon-cell-color").click(function(){let t=xe.deepCopyFlowData(f.flowdata),l=$(this).attr("color");l==null&&(l="#ffffff"),e.updateFormat(t,"bg",l)}),$("#luckysheet-icon-cell-color-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let h="cell-color-self",d=Q(),m=d.toolbar,p=d.button,v=d.alternatingColors,y=_e(e.coloritem,{class:"luckysheet-icon-alternateformat",name:m.alternatingColors+"..."}),k=_e(e.color,{id:t,coloritem:y,colorself:h,sub:"",resetColor:m.resetColor});$("body").append(k),l=$("#"+t),$("#"+t).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:de.defaultCellColor,cancelText:p.cancel,chooseText:p.confirm,togglePaletteMoreText:m.customColor,togglePaletteLessText:m.collapse,togglePaletteOnly:!0,clearText:m.clearText,noColorSelectedText:m.noColorSelectedText,localStorageKey:"spectrum.bgcolor"+ne.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(b){let w=$(this);b!=null?b=b.toHexString():b="#fff";let x=null;$("#luckysheet-icon-cell-color .text-color-bar").css("background-color",b),$("#luckysheet-icon-cell-color").attr("color",b);let C=xe.deepCopyFlowData(f.flowdata);e.updateFormat(C,"bg",b),l.hide(),rt()}}),l.find(".luckysheet-color-reset").click(function(){l.hide(),rt();let b=$("#"+t).find(".luckysheet-color-selected");b.val("#ffffff"),$("#luckysheet-icon-cell-color").attr("color",null),b.spectrum("set","#ffffff"),$("#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#ffffff");let w=xe.deepCopyFlowData(f.flowdata);e.updateFormat(w,"bg",null)}),l.find(".luckysheet-icon-alternateformat").click(function(){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}if(l.hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(v.errorInfo):W.info(v.errorInfo,"");return}let b=$.extend(!0,{},f.luckysheet_select_save[0]);el.rangeIsExists(b)[0]||(el.modelfocusIndex=0,el.new(b)),el.init(),el.perfect()}),$("#"+t).find(".luckysheet-color-selected").val("#fff")}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o);let u=$(this).offset().top+26;setTimeout(function(){let h=$("#"+t).find(".luckysheet-color-selected");h.spectrum("set",h.val()),ml(l,s-28,u,"lefttop")},1)});let n=null;$("#luckysheet-icon-font-size").mousedown(function(t){if(parseInt($("#luckysheet-input-box").css("top"))>0){let l=window.getSelection();if(l.type!="None"){let o=l.getRangeAt(0);o.collapsed||(f.inlineStringEditRange=o.cloneRange())}}xr(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let h=[{text:"9",value:"9",example:""},{text:"10",value:"10",example:""},{text:"11",value:"11",example:""},{text:"12",value:"12",example:""},{text:"14",value:"14",example:""},{text:"16",value:"16",example:""},{text:"18",value:"18",example:""},{text:"20",value:"20",example:""},{text:"22",value:"22",example:""},{text:"24",value:"24",example:""},{text:"26",value:"26",example:""},{text:"28",value:"28",example:""},{text:"36",value:"36",example:""},{text:"48",value:"48",example:""},{text:"72",value:"72",example:""}],d=e.createButtonMenu(h),m=_e(e.menu,{id:"font-size",item:d,subclass:"",sub:""});$("body").append(m),l=$("#"+t).width(150),e.focus(l,10),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let p=$(this),v=p.attr("itemvalue"),y=$("#luckysheet-icon-font-size input");$("#luckysheet-icon-font-size").attr("itemvalue",v),e.focus(l,v),y.val(v);let k=xe.deepCopyFlowData(f.flowdata);e.updateFormat(k,"fs",v),clearTimeout(n)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$("#luckysheet-icon-font-size").attr("itemvalue");s==null&&(s=10),e.focus(l,s);let u=$(this).offset().left;a>o&&a+u>$("#"+f.container).width()&&(u=u-a+o),ml(l,u,$(this).offset().top+25,"lefttop")}).find("input.luckysheet-toolbar-textinput").keydown(function(t){xr(t),t.stopPropagation()}).keyup(function(t){if(t.keyCode!=13)return;let l=$(this),o=parseInt(l.val()),a=$("#luckysheet-icon-font-size-menuButton");e.focus(a,o);let s=xe.deepCopyFlowData(f.flowdata);e.updateFormat(s,"fs",o),n=setTimeout(function(){a.hide(),l.blur()},200)}),$("#luckysheet-icon-border-all").click(function(){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}if(!Sr(f.currentSheetIndex))return;let t=xe.deepCopyFlowData(f.flowdata),l=$(this).attr("type");l==null&&(l="border-all");let o="luckysheet-icon-borderColor-menuButton",a=$("#"+o).find(".luckysheet-color-selected").val(),s=$("#luckysheetborderSizepreview").attr("itemvalue");(a==null||a=="")&&(a="#000"),(s==null||s=="")&&(s="1");let u=$.extend(!0,{},f.config);u.borderInfo==null&&(u.borderInfo=[]);let h={rangeType:"range",borderType:l,color:a,style:s,range:$.extend(!0,[],f.luckysheet_select_save)};if(u.borderInfo.push(h),f.clearjfundo){f.jfundo.length=0;let d=[];d.type="borderChange",d.config=$.extend(!0,{},f.config),d.curconfig=$.extend(!0,{},u),d.sheetIndex=f.currentSheetIndex,f.jfredo.push(d)}ne.saveParam("cg",f.currentSheetIndex,u.borderInfo,{k:"borderInfo"}),f.config=u,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,setTimeout(function(){Be()},1)}),$("#luckysheet-icon-border-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=10,h=120,d=Q(),m=d.border,p=d.toolbar,v=d.button,y=[{text:m.borderTop,value:"border-top",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-top iconfont luckysheet-iconfont-shangbiankuang" style="user-select: none;"> </div> </div>'},{text:m.borderBottom,value:"border-bottom",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-bottom iconfont luckysheet-iconfont-xiabiankuang" style="user-select: none;"> </div> </div>'},{text:m.borderLeft,value:"border-left",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-left iconfont luckysheet-iconfont-zuobiankuang" style="user-select: none;"> </div> </div>'},{text:m.borderRight,value:"border-right",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-right iconfont luckysheet-iconfont-youbiankuang" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:m.borderNone,value:"border-none",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-none iconfont luckysheet-iconfont-wubiankuang" style="user-select: none;"> </div> </div>'},{text:m.borderAll,value:"border-all",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang" style="user-select: none;"> </div> </div>'},{text:m.borderOutside,value:"border-outside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-outside iconfont luckysheet-iconfont-sizhoujiabiankuang" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:m.borderInside,value:"border-inside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-inside iconfont luckysheet-iconfont-neikuangxian" style="user-select: none;"> </div> </div>'},{text:m.borderHorizontal,value:"border-horizontal",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-horizontal iconfont luckysheet-iconfont-neikuanghengxian" style="user-select: none;"> </div> </div>'},{text:m.borderVertical,value:"border-vertical",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-vertical iconfont luckysheet-iconfont-neikuangshuxian" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"<span id='luckysheet-icon-borderColor-linecolor' class='luckysheet-mousedown-cancel' style='border-bottom:3px solid #000;'>"+m.borderColor+"</span>",value:"borderColor",example:"more"},{text:""+m.borderSize+"<img id='luckysheetborderSizepreview' width=100 height=10 src='data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' style='position:absolute;bottom:-5px;right:0px;width:100px;height:10px;'>",value:"borderSize",example:"more"}],k=Jr.border,b=e.createButtonMenu(y),w=_e(e.menu,{id:"border-menu",item:b,subclass:"",sub:""}),x=[{text:m.borderNone,value:"0",example:""},{text:"<canvas type='Thin' class='border-Thin' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"1",example:""},{text:"<canvas type='Hair' class='border-Hair' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"2",example:""},{text:"<canvas type='Dotted' class='border-Dotted' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"3",example:""},{text:"<canvas type='Dashed' class='border-Dashed' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"4",example:""},{text:"<canvas type='DashDot' class='border-DashDot' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"5",example:""},{text:"<canvas type='DashDotDot' class='border-DashDotDot' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"6",example:""},{text:"<canvas type='Medium' class='border-Medium' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"8",example:""},{text:"<canvas type='MediumDashed' class='border-MediumDashed' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"9",example:""},{text:"<canvas type='MediumDashDot' class='border-MediumDashDot' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"10",example:""},{text:"<canvas type='MediumDashDotDot' class='border-MediumDashDotDot' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"11",example:""},{text:"<canvas type='Thick' class='border-Thick' width="+h+" height="+u+" style='width:"+h+"px;height:"+u+"px;position:static;'></canvas>",value:"13",example:""}],C=e.createButtonMenu(x),S=_e(e.menu,{id:"borderSize",item:C,subclass:"luckysheet-menuButton-sub"}),_="luckysheet-icon-borderSize-menuButton",T="luckysheet-icon-borderColor-menuButton",F=_e(e.color,{id:T,coloritem:"",colorself:"",sub:"luckysheet-menuButton-sub",resetColor:p.resetColor});$("body").append(w+F+S),l=$("#"+t).width(170),e.focus(l,"border-all"),$("#"+_+" canvas").each(function(R){let I=$(this).attr("type"),P=$(this).closest(".luckysheet-cols-menuitem").attr("itemvalue"),O=$(this).addClass("luckysheet-mousedown-cancel").get(0).getContext("2d");O.translate(.5,.5),e.setLineDash(O,P,"h",0,5,100,5),O.strokeStyle="#000000",O.stroke(),O.closePath()}),$("#"+_+" .luckysheet-cols-menuitem").click(function(){$("#"+_).hide();let R=$(this),I=R.attr("itemvalue");if(I==0)$("#luckysheetborderSizepreview").attr("src","data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==").attr("itemvalue",null);else{let P=R.find("canvas").get(0).toDataURL("image/png");$("#luckysheetborderSizepreview").attr("src",P).attr("itemvalue",I)}e.focus($("#"+_),I)}),l.find(".luckysheet-cols-menuitem").click(function(){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}l.hide(),rt();let R=$(this),I=R.attr("itemvalue");if(I=="borderColor"||I=="borderSize"||!Sr(f.currentSheetIndex))return;let P=xe.deepCopyFlowData(f.flowdata),O=$("#"+T).find(".luckysheet-color-selected").val(),M=$("#luckysheetborderSizepreview").attr("itemvalue");(O==null||O=="")&&(O="#000"),(M==null||M=="")&&(M="1");let A=$.extend(!0,{},f.config);A.borderInfo==null&&(A.borderInfo=[]);let z={rangeType:"range",borderType:I,color:O,style:M,range:$.extend(!0,[],f.luckysheet_select_save)};if(A.borderInfo.push(z),f.clearjfundo){f.jfundo.length=0;let E=[];E.type="borderChange",E.config=$.extend(!0,{},f.config),E.curconfig=$.extend(!0,{},A),E.sheetIndex=f.currentSheetIndex,f.jfredo.push(E)}ne.saveParam("cg",f.currentSheetIndex,A.borderInfo,{k:"borderInfo"}),f.config=A,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,setTimeout(function(){Be()},1),$("#luckysheet-icon-border-all").attr("type",I),$("#luckysheet-icon-border-all").find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-"+I+k[I]),e.focus(l,I)}),$("#"+T).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:"#000",cancelText:v.cancel,chooseText:v.confirm,togglePaletteMoreText:p.customColor,togglePaletteLessText:p.collapse,togglePaletteOnly:!0,clearText:p.clearText,noColorSelectedText:p.noColorSelectedText,localStorageKey:"spectrum.bordercolor"+ne.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(R){let I=$(this);R!=null?R=R.toHexString():R="#000";let P=null;$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color",R),$("#"+T).find(".luckysheet-color-selected").val(R)}}),$("#"+T).find(".luckysheet-color-reset").click(function(){let R=$("#"+T).find(".luckysheet-color-selected");R.val("#000"),$("#luckysheet-icon-cell-color").attr("color",null),R.spectrum("set","#000"),$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color","#000")})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o),ml(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-merge-button").click(function(){let l=Q().merge;if(!jr(f.currentSheetIndex))return;if(Yr()){he()?alert(l.overlappingError):W.info(l.overlappingError,"");return}if(f.config.merge!=null){let a=!1;for(let s=0;s<f.luckysheet_select_save.length;s++){let u=f.luckysheet_select_save[s].row[0],h=f.luckysheet_select_save[s].row[1],d=f.luckysheet_select_save[s].column[0],m=f.luckysheet_select_save[s].column[1];if(a=Dt(f.config,u,h,d,m),a)break}if(a){he()?alert(l.partiallyError):W.info(l.partiallyError,"");return}}let o=xe.deepCopyFlowData(f.flowdata);e.updateFormat_mc(o,"mergeAll")}),$("#luckysheet-icon-merge-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let h=Q().merge,d=[{text:h.mergeAll,value:"mergeAll",example:""},{text:h.mergeV,value:"mergeV",example:""},{text:h.mergeH,value:"mergeH",example:""},{text:h.mergeCancel,value:"mergeCancel",example:""}],m=e.createButtonMenu(d),p=_e(e.menu,{id:"merge-menu",item:m,subclass:"",sub:""});$("body").append(p),l=$("#"+t),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){if(l.hide(),rt(),Yr()){he()?alert(h.overlappingError):W.info(h.overlappingError,"");return}if(f.config.merge!=null){let b=!1;for(let w=0;w<f.luckysheet_select_save.length;w++){let x=f.luckysheet_select_save[w].row[0],C=f.luckysheet_select_save[w].row[1],S=f.luckysheet_select_save[w].column[0],_=f.luckysheet_select_save[w].column[1];if(b=Dt(f.config,x,C,S,_),b)break}if(b){he()?alert(h.partiallyError):W.info(h.partiallyError,"");return}}let v=$(this),y=v.attr("itemvalue");e.focus(l,y);let k=xe.deepCopyFlowData(f.flowdata);e.updateFormat_mc(k,y)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o),ml(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-align").click(function(){let t=$("#luckysheet-icon-align").attr("type");t==null&&(t="left");let l=xe.deepCopyFlowData(f.flowdata);e.updateFormat(l,"ht",t)}),$("#luckysheet-icon-align-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let h=Q().align,d=[{text:h.left,value:"left",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi" style="user-select: none;"> </div> </div>'},{text:h.center,value:"center",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-center iconfont luckysheet-iconfont-wenbenjuzhongduiqi" style="user-select: none;"> </div> </div>'},{text:h.right,value:"right",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-right iconfont luckysheet-iconfont-wenbenyouduiqi" style="user-select: none;"> </div> </div>'}],m=Jr.align,p=e.createButtonMenu(d),v=_e(e.menu,{id:"align-menu",item:p,subclass:"",sub:""});$("body").append(v),l=$("#"+t).width(120),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let y=$(this),k=y.attr("itemvalue");e.focus(l,k),$("#luckysheet-icon-align").attr("type",k).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+k+m[k]);let w=xe.deepCopyFlowData(f.flowdata);e.updateFormat(w,"ht",k)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o),ml(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-valign").click(function(){let t=$("#luckysheet-icon-valign").attr("type");t==null&&(t="bottom");let l=xe.deepCopyFlowData(f.flowdata);e.updateFormat(l,"vt",t)}),$("#luckysheet-icon-valign-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Q().align;if(l.length==0){let d=[{text:a.top,value:"top",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-top iconfont luckysheet-iconfont-dingbuduiqi" style="user-select: none;"> </div> </div>'},{text:a.middle,value:"middle",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-middle iconfont luckysheet-iconfont-shuipingduiqi" style="user-select: none;"> </div> </div>'},{text:a.bottom,value:"bottom",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi" style="user-select: none;"> </div> </div>'}],m=Jr.align,p=e.createButtonMenu(d),v=_e(e.menu,{id:"valign-menu",item:p,subclass:"",sub:""});$("body").append(v),l=$("#"+t).width(120),e.focus(l,"bottom"),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let y=$(this),k=y.attr("itemvalue");e.focus(l,k),$("#luckysheet-icon-valign").attr("type",k).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+k+m[k]);let w=xe.deepCopyFlowData(f.flowdata);e.updateFormat(w,"vt",k)})}let s=$(this).outerWidth(),u=l.outerWidth(),h=$(this).offset().left;u>s&&u+h>$("#"+f.container).width()&&(h=h-u+s),ml(l,h-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-textwrap-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let h=Q().textWrap,d=[{text:h.overflow,value:"overflow",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-overflow iconfont luckysheet-iconfont-yichu1" style="user-select: none;"> </div> </div>'},{text:h.wrap,value:"wrap",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-wrap iconfont luckysheet-iconfont-zidonghuanhang" style="user-select: none;"> </div> </div>'},{text:h.clip,value:"clip",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan" style="user-select: none;"> </div> </div>'}],m=Jr.textWrap,p=e.createButtonMenu(d),v=_e(e.menu,{id:"textwrap-menu",item:p,subclass:"",sub:""});$("body").append(v),l=$("#"+t).width(120),e.focus(l,"clip"),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let y=$(this),k=y.attr("itemvalue");e.focus(l,k),$("#luckysheet-icon-textwrap").attr("type",k).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+k+m[k]);let w=xe.deepCopyFlowData(f.flowdata);e.updateFormat(w,"tb",k)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o),ml(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-rotation-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let h=Q().rotation,d=[{text:h.none,value:"none",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang" style="user-select: none;"> </div> </div>'},{text:h.angleup,value:"angleup",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angleup iconfont luckysheet-iconfont-xiangshangqingxie" style="user-select: none;"> </div> </div>'},{text:h.angledown,value:"angledown",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angledown iconfont luckysheet-iconfont-xiangxiaqingxie" style="user-select: none;"> </div> </div>'},{text:h.vertical,value:"vertical",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-vertical iconfont luckysheet-iconfont-shupaiwenzi" style="user-select: none;"> </div> </div>'},{text:h.rotationUp,value:"rotation-up",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-up iconfont luckysheet-iconfont-wenbenxiangshang" style="user-select: none;"> </div> </div>'},{text:h.rotationDown,value:"rotation-down",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-down iconfont luckysheet-iconfont-xiangxia90" style="user-select: none;"> </div> </div>'}],m=Jr.rotation,p=e.createButtonMenu(d),v=_e(e.menu,{id:"rotation-menu",item:p,subclass:"",sub:""});$("body").append(v),l=$("#"+t).width(160),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let y=$(this),k=y.attr("itemvalue");e.focus(l,k),$("#luckysheet-icon-rotation").attr("type",k).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+k+m[k]);let w=xe.deepCopyFlowData(f.flowdata);e.updateFormat(w,"tr",k)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o),ml(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-freezen-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let h=Q().freezen,d=[{text:h.freezenRow,value:"freezenRow",example:""},{text:h.freezenColumn,value:"freezenColumn",example:""},{text:h.freezenRC,value:"freezenRC",example:""},{text:"",value:"split",example:""},{text:h.freezenRowRange,value:"freezenRowRange",example:""},{text:h.freezenColumnRange,value:"freezenColumnRange",example:""},{text:h.freezenRCRange,value:"freezenRCRange",example:""},{text:"",value:"split",example:""},{text:h.freezenCancel,value:"freezenCancel",example:""}],m=e.createButtonMenu(d),p=_e(e.menu,{id:"freezen-menu",item:m,subclass:"",sub:""});$("body").append(p),l=$("#"+t).width(170),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let v=$(this),y=v.attr("itemvalue");if(e.focus(l,y),y==="freezenCancel"&&l.find(".fa.fa-check").remove(),Y.saveFrozen(y),y=="freezenRow")Aa();else if(y=="freezenColumn")za();else if(y=="freezenRC"){if(Y.freezenRealFirstRowColumn){let k=0,b=f.visibledatarow[k]-2+f.columnHeaderHeight,w=[f.visibledatarow[k],k+1,0,Y.cutVolumn(f.visibledatarow,k+1),b];Y.saveFreezen(w,b,null,null),Y.createFreezenHorizontal(w,b);let x=0,C=f.visibledatacolumn[x]-2+f.rowHeaderWidth,S=[f.visibledatacolumn[x],x+1,0,Y.cutVolumn(f.visibledatacolumn,x+1),C];Y.saveFreezen(null,null,S,C),Y.createFreezenVertical(S,C)}else{let k=$("#luckysheet-cell-main").scrollTop(),b=at(f.visibledatarow,k);b==-1&&(b=0);let w=f.visibledatarow[b]-2-k+f.columnHeaderHeight,x=[f.visibledatarow[b],b+1,k,Y.cutVolumn(f.visibledatarow,b+1),w];Y.saveFreezen(x,w,null,null),Y.createFreezenHorizontal(x,w);let C=$("#luckysheet-cell-main").scrollLeft(),S=at(f.visibledatacolumn,C);S==-1&&(S=0);let _=f.visibledatacolumn[S]-2-C+f.rowHeaderWidth,T=[f.visibledatacolumn[S],S+1,C,Y.cutVolumn(f.visibledatacolumn,S+1),_];Y.saveFreezen(null,null,T,_),Y.createFreezenVertical(T,_)}Y.createAssistCanvas(),Be()}else if(y=="freezenRowRange"){if(f.luckysheet_select_save==null||f.luckysheet_select_save.length==0){he()?alert(h.noSeletionError):W.info(h.noSeletionError,"");return}let k=f.luckysheet_select_save[f.luckysheet_select_save.length-1].top;if(Y.freezenRealFirstRowColumn&&k>$("#luckysheet-cell-main").height())return W.info(h.rangeRCOverErrorTitle,h.rangeRCOverError);let b=$("#luckysheet-cell-main").scrollTop(),w=at(f.visibledatarow,b),x=f.luckysheet_select_save[f.luckysheet_select_save.length-1],C=x.row_focus==null?x.row[0]:x.row_focus;w=Math.max(w-1,C-1,0);let S,_;Y.freezenRealFirstRowColumn?(S=f.visibledatarow[w]-2+f.columnHeaderHeight,_=[f.visibledatarow[w],w+1,0,Y.cutVolumn(f.visibledatarow,w+1),S]):(S=f.visibledatarow[w]-2-b+f.columnHeaderHeight,_=[f.visibledatarow[w],w+1,b,Y.cutVolumn(f.visibledatarow,w+1),S]),Y.saveFreezen(_,S,null,null),Y.freezenverticaldata!=null&&(Y.cancelFreezenVertical(),Y.createAssistCanvas(),Be()),Y.createFreezenHorizontal(_,S),Y.createAssistCanvas(),Be()}else if(y=="freezenColumnRange"){if(f.luckysheet_select_save==null||f.luckysheet_select_save.length==0){he()?alert(h.noSeletionError):W.info(h.noSeletionError,"");return}let k=f.luckysheet_select_save[f.luckysheet_select_save.length-1].left;if(Y.freezenRealFirstRowColumn&&k>$("#luckysheet-cell-main").width())return W.info(h.rangeRCOverErrorTitle,h.rangeRCOverError);let b=$("#luckysheet-cell-main").scrollLeft(),w=at(f.visibledatacolumn,b),x=f.luckysheet_select_save[f.luckysheet_select_save.length-1],C=x.column_focus==null?x.column[0]:x.column_focus;w=Math.max(w-1,C-1,0);let S,_;Y.freezenRealFirstRowColumn?(S=f.visibledatacolumn[w]-2+f.rowHeaderWidth,_=[f.visibledatacolumn[w],w+1,0,Y.cutVolumn(f.visibledatacolumn,w+1),S]):(S=f.visibledatacolumn[w]-2-b+f.rowHeaderWidth,_=[f.visibledatacolumn[w],w+1,b,Y.cutVolumn(f.visibledatacolumn,w+1),S]),Y.saveFreezen(null,null,_,S),Y.freezenhorizontaldata!=null&&(Y.cancelFreezenHorizontal(),Y.createAssistCanvas(),Be()),Y.createFreezenVertical(_,S),Y.createAssistCanvas(),Be()}else if(y=="freezenRCRange"){if(f.luckysheet_select_save==null||f.luckysheet_select_save.length==0){he()?alert(h.noSeletionError):W.info(h.noSeletionError,"");return}let k=f.luckysheet_select_save[f.luckysheet_select_save.length-1].top,b=f.luckysheet_select_save[f.luckysheet_select_save.length-1].left;if(Y.freezenRealFirstRowColumn&&(k>$("#luckysheet-cell-main").height()||b>$("#luckysheet-cell-main").width()))return W.info(h.rangeRCOverErrorTitle,h.rangeRCOverError);let w=$("#luckysheet-cell-main").scrollTop(),x=at(f.visibledatarow,w),C=f.luckysheet_select_save[f.luckysheet_select_save.length-1],S=C.row_focus==null?C.row[0]:C.row_focus;x=Math.max(x-1,S-1,0);let _,T;Y.freezenRealFirstRowColumn?(_=f.visibledatarow[x]-2+f.columnHeaderHeight,T=[f.visibledatarow[x],x+1,0,Y.cutVolumn(f.visibledatarow,x+1),_],Y.saveFreezen(T,_,null,null)):(_=f.visibledatarow[x]-2-w+f.columnHeaderHeight,T=[f.visibledatarow[x],x+1,w,Y.cutVolumn(f.visibledatarow,x+1),_],Y.saveFreezen(T,_,null,null)),Y.createFreezenHorizontal(T,_);let F=$("#luckysheet-cell-main").scrollLeft(),R=at(f.visibledatacolumn,F),I=C.column_focus==null?C.column[0]:C.column_focus;R=Math.max(R-1,I-1,0);let P,O;Y.freezenRealFirstRowColumn?(P=f.visibledatacolumn[R]-2+f.rowHeaderWidth,O=[f.visibledatacolumn[R],R+1,0,Y.cutVolumn(f.visibledatacolumn,R+1),P]):(P=f.visibledatacolumn[R]-2-F+f.rowHeaderWidth,O=[f.visibledatacolumn[R],R+1,F,Y.cutVolumn(f.visibledatacolumn,R+1),P]),Y.saveFreezen(null,null,O,P),Y.createFreezenVertical(O,P),Y.createAssistCanvas(),Be()}else y=="freezenCancel"&&(Y.freezenverticaldata!=null&&(Y.cancelFreezenVertical(),Y.createAssistCanvas(),Be()),Y.freezenhorizontaldata!=null&&(Y.cancelFreezenHorizontal(),Y.createAssistCanvas(),Be()),Y.scrollAdapt());setTimeout(function(){Ot()},0)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o),ml(l,s-68,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-autofilter").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=Q(),h=u.sort,d=u.filter,m=[{text:h.asc,value:"asc",example:'<i class="iconfont luckysheet-iconfont-shengxu" aria-hidden="true"></i>'},{text:h.desc,value:"desc",example:'<i class="iconfont luckysheet-iconfont-jiangxu" aria-hidden="true"></i>'},{text:h.custom+"...",value:"diysort",example:'<i class="iconfont luckysheet-iconfont-zidingyipaixu" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:d.filter,value:"filter",example:'<i class="iconfont luckysheet-iconfont-shaixuan2" aria-hidden="true"></i>'},{text:d.clearFilter,value:"clearfilter",example:'<i class="iconfont luckysheet-iconfont-qingchushaixuan" aria-hidden="true"></i>'}],p=e.createButtonMenu(m),v=_e(e.menu,{id:"autofilter",item:p,subclass:"",sub:""});$("body").append(v),l=$("#"+t).width(150),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let y=$(this),k=y.attr("itemvalue");k=="diysort"?$("#luckysheetorderby").click():k=="asc"?Ys(!0):k=="desc"?Ys(!1):k=="filter"?$("#luckysheet-filter-options-sheet"+f.currentSheetIndex).length>0?$("#luckysheet-filter-initial").click():Io():k=="clearfilter"&&$("#luckysheet-filter-initial").click()})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+f.container).width()&&(s=s-a+o),ml(l,s,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-seachmore").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Q().findAndReplace;if(l.length==0){let d=[{text:a.find+" ...",value:"search",example:'<i class="iconfont luckysheet-iconfont-sousuo" aria-hidden="true"></i>'},{text:a.replace+" ...",value:"replace",example:'<i class="iconfont luckysheet-iconfont-tihuan" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:a.location+" ...",value:"location",example:'<i class="iconfont luckysheet-iconfont-dingwei" aria-hidden="true"></i>'},{text:a.formula,value:"locationFormula",example:a.locationExample},{text:a.date,value:"locationConstantDate",example:a.locationExample},{text:a.number,value:"locationConstantNumber",example:a.locationExample},{text:a.string,value:"locationConstantString",example:a.locationExample},{text:a.error,value:"locationConstantError",example:a.locationExample},{text:a.condition,value:"locationCF",example:a.locationExample},{text:a.rowSpan,value:"locationStepRow",example:a.locationExample},{text:a.columnSpan,value:"locationStepColumn",example:a.locationExample}],m=e.createButtonMenu(d),p=_e(e.menu,{id:"seachmore",item:m,subclass:"",sub:""});$("body").append(p),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let v=$(this),y=v.attr("itemvalue");if(y=="search"||y=="replace")y=="search"?$n.createDialog(0):y=="replace"&&$n.createDialog(1),$n.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(y=="location")Xr.createDialog(),Xr.init();else if(y=="locationFormula"||y=="locationConstantDate"||y=="locationConstantNumber"||y=="locationConstantString"||y=="locationConstantError"||y=="locationCF"){let k=f.luckysheet_select_save[0],b;f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&k.row[0]==k.row[1]&&k.column[0]==k.column[1]?b=[{row:[0,f.flowdata.length-1],column:[0,f.flowdata[0].length-1]}]:b=$.extend(!0,[],f.luckysheet_select_save),y=="locationFormula"?Xr.apply(b,"locationFormula","all"):y=="locationConstantDate"?Xr.apply(b,"locationConstant","d"):y=="locationConstantNumber"?Xr.apply(b,"locationConstant","n"):y=="locationConstantString"?Xr.apply(b,"locationConstant","s,g"):y=="locationConstantError"?Xr.apply(b,"locationConstant","e"):y=="locationCF"&&Xr.apply(b,"locationCF")}else if(y=="locationStepRow"){if(f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].row[0]==f.luckysheet_select_save[0].row[1]){he()?alert(a.lessTwoRowTip):W.info("",a.lessTwoRowTip);return}let k=$.extend(!0,[],f.luckysheet_select_save);Xr.apply(k,"locationStepRow")}else if(y=="locationStepColumn"){if(f.luckysheet_select_save.length==0||f.luckysheet_select_save.length==1&&f.luckysheet_select_save[0].column[0]==f.luckysheet_select_save[0].column[1]){he()?alert(a.lessTwoColumnTip):W.info("",a.lessTwoColumnTip);return}let k=$.extend(!0,[],f.luckysheet_select_save);Xr.apply(k,"locationStepColumn")}})}let s=$(this).outerWidth(),u=l.outerWidth(),h=$(this).offset().left;u>s&&u+h>$("#"+f.container).width()&&(h=h-u+s),ml(l,h,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-function").click(function(){e.autoSelectionFormula("SUM")}),$("#luckysheet-icon-function-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Q().formula;if(l.length==0){let d=[{text:a.sum,value:"SUM",example:"SUM"},{text:a.average,value:"AVERAGE",example:"AVERAGE"},{text:a.count,value:"COUNT",example:"COUNT"},{text:a.max,value:"MAX",example:"MAX"},{text:a.min,value:"MIN",example:"MIN"},{text:"",value:"split",example:""},{text:a.ifGenerate,value:"if",example:"IF"},{text:a.find+" ...",value:"formula",example:""}],m=e.createButtonMenu(d),p=_e(e.menu,{id:"function-menu",item:m,subclass:"",sub:""});$("body").append(p),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let v=$(this),y=v.attr("itemvalue");if(y=="if"){let k=f.luckysheet_select_save[f.luckysheet_select_save.length-1],b=k.row_focus==null?k.row[0]:k.row_focus,w=k.column_focus==null?k.column[0]:k.column_focus;if(!!f.flowdata[b]&&!!f.flowdata[b][w]&&!!f.flowdata[b][w].f){let x=f.flowdata[b][w].f.toString();if(x.indexOf("=if(")!=-1)eo.ifFormulaDialog(x);else{he()?alert(a.tipNotBelongToIf):W.info(a.tipNotBelongToIf,"");return}}else eo.ifFormulaDialog();eo.init()}else if(y=="formula"){if(f.luckysheet_select_save.length==0){he()?alert(a.tipSelectCell):W.info(a.tipSelectCell,"");return}let k=f.luckysheet_select_save[f.luckysheet_select_save.length-1],b=k.row_focus,w=k.column_focus;Rl(b,w,f.flowdata);let x=f.flowdata[b][w];if(x!=null&&x.f!=null){let C=g.getfunctionParam(x.f);C.fn!=null?cn.formulaParmDialog(C.fn,C.param):cn.formulaListDialog()}else $("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),cn.formulaListDialog();cn.init()}else e.autoSelectionFormula(y)})}let s=$(this).outerWidth(),u=l.outerWidth(),h=$(this).offset().left;u>s&&u+h>$("#"+f.container).width()&&(h=h-u+s),ml(l,h-48,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-bold").mousedown(function(t){xr(t),t.stopPropagation()}).click(function(t){let l=xe.deepCopyFlowData(f.flowdata),a=Qi("bl",1)?0:1;e.updateFormat(l,"bl",a)}),$("#luckysheet-icon-italic").mousedown(function(t){xr(t),t.stopPropagation()}).click(function(){let t=xe.deepCopyFlowData(f.flowdata),o=Qi("it",1)?0:1;e.updateFormat(t,"it",o)}),$("#luckysheet-icon-strikethrough").mousedown(function(t){xr(t),t.stopPropagation()}).click(function(){let t=xe.deepCopyFlowData(f.flowdata),o=Qi("cl",1)?0:1;e.updateFormat(t,"cl",o)}),$("#luckysheet-icon-underline").mousedown(function(t){xr(t),t.stopPropagation()}).click(function(){let t=xe.deepCopyFlowData(f.flowdata),o=Qi("un",1)?0:1;e.updateFormat(t,"un",o)}),$("#luckysheet-icon-conditionformat").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),o=Q().conditionformat;if(l.length==0){let h=[{text:o.highlightCellRules,value:"highlightCellRule",example:"more"},{text:o.itemSelectionRules,value:"projectSelectRule",example:"more"},{text:o.dataBar,value:"dataBar",example:"more"},{text:o.colorGradation,value:"colorGradation",example:"more"},{text:o.icons,value:"icons",example:""},{text:"",value:"split",example:""},{text:o.newRule,value:"newRule",example:""},{text:o.deleteRule,value:"deleteRule",example:"more"},{text:o.manageRules,value:"administerRule",example:""}],d=e.createButtonMenu(h),m=_e(e.menu,{id:"conditionformat",item:d,subclass:"",sub:""}),p=[{text:o.greaterThan,value:"greaterThan",example:">"},{text:o.lessThan,value:"lessThan",example:"<"},{text:o.between,value:"betweenness",example:"[]"},{text:o.equal,value:"equal",example:"="},{text:o.textContains,value:"textContains",example:"()"},{text:o.occurrence,value:"occurrenceDate",example:o.yesterday},{text:o.duplicateValue,value:"duplicateValue",example:"##"}],v=e.createButtonMenu(p),y=_e(e.menu,{id:"highlightCellRule",item:v,subclass:"luckysheet-menuButton-sub"}),k=[{text:o.top10,value:"top10",example:o.top10},{text:o.top10_percent,value:"top10%",example:o.top10_percent},{text:o.last10,value:"last10",example:o.last10},{text:o.last10_percent,value:"last10%",example:o.last10_percent},{text:o.aboveAverage,value:"AboveAverage",example:o.above},{text:o.belowAverage,value:"SubAverage",example:o.below}],b=e.createButtonMenu(k),w=_e(e.menu,{id:"projectSelectRule",item:b,subclass:"luckysheet-menuButton-sub"}),x=`<div id="luckysheet-icon-dataBar-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" style="width: 126px;padding: 5px;top: 118.5px;left: 1321.48px;display: none;">
                                    <div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="${o.gradientDataBar_1}"></div>
                                    </div>
                                    <div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="${o.gradientDataBar_2}"></div>
                                    </div>
                                    <div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="${o.gradientDataBar_3}"></div>
                                    </div>
                                    <div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="${o.gradientDataBar_4}"></div>
                                    </div>
                                    <div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="${o.gradientDataBar_5}"></div>
                                    </div>
                                    <div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="${o.gradientDataBar_6}"></div>
                                    </div>
                                    <div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="${o.solidColorDataBar_1}"></div>
                                    </div>
                                    <div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="${o.solidColorDataBar_2}"></div>
                                    </div>
                                    <div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="${o.solidColorDataBar_3}"></div>
                                    </div>
                                    <div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -108px;" title="${o.solidColorDataBar_4}"></div>
                                    </div>
                                    <div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -108px;" title="${o.solidColorDataBar_5}"></div>
                                    </div>
                                    <div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -108px;" title="${o.solidColorDataBar_6}"></div>
                                    </div>
                                </div>`,C=`<div id="luckysheet-icon-colorGradation-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" style="width: 126px;padding: 5px;top: 143.5px;left: 1321.48px;display: none;">
                                    <div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="${o.colorGradation_1}"></div>
                                    </div>
                                    <div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="${o.colorGradation_2}"></div>
                                    </div>
                                    <div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="${o.colorGradation_3}"></div>
                                    </div>
                                    <div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px 0;" title="${o.colorGradation_4}"></div>
                                    </div>
                                    <div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="${o.colorGradation_5}"></div>
                                    </div>
                                    <div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="${o.colorGradation_6}"></div>
                                    </div>
                                    <div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="${o.colorGradation_7}"></div>
                                    </div>
                                    <div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -36px;" title="${o.colorGradation_8}"></div>
                                    </div>
                                    <div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="${o.colorGradation_9}"></div>
                                    </div>
                                    <div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="${o.colorGradation_10}"></div>
                                    </div>
                                    <div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="${o.colorGradation_11}"></div>
                                    </div>
                                    <div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -72px;" title="${o.colorGradation_12}"></div>
                                    </div>
                                </div>`,S=[{text:o.deleteSheetRule,value:"delSheet",example:""}],_=e.createButtonMenu(S),T=_e(e.menu,{id:"deleteRule",item:_,subclass:"luckysheet-menuButton-sub"});$("body").append(m+y+w+x+C+T),l=$("#"+t).width(190),$("#luckysheet-icon-highlightCellRule-menuButton").width(160),$("#luckysheet-icon-projectSelectRule-menuButton").width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let F=$(this),R=F.attr("itemvalue");if(R=="icons"){if(f.luckysheet_select_save.length==0){he()?alert(o.pleaseSelectRange):W.info(o.pleaseSelectRange,"");return}Se.CFiconsDialog(),Se.init()}else if(R=="newRule"){if(f.luckysheet_select_save.length==0){he()?alert(o.pleaseSelectRange):W.info(o.pleaseSelectRange,"");return}Se.newConditionRuleDialog(0),Se.init()}else if(R=="administerRule"){let I=ne.loadSheetUrl,P=At();if(I!=""&&I!=null){let O=[];for(let M=0;M<P.length;M++)O.push(P[M].index);$.post(I,{gridKey:ne.gridKey,index:O.join(",")},function(M){let A=new Function("return "+M)();setTimeout(function(){f.loadingObj.close()},500);for(let z in A){if(z==f.currentSheetIndex)continue;let L=P[Z(z)];L.celldata=A[z.toString()],L.data=ye.buildGridData(L)}Kn(P),Se.fileClone=$.extend(!0,[],P),Se.administerRuleDialog(),Se.init()})}else Se.fileClone=$.extend(!0,[],P),Se.administerRuleDialog(),Se.init()}}),$(document).off("click.CFhighlightCellRule").on("click.CFhighlightCellRule","#luckysheet-icon-highlightCellRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-highlightCellRule-menuButton").hide(),rt();let F=$(this),R=F.attr("itemvalue");if(f.luckysheet_select_save.length==0){he()?alert(o.pleaseSelectRange):W.info(o.pleaseSelectRange,"");return}else{let I=Se.textCellColorHtml(),P,O;switch(R){case"greaterThan":P=o.conditionformat_greaterThan,O=`<div class="box" data-itemvalue="greaterThan">
                                                <div class="boxTitleOne">${o.conditionformat_greaterThan_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div> 
                                                ${I} 
                                            </div>`;break;case"lessThan":P=o.conditionformat_lessThan,O=`<div class="box" data-itemvalue="lessThan">
                                                <div class="boxTitleOne">${o.conditionformat_lessThan_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"betweenness":P=o.conditionformat_betweenness,O=`<div class="box" data-itemvalue="betweenness">
                                                <div class="boxTitleOne">${o.conditionformat_betweenness_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div class="inpbox2 range">
                                                        <input id="conditionVal" class="formulaInputFocus"/>
                                                        <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.to}</div>
                                                    <div class="inpbox2 range">
                                                        <input id="conditionVal2" class="formulaInputFocus"/>
                                                        <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                    </div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"equal":P=o.conditionformat_equal,O=`<div class="box" data-itemvalue="equal">
                                                <div class="boxTitleOne">${o.conditionformat_equal_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"textContains":P=o.conditionformat_textContains,O=`<div class="box" data-itemvalue="textContains">
                                                <div class="boxTitleOne">${o.conditionformat_textContains_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"occurrenceDate":P=o.conditionformat_occurrenceDate,O=`<div class="box" data-itemvalue="occurrenceDate">
                                                <div class="boxTitleOne">${o.conditionformat_occurrenceDate_title}\uFF1A</div>
                                                <div class="inpbox">
                                                    <input id="daterange-btn" class="formulaInputFocus" readonly="readonly" placeholder="${o.pleaseSelectADate}"/>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"duplicateValue":P=o.conditionformat_duplicateValue,O=`<div class="box" data-itemvalue="duplicateValue">
                                                <div class="boxTitleOne">${o.conditionformat_duplicateValue_title}\uFF1A</div>
                                                <select id="conditionVal" class="selectbox">
                                                    <option value="0">${o.duplicateValue}</option>
                                                    <option value="1">${o.uniqueValue}</option>
                                                </select>
                                                <div style="margin:5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break}Se.conditionformatDialog(P,O)}}),$(document).off("click.CFprojectSelectRule").on("click.CFprojectSelectRule","#luckysheet-icon-projectSelectRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-projectSelectRule-menuButton").hide(),rt();let F=$(this),R=F.attr("itemvalue");if(f.luckysheet_select_save.length==0){he()?alert(o.pleaseSelectRange):W.info(o.pleaseSelectRange,"");return}else{let I=Se.textCellColorHtml(),P,O;switch(R){case"top10":P=o.conditionformat_top10,O=`<div class="box" data-itemvalue="top10">
                                                <div class="boxTitleOne">${o.conditionformat_top10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.top}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.oneself}</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"top10%":P=o.conditionformat_top10_percent,O=`<div class="box" data-itemvalue="top10%">
                                                <div class="boxTitleOne">${o.conditionformat_top10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.top}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"last10":P=o.conditionformat_last10,O=`<div class="box" data-itemvalue="last10">
                                                <div class="boxTitleOne">${o.conditionformat_last10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.last}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.oneself}</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"last10%":P=o.conditionformat_last10_percent,O=`<div class="box" data-itemvalue="last10%">
                                                <div class="boxTitleOne">${o.conditionformat_last10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.last}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div>
                                                </div>
                                                <div style="margin:5px 0;">\u8BBE\u7F6E\u4E3A\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"AboveAverage":P=o.conditionformat_AboveAverage,O=`<div class="box" data-itemvalue="AboveAverage">
                                                <div class="boxTitleOne">${o.conditionformat_AboveAverage_title}\uFF1A</div>
                                                <div style="margin: 5px 0;">${o.setAsByArea}\uFF1A</div>
                                                ${I}
                                            </div>`;break;case"SubAverage":P=o.conditionformat_SubAverage,O=`<div class="box" data-itemvalue="SubAverage">
                                                <div class="boxTitleOne">${o.conditionformat_SubAverage_title}\uFF1A</div>
                                                <div style="margin: 5px 0;">${o.setAsByArea}\uFF1A</div>
                                                ${I}
                                            </div>`;break}Se.conditionformatDialog(P,O)}}),$(document).off("click.CFdataBar").on("click.CFdataBar","#luckysheet-icon-dataBar-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-dataBar-menuButton").hide(),rt();let F=$(this),R=F.attr("itemvalue");if(f.luckysheet_select_save.length>0){let I=$.extend(!0,[],f.luckysheet_select_save),P=Se.dataBarList[R].format;Se.updateItem("dataBar",I,P)}}),$(document).off("click.CFcolorGradation").on("click.CFcolorGradation","#luckysheet-icon-colorGradation-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-colorGradation-menuButton").hide(),rt();let F=$(this),R=F.attr("itemvalue");if(f.luckysheet_select_save.length>0){let I=$.extend(!0,[],f.luckysheet_select_save),P=Se.colorGradationList[R].format;Se.updateItem("colorGradation",I,P)}}),$(document).off("click.CFdeleteRule").on("click.CFdeleteRule","#luckysheet-icon-deleteRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-deleteRule-menuButton").hide(),rt(),$(this).attr("itemvalue")=="delSheet"&&Se.updateItem("delSheet")})}let a=$(this).outerWidth(),s=l.outerWidth(),u=$(this).offset().left;s>a&&s+u>$("#"+f.container).width()&&(u=u-s+a),ml(l,u,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-postil").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),o=Q().comment;l.remove(),He.removeActivePs();let a=f.luckysheet_select_save[f.luckysheet_select_save.length-1],s=a.row_focus;s==null&&(s=a.row[0]);let u=a.column_focus;u==null&&(u=a.column[0]);let h;f.flowdata[s][u]!=null&&f.flowdata[s][u].ps!=null?h=[{text:o.edit,value:"editPs",example:""},{text:o.delete,value:"delPs",example:""},{text:"",value:"split",example:""},{text:o.showOne,value:"showHidePs",example:""},{text:o.showAll,value:"showHideAllPs",example:""}]:h=[{text:o.insert,value:"newPs",example:""},{text:"",value:"split",example:""},{text:o.showAll,value:"showHideAllPs",example:""}];let d=e.createButtonMenu(h),m=_e(e.menu,{id:"postil",item:d,subclass:"",sub:""});$("body").append(m),l=$("#"+t).width(150),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let k=$(this),b=k.attr("itemvalue");b=="newPs"?He.newPs(s,u):b=="editPs"?He.editPs(s,u):b=="delPs"?He.delPs(s,u):b=="showHidePs"?He.showHidePs(s,u):b=="showHideAllPs"&&He.showHideAllPs()});let p=$(this).outerWidth(),v=l.outerWidth(),y=$(this).offset().left;v>p&&v+y>$("#"+f.container).width()&&(y=y-v+p),ml(l,y,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-protection").click(function(){let t=ye.getSheetByIndex();Bh(t)}),$("#luckysheet-icon-print").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Q().print;if(l.length==0){let d=[{text:a.menuItemPrint,value:"print",example:'<i class="iconfont luckysheet-iconfont-dayin" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:a.menuItemAreas,value:"areas",example:'<i class="iconfont luckysheet-iconfont-tihuan" aria-hidden="true"></i>'},{text:a.menuItemRows,value:"rows",example:'<i class="iconfont luckysheet-iconfont-zhuandao1" aria-hidden="true"></i>'},{text:a.menuItemColumns,value:"columns",example:'<i class="iconfont luckysheet-iconfont-dingwei" aria-hidden="true"></i>'}],m=e.createButtonMenu(d),p=_e(e.menu,{id:"print",item:m,subclass:"",sub:""});$("body").append(p),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),rt();let v=$(this),y=v.attr("itemvalue");y=="print"?alert("print"):(y=="areas"||y=="rows"||y=="columns")&&alert("areas")})}let s=$(this).outerWidth(),u=l.outerWidth(),h=$(this).offset().left;u>s&&u+h>$("#"+f.container).width()&&(h=h-u+s),ml(l,h,$(this).offset().top+25,"lefttop")}),$("body").on("mouseover mouseleave",".luckysheet-menuButton .luckysheet-cols-submenu",function(t){let l=$(this),o=l.attr("itemvalue"),a=$("#luckysheet-icon-"+o+"-menuButton");if(t.type==="mouseover"){let s=l.parent(),u=$(window).width(),h=$(window).height(),d=s.width(),m=a.height()+25,p=a.width()+5,v=l.offset(),y=v.top,k=v.left+d;k+p>u&&(k=v.left-p),y+m>h&&(y=h-m),a.css({top:y,left:k}).show(),e.rightclickmenu=l}else clearTimeout(e.submenuhide[a.attr("id")]),e.submenuhide[a.attr("id")]=setTimeout(function(){a.hide()},200)}).on("mouseover mouseleave",".luckysheet-menuButton-sub",function(t){t.type==="mouseover"?(e.rightclickmenu.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(e.submenuhide[$(this).attr("id")])):(e.rightclickmenu.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide())})},getQKBorder:function(e,n,t){let l="";e.indexOf("pt")>-1?(e=parseFloat(e),e<1||(e<1.5?l="Medium":l="Thick")):(e=parseFloat(e),e<2||(e<3?l="Medium":l="Thick"));let o=0;return n=n.toLowerCase(),n=="double"?o=2:n=="dotted"?l=="Medium"||l=="Thick"?o=3:o=10:n=="dashed"?l=="Medium"||l=="Thick"?o=4:o=9:n=="solid"&&(l=="Medium"?o=8:l=="Thick"?o=13:o=1),[o,t]},updateFormatCell:function(e,n,t,l,o,a,s){if(!(e==null||n==null))if(n=="ct"){for(let u=l;u<=o;u++)if(!(f.config.rowhidden!=null&&f.config.rowhidden[u]!=null))for(let h=a;h<=s;h++){let d=e[u][h],m=null;N(d)=="object"?m=e[u][h].v:m=e[u][h],t!="@"&&B(m)&&(m=parseFloat(m));let p=mt(t,m),v="n";Sh(t)||t===14||t===15||t===16||t===17||t===18||t===19||t===20||t===21||t===22||t===45||t===46||t===47?v="d":t=="@"||t===49?v="s":(t=="General"||t===0)&&(v=B(m)?"n":"g"),N(d)=="object"?(e[u][h].m=p,e[u][h].ct==null&&(e[u][h].ct={}),e[u][h].ct.fa=t,e[u][h].ct.t=v):e[u][h]={ct:{fa:t,t:v},v:m,m:p}}}else{n=="ht"?t=="left"?t="1":t=="center"?t="0":t=="right"&&(t="2"):n=="vt"?t=="top"?t="1":t=="middle"?t="0":t=="bottom"&&(t="2"):n=="tb"?t=="overflow"?t="1":t=="clip"?t="0":t=="wrap"&&(t="2"):n=="tr"&&(t=="none"?t="0":t=="angleup"?t="1":t=="angledown"?t="2":t=="vertical"?t="3":t=="rotation-up"?t="4":t=="rotation-down"&&(t="5"));for(let u=l;u<=o;u++)if(!(f.config.rowhidden!=null&&f.config.rowhidden[u]!=null))for(let h=a;h<=s;h++){let d=e[u][h];N(d)=="object"?(ph(d,n,t),e[u][h][n]=t):(e[u][h]={v:d},e[u][h][n]=t)}}},updateFormat:function(e,n,t){let l=this;if(!Sr(f.currentSheetIndex))return;if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}let a=document.createElement("canvas").getContext("2d");if(n in hh&&parseInt($("#luckysheet-input-box").css("top"))>0&&$("#luckysheet-input-box").text().substr(0,1)!="="){let d=e[f.luckysheetCellUpdate[0]][f.luckysheetCellUpdate[1]];mh(d,n,t,g.rangeResizeTo)}let s=$.extend(!0,{},f.config);s.rowlen==null&&(s.rowlen={});for(let h=0;h<f.luckysheet_select_save.length;h++){let d=f.luckysheet_select_save[h].row[0],m=f.luckysheet_select_save[h].row[1],p=f.luckysheet_select_save[h].column[0],v=f.luckysheet_select_save[h].column[1];this.updateFormatCell(e,n,t,d,m,p,v),(n=="tb"||n=="tr"||n=="fs")&&(s=pl(e,d,m,s))}let u={};(n=="tb"||n=="tr"||n=="fs")&&(u={cfg:s,RowlChange:!0}),Ze(e,f.luckysheet_select_save,u,!1)},updateFormat_mc:function(e,n){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}let t=$.extend(!0,{},f.config);if(t.merge==null&&(t.merge={}),!!jr(f.currentSheetIndex)){if(n=="mergeCancel")for(let l=0;l<f.luckysheet_select_save.length;l++){let o=f.luckysheet_select_save[l],a=o.row[0],s=o.row[1],u=o.column[0],h=o.column[1];if(a==s&&u==h)continue;let d={};for(let m=a;m<=s;m++)for(let p=u;p<=h;p++){let v=e[m][p];if(v!=null&&v.mc!=null){let y=v.mc.r,k=v.mc.c;if("rs"in v.mc)delete v.mc,delete t.merge[y+"_"+k],d[y+"_"+k]=$.extend(!0,{},v);else{let b=JSON.parse(JSON.stringify(d[y+"_"+k]));delete b.v,delete b.m,delete b.ct,delete b.f,delete b.spl,e[m][p]=b}}}}else{let l=!1;for(let o=0;o<f.luckysheet_select_save.length;o++){let a=f.luckysheet_select_save[o],s=a.row[0],u=a.row[1],h=a.column[0],d=a.column[1];for(let m=s;m<=u;m++)for(let p=h;p<=d;p++){let v=e[m][p];if(N(v)=="object"&&"mc"in v){l=!0;break}}}if(l)for(let o=0;o<f.luckysheet_select_save.length;o++){let a=f.luckysheet_select_save[o],s=a.row[0],u=a.row[1],h=a.column[0],d=a.column[1];if(s==u&&h==d)continue;let m={};for(let p=s;p<=u;p++)for(let v=h;v<=d;v++){let y=e[p][v];if(y!=null&&y.mc!=null){let k=y.mc.r,b=y.mc.c;if("rs"in y.mc)delete y.mc,delete t.merge[k+"_"+b],m[k+"_"+b]=$.extend(!0,{},y);else{let w=JSON.parse(JSON.stringify(m[k+"_"+b]));delete w.v,delete w.m,delete w.ct,delete w.f,delete w.spl,e[p][v]=w}}}}else for(let o=0;o<f.luckysheet_select_save.length;o++){let a=f.luckysheet_select_save[o],s=a.row[0],u=a.row[1],h=a.column[0],d=a.column[1];if(!(s==u&&h==d)){if(n=="mergeAll"){let m={},p=!1;for(let v=s;v<=u;v++)for(let y=h;y<=d;y++){let k=e[v][y];k!=null&&(Pi(k.ct)||!me(k.v)||k.f!=null)&&!p&&(m=$.extend(!0,{},k),p=!0),e[v][y]={mc:{r:s,c:h}}}e[s][h]=m,e[s][h].mc={r:s,c:h,rs:u-s+1,cs:d-h+1},t.merge[s+"_"+h]={r:s,c:h,rs:u-s+1,cs:d-h+1}}else if(n=="mergeV")for(let m=h;m<=d;m++){let p={},v=!1;for(let y=s;y<=u;y++){let k=e[y][m];k!=null&&(!me(k.v)||k.f!=null)&&!v&&(p=$.extend(!0,{},k),v=!0),e[y][m]={mc:{r:s,c:m}}}e[s][m]=p,e[s][m].mc={r:s,c:m,rs:u-s+1,cs:1},t.merge[s+"_"+m]={r:s,c:m,rs:u-s+1,cs:1}}else if(n=="mergeH")for(let m=s;m<=u;m++){let p={},v=!1;for(let y=h;y<=d;y++){let k=e[m][y];k!=null&&(!me(k.v)||k.f!=null)&&!v&&(p=$.extend(!0,{},k),v=!0),e[m][y]={mc:{r:m,c:h}}}e[m][h]=p,e[m][h].mc={r:m,c:h,rs:1,cs:d-h+1},t.merge[m+"_"+h]={r:m,c:h,rs:1,cs:d-h+1}}}}}f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"mergeChange",sheetIndex:f.currentSheetIndex,data:f.flowdata,curData:e,range:$.extend(!0,[],f.luckysheet_select_save),config:$.extend(!0,{},f.config),curConfig:t})),f.clearjfundo=!1,Ze(e,f.luckysheet_select_save,{cfg:t}),f.clearjfundo=!0}},borderfix:function(e,n,t){let l=e[n][t],o=null;return l==null?[-1,0,0,-1]:e[n][t].bg==null||e[n][t].bg==""?[-1,0,0,-1]:[-2,-1,1,0]},changeMenuButtonDom:function(e,n,t){let l=this;t==null&&(t=Q());let o=t.fontarray,a=t.fontjson;if(e=="bl")n!="0"?$("#luckysheet-icon-bold").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-bold").removeClass("luckysheet-toolbar-button-hover");else if(e=="it")n!="0"?$("#luckysheet-icon-italic").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-italic").removeClass("luckysheet-toolbar-button-hover");else if(e=="cl")n!="0"?$("#luckysheet-icon-strikethrough").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-strikethrough").removeClass("luckysheet-toolbar-button-hover");else if(e=="un")n!="0"?$("#luckysheet-icon-underline").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-underline").removeClass("luckysheet-toolbar-button-hover");else if(e=="ff"){let s="luckysheet-icon-font-family-menuButton",u=$("#"+s),h=o[0],d=0;n!=null&&(Nn(n).num?(d=parseInt(n),h=o[d],h==null&&(d=l.defualtFont[d],h=d,d!=null&&l.addFontTolist(d))):(n=n.replace(/"/g,"").replace(/'/g,""),d=n,h=n,l.addFontTolist(d))),l.focus(u,d),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+h+" ")}else if(e=="fs"){let s=$("#luckysheet-icon-font-size-menuButton"),u=n,h=$("#luckysheet-icon-font-size input");l.focus(s,u),$("#luckysheet-icon-font-size").attr("itemvalue",u),h.val(u)}else if(e=="ht"){let s=$("#luckysheet-icon-align-menu-menuButton"),u=$("luckysheet-icon-align"),h="left";n=="0"?h="center":n=="2"&&(h="right"),l.focus(s,h);let d=Jr.align;$("#luckysheet-icon-align").attr("type",h).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+h+d[h]),s.hide()}else if(e=="vt"){let s=$("#luckysheet-icon-valign-menu-menuButton"),u=$("luckysheet-icon-valign"),h="bottom";n=="1"?h="top":n=="0"&&(h="middle"),l.focus(s,h);let d=Jr.align;$("#luckysheet-icon-valign").attr("type",h).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+h+d[h]),s.hide()}else if(e=="tb"){let s=$("#luckysheet-icon-textwrap-menu-menuButton"),u=$("luckysheet-icon-textwrap"),h="clip";n=="1"?h="overflow":n=="2"&&(h="wrap"),l.focus(s,h);let d=Jr.textWrap;$("#luckysheet-icon-textwrap").attr("type",h).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+h+d[h]),s.hide()}else if(e=="tr"){let s=$("#luckysheet-icon-rotation-menu-menuButton"),u=$("luckysheet-icon-rotation"),h="none";n=="1"?h="angleup":n=="2"?h="angledown":n=="3"?h="vertical":n=="4"?h="rotation-up":n=="5"&&(h="rotation-down"),l.focus(s,h);let d=Jr.rotation;$("#luckysheet-icon-rotation").attr("type",h).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+h+d[h]),s.hide()}else if(e=="ct"){let s=$("#luckysheet-icon-fmt-other"),h=Q().defaultFmt;if(!n){s.find(".luckysheet-toolbar-menu-button-caption").html(" "+h[0].text+" ");return}let{fa:d}=n,m=h.find(p=>p.value===d);if(m)s.find(".luckysheet-toolbar-menu-button-caption").html(" "+m.text+" ");else{let p=h.find(v=>v.value==="fmtOtherSelf");s.find(".luckysheet-toolbar-menu-button-caption").html(" "+p.text+" ")}}},inputMenuButtonFocus:function(e){var n=window.getSelection(),t=n.getRangeAt(0);let l=t.startContainer;f.inlineStringEditRange=null;let o=Q();if(l.parentNode.tagName=="SPAN"){let a=l.parentNode.style.cssText,s=Is(a);for(let u in s)this.changeMenuButtonDom(u,s[u],o)}},menuButtonFocus:function(e,n,t){let l=this,o=["bl","it","cl","ff","ht","vt","fs","tb","tr","ct","un"],a=Q();for(let s=0;s<o.length;s++){let u=o[s],h=l.checkstatus(e,n,t,u);this.changeMenuButtonDom(u,h,a)}},checkstatus:function(e,n,t,l){if(e==null||e[n]==null)return console.warn("It's incorrect data",n,t),null;let o=e[n][t];return _r(o,l)},setLineDash:function(e,n,t,l,o,a,s){n={"0":"none","1":"Thin","2":"Hair","3":"Dotted","4":"Dashed","5":"DashDot","6":"DashDotDot","7":"Double","8":"Medium","9":"MediumDashed","10":"MediumDashDot","11":"MediumDashDotDot","12":"SlantedDashDot","13":"Thick"}[n.toString()];try{n=="Hair"?e.setLineDash([1,2]):n.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):n.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):n.indexOf("Dotted")>-1?e.setLineDash([2]):n.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(h){console.log(h)}e.beginPath(),n.indexOf("Medium")>-1?(t=="h"?(e.moveTo(l,o-.5),e.lineTo(a,s-.5)):(e.moveTo(l-.5,o),e.lineTo(a-.5,s)),e.lineWidth=2):n=="Thick"?(e.moveTo(l,o),e.lineTo(a,s),e.lineWidth=3):(e.moveTo(l,o),e.lineTo(a,s),e.lineWidth=1)},moveMergeData:function(e,n,t){if(me(e))return e;let l=[],o=[],a=!1;for(let s=0;s<e.length;s++)for(let u=0;u<e[0].length;u++){let h=e[s][u];N(h)=="object"&&"mc"in h&&(h.mc.rs!=null&&(l.push({rs:h.mc.rs,cs:h.mc.cs,r:h.mc.r,c:h.mc.c}),o.push({rs:h.mc.rs,cs:h.mc.cs,r:h.mc.r+n,c:h.mc.c+t}),a=!0),e[s][u].mc.r+=n,e[s][u].mc.c+=t)}return{deleMC:l,insertMC:o,hasMC:a}},getRangeInMerge:function(e,n,t,l,o){let a=this,s=[],u=null;if(o!=null?u=$.extend(!0,{},a.getSheetConfig()):u=$.extend(!0,{},f.config),u!=null&&u.merge!=null)for(let h in u.merge){let d=u.merge[h];!(e+n-1<d.r||e>d.r+d.rs-1)&&!(t+l-1<d.c||t>d.c+d.cs-1)&&s.push(d)}return s},mergeborer:function(e,n,t){if(e==null||e[n]==null)return console.warn("Merge info is null",n,t),null;let l=e[n][t];if(N(l)=="object"&&"mc"in l){let o=l.mc;if(o==null)return console.warn("Merge info is null",n,t),null;if(t=o.c,n=o.r,e[n][t]==null)return console.warn("Main merge Cell info is null",n,t),null;let a=e[n][t].mc.cs,s=e[n][t].mc.rs,u=e[n][t].mc,h,d,m,p;for(let w=n;w<u.rs+n;w++)w==0?h=-1:h=f.visibledatarow[w-1]-1,d=f.visibledatarow[w],p==null?(p=h,m=d):m+=d-h-1;let v,y,k,b;for(let w=t;w<u.cs+t;w++)w==0?v=0:v=f.visibledatacolumn[w-1],y=f.visibledatacolumn[w],b==null?(b=v,k=y):k+=y-v;return{row:[p,m,n,n+s-1],column:[b,k,t,t+a-1]}}else return null},mergeMoveData:{},mergeMoveMain:function(e,n,t,l,o,a,s){let u=this,h=ye.getSheetMerge();if(h==null)return;let d=[];for(let p in h)d.push(p);n[0]>n[1]&&(n[1]=n[0]),e[0]>e[1]&&(e[1]=e[0]);let m=!0;for(u.mergeMoveData={};m;){m=!1;for(let p=0;p<d.length;p++){let v=d[p],y=h[v];if(v in u.mergeMoveData)continue;let k=u.mergeMove(y,e,n,t,l,o,a,s);k!=null?(u.mergeMoveData[v]=y,e=k[0],n=k[1],l=k[2],o=k[3],a=k[4],s=k[5],m=!0):delete u.mergeMoveData[v]}}return[e,n,l,o,a,s]},mergeMove:function(e,n,t,l,o,a,s,u){let h=this,d=e.r,m=e.r+e.rs-1,p=e.c,v=e.c+e.cs-1,y=!1;if(n[1]<n[0]&&(n[0]=n[1]),t[1]<t[0]&&(t[0]=t[1]),n[0]<=p&&n[1]>=v&&t[0]<=d&&t[1]>=m||!(n[1]<p||n[0]>v)&&!(t[1]<d||t[0]>m)){let k=h.mergeborer(f.flowdata,e.r,e.c);if(k){let b=k.row[1],w=k.row[0],x=k.row[2],C=k.column[1],S=k.column[0],_=k.column[2];n[1]<p||n[0]>v||(t[0]<=m&&t[0]>=d&&(a+=o-w,o=w,t[0]=d),t[1]>=d&&t[1]<=m&&(l.row_focus>=d&&l.row_focus<=m,a=b-o,t[1]=m)),t[1]<d||t[0]>m||(n[0]<=v&&n[0]>=p&&(u+=s-S,s=S,n[0]=p),n[1]>=p&&n[1]<=v&&(l.column_focus>=p&&l.column_focus<=v,u=C-s,n[1]=v)),y=!0}}return y?[n,t,o,a,s,u]:null},getCellRealSize:function(e,n,t){let l=this,o=f.defaultcollen,a=f.defaultrowlen,s=e[n][t];if(!!s&&s.mc!=null){let u=s.mc,h=l.mergeborer(e,u.r,u.c);if(h){let d=h.row[1],m=h.row[0],p=h.row[2],v=h.row[3],y=h.column[1],k=h.column[0],b=h.column[2],w=h.column[3];o=y-k-1,a=d-m-1}}else{let u=At()[Z(f.currentSheetIndex)].config;u.columnlen!=null&&u.columnlen[t]!=null&&(o=u.columnlen[t]),u.rowlen!=null&&u.rowlen[n]!=null&&(a=u.rowlen[n])}return[o,a]},getTextHeightCache:{},getTextSize:function(e,n){let t=Q().fontarray,l=n||"10pt "+t[0],o=this;if(l in o.getTextHeightCache)return o.getTextHeightCache[l];$("#luckysheetTextSizeTest").length==0&&$('<span id="luckysheetTextSizeTest" style="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;">'+e+"</span>").appendTo($("body"));let a=$("#luckysheetTextSizeTest").text(e).css({font:l}),s=a.innerWidth(),u=a.innerHeight();return o.getTextHeightCache[l]=[s,u],[s,u]},activeFormulaInput:function(e,n,t,l,o,a){let s=this;if(a==null&&(a=!1),Rl(e,n,f.flowdata,!0),a){let v='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(v);let y=window.getSelection(),k=$("#luckysheet-rich-text-editor").find("span");g.setCaretPosition(k.get(k.length-2),0,1);return}let u=tl(t[0])[0],h=tl(t[1])[1],d=Rt(l[0])[0],m=Rt(l[1])[1],p='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span class="luckysheet-formula-functionrange-cell" rangeindex="0" dir="auto" style="color:'+Gl[0]+';">'+Mt(f.currentSheetIndex,{row:t,column:l},f.currentSheetIndex)+'</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(p),g.israngeseleciton(),g.rangestart=!0,g.rangedrag_column_start=!1,g.rangedrag_row_start=!1,g.rangechangeindex=0,g.rangeSetValue({row:t,column:l}),g.func_selectedrange={left:d,width:m-d-1,top:u,height:h-u-1,left_move:d,width_move:m-d-1,top_move:u,height_move:h-u-1,row:[e,e],column:[n,n]},$("#luckysheet-formula-functionrange-select").css({left:d,width:m-d-1,top:u,height:h-u-1}).show(),$("#luckysheet-formula-help-c").hide()},backFormulaInput:function(e,n,t,l,o,a){let s=this,u="="+a.toUpperCase()+"("+Mt(f.currentSheetIndex,{row:l,column:o},f.currentSheetIndex)+")",h=g.execfunction(u,n,t),d={v:h[1],f:h[2]};Ht(n,t,e,d),g.execFunctionExist.push({r:n,c:t,i:f.currentSheetIndex}),ne.historyParam(e,f.currentSheetIndex,{row:[n,n],column:[t,t]})},checkNoNullValue:function(e){let n=e;return N(n)=="object"&&(n=n.v),!!(!me(n)&&Nn(n).num&&(e.ct==null||e.ct.t==null||e.ct.t=="n"||e.ct.t=="g"))},checkNoNullValueAll:function(e){let n=e;return N(n)=="object"&&(n=n.v),!me(n)},getNoNullValue:function(e,n,t,l){let o=this,a=0,s=null,u=0,h=0;for(let d=t-1;d>=0;d--){let m;if(l=="c"?m=e[n][d]:m=e[d][n],o.checkNoNullValue(m))a++,s=d;else if(m==null||m.v==null||m.v==""){if(u++,u>=40)if(h<=0)h=1;else break}else break}return s},singleFormulaInput:function(e,n,t,l,o,a,s,u,h){let d=this;s==null&&(s="r"),u==null&&(u=!0),h==null&&(h=!0);let m=!0,p=!1;for(let v=l;v<=o;v++){let y=null;s=="c"?y=e[v][t]:y=e[t][v],d.checkNoNullValue(y)?(m=!1,p=!0):d.checkNoNullValueAll(y)&&(m=!1)}if(m&&h)if(d.getNoNullValue(e,n,t,s)==null)s=="c"?d.activeFormulaInput(n,t,null,null,a,!0):d.activeFormulaInput(t,n,null,null,a,!0);else if(n==l)for(let y=l;y<=o;y++){let k=d.getNoNullValue(e,y,t,s);if(k==null)break;s=="c"?d.backFormulaInput(e,y,t,[y,y],[k,t-1],a):d.backFormulaInput(e,t,y,[k,t-1],[y,y],a)}else for(let y=o;y>=l;y--){let k=d.getNoNullValue(e,y,t,s);if(k==null)break;s=="c"?d.backFormulaInput(e,y,t,[y,y],[k,t-1],a):d.backFormulaInput(e,t,y,[k,t-1],[y,y],a)}else if(p&&u){let v=null;if(s=="c"?v=e[o+1][t]:v=e[t][o+1],v!=null&&v.v!=null&&v.v.toString().length>0){let y=o+1;for(s=="c"?v=e[o+1][t]:v=e[t][o+1];v!=null&&v.v!=null&&v.v.toString().length>0;){y++;let k=null;if(s=="c"?k=e.length:k=e[0].length,y>=k)return;s=="c"?v=e[y][t]:v=e[t][y]}s=="c"?d.backFormulaInput(e,y,t,[l,o],[t,t],a):d.backFormulaInput(e,t,y,[t,t],[l,o],a)}else s=="c"?d.backFormulaInput(e,o+1,t,[l,o],[t,t],a):d.backFormulaInput(e,t,o+1,[t,t],[l,o],a)}else return!0},autoSelectionFormula:function(e){let n=this,t=xe.deepCopyFlowData(f.flowdata),l=40,o=!0;g.execFunctionExist=[];let a=function(u,h,d,m,p,v){let y=n.getNoNullValue(u,h,p,"c");y==null?n.activeFormulaInput(h,m,null,null,v,!0):n.activeFormulaInput(h,m,[h,d],[y,p-1],v)},s=function(u,h,d,m,p,v){let y=n.getNoNullValue(u,m,d,"r");y==null?a(u,h,d,m,p,v):n.activeFormulaInput(h,m,[y,d-1],[m,p],v)};for(let u=0;u<f.luckysheet_select_save.length;u++){let h=f.luckysheet_select_save[u].row[0],d=f.luckysheet_select_save[u].row[1],m=f.luckysheet_select_save[u].column[0],p=f.luckysheet_select_save[u].column[1],v=f.luckysheet_select_save[u].row_focus,y=f.luckysheet_select_save[u].column_focus;if(h==d&&m==p){if(d-1<0&&p-1<0){n.activeFormulaInput(h,m,null,null,e,!0);return}d-1>=0&&n.checkNoNullValue(t[d-1][m])?s(t,h,d,m,p,e):p-1>=0&&n.checkNoNullValue(t[h][p-1])?a(t,h,d,m,p,e):s(t,h,d,m,p,e)}else if(h==d)o=n.singleFormulaInput(t,y,h,m,p,e,"r");else if(m==p)o=n.singleFormulaInput(t,v,m,h,d,e,"c");else{let k=!0;for(let w=h;w<=d;w++)k=n.singleFormulaInput(t,y,w,m,p,e,"r",!0,!1)&&k;let b=!0;for(let w=m;w<=p;w++)b=n.singleFormulaInput(t,v,w,h,d,e,"c",!0,!1)&&b;o=!!k&&!!b}o=o&&o}o||(g.execFunctionExist.reverse(),g.execFunctionGroup(null,null,null,null,t),Ze(t,f.luckysheet_select_save),clearTimeout(f.jfcountfuncTimeout),f.jfcountfuncTimeout=setTimeout(function(){bl()},500))},getStyleByCell:function(e,n,t){let l=this,o="",a=el.getComputeMap(),s=el.checksAF(n,t,a),u=Se.getComputeMap(),h=Se.checksCF(n,t,u),d=Q().fontarray,m=e[n][t],p=m.ct,v=!1;_l(m)&&(v=!0);for(let y in m){let k=l.checkstatus(e,n,t,y);(s!=null||h!=null&&h.cellColor!=null)&&(h!=null&&h.cellColor!=null?o+="background: "+h.cellColor+";":s!=null&&(o+="background: "+s[1]+";")),N(k)!="object"&&((y=="bg"||s!=null||h!=null&&h.cellColor!=null)&&(h!=null&&h.cellColor!=null?o+="background: "+h.cellColor+";":s!=null?o+="background: "+s[1]+";":o+="background: "+k+";"),y=="ht"&&k!="1"&&(k=="0"?o+="text-align: center;":k=="2"&&(o+="text-align: right;")),y=="vt"&&(k=="0"?o+="vertical-align: middle;":k=="1"?o+="vertical-align: top;":k=="2"&&(o+="vertical-align: bottom;")),y=="un"&&k&&(o+="text-decoration:underline;"))}return v||(o+=_o(m,s,h)),o},fontSelectList:[],defualtFont:["Times New Roman","Arial","Tahoma","Verdana","\u5FAE\u8F6F\u96C5\u9ED1","\u5B8B\u4F53","\u9ED1\u4F53","\u6977\u4F53","\u4EFF\u5B8B","\u65B0\u5B8B\u4F53","\u534E\u6587\u65B0\u9B4F","\u534E\u6587\u884C\u6977","\u534E\u6587\u96B6\u4E66"],addFontTolist:function(e){e=e.replace(/"/g,"").replace(/'/g,"");let n=!0;for(let o=0;o<this.fontSelectList.length;o++)if(this.fontSelectList[o].value==e){n=!1;break}let l=Q().fontjson;if(e in l&&(n=!1),n){let o={};o.value=e,o.index=this.fontSelectList.length,o.type="userDefined",o.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+e+"'>"+e+"</span>",o.example="",this.fontSelectList.push(o);let a=$("#luckysheet-icon-font-family-menuButton"),s=this.createButtonMenu(this.fontSelectList);a.html(s)}},fontInitial:function(e){let n=[],t=Q().fontarray;for(let l=0;l<t.length;l++){let o=t[l],a={};a.value=o,a.index=l,a.type="inner",a.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+o+"'>"+o+"</span>",a.example="",n.push(a)}if(e!=null){for(let l=0;l<e.length;l++){let o=e[l],a={};if(a.value=o.fontName,a.index=l,a.type="userDefined",a.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+o.fontName+"'>"+o.fontName+"</span>",a.example="",n.push(a),document.fonts&&!document.fonts.check("12px "+o.fontName)&&o.url){let s=new FontFace(o.fontName,`url(${o.url})`);document.fonts.add(s),s.load()}}document.fonts&&document.fonts.ready.then(function(){})}this.fontSelectList=n}},be=F0});function Pc(e,n){let t={};for(let l in e)t[l]=e[l];for(let l in n)n[l]!=null&&(t[l]=n[l]);return t}function _e(e,n){return e.replace(/\$\{([\w]+)\}/g,(t,l)=>{let o=n[l];return typeof o!="undefined"?o:t})}function N(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}function La(e){let n=new Date,t=n.getFullYear(),l=n.getMonth(),o=n.getDate(),a=n.getHours(),s=n.getMinutes(),u=n.getSeconds();l=l+1,l<10&&(l="0"+l),o<10&&(o="0"+o),a<10&&(a="0"+a),s<10&&(s="0"+s),u<10&&(u="0"+u);let h="";return e==1?h=t+"-"+l+"-"+o:e==2&&(h=t+"-"+l+"-"+o+" "+a+":"+s+":"+u),h}function Pn(e){let n;e.indexOf("rgba")>-1?n=e.replace("rgba(","").replace(")","").split(","):n=e.replace("rgb(","").replace(")","").split(",");let t=parseInt(n[0]),l=parseInt(n[1]),o=parseInt(n[2]);return"#"+((1<<24)+(t<<16)+(l<<8)+o).toString(16).slice(1)}function fl(e){if(e==null||e.length==0)return NaN;let n=e.toLowerCase().split(""),t=n.length,l=a=>a.charCodeAt()-96,o=0;for(let a=0;a<t;a++)o+=l(n[a])*Math.pow(26,t-a-1);return o==0?NaN:o-1}function tt(e){let n="a".charCodeAt(0),l="z".charCodeAt(0)-n+1,o="";for(;e>=0;)o=String.fromCharCode(e%l+n)+o,e=Math.floor(e/l)-1;return o.toUpperCase()}function vi(e,n){if(n===0)return"";if(e==null)return 0;let t=0;for(let l=0;l<e.length;l++)if(e.charAt(l).match(/[^\x00-\xff]/ig)!=null?t+=2:t+=1,B(n)&&t===~~n)return e.substring(0,l);return t}function Nc(e){let n=[],t={};if(e.length>0)for(let l=0;l<e.length;l++){let o=e[l];t[o]||(n.push(o),t[o]=1)}return n}function oi(e){let n=Q().fontarray;if(N(e)=="object"){let t="";if(e.it=="0"||e.it==null?t+="normal ":t+="italic ",t+="normal ",e.bl=="0"||e.bl==null?t+="normal ":t+="bold ",e.fs?t+=Math.ceil(e.fs)+"pt ":t+=f.defaultFontSize+"pt ",!e.ff)t+=n[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';else{let l=null,o=Q().fontjson;Nn(e.ff).num?l=n[parseInt(e.ff)]:(l=e.ff,l=l.replace(/"/g,"").replace(/'/g,""),l.indexOf(" ")>-1&&(l='"'+l+'"'),l!=null&&document.fonts&&!document.fonts.check("12px "+l)&&be.addFontTolist(l)),l==null&&(l=n[0]),t+=l+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'}return t}else return Yn()}function on(e,n,t){let l=$(window).height(),o=$(window).width(),a=e.width(),s=e.height(),u=t,h=n;n+a>o&&(h=n-a),t+s>l&&(u=t-s),u<0&&(u=0),e.css({top:u,left:h}).show()}function Dr(){f.fullscreenmode&&setTimeout(function(){document.getElementById("luckysheet-rich-text-editor").focus({preventScroll:!0}),$("#luckysheet-rich-text-editor").select()},50)}function rt(){document.getElementById(f.container).focus({preventScroll:!0})}function Il(e,n){if(e==null||isNaN(parseFloat(e))||Tn(e)||e==-Infinity||e==Infinity)return null;let t=6,l=!1;n==null||n=="auto"?e<1?t=6:t=1:tr(n)=="num"?(t=parseInt(n),l=!0):t=6;let o="",a=null;for(let s=0;s<t;s++)o+="0";return l||(o="["+o+"]"),e>=1e21?a=parseFloat((0,Ea.default)(e).value()):a=parseFloat((0,Ea.default)(e).format("0."+o)),a}function Ks(e){if(e!=null&&!isNaN(parseFloat(e))&&!Tn(e)){let t=(0,Ea.default)(e).value().toString().split(".");return t.length==1?t=0:t=t[1].length,t}else return null}function ml(e,n,t,l){let o=$(window).height(),a=$(window).width(),s=e.width(),u=e.height(),h=t,d=n;l==null&&(l="lefttop"),l=="lefttop"?e.css({top:t,left:n}).show():l=="righttop"?e.css({top:t,left:n-s}).show():l=="leftbottom"?e.css({bottom:o-t-12,left:n}).show():l=="rightbottom"&&e.css({bottom:o-t-12,left:n-s}).show()}function Ge(e,n){n=n||document;var t=n.querySelectorAll(e);return t.length==1?Array.prototype.slice.call(t)[0]:Array.prototype.slice.call(t)}function Vh(e){if(e==null||e.length===0)return null;let n=e.split(","),t="";for(let l=0;l<n.length;l++){let a=n[l].split("!"),s="",u="";a.length>1?(s=a[0],u=a[1]):u=a[0];let h=u.split(":"),d="";for(let m=0;m<h.length;m++){let p=h[m],v=p.replace(/[^0-9]/g,""),y=p.replace(/[^A-Za-z]/g,""),k="";y!=""&&(k+="$"+y),v!=""&&(k+="$"+v),d+=k+":"}d=d.substr(0,d.length-1),t+=s+d+","}return t.substr(0,t.length-1)}function di(e,n=!0){let t=$("#"+e).find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),h=$(document).scrollTop();t.css({left:(a+u-o)/2,top:(s+h-l)/3}).show(),n&&$("#luckysheet-modal-dialog-mask").show()}function D0(e,n,t,l){e[n]=new Proxy(t,{set(o,a,s,u){return setTimeout(()=>{l(o,a,s,u)},0),Reflect.set(o,a,s,u)}})}function M0(e,n,t,l){Object.defineProperty(e,n,{enumerable:!0,configurable:!1,get(){return t},set(o){t!==o&&(console.log(`\u53D1\u73B0 ${n} \u5C5E\u6027 ${t} -> ${o}`),setTimeout(()=>{l(t,o)},0),t=o)}})}function od(e,n){e.some((t,l,o)=>{if(t===n)return o.splice(l,1),t===n})}function Sn(e){return e.replace(/([A-Z])/g,(n,t)=>"-"+t.toLowerCase())}var Ea,Oa,ht=Me(()=>{Wt();ol();Lr();Nt();Ke();kt();Ea=El(ai());Oa=(e,n,t)=>{if(!Object.prototype.hasOwnProperty.call(e,n)){console.info("No %s in data",n);return}N(e)==="object"&&(N(e[n])==="object"||N(e[n])==="array"?D0(e,n,e[n],t):M0(e,n,e[n],t))}});function Ec(){f.cellMainSrollBarSize=0;let e=!1,n={},t=!1,l=null;$(document).on("touchstart","#luckysheet-grid-window-1",function(o){clearInterval(l),e=!0;let a=o.originalEvent.targetTouches[0];n={x:a.pageX,y:a.pageY,vy:0,moveType:"y"}}),$(document).on("touchmove","#luckysheet-grid-window-1",function(o){if(o.originalEvent.targetTouches.length>1||o.scale&&o.scale!==1)return;let a=o.originalEvent.targetTouches[0];if(e){let s=a.pageX-n.x,u=a.pageY-n.y;n.x=a.pageX,n.y=a.pageY;let h=$("#luckysheet-scrollbar-x").scrollLeft(),d=$("#luckysheet-scrollbar-y").scrollTop();h-=s,d-=u,h<0&&(h=0),d<0&&(d=0),$("#luckysheet-scrollbar-y").scrollTop(d),n.vy_y=u,n.scrollTop=d,$("#luckysheet-scrollbar-x").scrollLeft(h),n.vy_x=s,n.scrollLeft=h}else if(t){let s=ut(a.pageX,a.pageY),u=s[0]+$("#luckysheet-cell-main").scrollLeft(),h=s[1]+$("#luckysheet-cell-main").scrollTop(),d=$t(h),m=d[1],p=d[0],v=d[2],y=_t(u),k=y[1],b=y[0],w=y[2],x=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),C=0,S=0,_=[];x.top>p?(C=p,S=x.top+x.height-p,x.row[1]>x.row_focus&&(x.row[1]=x.row_focus),_=[v,x.row[1]]):x.top==p?(C=p,S=x.top+x.height-p,_=[v,x.row[0]]):(C=x.top,S=m-x.top-1,x.row[0]<x.row_focus&&(x.row[0]=x.row_focus),_=[x.row[0],v]);let T=0,F=0,R=[];x.left>b?(T=b,F=x.left+x.width-b,x.column[1]>x.column_focus&&(x.column[1]=x.column_focus),R=[w,x.column[1]]):x.left==b?(T=b,F=x.left+x.width-b,R=[w,x.column[0]]):(T=x.left,F=k-x.left-1,x.column[0]<x.column_focus&&(x.column[0]=x.column_focus),R=[x.column[0],w]);let I=be.mergeMoveMain(R,_,x,C,S,T,F);I!=null&&(R=I[0],_=I[1],C=I[2],S=I[3],T=I[4],F=I[5]),x.row=_,x.column=R,x.left_move=T,x.width_move=F,x.top_move=C,x.height_move=S,f.luckysheet_select_save[f.luckysheet_select_save.length-1]=x,lt(),Y.scrollFreezen()}o.stopPropagation()}),$(document).on("touchend",function(o){if(e){let a=Math.abs(n.vy_x),s=((a>>31)*2+1)*.25,u=Math.abs(n.vy_y),h=((u>>31)*2+1)*.25;(a>0||u>0)&&(l=setInterval(function(){a-=s,u-=h,a<=0&&(a=0),u<=0&&(u=0),n.vy_y>0?n.scrollTop-=u:n.scrollTop+=u,$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop),n.vy_x>0?n.scrollLeft-=a:n.scrollLeft+=a,$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft),a<=0&&u<=0&&clearInterval(l)},20))}e=!1,t=!1}),$(document).on("touchstart",".luckysheet-cs-touchhandle",function(o){t=!0,e=!1,o.stopPropagation()}),document.addEventListener("touchmove",function(o){o.preventDefault()},{passive:!1})}var Nd=Me(()=>{Zl();Zt();ol();Hl();Ke()});var A0,Lc,Ed=Me(()=>{ht();Wt();Zt();ll();Jt();$r();Kt();Yt();Ke();kt();A0={createDialog:function(){let e=this,n=Q(),t=n.splitText,l=n.punctuation,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-splitColumn-dialog").remove();let a='<div class="box"><div class="boxTitle">'+t.splitDelimiters+'</div><div class="boxMain"><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_01" type="checkbox"/><label for="splitColumn_type_01">'+l.tab+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_02" type="checkbox"/><label for="splitColumn_type_02">'+l.semicolon+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_03" type="checkbox"/><label for="splitColumn_type_03">'+l.comma+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_04" type="checkbox"/><label for="splitColumn_type_04">'+l.space+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_05" type="checkbox"/><label for="splitColumn_type_05">'+t.splitOther+'</label><input type="text" class="formulaInputFocus" maxlength="1"/></div></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_06" type="checkbox"/><label for="splitColumn_type_06">'+t.splitContinueSymbol+'</label></div><div class="boxTitle" style="margin-top: 10px;">'+t.splitDataPreview+'</div><div class="boxMain" id="splitColumnData"></div></div>';$("body").append(_e(dt,{id:"luckysheet-splitColumn-dialog",addclass:"luckysheet-splitColumn-dialog",title:t.splitTextTitle,content:a,botton:'<button id="luckysheet-splitColumn-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let s=$("#luckysheet-splitColumn-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),u=s.outerHeight(),h=s.outerWidth(),d=$(window).width(),m=$(window).height(),p=$(document).scrollLeft(),v=$(document).scrollTop();$("#luckysheet-splitColumn-dialog").css({left:(d+p-h)/2,top:(m+v-u)/3}).show();let y=e.getDataArr();e.dataPreview(y)},init:function(){let e=this,t=Q().splitText;$(document).off("change.SPCinpcheckbox").on("change.SPCcheckbox","#luckysheet-splitColumn-dialog .box input[type='checkbox']",function(){let l=e.getRegStr(),o=e.getDataArr(l);e.dataPreview(o)}),$(document).off("keyup.SPCinptext").on("keyup.SPCinptext","#luckysheet-splitColumn-dialog .box input[type='text']",function(){if($(this).siblings("input[type='checkbox']").is(":checked")){let l=e.getRegStr(),o=e.getDataArr(l);e.dataPreview(o)}}),$(document).off("click.SPCconfirm").on("click.SPCconfirm","#luckysheet-splitColumn-dialog #luckysheet-splitColumn-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-splitColumn-dialog").hide();let l=e.getRegStr(),o=e.getDataArr(l),a=f.luckysheet_select_save[0].row[0],s=f.luckysheet_select_save[0].column[0];if(o[0].length==1)return;let u=!1;for(let h=0;h<o.length;h++)for(let d=1;d<o[0].length;d++){let m=f.flowdata[a+h][s+d];if(m!=null&&m.v!=null){u=!0;break}}if(u){let h=function(){e.update(a,s,o)};W.confirm("",t.splitConfirmToExe,h)}else e.update(a,s,o)})},update:function(e,n,t){let l=xe.deepCopyFlowData(f.flowdata);for(let u=0;u<t.length;u++)for(let h=0;h<t[0].length;h++){let d=t[u][h];Ht(e+u,n+h,l,d)}let o=f.luckysheet_select_save[0].row[0],a=f.luckysheet_select_save[0].column[0],s=[{row:[o,o+t.length-1],column:[a,a+t[0].length-1]}];Ze(l,s),lt()},dataPreview:function(e){$("#luckysheet-splitColumn-dialog #splitColumnData").empty();let n="";for(let l=0;l<e.length;l++){let o="";for(let a=0;a<e[0].length;a++)o+="<td>"+e[l][a]+"</td>";n+="<tr>"+o+"</tr>"}let t="<table>"+n+"</table>";$("#luckysheet-splitColumn-dialog #splitColumnData").append(t)},getRegStr:function(){let e="",n=0;return $("#luckysheet-splitColumn-dialog .box input[type='checkbox']:checked").each(function(t,l){let o=$(l).attr("id");if(o=="splitColumn_type_01")e+="\\t",n++;else if(o=="splitColumn_type_02")n>0&&(e+="|"),e+=";",n++;else if(o=="splitColumn_type_03")n>0&&(e+="|"),e+=",",n++;else if(o=="splitColumn_type_04")n>0&&(e+="|"),e+="\\s",n++;else if(o=="splitColumn_type_05"){let a=$(l).siblings("input[type='text']").val().trim();a!=""&&(n>0&&(e+="|"),e+=a)}else o=="splitColumn_type_06"&&(e="["+e+"]+")}),e},getDataArr:function(e){let n=this,t=[],l=f.luckysheet_select_save[0].row[0],o=f.luckysheet_select_save[0].row[1],a=f.luckysheet_select_save[0].column[0];if(e!=null&&e!=""){let s=new RegExp(e,"g"),u=[];for(let m=l;m<=o;m++){let p=[],v=f.flowdata[m][a],y;v!=null&&v.m!=null?y=v.m:y=Le(m,a,f.flowdata),y==null&&(y=""),p=y.toString().split(s),u.push(p)}let h=u.length,d=0;for(let m=0;m<h;m++)u[m].length>d&&(d=u[m].length);t=n.getNullData(h,d);for(let m=0;m<t.length;m++)for(let p=0;p<t[0].length;p++)u[m][p]!=null&&(t[m][p]=u[m][p])}else for(let s=l;s<=o;s++){let u=[],h=f.flowdata[s][a],d;h!=null&&h.m!=null?d=h.m:d=Le(s,a,f.flowdata),d==null&&(d=""),u.push(d),t.push(u)}return t},getNullData:function(e,n){let t=[];for(let l=0;l<e;l++){let o=[];for(let a=0;a<n;a++)o.push("");t.push(o)}return t}},Lc=A0});function z0(){let n=Q().cellFormat;$("#luckysheet-cellFormat-confirm").click(function(){let t=$("#luckysheet-protection-check-locked").is(":checked"),l=$("#luckysheet-protection-check-hidden").is(":checked");t=t==!0?1:0,l=l==!0?1:0;let o=Od(function(a,s,u,h){a==null?Ht(s,u,h,{lo:t,hi:l}):(a.lo=t,a.hi=l)},function(){alert(n.sheetDataIsNullAlert)});Ze(o,void 0,void 0,!1),$("#luckysheet-cellFormat-config").hide(),$("#luckysheet-modal-dialog-mask").hide()})}function Od(e,n){if(f.luckysheet_select_save!=null&&f.luckysheet_select_save.length>0){let t=ye.getSheetByIndex(),l=t.data;if(l!=null)for(let o=0;o<f.luckysheet_select_save.length;o++){let a=f.luckysheet_select_save[o],s=a.row,u=a.column;for(let h=s[0];h<=s[1];h++)for(let d=u[0];d<=u[1];d++){let m,p=be.mergeborer(l,h,d);if(p){let v=p.row[2],y=p.column[2];m=l[v][y]}else m=l[h][d];e(m,h,d,l)}}else n();return l}}function P0(){if(Ld)return;Ld=!0;let e=Q(),n=e.cellFormat,t=e.button;$("body").append(_e(dt,{id:"luckysheet-cellFormat-config",addclass:"luckysheet-cellFormat-config",title:n.cellFormatTitle,content:`
            <div class="luckysheet-cellFormat-menu-c">
                <div class="luckysheet-cellFormat-menu luckysheet-cellFormat-menu-active" id="luckysheet-cellFormat-protection">
                    ${n.protection}
                </div>
            </div>
            <div id="luckysheet-cellFormat-protection-content" class="luckysheet-cellFormat-content">
                <div class="luckysheet-cellFormat-protection">
                    <p>
                        ${n.protectionTips}
                    </p>
                    <label for="luckysheet-protection-check-locked"><input id="luckysheet-protection-check-locked" name="luckysheet-protection-check-locked" type="checkbox">${n.locked}</label><span>\u90E8\u5206\u9009\u4E2D</span>
                    <br/>
                    <label for="luckysheet-protection-check-hidden"><input id="luckysheet-protection-check-hidden" name="luckysheet-protection-check-hidden" type="checkbox">${n.hidden}</label><span>\u5168\u90E8\u9009\u4E2D</span>
                </div>
            </div>
        `,botton:`<button id="luckysheet-cellFormat-confirm" class="btn btn-primary">${t.confirm}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${t.cancel}</button>`,style:"z-index:100003"})),z0()}function Bd(){P0();let e=Q(),n=e.cellFormat,t=e.button;if($("#luckysheet-rightclick-menu").hide(),!jr(f.currentSheetIndex))return;let l=!1,o=!1,a=0,s=0,u=0;if(f.luckysheet_select_save!=null&&f.luckysheet_select_save.length>0)Od(function(m){(m==null||m.lo==null||m.lo==1)&&(l=!0,a++),m!=null&&m.hi==1&&(o=!0,s++),u++},function(){l=!0});else{alert(n.selectionIsNullAlert);return}let h="",d="";l&&(h=a==u?n.tipsAll:n.tipsPart),o&&(d=s==u?n.tipsAll:n.tipsPart),$("#luckysheet-protection-check-locked").prop("checked",l).parent().next().html(h),$("#luckysheet-protection-check-hidden").prop("checked",o).parent().next().html(d),di("luckysheet-cellFormat-config")}var Ld,Hd=Me(()=>{Ke();ht();Wt();dl();ol();Ml();Yt();kt();$r();Ld=!1});function Ba(e){let n=$("#luckysheet-cell-main"),t=$("#luckysheet-scrollbar-x").scrollLeft(),l=$("#luckysheet-scrollbar-y").scrollTop(),o=$("#luckysheetTableContent").height();if(Y.freezenhorizontaldata!=null&&l<Y.freezenhorizontaldata[2]){l=Y.freezenhorizontaldata[2],$("#luckysheet-scrollbar-y").scrollTop(l);return}if(Y.freezenverticaldata!=null&&t<Y.freezenverticaldata[2]){t=Y.freezenverticaldata[2],$("#luckysheet-scrollbar-x").scrollLeft(t);return}$("#luckysheet-cols-h-c").scrollLeft(t),$("#luckysheet-rows-h").scrollTop(l),n.scrollLeft(t).scrollTop(l),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")}).show(),Be(t,l),$("#luckysheet-bottom-controll-row").css("left",t),(Y.freezenhorizontaldata!=null||Y.freezenverticaldata!=null)&&Y.scrollAdapt(),!!Je.createHookFunction("scroll",{scrollLeft:t,scrollTop:l,canvasHeight:o})}var Vd=Me(()=>{Hl();Nr();Yt();Ke();Nl()});function Oc(){let e=fr.detectOS();fr.mobilecheck()&&Ec(),Date.now||(Date.now=function(){return new Date().getTime()}),function(){"use strict";for(var p=["webkit","moz"],v=0;v<p.length&&!window.requestAnimationFrame;++v){var y=p[v];window.requestAnimationFrame=window[y+"RequestAnimationFrame"],window.cancelAnimationFrame=window[y+"CancelAnimationFrame"]||window[y+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var k=0;window.requestAnimationFrame=function(b){var w=Date.now(),x=Math.max(k+16,w);return setTimeout(function(){b(k=x)},x-w)},window.cancelAnimationFrame=clearTimeout}}(),$("#luckysheet-sheet-container-c").mousewheel(function(p,v){let y=p.deltaFactor<40?1:p.deltaFactor<80?2:3,k=$(this).scrollLeft();p.deltaY!=0?p.deltaY<0?k=k+10*y:k=k-10*y:p.deltaX!=0&&(p.deltaX>0?k=k+10*y:k=k-10*y),$(this).scrollLeft(k),p.preventDefault()}),$("#luckysheet-cell-main").scroll(function(){}).mousewheel(function(p,v){p.preventDefault()});let t=Q(),l=t.drag,o=t.info,a,s;$("#luckysheet-grid-window-1").mousewheel(function(p,v){let y=$("#luckysheet-scrollbar-x").scrollLeft(),k=$("#luckysheet-scrollbar-y").scrollTop(),b=f.visibledatacolumn,w=f.visibledatarow;Y.freezenhorizontaldata!=null&&(w=Y.freezenhorizontaldata[3]),Y.freezenverticaldata!=null&&(b=Y.freezenverticaldata[3]),clearTimeout(s),f.visibledatacolumn_unique!=null?b=f.visibledatacolumn_unique:(b=Nc(b),f.visibledatacolumn_unique=b),f.visibledatarow_unique!=null?w=f.visibledatarow_unique:(w=Nc(w),f.visibledatarow_unique=w);let x=at(b,y),C=at(w,k);Y.freezenhorizontaldata!=null&&(C=at(w,k+Y.freezenhorizontaldata[0]));let S=0,_=0,T=p.deltaFactor<40?1:p.deltaFactor<80?2:3;if(p.deltaY!=0){let F,R=Math.round(T/f.zoomRatio);R=R<1?1:R,p.deltaY<0?(F=C+R,F>=w.length&&(F=w.length-1)):(F=C-R,F<0&&(F=0)),_=F==0?0:w[F-1],Y.freezenhorizontaldata!=null&&(_-=Y.freezenhorizontaldata[0]),$("#luckysheet-scrollbar-y").scrollTop(_)}else if(p.deltaX!=0){let F;p.deltaX>0?y=y+20*f.zoomRatio:y=y-20*f.zoomRatio,$("#luckysheet-scrollbar-x").scrollLeft(y)}s=setTimeout(()=>{f.visibledatacolumn_unique=null,f.visibledatarow_unique=null},500)}),$("#luckysheet-scrollbar-x").scroll(function(){Ba()}).mousewheel(function(p,v){p.preventDefault()}),$("#luckysheet-scrollbar-y").scroll(function(){Ba()}).mousewheel(function(p,v){p.preventDefault()}),$(window).resize(function(){document.getElementById(f.container)&&Ot()}),$("#luckysheet-rich-text-editor").mouseup(function(p){be.inputMenuButtonFocus(p.target)}),$("#luckysheet-cell-main, #luckysheetTableContent").mousedown(function(p){if($(p.target).hasClass("luckysheet-mousedown-cancel"))return;N0(),$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","default").end().find(".luckysheet-cs-draghandle").css("cursor","default"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),He.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Ie.cancelActiveImgItem();let v=ut(p.pageX,p.pageY);if(v[0]>=f.cellmainWidth-f.cellMainSrollBarSize||v[1]>=f.cellmainHeight-f.cellMainSrollBarSize)return;let y=v[0]+$("#luckysheet-cell-main").scrollLeft(),k=v[1]+$("#luckysheet-cell-main").scrollTop();Y.freezenverticaldata!=null&&v[0]<Y.freezenverticaldata[0]-Y.freezenverticaldata[2]&&(y=v[0]+Y.freezenverticaldata[2]),Y.freezenhorizontaldata!=null&&v[1]<Y.freezenhorizontaldata[0]-Y.freezenhorizontaldata[2]&&(k=v[1]+Y.freezenhorizontaldata[2]);let b=ye.getSheetByIndex(),w=$("#luckysheetTableContent").get(0).getContext("2d"),x=$t(k),C=x[1],S=x[0],_=x[2],T=_t(y),F=T[1],R=T[0],I=T[2],P=_,O=I,M=be.mergeborer(f.flowdata,_,I);if(M&&(C=M.row[1],S=M.row[0],_=M.row[2],P=M.row[3],F=M.column[1],R=M.column[0],I=M.column[2],O=M.column[3]),!Je.createHookFunction("cellMousedownBefore",f.flowdata[_][I],{r:_,c:I,start_r:S,start_c:R,end_r:C,end_c:F},b,w))return;if(Ye.cellFocus(_,I,!0),R<$("#luckysheet-cell-main").scrollLeft()&&$("#luckysheet-scrollbar-x").scrollLeft(R),S<$("#luckysheet-cell-main").scrollTop()&&$("#luckysheet-scrollbar-y").scrollTop(S),p.which=="3"){$("#luckysheet-dataVerification-showHintBox").hide();let z=!1;for(let L=0;L<f.luckysheet_select_save.length;L++)if(f.luckysheet_select_save[L].row!=null&&_>=f.luckysheet_select_save[L].row[0]&&_<=f.luckysheet_select_save[L].row[1]&&I>=f.luckysheet_select_save[L].column[0]&&I<=f.luckysheet_select_save[L].column[1]){z=!0;break}if(z)return}if(f.flowdata[_]!=null&&f.flowdata[_][I]!=null&&f.flowdata[_][I].dd!=null&&de.fireMousedown!=null&&N(de.fireMousedown)=="function"){de.fireMousedown(f.flowdata[_][I].dd);return}if(Cl.hyperlink&&Cl.hyperlink[_+"_"+I]&&p.which!="3"){Cl.cellFocus(_,I);return}f.luckysheet_scroll_status=!0;let A=$("#luckysheet-input-box");if(parseInt(A.css("top"))>0)if(g.rangestart||g.rangedrag_column_start||g.rangedrag_row_start||g.israngeseleciton()){let z=[_,P],L=[I,O],E=R,V=F-R-1,q=S,G=C-S-1;if(p.shiftKey){let X=g.func_selectedrange,ee=0,le=0,se=[];X.top>S?(ee=S,le=X.top+X.height-S,X.row[1]>X.row_focus&&(X.row[1]=X.row_focus),se=[_,X.row[1]]):X.top==S?(ee=S,le=X.top+X.height-S,se=[_,X.row[0]]):(ee=X.top,le=C-X.top-1,X.row[0]<X.row_focus&&(X.row[0]=X.row_focus),se=[X.row[0],_]);let ae=0,ue=0,fe=[];X.left>R?(ae=R,ue=X.left+X.width-R,X.column[1]>X.column_focus&&(X.column[1]=X.column_focus),fe=[I,X.column[1]]):X.left==R?(ae=R,ue=X.left+X.width-R,fe=[I,X.column[0]]):(ae=X.left,ue=F-X.left-1,X.column[0]<X.column_focus&&(X.column[0]=X.column_focus),fe=[X.column[0],I]);let ce=be.mergeMoveMain(fe,se,X,ee,le,ae,ue);ce!=null&&(fe=ce[0],se=ce[1],ee=ce[2],le=ce[3],ae=ce[4],ue=ce[5]),or(ae,ee,ue,le,se,fe),X.row=se,X.column=fe,X.left_move=ae,X.width_move=ue,X.top_move=ee,X.height_move=le,g.func_selectedrange=X}else if(p.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let X=$("#luckysheet-rich-text-editor").text();if(X[X.length-1]===")"&&(X=X.substr(0,X.length-1)),X.length>0){let ee=X.substr(X.length-1,1);ee!=","&&ee!="="&&ee!="("&&(X+=",")}if(X.length>0&&X.substr(0,1)=="="){if(X=g.functionHTMLGenerate(X),window.getSelection){let ee=window.getSelection();g.functionRangeIndex=[$(ee.anchorNode).parent().index(),ee.anchorOffset]}else{let ee=document.selection.createRange();g.functionRangeIndex=ee}$("#luckysheet-rich-text-editor").html(X+")"),g.canceFunctionrangeSelected(),g.createRangeHightlight()}g.rangestart=!1,g.rangedrag_column_start=!1,g.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(X+")"),g.rangeHightlightselected($("#luckysheet-rich-text-editor")),g.israngeseleciton(),g.func_selectedrange={left:E,width:V,top:q,height:G,left_move:E,width_move:V,top_move:q,height_move:G,row:z,column:L,row_focus:_,column_focus:I}}else g.func_selectedrange={left:E,width:V,top:q,height:G,left_move:E,width_move:V,top_move:q,height_move:G,row:z,column:L,row_focus:_,column_focus:I};g.rangeSetValue({row:z,column:L}),g.rangestart=!0,g.rangedrag_column_start=!1,g.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:E,width:V,top:q,height:G}).show(),$("#luckysheet-formula-help-c").hide(),or(E,q,V,G,z,L),setTimeout(function(){let ee=window.getSelection().anchorNode,le;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?(le=$("#luckysheet-rich-text-editor"),g.rangechangeindex=g.data_parm_index):le=$(ee).closest("div");let se=le.find("span[rangeindex='"+g.rangechangeindex+"']");g.setCaretPosition(se.get(0),0,se.html().length)},1);return}else g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),f.luckysheet_select_status=!0,$("#luckysheet-info").is(":visible")&&(f.luckysheet_select_status=!1);else Gs(_,I,f.currentSheetIndex)&&(f.luckysheet_select_status=!0);if($("#luckysheet-multiRange-dialog").is(":visible")){if(Se.selectStatus=!0,f.luckysheet_select_status=!1,p.shiftKey){let L=Se.selectRange[Se.selectRange.length-1],E=0,V=0,q=[];L.top>S?(E=S,V=L.top+L.height-S,L.row[1]>L.row_focus&&(L.row[1]=L.row_focus),q=[_,L.row[1]]):L.top==S?(E=S,V=L.top+L.height-S,q=[_,L.row[0]]):(E=L.top,V=C-L.top-1,L.row[0]<L.row_focus&&(L.row[0]=L.row_focus),q=[L.row[0],_]);let G=0,X=0,ee=[];L.left>R?(G=R,X=L.left+L.width-R,L.column[1]>L.column_focus&&(L.column[1]=L.column_focus),ee=[I,L.column[1]]):L.left==R?(G=R,X=L.left+L.width-R,ee=[I,L.column[0]]):(G=L.left,X=F-L.left-1,L.column[0]<L.column_focus&&(L.column[0]=L.column_focus),ee=[L.column[0],I]);let le=be.mergeMoveMain(ee,q,L,E,V,G,X);le!=null&&(ee=le[0],q=le[1],E=le[2],V=le[3],G=le[4],X=le[5]),L.row=q,L.column=ee,L.left_move=G,L.width_move=X,L.top_move=E,L.height_move=V,Se.selectRange[Se.selectRange.length-1]=L}else p.ctrlKey?Se.selectRange.push({left:R,width:F-R-1,top:S,height:C-S-1,left_move:R,width_move:F-R-1,top_move:S,height_move:C-S-1,row:[_,P],column:[I,O],row_focus:_,column_focus:I}):(Se.selectRange=[],Se.selectRange.push({left:R,width:F-R-1,top:S,height:C-S-1,left_move:R,width_move:F-R-1,top_move:S,height_move:C-S-1,row:[_,P],column:[I,O],row_focus:_,column_focus:I}));Pt(Se.selectRange);let z=Se.getTxtByRange(Se.selectRange);$("#luckysheet-multiRange-dialog input").val(z);return}else Se.selectStatus=!1,Se.selectRange=[];if($("#luckysheet-singleRange-dialog").is(":visible")){f.luckysheet_select_status=!1,Pt([{row:[_,_],column:[I,I]}]);let z=Mt(f.currentSheetIndex,{row:[_,_],column:[I,I]},f.currentSheetIndex);$("#luckysheet-singleRange-dialog input").val(z);return}if($("#luckysheet-dataVerificationRange-dialog").is(":visible")){if(Ye.selectStatus=!0,f.luckysheet_select_status=!1,p.shiftKey){let L=Ye.selectRange[Ye.selectRange.length-1],E=0,V=0,q=[];L.top>S?(E=S,V=L.top+L.height-S,L.row[1]>L.row_focus&&(L.row[1]=L.row_focus),q=[_,L.row[1]]):L.top==S?(E=S,V=L.top+L.height-S,q=[_,L.row[0]]):(E=L.top,V=C-L.top-1,L.row[0]<L.row_focus&&(L.row[0]=L.row_focus),q=[L.row[0],_]);let G=0,X=0,ee=[];L.left>R?(G=R,X=L.left+L.width-R,L.column[1]>L.column_focus&&(L.column[1]=L.column_focus),ee=[I,L.column[1]]):L.left==R?(G=R,X=L.left+L.width-R,ee=[I,L.column[0]]):(G=L.left,X=F-L.left-1,L.column[0]<L.column_focus&&(L.column[0]=L.column_focus),ee=[L.column[0],I]);let le=be.mergeMoveMain(ee,q,L,E,V,G,X);le!=null&&(ee=le[0],q=le[1],E=le[2],V=le[3],G=le[4],X=le[5]),L.row=q,L.column=ee,L.left_move=G,L.width_move=X,L.top_move=E,L.height_move=V,Ye.selectRange[Ye.selectRange.length-1]=L}else Ye.selectRange=[],Ye.selectRange.push({left:R,width:F-R-1,top:S,height:C-S-1,left_move:R,width_move:F-R-1,top_move:S,height_move:C-S-1,row:[_,P],column:[I,O],row_focus:_,column_focus:I});Pt(Ye.selectRange);let z=Ye.getTxtByRange(Ye.selectRange);g.rangetosheet!=f.currentSheetIndex&&(z=f.luckysheetfile[Z(f.currentSheetIndex)].name+"!"+z),$("#luckysheet-dataVerificationRange-dialog input").val(z);return}else Ye.selectStatus=!1,Ye.selectRange=[];if(eo.singleRangeFocus&&$("#luckysheet-ifFormulaGenerator-dialog .singRange").click(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").is(":visible")){f.luckysheet_select_status=!1,g.rangestart=!1,$("#luckysheet-formula-functionrange-select").css({left:R,width:F-R-1,top:S,height:C-S-1}).show(),$("#luckysheet-formula-help-c").hide();let z=Mt(f.currentSheetIndex,{row:[_,_],column:[I,I]},f.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-singleRange-dialog input").val(z);return}if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){f.luckysheet_select_status=!1,g.func_selectedrange={left:R,width:F-R-1,top:S,height:C-S-1,left_move:R,width_move:F-R-1,top_move:S,height_move:C-S-1,row:[_,_],column:[I,I],row_focus:_,column_focus:I},g.rangestart=!0,$("#luckysheet-formula-functionrange-select").css({left:R,width:F-R-1,top:S,height:C-S-1}).show(),$("#luckysheet-formula-help-c").hide();let z=Mt(f.currentSheetIndex,{row:[_,_],column:[I,I]},f.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(z),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide();return}if(f.luckysheet_select_status){if(p.shiftKey){let z=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),L=0,E=0,V=[];z.top>S?(L=S,E=z.top+z.height-S,z.row[1]>z.row_focus&&(z.row[1]=z.row_focus),V=[_,z.row[1]]):z.top==S?(L=S,E=z.top+z.height-S,V=[_,z.row[0]]):(L=z.top,E=C-z.top-1,z.row[0]<z.row_focus&&(z.row[0]=z.row_focus),V=[z.row[0],_]);let q=0,G=0,X=[];z.left>R?(q=R,G=z.left+z.width-R,z.column[1]>z.column_focus&&(z.column[1]=z.column_focus),X=[I,z.column[1]]):z.left==R?(q=R,G=z.left+z.width-R,X=[I,z.column[0]]):(q=z.left,G=F-z.left-1,z.column[0]<z.column_focus&&(z.column[0]=z.column_focus),X=[z.column[0],I]);let ee=be.mergeMoveMain(X,V,z,L,E,q,G);ee!=null&&(X=ee[0],V=ee[1],L=ee[2],E=ee[3],q=ee[4],G=ee[5]),z.row=V,z.column=X,z.left_move=q,z.width_move=G,z.top_move=L,z.height_move=E,f.luckysheet_select_save[f.luckysheet_select_save.length-1]=z,$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(Mt(f.currentSheetIndex,f.luckysheet_select_save)),Oe.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(f.luckysheetfile[Z(f.currentSheetIndex)].name+"!"+tt(f.luckysheet_select_save[0].column[0])+(f.luckysheet_select_save[0].row[0]+1)+":"+tt(f.luckysheet_select_save[0].column[1])+(f.luckysheet_select_save[0].row[1]+1))}else p.ctrlKey?f.luckysheet_select_save.push({left:R,width:F-R-1,top:S,height:C-S-1,left_move:R,width_move:F-R-1,top_move:S,height_move:C-S-1,row:[_,P],column:[I,O],row_focus:_,column_focus:I}):(f.luckysheet_select_save.length=0,f.luckysheet_select_save.push({left:R,width:F-R-1,top:S,height:C-S-1,left_move:R,width_move:F-R-1,top_move:S,height_move:C-S-1,row:[_,P],column:[I,O],row_focus:_,column_focus:I}),be.menuButtonFocus(f.flowdata,_,I),g.fucntionboxshow(_,I));lt(),(Y.freezenhorizontaldata!=null||Y.freezenverticaldata!=null)&&Y.scrollAdaptOfselect(),fr.mobilecheck()||Dr(),ne.saveParam("mv",f.currentSheetIndex,f.luckysheet_select_save)}el.rangefocus&&(el.rangefocus=!1,$("#luckysheet-alternateformat-range .fa-table").click()),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),Oe.pivotclick(_,I,f.currentSheetIndex),rt(),Je.createHookFunction("cellMousedown",f.flowdata[_][I],{r:_,c:I,start_r:S,start_c:R,end_r:C,end_c:F},b,w)}).mouseup(function(p){if(p.which=="3"){if(!f.allowEdit||he())return;let v=p.pageX,y=p.pageY,k=f.flowdata,b=f.luckysheet_select_save[0],w=de.cellRightClickConfig;if($("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-handleincell").show(),$("#luckysheet-cols-rows-add, #luckysheet-cols-rows-shift").hide(),Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block",Ge("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="block",b.row!=null&&b.row[0]==0&&b.row[1]==f.flowdata.length-1){if(!w.copy&&!w.copyAs&&!w.paste&&!w.insertColumn&&!w.deleteColumn&&!w.hideColumn&&!w.columnWidth&&!w.clear&&!w.matrix&&!w.sort&&!w.filter&&!w.chart&&!w.image&&!w.link&&!w.data&&!w.cellFormat)return;f.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Q().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Q().rightclick.width),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Q().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Q().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),f.luckysheet_cols_menu_status=!0,Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",Ge("#luckysheet-top-left-add-selected").style.display=w.insertColumn?"block":"none",Ge("#luckysheet-bottom-right-add-selected").style.display=w.insertColumn?"block":"none",Ge("#luckysheet-del-selected").style.display=w.deleteColumn?"block":"none",Ge("#luckysheet-hide-selected").style.display=w.hideColumn?"block":"none",Ge("#luckysheet-show-selected").style.display=w.hideColumn?"block":"none",Ge("#luckysheet-column-row-width-selected").style.display=w.columnWidth?"block":"none",!w.copy&&!w.copyAs&&!w.paste&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!w.insertColumn&&!w.deleteColumn&&!w.hideColumn&&!w.columnWidth&&(Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!w.insertColumn&&!w.deleteColumn&&!w.hideColumn&&!w.columnWidth&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none");let x=$.extend(!0,{},f.config);x.columnlen==null&&(x.columnlen={});let C=x.columnlen[f.luckysheet_select_save[0].column[0]]==null?f.defaultcollen:x.columnlen[f.luckysheet_select_save[0].column[0]],S=!0;for(let _=0;_<f.luckysheet_select_save.length;_++){let T=f.luckysheet_select_save[_],F=T.column[0],R=T.column[1];for(let I=F;I<=R;I++)if((x.columnlen[I]==null?f.defaultcollen:x.columnlen[I])!=C){S=!1;break}}S?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(C):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else if(b.column!=null&&b.column[0]==0&&b.column[1]==f.flowdata[0].length-1){if(!w.copy&&!w.copyAs&&!w.paste&&!w.insertRow&&!w.deleteRow&&!w.hideRow&&!w.rowHeight&&!w.clear&&!w.matrix&&!w.sort&&!w.filter&&!w.chart&&!w.image&&!w.link&&!w.data&&!w.cellFormat)return;f.luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Q().rightclick.row),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Q().rightclick.height),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Q().rightclick.top),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Q().rightclick.bottom),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),f.luckysheet_cols_menu_status=!0,Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",Ge("#luckysheet-top-left-add-selected").style.display=w.insertRow?"block":"none",Ge("#luckysheet-bottom-right-add-selected").style.display=w.insertRow?"block":"none",Ge("#luckysheet-del-selected").style.display=w.deleteRow?"block":"none",Ge("#luckysheet-hide-selected").style.display=w.hideRow?"block":"none",Ge("#luckysheet-show-selected").style.display=w.hideRow?"block":"none",Ge("#luckysheet-column-row-width-selected").style.display=w.rowHeight?"block":"none",!w.copy&&!w.copyAs&&!w.paste&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!w.insertRow&&!w.deleteRow&&!w.hideRow&&!w.rowHeight&&(Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!w.insertRow&&!w.deleteRow&&!w.hideRow&&!w.rowHeight&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none");let x=$.extend(!0,{},f.config);x.rowlen==null&&(x.rowlen={});let C=x.rowlen[f.luckysheet_select_save[0].row[0]]==null?f.defaultrowlen:x.rowlen[f.luckysheet_select_save[0].row[0]],S=!0;for(let _=0;_<f.luckysheet_select_save.length;_++){let T=f.luckysheet_select_save[_],F=T.row[0],R=T.row[1];for(let I=F;I<=R;I++)if((x.rowlen[I]==null?f.defaultrowlen:x.rowlen[I])!=C){S=!1;break}}S?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(C):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else{if(!w.copy&&!w.copyAs&&!w.paste&&!w.insertRow&&!w.insertColumn&&!w.deleteRow&&!w.deleteColumn&&!w.deleteCell&&!w.clear&&!w.matrix&&!w.sort&&!w.filter&&!w.chart&&!w.image&&!w.link&&!w.data&&!w.cellFormat)return;!w.copy&&!w.copyAs&&!w.paste&&(Ge("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="none",!w.insertRow&&!w.insertColumn&&!w.deleteRow&&!w.deleteColumn&&!w.deleteCell&&(Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!w.insertRow&&!w.insertColumn&&!w.deleteRow&&!w.deleteColumn&&!w.deleteCell&&(Ge("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="none")}!w.clear&&!w.matrix&&!w.sort&&!w.filter&&!w.chart&&!w.image&&!w.link&&!w.data&&!w.cellFormat&&(Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),on($("#luckysheet-rightclick-menu"),v,y)}ne.saveParam("mv",f.currentSheetIndex,f.luckysheet_select_save)}).dblclick(function(p){if($(p.target).hasClass("luckysheet-mousedown-cancel")||!f.allowEdit||parseInt($("#luckysheet-input-box").css("top"))>0)return;let v=ut(p.pageX,p.pageY);if(v[0]>=f.cellmainWidth-f.cellMainSrollBarSize||v[1]>=f.cellmainHeight-f.cellMainSrollBarSize)return;let y=$("#luckysheet-cell-main").scrollLeft(),k=$("#luckysheet-cell-main").scrollTop(),b=v[0]+y,w=v[1]+k;Y.freezenverticaldata!=null&&v[0]<Y.freezenverticaldata[0]-Y.freezenverticaldata[2]&&(b=v[0]+Y.freezenverticaldata[2]),Y.freezenhorizontaldata!=null&&v[1]<Y.freezenhorizontaldata[0]-Y.freezenhorizontaldata[2]&&(w=v[1]+Y.freezenhorizontaldata[2]);let x=$t(w),C=x[2],S=_t(b),_=S[2],T=be.mergeborer(f.flowdata,C,_);if(T&&(C=T.row[2],_=T.column[2]),Oe.isPivotRange(C,_)){if((Oe.filter==null||Oe.filter.length==0)&&(Oe.row==null||Oe.row.length==0)&&(Oe.column==null||Oe.column.length==0)&&(Oe.values==null||Oe.values.length==0)||Oe.values==null||Oe.values.length==0||C==0||_==0)return;if(Oe.column!=null&&Oe.column.length>0){if(Oe.values.length>=2&&Oe.showType=="column"){if(C<=Oe.column.length||_>=Oe.pivotDatas[0].length-Oe.values.length)return}else if(C<=Oe.column.length-1||_>=Oe.pivotDatas[0].length-1)return}if(Oe.row!=null&&Oe.row.length>0){if(Oe.values.length>=2&&Oe.showType=="row"){if(_<=Oe.row.length||C>=Oe.pivotDatas.length-Oe.values.length)return}else if(_<=Oe.row.length-1||C>=Oe.pivotDatas.length-1)return}ye.addNewSheet(p),Oe.drillDown(C,_);return}if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible"))$("#luckysheet-cell-selected").hide();else{if($("#luckysheet-conditionformat-dialog").is(":visible")||$("#luckysheet-administerRule-dialog").is(":visible")||$("#luckysheet-newConditionRule-dialog").is(":visible")||$("#luckysheet-editorConditionRule-dialog").is(":visible")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;if($("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")||$("#luckysheet-alternateformat-rangeDialog").is(":visible"))return;{be.luckysheetPaintModelOn&&be.cancelPaintModel();let F=f.luckysheet_select_save[0].column_focus,R=f.luckysheet_select_save[0].row_focus;(F!==_||R!==C)&&(C=R,_=F),Rl(C,_,f.flowdata),lt()}}}),document.getElementById("luckysheet-cell-main").addEventListener("drop",function(p){p.preventDefault(),p.stopPropagation();let v=p.dataTransfer.files;if(v.length==1&&v[0].type.indexOf("image")>-1){if(!Tt(f.currentSheetIndex,"editObjects"))return;Ie.insertImg(v[0])}u(p)},!1),document.getElementById("luckysheet-cell-main").addEventListener("dragover",function(p){p.preventDefault(),p.stopPropagation()},!1);function u(p){if(de&&de.hook&&de.hook.cellDragStop){let v=ut(p.pageX,p.pageY),y=v[0]+$("#luckysheet-cell-main").scrollLeft(),k=v[1]+$("#luckysheet-cell-main").scrollTop(),b=$t(k),w=b[1],x=b[0],C=b[2],S=_t(y),_=S[1],T=S[0],F=S[2],R=be.mergeborer(f.flowdata,C,F);R&&(w=R.row[1],x=R.row[0],C=R.row[2],_=R.column[1],T=R.column[0],F=R.column[2]);let I=ye.getSheetByIndex(),P=$("#luckysheetTableContent").get(0).getContext("2d");Je.createHookFunction("cellDragStop",f.flowdata[C][F],{r:C,c:F,start_r:x,start_c:T,end_r:w,end_c:_},I,P,p)}}$(document).on("mousemove.luckysheetEvent",function(p){if(He.overshow(p),Cl.overshow(p),window.cancelAnimationFrame(f.jfautoscrollTimeout),de&&de.hook&&de.hook.sheetMousemove){let v=ut(p.pageX,p.pageY),y=v[0]+$("#luckysheet-cell-main").scrollLeft(),k=v[1]+$("#luckysheet-cell-main").scrollTop(),b=$t(k),w=b[1],x=b[0],C=b[2],S=_t(y),_=S[1],T=S[0],F=S[2],R=be.mergeborer(f.flowdata,C,F);R&&(w=R.row[1],x=R.row[0],C=R.row[2],_=R.column[1],T=R.column[0],F=R.column[2]);let I=ye.getSheetByIndex(),P={functionResizeStatus:g.functionResizeStatus,horizontalmoveState:!!Y.horizontalmovestate,verticalmoveState:!!Y.verticalmovestate,pivotTableMoveState:!!Oe&&Oe.movestate,sheetMoveStatus:f.luckysheet_sheet_move_status,scrollStatus:!!f.luckysheet_scroll_status,selectStatus:!!f.luckysheet_select_status,rowsSelectedStatus:!!f.luckysheet_rows_selected_status,colsSelectedStatus:!!f.luckysheet_cols_selected_status,cellSelectedMove:!!f.luckysheet_cell_selected_move,cellSelectedExtend:!!f.luckysheet_cell_selected_extend,colsChangeSize:!!f.luckysheet_cols_change_size,rowsChangeSize:!!f.luckysheet_rows_change_size,chartMove:!!f.chartparam.luckysheetCurrentChartMove,chartResize:!!f.chartparam.luckysheetCurrentChartResize,rangeResize:!!g.rangeResize,rangeMove:!!g.rangeMove},O=$("#luckysheetTableContent").get(0).getContext("2d");f.flowdata&&f.flowdata[C]&&Je.createHookFunction("sheetMousemove",f.flowdata[C][F],{r:C,c:F,start_r:x,start_c:T,end_r:w,end_c:_},I,P,O)}if(g.functionResizeStatus){let y=p.pageY-g.functionResizeData.y,k=g.functionResizeData.calculatebarHeight+y,b=Math.round($(window).height()/2);if(k<=28){if(k<=20)return;k=28}else if(k>=b){if(k>=b+8)return;k=b}f.calculatebarHeight=k,$("#luckysheet-wa-calculate").css("height",f.calculatebarHeight-2),$("#luckysheet-wa-calculate-size").css({background:"#5e5e5e",cursor:"ns-resize"}),clearTimeout(g.functionResizeTimeout),g.functionResizeTimeout=setTimeout(function(){Ot()},15)}else if(Y.horizontalmovestate){let v=ut(p.pageX,p.pageY),y=$("#luckysheet-cell-main").scrollLeft(),k=$("#luckysheet-cell-main").scrollTop(),b=v[0]+y,w=v[1]+k,x=$t(w),C=x[1],S=x[0],_=x[2],T=v[1]+f.columnHeaderHeight;T<f.columnHeaderHeight&&(T=f.columnHeaderHeight),T>Y.windowHeight-4&&(T=Y.windowHeight-4),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({top:T}),T+k-f.columnHeaderHeight>=S+(C-S)/2?(T=C-2-k+f.columnHeaderHeight,Y.freezenhorizontaldata=[C,_+1,k,Y.cutVolumn(f.visibledatarow,_+1),T]):(T=S-2-k+f.columnHeaderHeight,Y.freezenhorizontaldata=[S,_,k,Y.cutVolumn(f.visibledatarow,_),T]),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").css({top:T}),Y.saveFreezen(Y.freezenhorizontaldata,T,null,null)}else if(Y.verticalmovestate){let v=ut(p.pageX,p.pageY),y=$("#luckysheet-cell-main").scrollLeft(),k=$("#luckysheet-cell-main").scrollTop(),b=v[0]+y,w=v[1]+k,x=_t(b),C=x[1],S=x[0],_=x[2],T=v[0]+f.rowHeaderWidth;T<f.rowHeaderWidth&&(T=f.rowHeaderWidth),T>Y.windowWidth-4&&(T=Y.windowWidth-4),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({left:T}),T+y-f.rowHeaderWidth>=S+(C-S)/2?(T=C-2-y+f.rowHeaderWidth,Y.freezenverticaldata=[C,_+1,y,Y.cutVolumn(f.visibledatacolumn,_+1),T]):(T=S-2-y+f.rowHeaderWidth,Y.freezenverticaldata=[S,_,y,Y.cutVolumn(f.visibledatacolumn,_),T]),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").css({left:T}),Y.saveFreezen(null,null,Y.freezenverticaldata,T),Ot()}else if(!!Oe&&Oe.movestate){let v=p.pageX,y=p.pageY;$("#luckysheet-modal-dialog-slider-pivot-move").css({left:v-Oe.movesave.width/2,top:y-Oe.movesave.height})}else if(f.luckysheet_sheet_move_status){let v=$("#luckysheet-sheet-container-c").scrollLeft(),y=p.pageX+v;if(Math.abs(p.pageX-f.luckysheet_sheet_move_data.pageX)<3)return;let k=$("#luckysheet-sheet-container").width(),b=y-f.luckysheet_sheet_move_data.curleft-$("#luckysheet-sheet-container").offset().left;f.luckysheet_sheet_move_data.activeobject.css({left:b});let w=at(f.luckysheet_sheet_move_data.widthlist,b+f.luckysheet_sheet_move_data.curleft);f.luckysheet_sheet_move_data.cursorobject.css({cursor:"move"}),b-v<=6&&$("#luckysheet-sheets-leftscroll").click(),b-v>=k-40&&$("#luckysheet-sheets-rightscroll").click(),w!=f.luckysheet_sheet_move_data.curindex&&(w==-1&&b>0?(w=f.luckysheet_sheet_move_data.widthlist.length-1,$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(w))):w==-1&&b<=0?$("#luckysheet-sheets-item-clone").insertBefore($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(0)):$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(w)),f.luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(x){x==0?f.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):f.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+f.luckysheet_sheet_move_data.widthlist[x-1])}),f.luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").index($("#luckysheet-sheets-item-clone")))}else if(f.luckysheet_model_move_state){let v=$(document).scrollTop(),y=$(document).scrollLeft(),k=p.pageY+v,b=p.pageX+y,w=$(window).height(),x=$(window).width(),C=f.luckysheet_model_move_obj.height(),S=f.luckysheet_model_move_obj.width(),_=k-f.luckysheet_model_xy[1],T=b-f.luckysheet_model_xy[0];_<0&&(_=0),_+C+62>w&&(_=w-C-62),T<0&&(T=0),T+S+86>x&&(T=x-S-86),f.luckysheet_model_move_obj.css({top:_,left:T}),p.preventDefault()}else if(!!f.luckysheet_scroll_status||!!f.luckysheet_select_status||!!f.luckysheet_rows_selected_status||!!f.luckysheet_cols_selected_status||!!f.luckysheet_cell_selected_move||!!f.luckysheet_cell_selected_extend||!!f.luckysheet_cols_change_size||!!f.luckysheet_rows_change_size||!!f.chartparam.luckysheetCurrentChartMove||!!f.chartparam.luckysheetCurrentChartResize||!!g.rangeResize||!!g.rangeMove){let v=function(){if(f.luckysheet_scroll_status&&!f.luckysheet_cols_change_size&&!f.luckysheet_rows_change_size){let y=ut(p.pageX,p.pageY),k=$("#luckysheet-scrollbar-x").scrollLeft(),b=$("#luckysheet-scrollbar-y").scrollTop(),w=y[0],x=y[1],C=$("#luckysheet-cell-main").height()-20*f.zoomRatio,S=$("#luckysheet-cell-main").width()-60*f.zoomRatio;if(x<0||x>C){let _;x<0?_=b+x/2:_=b+(x-C)/2,$("#luckysheet-scrollbar-y").scrollTop(_)}if(w<0||w>S){let _;w<0?_=k+w/2:_=k+(w-S)/2,$("#luckysheet-scrollbar-x").scrollLeft(_)}}if(f.luckysheet_select_status){let y=ut(p.pageX,p.pageY),k=y[0]+$("#luckysheet-cell-main").scrollLeft(),b=y[1]+$("#luckysheet-cell-main").scrollTop(),w=$t(b),x=w[1],C=w[0],S=w[2],_=_t(k),T=_[1],F=_[0],R=_[2];if(!Gs(S,R,f.currentSheetIndex))return;let I=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),P=0,O=0,M=[];I.top>C?(P=C,O=I.top+I.height-C,I.row[1]>I.row_focus&&(I.row[1]=I.row_focus),M=[S,I.row[1]]):I.top==C?(P=C,O=I.top+I.height-C,M=[S,I.row[0]]):(P=I.top,O=x-I.top-1,I.row[0]<I.row_focus&&(I.row[0]=I.row_focus),M=[I.row[0],S]);let A=0,z=0,L=[];I.left>F?(A=F,z=I.left+I.width-F,I.column[1]>I.column_focus&&(I.column[1]=I.column_focus),L=[R,I.column[1]]):I.left==F?(A=F,z=I.left+I.width-F,L=[R,I.column[0]]):(A=I.left,z=T-I.left-1,I.column[0]<I.column_focus&&(I.column[0]=I.column_focus),L=[I.column[0],R]);let E=be.mergeMoveMain(L,M,I,P,O,A,z);E!=null&&(L=E[0],M=E[1],P=E[2],O=E[3],A=E[4],z=E[5]),I.row=M,I.column=L,I.left_move=A,I.width_move=z,I.top_move=P,I.height_move=O,f.luckysheet_select_save[f.luckysheet_select_save.length-1]=I,lt(),Y.scrollFreezen(),$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(Mt(f.currentSheetIndex,f.luckysheet_select_save[f.luckysheet_select_save.length-1])),Oe.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(f.luckysheetfile[Z(f.currentSheetIndex)].name+"!"+tt(f.luckysheet_select_save[0].column[0])+(f.luckysheet_select_save[0].row[0]+1)+":"+tt(f.luckysheet_select_save[0].column[1])+(f.luckysheet_select_save[0].row[1]+1))}else if(Se.selectStatus){let y=ut(p.pageX,p.pageY),k=y[0]+$("#luckysheet-cell-main").scrollLeft(),b=y[1]+$("#luckysheet-cell-main").scrollTop(),w=$t(b),x=w[1],C=w[0],S=w[2],_=_t(k),T=_[1],F=_[0],R=_[2],I=Se.selectRange[Se.selectRange.length-1],P=0,O=0,M=[];I.top>C?(P=C,O=I.top+I.height-C,I.row[1]>I.row_focus&&(I.row[1]=I.row_focus),M=[S,I.row[1]]):I.top==C?(P=C,O=I.top+I.height-C,M=[S,I.row[0]]):(P=I.top,O=x-I.top-1,I.row[0]<I.row_focus&&(I.row[0]=I.row_focus),M=[I.row[0],S]);let A=0,z=0,L=[];I.left>F?(A=F,z=I.left+I.width-F,I.column[1]>I.column_focus&&(I.column[1]=I.column_focus),L=[R,I.column[1]]):I.left==F?(A=F,z=I.left+I.width-F,L=[R,I.column[0]]):(A=I.left,z=T-I.left-1,I.column[0]<I.column_focus&&(I.column[0]=I.column_focus),L=[I.column[0],R]);let E=be.mergeMoveMain(L,M,I,P,O,A,z);E!=null&&(L=E[0],M=E[1],P=E[2],O=E[3],A=E[4],z=E[5]),I.row=M,I.column=L,I.left_move=A,I.width_move=z,I.top_move=P,I.height_move=O,Se.selectRange[Se.selectRange.length-1]=I,Pt(Se.selectRange);let V=Se.getTxtByRange(Se.selectRange);$("#luckysheet-multiRange-dialog input").val(V)}else if(Ye.selectStatus){let y=ut(p.pageX,p.pageY),k=y[0]+$("#luckysheet-cell-main").scrollLeft(),b=y[1]+$("#luckysheet-cell-main").scrollTop(),w=$t(b),x=w[1],C=w[0],S=w[2],_=_t(k),T=_[1],F=_[0],R=_[2],I=Ye.selectRange[Ye.selectRange.length-1],P=0,O=0,M=[];I.top>C?(P=C,O=I.top+I.height-C,I.row[1]>I.row_focus&&(I.row[1]=I.row_focus),M=[S,I.row[1]]):I.top==C?(P=C,O=I.top+I.height-C,M=[S,I.row[0]]):(P=I.top,O=x-I.top-1,I.row[0]<I.row_focus&&(I.row[0]=I.row_focus),M=[I.row[0],S]);let A=0,z=0,L=[];I.left>F?(A=F,z=I.left+I.width-F,I.column[1]>I.column_focus&&(I.column[1]=I.column_focus),L=[R,I.column[1]]):I.left==F?(A=F,z=I.left+I.width-F,L=[R,I.column[0]]):(A=I.left,z=T-I.left-1,I.column[0]<I.column_focus&&(I.column[0]=I.column_focus),L=[I.column[0],R]);let E=be.mergeMoveMain(L,M,I,P,O,A,z);E!=null&&(L=E[0],M=E[1],P=E[2],O=E[3],A=E[4],z=E[5]),I.row=M,I.column=L,I.left_move=A,I.width_move=z,I.top_move=P,I.height_move=O,Ye.selectRange[Ye.selectRange.length-1]=I,Pt(Ye.selectRange);let V=Ye.getTxtByRange(Ye.selectRange);g.rangetosheet!=f.currentSheetIndex&&(V=f.luckysheetfile[Z(f.currentSheetIndex)].name+"!"+V),$("#luckysheet-dataVerificationRange-dialog input").val(V)}else if(g.rangestart)g.rangedrag(p);else if(g.rangedrag_row_start)g.rangedrag_row(p);else if(g.rangedrag_column_start)g.rangedrag_column(p);else if(f.luckysheet_rows_selected_status){let k=ut(p.pageX,p.pageY)[1]+$("#luckysheet-rows-h").scrollTop();if(k<0)return!1;let b=$t(k),w=b[1],x=b[0],C=b[2],S=f.visibledatacolumn.length-1,_=f.visibledatacolumn[S],T=0,F=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),R=0,I=0,P=[];F.top>x?(R=x,I=F.top+F.height-x,F.row[1]>F.row_focus&&(F.row[1]=F.row_focus),P=[C,F.row[1]]):F.top==x?(R=x,I=F.top+F.height-x,P=[C,F.row[0]]):(R=F.top,I=w-F.top-1,F.row[0]<F.row_focus&&(F.row[0]=F.row_focus),P=[F.row[0],C]),F.row=P,F.top_move=R,F.height_move=I,f.luckysheet_select_save[f.luckysheet_select_save.length-1]=F,lt(),clearTimeout(f.countfuncTimeout),f.countfuncTimeout=setTimeout(function(){bl()},500)}else if(f.luckysheet_cols_selected_status){let k=ut(p.pageX,p.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft();if(k<0)return!1;let b=f.visibledatarow.length-1,w=f.visibledatarow[b],x=0,C=_t(k),S=C[1],_=C[0],T=C[2],F=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),R=0,I=0,P=[];F.left>_?(R=_,I=F.left+F.width-_,F.column[1]>F.column_focus&&(F.column[1]=F.column_focus),P=[T,F.column[1]]):F.left==_?(R=_,I=F.left+F.width-_,P=[T,F.column[0]]):(R=F.left,I=S-F.left-1,F.column[0]<F.column_focus&&(F.column[0]=F.column_focus),P=[F.column[0],T]),F.column=P,F.left_move=R,F.width_move=I,f.luckysheet_select_save[f.luckysheet_select_save.length-1]=F,lt(),clearTimeout(f.countfuncTimeout),f.countfuncTimeout=setTimeout(function(){bl()},500)}else if(f.luckysheet_cell_selected_move){let y=ut(p.pageX,p.pageY),k=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),w=y[0]+k,x=y[1]+b,C=$(window).height()+b-f.sheetBarHeight-f.statisticBarHeight,S=$(window).width()+k,_=$t(x),T=_[1],F=_[0],R=_[2],I=_t(w),P=I[1],O=I[0],M=I[2],A=f.luckysheet_cell_selected_move_index[0],z=f.luckysheet_cell_selected_move_index[1],L=f.luckysheet_select_save[0].row[0]-A+R,E=f.luckysheet_select_save[0].row[1]-A+R,V=f.luckysheet_select_save[0].column[0]-z+M,q=f.luckysheet_select_save[0].column[1]-z+M;(L<0||x<0)&&(L=0,E=f.luckysheet_select_save[0].row[1]-f.luckysheet_select_save[0].row[0]),(V<0||w<0)&&(V=0,q=f.luckysheet_select_save[0].column[1]-f.luckysheet_select_save[0].column[0]),(E>=f.visibledatarow[f.visibledatarow.length-1]||x>C)&&(L=f.visibledatarow.length-1-f.luckysheet_select_save[0].row[1]+f.luckysheet_select_save[0].row[0],E=f.visibledatarow.length-1),(q>=f.visibledatacolumn[f.visibledatacolumn.length-1]||w>S)&&(V=f.visibledatacolumn.length-1-f.luckysheet_select_save[0].column[1]+f.luckysheet_select_save[0].column[0],q=f.visibledatacolumn.length-1),O=V-1==-1?0:f.visibledatacolumn[V-1],P=f.visibledatacolumn[q],F=L-1==-1?0:f.visibledatarow[L-1],T=f.visibledatarow[E],$("#luckysheet-cell-selected-move").css({left:O,width:P-O-2,top:F,height:T-F-2,display:"block"})}else if(f.luckysheet_cell_selected_extend){let y=ut(p.pageX,p.pageY),k=$("#luckysheet-cell-main").scrollLeft()-5,b=$("#luckysheet-cell-main").scrollTop()-5,w=y[0]+k,x=y[1]+b,C=$(window).height()+b-f.sheetBarHeight-f.statisticBarHeight,S=$(window).width()+k,_=$t(x),T=_[1],F=_[0],R=_[2],I=_t(w),P=I[1],O=I[0],M=I[2],A=f.luckysheet_cell_selected_extend_index[0],z=f.luckysheet_cell_selected_extend_index[1],L=f.luckysheet_select_save[0].row[0],E=f.luckysheet_select_save[0].row[1],V=f.luckysheet_select_save[0].column[0],q=f.luckysheet_select_save[0].column[1];(L<0||x<0)&&(L=0,E=f.luckysheet_select_save[0].row[1]-f.luckysheet_select_save[0].row[0]),(V<0||w<0)&&(V=0,q=f.luckysheet_select_save[0].column[1]-f.luckysheet_select_save[0].column[0]),(E>=f.visibledatarow[f.visibledatarow.length-1]||x>C)&&(L=f.visibledatarow.length-1-f.luckysheet_select_save[0].row[1]+f.luckysheet_select_save[0].row[0],E=f.visibledatarow.length-1),(q>=f.visibledatacolumn[f.visibledatacolumn.length-1]||w>S)&&(V=f.visibledatacolumn.length-1-f.luckysheet_select_save[0].column[1]+f.luckysheet_select_save[0].column[0],q=f.visibledatacolumn.length-1);let G=f.luckysheet_select_save[0].top_move,X=f.luckysheet_select_save[0].height_move,ee=f.luckysheet_select_save[0].left_move,le=f.luckysheet_select_save[0].width_move;Math.abs(A-R)>Math.abs(z-M)?R>=L&&R<=E||(f.luckysheet_select_save[0].top_move>=F?(G=F,X=f.luckysheet_select_save[0].top_move+f.luckysheet_select_save[0].height_move-F):(G=f.luckysheet_select_save[0].top_move,X=T-f.luckysheet_select_save[0].top_move-1)):M>=V&&M<=q||(f.luckysheet_select_save[0].left_move>=O?(ee=O,le=f.luckysheet_select_save[0].left_move+f.luckysheet_select_save[0].width_move-O):(ee=f.luckysheet_select_save[0].left_move,le=P-f.luckysheet_select_save[0].left_move-1)),$("#luckysheet-cell-selected-extend").css({left:ee,width:le,top:G,height:X,display:"block"})}else if(f.luckysheet_cols_change_size){let y=ut(p.pageX,p.pageY),k=$("#luckysheet-cols-h-c").scrollLeft(),b=y[0]+k,w=$(window).width(),x=f.visibledatarow.length-1,C=f.visibledatarow[x],S=0,_=_t(b),T=_[1],F=_[0],R=_[2];b+3-f.luckysheet_cols_change_size_start[0]>30&&b<w+k-100&&($("#luckysheet-change-size-line").css({left:b}),$("#luckysheet-cols-change-size").css({left:b-2}))}else if(f.luckysheet_rows_change_size){let y=ut(p.pageX,p.pageY),k=$("#luckysheet-rows-h").scrollTop(),b=y[1]+k,w=$(window).height(),x=$t(b),C=x[1],S=x[0],_=x[2];b+3-f.luckysheet_rows_change_size_start[0]>19&&b<w+k-200&&($("#luckysheet-change-size-line").css({top:b}),$("#luckysheet-rows-change-size").css({top:b}))}else if(f.chartparam.luckysheetCurrentChartMove){let y=ut(p.pageX,p.pageY),k=y[0]+$("#luckysheet-cell-main").scrollLeft(),b=y[1]+$("#luckysheet-cell-main").scrollTop(),w=f.chartparam.luckysheetCurrentChartMoveObj.height(),x=f.chartparam.luckysheetCurrentChartMoveObj.width(),C=b-f.chartparam.luckysheetCurrentChartMoveXy[1],S=k-f.chartparam.luckysheetCurrentChartMoveXy[0];if(C<0&&(C=0),C+w+42+6>f.chartparam.luckysheetCurrentChartMoveWinH&&(C=f.chartparam.luckysheetCurrentChartMoveWinH-w-42-6),S<0&&(S=0),S+x+22+36>f.chartparam.luckysheetCurrentChartMoveWinW&&(S=f.chartparam.luckysheetCurrentChartMoveWinW-x-22-36),f.chartparam.luckysheetCurrentChartMoveObj.css({top:C,left:S}),Y.freezenhorizontaldata!=null||Y.freezenverticaldata!=null){Y.scrollAdapt();let _=f.chartparam.luckysheetCurrentChartMoveObj.offset(),T=f.chartparam.luckysheetCurrentChartMoveObj.position();f.chartparam.luckysheetCurrentChartMoveXy=[p.pageX-_.left,p.pageY-_.top,T.left,T.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()]}}else if(f.chartparam.luckysheetCurrentChartResize){let y=$("#luckysheet-cell-main").scrollTop(),k=$("#luckysheet-cell-main").scrollLeft(),b=ut(p.pageX,p.pageY),w=b[0]+k,x=b[1]+y;if(w<0||x<0)return!1;let C=f.chartparam.luckysheetCurrentChartResizeObj.height(),S=f.chartparam.luckysheetCurrentChartResizeObj.width(),_=x-f.chartparam.luckysheetCurrentChartResizeXy[1],T=w-f.chartparam.luckysheetCurrentChartResizeXy[0],F=f.chartparam.luckysheetCurrentChartResizeXy[5],R=f.chartparam.luckysheetCurrentChartResizeXy[3],I=f.chartparam.luckysheetCurrentChartResizeXy[4],P=f.chartparam.luckysheetCurrentChartResizeXy[2];(f.chartparam.luckysheetCurrentChartResize=="lm"||f.chartparam.luckysheetCurrentChartResize=="lt"||f.chartparam.luckysheetCurrentChartResize=="lb")&&(I=w,P=f.chartparam.luckysheetCurrentChartResizeXy[2]-T,I>f.chartparam.luckysheetCurrentChartResizeXy[2]+f.chartparam.luckysheetCurrentChartResizeXy[4]-60?(I=f.chartparam.luckysheetCurrentChartResizeXy[2]+f.chartparam.luckysheetCurrentChartResizeXy[4]-60,P=f.chartparam.luckysheetCurrentChartResizeXy[2]-(f.chartparam.luckysheetCurrentChartResizeXy[2]+f.chartparam.luckysheetCurrentChartResizeXy[4]-60-f.chartparam.luckysheetCurrentChartResizeXy[0])):I<=0&&(I=0,P=f.chartparam.luckysheetCurrentChartResizeXy[2]+f.chartparam.luckysheetCurrentChartResizeXy[0])),(f.chartparam.luckysheetCurrentChartResize=="rm"||f.chartparam.luckysheetCurrentChartResize=="rt"||f.chartparam.luckysheetCurrentChartResize=="rb")&&(P=f.chartparam.luckysheetCurrentChartResizeXy[2]+T,P<60?P=60:P>=f.chartparam.luckysheetCurrentChartResizeWinW-f.chartparam.luckysheetCurrentChartResizeXy[4]-22-36&&(P=f.chartparam.luckysheetCurrentChartResizeWinW-f.chartparam.luckysheetCurrentChartResizeXy[4]-22-36)),(f.chartparam.luckysheetCurrentChartResize=="mt"||f.chartparam.luckysheetCurrentChartResize=="lt"||f.chartparam.luckysheetCurrentChartResize=="rt")&&(F=x,R=f.chartparam.luckysheetCurrentChartResizeXy[3]-_,F>f.chartparam.luckysheetCurrentChartResizeXy[3]+f.chartparam.luckysheetCurrentChartResizeXy[5]-60?(F=f.chartparam.luckysheetCurrentChartResizeXy[3]+f.chartparam.luckysheetCurrentChartResizeXy[5]-60,R=f.chartparam.luckysheetCurrentChartResizeXy[3]-(f.chartparam.luckysheetCurrentChartResizeXy[3]+f.chartparam.luckysheetCurrentChartResizeXy[5]-60-f.chartparam.luckysheetCurrentChartResizeXy[1])):F<=0&&(F=0,R=f.chartparam.luckysheetCurrentChartResizeXy[3]+f.chartparam.luckysheetCurrentChartResizeXy[1])),(f.chartparam.luckysheetCurrentChartResize=="mb"||f.chartparam.luckysheetCurrentChartResize=="lb"||f.chartparam.luckysheetCurrentChartResize=="rb")&&(R=f.chartparam.luckysheetCurrentChartResizeXy[3]+_,R<60?R=60:R>=f.chartparam.luckysheetCurrentChartResizeWinH-f.chartparam.luckysheetCurrentChartResizeXy[5]-42-6&&(R=f.chartparam.luckysheetCurrentChartResizeWinH-f.chartparam.luckysheetCurrentChartResizeXy[5]-42-6));let O={top:F,left:I,height:R,width:P};f.chartparam.luckysheetCurrentChartResizeObj.css(O),f.resizeChart(f.chartparam.luckysheetCurrentChart)}else if(Ie.move){let y=ut(p.pageX,p.pageY),k=y[0]+$("#luckysheet-cell-main").scrollLeft(),b=y[1]+$("#luckysheet-cell-main").scrollTop(),w=Ie.images[Ie.currentImgId];w.isFixedPos&&(k=p.pageX,b=p.pageY);let x=$("#luckysheet-modal-dialog-activeImage").height(),C=$("#luckysheet-modal-dialog-activeImage").width(),S=b-Ie.moveXY[1],_=k-Ie.moveXY[0],T=0,F=Ie.currentWinH-x-42-6,R=0,I=Ie.currentWinW-C-22-36;w.isFixedPos&&(T=f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight,F=T+f.cellmainHeight-f.cellMainSrollBarSize-x,R=f.rowHeaderWidth,I=R+f.cellmainWidth-f.cellMainSrollBarSize-C),S<T&&(S=T),S>F&&(S=F),_<R&&(_=R),_>I&&(_=I),$("#luckysheet-modal-dialog-activeImage").css({left:_,top:S})}else if(Ie.resize){let y=ut(p.pageX,p.pageY),k=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),w=y[0]+k,x=y[1]+b;if(w<0||x<0)return!1;let C=Ie.resizeXY,S=x-C[1],_=w-C[0],T=C[5],F=C[3],R=C[4],I=C[2],P=Ie.resize,O=Ie.images[Ie.currentImgId];if(O.isFixedPos){let q=f.infobarHeight+f.toolbarHeight+f.calculatebarHeight+f.columnHeaderHeight,G=f.rowHeaderWidth;P=="lt"?(R=C[4]-C[6]+_,R<G&&(R=G),R>C[4]-C[6]+C[2]-1&&(R=C[4]-C[6]+C[2]-1),I=C[4]-C[6]+C[2]-R,F=Math.round(I*(C[3]/C[2])),T=C[5]-C[7]+C[3]-F,T<q&&(T=q,F=C[5]-C[7]+C[3]-T,I=Math.round(F*(C[2]/C[3])),R=C[4]-C[6]+C[2]-I),T>C[5]-C[7]+C[3]-1&&(T=C[5]-C[7]+C[3]-1,F=C[5]-C[7]+C[3]-T,I=Math.round(F*(C[2]/C[3])),R=C[4]-C[6]+C[2]-I)):P=="lm"?(R=C[4]-C[6]+_,R<G&&(R=G),R>C[4]-C[6]+C[2]-1&&(R=C[4]-C[6]+C[2]-1),I=C[4]-C[6]+C[2]-R,T=C[5]-C[7],F=C[3]):P=="lb"?(R=C[4]-C[6]+_,R<G&&(R=G),R>C[4]-C[6]+C[2]-1&&(R=C[4]-C[6]+C[2]-1),I=C[4]-C[6]+C[2]-R,F=Math.round(I*(C[3]/C[2])),T=C[5]-C[7],F<1&&(F=1,I=Math.round(F*(C[2]/C[3])),R=C[4]-C[6]+C[2]-I),F>q+f.cellmainHeight-f.cellMainSrollBarSize-T&&(F=q+f.cellmainHeight-f.cellMainSrollBarSize-T,I=Math.round(F*(C[2]/C[3])),R=C[4]-C[6]+C[2]-I)):P=="rt"?(R=C[4]-C[6],I=C[2]+_,I<1&&(I=1),I>G+f.cellmainWidth-f.cellMainSrollBarSize-R&&(I=G+f.cellmainWidth-f.cellMainSrollBarSize-R),F=Math.round(I*(C[3]/C[2])),T=C[5]-C[7]+C[3]-F,T<q&&(T=q,F=C[5]-C[7]+C[3]-T,I=Math.round(F*(C[2]/C[3]))),T>C[5]-C[7]+C[3]-1&&(T=C[5]-C[7]+C[3]-1,F=C[5]-C[7]+C[3]-T,I=Math.round(F*(C[2]/C[3])))):P=="rm"?(R=C[4]-C[6],I=C[2]+_,I<1&&(I=1),I>G+f.cellmainWidth-f.cellMainSrollBarSize-R&&(I=G+f.cellmainWidth-f.cellMainSrollBarSize-R),T=C[5]-C[7],F=C[3]):P=="rb"?(R=C[4]-C[6],I=C[2]+_,I<1&&(I=1),I>G+f.cellmainWidth-f.cellMainSrollBarSize-R&&(I=G+f.cellmainWidth-f.cellMainSrollBarSize-R),F=Math.round(I*(C[3]/C[2])),T=C[5]-C[7],F<1&&(F=1,I=Math.round(F*(C[2]/C[3]))),F>q+f.cellmainHeight-f.cellMainSrollBarSize-T&&(F=q+f.cellmainHeight-f.cellMainSrollBarSize-T,I=Math.round(F*(C[2]/C[3])))):P=="mt"?(R=C[4]-C[6],I=C[2],T=C[5]-C[7]+S,T<q&&(T=q),T>C[5]-C[7]+C[3]-1&&(T=C[5]-C[7]+C[3]-1),F=C[5]-C[7]+C[3]-T):P=="mb"&&(R=C[4]-C[6],I=C[2],T=C[5]-C[7],F=C[3]+S,F<1&&(F=1),F>q+f.cellmainHeight-f.cellMainSrollBarSize-T&&(F=q+f.cellmainHeight-f.cellMainSrollBarSize-T))}else P=="lt"?(R=w,I=C[2]-_,R>C[2]+C[4]-1?(R=C[2]+C[4]-1,I=C[2]+C[0]-(C[2]+C[4]-1)):R<=0&&(R=0,I=C[2]+C[0]),F=Math.round(I*(C[3]/C[2])),T=C[3]+C[1]-F,T>C[3]+C[5]-1?(T=C[3]+C[5]-1,F=C[3]+C[1]-(C[3]+C[5]-1),I=Math.round(F*(C[2]/C[3])),R=C[2]+C[0]-I):T<=0&&(T=0,F=C[3]+C[1],I=Math.round(F*(C[2]/C[3])),R=C[2]+C[0]-I)):P=="lm"?(R=w,I=C[2]-_,R>C[2]+C[4]-1?(R=C[2]+C[4]-1,I=C[2]+C[0]-(C[2]+C[4]-1)):R<=0&&(R=0,I=C[2]+C[0])):P=="lb"?(R=w,I=C[2]-_,R>C[2]+C[4]-1?(R=C[2]+C[4]-1,I=C[2]+C[0]-(C[2]+C[4]-1)):R<=0&&(R=0,I=C[2]+C[0]),F=Math.round(I*(C[3]/C[2])),F<1?(F=1,I=Math.round(F*(C[2]/C[3])),R=C[2]+C[0]-I):F>=Ie.currentWinH-C[5]-42-6&&(F=Ie.currentWinH-C[5]-42-6,I=Math.round(F*(C[2]/C[3])),R=C[2]+C[0]-I)):P=="rt"?(I=C[2]+_,I<1?I=1:I>=Ie.currentWinW-C[4]-22-36&&(I=Ie.currentWinW-C[4]-22-36),F=Math.round(I*(C[3]/C[2])),T=C[3]+C[1]-F,T>C[3]+C[5]-1?(T=C[3]+C[5]-1,F=C[3]+C[1]-(C[3]+C[5]-1),I=Math.round(F*(C[2]/C[3]))):T<=0&&(T=0,F=C[3]+C[1],I=Math.round(F*(C[2]/C[3])))):P=="rm"?(I=C[2]+_,I<1?I=1:I>=Ie.currentWinW-C[4]-22-36&&(I=Ie.currentWinW-C[4]-22-36)):P=="rb"?(I=C[2]+_,I<1?I=1:I>=Ie.currentWinW-C[4]-22-36&&(I=Ie.currentWinW-C[4]-22-36),F=Math.round(I*(C[3]/C[2])),F<1?(F=1,I=Math.round(F*(C[2]/C[3]))):F>=Ie.currentWinH-C[5]-42-6&&(F=Ie.currentWinH-C[5]-42-6,I=Math.round(F*(C[2]/C[3])))):P=="mt"?(T=x,F=C[3]-S,T>C[3]+C[5]-1?(T=C[3]+C[5]-1,F=C[3]+C[1]-(C[3]+C[5]-1)):T<=0&&(T=0,F=C[3]+C[1])):P=="mb"&&(F=C[3]+S,F<1?F=1:F>=Ie.currentWinH-C[5]-42-6&&(F=Ie.currentWinH-C[5]-42-6));$("#luckysheet-modal-dialog-activeImage").css({width:I,height:F,left:R,top:T});let M=I/O.crop.width,A=F/O.crop.height,z=Math.round(O.default.width*M),L=Math.round(O.default.height*A),E=Math.round(O.crop.offsetLeft*M),V=Math.round(O.crop.offsetTop*A);$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-size":z+"px "+L+"px","background-position":-E+"px "+-V+"px"})}else if(Ie.cropChange){let y=ut(p.pageX,p.pageY),k=y[0]+$("#luckysheet-cell-main").scrollLeft(),b=y[1]+$("#luckysheet-cell-main").scrollTop();if(k<0||b<0)return!1;let w=Ie.cropChangeXY,x=b-w[1],C=k-w[0],S=Ie.images[Ie.currentImgId],_=Ie.cropChange,T,F,R,I;_=="lt"?(R=S.crop.offsetLeft+C,R<0&&(R=0),R>S.crop.width+S.crop.offsetLeft-1&&(R=S.crop.width+S.crop.offsetLeft-1),T=S.crop.width+S.crop.offsetLeft-R,I=S.crop.offsetTop+x,I<0&&(I=0),I>S.crop.height+S.crop.offsetTop-1&&(I=S.crop.height+S.crop.offsetTop-1),F=S.crop.height+S.crop.offsetTop-I):_=="lm"?(R=S.crop.offsetLeft+C,R<0&&(R=0),R>S.crop.width+S.crop.offsetLeft-1&&(R=S.crop.width+S.crop.offsetLeft-1),T=S.crop.width+S.crop.offsetLeft-R,I=S.crop.offsetTop,F=S.crop.height):_=="lb"?(R=S.crop.offsetLeft+C,R<0&&(R=0),R>S.crop.width+S.crop.offsetLeft-1&&(R=S.crop.width+S.crop.offsetLeft-1),T=S.crop.width+S.crop.offsetLeft-R,I=S.crop.offsetTop,F=S.crop.height+x,F<1&&(F=1),F>S.default.height-I&&(F=S.default.height-I)):_=="rt"?(R=S.crop.offsetLeft,T=S.crop.width+C,T<1&&(T=1),T>S.default.width-R&&(T=S.default.width-R),I=S.crop.offsetTop+x,I<0&&(I=0),I>S.crop.height+S.crop.offsetTop-1&&(I=S.crop.height+S.crop.offsetTop-1),F=S.crop.height+S.crop.offsetTop-I):_=="rm"?(R=S.crop.offsetLeft,T=S.crop.width+C,T<1&&(T=1),T>S.default.width-R&&(T=S.default.width-R),I=S.crop.offsetTop,F=S.crop.height):_=="rb"?(R=S.crop.offsetLeft,T=S.crop.width+C,T<1&&(T=1),T>S.default.width-R&&(T=S.default.width-R),I=S.crop.offsetTop,F=S.crop.height+x,F<1&&(F=1),F>S.default.height-I&&(F=S.default.height-I)):_=="mt"?(R=S.crop.offsetLeft,T=S.crop.width,I=S.crop.offsetTop+x,I<0&&(I=0),I>S.crop.height+S.crop.offsetTop-1&&(I=S.crop.height+S.crop.offsetTop-1),F=S.crop.height+S.crop.offsetTop-I):_=="mb"&&(R=S.crop.offsetLeft,T=S.crop.width,I=S.crop.offsetTop,F=S.crop.height+x,F<1&&(F=1),F>S.default.height-I&&(F=S.default.height-I));let P=S.default.left+R,O=S.default.top+I;S.isFixedPos&&(P=S.fixedLeft+R,O=S.fixedTop+I),$("#luckysheet-modal-dialog-cropping").show().css({width:T,height:F,left:P,top:O});let M=f.toJsonOptions&&f.toJsonOptions.imageUrlHandle,A=typeof M=="function"?M(S.src):S.src;$("#luckysheet-modal-dialog-cropping .cropping-mask").css({width:S.default.width,height:S.default.height,"background-image":"url("+A+")",left:-R,top:-I}),$("#luckysheet-modal-dialog-cropping .cropping-content").css({"background-image":"url("+A+")","background-size":S.default.width+"px "+S.default.height+"px","background-position":-R+"px "+-I+"px"}),Ie.cropChangeObj={width:T,height:F,offsetLeft:R,offsetTop:I}}else if(He.move){let y=ut(p.pageX,p.pageY),k=y[0]+$("#luckysheet-cell-main").scrollLeft(),b=y[1]+$("#luckysheet-cell-main").scrollTop(),w=He.currentObj.outerHeight(),x=He.currentObj.outerWidth(),C=b-He.moveXY[1],S=k-He.moveXY[0];C<0&&(C=0),C+w+42+6>He.currentWinH&&(C=He.currentWinH-w-42-6),S<0&&(S=0),S+x+22+36>He.currentWinW&&(S=He.currentWinW-x-22-36),He.currentObj.css({left:S,top:C})}else if(He.resize){let y=ut(p.pageX,p.pageY),k=y[0]+$("#luckysheet-cell-main").scrollLeft(),b=y[1]+$("#luckysheet-cell-main").scrollTop();if(k<0||b<0)return!1;let w=He.resizeXY,x=b-w[1],C=k-w[0],S=w[5],_=w[3],T=w[4],F=w[2],R=He.resize;(R=="lm"||R=="lt"||R=="lb")&&(T=k,F=w[2]-C,T>w[2]+w[4]-60?(T=w[2]+w[4]-60,F=w[2]-(w[2]+w[4]-60-w[0])):T<=0&&(T=0,F=w[2]+w[0])),(R=="rm"||R=="rt"||R=="rb")&&(F=w[2]+C,F<60?F=60:F>=He.currentWinW-w[4]-22-36&&(F=He.currentWinW-w[4]-22-36)),(R=="mt"||R=="lt"||R=="rt")&&(S=b,_=w[3]-x,S>w[3]+w[5]-60?(S=w[3]+w[5]-60,_=w[3]-(w[3]+w[5]-60-w[1])):S<=0&&(S=0,_=w[3]+w[1])),(R=="mb"||R=="lb"||R=="rb")&&(_=w[3]+x,_<60?_=60:_>=He.currentWinH-w[5]-42-6&&(_=He.currentWinH-w[5]-42-6)),He.currentObj.css({width:F,height:_,left:T,top:S})}else g.rangeResize?g.rangeResizeDraging(p,g.rangeResizeObj,g.rangeResizexy,g.rangeResize,g.rangeResizeWinW,g.rangeResizeWinH,f.ch_width,f.rh_height):g.rangeMove?g.rangeMoveDraging(p,g.rangeMovexy,g.rangeMoveObj.data("range"),g.rangeMoveObj,f.sheetBarHeight,f.statisticBarHeight):f.chart_selection.rangeResize?f.chart_selection.rangeResizeDraging(p,f.sheetBarHeight,f.statisticBarHeight):f.chart_selection.rangeMove&&f.chart_selection.rangeMoveDraging(p,f.sheetBarHeight,f.statisticBarHeight);f.jfautoscrollTimeout=window.requestAnimationFrame(v)};f.luckysheet_select_status&&(clearTimeout(f.countfuncTimeout),f.countfuncTimeout=setTimeout(function(){bl()},500)),f.jfautoscrollTimeout=window.requestAnimationFrame(v)}}),$(document).on("mouseup.luckysheetEvent",function(p){if(de&&de.hook&&de.hook.sheetMouseup){let P=ut(p.pageX,p.pageY),O=P[0]+$("#luckysheet-cell-main").scrollLeft(),M=P[1]+$("#luckysheet-cell-main").scrollTop(),A=$t(M),z=A[1],L=A[0],E=A[2],V=_t(O),q=V[1],G=V[0],X=V[2],ee=be.mergeborer(f.flowdata,E,X);ee&&(z=ee.row[1],L=ee.row[0],E=ee.row[2],q=ee.column[1],G=ee.column[0],X=ee.column[2]);let le=ye.getSheetByIndex(),se={functionResizeStatus:g.functionResizeStatus,horizontalmoveState:!!Y.horizontalmovestate,verticalmoveState:!!Y.verticalmovestate,pivotTableMoveState:!!Oe&&Oe.movestate,sheetMoveStatus:f.luckysheet_sheet_move_status,scrollStatus:!!f.luckysheet_scroll_status,selectStatus:!!f.luckysheet_select_status,rowsSelectedStatus:!!f.luckysheet_rows_selected_status,colsSelectedStatus:!!f.luckysheet_cols_selected_status,cellSelectedMove:!!f.luckysheet_cell_selected_move,cellSelectedExtend:!!f.luckysheet_cell_selected_extend,colsChangeSize:!!f.luckysheet_cols_change_size,rowsChangeSize:!!f.luckysheet_rows_change_size,chartMove:!!f.chartparam.luckysheetCurrentChartMove,chartResize:!!f.chartparam.luckysheetCurrentChartResize,rangeResize:!!g.rangeResize,rangeMove:!!g.rangeMove},ae=$("#luckysheetTableContent").get(0).getContext("2d");Je.createHookFunction("sheetMouseup",f.flowdata[E][X],{r:E,c:X,start_r:L,start_c:G,end_r:z,end_c:q},le,se,ae)}if(f.luckysheet_select_status&&(clearTimeout(f.countfuncTimeout),f.countfuncTimeout=setTimeout(function(){bl()},0),be.luckysheetPaintModelOn&&(wt.pasteHandlerOfPaintModel(f.luckysheet_copy_save),be.luckysheetPaintSingle&&be.cancelPaintModel())),f.luckysheet_select_status=!1,window.cancelAnimationFrame(f.jfautoscrollTimeout),f.luckysheet_scroll_status=!1,$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),f.luckysheet_rows_selected_status=!1,f.luckysheet_cols_selected_status=!1,f.luckysheet_model_move_state=!1,g.functionResizeStatus&&(g.functionResizeStatus=!1,$("#luckysheet-wa-calculate-size").removeAttr("style")),Y.horizontalmovestate&&(Y.horizontalmovestate=!1,$("#luckysheet-freezebar-horizontal").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grab"),Y.freezenhorizontaldata[4]<=f.columnHeaderHeight&&Y.cancelFreezenHorizontal(),Y.createAssistCanvas(),Be()),Y.verticalmovestate&&(Y.verticalmovestate=!1,$("#luckysheet-freezebar-vertical").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grab"),Y.freezenverticaldata[4]<=f.rowHeaderWidth&&Y.cancelFreezenVertical(),Y.createAssistCanvas(),Be()),!!Oe&&Oe.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").remove(),Oe.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),Oe.movesave.containerid!="luckysheet-modal-dialog-pivotTable-list"&&$(p.target).closest(".luckysheet-modal-dialog-slider-config-list").length==0&&(Oe.movesave.containerid=="luckysheet-modal-dialog-config-value"&&Oe.resetOrderby(Oe.movesave.obj),Oe.movesave.obj.remove(),Oe.showvaluecolrow(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){let O=$(this).data("index");$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){let M=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==O&&M.find("i").length==0&&M.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')})}),Oe.refreshPivotTable())),f.luckysheet_sheet_move_status&&(f.luckysheet_sheet_move_status=!1,f.luckysheet_sheet_move_data.activeobject.insertBefore($("#luckysheet-sheets-item-clone")),f.luckysheet_sheet_move_data.activeobject.removeAttr("style"),$("#luckysheet-sheets-item-clone").remove(),f.luckysheet_sheet_move_data.cursorobject.css({cursor:"pointer"}),f.luckysheet_sheet_move_data={},ye.reOrderAllSheet()),clearTimeout(f.chartparam.luckysheetCurrentChartMoveTimeout),f.chartparam.luckysheetCurrentChartMove&&(f.chartparam.luckysheetCurrentChartMove=!1,f.chartparam.luckysheetInsertChartTosheetChange)){var v=f.chartparam.luckysheetCurrentChartMoveObj.css("top"),y=f.chartparam.luckysheetCurrentChartMoveObj.css("left"),k=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),w=f.chartparam.luckysheetCurrentChartMoveXy[2],x=f.chartparam.luckysheetCurrentChartMoveXy[3],C=f.chartparam.luckysheetCurrentChartMoveXy[4],S=f.chartparam.luckysheetCurrentChartMoveXy[5],_=f.chartparam.luckysheetCurrentChartMoveObj.find(".luckysheet-modal-dialog-content").attr("id");f.jfredo.push({type:"moveChart",chart_id:_,sheetIndex:f.currentSheetIndex,myTop:v,myLeft:y,scrollTop:b,scrollLeft:k,x:w,y:x,scrollTop1:S,scrollLeft1:C})}if(f.chartparam.luckysheetCurrentChartResize&&(f.chartparam.luckysheetCurrentChartResize=null,f.chartparam.luckysheetInsertChartTosheetChange)){var T=f.chartparam.luckysheetCurrentChartResizeObj.height(),F=f.chartparam.luckysheetCurrentChartResizeObj.width(),k=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),v=f.chartparam.luckysheetCurrentChartMoveObj.css("top"),y=f.chartparam.luckysheetCurrentChartMoveObj.css("left"),_=f.chartparam.luckysheetCurrentChartResizeObj.find(".luckysheet-modal-dialog-content").attr("id"),R=f.chartparam.luckysheetCurrentChartResizeXy[2],I=f.chartparam.luckysheetCurrentChartResizeXy[3],w=f.chartparam.luckysheetCurrentChartResizeXy[4],x=f.chartparam.luckysheetCurrentChartResizeXy[5],C=f.chartparam.luckysheetCurrentChartResizeXy[6],S=f.chartparam.luckysheetCurrentChartResizeXy[7];f.jfredo.push({type:"resizeChart",chart_id:_,sheetIndex:f.currentSheetIndex,myTop:v,myLeft:y,myHeight:T,myWidth:F,scrollTop:b,scrollLeft:k,x:w,y:x,myWidth1:R,myHeight1:I,scrollTop1:S,scrollLeft1:C})}if(g.rangeResize&&g.rangeResizeDragged(p,g.rangeResizeObj,g.rangeResize,g.rangeResizexy,g.rangeResizeWinW,g.rangeResizeWinH),Ie.move&&Ie.moveImgItem(),Ie.resize&&Ie.resizeImgItem(),Ie.cropChange&&Ie.cropChangeImgItem(),He.move){He.move=!1;let P=He.currentObj.closest(".luckysheet-postil-show").attr("id"),O=P.split("luckysheet-postil-show_")[1].split("_")[0],M=P.split("luckysheet-postil-show_")[1].split("_")[1],A=xe.deepCopyFlowData(f.flowdata),z=[];A[O][M].ps.left=He.currentObj.position().left,A[O][M].ps.top=He.currentObj.position().top,A[O][M].ps.value=He.currentObj.find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim(),z.push(O+"_"+M),He.ref(A,z),$("#"+P).remove(),A[O][M].ps.isshow?(He.buildPs(O,M,A[O][M].ps),$("#"+P).addClass("luckysheet-postil-show-active"),$("#"+P).find(".luckysheet-postil-dialog-resize").show()):He.editPs(O,M)}if(He.resize){He.resize=null;let P=He.currentObj.closest(".luckysheet-postil-show").attr("id"),O=P.split("luckysheet-postil-show_")[1].split("_")[0],M=P.split("luckysheet-postil-show_")[1].split("_")[1],A=xe.deepCopyFlowData(f.flowdata),z=[];A[O][M].ps.left=He.currentObj.position().left,A[O][M].ps.top=He.currentObj.position().top,A[O][M].ps.width=He.currentObj.outerWidth(),A[O][M].ps.height=He.currentObj.outerHeight(),A[O][M].ps.value=He.currentObj.find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim(),z.push(O+"_"+M),He.ref(A,z),$("#"+P).remove(),A[O][M].ps.isshow?(He.buildPs(O,M,A[O][M].ps),$("#"+P).addClass("luckysheet-postil-show-active"),$("#"+P).find(".luckysheet-postil-dialog-resize").show()):He.editPs(O,M)}if(f.luckysheet_rows_change_size){f.luckysheet_rows_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-rows-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","default");let P=ut(p.pageX,p.pageY),O=$("#luckysheet-rows-h").scrollTop(),M=P[1]+O,A=$(window).height(),z=$t(M),L=z[1],E=z[0],V=z[2],q=M+3-f.luckysheet_rows_change_size_start[0];M+3-f.luckysheet_rows_change_size_start[0]<19&&(q=19),M>=A-200+O&&(q=A-200-f.luckysheet_rows_change_size_start[0]+O);let G=$.extend(!0,{},f.config);G.rowlen==null&&(G.rowlen={}),G.customHeight==null&&(G.customHeight={}),G.customHeight[f.luckysheet_rows_change_size_start[1]]=1;let X=f.luckysheet_rows_change_size_start[1],ee=!1;f.luckysheet_select_save.length>0&&f.luckysheet_select_save.filter(se=>se.row_select).some(se=>(X>=se.row[0]&&X<=se.row[1]&&(ee=!0),ee)),ee?f.luckysheet_select_save.filter(se=>se.row_select).forEach(se=>{for(let ae=se.row[0];ae<=se.row[1];ae++)G.rowlen[ae]=Math.ceil(q/f.zoomRatio)}):G.rowlen[f.luckysheet_rows_change_size_start[1]]=Math.ceil(q/f.zoomRatio);let le=Ie.moveChangeSize("row",f.luckysheet_rows_change_size_start[1],q);f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"resize",ctrlType:"resizeR",sheetIndex:f.currentSheetIndex,config:$.extend(!0,{},f.config),curconfig:$.extend(!0,{},G),images:$.extend(!0,{},Ie.images),curImages:$.extend(!0,{},le)})),f.config=G,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,G.rowlen,{k:"rowlen"}),f.luckysheetfile[Z(f.currentSheetIndex)].images=le,ne.saveParam("all",f.currentSheetIndex,le,{k:"images"}),Ie.images=le,Ie.allImagesShow(),Ct(f.flowdata.length,null)}if(f.luckysheet_cols_change_size){f.luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");let P=ut(p.pageX,p.pageY),O=$("#luckysheet-cols-h-c").scrollLeft(),M=P[0]+O,A=$(window).width(),z=f.visibledatarow.length-1,L=f.visibledatarow[z],E=0,V=_t(M),q=V[1],G=V[0],X=V[2],ee=M+3-f.luckysheet_cols_change_size_start[0],le=f.defaultcollen;if(f.config.columnlen!=null&&f.config.columnlen[f.luckysheet_cols_change_size_start[1]]!=null&&(le=f.config.columnlen[f.luckysheet_cols_change_size_start[1]]),Math.abs(ee-le)<3)return;M+3-f.luckysheet_cols_change_size_start[0]<30&&(ee=30),M>=A-100+O&&(ee=A-100-f.luckysheet_cols_change_size_start[0]+O);let se=$.extend(!0,{},f.config);se.columnlen==null&&(se.columnlen={}),se.customWidth==null&&(se.customWidth={}),se.customWidth[f.luckysheet_cols_change_size_start[1]]=1;let ae=f.luckysheet_cols_change_size_start[1],ue=!1;f.luckysheet_select_save.length>0&&f.luckysheet_select_save.filter(ce=>ce.column_select).some(ce=>(ae>=ce.column[0]&&ae<=ce.column[1]&&(ue=!0),ue)),ue?f.luckysheet_select_save.filter(ce=>ce.column_select).forEach(ce=>{for(let K=ce.column[0];K<=ce.column[1];K++)se.columnlen[K]=Math.ceil(ee/f.zoomRatio)}):se.columnlen[f.luckysheet_cols_change_size_start[1]]=Math.ceil(ee/f.zoomRatio);let fe=Ie.moveChangeSize("column",f.luckysheet_cols_change_size_start[1],ee);f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"resize",ctrlType:"resizeC",sheetIndex:f.currentSheetIndex,config:$.extend(!0,{},f.config),curconfig:$.extend(!0,{},se),images:$.extend(!0,{},Ie.images),curImages:$.extend(!0,{},fe)})),f.config=se,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,se.columnlen,{k:"columnlen"}),f.luckysheetfile[Z(f.currentSheetIndex)].images=fe,ne.saveParam("all",f.currentSheetIndex,fe,{k:"images"}),Ie.images=fe,Ie.allImagesShow(),Ct(null,f.flowdata[0].length),setTimeout(function(){Be()},1)}if(g.rangeMove&&g.rangeMoveDragged(g.rangeMoveObj),f.luckysheet_cell_selected_move){$("#luckysheet-cell-selected-move").hide(),f.luckysheet_cell_selected_move=!1;let P=ut(p.pageX,p.pageY);if(!pr(f.luckysheet_select_save,f.currentSheetIndex))return;let O=$("#luckysheet-cell-main").scrollLeft(),M=$("#luckysheet-cell-main").scrollTop(),A=P[0]+O,z=P[1]+M,L=$(window).height()+M-f.sheetBarHeight-f.statisticBarHeight,E=$(window).width()+O,V=$t(z)[2],q=_t(A)[2],G=f.luckysheet_cell_selected_move_index[0],X=f.luckysheet_cell_selected_move_index[1];if(V==G&&q==X)return;let ee=xe.deepCopyFlowData(f.flowdata),le=f.luckysheet_select_save[f.luckysheet_select_save.length-1],se=Bt(le),ae=$.extend(!0,{},f.config);if(ae.merge==null&&(ae.merge={}),ae.rowlen==null&&(ae.rowlen={}),Dt(ae,le.row[0],le.row[1],le.column[0],le.column[1])){he()?alert(l.noMerge):W.info('<i class="fa fa-exclamation-triangle"></i>',l.noMerge);return}let ue=le.row[0]-G+V,fe=le.row[1]-G+V,ce=le.column[0]-X+q,K=le.column[1]-X+q;if(!pr([{row:[ue,fe],column:[ce,K]}],f.currentSheetIndex))return;if((ue<0||z<0)&&(ue=0,fe=le.row[1]-le.row[0]),(ce<0||A<0)&&(ce=0,K=le.column[1]-le.column[0]),(fe>=f.visibledatarow[f.visibledatarow.length-1]||z>L)&&(ue=f.visibledatarow.length-1-le.row[1]+le.row[0],fe=f.visibledatarow.length-1),(K>=f.visibledatacolumn[f.visibledatacolumn.length-1]||A>E)&&(ce=f.visibledatacolumn.length-1-le.column[1]+le.column[0],K=f.visibledatacolumn.length-1),Dt(ae,ue,fe,ce,K)){he()?alert(l.noMerge):W.info('<i class="fa fa-exclamation-triangle"></i>',l.noMerge);return}let U=Ur(f.currentSheetIndex),te=null;for(let Ce=le.row[0];Ce<=le.row[1];Ce++){Ce in ae.rowlen&&(te=!0);for(let Ee=le.column[0];Ee<=le.column[1];Ee++){let Ue=ee[Ce][Ee];N(Ue)=="object"&&"mc"in Ue&&Ue.mc.r+"_"+Ue.mc.c in ae.merge&&delete ae.merge[Ue.mc.r+"_"+Ue.mc.c],ee[Ce][Ee]=null}}if(ae.borderInfo&&ae.borderInfo.length>0){let Ce=[];for(let Ee=0;Ee<ae.borderInfo.length;Ee++){let Ue=ae.borderInfo[Ee].rangeType;if(Ue=="range"){let Pe=ae.borderInfo[Ee].range,et=[];for(let yt=0;yt<Pe.length;yt++)et=et.concat(Se.CFSplitRange(Pe[yt],{row:le.row,column:le.column},{row:[ue,fe],column:[ce,K]},"restPart"));ae.borderInfo[Ee].range=et,Ce.push(ae.borderInfo[Ee])}else if(Ue=="cell"){let Pe=ae.borderInfo[Ee].value.row_index,et=ae.borderInfo[Ee].value.col_index;Pe>=le.row[0]&&Pe<=le.row[1]&&et>=le.column[0]&&et<=le.column[1]||Ce.push(ae.borderInfo[Ee])}}ae.borderInfo=Ce}let ge={};for(let Ce=0;Ce<se.length;Ce++)for(let Ee=0;Ee<se[0].length;Ee++){if(U[Ce+le.row[0]+"_"+(Ee+le.column[0])]){let Pe={rangeType:"cell",value:{row_index:Ce+ue,col_index:Ee+ce,l:U[Ce+le.row[0]+"_"+(Ee+le.column[0])].l,r:U[Ce+le.row[0]+"_"+(Ee+le.column[0])].r,t:U[Ce+le.row[0]+"_"+(Ee+le.column[0])].t,b:U[Ce+le.row[0]+"_"+(Ee+le.column[0])].b}};ae.borderInfo==null&&(ae.borderInfo=[]),ae.borderInfo.push(Pe)}let Ue="";if(se[Ce]!=null&&se[Ce][Ee]!=null&&(Ue=se[Ce][Ee]),N(Ue)=="object"&&"mc"in Ue){let Pe=$.extend(!0,{},Ue.mc);"rs"in Ue.mc?(ge[Pe.r+"_"+Pe.c]=[Ce+ue,Ee+ce],Ue.mc.r=Ce+ue,Ue.mc.c=Ee+ce,ae.merge[Ce+ue+"_"+(Ee+ce)]=Ue.mc):(Ue.mc.r=ge[Pe.r+"_"+Pe.c][0],Ue.mc.c=ge[Pe.r+"_"+Pe.c][1])}ee[Ce+ue][Ee+ce]=Ue}te&&(ae=pl(ee,le.row[0],le.row[1],ae),ae=pl(ee,ue,fe,ae));let ie=$.extend(!0,[],f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save);if(ie!=null&&ie.length>0)for(let Ce=0;Ce<ie.length;Ce++){let Ee=ie[Ce].cellrange,Ue=[];for(let Pe=0;Pe<Ee.length;Pe++){let et=Se.CFSplitRange(Ee[Pe],{row:le.row,column:le.column},{row:[ue,fe],column:[ce,K]},"allPart");Ue=Ue.concat(et)}ie[Ce].cellrange=Ue}let $e;f.luckysheet_select_save[0].row_focus==f.luckysheet_select_save[0].row[0]?$e=ue:$e=fe;let oe;f.luckysheet_select_save[0].column_focus==f.luckysheet_select_save[0].column[0]?oe=ce:oe=K;let ze=[];ze.push({row:le.row,column:le.column}),ze.push({row:[ue,fe],column:[ce,K]}),le.row=[ue,fe],le.column=[ce,K],le.row_focus=$e,le.column_focus=oe,Ze(ee,ze,{cfg:ae,RowlChange:te,cdformat:ie}),lt(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(f.countfuncTimeout),f.countfuncTimeout=setTimeout(function(){bl()},500)}if(f.chart_selection.rangeMove&&f.chart_selection.rangeMoveDragged(),f.chart_selection.rangeResize&&f.chart_selection.rangeResizeDragged(),f.luckysheet_cell_selected_extend){if(f.luckysheet_cell_selected_extend=!1,$("#luckysheet-cell-selected-extend").hide(),!pr(f.luckysheet_select_save,f.currentSheetIndex))return;let P=ut(p.pageX,p.pageY),O=$("#luckysheet-cell-main").scrollLeft(),M=$("#luckysheet-cell-main").scrollTop(),A=P[0]+O-5,z=P[1]+M-5,L=$(window).height()+M-f.sheetBarHeight-f.statisticBarHeight,E=$(window).width()+O,V=$t(z),q=V[1],G=V[0],X=V[2],ee=_t(A),le=ee[1],se=ee[0],ae=ee[2],ue=f.luckysheet_cell_selected_extend_index[0],fe=f.luckysheet_cell_selected_extend_index[1],ce=f.luckysheet_select_save[f.luckysheet_select_save.length-1],K=ce.row[0],U=ce.row[1],te=ce.column[0],ge=ce.column[1];(K<0||z<0)&&(K=0,U=ce.row[1]-ce.row[0]),(te<0||A<0)&&(te=0,ge=ce.column[1]-ce.column[0]),(U>=f.visibledatarow[f.visibledatarow.length-1]||z>L)&&(K=f.visibledatarow.length-1-ce.row[1]+ce.row[0],U=f.visibledatarow.length-1),(ge>=f.visibledatacolumn[f.visibledatacolumn.length-1]||A>E)&&(te=f.visibledatacolumn.length-1-ce.column[1]+ce.column[0],ge=f.visibledatacolumn.length-1),nl.copyRange={row:$.extend(!0,[],ce.row),column:$.extend(!0,[],ce.column)};let ie=nl.typeItemHide();if(!ie[0]&&!ie[1]&&!ie[2]&&!ie[3]&&!ie[4]&&!ie[5]&&!ie[6]?nl.applyType="0":nl.applyType="1",Math.abs(ue-X)>Math.abs(fe-ae)){if(X>=K&&X<=U)return;if(f.luckysheet_select_save[0].top_move>=G){if(nl.applyRange={row:[X,ce.row[0]-1],column:ce.column},nl.direction="up",K-=ce.row[0]-X,Oe.isPivotRange(K,ge)){W.info(l.affectPivot,"");return}}else if(nl.applyRange={row:[ce.row[1]+1,X],column:ce.column},nl.direction="down",U+=X-ce.row[1],Oe.isPivotRange(U,ge)){W.info(l.affectPivot,"");return}}else{if(ae>=te&&ae<=ge)return;if(f.luckysheet_select_save[0].left_move>=se){if(nl.applyRange={row:ce.row,column:[ae,ce.column[0]-1]},nl.direction="left",te-=ce.column[0]-ae,Oe.isPivotRange(U,te)){W.info(l.affectPivot,"");return}}else if(nl.applyRange={row:ce.row,column:[ce.column[1]+1,ae]},nl.direction="right",ge+=ae-ce.column[1],Oe.isPivotRange(U,ge)){W.info(l.affectPivot,"");return}}if(f.config.merge!=null){let $e=!1;for(let oe=ce.row[0];oe<=ce.row[1];oe++)for(let ze=ce.column[0];ze<=ce.column[1];ze++){let je=f.flowdata[oe][ze];if(je!=null&&je.mc!=null){$e=!0;break}}if($e){he()?alert(l.noMerge):W.info(l.noMerge,"");return}for(let oe=K;oe<=U;oe++)for(let ze=te;ze<=ge;ze++){let je=f.flowdata[oe][ze];if(je!=null&&je.mc!=null){$e=!0;break}}if($e){he()?alert(l.noMerge):W.info(l.noMerge,"");return}}ce.row=[K,U],ce.column=[te,ge],nl.update(),nl.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(f.countfuncTimeout),f.countfuncTimeout=setTimeout(function(){bl()},500)}}),$(".luckysheet-grid-container, #luckysheet-rightclick-menu").on("contextmenu",function(p){p.preventDefault()}),$("#luckysheet-cell-main div.luckysheet-cs-draghandle").mousedown(function(p){if(he()||f.allowEdit===!1)return;$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","move").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","move"),f.luckysheet_cell_selected_move=!0,f.luckysheet_scroll_status=!0;let v=ut(p.pageX,p.pageY),y=v[0]+$("#luckysheet-cell-main").scrollLeft(),k=v[1]+$("#luckysheet-cell-main").scrollTop(),b=$t(k),w=b[0],x=b[1],C=b[2],S=_t(y),_=S[0],T=S[1],F=S[2];f.luckysheet_cell_selected_move_index=[C,F],$("#luckysheet-cell-selected-move").css({left:_,width:T-_-1,top:w,height:x-w-1,display:"block"}),p.stopPropagation()}),$("#luckysheet-cell-main div.luckysheet-cs-fillhandle").mousedown(function(p){he()||f.allowEdit===!1||($("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","crosshair"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","crosshair"),f.luckysheet_cell_selected_extend_time=setTimeout(function(){f.luckysheet_cell_selected_extend=!0,f.luckysheet_scroll_status=!0;let v=ut(p.pageX,p.pageY),y=v[0]+$("#luckysheet-cell-main").scrollLeft()-5,k=v[1]+$("#luckysheet-cell-main").scrollTop()-5,b=$t(k),w=b[0],x=b[1],C=b[2],S=_t(y),_=S[0],T=S[1],F=S[2];f.luckysheet_cell_selected_extend_index=[C,F],$("#luckysheet-cell-selected-extend").css({left:_,width:T-_-1,top:w,height:x-w-1,display:"block"})},100),p.stopPropagation())}).click(function(){clearTimeout(f.luckysheet_cell_selected_extend_time),event.stopPropagation()}).dblclick(function(){let p=f.luckysheet_select_save[0],v=p.row[0],y=p.row[1],k=p.column[0],b=p.column[1];if(Oe.isPivotRange(v,k))return;let w=!1,x=0;for(let S=y+1;S<f.flowdata.length;S++)if(k-1>=0&&b+1<f.flowdata[0].length){let _=f.flowdata[S][k-1],T=f.flowdata[S][b+1];if(S==y+1)if((_==null||me(_.v))&&(T==null||me(T.v))){w=!1;break}else w=!0,x++;else{if((_==null||me(_.v))&&(T==null||me(T.v)))break;x++}}else if(k-1>=0){let _=f.flowdata[S][k-1];if(S==y+1)if(_==null||me(_.v)){w=!1;break}else w=!0,x++;else{if(_==null||me(_.v))break;x++}}else if(b+1<f.flowdata[0].length){let _=f.flowdata[S][b+1];if(S==y+1)if(_==null||me(_.v)){w=!1;break}else w=!0,x++;else{if(_==null||me(_.v))break;x++}}if(!w||x==0){event.stopPropagation();return}nl.copyRange={row:[v,y],column:[k,b]};let C=nl.typeItemHide();!C[0]&&!C[1]&&!C[2]&&!C[3]&&!C[4]&&!C[5]&&!C[6]?nl.applyType="0":nl.applyType="1",nl.applyRange={row:[y+1,y+x],column:[k,b]},nl.direction="down",f.luckysheet_select_save=[{row:[v,y+x],column:[k,b]}],nl.update(),nl.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(f.countfuncTimeout),f.countfuncTimeout=setTimeout(function(){bl()},500),event.stopPropagation()}),$("#luckysheet-bottom-add-row, #luckysheet-bottom-add-row-input, #luckysheet-bottom-return-top").on("mousedown dblclick mouseup",function(p){p.stopPropagation()}),$("#luckysheet-bottom-add-row").on("click",function(p){$("#luckysheet-rightclick-menu").hide(),rt();let v=$(this),y=$("#luckysheet-bottom-add-row-input").val();if(y==""&&(y=de.addRowCount||100),isNaN(parseInt(y))){he()?alert(o.tipInputNumber):W.info("error",o.tipInputNumber);return}if(y=parseInt(y),y<1||y>100){he()?alert(o.tipInputNumberLimit):W.info("error",o.tipInputNumberLimit);return}Tr("row",f.flowdata.length-1,y)}),$("#luckysheet-bottom-return-top").on("click",function(p){$("#luckysheet-scrollbar-y").scrollTop(0)}),$("#luckysheet-copy-btn, #luckysheet-cols-copy-btn, #luckysheet-paste-btn-title").click(function(p){if($(this).parent().hide(),f.config.merge!=null){let y=!1;for(let k=0;k<f.luckysheet_select_save.length;k++){let b=f.luckysheet_select_save[k].row[0],w=f.luckysheet_select_save[k].row[1],x=f.luckysheet_select_save[k].column[0],C=f.luckysheet_select_save[k].column[1];if(y=Dt(f.config,b,w,x,C),y)break}if(y){he()?alert(l.noPartMerge):W.info(l.noPartMerge,"");return}}let v=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save;if(f.luckysheet_select_save.length>1&&v!=null&&v.length>0){let y=!1,k=Se.getComputeMap();e:for(let b=0;b<f.luckysheet_select_save.length&&!y;b++){let w=f.luckysheet_select_save[b].row[0],x=f.luckysheet_select_save[b].row[1],C=f.luckysheet_select_save[b].column[0],S=f.luckysheet_select_save[b].column[1];for(let _=w;_<=x;_++)for(let T=C;T<=S;T++)if(Se.checksCF(_,T,k)!=null){y=!0;continue e}}if(y){he()?alert(l.noMulti):W.info(l.noMulti,"");return}}if(f.luckysheet_select_save.length>1){let y=!0,k=f.luckysheet_select_save[0].row[0],b=f.luckysheet_select_save[0].row[1],w=!0,x=f.luckysheet_select_save[0].column[0],C=f.luckysheet_select_save[0].column[1];for(let S=1;S<f.luckysheet_select_save.length;S++)(f.luckysheet_select_save[S].row[0]!=k||f.luckysheet_select_save[S].row[1]!=b)&&(y=!1),(f.luckysheet_select_save[S].column[0]!=x||f.luckysheet_select_save[S].column[1]!=C)&&(w=!1);if(!y&&!w||Yr()){he()?alert(l.noMulti):W.info(l.noMulti,"");return}}wt.copy(p)}),$("#luckysheet-copy-paste, #luckysheet-cols-paste-btn, #luckysheet-paste-btn-title").click(function(p){wt.paste(p,"btn"),$(this).parent().hide()}),$("#luckysheet-chart-btn-title").click(function(){console.warn("TODO : #luckysheet-chart-btn-title \u3053\u306E\u30A4\u30D9\u30F3\u30C8\u6D88\u3059")}),$("#luckysheetdatavisual").click(function(){console.warn("TODO : #luckysheetdatavisual \u3053\u306E\u30A4\u30D9\u30F3\u30C8\u6D88\u3059"),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheet-pivot-btn-title").click(function(p){!Tt(f.currentSheetIndex,"usePivotTablereports")||Oe.createPivotTable(p)}),$("#luckysheet-chart-btn-screenshot").click(function(){let p=t.screenshot;if(f.luckysheet_select_save.length==0){he()?alert(p.screenshotTipNoSelection):W.info(p.screenshotTipTitle,p.screenshotTipNoSelection);return}if(f.luckysheet_select_save.length>1){he()?alert(p.screenshotTipHasMulti):W.info(p.screenshotTipTitle,p.screenshotTipHasMulti);return}if(f.config.merge!=null){let P=!1;for(let O=0;O<f.luckysheet_select_save.length;O++){let M=f.luckysheet_select_save[O].row[0],A=f.luckysheet_select_save[O].row[1],z=f.luckysheet_select_save[O].column[0],L=f.luckysheet_select_save[O].column[1];if(P=Dt(f.config,M,A,z,L),P)break}if(P){he()?alert(p.screenshotTipHasMerge):W.info(p.screenshotTipTitle,p.screenshotTipHasMerge);return}}let v=f.luckysheet_select_save[0].row[0],y=f.luckysheet_select_save[0].row[1],k=f.luckysheet_select_save[0].column[0],b=f.luckysheet_select_save[0].column[1],w,x;v-1<0?(w=0,x=f.visibledatarow[y]):(w=f.visibledatarow[v-1],x=f.visibledatarow[y]-f.visibledatarow[v-1]);let C,S;k-1<0?(C=0,S=f.visibledatacolumn[b]):(C=f.visibledatacolumn[k-1],S=f.visibledatacolumn[b]-f.visibledatacolumn[k-1]);let _=$("<canvas>").attr({width:Math.ceil(S*f.devicePixelRatio),height:Math.ceil(x*f.devicePixelRatio)}).css({width:S,height:x});nr(C,w,S,x,1,1,null,null,_);let T=_.get(0).getContext("2d");T.beginPath(),T.moveTo(0,0),T.lineTo(0,f.devicePixelRatio*x),T.lineWidth=f.devicePixelRatio*2,T.strokeStyle=Tl.strokeStyle,T.stroke(),T.closePath(),T.beginPath(),T.moveTo(0,0),T.lineTo(f.devicePixelRatio*S,0),T.lineWidth=f.devicePixelRatio*2,T.strokeStyle=Tl.strokeStyle,T.stroke(),T.closePath();let F=new Image,R=_.get(0).toDataURL("image/png");F.src=R,S>x?F.style.width="100%":F.style.height="100%";let I=$(window).height()-200;W.screenshot(p.screenshotTipSuccess,'<div id="luckysheet-confirm-screenshot-save" style="height:'+I+'px;overflow:auto;"></div>',R),$("#luckysheet-confirm-screenshot-save").append(F),_.remove()}),$(document).on("click.luckysheetEvent","a.download",function(){let p=$("#luckysheet-confirm-screenshot-save img").attr("src"),v=t.screenshot,y=atob(p.split(",")[1]),k=y.length,b=new Uint8Array(k);for(let S=0;S<k;S++)b[S]=y.charCodeAt(S);let w=new Blob([b]),x=document.createElement("a");x.setAttribute("href",URL.createObjectURL(w)),x.setAttribute("download",v.screenshotImageName+".png"),x.style.display="none",document.body.appendChild(x),x.click();let C;x.addEventListener("click",C=function(){requestAnimationFrame(function(){URL.revokeObjectURL(x.href)}),x.removeAttribute("href"),x.removeEventListener("click",C)}),document.body.removeChild(x)}),$("#luckysheet-splitColumn-btn-title").click(function(){if(!jr(f.currentSheetIndex)||f.luckysheet_select_save==null||f.luckysheet_select_save.length==0)return;let p=t.splitText;if(f.luckysheet_select_save.length>1){W.info(p.tipNoMulti,"");return}if(f.luckysheet_select_save[0].column[0]!=f.luckysheet_select_save[0].column[1]){W.info(p.tipNoMultiColumn,"");return}Lc.createDialog(),Lc.init()}),$("#luckysheet-insertImg-btn-title").click(function(){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}!Tt(f.currentSheetIndex,"editObjects")||$("#luckysheet-imgUpload").click()}),$("#luckysheetInsertImage").click(function(){!Tt(f.currentSheetIndex,"editObjects")||($("#luckysheet-imgUpload").click(),$("#luckysheet-rightclick-menu").hide())}),$("#luckysheet-imgUpload").click(function(p){p.stopPropagation()}),$("#luckysheet-imgUpload").on("change",function(p){if(!Tt(f.currentSheetIndex,"editObjects",!1))return;let v=p.currentTarget.files[0];Ie.insertImg(v)}),$("#luckysheet-insertLink-btn-title").click(function(){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}!jr(f.currentSheetIndex)||f.luckysheet_select_save==null||f.luckysheet_select_save.length==0||(Cl.createDialog(),Cl.init())}),$("#luckysheetInsertLink").click(function(){$("#luckysheet-insertLink-btn-title").click(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheet-dataVerification-btn-title").click(function(){!jr(f.currentSheetIndex)||f.luckysheet_select_save==null||f.luckysheet_select_save.length==0||(Ye.createDialog(),Ye.init())}),$("#luckysheetDataVerification").click(function(){$("#luckysheet-dataVerification-btn-title").click(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheetCellFormatRightClickMenu").click(function(){Bd()}),$("#luckysheet-freezen-btn-horizontal").click(function(){$.trim($(this).text())==Q().freezen.freezenCancel?(Y.saveFrozen("freezenCancel"),Y.freezenverticaldata!=null&&(Y.cancelFreezenVertical(),Y.createAssistCanvas(),Be()),Y.freezenhorizontaldata!=null&&(Y.cancelFreezenHorizontal(),Y.createAssistCanvas(),Be()),Y.scrollAdapt(),$("#luckysheet-icon-freezen-menu-menuButton").find(".fa.fa-check").remove()):(Y.saveFrozen("freezenRow"),Y.freezenverticaldata!=null&&(Y.cancelFreezenVertical(),Y.createAssistCanvas(),Be()),Y.freezenhorizontaldata==null&&(Y.createFreezenHorizontal(),Y.createAssistCanvas()))}),$("#luckysheet-freezen-btn-vertical").click(function(){Y.freezenverticaldata!=null?(Y.saveFrozen("freezenCancel"),Y.cancelFreezenVertical(),Be()):(Y.saveFrozen("freezenColumn"),Y.createFreezenVertical()),Y.createAssistCanvas()}),$("#luckysheet-rightclick-menu input").on("keydown",function(p){p.stopPropagation()}),$("#luckysheet-modal-dialog-mask").on("click dbclick mousedown mousemove mouseup",function(p){p.stopPropagation(),p.preventDefault()});let h=function(){(document.hidden||document.webkitHidden||document.msHidden)&&(f.iscopyself=!1)};$(document).on("visibilitychange.luckysheetEvent webkitvisibilitychange.luckysheetEvent msvisibilitychange.luckysheetEvent",h).on("mouseleave.luckysheetEvent",function(){f.iscopyself=!1}).on("mousedown.luckysheetEvent",function(p){He.removeActivePs(),xr(p),$(p.target).closest("#luckysheet-wa-editor").length>0&&parseInt($("#luckysheet-input-box").css("top"))>0&&(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("down",0,"rangeOfSelect"))}),$("#luckysheet-left-top").click(function(p){!Fo(f.currentSheetIndex)||($("#luckysheet-wa-functionbox-confirm").click(),f.luckysheet_select_status=!1,f.luckysheet_select_save=[{row:[0,f.flowdata.length-1],column:[0,f.flowdata[0].length-1],row_focus:0,column_focus:0,row_select:!0,column_select:!0}],lt(),clearTimeout(f.countfuncTimeout),f.countfuncTimeout=setTimeout(function(){bl()},500),ne.saveParam("mv",f.currentSheetIndex,f.luckysheet_select_save),p.stopPropagation())}),$("#luckysheet-icon-undo").click(function(p){$(this).hasClass("disabled")||_n.redo(p)}),$("#luckysheet-icon-redo").click(function(p){$(this).hasClass("disabled")||_n.undo(p)}),$(document).on("mousedown.luckysheetEvent","div.luckysheet-modal-dialog",function(p){if(!$(p.target).is(".luckysheet-modal-dialog"))return;f.luckysheet_model_move_state=!0,f.luckysheet_model_move_obj=$(p.currentTarget);let v=f.luckysheet_model_move_obj.offset();f.luckysheet_model_xy=[p.pageX-v.left,p.pageY-v.top]}),$(document).on("click.luckysheetEvent",".luckysheet-modal-dialog-title-close, .luckysheet-model-close-btn",function(p){($("#textcolorselect").is(":visible")||$("#cellcolorselect").is(":visible"))&&$("#luckysheet-conditionformat-dialog").show(),$(p.currentTarget).parents(".luckysheet-modal-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide(),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula")&&(g.dontupdate(),jt("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm")&&(g.dontupdate(),jt("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm-select")&&(g.dontupdate(),jt("down",0,"rangeOfSelect")),rt()}),$("#luckysheet_info_detail_title").click(()=>{window.open(de.myFolderUrl,"_self")}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowMove",".luckysheet-chart-rangeShow-move",function(p){f.chart_selection.rangeMove=!0,f.luckysheet_scroll_status=!0,f.chart_selection.rangeMoveObj=$(this).parent();let v=f.currentChart,y=$(this).parent().attr("id");if(y=="luckysheet-chart-rangeShow-content"){let _=v.rangeArray[0].row[0]+v.rangeSplitArray.content.row[0],T=v.rangeArray[0].column[0]+v.rangeSplitArray.content.column[0];f.chart_selection.rangeMoveIndex=[_,T]}else if(y=="luckysheet-chart-rangeShow-rowtitle"){let _=v.rangeArray[0].row[0]+v.rangeSplitArray.rowtitle.row[0],T=v.rangeArray[0].column[0]+v.rangeSplitArray.rowtitle.column[0];f.chart_selection.rangeMoveIndex=[_,T]}else if(y=="luckysheet-chart-rangeShow-coltitle"){let _=v.rangeArray[0].row[0]+v.rangeSplitArray.coltitle.row[0],T=v.rangeArray[0].column[0]+v.rangeSplitArray.coltitle.column[0];f.chart_selection.rangeMoveIndex=[_,T]}let k=ut(p.pageX,p.pageY),b=k[0]+$("#luckysheet-cell-main").scrollLeft(),w=k[1]+$("#luckysheet-cell-main").scrollTop(),x=$(this).data("type");x=="top"?w+=3:x=="right"?b-=3:x=="bottom"?w-=3:x=="left"&&(b+=3);let C=$t(w)[2],S=_t(b)[2];f.chart_selection.rangeMovexy=[C,S],p.stopPropagation()}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowResize",".luckysheet-chart-rangeShow-resize",function(p){f.chart_selection.rangeResize=$(this).data("type"),f.luckysheet_scroll_status=!0,f.chart_selection.rangeResizeObj=$(this).parent();let v=f.currentChart,y,k,b,w,x=$(this).parent().attr("id");if(x=="luckysheet-chart-rangeShow-content")v.rangeRowCheck.exits?(y=v.rangeArray[0].row[0]+v.rangeSplitArray.content.row[0],k=v.rangeArray[0].row[0]+v.rangeSplitArray.content.row[1]):(y=v.rangeSplitArray.content.row[0],k=v.rangeSplitArray.content.row[0]),v.rangeColCheck.exits?(b=v.rangeArray[0].column[0]+v.rangeSplitArray.content.column[0],w=v.rangeArray[0].column[0]+v.rangeSplitArray.content.column[1]):(b=v.rangeSplitArray.content.column[0],w=v.rangeSplitArray.content.column[1]),f.chart_selection.rangeResizeIndex={row:[y,k],column:[b,w]};else if(x=="luckysheet-chart-rangeShow-rowtitle"){let R=v.rangeArray[0].row[0]+v.rangeSplitArray.rowtitle.row[0],I=v.rangeArray[0].row[0]+v.rangeSplitArray.rowtitle.row[1],P=v.rangeArray[0].column[0]+v.rangeSplitArray.rowtitle.column[0],O=v.rangeArray[0].column[0]+v.rangeSplitArray.rowtitle.column[1];f.chart_selection.rangeResizeIndex={row:[R,I],column:[P,O]}}else if(x=="luckysheet-chart-rangeShow-coltitle"){let R=v.rangeArray[0].row[0]+v.rangeSplitArray.coltitle.row[0],I=v.rangeArray[0].row[0]+v.rangeSplitArray.coltitle.row[1],P=v.rangeArray[0].column[0]+v.rangeSplitArray.coltitle.column[0],O=v.rangeArray[0].column[0]+v.rangeSplitArray.coltitle.column[1];f.chart_selection.rangeResizeIndex={row:[R,I],column:[P,O]}}let C=ut(p.pageX,p.pageY),S=C[0]+$("#luckysheet-cell-main").scrollLeft(),_=C[1]+$("#luckysheet-cell-main").scrollTop();f.chart_selection.rangeResize=="lt"?(S+=3,_+=3):f.chart_selection.rangeResize=="lb"?(S+=3,_-=3):f.chart_selection.rangeResize=="rt"?(S-=3,_+=3):f.chart_selection.rangeResize=="rb"&&(S-=3,_-=3);let T=$t(_)[2],F=_t(S)[2];f.chart_selection.rangeResizexy=[T,F],p.stopPropagation()}),$("#luckysheet-wa-calculate-size").mousedown(function(p){let v=p.pageY;g.functionResizeData.y=v,g.functionResizeStatus=!0,g.functionResizeData.calculatebarHeight=f.calculatebarHeight,g.rangetosheet!=null&&g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1])}),be.initialMenuButton();let d=document.getElementById("testdpidiv").offsetWidth*f.devicePixelRatio,m=document.getElementById("testdpidiv").offsetHeight*f.devicePixelRatio;$(document).on("paste.luckysheetEvent",function(p){if(!he()){if(wt.isPasteAction){$("#luckysheet-rich-text-editor").blur(),wt.isPasteAction=!1;let v=window.clipboardData;v||(v=p.originalEvent.clipboardData);let y=v.getData("text/html")||v.getData("text/plain"),k=!0;if(y.indexOf("luckysheet_copy_action_table")>-1&&f.luckysheet_copy_save.copyRange!=null&&f.luckysheet_copy_save.copyRange.length>0){let w=[],x=new RegExp("<tr.*?>(.*?)</tr>","gs"),C=new RegExp("<td.*?>(.*?)</td>","gs"),S=y.match(x)||[];for(let O=0;O<S.length;O++){let M=[],A=S[O].match(C);if(A!=null)for(let z=0;z<A.length;z++){let L=A[z].replace(/<td.*?>/gs,"").replace(/<\/td>/gs,"");M.push(L)}w.push(M)}let _=f.luckysheet_copy_save.copyRange[0].row[0],T=f.luckysheet_copy_save.copyRange[0].row[1],F=f.luckysheet_copy_save.copyRange[0].column[0],R=f.luckysheet_copy_save.copyRange[0].column[1],I=f.luckysheet_copy_save.dataSheetIndex,P;I==f.currentSheetIndex?P=xe.deepCopyFlowData(f.flowdata):P=f.luckysheetfile[Z(I)].data;for(let O=_;O<=T&&!(O-_>w.length-1);O++)for(let M=F;M<=R;M++){let A=P[O][M],z=!1;if(A!=null&&A.mc!=null&&A.mc.rs==null)continue;let L;if(A!=null?A.ct!=null&&A.ct.fa.indexOf("w")>-1?L=P[O][M].v:L=P[O][M].m:L="",L==null&&P[O][M]&&P[O][M].ct&&P[O][M].ct.t=="inlineStr"&&(L=P[O][M].ct.s.map(E=>E.v).join(""),z=!0),L==null&&(L=""),z){let E=$(w[O-_][M-F]).text().replace(/\s|\n/g," "),V=L.replace(/\n/g,"").replace(/\s/g," ");if(E!=V){k=!1;break}}else if(w[O-_][M-F]!=L){k=!1;break}}}let b=Q().fontjson;if(!Je.createHookFunction("rangePasteBefore",f.luckysheet_select_save,y))return;if(y.indexOf("luckysheet_copy_action_table")>-1&&f.luckysheet_copy_save.copyRange!=null&&f.luckysheet_copy_save.copyRange.length>0&&k)f.luckysheet_paste_iscut?(f.luckysheet_paste_iscut=!1,wt.pasteHandlerOfCutPaste(f.luckysheet_copy_save),wt.clearcopy(p)):wt.pasteHandlerOfCopyPaste(f.luckysheet_copy_save);else if(y.indexOf("luckysheet_copy_action_image")>-1)Ie.pasteImgItem();else{let w;try{w=$("#luckysheet-copy-content").html(y)}catch(x){}if(w&&(w.find("table").length!==0||w.children("span[data-sheets-value]").length===1)){if(w.find("table").length===0){let F=w.children("span[data-sheets-value]")[0].outerHTML.replace(/^<span/,"<td").replace(/<\/span>$/,"</td>");w.html("<table><tbody><tr>"+F+"</tr></tbody></table>")}let x=new Array(w.find("table tr").length),C=0,S="th, td";w.find("table tr").eq(0).find(S).each(function(){let F=parseInt($(this).attr("colspan"));isNaN(F)&&(F=1),C+=F});for(let F=0;F<x.length;F++)x[F]=new Array(C);let _=0,T={};w.find("table tr").each(function(){let F=$(this),R=0;F.find(S).each(function(){let I=$(this),P={},O=I.attr("data-sheets-formula"),M=I.text();if(O&&O.startsWith("=")){let se=f.luckysheet_select_save[0],ae=se.row[0]+_,ue=se.column[0]+R,fe=O.replace(/([^a-zA-Z0-9])R(\[?)(-?[0-9]+)\]?C(\[?)(-?[0-9]+)\]?/g,function(K,U,te,ge,ie,$e){return[U,ie?tt(ue+ +$e):`$${tt(+$e-1)}`,te?ae+ +ge+1:`$${ge}`].join("")}).replace(/\bTRUE\b/g,"true").replace(/\bFALSE\b/g,"false"),ce=g.execfunction(fe,ae,ue);P.f=ce[2],P.v=ce[1],P.ct=nt(M)[1],P.ct&&P.ct.fa&&(P.m=mt(P.ct.fa,P.v))}else if(M.trim().length===0)P.v=null,P.m="";else{let se=nt(M);P.v=se[2],P.ct=se[1],P.m=se[0]}let A=I.css("background-color");A=="rgba(0, 0, 0, 0)"&&(A=null),P.bg=A;let z=I.css("font-weight");z==400||z=="normal"?P.bl=0:P.bl=1,I.css("text-decoration").indexOf("underline")!=-1&&(P.un=1),I.css("font-style")=="normal"?P.it=0:P.it=1;let q=I.css("font-family").split(",");for(let se=0;se<q.length;se++){let ae=$.trim(q[se].toLowerCase());if(ae=b[ae],ae==null)P.ff=0;else{P.ff=ae;break}}let G=Math.round(parseInt(I.css("font-size"))*72/96);P.fs=G;let X=I.css("color");P.fc=X;let ee=I.css("text-align");ee=="center"?P.ht=0:ee=="right"?P.ht=2:P.ht=1;let le=I.css("vertical-align");for(le=="middle"?P.vt=0:le=="top"||le=="text-top"?P.vt=1:P.vt=2;R<C&&x[_][R]!=null;)R++;if(R==C)return!0;if(x[_][R]==null){x[_][R]=P;let se=parseInt(I.attr("rowspan")),ae=parseInt(I.attr("colspan"));isNaN(se)&&(se=1),isNaN(ae)&&(ae=1);let ue=f.luckysheet_select_save[0].row[0]+_,fe=f.luckysheet_select_save[0].column[0]+R;for(let ce=0;ce<se;ce++)for(let K=0;K<ae;K++){if(ce==0){let U=I.css("border-top");if(U!=null&&U.length>0&&U.substr(0,3).toLowerCase()!="0px"){let te=I.css("border-top-width"),ge=I.css("border-top-style"),ie=I.css("border-top-color"),$e=be.getQKBorder(te,ge,ie);T[_+ce+"_"+(R+K)]==null&&(T[_+ce+"_"+(R+K)]={}),T[_+ce+"_"+(R+K)].t={style:$e[0],color:$e[1]}}}if(ce==se-1){let U=I.css("border-bottom");if(U!=null&&U.length>0&&U.substr(0,3).toLowerCase()!="0px"){let te=I.css("border-bottom-width"),ge=I.css("border-bottom-style"),ie=I.css("border-bottom-color"),$e=be.getQKBorder(te,ge,ie);T[_+ce+"_"+(R+K)]==null&&(T[_+ce+"_"+(R+K)]={}),T[_+ce+"_"+(R+K)].b={style:$e[0],color:$e[1]}}}if(K==0){let U=I.css("border-left");if(U!=null&&U.length>0&&U.substr(0,3).toLowerCase()!="0px"){let te=I.css("border-left-width"),ge=I.css("border-left-style"),ie=I.css("border-left-color"),$e=be.getQKBorder(te,ge,ie);T[_+ce+"_"+(R+K)]==null&&(T[_+ce+"_"+(R+K)]={}),T[_+ce+"_"+(R+K)].l={style:$e[0],color:$e[1]}}}if(K==ae-1){let U=I.css("border-right");if(U!=null&&U.length>0&&U.substr(0,3).toLowerCase()!="0px"){let te=I.css("border-right-width"),ge=I.css("border-right-style"),ie=I.css("border-right-color"),$e=be.getQKBorder(te,ge,ie);T[_+ce+"_"+(R+K)]==null&&(T[_+ce+"_"+(R+K)]={}),T[_+ce+"_"+(R+K)].r={style:$e[0],color:$e[1]}}}ce==0&&K==0||(x[_+ce][R+K]={mc:{r:ue,c:fe}})}if(se>1||ae>1){let ce={rs:se,cs:ae,r:ue,c:fe};x[_][R].mc=ce}}if(R++,R==C)return!0}),_++}),f.luckysheet_selection_range=[],wt.pasteHandler(x,T)}else if(v.files.length==1&&v.files[0].type.indexOf("image")>-1){Ie.insertImg(v.files[0]);return}else y=v.getData("text/plain"),wt.pasteHandler(y);$("#luckysheet-copy-content").empty()}}else if($(p.target).closest("#luckysheet-rich-text-editor").length>0){p.preventDefault();let v=window.clipboardData;v||(v=p.originalEvent.clipboardData);let y=v.getData("text/plain");document.execCommand("insertText",!1,y)}}}),de.enablePage&&$("#luckysheet-bottom-page-next").click(function(){let p=de.pageInfo.queryExps,v=de.pageInfo.reportId,y=de.pageInfo.fields,k=de.pageInfo.mobile,b=de.pageInfo.frezon,w=de.pageInfo.currentPage,x=de.pageInfo.totalPage,C=de.pageInfo.pageUrl;Je.addDataAjax({queryExps:p,reportId:v,fields:y,mobile:k,frezon:b,pageIndex:w,currentPage:w},f.currentSheetIndex,C,function(){if(de.pageInfo.currentPage++,de.pageInfo.totalPage==de.pageInfo.currentPage){$("#luckysheet-bottom-page-next").hide();let S=_e(o.pageInfoFull,{total:de.total,totalPage:de.pageInfo.totalPage});$("#luckysheet-bottom-page-info").html(S)}else{let S=_e(o.pageInfo,{total:de.total,totalPage:de.pageInfo.totalPage,currentPage:de.pageInfo.currentPage});$("#luckysheet-bottom-page-info").html(S)}})}).mousedown(function(p){p.stopPropagation()}),$("#luckysheet-bottom-bottom-top").click(function(){$("#luckysheet-scrollbar-y").scrollTop(0)}).mousedown(function(p){p.stopPropagation()}),$("#luckysheet-wa-editor,#luckysheet-icon-morebtn-div,.luckysheet-toolbar-button").click(function(p){this.id!="luckysheet-icon-paintformat"&&be.luckysheetPaintModelOn&&be.cancelPaintModel()})}function N0(){let e=Ge(".luckysheet-multipleRange-show");e.length===void 0&&(e=[e]),e.forEach(n=>{let t=n.id.replace("luckysheet-multipleRange-show-","");f.cooperativeEdit.usernameTimeout["user"+t]===null&&(Ge(".username",n).style.display="none")})}var qd=Me(()=>{Nd();xl();Hl();nn();Os();Wr();qr();qi();gr();ol();mr();Ei();Ac();dl();Qt();ki();Nr();Br();So();Zt();Wi();Ca();Ed();dn();Wt();Ml();Hd();ht();Et();Zl();dr();Nt();Ni();xi();Ut();hi();Vd();Yt();Kt();ll();Jt();Fl();Nl();Bi();ka();kt();Ke()});function jd(){let e=Q().drag;$("#luckysheet-copy-json-head").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let a=!1;for(let s=0;s<f.luckysheet_select_save.length;s++){let u=f.luckysheet_select_save[s].row[0],h=f.luckysheet_select_save[s].row[1],d=f.luckysheet_select_save[s].column[0],m=f.luckysheet_select_save[s].column[1];if(a=Dt(f.config,u,h,d,m),a)break}if(a){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length!=0){if(l.length==1){let a={};for(let s=0;s<l[0].length;s++)a[Le(0,s,l)]="";o.push(a)}else for(let a=1;a<l.length;a++){let s={};for(let u=0;u<l[0].length;u++)Le(0,u,l)==null?s[""]=Le(a,u,l):s[Le(0,u,l)]=Le(a,u,l);o.push(s)}wt.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-json-nohead").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let s=!1;for(let u=0;u<f.luckysheet_select_save.length;u++){let h=f.luckysheet_select_save[u].row[0],d=f.luckysheet_select_save[u].row[1],m=f.luckysheet_select_save[u].column[0],p=f.luckysheet_select_save[u].column[1];if(s=Dt(f.config,h,d,m,p),s)break}if(s){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=f.luckysheet_select_save[0].column[0];for(let s=0;s<l.length;s++){let u={};for(let h=0;h<l[0].length;h++)u[tt(h+a)]=Le(s,h,l);o.push(u)}wt.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-array1").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let a=!1;for(let s=0;s<f.luckysheet_select_save.length;s++){let u=f.luckysheet_select_save[s].row[0],h=f.luckysheet_select_save[s].row[1],d=f.luckysheet_select_save[s].column[0],m=f.luckysheet_select_save[s].column[1];if(a=Dt(f.config,u,h,d,m),a)break}if(a){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++)for(let s=0;s<l[0].length;s++)o.push(Le(a,s,l));wt.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-array2").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let a=!1;for(let s=0;s<f.luckysheet_select_save.length;s++){let u=f.luckysheet_select_save[s].row[0],h=f.luckysheet_select_save[s].row[1],d=f.luckysheet_select_save[s].column[0],m=f.luckysheet_select_save[s].column[1];if(a=Dt(f.config,u,h,d,m),a)break}if(a){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++){let s=[];for(let u=0;u<l[0].length;u++)s.push(Le(a,u,l));o.push(s)}wt.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-arraymore-confirm").click(function(t){if(t.target.nodeName==="INPUT")return;if($("body .luckysheet-cols-menu").hide(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let m=!1;for(let p=0;p<f.luckysheet_select_save.length;p++){let v=f.luckysheet_select_save[p].row[0],y=f.luckysheet_select_save[p].row[1],k=f.luckysheet_select_save[p].column[0],b=f.luckysheet_select_save[p].column[1];if(m=Dt(f.config,v,y,k,b),m)break}if(m){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length==0)return;for(let m=0;m<l.length;m++)for(let p=0;p<l[0].length;p++)o.push(l[m][p]);let a=$("#luckysheet-copy-arraymore-row").val(),s=$("#luckysheet-copy-arraymore-col").val();if(a==""&&s==""){wt.copybyformat(t,JSON.stringify(o)),$("body .luckysheet-cols-menu").hide();return}if(a==""?a=1:(a=parseInt(a),a==null&&(a=1)),s==""?s=1:(s=parseInt(s),s==null&&(s=1)),a.toString()=="NaN"||s.toString()=="NaN"){he()?alert(e.inputCorrect):W.info(e.inputCorrect,"");return}if(a<1||s<1){he()?alert(e.notLessOne):W.info(e.notLessOne,"");return}let u=o.length,h=0,d=[];for(let m=0;m<a;m++){let p=[];for(let v=0;v<s;v++)if(p.push(o[h++]),h>=u){wt.copybyformat(t,JSON.stringify(d)),$("body .luckysheet-cols-menu").hide();return}d.push(p)}wt.copybyformat(t,JSON.stringify(d))}),$("#luckysheet-copy-diagonal").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let s=!1;for(let u=0;u<f.luckysheet_select_save.length;u++){let h=f.luckysheet_select_save[u].row[0],d=f.luckysheet_select_save[u].row[1],m=f.luckysheet_select_save[u].column[0],p=f.luckysheet_select_save[u].column[1];if(s=Dt(f.config,h,d,m,p),s)break}if(s){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length;for(let s=0;s<l.length&&!(s>=a);s++)o.push(l[s][s]);wt.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-antidiagonal").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let s=!1;for(let u=0;u<f.luckysheet_select_save.length;u++){let h=f.luckysheet_select_save[u].row[0],d=f.luckysheet_select_save[u].row[1],m=f.luckysheet_select_save[u].column[0],p=f.luckysheet_select_save[u].column[1];if(s=Dt(f.config,h,d,m,p),s)break}if(s){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length;for(let s=0;s<l.length&&!(s>=a);s++)o.push(l[s][a-s-1]);wt.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-diagonaloffset").click(function(t){if(t.target.nodeName==="INPUT")return;if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let u=!1;for(let h=0;h<f.luckysheet_select_save.length;h++){let d=f.luckysheet_select_save[h].row[0],m=f.luckysheet_select_save[h].row[1],p=f.luckysheet_select_save[h].column[0],v=f.luckysheet_select_save[h].column[1];if(u=Dt(f.config,d,m,p,v),u)break}if(u){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length,s=parseInt($("#luckysheet-copy-diagonaloffset-value").val());if(s.toString()=="NaN"){he()?alert(e.inputCorrect):W.info(e.inputCorrect,"");return}if(s<0){he()?alert(e.offsetColumnLessZero):W.info(e.offsetColumnLessZero,"");return}s==null&&(s=1);for(let u=0;u<l.length&&!(u+s>=a);u++)o.push(l[u][u+s]);wt.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-boolvalue").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}if(f.config.merge!=null){let a=!1;for(let s=0;s<f.luckysheet_select_save.length;s++){let u=f.luckysheet_select_save[s].row[0],h=f.luckysheet_select_save[s].row[1],d=f.luckysheet_select_save[s].column[0],m=f.luckysheet_select_save[s].column[1];if(a=Dt(f.config,u,h,d,m),a)break}if(a){he()?alert(e.noPartMerge):W.info(e.noPartMerge,"");return}}let l=Bt(f.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++){let s=[];for(let u=0;u<l[0].length;u++){let h=!1,d;N(l[a][u])=="object"?d=l[a][u].v:d=l[a][u],d==null||d==""?h=!1:(d=parseInt(d),d==null||d>0?h=!0:h=!1),s.push(h)}o.push(s)}wt.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-matrix-turn-up").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=l.length-1;a>=0;a--){let s=[];for(let u=0;u<l[0].length;u++){let h="";l[a]!=null&&l[a][u]!=null&&(h=l[a][u]),s.push(h)}o.push(s)}xe.controlHandler(o)}),$("#luckysheet-matrix-turn-left").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l.length;a++){let s=[];for(let u=l[0].length-1;u>=0;u--){let h="";l[a]!=null&&l[a][u]!=null&&(h=l[a][u]),s.push(h)}o.push(s)}xe.controlHandler(o)}),$("#luckysheet-matrix-turn-cw").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l[0].length;a++){let s=[];for(let u=l.length-1;u>=0;u--){let h="";l[u]!=null&&l[u][a]!=null&&(h=l[u][a]),s.push(h)}o.push(s)}xe.controlHandlerD(o)}),$("#luckysheet-matrix-turn-anticw").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=l[0].length-1;a>=0;a--){let s=[];for(let u=0;u<l.length;u++){let h="";l[u]!=null&&l[u][a]!=null&&(h=l[u][a]),s.push(h)}o.push(s)}xe.controlHandlerD(o)}),$("#luckysheet-matrix-turn-trans").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l[0].length;a++){let s=[];for(let u=0;u<l.length;u++){let h="";l[u]!=null&&l[u][a]!=null&&(h=l[u][a]),s.push(h)}o.push(s)}xe.controlHandlerD(o)});let n=function(t,l){if(t==0)return 0;let o,a;for(o=t,a=(l-1)*o/l+t/(Math.pow(o,l-1)*l);Math.abs(a-o)>1e-6;)o=a,a=(l-1)*o/l+t/(Math.pow(o,l-1)*l);return a};$("#luckysheet-matrix-cal-confirm").click(function(t){if(t.target.nodeName==="INPUT"||t.target.nodeName==="SELECT")return;if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=$("#luckysheet-matrix-cal-type").val(),a=parseInt($("#luckysheet-matrix-cal-value").val());if(a.toString()=="NaN"){he()?alert(e.inputCorrect):W.info(e.inputCorrect,"");return}a==null&&(a=2);let s=[];for(let u=0;u<l.length;u++){let h=[];for(let d=0;d<l[0].length;d++){let m="";l[u]!=null&&l[u][d]!=null&&(m=l[u][d],parseInt(m)!=null&&l[u][d].ct!=null&&l[u][d].ct.t=="n"&&(o=="minus"?m.v=m.v-a:o=="multiply"?m.v=m.v*a:o=="divided"?m.v=Il(m.v/a,4):o=="power"?m.v=Math.pow(m.v,a):o=="root"?a==2?m.v=Il(Math.sqrt(m.v),4):a==3&&Math.cbrt?m.v=Il(Math.cbrt(m.v),4):m.v=Il(n(m.v,a),4):o=="log"?m.v=Il(Math.log(m.v)*1e4/Math.log(Math.abs(a)),4):m.v=m.v+a,m.v==null?m.m="":m.m=m.v.toString())),h.push(m)}s.push(h)}xe.controlHandler(s)}),$("#luckysheet-matrix-delezero-row").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l[0].length;for(let s=0;s<l.length;s++){let u=[],h=!0,d=!0;for(let p=0;p<a;p++){let v="";if(l[s]!=null&&l[s][p]!=null){if(v=l[s][p],(v.v=="0"||v.v==0)&&h)continue;h=!1}u.push(v)}let m=[];if(u.length==a)m=u;else{for(let v=u.length-1;v>=0;v--){let y="";if(u[v]!=null){if(y=u[v],(y.v=="0"||y.v==0)&&d)continue;d=!1}m.unshift(y)}let p=a-m.length;for(let v=0;v<p;v++)m.push("")}o.push(m)}xe.controlHandler(o)}),$("#luckysheet-matrix-delezero-column").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l.length,s=l[0].length;for(let h=0;h<s;h++){let d=[],m=!0,p=!0;for(let y=0;y<a;y++){let k="";if(l[y]!=null&&l[y][h]!=null){if(k=l[y][h],(k.v=="0"||k.v==0)&&m)continue;m=!1}d.push(k)}let v=[];if(d.length==a)v=d;else{for(let k=d.length-1;k>=0;k--){let b="";if(d[k]!=null){if(b=d[k],(b.v=="0"||b.v==0)&&p)continue;p=!1}v.unshift(b)}let y=a-v.length;for(let k=0;k<y;k++)v.push("")}o.push(v)}let u=[];for(let h=0;h<o[0].length;h++){let d=[];for(let m=0;m<o.length;m++){let p="";o[m]!=null&&o[m][h]!=null&&(p=o[m][h]),d.push(p)}u.push(d)}xe.controlHandler(u)}),$("#luckysheet-matrix-delerpt-row").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l[0].length;for(let s=0;s<l.length;s++){let u=[],h={};for(let m=0;m<a;m++){let p=null;l[s]!=null&&l[s][m]!=null&&(p=l[s][m],p.v in h||(h[p.v]=[]),h[p.v].push(p))}for(let m=0;m<a;m++){let p=null;l[s]!=null&&l[s][m]!=null&&(p=l[s][m],h[p.v].length==1&&u.push(p))}let d=a-u.length;for(let m=0;m<d;m++)u.push(null);o.push(u)}xe.controlHandler(o)}),$("#luckysheet-matrix-delerpt-column").click(function(t){if($("body .luckysheet-cols-menu").hide(),rt(),f.luckysheet_select_save.length>1){he()?alert(e.noMulti):W.info(e.noMulti,"");return}let l=Bt(f.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l.length,s=l[0].length;for(let h=0;h<s;h++){let d=[],m={};for(let v=0;v<a;v++){let y=null;l[v]!=null&&l[v][h]!=null&&(y=l[v][h],y.v in m||(m[y.v]=[]),m[y.v].push(y))}for(let v=0;v<a;v++){let y=null;l[v]!=null&&l[v][h]!=null&&(y=l[v][h],m[y.v].length==1&&d.push(y))}a1=d;let p=a-a1.length;for(let v=0;v<p;v++)a1.push(null);o.push(a1)}let u=[];for(let h=0;h<o[0].length;h++){let d=[];for(let m=0;m<o.length;m++){let p=null;o[m]!=null&&o[m][h]!=null&&(p=o[m][h]),d.push(p)}u.push(d)}xe.controlHandler(u)})}var Wd=Me(()=>{Wi();ht();Nt();Kt();ll();Jt();kt();Ke()});function Yd(){if(!Bc){Bc=!0;let t=Q(),l=t.toolbar;$("#luckysheetsheetconfigcolorur").spectrum({showPalette:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!1,showSelectionPalette:!0,maxPaletteSize:10,cancelText:t.sheetconfig.cancelText,chooseText:t.sheetconfig.chooseText,togglePaletteMoreText:l.toolMore,togglePaletteLessText:l.toolLess,clearText:l.clearText,noColorSelectedText:l.noColorSelectedText,palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)"],["rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)"],["rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)"],["rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)"],["rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"],["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"]],change:function(o){let a=$(this);o!=null?o=o.toHexString():o="rgb(0, 0, 0)";let s=null;gl.find(".luckysheet-sheets-item-color").length>0&&(s=gl.find(".luckysheet-sheets-item-color").css("background-color")),gl.find(".luckysheet-sheets-item-color").remove(),gl.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+o+';"></div>');let u=Z(f.currentSheetIndex);if(f.luckysheetfile[u].color=o,ne.saveParam("all",f.currentSheetIndex,o,{k:"color"}),f.clearjfundo){let h={};h.type="sheetColor",h.sheetIndex=f.currentSheetIndex,h.oldcolor=s,h.color=o,f.jfundo.length=0,f.jfredo.push(h)}}}),$("#luckysheetsheetconfigcolorreset").click(function(){let o=null;gl.find(".luckysheet-sheets-item-color").length>0&&(o=gl.find(".luckysheet-sheets-item-color").css("background-color")),gl.find(".luckysheet-sheets-item-color").remove();let a=Z(f.currentSheetIndex);if(f.luckysheetfile[a].color=null,ne.saveParam("all",f.currentSheetIndex,null,{k:"color"}),f.clearjfundo){let s={};s.type="sheetColor",s.sheetIndex=f.currentSheetIndex,s.oldcolor=o,s.color=null,f.jfundo.length=0,f.jfredo.push(s)}})}let e=Z(f.currentSheetIndex);f.luckysheetfile[e].color!=null&&f.luckysheetfile[e].color.length>0&&$("#luckysheetsheetconfigcolorur").spectrum("set",f.luckysheetfile[e].color),$("#luckysheetsheetconfigcolorur").parent().find("span, div, button, input, a").addClass("luckysheet-mousedown-cancel");let n=de.sheetRightClickConfig;Object.values(n).every(t=>!t)||setTimeout(function(){ml($("#luckysheet-rightclick-sheet-menu"),gl.offset().left+gl.width(),gl.offset().top-18,"leftbottom")},1)}function Kd(){let n=Q().sheetconfig;Bc=!1,$("#luckysheet-sheet-area").on("mousedown","div.luckysheet-sheets-item",function(d){if(he())return;let m=$(this),p=$(d.target),v=p.closest(".luckysheet-sheets-item");d.which=="3"&&setTimeout(()=>{Xd(m,p,d),gl=v,Yd()},0),v.hasClass("luckysheet-sheets-item-active")&&v.find(".luckysheet-sheets-item-name").attr("contenteditable")=="false"&&(Ud=setTimeout(function(){f.luckysheet_sheet_move_status=!0,f.luckysheet_sheet_move_data={},f.luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(b){b==0?f.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):f.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+f.luckysheet_sheet_move_data.widthlist[b-1])}),f.luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item").index(v);let y=d.pageX;f.luckysheet_sheet_move_data.curleft=y-v.offset().left,f.luckysheet_sheet_move_data.pageX=y,f.luckysheet_sheet_move_data.activeobject=v,f.luckysheet_sheet_move_data.cursorobject=p;let k=v.clone().css("visibility","hidden").attr("id","luckysheet-sheets-item-clone");v.after(k),v.css({position:"absolute",opacity:.8,cursor:"move",transition:"initial","z-index":10})},200))}).on("click","div.luckysheet-sheets-item",function(d){if(he())return;let m=$(this),p=$(d.target);Xd(m,p,d),ne.keepHighLightBox()});let t=function(d){f.allowEdit!==!1&&(d.attr("contenteditable","true").addClass("luckysheet-mousedown-cancel").data("oldtxt",d.text()),setTimeout(function(){sh(d.get(0))},1))};$("#luckysheet-sheet-area").on("dblclick","span.luckysheet-sheets-item-name",function(d){t($(this))});let l=!0;$("#luckysheet-sheet-area").on("compositionstart","span.luckysheet-sheets-item-name",()=>l=!1),$("#luckysheet-sheet-area").on("compositionend","span.luckysheet-sheets-item-name",()=>l=!0),$("#luckysheet-sheet-area").on("input","span.luckysheet-sheets-item-name",function(){if(f.allowEdit===!1||f.limitSheetNameLength===!1)return;let d=f.defaultSheetNameMaxLength;d!==0&&setTimeout(()=>{l&&$(this).text().length>=d&&setTimeout(()=>{$(this).text($(this).text().substring(0,d));let m=window.getSelection();m.selectAllChildren(this),m.collapseToEnd()},0)},0)}),$("#luckysheet-sheet-area").on("blur","span.luckysheet-sheets-item-name",function(d){if(f.allowEdit===!1)return;let m=$(this),p=m.text(),v=m.data("oldtxt");if($(this).text().length===0){W.info("",n.sheetNamecannotIsEmptyError),m.text(v).attr("contenteditable","false");return}if(p.length>31||p.charAt(0)=="'"||p.charAt(p.length-1)=="'"||/[\:\\\/\?\*\[\]]+/.test(p)){W.info("",n.sheetNameSpecCharError),m.text(v).attr("contenteditable","false");return}let y=Z(f.currentSheetIndex);for(let k=0;k<f.luckysheetfile.length;k++)if(y!=k&&f.luckysheetfile[k].name==p){he()?alert(n.tipNameRepeat):W.info("",n.tipNameRepeat),m.text(v).attr("contenteditable","false");return}if(ye.sheetArrowShowAndHide(),f.luckysheetfile[y].name=p,ne.saveParam("all",f.currentSheetIndex,p,{k:"name"}),m.attr("contenteditable","false").removeClass("luckysheet-mousedown-cancel"),f.clearjfundo){let k={};k.type="sheetName",k.sheetIndex=f.currentSheetIndex,k.oldtxt=v,k.txt=p,f.jfundo.length=0,f.jfredo.push(k)}Je.createHookFunction("sheetEditNameAfter",{i:f.luckysheetfile[y].index,oldName:v,newName:p})}),$("#luckysheet-sheet-area").on("keydown","span.luckysheet-sheets-item-name",function(d){if(f.allowEdit===!1)return;let m=d.keyCode,p=$(this);if(m==it.ENTER){let v=Z(f.currentSheetIndex);Gd=f.luckysheetfile[v].name||Gd,f.luckysheetfile[v].name=p.text(),p.attr("contenteditable","false")}}),$("#luckysheetsheetconfigrename").click(function(){var d=gl.find("span.luckysheet-sheets-item-name");!Je.createHookFunction("sheetEditNameBefore",{i:gl.data("index"),name:d.text()})||(t(gl.find("span.luckysheet-sheets-item-name")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide())}),$("#luckysheetsheetconfigshow").click(function(){$("#luckysheet-sheets-m").click(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveleft").click(function(){gl.prevAll(":visible").length>0&&(gl.insertBefore(gl.prevAll(":visible").eq(0)),ye.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveright").click(function(){gl.nextAll(":visible").length>0&&(gl.insertAfter(gl.nextAll(":visible").eq(0)),ye.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigdelete").click(function(d){if($("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-sheet-container-c .luckysheet-sheets-item:visible").length<=1){he()?alert(n.noMoreSheet):W.info(n.noMoreSheet,"");return}let m=Z(f.currentSheetIndex);W.confirm(n.confirmDelete+"\u3010"+f.luckysheetfile[m].name+"\u3011\uFF1F","<span style='color:#9e9e9e;font-size:12px;'>"+n.redoDelete+"</span>",function(){ye.deleteSheet(gl.data("index"))},null),$("#luckysheet-input-box").removeAttr("style")}),$("#luckysheetsheetconfigcopy").click(function(d){ye.copySheet(gl.data("index"),d),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfighide").click(function(){if($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").length==1){he()?alert(n.noHide):W.info("",n.noHide);return}ye.setSheetHide(gl.data("index")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheet-sheets-add").click(function(d){parseInt($("#luckysheet-input-box").css("top"))>0&&g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),ye.addNewSheet(d),ye.locationSheet(),$("#luckysheet-input-box").removeAttr("style")});let o=null,a=0,s=0,u=150;$("#luckysheet-sheets-leftscroll").click(function(){let d=$("#luckysheet-sheet-container-c");a=d.scrollLeft(),s=d.scrollLeft()-u,s<=0&&$("#luckysheet-sheet-container .docs-sheet-fade-left").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-right").show(),clearInterval(o),o=setInterval(function(){a-=4,d.scrollLeft(a),a<=s&&clearInterval(o)},1)}),$("#luckysheet-sheets-rightscroll").click(function(){let d=$("#luckysheet-sheet-container-c");a=d.scrollLeft(),s=d.scrollLeft()+u,a>0&&$("#luckysheet-sheet-container .docs-sheet-fade-right").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),clearInterval(o),o=setInterval(function(){a+=4,d.scrollLeft(a),a>=s&&clearInterval(o)},1)});let h=!0;$("#luckysheet-sheets-m").click(function(d){parseInt($("#luckysheet-input-box").css("top"))>0&&g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),$("#luckysheet-sheet-list").html("");let m="";for(let k=0;k<f.luckysheetfile.length;k++){let b=f.luckysheetfile[k],w="",x="";b.status==1&&(w='<i class="fa fa-check" aria-hidden="true"></i>'),b.hide==1&&(w='<i class="fa fa-low-vision" aria-hidden="true"></i>',x+="color:#BBBBBB;"),b.color!=null&&b.color.length>0&&(x+="border-right:4px solid "+b.color+";"),m+=_e(au,{index:b.index,name:b.name,icon:w,style:x})}h?($("#"+f.container).append(_e(ou,{item:m})),$("#luckysheet-sheet-list").on("click",".luckysheet-cols-menuitem",function(k){if(he()){alert(n.chartEditNoOpt);return}let b=$(this),w=b.data("index");b.data("index")!=f.currentSheetIndex&&(ye.setSheetShow(w),ye.locationSheet()),ne.keepHighLightBox()}),h=!1):$("#luckysheet-sheet-list").html(m);let p=$("#luckysheet-sheet-list"),v=$(this).offset().left-$("#"+f.container).offset().left,y=$(this).height()+$("#luckysheet-sta-content").height()+12;p.css({left:v+"px",bottom:y+"px"}).show(),$("#luckysheet-input-box").removeAttr("style")}),de.pager&&Ic(de.pager)}var Bc,gl,Ud,Gd,Xd,Zd=Me(()=>{dl();Qt();Wt();ht();Et();Nt();Ut();Vr();ll();dn();kt();Ke();xl();yi();Nl();Bc=!1,gl=null,Ud=null,Gd="";Xd=function(e,n,t){clearTimeout(Ud),!(n.hasClass("luckysheet-sheets-item-name")&&n.attr("contenteditable")=="true")&&(g.rangestart||g.rangedrag_column_start||g.rangedrag_row_start||g.israngeseleciton()?setTimeout(function(){g.setCaretPosition(g.rangeSetValueTo.get(0),0,g.rangeSetValueTo.text().length),g.createRangeHightlight(),$("#luckysheet-input-box-index").find(".luckysheet-input-box-index-sheettxt").remove().end().prepend("<span class='luckysheet-input-box-index-sheettxt'>"+ye.getSheetName(g.rangetosheet)+"!</span>").show(),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")})},1):(parseInt($("#luckysheet-input-box").css("top"))>0&&g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove()),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),e.addClass("luckysheet-sheets-item-active"),rl(t),ye.changeSheet(e.data("index")),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),(n.hasClass("luckysheet-sheets-item-menu")||n.hasClass("fa-sort-desc")||t.which=="3")&&(gl=n.closest(".luckysheet-sheets-item"),Yd()))}});function Jd(){let n=Q().formula;$("#luckysheet-functionbox-cell").focus(function(){if(!he()&&f.luckysheet_select_save.length>0){let t=f.luckysheet_select_save[f.luckysheet_select_save.length-1],l=t.row_focus,o=t.column_focus;Rl(l,o,f.flowdata,null,!0),g.rangeResizeTo=$("#luckysheet-functionbox-cell")}}).keydown(function(t){if(he())return;let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode,u=$("#luckysheet-input-box");if(s==it.ENTER&&parseInt(u.css("top"))>0)$("#luckysheet-formula-search-c").is(":visible")&&g.searchFunctionCell!=null?g.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),f.luckysheet_select_save=[{row:[f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[0]],column:[f.luckysheetCellUpdate[1],f.luckysheetCellUpdate[1]],row_focus:f.luckysheetCellUpdate[0],column_focus:f.luckysheetCellUpdate[1]}],jt("down",1,"rangeOfSelect"),$("#luckysheet-rich-text-editor").focus()),t.preventDefault();else if(s==it.ESC&&parseInt(u.css("top"))>0)g.dontupdate(),jt("down",0,"rangeOfSelect"),$("#luckysheet-rich-text-editor").focus(),t.preventDefault();else if(s==it.F4&&parseInt(u.css("top"))>0)g.setfreezonFuc(t),t.preventDefault();else if(s==it.UP&&parseInt(u.css("top"))>0){if($("#luckysheet-formula-search-c").is(":visible")){let h=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev();h.length==0&&(h=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),h.addClass("luckysheet-formula-search-item-active"),t.preventDefault()}}else if(s==it.DOWN&&parseInt(u.css("top"))>0){if($("#luckysheet-formula-search-c").is(":visible")){let h=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next();h.length==0&&(h=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),h.addClass("luckysheet-formula-search-item-active"),t.preventDefault()}}else s==it.LEFT&&parseInt(u.css("top"))>0?g.rangeHightlightselected($("#luckysheet-functionbox-cell")):s==it.RIGHT&&parseInt(u.css("top"))>0?g.rangeHightlightselected($("#luckysheet-functionbox-cell")):(!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40))||s==8||s==32||s==46||t.ctrlKey&&s==86)&&g.functionInputHanddler($("#luckysheet-rich-text-editor"),$("#luckysheet-functionbox-cell"),s)}).click(function(){he()||g.rangeHightlightselected($("#luckysheet-functionbox-cell"))}),$("#luckysheet-wa-functionbox-cancel").click(function(){!$(this).hasClass("luckysheet-wa-calculate-active")||($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),g.dontupdate(),jt("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-confirm").click(function(){!$(this).hasClass("luckysheet-wa-calculate-active")||($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-fx").click(function(){if(f.luckysheet_select_save.length==0){he()?alert(n.tipSelectCell):W.info(n.tipSelectCell,"");return}let t=f.luckysheet_select_save[f.luckysheet_select_save.length-1],l=t.row_focus,o=t.column_focus;Rl(l,o,f.flowdata);let a=f.flowdata[l][o];if(a!=null&&a.f!=null){let s=g.getfunctionParam(a.f);s.fn!=null?cn.formulaParmDialog(s.fn,s.param):cn.formulaListDialog()}else $("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),cn.formulaListDialog();cn.init()}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-copy",function(t){g.rangeMove=!0,f.luckysheet_scroll_status=!0,g.rangeMoveObj=$(this).parent(),g.rangeMoveIndex=$(this).parent().attr("rangeindex");let l=ut(t.pageX,t.pageY),o=l[0]+$("#luckysheet-cell-main").scrollLeft(),a=l[1]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-formula-functionrange-highlight-"+g.rangeMoveIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13);let s=$(this).data("type");s=="top"?a+=3:s=="right"?o-=3:s=="bottom"?a-=3:s=="left"&&(o+=3);let u=$t(a)[2],h=_t(o)[2];g.rangeMovexy=[u,h],$("#luckysheet-sheettable").css("cursor","move"),t.stopPropagation()}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-highlight",function(t){g.rangeResize=$(this).data("type"),g.rangeResizeIndex=$(this).parent().attr("rangeindex");let l=ut(t.pageX,t.pageY),o=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),s=l[0]+o,u=l[1]+a;g.rangeResizeObj=$(this).parent(),$("#luckysheet-formula-functionrange-highlight-"+g.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13),g.rangeResize=="lt"?(s+=3,u+=3):g.rangeResize=="lb"?(s+=3,u-=3):g.rangeResize=="rt"?(s-=3,u+=3):g.rangeResize=="rb"&&(s-=3,u-=3);let h=$t(u),d=h[1],m=h[0],p=h[2],v=_t(s),y=v[1],k=v[0],b=v[2],w=g.rangeResizeObj.position();g.rangeResizexy=[k,m,g.rangeResizeObj.width(),g.rangeResizeObj.height(),w.left+o,w.top+a,y,d],g.rangeResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,g.rangeResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,f.luckysheet_scroll_status=!0,t.stopPropagation()})}var Qd=Me(()=>{ol();ki();Wt();So();zc();Zl();Nt();Ut();ll();kt();Ke()});function em(){$("#luckysheet-rows-h").mousedown(function(e){if(!Fo(f.currentSheetIndex))return;He.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Ie.cancelActiveImgItem();let t=ut(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=$t(t),o=l[1],a=l[0],s=l[2],u=f.visibledatacolumn.length-1,h=f.visibledatacolumn[u],d=0;if($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),e.which=="3"){let k=!1;for(let b=0;b<f.luckysheet_select_save.length;b++){let w=f.luckysheet_select_save[b];if(w.row!=null&&s>=w.row[0]&&s<=w.row[1]&&w.column[0]==0&&w.column[1]==f.flowdata[0].length-1){k=!0;break}}if(k)return}let m=a,p=o-a-1,v=[s,s];f.luckysheet_scroll_status=!0;let y=$("#luckysheet-input-box");if(parseInt(y.css("top"))>0)if(g.rangestart||g.rangedrag_column_start||g.rangedrag_row_start||g.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let k=be.mergeMoveMain([0,u],v,{row_focus:s,column_focus:0},m,p,d,h);if(k!=null&&(v=k[1],m=k[2],p=k[3]),e.shiftKey){let b=g.func_selectedrange,w=0,x=0,C=[];b.top>a?(w=a,x=b.top+b.height-a,b.row[1]>b.row_focus&&(b.row[1]=b.row_focus),C=[s,b.row[1]]):b.top==a?(w=a,x=b.top+b.height-a,C=[s,b.row[0]]):(w=b.top,x=o-b.top-1,b.row[0]<b.row_focus&&(b.row[0]=b.row_focus),C=[b.row[0],s]);let S=be.mergeMoveMain([0,u],C,{row_focus:s,column_focus:0},w,x,d,h);S!=null&&(C=S[1],w=S[2],x=S[3]),b.row=C,b.top_move=w,b.height_move=x,g.func_selectedrange=b}else if(e.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let b=$("#luckysheet-rich-text-editor").text()+",";if(b.length>0&&b.substr(0,1)=="="){if(b=g.functionHTMLGenerate(b),window.getSelection){let w=window.getSelection();g.functionRangeIndex=[$(w.anchorNode).parent().index(),w.anchorOffset]}else{let w=document.selection.createRange();g.functionRangeIndex=w}$("#luckysheet-rich-text-editor").html(b),g.canceFunctionrangeSelected(),g.createRangeHightlight()}g.rangestart=!1,g.rangedrag_column_start=!1,g.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(b),g.rangeHightlightselected($("#luckysheet-rich-text-editor")),g.israngeseleciton(),g.func_selectedrange={left:Rt(0)[0],width:Rt(0)[1]-Rt(0)[0]-1,top:m,height:p,left_move:d,width_move:h-d-1,top_move:m,height_move:p,row:v,column:[0,u],row_focus:s,column_focus:0}}else g.func_selectedrange={left:Rt(0)[0],width:Rt(0)[1]-Rt(0)[0]-1,top:m,height:p,left_move:d,width_move:h-d-1,top_move:m,height_move:p,row:v,column:[0,u],row_focus:s,column_focus:0};if(g.rangestart||g.rangedrag_column_start||g.rangedrag_row_start||g.israngeseleciton())g.rangeSetValue({row:v,column:[null,null]});else if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let b=Mt(f.currentSheetIndex,{row:v,column:[0,u]},f.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(b)}g.rangedrag_row_start=!0,g.rangestart=!1,g.rangedrag_column_start=!1,$("#luckysheet-formula-functionrange-select").css({left:d,width:h-d-1,top:m,height:p}).show(),$("#luckysheet-formula-help-c").hide(),or(d,m,h-d-1,p,v,[0,u]),setTimeout(function(){let w=window.getSelection().anchorNode,x;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?(x=$("#luckysheet-rich-text-editor"),g.rangechangeindex=g.data_parm_index):x=$(w).closest("div");let C=x.find("span[rangeindex='"+g.rangechangeindex+"']");g.setCaretPosition(C.get(0),0,C.html().length)},1);return}else g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),f.luckysheet_rows_selected_status=!0;else f.luckysheet_rows_selected_status=!0;if(f.luckysheet_rows_selected_status){if(e.shiftKey){let k=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),b=0,w=0,x=[];k.top>a?(b=a,w=k.top+k.height-a,k.row[1]>k.row_focus&&(k.row[1]=k.row_focus),x=[s,k.row[1]]):k.top==a?(b=a,w=k.top+k.height-a,x=[s,k.row[0]]):(b=k.top,w=o-k.top-1,k.row[0]<k.row_focus&&(k.row[0]=k.row_focus),x=[k.row[0],s]),k.row=x,k.top_move=b,k.height_move=w,f.luckysheet_select_save[f.luckysheet_select_save.length-1]=k}else e.ctrlKey?f.luckysheet_select_save.push({left:Rt(0)[0],width:Rt(0)[1]-Rt(0)[0]-1,top:m,height:p,left_move:d,width_move:h-d-1,top_move:m,height_move:p,row:v,column:[0,u],row_focus:s,column_focus:0,row_select:!0}):(f.luckysheet_select_save.length=0,f.luckysheet_select_save.push({left:Rt(0)[0],width:Rt(0)[1]-Rt(0)[0]-1,top:m,height:p,left_move:d,width_move:h-d-1,top_move:m,height_move:p,row:v,column:[0,u],row_focus:s,column_focus:0,row_select:!0}));lt(),ne.saveParam("mv",f.currentSheetIndex,f.luckysheet_select_save)}Na(),setTimeout(function(){clearTimeout(f.countfuncTimeout),bl()},101)}).mousemove(function(e){if(f.luckysheet_rows_selected_status||f.luckysheet_rows_change_size||f.luckysheet_select_status){$("#luckysheet-rows-h-hover").hide();return}let t=ut(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=$t(t),o=l[1],a=l[0],s=l[2];$("#luckysheet-rows-h-hover").css({top:a,height:o-a-1,display:"block"}),t<o-1&&t>=o-5?$("#luckysheet-rows-change-size").css({top:o-3,opacity:0}):$("#luckysheet-rows-change-size").css("opacity",0)}).mouseleave(function(e){$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-rows-change-size").css("opacity",0)}).mouseup(function(e){if(e.which==3){if(!Al()||he())return;$("#luckysheet-cols-rows-shift").hide(),f.luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Q().rightclick.row),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Q().rightclick.height),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Q().rightclick.top),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Q().rightclick.bottom),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block";let n=de.cellRightClickConfig;if(!n.copy&&!n.copyAs&&!n.paste&&!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat)return;Ge("#luckysheet-top-left-add-selected").style.display=n.insertRow?"block":"none",Ge("#luckysheet-bottom-right-add-selected").style.display=n.insertRow?"block":"none",Ge("#luckysheet-del-selected").style.display=n.deleteRow?"block":"none",Ge("#luckysheet-hide-selected").style.display=n.hideRow?"block":"none",Ge("#luckysheet-show-selected").style.display=n.hideRow?"block":"none",Ge("#luckysheet-column-row-width-selected").style.display=n.rowHeight?"block":"none",!n.copy&&!n.copyAs&&!n.paste&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&(Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat&&(Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),on($("#luckysheet-rightclick-menu"),$(this).offset().left+46,e.pageY),f.luckysheet_cols_menu_status=!0;let t=$.extend(!0,{},f.config);t.rowlen==null&&(t.rowlen={});let l=t.rowlen[f.luckysheet_select_save[0].row[0]]==null?f.defaultrowlen:t.rowlen[f.luckysheet_select_save[0].row[0]],o=!0;for(let a=0;a<f.luckysheet_select_save.length;a++){let s=f.luckysheet_select_save[a],u=s.row[0],h=s.row[1];for(let d=u;d<=h;d++)if((t.rowlen[d]==null?f.defaultrowlen:t.rowlen[d])!=l){o=!1;break}}o?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(l):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),$("#luckysheet-cols-h-c").mousedown(function(e){if(!Fo(f.currentSheetIndex))return;He.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Ie.cancelActiveImgItem();let t=ut(e.pageX,e.pageY)[0]+$(this).scrollLeft(),l=f.visibledatarow.length-1,o=f.visibledatarow[l],a=0,s=_t(t),u=s[1],h=s[0],d=s[2];if(f.orderbyindex=d,$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),e.which=="3"){let k=!1;for(let b=0;b<f.luckysheet_select_save.length;b++){let w=f.luckysheet_select_save[b];if(w.column!=null&&d>=w.column[0]&&d<=w.column[1]&&w.row[0]==0&&w.row[1]==f.flowdata.length-1){k=!0;break}}if(k)return}let m=h,p=u-h-1,v=[d,d];f.luckysheet_scroll_status=!0;let y=$("#luckysheet-input-box");if(parseInt(y.css("top"))>0)if(g.rangestart||g.rangedrag_column_start||g.rangedrag_row_start||g.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let k=be.mergeMoveMain(v,[0,l],{row_focus:0,column_focus:d},a,o,m,p);if(k!=null&&(v=k[0],m=k[4],p=k[5]),e.shiftKey){let b=g.func_selectedrange,w=0,x=0,C=[];b.left>h?(w=h,x=b.left+b.width-h,b.column[1]>b.column_focus&&(b.column[1]=b.column_focus),C=[d,b.column[1]]):b.left==h?(w=h,x=b.left+b.width-h,C=[d,b.column[0]]):(w=b.left,x=u-b.left-1,b.column[0]<b.column_focus&&(b.column[0]=b.column_focus),C=[b.column[0],d]);let S=be.mergeMoveMain(C,[0,l],{row_focus:0,column_focus:d},a,o,w,x);S!=null&&(C=S[0],w=S[4],x=S[5]),b.column=C,b.left_move=w,b.width_move=x,g.func_selectedrange=b}else if(e.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let b=$("#luckysheet-rich-text-editor").text()+",";if(b.length>0&&b.substr(0,1)=="="){if(b=g.functionHTMLGenerate(b),window.getSelection){let w=window.getSelection();g.functionRangeIndex=[$(w.anchorNode).parent().index(),w.anchorOffset]}else{let w=document.selection.createRange();g.functionRangeIndex=w}$("#luckysheet-rich-text-editor").html(b),g.canceFunctionrangeSelected(),g.createRangeHightlight()}g.rangestart=!1,g.rangedrag_column_start=!1,g.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(b),g.rangeHightlightselected($("#luckysheet-rich-text-editor")),g.israngeseleciton(),g.func_selectedrange={left:m,width:p,top:tl(0)[0],height:tl(0)[1]-tl(0)[0]-1,left_move:m,width_move:p,top_move:a,height_move:o-a-1,row:[0,l],column:v,row_focus:0,column_focus:d}}else g.func_selectedrange={left:m,width:p,top:tl(0)[0],height:tl(0)[1]-tl(0)[0]-1,left_move:m,width_move:p,top_move:a,height_move:o-a-1,row:[0,l],column:v,row_focus:0,column_focus:d};if(g.rangestart||g.rangedrag_column_start||g.rangedrag_row_start||g.israngeseleciton())g.rangeSetValue({row:[null,null],column:v});else if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let b=Mt(f.currentSheetIndex,{row:[0,l],column:v},f.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(b)}g.rangedrag_column_start=!0,g.rangestart=!1,g.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:m,width:p,top:a,height:o-a-1}).show(),$("#luckysheet-formula-help-c").hide(),or(m,a,p,o-a-1,[0,l],v);return}else g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),f.luckysheet_cols_selected_status=!0;else f.luckysheet_cols_selected_status=!0;if(f.luckysheet_cols_selected_status){if(e.shiftKey){let k=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),b=0,w=0,x=[];k.left>h?(b=h,w=k.left+k.width-h,k.column[1]>k.column_focus&&(k.column[1]=k.column_focus),x=[d,k.column[1]]):k.left==h?(b=h,w=k.left+k.width-h,x=[d,k.column[0]]):(b=k.left,w=u-k.left-1,k.column[0]<k.column_focus&&(k.column[0]=k.column_focus),x=[k.column[0],d]),k.column=x,k.left_move=b,k.width_move=w,f.luckysheet_select_save[f.luckysheet_select_save.length-1]=k}else e.ctrlKey?f.luckysheet_select_save.push({left:m,width:p,top:tl(0)[0],height:tl(0)[1]-tl(0)[0]-1,left_move:m,width_move:p,top_move:a,height_move:o-a-1,row:[0,l],column:v,row_focus:0,column_focus:d,column_select:!0}):(f.luckysheet_select_save.length=0,f.luckysheet_select_save.push({left:m,width:p,top:tl(0)[0],height:tl(0)[1]-tl(0)[0]-1,left_move:m,width_move:p,top_move:a,height_move:o-a-1,row:[0,l],column:v,row_focus:0,column_focus:d,column_select:!0}));lt(),ne.saveParam("mv",f.currentSheetIndex,f.luckysheet_select_save)}Na(),setTimeout(function(){clearTimeout(f.countfuncTimeout),bl()},101),f.luckysheet_cols_menu_status&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),f.luckysheet_cols_menu_status=!1),e.stopPropagation()}).mousemove(function(e){if(f.luckysheet_cols_selected_status||f.luckysheet_select_status){$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide();return}if(f.luckysheet_cols_menu_status||f.luckysheet_cols_change_size)return;let t=ut(e.pageX,e.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft(),l=_t(t),o=l[1],a=l[0],s=l[2];$("#luckysheet-cols-h-hover").css({left:a,width:o-a-1,display:"block"}),$("#luckysheet-cols-menu-btn").css({left:o-19,display:"block"}),$("#luckysheet-cols-change-size").css({left:o-5}),t<o&&t>=o-5?($("#luckysheet-cols-change-size").css({opacity:0}),$("#luckysheet-cols-menu-btn").hide()):($("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}).mouseleave(function(e){f.luckysheet_cols_menu_status||f.luckysheet_cols_change_size||($("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}).mouseup(function(e){if(e.which==3){if(!Al()||he())return;f.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Q().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Q().rightclick.width),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Q().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Q().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block";let n=de.cellRightClickConfig;if(!n.copy&&!n.copyAs&&!n.paste&&!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat)return;Ge("#luckysheet-top-left-add-selected").style.display=n.insertColumn?"block":"none",Ge("#luckysheet-bottom-right-add-selected").style.display=n.insertColumn?"block":"none",Ge("#luckysheet-del-selected").style.display=n.deleteColumn?"block":"none",Ge("#luckysheet-hide-selected").style.display=n.hideColumn?"block":"none",Ge("#luckysheet-show-selected").style.display=n.hideColumn?"block":"none",Ge("#luckysheet-column-row-width-selected").style.display=n.columnWidth?"block":"none",!n.copy&&!n.copyAs&&!n.paste&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&(Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat&&(Ge("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),on($("#luckysheet-rightclick-menu"),e.pageX,$(this).offset().top+18),f.luckysheet_cols_menu_status=!0;let t=$.extend(!0,{},f.config);t.columnlen==null&&(t.columnlen={});let l=t.columnlen[f.luckysheet_select_save[0].column[0]]==null?f.defaultcollen:t.columnlen[f.luckysheet_select_save[0].column[0]],o=!0;for(let a=0;a<f.luckysheet_select_save.length;a++){let s=f.luckysheet_select_save[a],u=s.column[0],h=s.column[1];for(let d=u;d<=h;d++)if((t.columnlen[d]==null?f.defaultcollen:t.columnlen[d])!=l){o=!1;break}}o?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(l):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),$("#luckysheet-rows-change-size").mousedown(function(e){if(!Al())return;He.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Ie.cancelActiveImgItem(),$("#luckysheet-input-box").hide(),$("#luckysheet-rows-change-size").css({opacity:1});let t=ut(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").width(),a=$t(t),s=a[1],u=a[0],h=a[2];f.luckysheet_rows_change_size=!0,f.luckysheet_scroll_status=!0,$("#luckysheet-change-size-line").css({height:"1px","border-width":"0 0px 1px 0",top:s-3,left:0,width:l+o,display:"block",cursor:"ns-resize"}),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","ns-resize"),f.luckysheet_rows_change_size_start=[u,h],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),e.stopPropagation()}),$("#luckysheet-cols-change-size").mousedown(function(e){if(!Al())return;He.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Ie.cancelActiveImgItem(),$("#luckysheet-input-box").hide(),$("#luckysheet-cols-change-size").css({opacity:1});let n=ut(e.pageX,e.pageY),t=$("#luckysheet-cols-h-c").scrollLeft(),l=$("#luckysheet-cell-main").scrollTop(),o=$("#luckysheet-cell-main").height(),a=n[0]+t,s=f.visibledatarow.length-1,u=f.visibledatarow[s],h=0,d=_t(a),m=d[1],p=d[0],v=d[2];f.luckysheet_cols_change_size=!0,f.luckysheet_scroll_status=!0,$("#luckysheet-change-size-line").css({height:o+l,"border-width":"0 1px 0 0",top:0,left:m-3,width:"1px",display:"block",cursor:"ew-resize"}),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","ew-resize"),f.luckysheet_cols_change_size_start=[p,v],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),f.luckysheet_cols_dbclick_times=0,e.stopPropagation()}).dblclick(function(){E0()}),$("#luckysheet-cols-menu-btn").click(function(e){if(!Al()){W.info("",Q().pivotTable.errorNotAllowEdit);return}let n=$("#luckysheet-rightclick-menu"),t=$(this).offset();$("#luckysheet-cols-rows-shift").show(),f.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Q().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Q().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Q().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").hide(),$("#luckysheet-cols-rows-shift").show(),$("#luckysheet-cols-rows-handleincell").hide(),Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",Ge("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="block";let l=de.cellRightClickConfig;!l.copy&&!l.copyAs&&!l.paste&&!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&!l.sort||(Ge("#luckysheet-top-left-add-selected").style.display=l.insertColumn?"block":"none",Ge("#luckysheet-bottom-right-add-selected").style.display=l.insertColumn?"block":"none",Ge("#luckysheet-del-selected").style.display=l.deleteColumn?"block":"none",Ge("#luckysheet-hide-selected").style.display=l.hideColumn?"block":"none",Ge("#luckysheet-show-selected").style.display=l.hideColumn?"block":"none",Ge("#luckysheet-column-row-width-selected").style.display=l.columnWidth?"block":"none",!l.copy&&!l.copyAs&&!l.paste&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&(Ge("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="none")),!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&(Ge("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),l.sort||(Ge("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="none"),on(n,t.left,t.top+18),f.luckysheet_cols_menu_status=!0)}),$("#luckysheet-top-left-add-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),rt();let n=Q(),t=n.drag,l=n.info;if(f.luckysheet_select_save.length>1){he()?alert(t.noMulti):W.info(t.noMulti,"");return}let o=$(this),a=o.find("input").val();if(!B(a)){he()?alert(l.tipInputNumber):W.info(l.tipInputNumber,"");return}if(a=parseInt(a),a<1||a>100){he()?alert(l.tipInputNumberLimit):W.info(l.tipInputNumberLimit,"");return}let s=f.luckysheet_select_save[0][f.luckysheetRightHeadClickIs][0];!Je.createHookFunction("rowInsertBefore",s,a,"lefttop")||Tr(f.luckysheetRightHeadClickIs,s,a,"lefttop")}),$("#luckysheetColsRowsHandleAdd_row").click(function(e){if($("#luckysheet-rightclick-menu").hide(),rt(),f.allowEdit===!1)return;let n=f.luckysheet_select_save[0].row[0];!Je.createHookFunction("rowInsertBefore",n,1,"lefttop")||Tr("row",n,1,"lefttop")}),$("#luckysheetColsRowsHandleAdd_column").click(function(e){if($("#luckysheet-rightclick-menu").hide(),rt(),f.allowEdit===!1)return;let n=f.luckysheet_select_save[0].column[0];Tr("column",n,1,"lefttop")}),$(".luckysheetColsRowsHandleAdd_custom").click(function(e){$("#luckysheet-rightclick-menu").hide();let n=de.cellRightClickConfig,t=f.luckysheet_select_save[0].row[0],l=f.luckysheet_select_save[0].column[0];if(n.customs[Number(e.currentTarget.dataset.index)])try{n.customs[Number(e.currentTarget.dataset.index)].onClick(e,event,{rowIndex:t,columnIndex:l})}catch(o){console.error("custom click error",o)}}),$("#luckysheet-bottom-right-add-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),rt();let n=Q(),t=n.drag,l=n.info;if(f.luckysheet_select_save.length>1){he()?alert(t.noMulti):W.info(t.noMulti,"");return}let o=$(this),a=o.find("input").val();if(!B(a)){he()?alert(l.tipInputNumber):W.info(l.tipInputNumber,"");return}if(a=parseInt(a),a<1||a>100){he()?alert(l.tipInputNumberLimit):W.info(l.tipInputNumberLimit,"");return}let s=f.luckysheet_select_save[0][f.luckysheetRightHeadClickIs][1];!Je.createHookFunction("rowInsertBefore",s,a,"rightbottom")||Tr(f.luckysheetRightHeadClickIs,s,a,"rightbottom")}),$("#luckysheet-del-selected, #luckysheet-del-selected_t").click(function(e){$("#luckysheet-rightclick-menu").hide(),rt();let n=Q().drag;if(f.luckysheet_select_save.length>1){f.luckysheetRightHeadClickIs=="row"?he()?alert(n.noMulti):W.info(n.noMulti,""):f.luckysheetRightHeadClickIs=="column"&&(he()?alert(n.noMulti):W.info(n.noMulti,""));return}let t=f.luckysheet_select_save[0][f.luckysheetRightHeadClickIs][0],l=f.luckysheet_select_save[0][f.luckysheetRightHeadClickIs][1];!Je.createHookFunction("rowDeleteBefore",t,l)||Bn(f.luckysheetRightHeadClickIs,t,l)}),$("#luckysheet-delRows").click(function(e){$("#luckysheet-rightclick-menu").hide(),rt();let n=Q().drag;if(f.luckysheet_select_save.length>1){f.luckysheetRightHeadClickIs=="row"?he()?alert(n.noMulti):W.info(n.noMulti,""):f.luckysheetRightHeadClickIs=="column"&&(he()?alert(n.noMulti):W.info(n.noMulti,""));return}let t=f.luckysheet_select_save[0].row[0],l=f.luckysheet_select_save[0].row[1];!Je.createHookFunction("rowDeleteBefore",t,l)||Bn("row",t,l)}),$("#luckysheet-delCols").click(function(e){$("#luckysheet-rightclick-menu").hide(),rt();let n=Q().drag;if(f.luckysheet_select_save.length>1){f.luckysheetRightHeadClickIs=="row"?he()?alert(n.noMulti):W.info(n.noMulti,""):f.luckysheetRightHeadClickIs=="column"&&(he()?alert(n.noMulti):W.info(n.noMulti,""));return}let t=f.luckysheet_select_save[0].column[0],l=f.luckysheet_select_save[0].column[1];Bn("column",t,l)}),$("#luckysheet-hide-selected").click(function(e){$("#luckysheet-rightclick-menu").hide(),rt();let n=Q().drag;if(f.luckysheet_select_save.length>1){f.luckysheetRightHeadClickIs=="row"?he()?alert(n.noMulti):W.info(n.noMulti,""):f.luckysheetRightHeadClickIs=="column"&&(he()?alert(n.noMulti):W.info(n.noMulti,""));return}if(f.luckysheetRightHeadClickIs=="row"){if(!Tt(f.currentSheetIndex,"formatRows"))return;let t=$.extend(!0,{},f.config);t.rowhidden==null&&(t.rowhidden={});for(let l=0;l<f.luckysheet_select_save.length;l++){let o=f.luckysheet_select_save[l].row[0],a=f.luckysheet_select_save[l].row[1];for(let s=o;s<=a;s++)t.rowhidden[s]=0}if(f.clearjfundo){let l={};l.type="showHidRows",l.sheetIndex=f.currentSheetIndex,l.config=$.extend(!0,{},f.config),l.curconfig=t,f.jfundo.length=0,f.jfredo.push(l)}f.config=t,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,t.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length)}else if(f.luckysheetRightHeadClickIs=="column"){if(!Tt(f.currentSheetIndex,"formatColumns"))return;let t=$.extend(!0,{},f.config);t.colhidden==null&&(t.colhidden={});for(let l=0;l<f.luckysheet_select_save.length;l++){let o=f.luckysheet_select_save[l].column[0],a=f.luckysheet_select_save[l].column[1];for(let s=o;s<=a;s++)t.colhidden[s]=0}if(f.clearjfundo){let l={};l.type="showHidCols",l.sheetIndex=f.currentSheetIndex,l.config=$.extend(!0,{},f.config),l.curconfig=t,f.jfundo.length=0,f.jfredo.push(l)}f.config=t,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,t.colhidden,{k:"colhidden"}),Ct(f.flowdata.length,f.flowdata[0].length)}}),$("#luckysheet-show-selected").click(function(e){$("#luckysheet-rightclick-menu").hide(),rt();let n=Q().drag;if(f.luckysheet_select_save.length>1){f.luckysheetRightHeadClickIs=="row"?he()?alert(n.noMulti):W.info(n.noMulti,""):f.luckysheetRightHeadClickIs=="column"&&(he()?alert(n.noMulti):W.info(n.noMulti,""));return}if(f.luckysheetRightHeadClickIs=="row"){if(!Tt(f.currentSheetIndex,"formatRows"))return;let t=$.extend(!0,{},f.config);if(t.rowhidden==null)return;for(let l=0;l<f.luckysheet_select_save.length;l++){let o=f.luckysheet_select_save[l].row[0],a=f.luckysheet_select_save[l].row[1];for(let s=o;s<=a;s++)delete t.rowhidden[s]}if(f.clearjfundo){let l={};l.type="showHidRows",l.sheetIndex=f.currentSheetIndex,l.config=$.extend(!0,{},f.config),l.curconfig=t,f.jfundo.length=0,f.jfredo.push(l)}f.config=t,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,t.rowhidden,{k:"rowhidden"}),Ct(f.flowdata.length,f.flowdata[0].length)}else if(f.luckysheetRightHeadClickIs=="column"){if(!Tt(f.currentSheetIndex,"formatColumns"))return;let t=$.extend(!0,{},f.config);if(t.colhidden==null)return;for(let l=0;l<f.luckysheet_select_save.length;l++){let o=f.luckysheet_select_save[l].column[0],a=f.luckysheet_select_save[l].column[1];for(let s=o;s<=a;s++)delete t.colhidden[s]}if(f.clearjfundo){let l={};l.type="showHidCols",l.sheetIndex=f.currentSheetIndex,l.config=$.extend(!0,{},f.config),l.curconfig=t,f.jfundo.length=0,f.jfredo.push(l)}f.config=t,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,ne.saveParam("cg",f.currentSheetIndex,t.colhidden,{k:"colhidden"}),Ct(f.flowdata.length,f.flowdata[0].length)}}),$("#luckysheet-delCellsMoveLeft").click(function(e){$("body .luckysheet-cols-menu").hide(),rt();let n=Q().drag;if(f.luckysheet_select_save.length>1){he()?alert(n.noMulti):W.info(n.noMulti,"");return}let t=f.luckysheet_select_save[0].row[0],l=f.luckysheet_select_save[0].row[1],o=f.luckysheet_select_save[0].column[0],a=f.luckysheet_select_save[0].column[1];fi("moveLeft",t,l,o,a)}),$("#luckysheet-delCellsMoveUp").click(function(e){$("body .luckysheet-cols-menu").hide(),rt();let n=Q().drag;if(f.luckysheet_select_save.length>1){he()?alert(n.noMulti):W.info(n.noMulti,"");return}let t=f.luckysheet_select_save[0].row[0],l=f.luckysheet_select_save[0].row[1],o=f.luckysheet_select_save[0].column[0],a=f.luckysheet_select_save[0].column[1];fi("moveUp",t,l,o,a)}),$("#luckysheet-delete-text").click(function(){if(!!pr(f.luckysheet_select_save,f.currentSheetIndex)&&($("#luckysheet-rightclick-menu").hide(),rt(),f.allowEdit!==!1&&f.luckysheet_select_save.length>0)){let e=xe.deepCopyFlowData(f.flowdata),n=!1;for(let a=0;a<f.luckysheet_select_save.length;a++){let s=f.luckysheet_select_save[a].row[0],u=f.luckysheet_select_save[a].row[1],h=f.luckysheet_select_save[a].column[0],d=f.luckysheet_select_save[a].column[1];if(Dt(f.config,s,u,h,d)){n=!0;break}}if(n){let a=Q().drag;he()?alert(a.noPartMerge):W.info(a.noPartMerge,"");return}let t=f.luckysheetfile[Z(f.currentSheetIndex)],l=t.hyperlink&&$.extend(!0,{},t.hyperlink),o;for(let a=0;a<f.luckysheet_select_save.length;a++){let s=f.luckysheet_select_save[a].row[0],u=f.luckysheet_select_save[a].row[1],h=f.luckysheet_select_save[a].column[0],d=f.luckysheet_select_save[a].column[1];for(let m=s;m<=u;m++)for(let p=h;p<=d;p++)Oe.isPivotRange(m,p)||(N(e[m][p])=="object"?(delete e[m][p].m,delete e[m][p].v,e[m][p].f!=null&&(delete e[m][p].f,g.delFunctionGroup(m,p,f.currentSheetIndex),delete e[m][p].spl),e[m][p].ct!=null&&e[m][p].ct.t=="inlineStr"&&delete e[m][p].ct):e[m][p]=null,(l==null?void 0:l[`${m}_${p}`])&&(delete l[`${m}_${p}`],o=!0))}Ze(e,f.luckysheet_select_save,o&&{hyperlink:l}),$("#luckysheet-rich-text-editor").html("")}}),$("#luckysheet-column-row-width-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),rt();let n=parseInt($(this).closest(".luckysheet-cols-menuitem").find("input[type='number']").val().trim()),t=Q().info;if(isNaN(n)){W.info("\u53EA\u5141\u8BB8\u4F7F\u7528\u6570\u5B57\u6765\u8BBE\u7F6E\u884C\u5217\u7684\u5BBD\u9AD8!","");return}let l=$.extend(!0,{},f.config),o,a=null;if(f.luckysheetRightHeadClickIs=="row"){if(!Tt(f.currentSheetIndex,"formatRows"))return;if(n<0||n>545){he()?alert(t.tipRowHeightLimit):W.info(t.tipRowHeightLimit,"");return}o="resizeR",l.rowlen==null&&(l.rowlen={});for(let s=0;s<f.luckysheet_select_save.length;s++){let u=f.luckysheet_select_save[s].row[0],h=f.luckysheet_select_save[s].row[1];for(let d=u;d<=h;d++)l.rowlen[d]=n,a=Ie.moveChangeSize("row",d,n)}}else if(f.luckysheetRightHeadClickIs=="column"){if(!Tt(f.currentSheetIndex,"formatColumns"))return;if(n<0||n>2038){he()?alert(t.tipColumnWidthLimit):W.info(t.tipColumnWidthLimit,"");return}o="resizeC",l.columnlen==null&&(l.columnlen={});for(let s=0;s<f.luckysheet_select_save.length;s++){let u=f.luckysheet_select_save[s].column[0],h=f.luckysheet_select_save[s].column[1];for(let d=u;d<=h;d++)l.columnlen[d]=n,a=Ie.moveChangeSize("column",d,n)}}f.clearjfundo&&(f.jfundo.length=0,f.jfredo.push({type:"resize",ctrlType:o,sheetIndex:f.currentSheetIndex,config:$.extend(!0,{},f.config),curconfig:$.extend(!0,{},l),images:$.extend(!0,{},Ie.images),curImages:$.extend(!0,{},a)})),f.config=l,f.luckysheetfile[Z(f.currentSheetIndex)].config=f.config,f.luckysheetfile[Z(f.currentSheetIndex)].images=a,ne.saveParam("all",f.currentSheetIndex,a,{k:"images"}),Ie.images=a,Ie.allImagesShow(),f.luckysheetRightHeadClickIs=="row"?(ne.saveParam("cg",f.currentSheetIndex,l.rowlen,{k:"rowlen"}),Ct(f.flowdata.length,null)):f.luckysheetRightHeadClickIs=="column"&&(ne.saveParam("cg",f.currentSheetIndex,l.columnlen,{k:"columnlen"}),Ct(null,f.flowdata[0].length))})}function E0(){f.luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");let e=ut(event.pageX,event.pageY),n=$("#luckysheet-cols-h-c").scrollLeft(),t=e[0]+n,l=_t(t)[2],o=xe.deepCopyFlowData(f.flowdata),a=$("#luckysheetTableContent").get(0).getContext("2d"),s=$.extend(!0,{},f.config);s.columnlen==null&&(s.columnlen={});let u={},h=$("#luckysheet-cell-main").scrollTop(),d=f.luckysheetTableContentHW[1],m=at(f.visibledatarow,h),p=at(f.visibledatarow,h+d);p+=p-m,p>=o.length&&(p=o.length-1);for(let v=0;v<f.luckysheet_select_save.length;v++){let y=f.luckysheet_select_save[v].column[0],k=f.luckysheet_select_save[v].column[1];if(l<y||l>k){if(l in u)continue;let b=f.defaultcollen;for(let w=m;w<=p;w++){let x=o[w][l];if(x==null||me(x.v)&&!_l(x))continue;let C=Rt(l)[1]-Rt(l)[0]-2,S=Cr(x,a,{r:w,c:l,cellWidth:C}),_=0;S!=null&&(_=S.textWidthAll),_+6>b&&(b=_+6)}b!=f.defaultcollen&&(s.columnlen[l]=b,s.customWidth&&delete s.customWidth[l]),u[l]=1}else for(let b=y;b<=k;b++){if(b in u)continue;let w=f.defaultcollen;for(let x=m;x<=p;x++){let C=o[x][b];if(C==null||me(C.v)&&!_l(C))continue;let S=Rt(b)[1]-Rt(b)[0]-2,_=Cr(C,a,{r:x,c:b,cellWidth:S}),T=0;_!=null&&(T=_.textWidthAll),T+6>w&&(w=T+6)}w!=f.defaultcollen&&(s.columnlen[b]=w,s.customWidth&&delete s.customWidth[b]),u[b]=1}}Kl(f.flowdata[0].length,f.flowdata.length,f.flowdata,s,f.luckysheet_select_save,"resizeC","columnlen")}var tm=Me(()=>{nn();Wr();qr();ol();Qt();Nl();Zt();ht();Et();Zl();Nt();Ni();Ut();hi();Yt();Kt();ll();Jt();kt();dr();Nr();mn();Ml();Ke();xl()});function Ha(e,n,t,l){if($("#luckysheet-formula-search-c").is(":visible")&&(e=="up"||e=="down")){let o;e=="down"?(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next(),o.length==0&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first())):e=="up"&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev(),o.length==0&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last())),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),o.addClass("luckysheet-formula-search-item-active"),l.preventDefault()}else if($("#luckysheet-formula-functionrange-select").is(":visible")){if(n&&t)ci(e,"rangeOfFormula");else if(n)si(e,"rangeOfFormula");else if(t){let o=e,a=1;e=="up"&&(o="down",a=-1),e=="left"&&(o="right",a=-1),En(o,a,"rangeOfFormula")}else{let o=e,a=1;e=="up"&&(o="down",a=-1),e=="left"&&(o="right",a=-1),jt(o,a,"rangeOfFormula")}l.preventDefault()}else if(g.israngeseleciton()){let o=$(window.getSelection().anchorNode);if(o.parent().next().text()==null||o.parent().next().text()==""){let a=$("#luckysheet-input-box #luckysheet-input-box-index").text(),s=g.getcellrange(a);s==null&&(s=g.getcellrange($("#luckysheet-input-box-index").text()));let u=s.row[0],h=s.row[1],d=s.column[0],m=s.column[1],p=f.visibledatarow[h],v=u-1==-1?0:f.visibledatarow[u-1],y=f.visibledatacolumn[m],k=d-1==-1?0:f.visibledatacolumn[d-1];if(g.func_selectedrange={left:k,width:y-k-1,top:v,height:p-v-1,left_move:k,width_move:y-k-1,top_move:v,height_move:p-v-1,row:[u,h],column:[d,m],row_focus:u,column_focus:d},g.rangeSetValue({row:[u,h],column:[d,m]}),g.rangestart=!0,g.rangedrag_column_start=!1,g.rangedrag_row_start=!1,n&&t)ci(e,"rangeOfFormula");else if(n)si(e,"rangeOfFormula");else if(t){let b=e,w=1;e=="up"&&(b="down",w=-1),e=="left"&&(b="right",w=-1),En(b,w,"rangeOfFormula")}else{let b=e,w=1;e=="up"&&(b="down",w=-1),e=="left"&&(b="right",w=-1),jt(b,w,"rangeOfFormula")}l.preventDefault()}}else if(!n&&!t){let o=$(window.getSelection().anchorNode),a=window.getSelection().anchorOffset;e=="up"?o.parent().is("span")&&o.parent().next().length==0&&a>0?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("down",-1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("down",-1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a&&(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("down",-1,"rangeOfSelect"),l.preventDefault()):e=="down"?o.parent().is("span")&&o.parent().next().length==0&&a>0?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("down",1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("down",1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a&&(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("down",1,"rangeOfSelect"),l.preventDefault()):e=="left"?o.parent().is("span")&&o.parent().prev().length==0&&a==0?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("right",-1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&a==1?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("right",-1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&a==0?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("right",-1,"rangeOfSelect"),l.preventDefault()):g.rangeHightlightselected($("#luckysheet-rich-text-editor")):e=="right"&&(o.parent().is("span")&&o.parent().next().length==0&&a>0?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("right",1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("right",1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a?(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("right",1,"rangeOfSelect"),l.preventDefault()):g.rangeHightlightselected($("#luckysheet-rich-text-editor")))}}function rm(){let n=Q().drag;$("#luckysheet-input-box").click(function(){g.rangeHightlightselected($("#luckysheet-rich-text-editor"))}).add("#"+f.container).on("keydown",function(t){let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode;if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("sp-input")||parseInt($("#luckysheet-input-box").css("top"))>0&&$(t.target).closest(".luckysheet-input-box").length>0&&s!=it.ENTER&&s!=it.TAB&&s!=it.UP&&s!=it.DOWN&&s!=it.LEFT&&s!=it.RIGHT){let h=$(window.getSelection().anchorNode);if((h.parent().is("#luckysheet-helpbox-cell")||h.is("#luckysheet-helpbox-cell"))&&s==it.ENTER){let d=$("#luckysheet-helpbox-cell").text();if(g.iscelldata(d)){let m=g.getcellrange(d);f.luckysheet_select_save=[{row:m.row,column:m.column,row_focus:m.row[0],column_focus:m.column[0]}],lt(),$("#luckysheet-helpbox-cell").blur();let p=$("#luckysheet-cell-main").scrollLeft(),v=$("#luckysheet-cell-main").scrollTop(),y=$("#luckysheet-cell-main").height(),k=$("#luckysheet-cell-main").width(),b=f.visibledatarow[m.row[1]],w=m.row[0]-1==-1?0:f.visibledatarow[m.row[0]-1],x=f.visibledatacolumn[m.column[1]],C=m.column[0]-1==-1?0:f.visibledatacolumn[m.column[0]-1];x-p-k+20>0?$("#luckysheet-scrollbar-x").scrollLeft(x-k+20):C-p-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(C-20),b-v-y+20>0?$("#luckysheet-scrollbar-y").scrollTop(b-y+20):w-v-20<0&&$("#luckysheet-scrollbar-y").scrollTop(w-20)}}return}if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("formulaInputFocus"))return;let u=$("#luckysheet-input-box");if((o||t.metaKey)&&s==it.ENTER&&parseInt(u.css("top"))>0){let h=f.luckysheet_select_save[f.luckysheet_select_save.length-1],d=h.row_focus,m=h.column_focus;gh(f.flowdata[d][m]),t.preventDefault()}else if(s==it.ENTER&&parseInt(u.css("top"))>0)$("#luckysheet-formula-search-c").is(":visible")&&g.searchFunctionCell!=null?g.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),f.luckysheet_select_save=[{row:[f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[0]],column:[f.luckysheetCellUpdate[1],f.luckysheetCellUpdate[1]],row_focus:f.luckysheetCellUpdate[0],column_focus:f.luckysheetCellUpdate[1]}],jt("down",1,"rangeOfSelect")),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),t.preventDefault();else if(s==it.TAB){if(parseInt(u.css("top"))>0)return;jt("right",1,"rangeOfSelect"),t.preventDefault()}else if(s==it.F2){if(parseInt(u.css("top"))>0)return;let h=f.luckysheet_select_save[f.luckysheet_select_save.length-1],d=h.row_focus,m=h.column_focus;Rl(d,m,f.flowdata),t.preventDefault()}else if(s==it.F4&&parseInt(u.css("top"))>0)g.setfreezonFuc(t),t.preventDefault();else if(s==it.ESC&&parseInt(u.css("top"))>0)g.dontupdate(),jt("down",0,"rangeOfSelect"),t.preventDefault();else if(s==it.ENTER){if($(t.target).hasClass("formulaInputFocus")||$("#luckysheet-conditionformat-dialog").is(":visible"))return;if(String.fromCharCode(s)!=null&&$("#luckysheet-cell-selected").is(":visible")){let h=f.luckysheet_select_save[f.luckysheet_select_save.length-1],d=h.row_focus,m=h.column_focus;Rl(d,m,f.flowdata),t.preventDefault()}}else if(l||t.metaKey){if(a){if(lm||(f.luckysheet_shiftpositon=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),f.luckysheet_shiftkeydown=!0),s==it.UP){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ci("up","rangeOfSelect")}else if(s==it.DOWN){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ci("down","rangeOfSelect")}else if(s==it.LEFT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ci("left","rangeOfSelect")}else if(s==it.RIGHT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ci("right","rangeOfSelect")}else if(s==186||s==222){let h=f.luckysheet_select_save[f.luckysheet_select_save.length-1],d=h.row_focus,m=h.column_focus;Rl(d,m,f.flowdata,!0);let p=La(2);$("#luckysheet-rich-text-editor").html(p),wr($("#luckysheet-rich-text-editor")[0]),g.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}}else if(s==66)$("#luckysheet-icon-bold").click();else if(s==67){if(Ie.currentImgId!=null){Ie.copyImgItem(t);return}if(be.luckysheetPaintModelOn&&be.cancelPaintModel(),f.luckysheet_select_save.length==0)return;if(f.config.merge!=null){let d=!1;for(let m=0;m<f.luckysheet_select_save.length;m++){let p=f.luckysheet_select_save[m].row[0],v=f.luckysheet_select_save[m].row[1],y=f.luckysheet_select_save[m].column[0],k=f.luckysheet_select_save[m].column[1];if(d=Dt(f.config,p,v,y,k),d)break}if(d){he()?alert(n.noMerge):W.info(n.noMerge,"");return}}let h=f.luckysheetfile[Z(f.currentSheetIndex)].luckysheet_conditionformat_save;if(f.luckysheet_select_save.length>1&&h!=null&&h.length>0){let d=!1,m=Se.getComputeMap();e:for(let p=0;p<f.luckysheet_select_save.length&&!d;p++){let v=f.luckysheet_select_save[p].row[0],y=f.luckysheet_select_save[p].row[1],k=f.luckysheet_select_save[p].column[0],b=f.luckysheet_select_save[p].column[1];for(let w=v;w<=y;w++)for(let x=k;x<=b;x++)if(Se.checksCF(w,x,m)!=null){d=!0;continue e}}if(d){he()?alert(n.noMulti):W.info(n.noMulti,"");return}}if(f.luckysheet_select_save.length>1){let d=!0,m=f.luckysheet_select_save[0].row[0],p=f.luckysheet_select_save[0].row[1],v=!0,y=f.luckysheet_select_save[0].column[0],k=f.luckysheet_select_save[0].column[1];for(let b=1;b<f.luckysheet_select_save.length;b++)(f.luckysheet_select_save[b].row[0]!=m||f.luckysheet_select_save[b].row[1]!=p)&&(d=!1),(f.luckysheet_select_save[b].column[0]!=y||f.luckysheet_select_save[b].column[1]!=k)&&(v=!1);if(!d&&!v||Yr()){he()?alert(n.noMulti):W.info(n.noMulti,"");return}}wt.copy(t),f.luckysheet_paste_iscut=!1,Dr(),t.stopPropagation();return}else if(s==70)$n.createDialog(0),$n.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(s==72)$n.createDialog(1),$n.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(s==73)$("#luckysheet-icon-italic").click();else if(s==86){if(he()||f.allowEdit===!1||$(t.target).hasClass("formulaInputFocus"))return;if(f.luckysheet_select_save.length>1){he()?alert(n.noPaste):W.info(n.noPaste,"");return}wt.isPasteAction=!0,Dr(),t.stopPropagation();return}else if(s==88){if(be.luckysheetPaintModelOn&&be.cancelPaintModel(),f.luckysheet_select_save.length==0)return;if(f.config.merge!=null){let h=!1;for(let d=0;d<f.luckysheet_select_save.length;d++){let m=f.luckysheet_select_save[d].row[0],p=f.luckysheet_select_save[d].row[1],v=f.luckysheet_select_save[d].column[0],y=f.luckysheet_select_save[d].column[1];if(h=Dt(f.config,m,p,v,y),h)break}if(h){de.editMode?alert(_locale_drag.noMerge):W.info(_locale_drag.noMerge,"");return}}if(f.luckysheet_select_save.length>1){he()?alert(n.noMulti):W.info(n.noMulti,"");return}wt.copy(t),f.luckysheet_paste_iscut=!0,Dr(),t.stopPropagation();return}else if(s==90){_n.redo(t),Dr(),t.stopPropagation();return}else if(s==89){_n.undo(t),Dr(),t.stopPropagation();return}else if(s==it.UP){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;si("up","rangeOfSelect")}else if(s==it.DOWN){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;si("down","rangeOfSelect")}else if(s==it.LEFT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;si("left","rangeOfSelect")}else if(s==it.RIGHT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;si("right","rangeOfSelect")}else if(s==186){let h=f.luckysheet_select_save[f.luckysheet_select_save.length-1],d=h.row_focus,m=h.column_focus;Rl(d,m,f.flowdata,!0);let p=La(1);$("#luckysheet-rich-text-editor").html(p),wr($("#luckysheet-rich-text-editor")[0]),g.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}else if(s==222){let h=f.luckysheet_select_save[f.luckysheet_select_save.length-1],d=h.row_focus,m=h.column_focus;Rl(d,m,f.flowdata,!0);let p=La(2);$("#luckysheet-rich-text-editor").html(p),wr($("#luckysheet-rich-text-editor")[0]),g.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}else String.fromCharCode(s).toLocaleUpperCase()=="A"&&$("#luckysheet-left-top").click();t.preventDefault();return}else if(a&&(s==it.UP||s==it.DOWN||s==it.LEFT||s==it.RIGHT||o&&(s==53||s==101))){if(parseInt(u.css("top"))>0||$(t.target).hasClass("formulaInputFocus"))return;if(lm||(f.luckysheet_shiftpositon=$.extend(!0,{},f.luckysheet_select_save[f.luckysheet_select_save.length-1]),f.luckysheet_shiftkeydown=!0),s==it.UP){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;En("down",-1,"rangeOfSelect")}else if(s==it.DOWN){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;En("down",1,"rangeOfSelect")}else if(s==it.LEFT){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;En("right",-1,"rangeOfSelect")}else if(s==it.RIGHT){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;En("right",1,"rangeOfSelect")}else o&&(s==53||s==101)&&$("#luckysheet-icon-strikethrough").click();t.preventDefault()}else if(s==it.ESC)be.luckysheetPaintModelOn?be.cancelPaintModel():(rl(t),t.preventDefault()),lt();else if(s==it.DELETE||s==it.BACKSPACE)Ie.currentImgId!=null?Ie.removeImgItem():$("#luckysheet-delete-text").click(),t.preventDefault();else if(s==8&&Ie.currentImgId!=null)Ie.removeImgItem(),t.preventDefault();else if(s==it.UP){if(parseInt(u.css("top"))>0||f.luckysheet_cell_selected_move||f.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;jt("down",-1,"rangeOfSelect"),t.preventDefault()}else if(s==it.DOWN){if(parseInt(u.css("top"))>0||f.luckysheet_cell_selected_move||f.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;jt("down",1,"rangeOfSelect"),t.preventDefault()}else if(s==it.LEFT){if(parseInt(u.css("top"))>0||f.luckysheet_cell_selected_move||f.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;jt("right",-1,"rangeOfSelect"),t.preventDefault()}else if(s==it.RIGHT){if(parseInt(u.css("top"))>0||f.luckysheet_cell_selected_move||f.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;jt("right",1,"rangeOfSelect"),t.preventDefault()}else if((!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40))||s==8||s==32||s==46||s==0||t.ctrlKey&&s==86)&&String.fromCharCode(s)!=null&&$("#luckysheet-cell-selected").is(":visible")&&s!=it.CAPSLOCK&&s!=it.WIN&&s!=18){let h=f.luckysheet_select_save[f.luckysheet_select_save.length-1],d=h.row_focus,m=h.column_focus;Rl(d,m,f.flowdata,!0),s==8&&$("#luckysheet-rich-text-editor").html("<br/>"),g.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}Dr(),t.stopPropagation()}),$("#"+f.container).add("#luckysheet-input-box").keydown(function(t){if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("formulaInputFocus"))return;let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode,u=$("#luckysheet-input-box");s==it.ESC&&parseInt($("#luckysheet-input-box").css("top"))>0?(g.dontupdate(),jt("down",0,"rangeOfSelect"),t.preventDefault()):s==it.ENTER&&parseInt(u.css("top"))>0?$("#luckysheet-formula-search-c").is(":visible")&&g.searchFunctionCell!=null&&(g.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")),t.preventDefault()):s==it.TAB&&parseInt(u.css("top"))>0?($("#luckysheet-formula-search-c").is(":visible")&&g.searchFunctionCell!=null?g.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(g.updatecell(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1]),jt("right",1,"rangeOfSelect")),t.preventDefault()):s==it.F4&&parseInt(u.css("top"))>0?(g.setfreezonFuc(t),t.preventDefault()):s==it.UP&&parseInt(u.css("top"))>0?Ha("up",l,a,t):s==it.DOWN&&parseInt(u.css("top"))>0?Ha("down",l,a,t):s==it.LEFT&&parseInt(u.css("top"))>0?Ha("left",l,a,t):s==it.RIGHT&&parseInt(u.css("top"))>0?Ha("right",l,a,t):(!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40||s==it.WIN||s==it.WIN_R||s==it.MENU))||s==8||s==32||s==46||t.ctrlKey&&s==86)&&(g.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s),wd(f.luckysheetCellUpdate[0],f.luckysheetCellUpdate[1],f.flowdata))}).keyup(function(t){let l=t.keyCode;!t.shiftKey&&l==16&&(f.luckysheet_shiftkeydown=!1,f.luckysheet_shiftpositon=null),parseInt($("#luckysheet-input-box").css("top"))>0&&(l==13||l==16||l==32),t.preventDefault()}),$("#luckysheet_info_detail_input").val(ne.title).css("width",vi(ne.title)*10).keydown(function(){let t=event.ctrlKey,l=event.altKey,o=event.shiftKey,a=event.keyCode,s=$(this);a==it.ENTER&&s.blur().change()}).bind("input propertychange",function(){let t=$(this),l=vi(t.val())*10,o=$("#luckysheet_info_detail_update").outerWidth(),a=$("#luckysheet_info_detail_save").outerWidth(),s=$("#luckysheet_info_detail_user").parent().outerWidth()+60,u=$("#"+f.container).outerWidth(),h=100,d=u-a-o-s-h;l>d?$("#luckysheet_info_detail_input").css("width",d):$("#luckysheet_info_detail_input").css("width",l)}).change(function(){ne.saveParam("na",null,$(this).val())}),$("#"+f.container).add("input.luckysheet-mousedown-cancel").keydown(function(t){let l=t.target.closest(".luckysheet-cols-menuitem");typeof l!="undefined"&&l!=null&&t.keyCode===13&&$(l).trigger("click")})}var lm,nm=Me(()=>{xl();ol();mr();Qt();ki();Wt();So();Zt();Wi();Mc();Ca();qr();ht();Et();Nt();dn();Ut();Vr();ll();kt();mn();Ke();lm=!1});function im(){let e=Q();$("#luckysheetorderbyasc, #luckysheetorderbyasc_t").mousedown(function(t){rl(t),Xs(f.orderbyindex,!0),lt()}),$("#luckysheetorderbydesc, #luckysheetorderbydesc_t").click(function(t){rl(t),Xs(f.orderbyindex,!1),lt()});let n=!0;$("#luckysheetorderby").click(function(){if(!Tt(f.currentSheetIndex,"sort"))return;$("body .luckysheet-cols-menu").hide();let t=e.sort;if(f.luckysheet_select_save.length>1){he()?alert(t.noRangeError):W.info(t.noRangeError,"");return}let l=f.luckysheet_select_save[0],o=l.row[0],a=l.row[1],s=l.column[0],u=l.column[1];if(n){n=!1;let w=`<div style="overflow: hidden;" class="luckysheet-sort-modal"><div><label><input type="checkbox" id="luckysheet-sort-haveheader"/><span>${t.hasTitle}</span></label></div><div style="overflow-y:auto;" id="luckysheet-sort-dialog-tablec"><table data-itemcount="0" cellspacing="0"> <tr><td>${t.hasTitle} <select name="sort_0"> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> </select> </td> <td> <div><label><input value="asc" type="radio" checked="checked" name="sort_0"><span>${t.asc}A-Z</span></label></div> <div><label><input value="desc" type="radio" name="sort_0"><span>${t.desc}Z-A</span></label></div></td></tr></table></div><div style="background: #e5e5e5;border-top: 1px solid #f5f5f5; height: 1px; width: 100%;margin:2px 0px;margin-bottom:10px;"></div> <div> <span style="font-weight: bold; text-decoration: underline;text-align:center;color: blue;cursor: pointer;" class="luckysheet-sort-dialog-additem">+ ${t.addOthers}</span> </div> </div>`;$("body").append(_e(dt,{id:"luckysheet-sort-dialog",addclass:"",title:e.sort.sortTitle,content:w,botton:`<button id="luckysheet-sort-modal-confirm" class="btn btn-primary">${t.confirm}</button><button class="btn btn-default luckysheet-model-close-btn">${t.close}</button>`})),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-additem").click(function(){let x=f.luckysheet_select_save[0],C=x.row[0],S=x.row[1],_=x.column[0],T=x.column[1],F="",R=$("#luckysheet-sort-dialog table").data("itemcount")+1,I=$("#luckysheet-sort-haveheader").is(":checked");for(let P=_;P<=T;P++)if(I){let O=Le(C,P,f.flowdata,"m");O==null&&(O=t.columnOperation+(P-_+1)),F+='<option value="'+P+'">'+O+"</option>"}else F+='<option value="'+P+'">'+tt(P)+"</option>";$("#luckysheet-sort-dialog table").append(`
                    <tr class="luckysheet-sort-dialog-tr">
                        <td><span class="luckysheet-sort-item-close" onclick="$(this).parent().parent().remove();"><i class="fa fa-times"
                                    aria-hidden="true"></i></span>${t.secondaryTitle} <select
                                name="sort_${R}">${F}</select> </td>
                        <td>
                            <div><label><input value="asc" type="radio" checked="checked"
                                        name="sort_${R}"><span>${t.asc}A-Z</span></label></div>
                            <div><label><input value="desc" type="radio" name="sort_${R}"><span>${t.desc}Z-A</span></label>
                            </div>
                        </td>
                    </tr>
                `),$("#luckysheet-sort-dialog table").data("itemcount",R)}),$("#luckysheet-sort-haveheader").change(function(){let x=f.luckysheet_select_save[0],C=x.row[0],S=x.row[1],_=x.column[0],T=x.column[1],F=$(this).is(":checked"),R="";for(let I=_;I<=T;I++)if(F){let P=Le(C,I,f.flowdata,"m");P==null&&(P=t.columnOperation+(I-_+1)),R+='<option value="'+I+'">'+P+"</option>"}else R+='<option value="'+I+'">'+tt(I)+"</option>";$("#luckysheet-sort-dialog tr select").each(function(){$(this).html(R)})}),$("#luckysheet-sort-modal-confirm").click(function(){if(f.luckysheet_select_save.length>1){he()?alert(t.noRangeError):W.info(t.noRangeError,"");return}let x=xe.deepCopyFlowData(f.flowdata),C=f.luckysheet_select_save[0],S=C.row[0],_=C.row[1],T=C.column[0],F=C.column[1],R=$("#luckysheet-sort-haveheader").is(":checked"),I;R?I=S+1:I=S;let P=!1,O=[];for(let A=I;A<=_;A++){let z=[];for(let L=T;L<=F;L++){if(x[A][L]!=null&&x[A][L].mc!=null){P=!0;break}z.push(x[A][L])}O.push(z)}if(P){he()?alert(t.mergeError):W.info(t.mergeError,"");return}$($("#luckysheet-sort-dialog table tr").toArray().reverse()).each(function(){let A=$(this).find("select").val(),z=$(this).find("input:radio:checked").val();A-=T,z=="asc"?z=!0:z=!1,O=Hr([].concat(O),A,z)});for(let A=I;A<=_;A++)for(let z=T;z<=F;z++)x[A][z]=O[A-I][z-T];let M={};if(f.config.rowlen!=null){let A=$.extend(!0,{},f.config);A=pl(x,I,_,A),M={cfg:A,RowlChange:!0}}Ze(x,[{row:[I,_],column:[T,F]}],M),$("#luckysheet-sort-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()})}let h="";for(let w=s;w<=u;w++)h+='<option value="'+w+'">'+tt(w)+"</option>";$("#luckysheet-sort-dialog select").html(h),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-tr").remove(),$("#luckysheet-sort-haveheader").prop("checked",!1),$("#luckysheet-sort-dialog input:radio:first").prop("checked","checked"),$("#luckysheet-sort-dialog .luckysheet-modal-dialog-title-text").html(t.sortRangeTitle+"<span>"+tt(s)+(o+1)+"</span>"+t.sortRangeTitleTo+"<span>"+tt(u)+(a+1)+"</span>");let d=$("#luckysheet-sort-dialog"),m=d.outerHeight(),p=d.outerWidth(),v=$(window).width(),y=$(window).height(),k=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-sort-dialog-tablec").css("max-height",(y-m)/2),$("#luckysheet-sort-dialog").css({left:(v+k-p)/2,top:(y+b-m)/2}).show(),$("#luckysheet-modal-dialog-mask").show(),o<a&&setTimeout(function(){let w=f.flowdata[o],x=f.flowdata[o+1],C=!1;for(let S=s;S<=u;S++){let _=tr(w[S]),T=tr(x[S]);_!=T&&(C=!0)}C&&$("#luckysheet-sort-haveheader").prop("checked",!0).change()},10)})}var om=Me(()=>{Wt();Zt();Ml();ht();dr();Nt();Vr();Yt();Kt();ui();ll();Jt();Lr();Ke();kt()});var j,qo,L0,am,sm=Me(()=>{xl();xa();oc();Et();ol();ec();Ut();No();Jt();Lr();Nt();Yt();Fl();ui();Kt();ht();Ke();j=El(pn()),qo=El(ai()),L0={SUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else if(B(l))t.push(l);else if(N(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else return g.error.v}var o=0;if(t.length>0)for(var e=0;e<t.length;e++){if(H(t[e]))return t[e];!B(t[e])||(o=xt(o,"+",t[e]))}return o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},AVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array")if(N(l[0])=="array"){if(!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else t=t.concat(l);else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=0,a=0,e=0;e<t.length;e++){if(H(t[e]))return t[e];if(!B(t[e]))return g.error.v;o=xt(o,"+",t[e]),a++}return a==0?g.error.d:xt(o,"/",a)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},COUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array")if(N(l[0])=="array"){if(!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else t=t.concat(l);else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"text",!0)):N(l)=="boolean"?l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0):t.push(l)}for(var o=0,e=0;e<t.length;e++)B(t[e])&&o++;return o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},COUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array")if(N(l[0])=="array"){if(!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l))}else t=t.concat(l);else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"text",!0)):t.push(l)}return t.length}catch(o){return o=g.errorInfo(o),[g.error.v,o]}},MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array")if(N(l[0])=="array"){if(!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else t=t.concat(l);else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=null,e=0;e<t.length;e++){if(H(t[e]))return t[e];!B(t[e])||(o==null||parseFloat(t[e])>o)&&(o=parseFloat(t[e]))}return o==null?0:o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array")if(N(l[0])=="array"){if(!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else t=t.concat(l);else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=null,e=0;e<t.length;e++){if(H(t[e]))return t[e];!B(t[e])||(o==null||parseFloat(t[e])<o)&&(o=parseFloat(t[e]))}return o==null?0:o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},AGE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return g.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(H(l))return l;l=(0,j.default)(l);var o=(0,j.default)();if(arguments.length==2){if(o=D.getFirstValue(arguments[1]),H(o))return o;o=(0,j.default)(o)}var a=o.diff(l,"years");return a<0||a.toString()=="NaN"?g.error.v:a}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},SEX_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]).toString();return H(t)?t:window.luckysheet_function.ISIDCARD.f(t)?parseInt(t.substr(16,1))%2==1?"\u7537":"\u5973":g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},BIRTHDAY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]).toString();if(H(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return g.error.v;var l="";if(t.length==15){var o="19"+t.substring(6,8)+"/"+t.substring(8,10)+"/"+t.substring(10,12);l=o}else if(t.length==18){var o=t.substring(6,10)+"/"+t.substring(10,12)+"/"+t.substring(12,14);l=o}var a=0;if(arguments[1]!=null&&(a=D.getFirstValue(arguments[1]),H(a)))return a;if(!B(a))return g.error.v;if(a=parseInt(a),a<0||a>2)return g.error.v;if(parseInt(a)==0)return l;if(parseInt(a)==1)return(0,j.default)(l).format("YYYY-MM-DD");if(parseInt(a)==2)return(0,j.default)(l).format("YYYY\u5E74M\u6708D\u65E5")}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},PROVINCE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]).toString();if(H(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return g.error.v;var l="\u672A\u77E5",o=g.classlist.province;return t.substring(0,2)in o&&(l=o[t.substring(0,2)]),l}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},CITY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]).toString();if(H(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return g.error.v;for(var l=cityData.length,o="\u672A\u77E5",e=0;e<l;e++)if(t.substring(0,6)==cityData[e].code){o=cityData[e].title;break}return o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},STAR_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return g.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(H(l))return l;l=new Date(l);var o=l.getMonth(),a=l.getDate(),s=new Date(1999,o,a,0,0,0),u=[];u.push(["\u9B54\u7FAF\u5EA7",new Date(1999,0,1,0,0,0)]),u.push(["\u6C34\u74F6\u5EA7",new Date(1999,0,20,0,0,0)]),u.push(["\u53CC\u9C7C\u5EA7",new Date(1999,1,19,0,0,0)]),u.push(["\u767D\u7F8A\u5EA7",new Date(1999,2,21,0,0,0)]),u.push(["\u91D1\u725B\u5EA7",new Date(1999,3,21,0,0,0)]),u.push(["\u53CC\u5B50\u5EA7",new Date(1999,4,21,0,0,0)]),u.push(["\u5DE8\u87F9\u5EA7",new Date(1999,5,22,0,0,0)]),u.push(["\u72EE\u5B50\u5EA7",new Date(1999,6,23,0,0,0)]),u.push(["\u5904\u5973\u5EA7",new Date(1999,7,23,0,0,0)]),u.push(["\u5929\u79E4\u5EA7",new Date(1999,8,23,0,0,0)]),u.push(["\u5929\u874E\u5EA7",new Date(1999,9,23,0,0,0)]),u.push(["\u5C04\u624B\u5EA7",new Date(1999,10,22,0,0,0)]),u.push(["\u9B54\u7FAF\u5EA7",new Date(1999,11,22,0,0,0)]);for(var e=u.length-1;e>=0;e--)if(s>=u[e][1])return u[e][0];return"\u672A\u627E\u5230\u5339\u914D\u661F\u5EA7\u4FE1\u606F"}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},ANIMAL_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return g.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(H(l))return l;l=new Date(l);var o=new Array("\u732A","\u9F20","\u725B","\u864E","\u5154","\u9F99","\u86C7","\u9A6C","\u7F8A","\u7334","\u9E21","\u72D7"),a=(parseInt(l.getFullYear())+9)%12;return a!=null&&!isNaN(a)?o[a]:"\u672A\u627E\u5230\u5339\u914D\u751F\u8096\u4FE1\u606F"}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},ISIDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return!!l.test(t)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},DM_TEXT_CUTWORD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0],"text");if(H(a))return a;var s=0;return arguments[1]!=null&&(s=D.getFirstValue(arguments[1]),H(s))?s:B(s)?(s=parseInt(s),s!=0&&s!=1&&s!=2?g.error.v:($.post("/dataqk/tu/api/cutword",{text:a,type:s},function(h){var d=[].concat(f.flowdata);g.execFunctionGroup(t,l,h),d[t][l]={v:h,f:o},Ze(d,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},DM_TEXT_TFIDF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0],"text");if(H(a))return a;var s=20;if(arguments[1]!=null&&(s=D.getFirstValue(arguments[1]),H(s)))return s;if(!B(s))return g.error.v;s=parseInt(s);var u=0;return arguments[2]!=null&&(u=D.getFirstValue(arguments[2]),H(u))?u:B(u)?(u=parseInt(u),s<0?g.error.v:u!=0&&u!=1&&u!=2?g.error.v:($.post("/dataqk/tu/api/tfidf",{text:a,count:s,set:u},function(d){var m=xe.deepCopyFlowData(f.flowdata);g.execFunctionGroup(t,l,d),m[t][l]={v:d,f:o},Ze(m,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},DM_TEXT_TEXTRANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0],"text");if(H(a))return a;var s=20;if(arguments[1]!=null&&(s=D.getFirstValue(arguments[1]),H(s)))return s;if(!B(s))return g.error.v;s=parseInt(s);var u=0;return arguments[2]!=null&&(u=D.getFirstValue(arguments[2]),H(u))?u:B(u)?(u=parseInt(u),s<0?g.error.v:u!=0&&u!=1&&u!=2?g.error.v:($.post("/dataqk/tu/api/tfidf",{text:a,count:s,set:u},function(d){var m=xe.deepCopyFlowData(f.flowdata);g.execFunctionGroup(t,l,d),m[t][l]={v:d,f:o},Ze(m,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},DATA_CN_STOCK_CLOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0]);if(H(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(N(u)=="array")return g.error.v;if(N(u)=="object"&&u.startCell!=null)if(u.data!=null&&N(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=mt("yyyy-mm-dd",u.data.v);else return g.error.v;else s=u;if(!zt(s))return[g.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,j.default)(s).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&(h=D.getFirstValue(arguments[2]),H(h))?h:B(h)?(h=parseInt(h),h!=0&&h!=1&&h!=2?g.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:h,type:"0"},function(m){var p=xe.deepCopyFlowData(f.flowdata),v=Il(m);v==null&&(v=m),g.execFunctionGroup(t,l,v),p[t][l]={v,f:o},Ze(p,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},DATA_CN_STOCK_OPEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0]);if(H(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(N(u)=="array")return g.error.v;if(N(u)=="object"&&u.startCell!=null)if(u.data!=null&&N(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=mt("yyyy-mm-dd",u.data.v);else return g.error.v;else s=u;if(!zt(s))return[g.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,j.default)(s).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&(h=D.getFirstValue(arguments[2]),H(h))?h:B(h)?(h=parseInt(h),h!=0&&h!=1&&h!=2?g.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:h,type:"1"},function(m){var p=xe.deepCopyFlowData(f.flowdata);g.execFunctionGroup(t,l,m),p[t][l]={v:m,f:o},Ze(p,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},DATA_CN_STOCK_MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0]);if(H(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(N(u)=="array")return g.error.v;if(N(u)=="object"&&u.startCell!=null)if(u.data!=null&&N(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=mt("yyyy-mm-dd",u.data.v);else return g.error.v;else s=u;if(!zt(s))return[g.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,j.default)(s).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&(h=D.getFirstValue(arguments[2]),H(h))?h:B(h)?(h=parseInt(h),h!=0&&h!=1&&h!=2?g.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:h,type:"2"},function(m){var p=xe.deepCopyFlowData(f.flowdata);g.execFunctionGroup(t,l,m),p[t][l]={v:m,f:o},Ze(p,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},DATA_CN_STOCK_MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0]);if(H(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(N(u)=="array")return g.error.v;if(N(u)=="object"&&u.startCell!=null)if(u.data!=null&&N(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=mt("yyyy-mm-dd",u.data.v);else return g.error.v;else s=u;if(!zt(s))return[g.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,j.default)(s).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&(h=D.getFirstValue(arguments[2]),H(h))?h:B(h)?(h=parseInt(h),h!=0&&h!=1&&h!=2?g.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:h,type:"3"},function(m){var p=xe.deepCopyFlowData(f.flowdata);g.execFunctionGroup(t,l,m),p[t][l]={v:m,f:o},Ze(p,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},DATA_CN_STOCK_VOLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0]);if(H(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(N(u)=="array")return g.error.v;if(N(u)=="object"&&u.startCell!=null)if(u.data!=null&&N(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=mt("yyyy-mm-dd",u.data.v);else return g.error.v;else s=u;if(!zt(s))return[g.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,j.default)(s).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&(h=D.getFirstValue(arguments[2]),H(h))?h:B(h)?(h=parseInt(h),h!=0&&h!=1&&h!=2?g.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:h,type:"4"},function(m){var p=xe.deepCopyFlowData(f.flowdata);g.execFunctionGroup(t,l,m),p[t][l]={v:m,f:o},Ze(p,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},DATA_CN_STOCK_AMOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=D.getFirstValue(arguments[0]);if(H(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(N(u)=="array")return g.error.v;if(N(u)=="object"&&u.startCell!=null)if(u.data!=null&&N(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=mt("yyyy-mm-dd",u.data.v);else return g.error.v;else s=u;if(!zt(s))return[g.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,j.default)(s).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&(h=D.getFirstValue(arguments[2]),H(h))?h:B(h)?(h=parseInt(h),h!=0&&h!=1&&h!=2?g.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:h,type:"5"},function(m){var p=xe.deepCopyFlowData(f.flowdata);g.execFunctionGroup(t,l,m),p[t][l]={v:m,f:o},Ze(p,[{row:[t,t],column:[l,l]}])}),"loading...")):g.error.v}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},ISDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:zt(t)}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},SUMIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=0,l=arguments[0].data,o=arguments[0].rowl,a=arguments[0].coll,s=Xi(arguments[1]);if(l=g.getRangeArray(l)[0],arguments[2]){var u=[],h=arguments[2].startCell,d=arguments[2].rowl,m=arguments[2].coll,p=arguments[2].sheetName;if(o==d&&a==m)u=arguments[2].data;else{var v=[],y=[],k="",b="";v[0]=parseInt(h.replace(/[^0-9]/g,""))-1,y[0]=fl(h.replace(/[^A-Za-z]/g,"")),v[1]=v[0]+o-1,y[1]=y[0]+a-1;var w=tt(y[1]),x=v[1]+1;k=w+x,b=p+"!"+h+":"+k,u=Fr(b).data}u=g.getRangeArray(u)[0];for(var e=0;e<l.length;e++){var C=l[e];if(!!C&&g.acompareb(C,s)){if(!B(u[e]))continue;t=xt(t,"+",u[e])}}}else for(var e=0;e<l.length;e++){var C=l[e];if(!!C&&g.acompareb(C,s)){if(!B(C))continue;t=xt(t,"",C)}}return t}catch(_){var S=_;return S=g.errorInfo(S),[g.error.v,S]}},TAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),Math.tan(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},TANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=Math.exp(2*t);return(l-1)/(l+1)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},CEILING:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),l==0?0:t>0&&l<0?g.error.nm:Math.ceil(t/l)*l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ATAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),Math.atan(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},ASINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),Math.log(t+Math.sqrt(t*t+1))):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},ABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),Math.abs(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},ACOS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<-1||t>1?g.error.nm:Math.acos(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},ACOSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<1?g.error.nm:Math.log(t+Math.sqrt(t*t-1))):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},MULTINOMIAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0,a=1,e=0;e<t.length;e++){var s=t[e];if(!B(s))return g.error.v;if(s=parseFloat(s),s<0)return g.error.nm;o+=s,a*=D.factorial(s)}return D.factorial(o)/a}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},ATANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<=-1||t>=1?g.error.nm:Math.log((1+t)/(1-t))/2):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},ATAN2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t==0&&l==0?g.error.d:Math.atan2(l,t)):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},COUNTBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=0;if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return 1;if(N(t.data)=="array")for(var o=0;o<t.data.length;o++)for(var a=0;a<t.data[o].length;a++)(t.data[o][a]==null||me(t.data[o][a].v))&&l++;else me(t.data.v)&&l++}return l}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},COSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),(Math.exp(t)+Math.exp(-t))/2):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},INT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0];if(N(t)=="array")return N(t[0])=="array"?D.isDyadicArr(t)?B(t[0][0])?Math.floor(parseFloat(t[0][0])):g.error.v:g.error.v:B(t[0])?Math.floor(parseFloat(t[0])):g.error.v;if(N(t)=="object"&&t.startCell!=null){if(t.coll>1)return g.error.v;if(t.rowl>1){var l=g.getcellrange(t.startCell),o=l.row[0];if(window.luckysheetCurrentRow<o||window.luckysheetCurrentRow>o+t.rowl-1)return g.error.v;var a=t.data[window.luckysheetCurrentRow-o][0]}else var a=t.data;return a==null||me(a.v)?0:B(a.v)?Math.floor(parseFloat(a.v)):g.error.v}else{if(N(t)=="boolean"){if(t.toString().toLowerCase()=="true")return 1;if(t.toString().toLowerCase()=="false")return 0}return B(t)?Math.floor(parseFloat(t)):g.error.v}}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},ISEVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseInt(t),!(Math.abs(t)&1)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},ISODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseInt(t),!!(Math.abs(t)&1)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},LCM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array")if(N(l[0])=="array"){if(!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l))}else t=t.concat(l);else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0;o<t.length;o++){var a=t[o];if(!B(a))return g.error.v;if(a=parseInt(a),a<0)return g.error.nm;t[o]=a}for(var e,s,u,h,d=1;(u=t.pop())!==void 0;)for(u==0&&(d=0);u>1;){if(u%2){for(e=3,s=Math.floor(Math.sqrt(u));e<=s&&u%e;e+=2);h=e<=s?e:u}else h=2;for(u/=h,d*=h,e=t.length;e;t[--e]%h==0&&(t[e]/=h)===1&&t.splice(e,1));}return d>=Math.pow(2,53)?g.error.nm:d}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},LN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<=0?g.error.nm:Math.log(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},LOG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;if(t=parseFloat(t),t<=0)return g.error.nm;if(arguments.length==2){var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;if(l=parseFloat(l),l<=0)return g.error.nm}else var l=10;return Math.log(t)/Math.log(l)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},LOG10:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<=0?g.error.nm:Math.log(t)/Math.log(10)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},MOD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;if(l=parseFloat(l),l==0)return g.error.d;var o=Math.abs(t%l);return l>0?o:-o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},MROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t*l<0?g.error.nm:Math.round(t/l)*l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=Math.ceil(Math.abs(t));return l=l&1?l:l+1,t>=0?l:-l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},SUMSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"number",!0)):t.push(l)}var o=0;if(t.length>0)for(var e=0;e<t.length;e++){var a=t[e];if(!B(a))return g.error.v;a=parseFloat(a),o+=a*a}return o}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},COMBIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),t<0||l<0||t<l?g.error.nm:D.factorial(t)/(D.factorial(l)*D.factorial(t-l))):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},SUBTOTAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let m=function(p){switch(p){case 1:case 101:return window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,s);case 2:case 102:return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,s);case 3:case 103:return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,s);case 4:case 104:return window.luckysheet_function.MAX.f.apply(window.luckysheet_function.MAX,s);case 5:case 105:return window.luckysheet_function.MIN.f.apply(window.luckysheet_function.MIN,s);case 6:case 106:return window.luckysheet_function.PRODUCT.f.apply(window.luckysheet_function.PRODUCT,s);case 7:case 107:return window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,s);case 8:case 108:return window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,s);case 9:case 109:return window.luckysheet_function.SUM.f.apply(window.luckysheet_function.SUM,s);case 10:case 110:return window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,s);case 11:case 111:return window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,s)}};var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=[];for(var e=0;e<t.length;e++){for(var o=[],a=0;a<t[e].length;a++)o.push(t[e][a]);l.push(o)}}else{l=[];for(var e=0;e<t.length;e++)l.push(t[e])}else N(t)=="object"&&t.startCell!=null?l=D.getFirstValue(t):l=t;var s=Array.prototype.slice.apply(arguments);if(s.shift(),N(l)=="array"){var u=[];if(N(l[0])=="array")for(var e=0;e<l.length;e++){for(var o=[],a=0;a<l[e].length;a++){var h=l[e][a];H(h)?o.push(h):B(h)?(h=parseInt(h),h<1||h>111||h>11&&h<101?o.push(g.error.v):o.push(m(h))):o.push(g.error.v)}u.push(o)}else for(var e=0;e<l.length;e++){var h=l[e];H(h)?u.push(h):B(h)?(h=parseInt(h),h<1||h>111||h>11&&h<101?u.push(g.error.v):u.push(m(h))):u.push(g.error.v)}return u}else return H(l)?l:B(l)?(l=parseInt(l),l<1||l>111||l>11&&l<101?g.error.v:m(l)):g.error.v}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},ASIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<-1||t>1?g.error.nm:Math.asin(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},COUNTIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let m=function(p,v){/[<>=!*?]/.test(v)||(v='=="'+v+'"'),v=v.replace("<>","!=");var y=0;if(N(p)=="array"){for(var k=0;k<p.length;k++)for(var b=0;b<p[k].length;b++)if(p[k][b]!=null&&!me(p[k][b].v)){var w=p[k][b].v;v.indexOf("*")>-1||v.indexOf("?")>-1?g.isWildcard(w,v)&&y++:typeof w!="string"?new Function("return "+w+v)()&&y++:new Function('return "'+w+'"'+v)()&&y++}}else if(p!=null&&!me(p.v)){var w=p.v;v.indexOf("*")>-1||v.indexOf("?")>-1?g.isWildcard(w,v)&&y++:typeof w!="string"?new Function("return "+w+v)()&&y++:new Function('return "'+w+'"'+v)()&&y++}return y};var t=arguments[0],l;if(N(t)=="object"&&t.startCell!=null)l=t.data;else return g.error.v;var o=arguments[1],a;if(N(o)=="array")if(a=[],N(o[0])=="array"){if(!D.isDyadicArr(o))return g.error.v;for(var e=0;e<o.length;e++){for(var s=[],u=0;u<o[e].length;u++)s.push(o[e][u]);a.push(s)}}else for(var e=0;e<o.length;e++)a.push(o[e]);else if(N(o)=="object"&&o.startCell!=null){if(o.rowl>1||o.coll>1)return 0;a=o.data.v}else a=o;if(N(a)=="array"){var h=[];if(N(a[0])=="array")for(var e=0;e<a.length;e++){for(var s=[],u=0;u<a[e].length;u++)s.push(m(l,a[e][u]));h.push(s)}else for(var e=0;e<a.length;e++)h.push(m(l,a[e]));return h}else return m(l,a)}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},RADIANS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t*Math.PI/180):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},RAND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;try{return Math.floor(Math.random()*1e9)/1e9}catch(n){var e=n;return e=g.errorInfo(e),[g.error.v,e]}},COUNTUNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"text",!0)):t.push(l)}return window.luckysheet_function.UNIQUE.f(t)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},DEGREES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t*180/Math.PI):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},ERFC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),jStat.erfc(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},EVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=Math.ceil(Math.abs(t));return l=l&1?l+1:l,t>0?l:-l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},EXP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),Math.exp(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},FACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))if(N(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return g.error.v;return t=parseInt(t),t<0?g.error.nm:D.factorial(t)}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},FACTDOUBLE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))if(N(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return g.error.v;return t=parseInt(t),t<0?g.error.nm:D.factorialDouble(t)}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},PI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;try{return Math.PI}catch(n){var e=n;return e=g.errorInfo(e),[g.error.v,e]}},FLOOR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;if(l=parseFloat(l),l==0)return g.error.d;if(t>0&&l<0)return g.error.nm;var o=-Math.floor(Math.log(Math.abs(l))/Math.log(10));return t>=0?Math.floor(t/l)*l*Math.pow(10,o)/Math.pow(10,o):-(Math.ceil(Math.abs(t)/l)*l*Math.pow(10,o))/Math.pow(10,o)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},GCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!1))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"number",!1)):t.push(l)}if(!B(t[0]))return g.error.v;var o=parseInt(t[0]);if(o<0||o>=Math.pow(2,53))return g.error.nm;for(var e=1;e<t.length;e++){var a=t[e];if(!B(a))return g.error.v;if(a=parseInt(a),a<0||a>=Math.pow(2,53))return g.error.nm;for(;o&&a;)o>a?o%=a:a%=o;o+=a}return o}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},RANDBETWEEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),t>l?g.error.nm:t+Math.ceil((l-t+1)*Math.random())-1):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.round(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},ROUNDDOWN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},ROUNDUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.ceil(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},SERIESSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=arguments[3],s=[];if(N(a)=="array"){if(N(a[0])=="array"&&!D.isDyadicArr(a))return g.error.v;s=s.concat(D.getDataArr(a,!1))}else N(a)=="object"&&a.startCell!=null?s=s.concat(D.getCellDataArr(a,"number",!1)):s.push(a);if(!B(s[0]))return g.error.v;for(var u=parseFloat(s[0])*Math.pow(t,l),e=1;e<s.length;e++){var h=s[e];if(!B(h))return g.error.v;h=parseFloat(h),u+=h*Math.pow(t,l+e*o)}return u}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},SIGN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;if(t=parseFloat(t),t>0)return 1;if(t==0)return 0;if(t<0)return-1}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},SIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),Math.sin(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},SINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),(Math.exp(t)-Math.exp(-t))/2):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},SQRT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<0?g.error.nm:Math.sqrt(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},SQRTPI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<0?g.error.nm:Math.sqrt(t*Math.PI)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},GAMMALN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<=0?g.error.nm:jStat.gammaln(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},COS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),Math.cos(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},TRUNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;if(t=parseFloat(t),arguments.length==2){var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}else var l=0;var o=t>0?1:-1;return o*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},QUOTIENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),l==0?g.error.d:parseInt(t/l,10)):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},POWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t==0&&l==0?g.error.nm:t<0&&l.toString().indexOf(".")>-1?g.error.nm:Math.pow(t,l)):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},SUMIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=0,l=arguments;jn(l);for(var o=g.getRangeArray(l[0])[0],a=new Array(o.length),e=0;e<a.length;e++)a[e]=!0;for(var e=1;e<l.length;e+=2)for(var s=g.getRangeArray(l[e])[0],u=l[e+1],h=0;h<s.length;h++){var d=s[h];a[h]=a[h]&&!!d&&g.acompareb(d,u)}for(var e=0;e<o.length;e++)a[e]&&(t=xt(t,"+",o[e]));return t}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},COUNTIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments;jn(t);for(var l=new Array(g.getRangeArray(t[0])[0].length),e=0;e<l.length;e++)l[e]=!0;for(var e=0;e<t.length;e+=2)for(var o=g.getRangeArray(t[e])[0],a=t[e+1],s=0;s<o.length;s++){var u=o[s];l[s]=l[s]&&!!u&&g.acompareb(u,a)}for(var h=0,e=0;e<l.length;e++)l[e]&&h++;return h}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},PRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=1,e=0;e<t.length;e++){var a=t[e];if(!B(a))return g.error.v;a=parseFloat(a),o*=a}return o}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},HARMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0,a=0,e=0;e<t.length;e++){var s=t[e];if(!B(s))return g.error.v;if(s=parseFloat(s),s<=0)return g.error.nm;o+=1/s,a++}return a/o}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},HYPGEOMDIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let h=function(m,p,v,y){var k=D.factorial(v)/(D.factorial(m)*D.factorial(v-m)),b=D.factorial(y-v)/(D.factorial(p-m)*D.factorial(y-v-p+m)),w=D.factorial(y)/(D.factorial(p)*D.factorial(y-p));return k*b/w},d=function(m,p,v,y){for(var k=0,b=0;b<=m;b++)k+=h(b,p,v,y);return k};var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseInt(a);var s=D.getCellBoolen(arguments[4]);return H(s)?s:t<0||t>Math.min(l,o)||t<Math.max(0,l-a+o)?g.error.nm:l<=0||l>a?g.error.nm:o<=0||o>a?g.error.nm:a<=0?g.error.nm:s?d(t,l,o,a):h(t,l,o,a)}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},INTERCEPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=0,l=arguments[0],o=[];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;o=o.concat(D.getDataArr(l,!1))}else N(l)=="object"&&l.startCell!=null?o=o.concat(D.getCellDataArr(l,"text",!1)):o.push(l);var a=arguments[1],s=[];if(N(a)=="array"){if(N(a[0])=="array"&&!D.isDyadicArr(a))return g.error.v;s=s.concat(D.getDataArr(a,!1))}else N(a)=="object"&&a.startCell!=null?s=s.concat(D.getCellDataArr(a,"text",!1)):s.push(a);if(o.length!=s.length)return g.error.na;for(var u=[],h=[],e=0;e<o.length;e++){var d=o[e],m=s[e];B(d)&&B(m)&&(u.push(parseFloat(d)),h.push(parseFloat(m)))}if(D.variance_s(h)==0)return g.error.d;for(var p=jStat.mean(h),v=jStat.mean(u),y=h.length,k=0,b=0,e=0;e<y;e++)k+=(h[e]-p)*(u[e]-v),b+=Math.pow(h[e]-p,2);var w=k/b,x=v-w*p;return x+w*t}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},KURT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!B(s))return g.error.v;s=parseFloat(s),o.push(s)}if(o.length<4||D.standardDeviation_s(o)==0)return g.error.d;for(var u=jStat.mean(o),h=o.length,d=0,e=0;e<h;e++)d+=Math.pow(o[e]-u,4);return d=d/Math.pow(jStat.stdev(o,!0),4),h*(h+1)/((h-1)*(h-2)*(h-3))*d-3*(h-1)*(h-1)/((h-2)*(h-3))}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},LARGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!0))}else N(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(D.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var l=[],o=0;o<t.length;o++){var a=t[o];if(!B(a))return g.error.v;a=parseFloat(a),l.push(a)}var s;if(N(arguments[1])=="array"){if(N(arguments[1][0])=="array"&&!D.isDyadicArr(arguments[1]))return g.error.v;s=D.getDataArr(arguments[1])}else if(N(arguments[1])=="object"&&arguments[1].startCell!=null){if(arguments[1].rowl>1||arguments[1].coll>1)return g.error.v;var u=arguments[1].data;if(u==null||me(u.v))var s=0;else var s=u.v}else s=arguments[1];if(N(s)=="array"){if(l.length==0)return g.error.nm;for(var h=[],e=0;e<s.length;e++){if(!B(s[e])){h.push(g.error.v);continue}if(s[e]=Math.ceil(parseFloat(s[e])),s[e]<=0||s[e]>l.length){h.push(g.error.nm);continue}h.push(t.sort(function(p,v){return v-p})[s[e]-1])}return h}else return B(s)?(s=Math.ceil(parseFloat(s)),l.length==0?g.error.nm:s<=0||s>l.length?g.error.nm:t.sort(function(m,p){return p-m})[s-1]):g.error.v}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},STDEVA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!1))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"text",!1)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];B(s)?s=parseFloat(s):s.toString().toLowerCase()=="true"?s=1:s=0,o.push(s)}return o.length==0?0:o.length==1?g.error.d:D.standardDeviation_s(o)}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},STDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?t=t.concat(D.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!B(s))return g.error.v;s=parseFloat(s),o.push(s)}return o.length==0?0:o.length==1?g.error.d:D.standardDeviation(o)}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},GEOMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"text",!0));else if(N(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else if(B(l))t.push(l);else return g.error.v}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!!B(s)){if(s=parseFloat(s),s<=0)return g.error.nm;o.push(s)}}return o.length==0?g.error.nm:jStat.geomean(o)}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},RANK_EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;o=o.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?o=o.concat(D.getCellDataArr(l,"number",!0)):o.push(l);for(var a=[],s=0;s<o.length;s++){var u=o[s];if(!B(u))return g.error.v;u=parseFloat(u),a.push(u)}if(arguments.length==3){var h=D.getCellBoolen(arguments[2]);if(H(h))return h}else var h=!1;var d=h?function(v,y){return v-y}:function(v,y){return y-v};a=a.sort(d);var m=a.indexOf(t);return m==-1?g.error.na:m+1}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},RANK_AVG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;o=o.concat(D.getDataArr(l,!0))}else N(l)=="object"&&l.startCell!=null?o=o.concat(D.getCellDataArr(l,"number",!0)):o.push(l);for(var a=[],s=0;s<o.length;s++){var u=o[s];if(!B(u))return g.error.v;u=parseFloat(u),a.push(u)}if(arguments.length==3){var h=D.getFirstValue(arguments[2]);if(H(h))return h;if(N(h)!="boolean")if(N(h)=="string"&&(h.toLowerCase()=="true"||h.toLowerCase()=="false"))h.toLowerCase()=="true"&&(h=!0),h.toLowerCase()=="false"&&(h=!1);else if(B(h))h=parseFloat(h),h=h!=0;else return g.error.v}else var h=!1;var d=h?function(v,y){return v-y}:function(v,y){return y-v};a=a.sort(d);for(var m=0,e=0;e<a.length;e++)a[e]==t&&m++;return m>1?(2*a.indexOf(t)+m+1)/2:a.indexOf(t)+1}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},PERCENTRANK_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!0))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],a=0;a<l.length;a++){var s=l[a];if(!B(s))return g.error.v;s=parseFloat(s),o.push(s)}var u=D.getFirstValue(arguments[1]);if(H(u))return u;if(!B(u))return g.error.v;if(u=parseFloat(u),arguments.length==3){var h=D.getFirstValue(arguments[2]);if(H(h))return h;if(!B(h))return g.error.v;h=parseInt(h)}else var h=3;if(o.length==0)return g.error.nm;if(h<1)return g.error.nm;if(o.length==1&&o[0]==u)return 1;o=o.sort(function(x,C){return x-C});for(var d=window.luckysheet_function.UNIQUE.f(o)[0],m=o.length,p=d.length,v=Math.pow(10,h),y=0,k=!1,e=0;!k&&e<p;)u===d[e]?(y=(o.indexOf(d[e])+1)/(m+1),k=!0):u>=d[e]&&(u<d[e+1]||e===p-1)&&(y=(o.lastIndexOf(d[e])+1+(u-d[e])/(d[e+1]-d[e]))/(m+1),k=!0),e++;return isNaN(y)?g.error.na:Math.floor(y*v)/v}catch(w){var b=w;return b=g.errorInfo(b),[g.error.v,b]}},PERCENTRANK_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!0))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],a=0;a<l.length;a++){var s=l[a];if(!B(s))return g.error.v;s=parseFloat(s),o.push(s)}var u=D.getFirstValue(arguments[1]);if(H(u))return u;if(!B(u))return g.error.v;if(u=parseFloat(u),arguments.length==3){var h=D.getFirstValue(arguments[2]);if(H(h))return h;if(!B(h))return g.error.v;h=parseInt(h)}else var h=3;if(o.length==0)return g.error.nm;if(h<1)return g.error.nm;if(o.length==1&&o[0]==u)return 1;o=o.sort(function(x,C){return x-C});for(var d=window.luckysheet_function.UNIQUE.f(o)[0],m=o.length,p=d.length,v=Math.pow(10,h),y=0,k=!1,e=0;!k&&e<p;)u===d[e]?(y=o.indexOf(d[e])/(m-1),k=!0):u>=d[e]&&(u<d[e+1]||e===p-1)&&(y=(o.lastIndexOf(d[e])+(u-d[e])/(d[e+1]-d[e]))/(m-1),k=!0),e++;return isNaN(y)?g.error.na:Math.floor(y*v)/v}catch(w){var b=w;return b=g.errorInfo(b),[g.error.v,b]}},FORECAST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;o=o.concat(D.getDataArr(l,!1))}else N(l)=="object"&&l.startCell!=null?o=o.concat(D.getCellDataArr(l,"text",!1)):o.push(l);var a=arguments[2],s=[];if(N(a)=="array"){if(N(a[0])=="array"&&!D.isDyadicArr(a))return g.error.v;s=s.concat(D.getDataArr(a,!1))}else N(a)=="object"&&a.startCell!=null?s=s.concat(D.getCellDataArr(a,"text",!1)):s.push(a);if(o.length!=s.length)return g.error.na;for(var u=[],h=[],e=0;e<o.length;e++){var d=o[e],m=s[e];B(d)&&B(m)&&(u.push(parseFloat(d)),h.push(parseFloat(m)))}if(D.variance_s(h)==0)return g.error.d;for(var p=jStat.mean(h),v=jStat.mean(u),y=h.length,k=0,b=0,e=0;e<y;e++)k+=(h[e]-p)*(u[e]-v),b+=Math.pow(h[e]-p,2);var w=k/b,x=v-w*p;return x+w*t}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},FISHERINV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=Math.exp(2*t);return(l-1)/(l+1)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},FISHER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<=-1||t>=1?g.error.nm:Math.log((1+t)/(1-t))/2):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},MODE_SNGL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else{if(!B(l))return g.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)&&o.push(parseFloat(a))}for(var s={},u=[],h=0,d,e=0;e<o.length;e++)d=o[e],s[d]=s[d]?s[d]+1:1,s[d]>h&&(h=s[d],u=[]),s[d]==h&&(u[u.length]=d);if(h<=1)return g.error.na;for(var m=o.indexOf(u[0]),p=0;p<u.length;p++){var v=o.indexOf(u[p]);v<m&&(m=v)}return o[m]}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},WEIBULL_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getCellBoolen(arguments[3]);return H(a)?a:t<0||l<=0||o<=0?g.error.nm:a?1-Math.exp(-Math.pow(t/o,l)):Math.pow(t,l-1)*Math.exp(-Math.pow(t/o,l))*l/Math.pow(o,l)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},AVEDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else{if(!B(l))return g.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)&&o.push(parseFloat(a))}return o.length==0?g.error.nm:jStat.sum(jStat(o).subtract(jStat.mean(o)).abs()[0])/o.length}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},AVERAGEA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!1))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else if(s.toString.toLowerCase()=="true")t.push(1);else if(s.toString.toLowerCase()=="false")t.push(0);else if(B(l))t.push(l);else return g.error.v}for(var o=0,a=0,e=0;e<t.length;e++){var s=t[e];B(s)?o+=parseFloat(s):s.toString().toLowerCase()=="true"?o+=1:o+=0,a++}return a==0?g.error.d:o/a}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},BINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getCellBoolen(arguments[3]);return H(a)?a:t<0||t>l?g.error.nm:o<0||o>1?g.error.nm:a?jStat.binomial.cdf(t,l,o):jStat.binomial.pdf(t,l,o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},BINOM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;if(o=parseFloat(o),t<0)return g.error.nm;if(l<0||l>1)return g.error.nm;if(o<0||o>1)return g.error.nm;for(var a=0;a<=t;){if(jStat.binomial.cdf(a,t,l)>=o)return a;a++}}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},CONFIDENCE_NORM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseInt(o),t<=0||t>=1?g.error.nm:l<=0?g.error.nm:o<1?g.error.nm:jStat.normalci(1,t,l,o)[1]-1):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},CORREL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;a=a.concat(D.getDataArr(o,!1))}else N(o)=="object"&&o.startCell!=null?a=a.concat(D.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return g.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var h=l[e],d=a[e];B(h)&&B(d)&&(s.push(parseFloat(h)),u.push(parseFloat(d)))}return s.length==0||u.length==0||D.standardDeviation(s)==0||D.standardDeviation(u)==0?g.error.d:jStat.corrcoeff(s,u)}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},COVARIANCE_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;a=a.concat(D.getDataArr(o,!1))}else N(o)=="object"&&o.startCell!=null?a=a.concat(D.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return g.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var h=l[e],d=a[e];B(h)&&B(d)&&(s.push(parseFloat(h)),u.push(parseFloat(d)))}if(s.length==0||u.length==0)return g.error.d;for(var m=jStat.mean(s),p=jStat.mean(u),v=0,e=0;e<s.length;e++)v+=(s[e]-m)*(u[e]-p);return v=v/s.length,v}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},COVARIANCE_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;a=a.concat(D.getDataArr(o,!1))}else N(o)=="object"&&o.startCell!=null?a=a.concat(D.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return g.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var h=l[e],d=a[e];B(h)&&B(d)&&(s.push(parseFloat(h)),u.push(parseFloat(d)))}return s.length==0||u.length==0?g.error.d:jStat.covariance(s,u)}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},DEVSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else if(B(l))t.push(l);else if(N(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else return g.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)&&o.push(parseFloat(a))}for(var s=jStat.mean(o),u=0,e=0;e<o.length;e++)u+=Math.pow(o[e]-s,2);return u}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},EXPON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getCellBoolen(arguments[2]);return H(o)?o:t<0?g.error.nm:l<0?g.error.nm:o?jStat.exponential.cdf(t,l):jStat.exponential.pdf(t,l)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},AVERAGEIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=0,l=0,o=arguments[0].data,a=arguments[0].rowl,s=arguments[0].coll,u=Xi(arguments[1]),h=[];if(arguments[2]){var d=arguments[2].startCell,m=arguments[2].rowl,p=arguments[2].coll,v=arguments[2].sheetName;if(a==m&&s==p)h=arguments[2].data;else{var y=[],k=[],b="",w="";y[0]=parseInt(d.replace(/[^0-9]/g,""))-1,k[0]=fl(d.replace(/[^A-Za-z]/g,"")),y[1]=y[0]+a-1,k[1]=k[0]+s-1;var x=tt(k[1]),C=y[1]+1;b=x+C,w=v+"!"+d+":"+b,h=Fr(w).data}h=g.getRangeArray(h)[0]}o=g.getRangeArray(o)[0];for(var e=0;e<o.length;e++){var S=o[e];if(!!S&&g.acompareb(S,u)){var _=h[e]||S;if(!B(_))continue;t+=parseFloat(_),l++}}return t==0||l==0?g.error.d:Il(t/l)}catch(F){var T=F;return T=g.errorInfo(T),[g.error.v,T]}},AVERAGEIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=0,l=0,o=arguments;jn(o);for(var a=g.getRangeArray(o[0])[0],s=new Array(a.length),e=0;e<s.length;e++)s[e]=!0;for(var e=1;e<o.length;e+=2)for(var u=g.getRangeArray(o[e])[0],h=o[e+1],d=0;d<u.length;d++){var m=u[d];s[d]=s[d]&&!!m&&g.acompareb(m,h)}for(var e=0;e<a.length;e++)s[e]&&B(a[e])&&(t+=parseFloat(a[e]),l++);return t==0||l==0?g.error.d:Il(t/l)}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},PERMUT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),t<=0||l<0?g.error.nm:t<l?g.error.nm:D.factorial(t)/D.factorial(t-l)):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},TRIMMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let m=function(v,y){return y=y||1,!v||typeof v.slice!="function"?v:v.slice(y)},p=function(v,y){return y=y||1,!v||typeof v.slice!="function"?v:v.slice(0,v.length-y)};var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];B(a)&&o.push(parseFloat(a))}var s=D.getFirstValue(arguments[1]);if(H(s))return s;if(!B(s))return g.error.v;if(s=parseFloat(s),o.length==0)return g.error.nm;if(s<0||s>1)return g.error.nm;o.sort(function(v,y){return v-y});var u=window.luckysheet_function.FLOOR.f(o.length*s,2)/2,h=m(o,u);return h=p(h,u),h=jStat.mean(h),h}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},PERCENTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];B(a)&&o.push(parseFloat(a))}var s=D.getFirstValue(arguments[1]);if(H(s))return s;if(!B(s))return g.error.v;if(s=parseFloat(s),o.length==0)return g.error.nm;if(s<=0||s>=1)return g.error.nm;o=o.sort(function(p,v){return p-v});var u=o.length;if(s<1/(u+1)||s>1-1/(u+1))return g.error.nm;var h=s*(u+1)-1,d=Math.floor(h);return h===d?o[h]:o[d]+(h-d)*(o[d+1]-o[d])}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},PERCENTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];B(a)&&o.push(parseFloat(a))}var s=D.getFirstValue(arguments[1]);if(H(s))return s;if(!B(s))return g.error.v;if(s=parseFloat(s),o.length==0)return g.error.nm;if(s<0||s>1)return g.error.nm;o=o.sort(function(p,v){return p-v});var u=o.length,h=s*(u-1),d=Math.floor(h);return h===d?o[h]:o[d]+(h-d)*(o[d+1]-o[d])}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},PEARSON:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;a=a.concat(D.getDataArr(o,!1))}else N(o)=="object"&&o.startCell!=null?a=a.concat(D.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return g.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var h=l[e],d=a[e];B(h)&&B(d)&&(s.push(parseFloat(h)),u.push(parseFloat(d)))}if(u.length==0||s.length==0)return g.error.d;for(var m=jStat.mean(s),p=jStat.mean(u),v=s.length,y=0,k=0,b=0,e=0;e<v;e++)y+=(s[e]-m)*(u[e]-p),k+=Math.pow(s[e]-m,2),b+=Math.pow(u[e]-p,2);return y/Math.sqrt(k*b)}catch(x){var w=x;return w=g.errorInfo(w),[g.error.v,w]}},NORM_S_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),t<=0||t>=1?g.error.nm:jStat.normal.inv(t,0,1)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},NORM_S_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getCellBoolen(arguments[1]);return H(l)?l:l?jStat.normal.cdf(t,0,1):jStat.normal.pdf(t,0,1)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},NORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))if(N(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))if(N(l)=="boolean")l.toString().toLowerCase()=="true"?l=1:l.toString().toLowerCase()=="false"&&(l=0);else return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))if(N(o)=="boolean")o.toString().toLowerCase()=="true"?o=1:o.toString().toLowerCase()=="false"&&(o=0);else return g.error.v;return o=parseFloat(o),t<=0||t>=1?g.error.nm:o<=0?g.error.nm:jStat.normal.inv(t,l,o)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},NORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))if(N(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getCellBoolen(arguments[3]);return H(a)?a:o<=0?g.error.nm:a?jStat.normal.cdf(t,l,o):jStat.normal.pdf(t,l,o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},NEGBINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getCellBoolen(arguments[3]);return H(a)?a:o<0||o>1?g.error.nm:t<0||l<1?g.error.nm:a?jStat.negbin.cdf(t,l,o):jStat.negbin.pdf(t,l,o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},MINA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!1))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(B(l))t.push(l);else return g.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}return o.length===0?0:Math.min.apply(Math,o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},MEDIAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else{if(!B(l))return g.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)&&o.push(parseFloat(a))}return jStat.median(o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},MAXA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!1))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(B(l))t.push(l);else return g.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}return o.length===0?0:Math.max.apply(Math,o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},LOGNORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseFloat(o),t<=0||t>=1?g.error.nm:o<=0?g.error.nm:jStat.lognormal.inv(t,l,o)):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},LOGNORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getCellBoolen(arguments[3]);return H(a)?a:t<=0||o<=0?g.error.nm:a?jStat.lognormal.cdf(t,l,o):jStat.lognormal.pdf(t,l,o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},Z_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!0))}else N(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(D.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var l=[],o=0;o<t.length;o++){var a=t[o];B(a)&&l.push(parseFloat(a))}var s=D.getFirstValue(arguments[1]);if(H(s))return s;if(!B(s))return g.error.v;if(s=parseFloat(s),l.length==0)return g.error.na;var u=D.standardDeviation_s(l);if(arguments.length==3){if(u=D.getFirstValue(arguments[2]),H(u))return u;if(!B(u))return g.error.v;u=parseFloat(u)}var h=l.length,d=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,l);return 1-window.luckysheet_function.NORM_S_DIST.f((d-s)/(u/Math.sqrt(h)),"true")}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},PROB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!1))}else N(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(D.getCellDataArr(arguments[0],"text",!1)):t.push(arguments[0]);var l=[];if(N(arguments[1])=="array"){if(N(arguments[1][0])=="array"&&!D.isDyadicArr(arguments[1]))return g.error.v;l=l.concat(D.getDataArr(arguments[1],!1))}else N(arguments[1])=="object"&&arguments[1].startCell!=null?l=l.concat(D.getCellDataArr(arguments[1],"text",!1)):l.push(arguments[1]);if(t.length!=l.length)return g.error.na;for(var o=[],a=[],s=0,e=0;e<t.length;e++){var u=t[e],h=l[e];if(B(u)&&B(h)&&(o.push(parseFloat(u)),a.push(parseFloat(h)),s+=parseFloat(h),parseFloat(h)<=0||parseFloat(h)>1))return g.error.nm}if(s!=1)return g.error.nm;var d=D.getFirstValue(arguments[2]);if(H(d))return d;if(!B(d))return g.error.v;d=parseFloat(d);var m=d;if(arguments.length==4){if(m=D.getFirstValue(arguments[3]),H(m))return m;if(!B(m))return g.error.v;m=parseFloat(m)}for(var p=0,e=0;e<o.length;e++)o[e]>=d&&o[e]<=m&&(p+=a[e]);return p}catch(y){var v=y;return v=g.errorInfo(v),[g.error.v,v]}},QUARTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!0))}else if(N(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(D.getCellDataArr(arguments[0],"text",!0));else{if(!B(arguments[0]))return g.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];B(o)&&l.push(parseFloat(o))}var a=D.getFirstValue(arguments[1]);if(H(a))return a;if(!B(a))return g.error.v;if(a=parseInt(a),l.length==0)return g.error.nm;if(a<=0||a>=4)return g.error.nm;switch(a){case 1:return window.luckysheet_function.PERCENTILE_EXC.f(l,.25);case 2:return window.luckysheet_function.PERCENTILE_EXC.f(l,.5);case 3:return window.luckysheet_function.PERCENTILE_EXC.f(l,.75)}}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},QUARTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!0))}else if(N(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(D.getCellDataArr(arguments[0],"text",!0));else{if(!B(arguments[0]))return g.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];B(o)&&l.push(parseFloat(o))}var a=D.getFirstValue(arguments[1]);if(H(a))return a;if(!B(a))return g.error.v;if(a=parseInt(a),l.length==0)return g.error.nm;if(a<0||a>4)return g.error.nm;switch(a){case 0:return Math.min.apply(Math,l);case 1:return window.luckysheet_function.PERCENTILE_INC.f(l,.25);case 2:return window.luckysheet_function.PERCENTILE_INC.f(l,.5);case 3:return window.luckysheet_function.PERCENTILE_INC.f(l,.75);case 4:return Math.max.apply(Math,l)}}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},POISSON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getCellBoolen(arguments[2]);return H(o)?o:t<0||l<0?g.error.nm:o?jStat.poisson.cdf(t,l):jStat.poisson.pdf(t,l)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},RSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else if(N(t)=="object"&&t.startCell!=null)l=l.concat(D.getCellDataArr(t,"text",!1));else{if(!B(t))return g.error.v;l.push(t)}var o=arguments[1],a=[];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;a=a.concat(D.getDataArr(o,!1))}else if(N(o)=="object"&&o.startCell!=null)a=a.concat(D.getCellDataArr(o,"text",!1));else{if(!B(o))return g.error.v;a.push(o)}if(l.length!=a.length)return g.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var h=l[e],d=a[e];B(h)&&B(d)&&(s.push(parseFloat(h)),u.push(parseFloat(d)))}return s.length==0||u.length==0?g.error.d:Math.pow(window.luckysheet_function.PEARSON.f(s,u),2)}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},T_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getCellBoolen(arguments[2]);return H(o)?o:l<1?g.error.nm:o?jStat.studentt.cdf(t,l):jStat.studentt.pdf(t,l)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},T_DIST_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),t<0||l<1?g.error.nm:(1-jStat.studentt.cdf(t,l))*2):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},T_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),l<1?g.error.nm:1-jStat.studentt.cdf(t,l)):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},T_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),t<=0||t>1?g.error.nm:l<1?g.error.nm:jStat.studentt.inv(t,l)):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},T_INV_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),t<=0||t>1?g.error.nm:l<1?g.error.nm:Math.abs(jStat.studentt.inv(t/2,l))):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},T_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!1))}else if(N(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(D.getCellDataArr(arguments[0],"text",!1));else{if(!B(arguments[0]))return g.error.v;t.push(arguments[0])}var l=t,o=[];if(N(arguments[1])=="array"){if(N(arguments[1][0])=="array"&&!D.isDyadicArr(arguments[1]))return g.error.v;o=o.concat(D.getDataArr(arguments[1],!1))}else if(N(arguments[1])=="object"&&arguments[1].startCell!=null)o=o.concat(D.getCellDataArr(arguments[1],"text",!1));else{if(!B(arguments[1]))return g.error.v;o.push(arguments[1])}var a=o,s=D.getFirstValue(arguments[2]);if(H(s))return s;if(!B(s))return g.error.v;s=parseInt(s);var u=D.getFirstValue(arguments[3]);if(H(u))return u;if(!B(u))return g.error.v;if(u=parseInt(u),[1,2].indexOf(s)==-1)return g.error.nm;if([1,2,3].indexOf(u)==-1)return g.error.nm;var h=null,d=null;if(u==1){var m=[];for(e=0;e<l.length;e++)m.push(l[e]-a[e]);var p=Math.abs(jStat.mean(m)),v=D.standardDeviation_s(m);h=p/(v/Math.sqrt(l.length)),d=l.length-1}else{var y=jStat.mean(l),k=jStat.mean(a),b=D.variance_s(l),w=D.variance_s(a);switch(h=Math.abs(y-k)/Math.sqrt(b/l.length+w/a.length),u){case 2:d=l.length+a.length-2;break;case 3:d=Math.pow(b/l.length+w/a.length,2)/(Math.pow(b/l.length,2)/(l.length-1)+Math.pow(w/a.length,2)/(a.length-1));break}}if(s==1)var x=window.luckysheet_function.T_DIST_RT.f(h,d);else if(s==2)var x=window.luckysheet_function.T_DIST_2T.f(h,d);return x}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},F_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=D.getCellBoolen(arguments[3]);return H(a)?a:t<0?g.error.nm:l<1?g.error.nm:o<1?g.error.nm:a?jStat.centralF.cdf(t,l,o):jStat.centralF.pdf(t,l,o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},F_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseInt(o),t<0?g.error.nm:l<1?g.error.nm:o<1?g.error.nm:1-jStat.centralF.cdf(t,l,o)):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},VAR_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else{if(!B(l))return g.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)&&o.push(parseFloat(a))}if(o.length==0)return g.error.d;for(var s=o.length,u=0,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-h,2);return u/s}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},VAR_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else{if(!B(l))return g.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)&&o.push(parseFloat(a))}if(o.length==0)return g.error.d;for(var s=o.length,u=0,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-h,2);return u/(s-1)}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},VARA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!1))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(B(l))t.push(l);else return g.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}for(var s=o.length,u=0,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-h,2);return u/(s-1)}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},VARPA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!1))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(B(l))t.push(l);else return g.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}for(var s=o.length,u=0,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-h,2);return u/s}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},STEYX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!1))}else if(N(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(D.getCellDataArr(arguments[0],"text",!1));else{if(!B(arguments[0]))return g.error.v;t.push(arguments[0])}var l=[];if(N(arguments[1])=="array"){if(N(arguments[1][0])=="array"&&!D.isDyadicArr(arguments[1]))return g.error.v;l=l.concat(D.getDataArr(arguments[1],!1))}else if(N(arguments[1])=="object"&&arguments[1].startCell!=null)l=l.concat(D.getCellDataArr(arguments[1],"text",!1));else{if(!B(arguments[1]))return g.error.v;l.push(arguments[1])}if(t.length!=l.length)return g.error.na;for(var o=[],a=[],e=0;e<t.length;e++){var s=t[e],u=l[e];B(s)&&B(u)&&(o.push(parseFloat(s)),a.push(parseFloat(u)))}if(o.length<3||a.length<3)return g.error.d;for(var h=jStat.mean(a),d=jStat.mean(o),m=a.length,p=0,v=0,y=0,e=0;e<m;e++)p+=Math.pow(o[e]-d,2),v+=(a[e]-h)*(o[e]-d),y+=Math.pow(a[e]-h,2);return Math.sqrt((p-v*v/y)/(m-2))}catch(b){var k=b;return k=g.errorInfo(k),[g.error.v,k]}},STANDARDIZE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseFloat(o),o<=0?g.error.nm:(t-l)/o):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},SMALL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!0))}else if(N(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(D.getCellDataArr(arguments[0],"number",!0));else{if(!B(arguments[0]))return g.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];B(o)&&l.push(parseFloat(o))}var a=D.getFirstValue(arguments[1]);return H(a)?a:B(a)?(a=parseInt(a),l.length==0?g.error.nm:a<=0||a>l.length?g.error.nm:l.sort(function(u,h){return u-h})[a-1]):g.error.v}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},SLOPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[];if(N(arguments[0])=="array"){if(N(arguments[0][0])=="array"&&!D.isDyadicArr(arguments[0]))return g.error.v;t=t.concat(D.getDataArr(arguments[0],!1))}else if(N(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(D.getCellDataArr(arguments[0],"text",!1));else{if(!B(arguments[0]))return g.error.v;t.push(arguments[0])}var l=[];if(N(arguments[1])=="array"){if(N(arguments[1][0])=="array"&&!D.isDyadicArr(arguments[1]))return g.error.v;l=l.concat(D.getDataArr(arguments[1],!1))}else if(N(arguments[1])=="object"&&arguments[1].startCell!=null)l=l.concat(D.getCellDataArr(arguments[1],"text",!1));else{if(!B(arguments[1]))return g.error.v;l.push(arguments[1])}if(t.length!=l.length)return g.error.na;for(var o=[],a=[],e=0;e<t.length;e++){var s=t[e],u=l[e];B(s)&&B(u)&&(o.push(parseFloat(s)),a.push(parseFloat(u)))}if(o.length<3||a.length<3)return g.error.d;for(var h=jStat.mean(a),d=jStat.mean(o),m=a.length,p=0,v=0,e=0;e<m;e++)p+=(a[e]-h)*(o[e]-d),v+=Math.pow(a[e]-h,2);return p/v}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},SKEW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else{if(!B(l))return g.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)&&o.push(parseFloat(a))}if(o.length<3||D.standardDeviation_s(o)==0)return g.error.d;for(var s=jStat.mean(o),u=o.length,h=0,e=0;e<u;e++)h+=Math.pow(o[e]-s,3);return u*h/((u-1)*(u-2)*Math.pow(jStat.stdev(o,!0),3))}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},SKEW_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;t=t.concat(D.getDataArr(l,!0))}else if(N(l)=="object"&&l.startCell!=null)t=t.concat(D.getCellDataArr(l,"number",!0));else{if(!B(l))return g.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];B(a)&&o.push(parseFloat(a))}if(o.length<3||D.standardDeviation_s(o)==0)return g.error.d;for(var s=jStat.mean(o),u=o.length,h=0,d=0,e=0;e<u;e++)d+=Math.pow(o[e]-s,3),h+=Math.pow(o[e]-s,2);return d=d/u,h=h/u,d/Math.pow(h,3/2)}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},ADDRESS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=1;if(arguments.length>=3){if(o=D.getFirstValue(arguments[2]),H(o))return o;if(!B(o))return g.error.v;o=parseInt(o)}var a=!0;if(arguments.length>=4&&(a=D.getCellBoolen(arguments[3]),H(a)))return a;if(t<=0||l<=0)return g.error.v;if([1,2,3,4].indexOf(o)==-1)return g.error.v;var s;if(a)switch(l=tt(l-1),o){case 1:s="$"+l+"$"+t;break;case 2:s=l+"$"+t;break;case 3:s="$"+l+t;break;case 4:s=l+t;break}else switch(o){case 1:s="R"+t+"C"+l;break;case 2:s="R"+t+"C["+l+"]";break;case 3:s="R["+t+"]C"+l;break;case 4:s="R["+t+"]C["+l+"]";break}if(arguments.length==5){var u=D.getFirstValue(arguments[4]);return H(u)?u:u+"!"+s}else return s}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},INDIRECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;var l=!0;if(arguments.length==2&&(l=D.getCellBoolen(arguments[1]),H(l)))return l;let a=At(),s=Z(f.calculateSheetIndex),u=a[s],h=u.data;if(g.iscelldata(t)){let d=g.getcellrange(t),m=d.row[0],p=d.column[0];if(m<0||m>=h.length||p<0||p>=h[0].length)return g.error.r;if(h[m][p]==null||me(h[m][p].v))return 0;let v=h[m][p].v;if(g.execFunctionGlobalData!=null){let k=g.execFunctionGlobalData[m+"_"+p+"_"+f.calculateSheetIndex];k!=null&&(v=k.v)}return{sheetName:u.name,startCell:t,rowl:m,coll:p,data:v}}else return g.error.r}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ROW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{if(arguments.length==1){var t;if(N(arguments[0])=="array")return g.error.v;if(N(arguments[0])=="object"&&arguments[0].startCell!=null?t=arguments[0].startCell:t=arguments[0],g.iscelldata(t)){var l=g.getcellrange(t);return l.row[0]+1}else return g.error.v}else return window.luckysheetCurrentRow+1}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ROWS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return N(arguments[0])=="array"?N(arguments[0][0])=="array"?arguments[0].length:1:N(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].rowl:1}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},COLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{if(arguments.length==1){var t;if(N(arguments[0])=="array")return g.error.v;if(N(arguments[0])=="object"&&arguments[0].startCell!=null?t=arguments[0].startCell:t=arguments[0],g.iscelldata(t)){var l=g.getcellrange(t);return l.column[0]+1}else return g.error.v}else return window.luckysheetCurrentColumn+1}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},COLUMNS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return N(arguments[0])=="array"?N(arguments[0][0])=="array"?arguments[0][0].length:arguments[0].length:N(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].coll:1}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},OFFSET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{if(!(N(arguments[0])=="object"&&arguments[0].startCell!=null))return g.error.v;var t=arguments[0].startCell;let x=arguments[0].sheetName;var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=arguments[0].rowl;if(arguments.length>=4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseInt(a)}var s=arguments[0].coll;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseInt(s)}if(a<1||s<1)return g.error.r;var u=g.getcellrange(t),h=u.row[0],d=u.column[0];h+=l,d+=o;var m=h+a-1,p=d+s-1;let C=At(),S=Z(f.calculateSheetIndex),_=C[S].data;if(h<0||m>=_.length||d<0||p>=_[0].length)return g.error.r;for(var v=[],y=h;y<=m;y++){for(var k=[],b=d;b<=p;b++)if(g.execFunctionGlobalData!=null&&g.execFunctionGlobalData[y+"_"+b+"_"+f.calculateSheetIndex]!=null){let F=g.execFunctionGlobalData[y+"_"+b+"_"+f.calculateSheetIndex];F!=null?k.push(F.v):k.push(0)}else _[y][b]!=null&&!me(_[y][b].v)?k.push(_[y][b].v):k.push(0);v.push(k)}return{sheetName:x,startCell:Mt(f.calculateSheetIndex,{row:[h,m],column:[d,p]}),rowl:h,coll:d,data:v}}catch(x){var w=x;return w=g.errorInfo(w),[g.error.v,w]}},MATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=arguments[1],o=[];if(N(l)=="array"){if(N(l[0])=="array")return D.isDyadicArr(l)?g.error.na:g.error.v;for(var e=0;e<l.length;e++)o.push(l[e])}else if(N(l)=="object"&&l.startCell!=null){if(l.rowl>1&&l.coll>1)return g.error.na;if(l.data!=null)if(N(l.data)=="array")for(var e=0;e<l.data.length;e++)for(var a=0;a<l.data[e].length;a++)l.data[e][a]!=null&&!me(l.data[e][a].v)&&o.push(l.data[e][a].v);else o.push(l.data.v)}var s=1;if(arguments.length==3){if(s=D.getFirstValue(arguments[2]),H(s))return s;if(!B(s))return g.error.v;s=Math.ceil(parseFloat(s))}if([-1,0,1].indexOf(s)==-1)return g.error.na;for(var u,h,d=0;d<o.length;d++)if(s===1){if(o[d]===t)return d+1;o[d]<t&&(h?o[d]>h&&(u=d+1,h=o[d]):(u=d+1,h=o[d]))}else if(s===0){if(typeof t=="string"){if(t=t.replace(/\?/g,"."),o[d].toLowerCase().match(t.toLowerCase()))return d+1}else if(o[d]===t)return d+1}else if(s===-1){if(o[d]===t)return d+1;o[d]>t&&(h?o[d]<h&&(u=d+1,h=o[d]):(u=d+1,h=o[d]))}return u||g.error.na}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},VLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;if(t.toString().replace(/\s/g,"")=="")return g.error.na;var l=arguments[1],o=[];if(N(l)=="array")if(N(l[0])=="array"){if(!D.isDyadicArr(l))return g.error.v;for(var e=0;e<l.length;e++){for(var a=[],s=0;s<l[e].length;s++)a.push(l[e][s]);o.push(a)}}else{for(var a=[],e=0;e<l.length;e++)a.push(l[e]);o.push(a)}else if(N(l)=="object"&&l.startCell!=null)o=D.getCellDataDyadicArr(l,"text");else return g.error.v;var u=D.getFirstValue(arguments[2]);if(H(u))return u;if(!B(u))return g.error.v;u=parseInt(u);var h=!0;if(arguments.length==4&&(h=D.getCellBoolen(arguments[3]),H(h)))return h;if(u<1)return g.error.v;if(u>o[0].length)return g.error.r;if(h){o=Hr(o,0,!0);for(var d=0;d<o.length;d++){var m=o[d][0],p;if(zt(t)&&zt(m)?p=ul(t,m):B(t)&&B(m)?p=(0,qo.default)(t).value()-(0,qo.default)(m).value():!B(t)&&!B(m)?p=t.localeCompare(m,"zh"):B(t)?B(m)||(p=-1):p=1,p<0)return d==0?g.error.na:o[d-1][u-1];if(d==o.length-1)return o[d][u-1]}}else{for(var v=null,d=0;d<o.length;d++)if(t.toString()==o[d][0].toString()){v=d;break}return v==null?g.error.na:o[v][u-1]}}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},HLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=arguments[0];typeof o=="object"&&(o=arguments[0].data,N(o)=="array"?(o=o[r],N(o)=="array"&&(o=o[d])):o=o.v);var a=arguments[1].data,s=arguments[2],u=!1;if(arguments.length>3&&(u=!!arguments[3]),s>a.rowl)return[g.error.v,"\u7D22\u5F15\u8D85\u8FC7\u4E86\u8303\u56F4\u7684\u957F\u5EA6\uFF0C"+a[0].length];if(s<1)return[g.error.v,"\u7D22\u5F15\u5FC5\u987B\u5927\u4E8E1"];for(var h=g.error.na,d=0;d<a[0].length;d++){var m=Le(0,d,a),p=Le(s-1,d,a);if(u)m.indexOf(o)>-1&&(h=p);else if(g.acompareb(m,o))return h=p,h}return h}catch(y){var v=y;return v=g.errorInfo(v),[g.error.v,v]}},LOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let k=function(b,w){return w-b};var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=arguments[0];typeof o=="object"&&(o=arguments[0].data,N(o)=="array"?(o=o[r],N(o)=="array"&&(o=o[c])):o=o.v);var a=arguments[1].data,s,u=g.error.na;if(a=g.getRangeArray(a)[0],arguments[2]&&(s=arguments[2].data,s=g.getRangeArray(s)[0]),typeof o=="string")for(var e=0;e<a.length;e++){var h=a[e],d;arguments[2]?(d=s[e],h==o&&(u=d)):g.acompareb(h,o)&&(u=h)}else if(tr(o)=="num"){for(var m=[],e=0;e<a.length;e++){var h=a[e],d;if(arguments[2]){if(d=s[e],h==o)return u=d,u;h!=o&&tr(h)=="num"&&m.push(h)}else{if(h==o)return u=h,u;h!=o&&tr(h)=="num"&&m.push(h)}}if(m.length!=0){m.push(o),m.sort(k);var p=m.indexOf(o);if(p==m.length-1)return[g.error.na,"\u627E\u4E0D\u5230\u5BF9\u5E94\u53C2\u6570"];var v=m[p+1];if(arguments[2]){var e=a.indexOf(v);u=s[e]}else u=v}}return u}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},INDEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];let v=!1;if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else N(t)=="object"&&t.startCell!=null&&(l=D.getCellDataDyadicArr(t,"number"),v=!0);var o=l.length,a=l[0].length,s=D.getFirstValue(arguments[1]);if(H(s))return s;if(!B(s))return g.error.v;s=parseInt(s);var u=D.getFirstValue(arguments[2]);if(H(u))return u;if(s<0||B(u)&&u<0)return g.error.v;if(s>o||B(u)&&u>a)return g.error.r;if(v){var h=g.getcellrange(t.startCell),d=h.row[0],m=h.column[0];let y=l;s==0||u==0?(s==0?(y=l[0],s=1):y=l[s-1],B(u)?u==0?(y=y[0],u=1):y=y[u-1]:u=1):(B(s)||(s=1),B(u)||(u=1),y=l[s-1][u-1]);let k=d+s-1,b=m+u-1;return{sheetName:t.sheetName,startCell:Mt(f.calculateSheetIndex,{row:[k,k],column:[b,b]}),rowl:k,coll:b,data:y}}else return B(u)?(u=parseInt(u),s<=0||u<=0?g.error.v:l[s-1][u-1]):g.error.v}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},GETPIVOTDATA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return g.error.v}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},CHOOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;if(t=parseInt(t),t<1||t>arguments.length-1)return g.error.v;var l=arguments[t];if(N(l)=="array")return N(l[0])=="array"&&!D.isDyadicArr(l)?g.error.v:l;if(N(l)=="object"&&l.startCell!=null){if(l.data==null)return 0;if(N(l.data)=="array"){var o=D.getCellDataDyadicArr(l.data,"number");return o}else return me(l.data.v)?0:l.data.v}else return l}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},HYPERLINK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return g.error.v}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},TIME:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;if(o=parseInt(o),t<0||t>32767)return g.error.nm;if(t>24&&(t=t%24),l<0||l>32767)return g.error.nm;if(o<0||o>32767)return g.error.nm;var a=(0,j.default)().set({hour:t,minute:l,second:o});return(0,j.default)(a).format("h:mm:ss a")}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},TIMEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);return H(t)?t:(0,j.default)(t).isValid()?(3600*(0,j.default)(t).get("hour")+60*(0,j.default)(t).get("minute")+(0,j.default)(t).get("second"))/86400:g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},EOMONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;if(l=parseInt(l),!(0,j.default)(t).isValid())return g.error.v;var o=(0,j.default)(t).add(l+1,"months").set("date",1).subtract(1,"days"),a=nt((0,j.default)(o).format("YYYY-MM-DD H:mm:ss")),s=a[2];return s}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},EDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;if(l=parseInt(l),!(0,j.default)(t).isValid())return g.error.v;var o=(0,j.default)(t).add(l,"months"),a=nt((0,j.default)(o).format("YYYY-MM-DD h:mm:ss")),s=a[2];return s}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},SECOND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=(0,j.default)(t).seconds();return l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},MINUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=(0,j.default)(t).minutes();return l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},HOUR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=(0,j.default)(t).hours();return l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},NOW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return(0,j.default)().format("YYYY-M-D HH:mm")}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},NETWORKDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{if(arguments.length==3)var t=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1,arguments[2]);else var t=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1);return t}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},NETWORKDAYS_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],l=D.getCellDate(arguments[0]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getCellDate(arguments[1]);if(H(o))return o;if(!(0,j.default)(o).isValid())return g.error.v;var a=t[1];if(arguments.length>=3&&(a=arguments[2],!(typeof a=="string"&&a.length=="7"&&/^[0-1]{7}$/g.test(a)))){if(a=D.getFirstValue(arguments[2]),H(a))return a;if(!B(a))return g.error.v;if(a=parseInt(a),a<1||a>7&&a<11||a>17)return g.error.nm;a=t[a]}var s=[];if(arguments.length==4&&(s=D.getCellrangeDate(arguments[3]),H(s)))return s;for(var e=0;e<s.length;e++)if(!(0,j.default)(s[e]).isValid())return g.error.v;var u=(0,j.default)(o).diff((0,j.default)(l),"days")+1,h=u,d=(0,j.default)(l);for(e=0;e<u;e++){var m=(0,j.default)(d).weekday(),p=!1;N(a)=="array"?(m===a[0]||m===a[1])&&(p=!0):(m==0&&(m=7),a.charAt(m-1)=="0"&&(p=!0));for(var v=0;v<s.length;v++)if((0,j.default)(d).diff((0,j.default)(s[v]),"days")===0){p=!0;break}p&&h--,d=(0,j.default)(d).add(1,"days")}return h}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},ISOWEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);return H(t)?t:(0,j.default)(t).isValid()?(0,j.default)(t).isoWeeks():g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},WEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[void 0,7,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,7],l=D.getCellDate(arguments[0]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=1;if(arguments.length==2){if(o=D.getFirstValue(arguments[1]),H(o))return o;if(!B(o))return g.error.v;o=parseInt(o)}if(o==21)return window.luckysheet_function.ISOWEEKNUM.f(arguments[0]);if([1,2,11,12,13,14,15,16,17].indexOf(o)==-1)return g.error.nm;var a=t[o],s=(0,j.default)(l).isoWeekday()>=a?1:0,u=(0,j.default)(l).isoWeeks()+s;return u}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},WEEKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=D.getCellDate(arguments[0]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=1;if(arguments.length==2){if(o=D.getFirstValue(arguments[1]),H(o))return o;if(!B(o))return g.error.v;o=parseInt(o)}if([1,2,3,11,12,13,14,15,16,17].indexOf(o)==-1)return g.error.nm;var a=t[o][(0,j.default)(l).day()];return a}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},DAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);return H(t)?t:(0,j.default)(t).isValid()?(0,j.default)(t).date():g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},DAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=(0,j.default)(t).diff((0,j.default)(l),"days");return o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},DAYS360:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=!1;if(arguments.length==3&&(o=D.getCellBoolen(arguments[2]),H(o)))return o;var a=(0,j.default)(t).month(),s=(0,j.default)(l).month(),u,h;if(o)u=(0,j.default)(t).date()===31?30:(0,j.default)(t).date(),h=(0,j.default)(l).date()===31?30:(0,j.default)(l).date();else{var d=(0,j.default)().set({year:(0,j.default)(t).year(),month:a+1,date:0}).date(),m=(0,j.default)().set({year:(0,j.default)(l).year(),month:s+1,date:0}).date();u=(0,j.default)(t).date()===d?30:(0,j.default)(t).date(),(0,j.default)(l).date()===m?u<30?(s++,h=1):h=30:h=(0,j.default)(l).date()}var p=360*(0,j.default)(l).diff((0,j.default)(t),"years")+30*(s-a)+(h-u);return p}catch(y){var v=y;return v=g.errorInfo(v),[g.error.v,v]}},DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;if(o=parseInt(o),t<0||t>=1e4)return g.error.nm;t>=0&&t<=1899&&(t=t+1900);var a=(0,j.default)().set({year:t,month:l-1,date:o});return(0,j.default)(a).year()<1900?g.error.nm:(0,j.default)(a).format("YYYY-MM-DD")}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},DATEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;t=(0,j.default)(t).format("YYYY-MM-DD");var l=nt(t)[2];return l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},DATEDIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var e=0;e<arguments.length-1;e++)if(arguments[e]=D.getCellDate(arguments[e]),!zt(arguments[e]))return g.error.v;var t=(0,j.default)(arguments[0]),l=(0,j.default)(arguments[1]),o=arguments[2],a=g.error.v;if(window.luckysheet_function.DAYS.f(l,t)<0)return g.error.v;switch(o){case"Y":case"y":a=l.diff(t,"years",!1);break;case"M":case"m":a=l.diff(t,"months",!1);break;case"D":case"d":a=l.diff(t,"days",!1);break;case"MD":case"md":a=l.format("DD")-t.format("DD");break;case"YM":case"ym":var s=parseInt(t.format("M")),u=parseInt(l.format("M"));a=s<=u?u-s:u+12-s;break;case"YD":case"yd":let d=`${l.$y}-MM-DD`;var s=nt(t.format(d))[2],u=nt(l.format(d))[2];a=s<=u?u-s:u+365-s;break;default:a=g.error.v}return a}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},WORKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{if(arguments.length==3)var t=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1,arguments[2]);else var t=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1);return t}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},WORKDAY_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],l=D.getCellDate(arguments[0]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[1]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=t[1];if(arguments.length>=3&&(a=arguments[2],!(typeof a=="string"&&a.length=="7"&&/^[0-1]{7}$/g.test(a)))){if(a=D.getFirstValue(arguments[2]),H(a))return a;if(!B(a))return g.error.v;if(a=parseInt(a),a<1||a>7&&a<11||a>17)return g.error.nm;a=t[a]}var s=[];if(arguments.length==4&&(s=D.getCellrangeDate(arguments[3]),H(s)))return s;for(var e=0;e<s.length;e++)if(!(0,j.default)(s[e]).isValid())return g.error.v;for(var u=0;u<o;){l=(0,j.default)(l).add(1,"days");var h=(0,j.default)(l).weekday();if(N(a)){if(h===a[0]||h===a[1])continue}else if(h==0&&(h=7),a.charAt(h-1)=="0")continue;for(var d=0;d<s.length;d++)if((0,j.default)(l).diff((0,j.default)(s[d]),"days")===0){u--;break}u++}return(0,j.default)(l).format("YYYY-MM-DD")}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},YEAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);return H(t)?t:(0,j.default)(t).isValid()?(0,j.default)(t).year():g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},YEARFRAC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=0;if(arguments.length==3){if(o=D.getFirstValue(arguments[2]),H(o))return o;if(!B(o))return g.error.v;o=parseInt(o)}if(o<0||o>4)return g.error.nm;var a=(0,j.default)(t).date(),s=(0,j.default)(t).month()+1,u=(0,j.default)(t).year(),h=(0,j.default)(l).date(),d=(0,j.default)(l).month()+1,m=(0,j.default)(l).year(),p;switch(o){case 0:a===31&&h===31?(a=30,h=30):a===31?a=30:a===30&&h===31&&(h=30),p=(h+d*30+m*360-(a+s*30+u*360))/360;break;case 1:var v=365;if(u===m||u+1===m&&(s>d||s===d&&a>=h))return(u===m&&D.isLeapYear(u)||D.feb29Between(t,l)||d===1&&h===29)&&(v=366),(0,j.default)(l).diff((0,j.default)(t),"days")/v;var y=m-u+1,k=((0,j.default)().set({year:m+1,month:0,date:1})-(0,j.default)().set({year:u,month:0,date:1}))/1e3/60/60/24,b=k/y;p=(0,j.default)(l).diff((0,j.default)(t),"days")/b;break;case 2:p=(0,j.default)(l).diff((0,j.default)(t),"days")/360;break;case 3:p=(0,j.default)(l).diff((0,j.default)(t),"days")/365;break;case 4:p=(h+d*30+m*360-(a+s*30+u*360))/360;break}return p}catch(x){var w=x;return w=g.errorInfo(w),[g.error.v,w]}},TODAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return(0,j.default)().format("YYYY-MM-DD")}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},MONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);return H(t)?t:(0,j.default)(t).isValid()?(0,j.default)(t).month()+1:g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},EFFECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),t<=0||l<1?g.error.nm:Math.pow(1+t/l,l)-1):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},DOLLAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=2;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}l>9&&(l=9);for(var o="0.",e=1;e<=l;e++)o+="0";var a=t>0?1:-1;return a*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},DOLLARDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;if(l=parseInt(l),l<0)return g.error.nm;if(l==0)return g.error.d;var o=parseInt(t,10);o+=t%1*Math.pow(10,Math.ceil(Math.log(l)/Math.LN10))/l;var a=Math.pow(10,Math.ceil(Math.log(l)/Math.LN2)+1);return o=Math.round(o*a)/a,o}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},DOLLARFR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;if(l=parseInt(l),l<0)return g.error.nm;if(l==0)return g.error.d;var o=parseInt(t,10);return o+=t%1*Math.pow(10,-Math.ceil(Math.log(l)/Math.LN10))*l,o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},DB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseInt(a);var s=12;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseInt(s)}if(t<0||l<0||o<0||a<0)return g.error.nm;if(s<1||s>12)return g.error.nm;if(a>o)return g.error.nm;if(l>=t)return 0;for(var u=(1-Math.pow(l/t,1/o)).toFixed(3),h=t*u*s/12,d=h,m=0,p=a===o?o-1:a,e=2;e<=p;e++)m=(t-d)*u,d+=m;if(a===1)var v=h;else if(a===o)var v=(t-d)*u;else var v=m;return v}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},DDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseInt(a);var s=2;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}if(t<0||l<0||o<0||a<0||s<=0)return g.error.nm;if(a>o)return g.error.nm;if(l>=t)return 0;for(var u=0,h=0,e=1;e<=a;e++)h=Math.min((t-u)*(s/o),t-l-u),u+=h;return h}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},RATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}var u=.1;if(arguments.length==6){if(u=D.getFirstValue(arguments[5]),H(u))return u;if(!B(u))return g.error.v;u=parseFloat(u)}if(s!=0&&s!=1)return g.error.nm;for(var h=1e-6,d=100,m=0,p=!1,v=u;m<d&&!p;){var y=Math.pow(v+1,t),k=Math.pow(v+1,t-1),b=a+y*o+l*(y-1)*(v*s+1)/v,w=t*k*o-l*(y-1)*(v*s+1)/Math.pow(v,2),x=t*l*k*(v*s+1)/v+l*(y-1)*s/v,C=v-b/(w+x);Math.abs(C-v)<h&&(p=!0),m++,v=C}return p?v:g.error.nm}catch(_){var S=_;return S=g.errorInfo(S),[g.error.v,S]}},CUMPRINC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseInt(a);var s=D.getFirstValue(arguments[4]);if(H(s))return s;if(!B(s))return g.error.v;s=parseInt(s);var u=D.getFirstValue(arguments[5]);if(H(u))return u;if(!B(u))return g.error.v;if(u=parseFloat(u),t<=0||l<=0||o<=0)return g.error.nm;if(a<1||s<1||a>s)return g.error.nm;if(u!=0&&u!=1)return g.error.nm;var h=window.luckysheet_function.PMT.f(t,l,o,0,u),d=0;a===1&&(u===0?d=h+o*t:d=h,a++);for(var e=a;e<=s;e++)u>0?d+=h-(window.luckysheet_function.FV.f(t,e-2,h,o,1)-h)*t:d+=h-window.luckysheet_function.FV.f(t,e-1,h,o,0)*t;return d}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},COUPNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=0;if(arguments.length==4){var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return g.error.nm;if(a<0||a>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var s=(0,j.default)(t).date(),u=(0,j.default)(t).month()+1,h=(0,j.default)(t).year(),d=(0,j.default)(l).date(),m=(0,j.default)(l).month()+1,p=(0,j.default)(l).year(),v;switch(a){case 0:s===31&&d===31?(s=30,d=30):s===31?s=30:s===30&&d===31&&(d=30),v=(d+m*30+p*360-(s+u*30+h*360))/(360/o);break;case 1:var y=365;if(h===p||h+1===p&&(u>m||u===m&&s>=d))return(h===p&&D.isLeapYear(h)||D.feb29Between(t,l)||m===1&&d===29)&&(y=366),(0,j.default)(l).diff((0,j.default)(t),"days")/(y/o);var k=p-h+1,b=((0,j.default)().set({year:p+1,month:0,date:1})-(0,j.default)().set({year:h,month:0,date:1}))/1e3/60/60/24,w=b/k;v=(0,j.default)(l).diff((0,j.default)(t),"days")/(w/o);break;case 2:v=(0,j.default)(l).diff((0,j.default)(t),"days")/(360/o);break;case 3:v=(0,j.default)(l).diff((0,j.default)(t),"days")/(365/o);break;case 4:v=(d+m*30+p*360-(s+u*30+h*360))/(360/o);break}return Math.round(v)}catch(C){var x=C;return x=g.errorInfo(x),[g.error.v,x]}},SYD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);return H(a)?a:B(a)?(a=parseInt(a),o==0?g.error.nm:a<1||a>o?g.error.nm:(t-l)*(o-a+1)*2/(o*(o+1))):g.error.v}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},TBILLEQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseFloat(o),o<=0?g.error.nm:(0,j.default)(t)-(0,j.default)(l)>0?g.error.nm:(0,j.default)(l)-(0,j.default)(t)>365*24*60*60*1e3?g.error.nm:365*o/(360-o*(0,j.default)(l).diff((0,j.default)(t),"days"))):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},TBILLYIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseFloat(o),o<=0?g.error.nm:(0,j.default)(t)-(0,j.default)(l)>=0?g.error.nm:(0,j.default)(l)-(0,j.default)(t)>365*24*60*60*1e3?g.error.nm:(100-o)/o*(360/(0,j.default)(l).diff((0,j.default)(t),"days"))):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},TBILLPRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseFloat(o),o<=0?g.error.nm:(0,j.default)(t)-(0,j.default)(l)>0?g.error.nm:(0,j.default)(l)-(0,j.default)(t)>365*24*60*60*1e3?g.error.nm:100*(1-o*(0,j.default)(l).diff((0,j.default)(t),"days")/360)):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},PV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return g.error.nm;if(t===0)var u=-o*l-a;else var u=((1-Math.pow(1+t,l))/t*o*(1+t*s)-a)/Math.pow(1+t,l);return u}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},ACCRINT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getCellDate(arguments[2]);if(H(o))return o;if(!(0,j.default)(o).isValid())return g.error.v;var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=D.getFirstValue(arguments[4]);if(H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s);var u=D.getFirstValue(arguments[5]);if(H(u))return u;if(!B(u))return g.error.v;u=parseInt(u);var h=0;if(arguments.length>=7){if(h=D.getFirstValue(arguments[6]),H(h))return h;if(!B(h))return g.error.v;h=parseInt(h)}var d=!0;if(arguments.length==8&&(d=D.getCellBoolen(arguments[7]),H(d)))return d;if(a<=0||s<=0)return g.error.nm;if(u!=1&&u!=2&&u!=4)return g.error.nm;if(h<0||h>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(o)>=0)return g.error.nm;var m;if((0,j.default)(o)-(0,j.default)(l)>=0&&!d){var p=(0,j.default)(l).date(),v=(0,j.default)(l).month()+1,y=(0,j.default)(l).year(),k=(0,j.default)(o).date(),b=(0,j.default)(o).month()+1,w=(0,j.default)(o).year();switch(h){case 0:p===31&&k===31?(p=30,k=30):p===31?p=30:p===30&&k===31&&(k=30),m=(k+b*30+w*360-(p+v*30+y*360))/360;break;case 1:var x=365;if(y===w||y+1===w&&(v>b||v===b&&p>=k))return(y===w&&D.isLeapYear(y)||D.feb29Between(l,o)||b===1&&k===29)&&(x=366),(0,j.default)(o).diff((0,j.default)(l),"days")/x;var C=w-y+1,S=((0,j.default)().set({year:w+1,month:0,date:1})-(0,j.default)().set({year:y,month:0,date:1}))/1e3/60/60/24,_=S/C;m=(0,j.default)(o).diff((0,j.default)(l),"days")/_;break;case 2:m=(0,j.default)(o).diff((0,j.default)(l),"days")/360;break;case 3:m=(0,j.default)(o).diff((0,j.default)(l),"days")/365;break;case 4:m=(k+b*30+w*360-(p+v*30+y*360))/360;break}}else{var p=(0,j.default)(t).date(),v=(0,j.default)(t).month()+1,y=(0,j.default)(t).year(),k=(0,j.default)(o).date(),b=(0,j.default)(o).month()+1,w=(0,j.default)(o).year();switch(h){case 0:p===31&&k===31?(p=30,k=30):p===31?p=30:p===30&&k===31&&(k=30),m=(k+b*30+w*360-(p+v*30+y*360))/360;break;case 1:var x=365;if(y===w||y+1===w&&(v>b||v===b&&p>=k))return(y===w&&D.isLeapYear(y)||D.feb29Between(t,o)||b===1&&k===29)&&(x=366),(0,j.default)(o).diff((0,j.default)(t),"days")/x;var C=w-y+1,S=((0,j.default)().set({year:w+1,month:0,date:1})-(0,j.default)().set({year:y,month:0,date:1}))/1e3/60/60/24,_=S/C;m=(0,j.default)(o).diff((0,j.default)(t),"days")/_;break;case 2:m=(0,j.default)(o).diff((0,j.default)(t),"days")/360;break;case 3:m=(0,j.default)(o).diff((0,j.default)(t),"days")/365;break;case 4:m=(k+b*30+w*360-(p+v*30+y*360))/360;break}}return s*a*m}catch(F){var T=F;return T=g.errorInfo(T),[g.error.v,T]}},ACCRINTM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseInt(s)}if(o<=0||a<=0)return g.error.nm;if(s<0||s>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var u=(0,j.default)(t).date(),h=(0,j.default)(t).month()+1,d=(0,j.default)(t).year(),m=(0,j.default)(l).date(),p=(0,j.default)(l).month()+1,v=(0,j.default)(l).year(),y;switch(s){case 0:u===31&&m===31?(u=30,m=30):u===31?u=30:u===30&&m===31&&(m=30),y=(m+p*30+v*360-(u+h*30+d*360))/360;break;case 1:var k=365;if(d===v||d+1===v&&(h>p||h===p&&u>=m))return(d===v&&D.isLeapYear(d)||D.feb29Between(t,l)||p===1&&m===29)&&(k=366),(0,j.default)(l).diff((0,j.default)(t),"days")/k;var b=v-d+1,w=((0,j.default)().set({year:v+1,month:0,date:1})-(0,j.default)().set({year:d,month:0,date:1}))/1e3/60/60/24,x=w/b;y=(0,j.default)(l).diff((0,j.default)(t),"days")/x;break;case 2:y=(0,j.default)(l).diff((0,j.default)(t),"days")/360;break;case 3:y=(0,j.default)(l).diff((0,j.default)(t),"days")/365;break;case 4:y=(m+p*30+v*360-(u+h*30+d*360))/360;break}return a*o*y}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},COUPDAYBS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return g.error.nm;if(a<0||a>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;for(var s,u=Math.ceil((0,j.default)(l).diff((0,j.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var h=(0,j.default)(l).subtract(12/o*e,"months");if(h<=(0,j.default)(t)){s=h;break}}var d;switch(a){case 0:var m=(0,j.default)(s).date(),p=(0,j.default)(s).month()+1,v=(0,j.default)(s).year(),y=(0,j.default)(t).date(),k=(0,j.default)(t).month()+1,b=(0,j.default)(t).year();m===31&&y===31?(m=30,y=30):m===31?m=30:m===30&&y===31&&(y=30),d=y+k*30+b*360-(m+p*30+v*360);break;case 1:case 2:case 3:d=(0,j.default)(t).diff((0,j.default)(s),"days");break;case 4:var m=(0,j.default)(s).date(),p=(0,j.default)(s).month()+1,v=(0,j.default)(s).year(),y=(0,j.default)(t).date(),k=(0,j.default)(t).month()+1,b=(0,j.default)(t).year();d=y+k*30+b*360-(m+p*30+v*360);break}return d}catch(x){var w=x;return w=g.errorInfo(w),[g.error.v,w]}},COUPDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return g.error.nm;if(a<0||a>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var s;switch(a){case 0:s=360/o;break;case 1:for(var u=Math.ceil((0,j.default)(l).diff((0,j.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var h=(0,j.default)(l).subtract(12/o*e,"months");if(h<=(0,j.default)(t)){var d=(0,j.default)(l).subtract(12/o*(e-1),"months");s=(0,j.default)(d).diff((0,j.default)(h),"days");break}}break;case 2:s=360/o;break;case 3:s=365/o;break;case 4:s=360/o;break}return s}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},COUPDAYSNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return g.error.nm;if(a<0||a>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;for(var s,u=Math.ceil((0,j.default)(l).diff((0,j.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var h=(0,j.default)(l).subtract(12/o*e,"months");if(h<=(0,j.default)(t)){s=(0,j.default)(l).subtract(12/o*(e-1),"months");break}}var d;switch(a){case 0:var m=(0,j.default)(t).date(),p=(0,j.default)(t).month()+1,v=(0,j.default)(t).year(),y=(0,j.default)(s).date(),k=(0,j.default)(s).month()+1,b=(0,j.default)(s).year();m===31&&y===31?(m=30,y=30):m===31?m=30:m===30&&y===31&&(y=30),d=y+k*30+b*360-(m+p*30+v*360);break;case 1:case 2:case 3:d=(0,j.default)(s).diff((0,j.default)(t),"days");break;case 4:var m=(0,j.default)(t).date(),p=(0,j.default)(t).month()+1,v=(0,j.default)(t).year(),y=(0,j.default)(s).date(),k=(0,j.default)(s).month()+1,b=(0,j.default)(s).year();d=y+k*30+b*360-(m+p*30+v*360);break}return d}catch(x){var w=x;return w=g.errorInfo(w),[g.error.v,w]}},COUPNCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return g.error.nm;if(a<0||a>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;for(var s,u=Math.ceil((0,j.default)(l).diff((0,j.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var h=(0,j.default)(l).subtract(12/o*e,"months");if(h<=(0,j.default)(t)){s=(0,j.default)(l).subtract(12/o*(e-1),"months");break}}return(0,j.default)(s).format("YYYY-MM-DD")}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},COUPPCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return g.error.nm;if(a<0||a>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;for(var s,u=Math.ceil((0,j.default)(l).diff((0,j.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var h=(0,j.default)(l).subtract(12/o*e,"months");if(h<=(0,j.default)(t)){s=h;break}}return(0,j.default)(s).format("YYYY-MM-DD")}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},FV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return g.error.nm;var u;if(t===0)u=a+o*l;else{var h=Math.pow(1+t,l);s===1?u=a*h+o*(1+t)*(h-1)/t:u=a*h+o*(h-1)/t}return-u}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},FVSCHEDULE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;o=o.concat(D.getDataArr(l,!1))}else N(l)=="object"&&l.startCell!=null?o=o.concat(D.getCellDataArr(l,"number",!1)):o.push(l);for(var a=[],e=0;e<o.length;e++){var s=o[e];if(!B(s))return g.error.v;a.push(parseFloat(s))}for(var u=a.length,h=t,e=0;e<u;e++)h*=1+a[e];return h}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},YIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=D.getFirstValue(arguments[4]);if(H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s);var u=D.getFirstValue(arguments[5]);if(H(u))return u;if(!B(u))return g.error.v;u=parseInt(u);var h=0;if(arguments.length==7){if(h=D.getFirstValue(arguments[6]),H(h))return h;if(!B(h))return g.error.v;h=parseInt(h)}if(o<0)return g.error.nm;if(a<=0||s<=0)return g.error.nm;if(u!=1&&u!=2&&u!=4)return g.error.nm;if(h<0||h>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var d=window.luckysheet_function.COUPNUM.f(t,l,u,h);if(d>1){for(var m=1,p=0,v=m,e=1;e<=100;e++){var y=window.luckysheet_function.PRICE.f(t,l,o,v,s,u,h);if(Math.abs(y-a)<1e-6)break;y>a?p=v:m=v,v=(m+p)/2}var k=v}else var b=window.luckysheet_function.COUPDAYSNC.f(t,l,u,h),w=window.luckysheet_function.COUPDAYS.f(t,l,u,h),x=window.luckysheet_function.COUPDAYBS.f(t,l,u,h),C=s/100+o/u,S=a/100+x/w*(o/u),_=u*w/b,k=(C-S)/S*_;return k}catch(F){var T=F;return T=g.errorInfo(T),[g.error.v,T]}},YIELDDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseInt(s)}if(o<=0||a<=0)return g.error.nm;if(s<0||s>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var u=window.luckysheet_function.YEARFRAC.f(t,l,s);return(a/o-1)/u}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},NOMINAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),t<=0||l<1?g.error.nm:(Math.pow(t+1,1/l)-1)*l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},XIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!B(a))return g.error.v;o.push(parseFloat(a))}var s=D.getCellrangeDate(arguments[1]);if(H(s))return s;for(var e=0;e<s.length;e++)if(!(0,j.default)(s[e]).isValid())return g.error.v;var u=.1;if(arguments.length==3){if(u=D.getFirstValue(arguments[2]),H(u))return u;if(!B(u))return g.error.v;u=parseFloat(u)}for(var h=!1,d=!1,e=0;e<o.length&&(o[e]>0&&(h=!0),o[e]<0&&(d=!0),!(h&&d));e++);if(!h||!d)return g.error.nm;if(o.length!=s.length)return g.error.nm;var m=function(S,_,T){for(var F=T+1,R=S[0],I=1;I<S.length;I++)R+=S[I]/Math.pow(F,window.luckysheet_function.DAYS.f(_[I],_[0])/365);return R},p=function(S,_,T){for(var F=T+1,R=0,I=1;I<S.length;I++){var P=window.luckysheet_function.DAYS.f(_[I],_[0])/365;R-=P*S[I]/Math.pow(F,P+1)}return R},v=u,y=1e-10,k,b,w,x=!0;do w=m(o,s,v),k=v-w/p(o,s,v),b=Math.abs(k-v),v=k,x=b>y&&Math.abs(w)>y;while(x);return v}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},MIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!B(a))return g.error.v;o.push(parseFloat(a))}var s=D.getFirstValue(arguments[1]);if(H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s);var u=D.getFirstValue(arguments[2]);if(H(u))return u;if(!B(u))return g.error.v;u=parseFloat(u);for(var h=o.length,d=[],m=[],e=0;e<h;e++)o[e]<0?d.push(o[e]):m.push(o[e]);if(d.length==0||m.length==0)return g.error.d;var p=-window.luckysheet_function.NPV.f(u,m)*Math.pow(1+u,h-1),v=window.luckysheet_function.NPV.f(s,d)*(1+s);return Math.pow(p/v,1/(h-1))-1}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},IRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!B(a))return g.error.v;o.push(parseFloat(a))}var s=.1;if(arguments.length==2){if(s=D.getFirstValue(arguments[1]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}for(var u=[],h=!1,d=!1,e=0;e<l.length;e++)u[e]=e===0?0:u[e-1]+365,l[e]>0&&(h=!0),l[e]<0&&(d=!0);if(!h||!d)return g.error.nm;var m=function(S,_,T){for(var F=T+1,R=S[0],I=1;I<S.length;I++)R+=S[I]/Math.pow(F,(_[I]-_[0])/365);return R},p=function(S,_,T){for(var F=T+1,R=0,I=1;I<S.length;I++){var P=(_[I]-_[0])/365;R-=P*S[I]/Math.pow(F,P+1)}return R},v=s,y=1e-10,k,b,w,x=!0;do w=m(o,u,v),k=v-w/p(o,u,v),b=Math.abs(k-v),v=k,x=b>y&&Math.abs(w)>y;while(x);return v}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},NPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);for(var l=[],e=1;e<arguments.length;e++){var o=arguments[e];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;l=l.concat(D.getDataArr(o,!0))}else N(o)=="object"&&o.startCell!=null?l=l.concat(D.getCellDataArr(o,"number",!0)):l.push(o)}for(var a=[],e=0;e<l.length;e++){var s=l[e];B(s)&&a.push(parseFloat(s))}var u=0;if(a.length>0)for(var e=0;e<a.length;e++)u+=a[e]/Math.pow(1+t,e+1);return u}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},XNPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(N(l)=="array"){if(N(l[0])=="array"&&!D.isDyadicArr(l))return g.error.v;o=o.concat(D.getDataArr(l,!1))}else N(l)=="object"&&l.startCell!=null?o=o.concat(D.getCellDataArr(l,"number",!1)):o.push(l);for(var a=[],e=0;e<o.length;e++){var s=o[e];if(!B(s))return g.error.v;a.push(parseFloat(s))}var u=D.getCellrangeDate(arguments[2]);if(H(u))return u;for(var e=0;e<u.length;e++)if(!(0,j.default)(u[e]).isValid())return g.error.v;if(a.length!=u.length)return g.error.nm;for(var h=0,e=0;e<a.length;e++)h+=a[e]/Math.pow(1+t,window.luckysheet_function.DAYS.f(u[e],u[0])/365);return h}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},CUMIPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseInt(a);var s=D.getFirstValue(arguments[4]);if(H(s))return s;if(!B(s))return g.error.v;s=parseInt(s);var u=D.getFirstValue(arguments[5]);if(H(u))return u;if(!B(u))return g.error.v;if(u=parseFloat(u),t<=0||l<=0||o<=0)return g.error.nm;if(a<1||s<1||a>s)return g.error.nm;if(u!=0&&u!=1)return g.error.nm;var h=window.luckysheet_function.PMT.f(t,l,o,0,u),d=0;a===1&&u===0&&(d=-o,a++);for(var e=a;e<=s;e++)u===1?d+=window.luckysheet_function.FV.f(t,e-2,h,o,1)-h:d+=window.luckysheet_function.FV.f(t,e-1,h,o,0);return d*=t,d}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},PMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a)}var s=0;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return g.error.nm;var u;if(t===0)u=(o+a)/l;else{var h=Math.pow(1+t,l);s===1?u=(a*t/(h-1)+o*t/(1-1/h))/(1+t):u=a*t/(h-1)+o*t/(1-1/h)}return-u}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},IPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=0;if(arguments.length>=5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}var u=0;if(arguments.length>=6){if(u=D.getFirstValue(arguments[5]),H(u))return u;if(!B(u))return g.error.v;u=parseFloat(u)}if(l<1||l>o)return g.error.nm;if(u!=0&&u!=1)return g.error.nm;var h=window.luckysheet_function.PMT.f(t,o,a,s,u),d;l===1?u===1?d=0:d=-a:u===1?d=window.luckysheet_function.FV.f(t,l-2,h,a,1)-h:d=window.luckysheet_function.FV.f(t,l-1,h,a,0);var m=d*t;return m}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},PPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=0;if(arguments.length>=5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}var u=0;if(arguments.length>=6){if(u=D.getFirstValue(arguments[5]),H(u))return u;if(!B(u))return g.error.v;u=parseFloat(u)}if(l<1||l>o)return g.error.nm;if(u!=0&&u!=1)return g.error.nm;var h=window.luckysheet_function.PMT.f(t,o,a,s,u),d=window.luckysheet_function.IPMT.f(t,l,o,a,s,u);return h-d}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},INTRATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseInt(s)}if(o<=0||a<=0)return g.error.nm;if(s<0||s>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var u=(0,j.default)(t).date(),h=(0,j.default)(t).month()+1,d=(0,j.default)(t).year(),m=(0,j.default)(l).date(),p=(0,j.default)(l).month()+1,v=(0,j.default)(l).year(),y;switch(s){case 0:u===31&&m===31?(u=30,m=30):u===31?u=30:u===30&&m===31&&(m=30),y=360/(m+p*30+v*360-(u+h*30+d*360));break;case 1:var k=365;if(d===v||d+1===v&&(h>p||h===p&&u>=m))return(d===v&&D.isLeapYear(d)||D.feb29Between(t,l)||p===1&&m===29)&&(k=366),y=k/(0,j.default)(l).diff((0,j.default)(t),"days"),y=(a-o)/o*y,y;var b=v-d+1,w=((0,j.default)().set({year:v+1,month:0,date:1})-(0,j.default)().set({year:d,month:0,date:1}))/1e3/60/60/24,x=w/b;y=x/(0,j.default)(l).diff((0,j.default)(t),"days");break;case 2:y=360/(0,j.default)(l).diff((0,j.default)(t),"days");break;case 3:y=365/(0,j.default)(l).diff((0,j.default)(t),"days");break;case 4:y=360/(m+p*30+v*360-(u+h*30+d*360));break}return y=(a-o)/o*y,y}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},PRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=D.getFirstValue(arguments[4]);if(H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s);var u=D.getFirstValue(arguments[5]);if(H(u))return u;if(!B(u))return g.error.v;u=parseInt(u);var h=0;if(arguments.length==7){if(h=D.getFirstValue(arguments[6]),H(h))return h;if(!B(h))return g.error.v;h=parseInt(h)}if(o<0||a<0)return g.error.nm;if(s<=0)return g.error.nm;if(u!=1&&u!=2&&u!=4)return g.error.nm;if(h<0||h>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var d=window.luckysheet_function.COUPDAYSNC.f(t,l,u,h),m=window.luckysheet_function.COUPDAYS.f(t,l,u,h),p=window.luckysheet_function.COUPDAYBS.f(t,l,u,h),v=window.luckysheet_function.COUPNUM.f(t,l,u,h);if(v>1){for(var y=s/Math.pow(1+a/u,v-1+d/m),k=0,e=1;e<=v;e++)k+=100*o/u/Math.pow(1+a/u,e-1+d/m);var b=100*(o/u)*(p/m),w=y+k-b}else var x=m-p,y=100*(o/u)+s,k=a/u*(x/m)+1,b=100*(o/u)*(p/m),w=y/k-b;return w}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},PRICEDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseInt(s)}if(o<=0||a<=0)return g.error.nm;if(s<0||s>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var u=(0,j.default)(t).date(),h=(0,j.default)(t).month()+1,d=(0,j.default)(t).year(),m=(0,j.default)(l).date(),p=(0,j.default)(l).month()+1,v=(0,j.default)(l).year(),y;switch(s){case 0:u===31&&m===31?(u=30,m=30):u===31?u=30:u===30&&m===31&&(m=30),y=(m+p*30+v*360-(u+h*30+d*360))/360;break;case 1:var k=365;if(d===v||d+1===v&&(h>p||h===p&&u>=m))return(d===v&&D.isLeapYear(d)||D.feb29Between(t,l)||p===1&&m===29)&&(k=366),y=(0,j.default)(l).diff((0,j.default)(t),"days")/k,y=a-o*a*y,y;var b=v-d+1,w=((0,j.default)().set({year:v+1,month:0,date:1})-(0,j.default)().set({year:d,month:0,date:1}))/1e3/60/60/24,x=w/b;y=(0,j.default)(l).diff((0,j.default)(t),"days")/x;break;case 2:y=(0,j.default)(l).diff((0,j.default)(t),"days")/360;break;case 3:y=(0,j.default)(l).diff((0,j.default)(t),"days")/365;break;case 4:y=(m+p*30+v*360-(u+h*30+d*360))/360;break}return y=a-o*a*y,y}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},PRICEMAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getCellDate(arguments[2]);if(H(o))return o;if(!(0,j.default)(o).isValid())return g.error.v;var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=D.getFirstValue(arguments[4]);if(H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s);var u=0;if(arguments.length==6){if(u=D.getFirstValue(arguments[5]),H(u))return u;if(!B(u))return g.error.v;u=parseInt(u)}if(a<0||s<0)return g.error.nm;if(u<0||u>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var h=(0,j.default)(t).date(),d=(0,j.default)(t).month()+1,m=(0,j.default)(t).year(),p=(0,j.default)(l).date(),v=(0,j.default)(l).month()+1,y=(0,j.default)(l).year(),k=(0,j.default)(o).date(),b=(0,j.default)(o).month()+1,w=(0,j.default)(o).year(),x;switch(u){case 0:h==31&&(h=30),p==31&&(p=30),k==31&&(k=30);var C=360,S=p+v*30+y*360-(h+d*30+m*360),_=p+v*30+y*360-(k+b*30+w*360),T=h+d*30+m*360-(k+b*30+w*360);break;case 1:var F=365;if(m===y||m+1===y&&(d>v||d===v&&h>=p)){(m===y&&D.isLeapYear(m)||D.feb29Between(t,l)||v===1&&p===29)&&(F=366);var C=F,S=(0,j.default)(l).diff((0,j.default)(t),"days"),_=(0,j.default)(t).diff((0,j.default)(o),"days"),T=(0,j.default)(l).diff((0,j.default)(o),"days");return x=(100+_/C*a*100)/(1+S/C*s)-T/C*a*100,x}var R=y-m+1,I=((0,j.default)().set({year:y+1,month:0,date:1})-(0,j.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,P=I/R,C=P,S=(0,j.default)(l).diff((0,j.default)(t),"days"),_=(0,j.default)(t).diff((0,j.default)(o),"days"),T=(0,j.default)(l).diff((0,j.default)(o),"days");break;case 2:var C=360,S=(0,j.default)(l).diff((0,j.default)(t),"days"),_=(0,j.default)(t).diff((0,j.default)(o),"days"),T=(0,j.default)(l).diff((0,j.default)(o),"days");break;case 3:var C=365,S=(0,j.default)(l).diff((0,j.default)(t),"days"),_=(0,j.default)(t).diff((0,j.default)(o),"days"),T=(0,j.default)(l).diff((0,j.default)(o),"days");break;case 4:var C=360,S=p+v*30+y*360-(h+d*30+m*360),_=p+v*30+y*360-(k+b*30+w*360),T=h+d*30+m*360-(k+b*30+w*360);break}return x=(100+_/C*a*100)/(1+S/C*s)-T/C*a*100,x}catch(M){var O=M;return O=g.errorInfo(O),[g.error.v,O]}},RECEIVED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}if(o<=0||a<=0)return g.error.nm;if(s<0||s>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var u=(0,j.default)(t).date(),h=(0,j.default)(t).month()+1,d=(0,j.default)(t).year(),m=(0,j.default)(l).date(),p=(0,j.default)(l).month()+1,v=(0,j.default)(l).year(),y;switch(s){case 0:u==31&&(u=30),m==31&&(m=30);var k=360,b=m+p*30+v*360-(u+h*30+d*360);break;case 1:var w=365;if(d===v||d+1===v&&(h>p||h===p&&u>=m)){(d===v&&D.isLeapYear(d)||D.feb29Between(t,l)||p===1&&m===29)&&(w=366);var k=w,b=(0,j.default)(l).diff((0,j.default)(t),"days");return y=o/(1-a*b/k),y}var x=v-d+1,C=((0,j.default)().set({year:v+1,month:0,date:1})-(0,j.default)().set({year:d,month:0,date:1}))/1e3/60/60/24,S=C/x,k=S,b=(0,j.default)(l).diff((0,j.default)(t),"days");break;case 2:var k=360,b=(0,j.default)(l).diff((0,j.default)(t),"days");break;case 3:var k=365,b=(0,j.default)(l).diff((0,j.default)(t),"days");break;case 4:var k=360,b=m+p*30+v*360-(u+h*30+d*360);break}return y=o/(1-a*b/k),y}catch(T){var _=T;return _=g.errorInfo(_),[g.error.v,_]}},DISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}if(o<=0||a<=0)return g.error.nm;if(s<0||s>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var u=(0,j.default)(t).date(),h=(0,j.default)(t).month()+1,d=(0,j.default)(t).year(),m=(0,j.default)(l).date(),p=(0,j.default)(l).month()+1,v=(0,j.default)(l).year(),y;switch(s){case 0:u==31&&(u=30),m==31&&(m=30);var k=360,b=m+p*30+v*360-(u+h*30+d*360);break;case 1:var w=365;if(d===v||d+1===v&&(h>p||h===p&&u>=m)){(d===v&&D.isLeapYear(d)||D.feb29Between(t,l)||p===1&&m===29)&&(w=366);var k=w,b=(0,j.default)(l).diff((0,j.default)(t),"days");return y=(a-o)/a*(k/b),y}var x=v-d+1,C=((0,j.default)().set({year:v+1,month:0,date:1})-(0,j.default)().set({year:d,month:0,date:1}))/1e3/60/60/24,S=C/x,k=S,b=(0,j.default)(l).diff((0,j.default)(t),"days");break;case 2:var k=360,b=(0,j.default)(l).diff((0,j.default)(t),"days");break;case 3:var k=365,b=(0,j.default)(l).diff((0,j.default)(t),"days");break;case 4:var k=360,b=m+p*30+v*360-(u+h*30+d*360);break}return y=(a-o)/a*(k/b),y}catch(T){var _=T;return _=g.errorInfo(_),[g.error.v,_]}},NPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=D.getFirstValue(arguments[4]),H(s))return s;if(!B(s))return g.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return g.error.nm;var u=l*(1+t*s)-a*t,h=o*t+l*(1+t*s);return Math.log(u/h)/Math.log(1+t)}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},SLN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseFloat(o),o==0?g.error.d:(t-l)/o):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},DURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=D.getFirstValue(arguments[4]);if(H(s))return s;if(!B(s))return g.error.v;s=parseInt(s);var u=0;if(arguments.length==6){if(u=D.getFirstValue(arguments[5]),H(u))return u;if(!B(u))return g.error.v;u=parseInt(u)}if(o<0||a<0)return g.error.nm;if(s!=1&&s!=2&&s!=4)return g.error.nm;if(u<0||u>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;for(var h=window.luckysheet_function.COUPNUM.f(t,l,s,u),d=0,m=0,e=1;e<=h;e++)d+=100*(o/s)*e/Math.pow(1+a/s,e),m+=100*(o/s)/Math.pow(1+a/s,e);var p=(d+100*h/Math.pow(1+a/s,h))/(m+100/Math.pow(1+a/s,h));return p=p/s,p}catch(y){var v=y;return v=g.errorInfo(v),[g.error.v,v]}},MDURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellDate(arguments[0]);if(H(t))return t;if(!(0,j.default)(t).isValid())return g.error.v;var l=D.getCellDate(arguments[1]);if(H(l))return l;if(!(0,j.default)(l).isValid())return g.error.v;var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o);var a=D.getFirstValue(arguments[3]);if(H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a);var s=D.getFirstValue(arguments[4]);if(H(s))return s;if(!B(s))return g.error.v;s=parseInt(s);var u=0;if(arguments.length==6){if(u=D.getFirstValue(arguments[5]),H(u))return u;if(!B(u))return g.error.v;u=parseInt(u)}if(o<0||a<0)return g.error.nm;if(s!=1&&s!=2&&s!=4)return g.error.nm;if(u<0||u>4)return g.error.nm;if((0,j.default)(t)-(0,j.default)(l)>=0)return g.error.nm;var h=window.luckysheet_function.DURATION.f(t,l,o,a,s,u);return h/(1+a/s)}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},BIN2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!/^[01]{1,10}$/g.test(t))return g.error.nm;var l=parseInt(t,2),o=t.toString();return o.length===10&&o.substring(0,1)==="1"?parseInt(o.substring(1),2)-512:l}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},BIN2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^[01]{1,10}$/g.test(t))return g.error.nm;var o=parseInt(t,2).toString(16).toUpperCase();return l==null?o:l<0||l<o.length?g.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},BIN2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^[01]{1,10}$/g.test(t))return g.error.nm;var o=t.toString();if(o.length===10&&o.substring(0,1)==="1")return(1073741312+parseInt(o.substring(1),2)).toString(8);var a=parseInt(t,2).toString(8);return l==null?a:l<0||l<a.length?g.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},DEC2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return g.error.nm;if(t<0)return"1"+new Array(9-(512+t).toString(2).length).join("0")+(512+t).toString(2);var o=parseInt(t,10).toString(2);return l==null?o:l<0||l<o.length?g.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},DEC2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return g.error.nm;if(t<0)return(1099511627776+t).toString(16).toUpperCase();var o=parseInt(t,10).toString(16).toUpperCase();return l==null?o:l<0||l<o.length?g.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},DEC2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return g.error.nm;if(t<0)return(1073741824+t).toString(8);var o=parseInt(t,10).toString(8);return l==null?o:l<0||l<o.length?g.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},HEX2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return g.error.nm;var o=t.length===10&&t.substring(0,1).toLowerCase()==="f",a=o?parseInt(t,16)-1099511627776:parseInt(t,16);if(a<-512||a>511)return g.error.nm;if(o)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var s=a.toString(2);return l==null?s:l<0||l<s.length?g.error.nm:new Array(l-s.length+1).join("0")+s}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},HEX2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return g.error.nm;var l=parseInt(t,16);return l>=549755813888?l-1099511627776:l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},HEX2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return g.error.nm;var o=parseInt(t,16);if(o>536870911&&o<1098974756864)return g.error.nm;if(o>=1098974756864)return(o-1098437885952).toString(8);var a=o.toString(8);return l==null?a:l<0||l<a.length?g.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},OCT2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^[0-7]{1,10}$/.test(t))return g.error.nm;t=t.toString();var o=t.length===10&&t.substring(0,1)==="7",a=o?parseInt(t,8)-1073741824:parseInt(t,8);if(a<-512||a>511)return De.num;if(o)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var s=a.toString(2);return l==null?s:l<0||l<s.length?g.error.nm:new Array(l-s.length+1).join("0")+s}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},OCT2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!/^[0-7]{1,10}$/.test(t))return g.error.nm;var l=parseInt(t,8);return l>=536870912?l-1073741824:l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},OCT2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=null;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(!/^[0-7]{1,10}$/.test(t))return g.error.nm;var o=parseInt(t,8);if(o>=536870912)return"FF"+(o+3221225472).toString(16).toUpperCase();var a=o.toString(16).toUpperCase();return l==null?a:l<0||l<a.length?g.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},COMPLEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l);var o="i";if(arguments.length==3&&(o=arguments[2].toString()),o!="i"&&o!="j")return g.error.v;if(t===0&&l===0)return 0;if(t===0)return l===1?o:l.toString()+o;if(l===0)return t.toString();var a=l>0?"+":"";return t.toString()+a+(l===1?o:l.toString()+o)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},IMREAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return g.error.v;if(t=="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var l=t.indexOf("+"),o=t.indexOf("-");l===0&&(l=t.indexOf("+",1)),o===0&&(o=t.indexOf("-",1));var a=t.substring(t.length-1,t.length),s=a==="i"||a==="j";return l>=0||o>=0?s?l>=0?isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?g.error.nm:Number(t.substring(0,l)):isNaN(t.substring(0,o))||isNaN(t.substring(o+1,t.length-1))?g.error.nm:Number(t.substring(0,o)):g.error.nm:s?isNaN(t.substring(0,t.length-1))?g.error.nm:0:isNaN(t)?g.error.nm:t}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},IMAGINARY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return g.error.v;if(t=="0")return 0;if(["i","j"].indexOf(t)>=0)return 1;t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var l=t.indexOf("+"),o=t.indexOf("-");l===0&&(l=t.indexOf("+",1)),o===0&&(o=t.indexOf("-",1));var a=t.substring(t.length-1,t.length),s=a==="i"||a==="j";return l>=0||o>=0?s?l>=0?isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?g.error.nm:Number(t.substring(l+1,t.length-1)):isNaN(t.substring(0,o))||isNaN(t.substring(o+1,t.length-1))?g.error.nm:-Number(t.substring(o+1,t.length-1)):g.error.nm:s?isNaN(t.substring(0,t.length-1))?g.error.nm:t.substring(0,t.length-1):isNaN(t)?g.error.nm:0}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},IMCONJUGATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;t=t.toString();var l=window.luckysheet_function.IMREAL.f(t);if(H(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(H(o))return o;var a=t.substring(t.length-1);return a=a==="i"||a==="j"?a:"i",o!==0?window.luckysheet_function.COMPLEX.f(l,-o,a):t}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},IMABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(H(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);return H(l)?l:Math.sqrt(Math.pow(t,2)+Math.pow(l,2))}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},DELTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=0;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseFloat(l)}return t===l?1:0}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},IMSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(H(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(H(l))return l;for(var o=arguments[0],e=1;e<arguments.length;e++){var a=window.luckysheet_function.IMREAL.f(o);if(H(a))return a;var s=window.luckysheet_function.IMAGINARY.f(o);if(H(s))return s;var u=window.luckysheet_function.IMREAL.f(arguments[e]);if(H(u))return u;var h=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(H(h))return h;o=window.luckysheet_function.COMPLEX.f(a+u,s+h)}return o}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},IMSUB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return g.error.v;var l=window.luckysheet_function.IMREAL.f(t);if(H(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(H(o))return o;var a=D.getFirstValue(arguments[1]);if(H(a))return a;if(a=a.toString(),a.toLowerCase()=="true"||a.toLowerCase()=="false")return g.error.v;var s=window.luckysheet_function.IMREAL.f(a);if(H(s))return s;var u=window.luckysheet_function.IMAGINARY.f(a);if(H(u))return u;var h=t.substring(t.length-1),d=a.substring(a.length-1),m="i";return(h==="j"||d==="j")&&(m="j"),window.luckysheet_function.COMPLEX.f(l-s,o-u,m)}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},IMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(H(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(H(l))return l;for(var o=arguments[0],e=1;e<arguments.length;e++){var a=window.luckysheet_function.IMREAL.f(o);if(H(a))return a;var s=window.luckysheet_function.IMAGINARY.f(o);if(H(s))return s;var u=window.luckysheet_function.IMREAL.f(arguments[e]);if(H(u))return u;var h=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(H(h))return h;o=window.luckysheet_function.COMPLEX.f(a*u-s*h,a*h+s*u)}return o}catch(m){var d=m;return d=g.errorInfo(d),[g.error.v,d]}},IMDIV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return g.error.v;var l=window.luckysheet_function.IMREAL.f(t);if(H(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(H(o))return o;var a=D.getFirstValue(arguments[1]);if(H(a))return a;if(a=a.toString(),a.toLowerCase()=="true"||a.toLowerCase()=="false")return g.error.v;var s=window.luckysheet_function.IMREAL.f(a);if(H(s))return s;var u=window.luckysheet_function.IMAGINARY.f(a);if(H(u))return u;var h=t.substring(t.length-1),d=a.substring(a.length-1),m="i";if((h==="j"||d==="j")&&(m="j"),s===0&&u===0)return g.error.nm;var p=s*s+u*u;return window.luckysheet_function.COMPLEX.f((l*s+o*u)/p,(o*s-l*u)/p,m)}catch(y){var v=y;return v=g.errorInfo(v),[g.error.v,v]}},NOT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellBoolen(arguments[0]);return H(t)?t:!t}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},TRUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return!0}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},FALSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return!1}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},AND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=!0,e=0;e<arguments.length;e++){var l=D.getCellBoolen(arguments[e]);if(H(l))return l;if(!l){t=!1;break}}return t}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},IFERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[1],"text"),l=D.getFirstValue(arguments[0],"text");return H(l)||N(l)==="string"&&$.trim(l)===""?t:l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},IF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getCellBoolen(arguments[0]);if(H(t))return t;var l=D.getFirstValue(arguments[1],"text");if(H(l)&&o!=De.d)return l;var o="";return arguments.length==3&&(o=D.getFirstValue(arguments[2],"text"),H(o)&&o!=De.d)?o:t?l:o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},OR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t=!1,e=0;e<arguments.length;e++){var l=D.getCellBoolen(arguments[e]);if(H(l))return l;if(l){t=!0;break}}return t}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},NE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=D.getFirstValue(arguments[1]);return H(l)?l:t!=l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;var l=D.getFirstValue(arguments[1]);return H(l)?l:t==l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},GT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t>l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},GTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t>=l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},LT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t<l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},LTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t<=l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ADD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t+l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},MINUS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t-l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},MULTIPLY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),t*l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},DIVIDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseFloat(l),l==0?g.error.d:t/l):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},CONCAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;var l=D.getFirstValue(arguments[1],"text");return H(l)?l:t+""+l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},UNARY_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=t/100;return Math.round(l*100)/100}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},CONCATENATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{for(var t="",e=0;e<arguments.length;e++){var l=D.getFirstValue(arguments[e],"text");if(H(l))return l;t=t+""+l}return t}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},CODE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:t==""?g.error.v:t.charCodeAt(0)}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},CHAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseInt(t),t<1||t>255?g.error.v:String.fromCharCode(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},ARABIC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;if(t=t.toString().toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return g.error.v;var l=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(a){l+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ROMAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let o=function(a){var s=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],["","M","MM","MMM"]],u=s[3][Math.floor(a/1e3)],h=s[2][Math.floor(a%1e3/100)],d=s[1][Math.floor(a%100/10)],m=s[0][a%10];return u+h+d+m};var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseInt(t),t==0?"":t<1||t>3999?g.error.v:o(t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},REGEXEXTRACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;var l=D.getFirstValue(arguments[1],"text");if(H(l))return l;var o=t.match(new RegExp(l));return o?o[o.length>1?o.length-1:0]:null}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},REGEXMATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;var l=D.getFirstValue(arguments[1],"text");if(H(l))return l;var o=t.match(new RegExp(l));return!!o}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},REGEXREPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;var l=D.getFirstValue(arguments[1],"text");if(H(l))return l;var o=D.getFirstValue(arguments[2],"text");return H(o)?o:t.replace(new RegExp(l),o)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)||N(t)=="string"?t:""}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},FIXED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=2;if(arguments.length>=2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}var o=!1;if(arguments.length==3&&(o=D.getCellBoolen(arguments[2]),H(o)))return o;if(l>127)return g.error.v;var a=o?"0":"#,##0";return l<=0?t=Math.round(t*Math.pow(10,l))/Math.pow(10,l):l>0&&(a+="."+new Array(l+1).join("0")),mt(a,t)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},FIND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=D.getFirstValue(arguments[1],"text");if(H(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=D.getFirstValue(arguments[2]),H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o)}if(o<0||o>l.length)return g.error.v;if(t=="")return o;if(l.indexOf(t)==-1)return g.error.v;var a=l.indexOf(t,o-1)+1;return a}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},FINDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=D.getFirstValue(arguments[1],"text");if(H(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=D.getFirstValue(arguments[2]),H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o)}if(o<0||o>l.length)return g.error.v;if(t=="")return o;if(l.indexOf(t)==-1)return g.error.v;for(var a=l.split(""),s=l.indexOf(t,o-1),u=0,e=0;e<s;e++)/[^\x00-\xff]/g.test(a[e])?u+=2:u+=1;return u}catch(d){var h=d;return h=g.errorInfo(h),[g.error.v,h]}},JOIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;for(var l=[],e=1;e<arguments.length;e++){var o=arguments[e];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;l=l.concat(D.getDataArr(o,!1))}else N(o)=="object"&&o.startCell!=null?l=l.concat(D.getCellDataArr(o,"text",!1)):l.push(o)}return l.join(t)}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},LEFT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=1;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}return l<0?g.error.v:l>=t.length?t:l==0?"":t.substr(0,l)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},RIGHT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=1;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}return l<0?g.error.v:l>=t.length?t:l==0?"":t.substr(-l,l)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},MID:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);return H(o)?o:B(o)?(o=parseInt(o),l<1||o<0?g.error.v:l>t.length?"":l+o>t.length?t.substr(l-1,t.length-l+1):t.substr(l-1,o)):g.error.v}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},LEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:(t=t.toString(),t.length)}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},LENB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:(t=t.toString(),t.replace(/[^\x00-\xff]/g,"aa").length)}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},LOWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:(t=t.toString(),t&&t.toLowerCase())}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},UPPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:(t=t.toString(),t&&t.toUpperCase())}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},EXACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=D.getFirstValue(arguments[1],"text");return H(l)?l:(l=l.toString(),t===l)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},REPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=D.getFirstValue(arguments[1]);if(H(l))return l;if(!B(l))return g.error.v;l=parseInt(l);var o=D.getFirstValue(arguments[2]);if(H(o))return o;if(!B(o))return g.error.v;o=parseInt(o);var a=D.getFirstValue(arguments[3],"text");return H(a)?a:(a=a.toString(),t.substr(0,l-1)+a+t.substr(l-1+o))}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},REPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=D.getFirstValue(arguments[1]);return H(l)?l:B(l)?(l=parseInt(l),l<0?g.error.v:(l>100&&(l=100),new Array(l+1).join(t))):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},SEARCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=D.getFirstValue(arguments[1],"text");if(H(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=D.getFirstValue(arguments[2]),H(o))return o;if(!B(o))return g.error.v;o=parseInt(o)}if(o<=0||o>l.length)return g.error.v;var a=l.toLowerCase().indexOf(t.toLowerCase(),o-1)+1;return a===0?g.error.v:a}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},SUBSTITUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();var l=D.getFirstValue(arguments[1],"text");if(H(l))return l;l=l.toString();var o=D.getFirstValue(arguments[2],"text");if(H(o))return o;o=o.toString();var a=null;if(arguments.length==4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseInt(a)}var s=new RegExp(l,"g"),u;if(a==null)u=t.replace(s,o);else{if(a<=0)return g.error.v;var h=t.match(s);if(h==null||a>h.length)return t;for(var d=l.length,m=0,e=1;e<=a;e++)m=t.indexOf(l,m)+1;u=t.substring(0,m-1)+o+t.substring(m-1+d)}return u}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},CLEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");if(H(t))return t;t=t.toString();for(var l=[],e=0;e<t.length;e++){var o=t.charCodeAt(e);(/[\u4e00-\u9fa5]/g.test(t.charAt(e))||o>31&&o<127)&&l.push(t.charAt(e))}return l.join("")}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1],"text");return H(l)?l:(l=l.toString(),mt(l,t))}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},TRIM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:(t=t.toString(),t.replace(/ +/g," ").trim())}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},VALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:(t=t.toString(),nt(t)[2])}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},PROPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:(t=t.toString().toLowerCase(),t.replace(/[a-zA-Z]+/g,function(o){return o.substring(0,1).toUpperCase()+o.substring(1)}))}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},CONVERT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseFloat(t);var l=D.getFirstValue(arguments[1],"text");if(H(l))return l;l=l.toString();var o=D.getFirstValue(arguments[2],"text");if(H(o))return o;o=o.toString();for(var a=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,30856775814671900],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,1125899906842624,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},u={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},h=null,d=null,m=l,p=o,v=1,y=1,k,e=0;e<a.length;e++)k=a[e][2]===null?[]:a[e][2],(a[e][1]===m||k.indexOf(m)>=0)&&(h=a[e]),(a[e][1]===p||k.indexOf(p)>=0)&&(d=a[e]);if(h===null){var b=s[l.substring(0,2)],w=u[l.substring(0,1)];l.substring(0,2)==="da"&&(w=["dekao",10,"da"]),b?(v=b[2],m=l.substring(2)):w&&(v=w[1],m=l.substring(w[2].length));for(var x=0;x<a.length;x++)k=a[x][2]===null?[]:a[x][2],(a[x][1]===m||k.indexOf(m)>=0)&&(h=a[x])}if(d===null){var C=s[o.substring(0,2)],S=u[o.substring(0,1)];o.substring(0,2)==="da"&&(S=["dekao",10,"da"]),C?(y=C[2],p=o.substring(2)):S&&(y=S[1],p=o.substring(S[2].length));for(var _=0;_<a.length;_++)k=a[_][2]===null?[]:a[_][2],(a[_][1]===p||k.indexOf(p)>=0)&&(d=a[_])}return h===null||d===null?g.error.na:h[3]!==d[3]?g.error.na:t*h[6]*v/(d[6]*y)}catch(F){var T=F;return T=g.errorInfo(T),[g.error.v,T]}},SUMX2MY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;a=a.concat(D.getDataArr(o,!1))}else N(o)=="object"&&o.startCell!=null?a=a.concat(D.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return g.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var h=l[e],d=a[e];B(h)&&B(d)&&(s.push(parseFloat(h)),u.push(parseFloat(d)))}for(var m=0,e=0;e<s.length;e++)m+=Math.pow(s[e],2)-Math.pow(u[e],2);return m}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},SUMX2PY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;a=a.concat(D.getDataArr(o,!1))}else N(o)=="object"&&o.startCell!=null?a=a.concat(D.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return g.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var h=l[e],d=a[e];B(h)&&B(d)&&(s.push(parseFloat(h)),u.push(parseFloat(d)))}for(var m=0,e=0;e<s.length;e++)m+=Math.pow(s[e],2)+Math.pow(u[e],2);return m}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},SUMXMY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!1))}else N(t)=="object"&&t.startCell!=null?l=l.concat(D.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(N(o)=="array"){if(N(o[0])=="array"&&!D.isDyadicArr(o))return g.error.v;a=a.concat(D.getDataArr(o,!1))}else N(o)=="object"&&o.startCell!=null?a=a.concat(D.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return g.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var h=l[e],d=a[e];B(h)&&B(d)&&(s.push(parseFloat(h)),u.push(parseFloat(d)))}for(var m=0,e=0;e<s.length;e++)m+=Math.pow(s[e]-u[e],2);return m}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},TRANSPOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else N(t)=="object"&&t.startCell!=null&&(l=D.getCellDataDyadicArr(t,"number"));return l=l[0].map(function(a,s){return l.map(function(u){return u[s]})}),l}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},TREND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let R=function(I,P){for(var O=0,M=0,A=0,z=0,L=0;L<I.length;L++)for(var E=0;E<I[L].length;E++)O+=I[L][E],M+=P[L][E],A+=I[L][E]*P[L][E],z+=I[L][E]*I[L][E];var V=I.length*I[0].length,q=O/V,G=M/V,X=A/V,ee=z/V,le=(X-q*G)/(ee-q*q),se=G-le*q;return[le,se]};var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else if(N(t)=="object"&&t.startCell!=null)l=D.getCellDataDyadicArr(t,"text");else{if(!B(t))return g.error.v;var o=[];o.push(parseFloat(t)),l.push(o)}for(var a=l.length,s=l[0].length,e=0;e<a;e++)for(var u=0;u<s;u++){if(!B(l[e][u]))return g.error.v;l[e][u]=parseFloat(l[e][u])}for(var h=[],e=1;e<=a;e++)for(var u=1;u<=s;u++){var d=(e-1)*s+u;h.push(d)}if(arguments.length>=2){var m=arguments[1];if(h=[],N(m)=="array"){if(N(m[0])=="array"&&!D.isDyadicArr(m))return g.error.v;h=D.getDataDyadicArr(m)}else if(N(m)=="object"&&m.startCell!=null)h=D.getCellDataDyadicArr(m,"text");else{if(!B(m))return g.error.v;var o=[];o.push(parseFloat(m)),h.push(o)}for(var e=0;e<h.length;e++)for(var u=0;u<h[0].length;u++){if(!B(h[e][u]))return g.error.v;h[e][u]=parseFloat(h[e][u])}}var p=h.length,v=h[0].length,y=h;if(arguments.length>=3){var k=arguments[2];if(y=[],N(k)=="array"){if(N(k[0])=="array"&&!D.isDyadicArr(k))return g.error.v;y=D.getDataDyadicArr(k)}else if(N(k)=="object"&&k.startCell!=null)y=D.getCellDataDyadicArr(k,"text");else{if(!B(k))return g.error.v;var o=[];o.push(parseFloat(k)),y.push(o)}for(var e=0;e<y.length;e++)for(var u=0;u<y[0].length;u++){if(!B(y[e][u]))return g.error.v;y[e][u]=parseFloat(y[e][u])}}var b=!0;if(arguments.length==4&&(b=D.getCellBoolen(arguments[3]),H(b)))return b;if(a!=p||s!=v)return g.error.r;var w=R(h,l),x=w[0];if(b)var C=w[1];else var C=0;for(var S=[],e=0;e<y.length;e++)for(var u=0;u<y[e].length;u++){var _=y[e][u],T=x*_+C;S.push(Math.round(T*1e9)/1e9)}return S}catch(R){var F=R;return F=g.errorInfo(F),[g.error.v,F]}},FREQUENCY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=l.concat(D.getDataArr(t,!0))}else if(N(t)=="object"&&t.startCell!=null)l=l.concat(D.getCellDataArr(t,"number",!0));else{if(!B(t))return g.error.v;l.push(t)}for(var o=[],e=0;e<l.length;e++)B(l[e])&&o.push(parseFloat(l[e]));var a=arguments[1],s=[];if(N(a)=="array"){if(N(a[0])=="array"&&!D.isDyadicArr(a))return g.error.v;s=s.concat(D.getDataArr(a,!0))}else if(N(a)=="object"&&a.startCell!=null)s=s.concat(D.getCellDataArr(a,"number",!0));else{if(!B(a))return g.error.v;s.push(a)}for(var u=[],e=0;e<s.length;e++)B(s[e])&&u.push(parseFloat(s[e]));if(o.length==0&&u.length==0)return[[0],[0]];if(o.length==0){for(var h=[[0]],e=0;e<u.length;e++)h.push([0]);return h}else{if(u.length==0)return[[0],[o.length]];u.sort(function(b,w){return b-w});for(var h=[],e=0;e<u.length;e++)if(e==0){for(var d=0,m=0;m<o.length;m++)o[m]<=u[0]&&d++;h.push([d])}else if(e==u.length-1){for(var p=0,v=0,m=0;m<o.length;m++)o[m]<=u[e]&&o[m]>u[e-1]&&p++,o[m]>u[e]&&v++;h.push([p]),h.push([v])}else{for(var d=0,m=0;m<o.length;m++)o[m]<=u[e]&&o[m]>u[e-1]&&d++;h.push([d])}return h}}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},GROWTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let R=function(I,P){for(var O=0,M=0,A=0,z=0,L=0;L<I.length;L++)for(var E=0;E<I[L].length;E++)O+=I[L][E],M+=Math.log(P[L][E]),A+=I[L][E]*Math.log(P[L][E]),z+=I[L][E]*I[L][E];var V=I.length*I[0].length,q=O/V,G=M/V,X=A/V,ee=z/V,le=(X-q*G)/(ee-q*q),se=G-le*q;return[Math.exp(le),Math.exp(se)]};var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else if(N(t)=="object"&&t.startCell!=null)l=D.getCellDataDyadicArr(t,"text");else{if(!B(t))return g.error.v;var o=[];o.push(parseFloat(t)),l.push(o)}for(var a=l.length,s=l[0].length,e=0;e<a;e++)for(var u=0;u<s;u++){if(!B(l[e][u]))return g.error.v;l[e][u]=parseFloat(l[e][u])}for(var h=[],e=1;e<=a;e++)for(var u=1;u<=s;u++){var d=(e-1)*s+u;h.push(d)}if(arguments.length>=2){var m=arguments[1];if(h=[],N(m)=="array"){if(N(m[0])=="array"&&!D.isDyadicArr(m))return g.error.v;h=D.getDataDyadicArr(m)}else if(N(m)=="object"&&m.startCell!=null)h=D.getCellDataDyadicArr(m,"text");else{if(!B(m))return g.error.v;var o=[];o.push(parseFloat(m)),h.push(o)}for(var e=0;e<h.length;e++)for(var u=0;u<h[0].length;u++){if(!B(h[e][u]))return g.error.v;h[e][u]=parseFloat(h[e][u])}}var p=h.length,v=h[0].length,y=h;if(arguments.length>=3){var k=arguments[2];if(y=[],N(k)=="array"){if(N(k[0])=="array"&&!D.isDyadicArr(k))return g.error.v;y=D.getDataDyadicArr(k)}else if(N(k)=="object"&&k.startCell!=null)y=D.getCellDataDyadicArr(k,"text");else{if(!B(k))return g.error.v;var o=[];o.push(parseFloat(k)),y.push(o)}for(var e=0;e<y.length;e++)for(var u=0;u<y[0].length;u++){if(!B(y[e][u]))return g.error.v;y[e][u]=parseFloat(y[e][u])}}var b=!0;if(arguments.length==4&&(b=D.getCellBoolen(arguments[3]),H(b)))return b;if(a!=p||s!=v)return g.error.r;var w=R(h,l),x=w[0];if(b)var C=w[1];else var C=1;for(var S=[],e=0;e<y.length;e++)for(var u=0;u<y[e].length;u++){var _=y[e][u],T=C*Math.pow(x,_);S.push(Math.round(T*1e9)/1e9)}return S}catch(R){var F=R;return F=g.errorInfo(F),[g.error.v,F]}},LINEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return g.error.v}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},LOGEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return g.error.v}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},MDETERM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{let u=function(h,d){var m,p=new Array;if(d==1)return m=h[0][0],m;if(d==2)return m=h[0][0]*h[1][1]-h[0][1]*h[1][0],m;if(d==3)return m=h[0][0]*h[1][1]*h[2][2]+h[1][0]*h[2][1]*h[0][2]+h[2][0]*h[0][1]*h[1][2]-h[2][0]*h[1][1]*h[0][2]-h[0][0]*h[2][1]*h[1][2]-h[1][0]*h[0][1]*h[2][2],m;m=0;for(var v=new Array,y=new Array,k=0;k<d;k++)p[k]=h[k][0]*Math.pow(-1,k+1+1);for(var k=0;k<d;k++){y[k]=new Array;for(var b=0;b<d-1;b++)y[k][b]=h[k][b+1]}for(var k=0;k<d;k++){for(var b=0;b<d;b++){v[b]=new Array;for(var w=0;w<d-1;w++)k>b?v[b][w]=y[b][w]:k<b&&(v[b-1][w]=y[b][w])}m+=p[k]*arguments.callee(v,d-1)}return m};var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else if(N(t)=="object"&&t.startCell!=null)l=D.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!B(l[e][a]))return g.error.v;l[e][a]=parseFloat(l[e][a])}return l.length!=l[0].length?g.error.v:u(l,l.length)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},MINVERSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else if(N(t)=="object"&&t.startCell!=null)l=D.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!B(l[e][a]))return g.error.v;l[e][a]=parseFloat(l[e][a])}return l.length!=l[0].length?g.error.v:wa(l)}catch(u){var s=u;return s=g.errorInfo(s),[g.error.v,s]}},MMULT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else if(N(t)=="object"&&t.startCell!=null)l=D.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!B(l[e][a]))return g.error.v;l[e][a]=parseFloat(l[e][a])}var s=arguments[1],u=[];if(N(s)=="array"){if(N(s[0])=="array"&&!D.isDyadicArr(s))return g.error.v;u=D.getDataDyadicArr(s)}else if(N(s)=="object"&&s.startCell!=null)u=D.getCellDataDyadicArr(s,"text");else{var o=[];o.push(s),u.push(o)}for(var e=0;e<u.length;e++)for(var a=0;a<u[e].length;a++){if(!B(u[e][a]))return g.error.v;u[e][a]=parseFloat(u[e][a])}if(l[0].length!=u.length)return g.error.v;for(var h=l.length,d=u[0].length,m=[],p=0;p<h;p++){for(var o=[],v=0;v<d;v++){for(var y=0,n=0;n<l[0].length;n++)y+=l[p][n]*u[n][v];o.push(y)}m.push(o)}return m}catch(b){var k=b;return k=g.errorInfo(k),[g.error.v,k]}},SUMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else if(N(t)=="object"&&t.startCell!=null)l=D.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++)B(l[e][a])?l[e][a]=parseFloat(l[e][a]):l[e][a]=0;var s=l.length,u=l[0].length;if(arguments.length>=2)for(var e=1;e<arguments.length;e++){var h=arguments[e],d=[];if(N(h)=="array"){if(N(h[0])=="array"&&!D.isDyadicArr(h))return g.error.v;d=D.getDataDyadicArr(h)}else if(N(h)=="object"&&h.startCell!=null)d=D.getCellDataDyadicArr(h,"text");else{var o=[];o.push(h),d.push(o)}if(d.length!=s||d[0].length!=u)return g.error.v;for(var m=0;m<s;m++)for(var p=0;p<u;p++)B(d[m][p])?l[m][p]=l[m][p]*parseFloat(d[m][p]):l[m][p]=0}for(var v=0,m=0;m<s;m++)for(var p=0;p<u;p++)v+=l[m][p];return v}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},ISFORMULA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;return N(t)=="object"&&t.startCell!=null?t.data==null?!1:(N(t.data)=="array"?l=t.data[0][0]:l=t.data,l!=null&&l.f!=null):g.error.v}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},CELL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;if(N(t.data)=="array")return g.error.v;if(l=t.data.v,me(l))return g.error.v}else l=t;var o=arguments[1],a;if(N(o)=="object"&&o.startCell!=null)a=o.startCell;else return g.error.v;if(["address","col","color","contents","filename","format","parentheses","prefix","protect","row","type","width"].indexOf(l)==-1)return g.error.v;var s=At()[Z(f.currentSheetIndex)],u=g.getcellrange(a),h=u.row[0],d=u.column[0];let v=At(),y=Z(f.calculateSheetIndex),k=v[y].data,b;switch(g.execFunctionGlobalData!=null&&g.execFunctionGlobalData[h+"_"+d+"_"+f.calculateSheetIndex]!=null?b=g.execFunctionGlobalData[h+"_"+d+"_"+f.calculateSheetIndex].v:k[h][d]!=null&&k[h][d].v!=null&&k[h][d].v!=""?(b=k[h][d],b instanceof Object&&(b=b.v)):b=0,l){case"address":return a;case"col":return d+1;case"color":return 0;case"contents":return b;case"filename":return s.name;case"format":return k[h][d]==null||k[h][d].ct==null?"G":k[h][d].ct.fa;case"parentheses":return k[h][d]==null||k[h][d].v==null||k[h][d].v==""?0:k[h][d].v>0?1:0;case"prefix":return b==0?"":k[h][d].ht==0?"^":k[h][d].ht==1?"'":k[h][d].ht==2?'"':"";case"protect":return 0;case"row":return h+1;case"type":return b==0?"b":"l";case"width":var m=s.config;return m.columnlen!=null&&d in m.columnlen?m.columnlen[d]:f.defaultcollen}}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},NA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return g.error.na}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},ERROR_TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.na;if(N(t.data)=="array"){if(l=t.data[0][0],l==null||me(l.v))return g.error.na;l=l.v}else{if(me(t.data.v))return g.error.na;l=t.data.v}}else l=t;var o={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7,"#GETTING_DATA":8};return l in o?o[l]:g.error.na}catch(s){var a=s;return a=g.errorInfo(a),[g.error.v,a]}},ISBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;return N(t)=="object"&&t.startCell!=null?t.data==null:!1}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ISERR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(N(t.data)=="array")return!0;if(t.data==null||me(t.data.v))return!1;l=t.data.v}else l=t;return["#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ISERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(N(t.data)=="array")return!0;if(t.data==null||me(t.data.v))return!1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ISLOGICAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(N(t.data)=="array"||t.data==null||me(t.data.v))return!1;l=t.data.v}else l=t;return l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ISNA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(N(t.data)=="array"||t.data==null||me(t.data.v))return!1;l=t.data.v}else l=t;return l.toString()=="#N/A"}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ISNONTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(N(t.data)=="array"||t.data==null||me(t.data.v))return!0;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1||l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?!0:!!B(l)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ISNUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(N(t.data)=="array"||t.data==null||me(t.data.v))return!1;l=t.data.v}else l=t;return!!B(l)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},ISREF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{return N(arguments[0])=="object"&&arguments[0].startCell!=null}catch(l){var t=l;return t=g.errorInfo(t),[g.error.v,t]}},ISTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null){if(N(t.data)=="array"||t.data==null||me(t.data.v))return!1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1||l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?!1:!B(l)}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")return 64;if(N(t)=="object"&&t.startCell!=null){if(N(t.data)=="array")return 16;if(t.data==null||me(t.data.v))return 1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1?16:l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?4:B(l)?1:2}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},N:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;l=t[0][0]}else l=t[0];else if(N(t)=="object"&&t.startCell!=null)if(N(t.data)=="array"){if(l=t.data[0][0],l==null||me(l.v))return 0;l=l.v}else{if(t.data==null||me(t.data.v))return 0;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1?l:l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?l.toString().toLowerCase()=="true"?1:0:B(l)?parseFloat(l):0}catch(a){var o=a;return o=g.errorInfo(o),[g.error.v,o]}},TO_DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),mt("yyyy-mm-dd",t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},TO_PURE_NUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:(0,j.default)(t).isValid()?nt(t)[2]:(0,qo.default)(t).value()==null?t:(0,qo.default)(t).value()}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},TO_TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0],"text");return H(t)?t:mt("@",t)}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},TO_DOLLARS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),mt("$ 0.00",t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},TO_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);return H(t)?t:B(t)?(t=parseFloat(t),mt("0%",t)):g.error.v}catch(o){var l=o;return l=g.errorInfo(l),[g.error.v,l]}},DGET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);return u.length===0?g.error.v:u.length>1?g.error.nm:h[u[0]]}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},DMAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=h[u[0]],e=1;e<u.length;e++)m<h[u[e]]&&(m=h[u[e]]);return m}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},DMIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=findResultIndex(l,s),h=[];if(N(o)==="string"){var d=findField(l,o);h=rest(l[d])}else h=rest(l[o]);for(var m=h[u[0]],e=1;e<u.length;e++)m>h[u[e]]&&(m=h[u[e]]);return m}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},DAVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=0,e=0;e<u.length;e++)m+=h[u[e]];return u.length===0?g.error.d:m/u.length}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},DCOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=[],e=0;e<u.length;e++)m[e]=h[u[e]];return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,m)}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},DCOUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=[],e=0;e<u.length;e++)m[e]=h[u[e]];return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,m)}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},DPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=[],e=0;e<u.length;e++)m[e]=h[u[e]];m=D.compact(m);var p=1;for(e=0;e<m.length;e++)p*=m[e];return p}catch(y){var v=y;return v=g.errorInfo(v),[g.error.v,v]}},DSTDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=[],e=0;e<u.length;e++)m[e]=h[u[e]];return m=D.compact(m),window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,m)}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},DSTDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=[],e=0;e<u.length;e++)m[e]=h[u[e]];return m=D.compact(m),window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,m)}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},DSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=[],e=0;e<u.length;e++)m[e]=h[u[e]];m=D.compact(m);var p=0;for(e=0;e<m.length;e++)p+=m[e];return p}catch(y){var v=y;return v=g.errorInfo(v),[g.error.v,v]}},DVAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=[],e=0;e<u.length;e++)m[e]=h[u[e]];return m=D.compact(m),window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,m)}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},DVARP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="object"&&t.startCell!=null){if(t.data==null)return g.error.v;l=D.getCellDataDyadicArr(t,"text")}else return g.error.v;var o=D.getFirstValue(arguments[1],"text");if(H(o))return o;if(me(o))return g.error.v;var a=arguments[2],s=[];if(N(a)=="object"&&a.startCell!=null){if(a.data==null)return g.error.v;s=D.getCellDataDyadicArr(a,"text")}else return g.error.v;if(!B(o)&&N(o)!=="string")return g.error.v;var u=D.findResultIndex(l,s),h=[];if(N(o)==="string"){var d=D.findField(l,o);h=D.rest(l[d])}else h=D.rest(l[o]);for(var m=[],e=0;e<u.length;e++)m[e]=h[u[e]];return m=D.compact(m),window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,m)}catch(v){var p=v;return p=g.errorInfo(p),[g.error.v,p]}},LINESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=arguments[1],h=arguments[2],d=arguments[3],m=arguments[4],p=arguments[5],v=arguments[6],y=arguments[7];let R=At(),I=Z(f.calculateSheetIndex),P=R[I].data;var k=g.readCellDataToOneArray(s),b=be.getCellRealSize(P,t,l),w=b[0],x=b[1],C={};h==null&&(h=1),C.lineWidth=h,C.offsetY=h+1,C.height=x-(h+1),C.width=w;var S=function(O,M){M&&(typeof M=="number"&&(M>19&&(M=M%20),M=a[M]),C[O]=M)};if(u==null&&(u="#2ec7c9"),S("lineColor",u),C.fillColor=0,d)if(typeof d=="string"){d=d.toLowerCase();var _=null;d=="min"?_=window.luckysheet_function.MIN.f({data:k}):d=="max"?_=window.luckysheet_function.MAX.f({data:k}):d=="avg"||d=="mean"?_=window.luckysheet_function.AVERAGE.f({data:k}):d=="median"&&(_=window.luckysheet_function.MEDIAN.f({data:k})),_&&(C.normalRangeMin=_,C.normalRangeMax=_)}else C.normalRangeMin=d,C.normalRangeMax=d;m==null&&(m="#000"),S("normalRangeColor",m),S("maxSpotColor",p),S("minSpotColor",v),y==null&&(y="1.5"),C.spotRadius=y;var T=Jl.init(k,C);return T}catch(R){var F=R;return F=g.errorInfo(F),[g.error.v,F]}},AREASPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=arguments[1],h=arguments[2],d=arguments[3],m=arguments[4],p=arguments[5],v=g.readCellDataToOneArray(s);let T=At(),F=Z(f.calculateSheetIndex),R=T[F].data;var y=be.getCellRealSize(R,t,l),k=y[0],b=y[1],w={};d==null&&(d=1),w.lineWidth=d,w.offsetY=d+1,w.height=b-(d+1),w.width=k;var x=function(I,P){P&&(typeof P=="number"&&(P>19&&(P=P%20),P=a[P]),w[I]=P)};if(u==null&&(u="#2ec7c9"),x("lineColor",u),x("fillColor",h),d==null&&(d="1"),w.lineWidth=d,m)if(typeof m=="string"){m=m.toLowerCase();var C=null;m=="min"?C=window.luckysheet_function.MIN.f({data:v}):m=="max"?C=window.luckysheet_function.MAX.f({data:v}):m=="avg"||m=="mean"?C=window.luckysheet_function.AVERAGE.f({data:v}):m=="median"&&(C=window.luckysheet_function.MEDIAN.f({data:v})),C&&(w.normalRangeMin=C,w.normalRangeMax=C)}else w.normalRangeMin=m,w.normalRangeMax=m;p==null&&(p="#000"),x("normalRangeColor",p);var S=Jl.init(v,w);return S}catch(T){var _=T;return _=g.errorInfo(_),[g.error.v,_]}},COLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=g.readCellDataToOneArray(s);let _=At(),T=Z(f.calculateSheetIndex),F=_[T].data;var h=be.getCellRealSize(F,t,l),d=h[0],m=h[1],p={};p.height=m,p.width=d;var v=function(R,I){I&&(typeof I=="number"&&(I>19&&(I=I%20),I=a[I]),p[R]=I)},y=arguments[1],k=arguments[2],b=arguments[3],w=arguments[4];p.type="column",y==null&&(y="1"),p.barSpacing=y,k==null&&(k="#fc5c5c"),v("barColor",k),b==null&&(b="#97b552"),v("negBarColor",b),w==null||w===!1||typeof w!="number"?p.chartRangeMax=void 0:p.chartRangeMax=w;var x=g.sparklinesColorMap(arguments);x&&(p.colorMap=x);var C=Jl.init(u,p);return C}catch(_){var S=_;return S=g.errorInfo(S),[g.error.v,S]}},STACKCOLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=[],h=[];if(s!=null&&s.data!=null&&(h=s.data),N(h)=="array")h=g.getPureValueByData(h);else{if(N(h)=="object")return h=h.v,[h];/\{.*?\}/.test(h)&&(h=h.replace(/\{/g,"[").replace(/\}/g,"]")),h=new Function("return "+h)()}var d=arguments[1],m=h.length;if(d==null||!!d)for(var p=0;p<h[0].length;p++){for(var v="",y=0;y<h.length;y++)v+=h[y][p]+":";v=v.substr(0,v.length-1),u.push(v)}else{for(var y=0;y<h.length;y++){for(var k="",p=0;p<h[0].length;p++)k+=h[y][p]+":";k=k.substr(0,k.length-1),u.push(k)}var m=h[0].length}let P=At(),O=Z(f.calculateSheetIndex),M=P[O].data;var b=be.getCellRealSize(M,t,l),w=b[0],x=b[1],C={};C.height=x,C.width=w;var S=function(A,z){z&&(typeof z=="number"&&(z>19&&(z=z%20),z=a[z]),C[A]=z)},_=arguments[2],T=arguments[3];C.type="column",_==null&&(_="1"),C.barSpacing=_,T==null||T===!1||typeof T!="number"?C.chartRangeMax=void 0:C.chartRangeMax=T;var F=g.sparklinesColorMap(arguments,4);F&&(C.colorMap=F);var R=Jl.init(u,C);return R}catch(P){var I=P;return I=g.errorInfo(I),[g.error.v,I]}},BARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=g.readCellDataToOneArray(s);let _=At(),T=Z(f.calculateSheetIndex),F=_[T].data;var h=be.getCellRealSize(F,t,l),d=h[0],m=h[1],p={};p.height=m,p.width=d;var v=function(R,I){I&&(typeof I=="number"&&(I>19&&(I=I%20),I=a[I]),p[R]=I)},y=arguments[1],k=arguments[2],b=arguments[3],w=arguments[4];p.type="bar",y==null&&(y="1"),p.barSpacing=y,k==null&&(k="#fc5c5c"),v("barColor",k),b==null&&(b="#97b552"),v("negBarColor",b),w==null||w===!1||typeof w!="number"?p.chartRangeMax=void 0:p.chartRangeMax=w;var x=g.sparklinesColorMap(arguments);x&&(p.colorMap=x);var C=Jl.init(u,p);return C}catch(_){var S=_;return S=g.errorInfo(S),[g.error.v,S]}},STACKBARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=[],h=[];if(s!=null&&s.data!=null&&(h=s.data),N(h)=="array")h=g.getPureValueByData(h);else{if(N(h)=="object")return h=h.v,[h];/\{.*?\}/.test(h)&&(h=h.replace(/\{/g,"[").replace(/\}/g,"]")),h=new Function("return "+h)()}var d=arguments[1],m=h.length;if(d==null||!!d)for(var p=0;p<h[0].length;p++){for(var v="",y=0;y<h.length;y++)v+=h[y][p]+":";v=v.substr(0,v.length-1),u.push(v)}else{for(var y=0;y<h.length;y++){for(var k="",p=0;p<h[0].length;p++)k+=h[y][p]+":";k=k.substr(0,k.length-1),u.push(k)}var m=h[0].length}let P=At(),O=Z(f.calculateSheetIndex),M=P[O].data;var b=be.getCellRealSize(M,t,l),w=b[0],x=b[1],C={};C.height=x,C.width=w;var S=function(A,z){z&&(typeof z=="number"&&(z>19&&(z=z%20),z=a[z]),C[A]=z)},_=arguments[2],T=arguments[3];C.type="bar",_==null&&(_="1"),C.barSpacing=_,T==null||T===!1||typeof T!="number"?C.chartRangeMax=void 0:C.chartRangeMax=T;var F=g.sparklinesColorMap(arguments,4);F&&(C.colorMap=F);var R=Jl.init(u,C);return R}catch(P){var I=P;return I=g.errorInfo(I),[g.error.v,I]}},DISCRETESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=g.readCellDataToOneArray(s);let C=At(),S=Z(f.calculateSheetIndex),_=C[S].data;var h=be.getCellRealSize(_,t,l),d=h[0],m=h[1],p={};p.height=m,p.width=d;var v=function(T,F){F&&(typeof F=="number"&&(F>19&&(F=F%20),F=a[F]),p[T]=F)},y=arguments[1],k=arguments[2],b=arguments[3];p.type="discrete",y==null&&(y=0),p.thresholdValue=y,k==null&&(k="#2ec7c9"),v("lineColor",k),b==null&&(b="#fc5c5c"),v("thresholdColor",b);var w=Jl.init(u,p);return w}catch(C){var x=C;return x=g.errorInfo(x),[g.error.v,x]}},TRISTATESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=g.readCellDataToOneArray(s);let _=At(),T=Z(f.calculateSheetIndex),F=_[T].data;var h=be.getCellRealSize(F,t,l),d=h[0],m=h[1],p={};p.height=m,p.width=d;var v=function(R,I){I&&(typeof I=="number"&&(I>19&&(I=I%20),I=a[I]),p[R]=I)},y=arguments[1],k=arguments[2],b=arguments[3],w=arguments[4];p.type="tristate",y==null&&(y="1"),p.barSpacing=y,k==null&&(k="#fc5c5c"),v("barColor",k),b==null&&(b="#97b552"),v("negBarColor",b),w==null&&(w="#999"),v("zeroBarColor",w);var x=g.sparklinesColorMap(arguments);x&&(p.colorMap=x);var C=Jl.init(u,p);return C}catch(_){var S=_;return S=g.errorInfo(S),[g.error.v,S]}},PIESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=g.readCellDataToOneArray(s);let S=At(),_=Z(f.calculateSheetIndex),T=S[_].data;var h=be.getCellRealSize(T,t,l),d=h[0],m=h[1],p={};p.height=m,p.width=d;var v=function(F,R){R&&(typeof R=="number"&&(R>19&&(R=R%20),R=a[R]),p[F]=R)},y=arguments[1],k=arguments[2],b=arguments[3];p.type="pie",y==null&&(y=0),p.offset=y,k==null&&(k=0),v("borderWidth",k),b==null&&(b="#97b552"),v("borderColor",b);var w=g.sparklinesColorMap(arguments,4);w&&(p.colorMap=w);var x=Jl.init(u,p);return x}catch(S){var C=S;return C=g.errorInfo(C),[g.error.v,C]}},BOXSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList,s=arguments[0],u=g.readCellDataToOneArray(s);let C=At(),S=Z(f.calculateSheetIndex),_=C[S].data;var h=be.getCellRealSize(_,t,l),d=h[0],m=h[1],p={};p.height=m,p.width=d;var v=function(T,F){F&&(typeof F=="number"&&(F>19&&(F=F%20),F=a[F]),p[T]=F)},y=arguments[1],k=arguments[2],b=arguments[3];p.type="box",y==null&&(y=1.5),p.outlierIQR=y,k==null?k=0:v("target",k),b==null&&(b=1.5),v("spotRadius",b);var w=Jl.init(u,p);return w}catch(C){var x=C;return x=g.errorInfo(x),[g.error.v,x]}},BULLETSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=g.colorList;let w=At(),x=Z(f.calculateSheetIndex),C=w[x].data;var s=be.getCellRealSize(C,t,l),u=s[0],h=s[1],d={};d.height=h,d.width=u;var m=function(S,_){_&&(typeof _=="number"&&(_>19&&(_=_%20),_=a[_]),d[S]=_)},p=[];jn(arguments);var v=g.getValueByFuncData(arguments[0]),y=g.getValueByFuncData(arguments[1]);p.push(v),p.push(y);for(var e=2;e<arguments.length;e++)p.push(g.getValueByFuncData(arguments[e]));d.type="bullet";var k=Jl.init(p,d);return k}catch(w){var b=w;return b=g.errorInfo(b),[g.error.v,b]}},SORT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[],o=1,a=1;if(N(t)=="array")if(N(t[0])=="array"){if(!D.isDyadicArr(t))return g.error.v;for(var e=0;e<t.length;e++){for(var s=[],u=0;u<t[e].length;u++){var h=t[e][u];s.push(h)}l.push(s)}o=l.length,a=l[0].length}else{for(var e=0;e<t.length;e++){var h=t[e];l.push(h)}o=l.length}else if(N(t)=="object"&&t.startCell!=null)if(t.data!=null)if(N(t.data)=="array"){for(var e=0;e<t.data.length;e++){for(var s=[],u=0;u<t.data[e].length;u++)if(t.data[e][u]!=null){var h=t.data[e][u].v;me(h)&&(h=0),s.push(h)}else s.push(0);l.push(s)}o=l.length,a=l[0].length}else{var h=t.data.v;me(h)&&(h=0),l.push(h)}else l.push(0);else{var h=t;l.push(h)}var d=1;if(arguments.length>=2){if(d=D.getFirstValue(arguments[1]),H(d))return d;if(!B(d))return g.error.v;d=parseInt(d)}var m=1;if(arguments.length>=3){if(m=D.getFirstValue(arguments[2]),H(m))return m;if(!B(m))return g.error.v;m=Math.floor(parseFloat(m))}var p=!1;if(arguments.length==4&&(p=D.getCellBoolen(arguments[3]),H(p)))return p;if(p){if(d<1||d>o)return g.error.v}else if(d<1||d>a)return g.error.v;if(m!=1&&m!=-1)return g.error.v;var v=function(b,w){if(N(b)=="array"&&(b=b[d-1]),N(w)=="array"&&(w=w[d-1]),!isNaN(b)&&!isNaN(w))return b-w;if(isNaN(b))if(isNaN(w)){if(b>w)return 1;if(b<w)return-1}else return 1;else return-1},y=function(b,w){if(N(b)=="array"&&(b=b[d-1]),N(w)=="array"&&(w=w[d-1]),!isNaN(b)&&!isNaN(w))return w-b;if(isNaN(b))if(isNaN(w)){if(b>w)return-1;if(b<w)return 1}else return-1;else return 1};return p?(l=l[0].map(function(b,w){return l.map(function(x){return x[w]})}),m==1&&l.sort(v),m==-1&&l.sort(y),l=l[0].map(function(b,w){return l.map(function(x){return x[w]})})):(m==1&&l.sort(v),m==-1&&l.sort(y)),l}catch(b){var k=b;return k=g.errorInfo(k),[g.error.v,k]}},FILTER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else if(N(t)=="object"&&t.startCell!=null)l=D.getCellDataDyadicArr(t,"number");else{var o=[];o.push(parseFloat(t)),l.push(o)}var a=l.length,s=l[0].length,u=arguments[1],h=[],d="row";if(N(u)=="array")if(N(u[0])=="array"){if(!D.isDyadicArr(u))return g.error.v;if(u.length>1&&u[0].length>1)return g.error.v;if(u.length>1){if(u.length!=l.length)return g.error.v;d="row";for(var e=0;e<u.length;e++){var m=u[e][0];if(N(m)!="boolean")if(N(m)=="string"&&(m.toLowerCase()=="true"||m.toLowerCase()=="false"))m.toLowerCase()=="true"?m=!0:m.toLowerCase()=="false"&&(m=!1);else if(B(m))m=parseFloat(m),m=m!=0;else return g.error.v;h.push(m)}}if(u[0].length>1){if(u[0].length!=l[0].length)return g.error.v;d="col";for(var e=0;e<u[0].length;e++){var m=u[0][e];if(N(m)!="boolean")if(N(m)=="string"&&(m.toLowerCase()=="true"||m.toLowerCase()=="false"))m.toLowerCase()=="true"?m=!0:m.toLowerCase()=="false"&&(m=!1);else if(B(m))m=parseFloat(m),m=m!=0;else return g.error.v;h.push(m)}}}else{if(u.length!=l[0].length)return g.error.v;d="col";for(var e=0;e<u.length;e++){var m=u[e];if(N(m)!="boolean")if(N(m)=="string"&&(m.toLowerCase()=="true"||m.toLowerCase()=="false"))m.toLowerCase()=="true"?m=!0:m.toLowerCase()=="false"&&(m=!1);else if(B(m))m=parseFloat(m),m=m!=0;else return g.error.v;h.push(m)}}else if(N(u)=="object"&&u.data!=null&&N(u.data)=="array"){if(u.data.length>1&&u.data[0].length>1)return g.error.v;if(u.data.length>1){if(u.data.length!=l.length)return g.error.v;d="row";for(var e=0;e<u.data.length;e++){var m=u.data[e][0].v;if(me(m)&&(m=0),N(m)!="boolean")if(N(m)=="string"&&(m.toLowerCase()=="true"||m.toLowerCase()=="false"))m.toLowerCase()=="true"?m=!0:m.toLowerCase()=="false"&&(m=!1);else if(B(m))m=parseFloat(m),m=m!=0;else return g.error.v;h.push(m)}}if(u.data[0].length>1){if(u.data[0].length!=l[0].length)return g.error.v;d="col";for(var e=0;e<u.data[0].length;e++){var m=u.data[0][e].v;if(me(m)&&(m=0),N(m)!="boolean")if(N(m)=="string"&&(m.toLowerCase()=="true"||m.toLowerCase()=="false"))m.toLowerCase()=="true"?m=!0:m.toLowerCase()=="false"&&(m=!1);else if(B(m))m=parseFloat(m),m=m!=0;else return g.error.v;h.push(m)}}}else return g.error.v;var p="";if(arguments.length==3&&(p=D.getFirstValue(arguments[2],"text"),H(p)))return p;var v=[];if(d=="row")for(var e=0;e<l.length;e++)h[e]&&v.push(l[e]);else for(var e=0;e<l.length;e++){for(var o=[],y=0;y<l[0].length;y++)h[y]&&o.push(l[e][y]);o.length>0&&v.push(o)}return v.length==0?p:v}catch(b){var k=b;return k=g.errorInfo(k),[g.error.v,k]}},UNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=arguments[0],l=[];if(N(t)=="array"){if(N(t[0])=="array"&&!D.isDyadicArr(t))return g.error.v;l=D.getDataDyadicArr(t)}else if(N(t)=="object"&&t.startCell!=null)l=D.getCellDataDyadicArr(t,"number");else{var o=[];o.push(parseFloat(t)),l.push(o)}var a=!1;if(arguments.length>=2&&(a=D.getCellBoolen(arguments[1]),H(a)))return a;var s=!1;if(arguments.length==3&&(s=D.getCellBoolen(arguments[2]),H(s)))return s;if(a){l=l[0].map(function(k,b){return l.map(function(w){return w[b]})});for(var u={},h=[],d=[],e=0;e<l.length;e++){for(var m="",p=0;p<l[e].length;p++)m+=l[e][p].toString()+"|||";h.push(m),m in u||(u[m]=0,d.push(l[e]))}if(s){for(var v=[],e=0;e<h.length;e++)h.indexOf(h[e])==h.lastIndexOf(h[e])&&v.push(l[e]);return v=v[0].map(function(k,b){return v.map(function(w){return w[b]})}),v}else return d=d[0].map(function(k,b){return d.map(function(w){return w[b]})}),d}else{for(var u={},h=[],d=[],e=0;e<l.length;e++){for(var m="",p=0;p<l[e].length;p++)m+=l[e][p].toString()+"|||";h.push(m),m in u||(u[m]=0,d.push(l[e]))}if(s){for(var v=[],e=0;e<h.length;e++)h.indexOf(h[e])==h.lastIndexOf(h[e])&&v.push(l[e]);return v}else return d}}catch(k){var y=k;return y=g.errorInfo(y),[g.error.v,y]}},RANDARRAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=1;if(arguments.length>=1){if(t=D.getFirstValue(arguments[0]),H(t))return t;if(!B(t))return g.error.v;t=parseInt(t)}var l=1;if(arguments.length==2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}if(t<=0||l<=0)return g.error.v;for(var o=[],e=0;e<t;e++){for(var a=[],s=0;s<l;s++)a.push(Math.random().toFixed(9));o.push(a)}return o}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},SEQUENCE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=D.getFirstValue(arguments[0]);if(H(t))return t;if(!B(t))return g.error.v;t=parseInt(t);var l=1;if(arguments.length>=2){if(l=D.getFirstValue(arguments[1]),H(l))return l;if(!B(l))return g.error.v;l=parseInt(l)}var o=1;if(arguments.length>=3){if(o=D.getFirstValue(arguments[2]),H(o))return o;if(!B(o))return g.error.v;o=parseFloat(o)}var a=1;if(arguments.length==4){if(a=D.getFirstValue(arguments[3]),H(a))return a;if(!B(a))return g.error.v;a=parseFloat(a)}if(t<=0||l<=0)return g.error.v;for(var s=[],e=0;e<t;e++){for(var u=[],h=0;h<l;h++){var d=o+a*(h+l*e);u.push(d)}s.push(u)}return s}catch(p){var m=p;return m=g.errorInfo(m),[g.error.v,m]}},EVALUATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;for(var e=0;e<arguments.length;e++){var n=g.errorParamCheck(this.p,arguments[e],e);if(!n[0])return g.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentIndex,a=D.getFirstValue(arguments[0]).toString();if(H(a))return a;a.trim().indexOf("=")!=0&&(a="="+a);var s=g.execstringformula(a,t,l,o);return s[1]}catch(h){var u=h;return u=g.errorInfo(u),[g.error.v,u]}},REMOTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return g.error.na;try{let n=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=D.getFirstValue(arguments[0]);return H(o)?o:(de.remoteFunction(o,a=>{let s=xe.deepCopyFlowData(f.flowdata);g.execFunctionGroup(n,t,a),s[n][t]={v:a,f:l},Ze(s,[{row:[n,n],column:[t,t]}])}),"Loading...")}catch(n){console.log(n);var e=n;return e=g.errorInfo(e),[g.error.v,e]}}},am=L0});var Hc,cm=Me(()=>{Hc=[{n:"SUMIF",t:0,m:[2,3],p:[{example:"A1:A10",require:"m",repeat:"n",type:"range"},{example:'">20"',require:"m",repeat:"n",type:"rangeall"},{example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,m:[1,1],p:[{example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,m:[2,2],p:[{example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,m:[1,1],p:[{example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,m:[1,1],p:[{example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,m:[1,1],p:[{example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,m:[1,1],p:[{example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,m:[1,1],p:[{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,m:[1,1],p:[{example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,m:[2,2],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,m:[1,1],p:[{example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,m:[1,1],p:[{example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,m:[1,1],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,m:[1,1],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,m:[1,255],p:[{example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,m:[1,1],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,m:[1,2],p:[{example:"128",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,m:[1,1],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,m:[2,2],p:[{example:"10",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,m:[2,2],p:[{example:"21",require:"m",repeat:"n",type:"rangenumber"},{example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,m:[1,1],p:[{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,m:[2,2],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,m:[2,256],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"A2:A5",require:"m",repeat:"n",type:"range"},{example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,m:[1,1],p:[{example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,m:[2,2],p:[{example:"A1:A10",require:"m",repeat:"n",type:"range"},{example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,m:[1,1],p:[{example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,m:[1,255],p:[{example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,m:[1,1],p:[{example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,m:[1,1],p:[{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,m:[1,1],p:[{example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,m:[1,1],p:[{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,m:[1,1],p:[{example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,m:[1,1],p:[{example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,m:[0,0],p:[]},{n:"FLOOR",t:0,m:[2,2],p:[{example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,m:[1,255],p:[{example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,m:[2,2],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,m:[2,2],p:[{example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,m:[2,2],p:[{example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,m:[2,2],p:[{example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,m:[4,4],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,m:[1,1],p:[{example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,m:[1,1],p:[{example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,m:[1,1],p:[{example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,m:[1,1],p:[{example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,m:[1,1],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,m:[1,1],p:[{example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,m:[1,2],p:[{example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,m:[2,2],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,m:[2,2],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,m:[3,257],p:[{example:"A1:A10",require:"m",repeat:"n",type:"range"},{example:" B1:B10",require:"m",repeat:"n",type:"range"},{example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,m:[2,256],p:[{example:"A1:A10",require:"m",repeat:"n",type:"range"},{example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,m:[5,5],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"},{example:"20",require:"m",repeat:"n",type:"rangenumber"},{example:"40",require:"m",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,m:[2,2],p:[{example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,m:[2,3],p:[{example:"A10",require:"m",repeat:"n",type:"rangenumber"},{example:"A1:A100",require:"m",repeat:"n",type:"range"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,m:[2,3],p:[{example:"A10",require:"m",repeat:"n",type:"rangenumber"},{example:"A1:A100",require:"m",repeat:"n",type:"range"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,m:[2,3],p:[{example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"A2",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,m:[2,3],p:[{example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{example:" A2",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,m:[3,3],p:[{example:"A1",require:"m",repeat:"n",type:"rangenumber"},{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,m:[1,1],p:[{example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,m:[1,1],p:[{example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,m:[4,4],p:[{example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"3",require:"m",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,m:[4,4],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,m:[3,3],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,m:[3,3],p:[{example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,m:[2,2],p:[{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,m:[3,3],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,m:[2,3],p:[{example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{example:'">20"',require:"m",repeat:"n",type:"rangeall"},{example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,m:[2,255],p:[{example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,m:[2,2],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"range"},{example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,m:[1,1],p:[{example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,m:[2,2],p:[{example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,m:[3,3],p:[{example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,m:[4,4],p:[{example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,m:[4,4],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,m:[1,255],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,m:[3,3],p:[{example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,m:[4,4],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"6",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,m:[2,3],p:[{example:"A2:A100",require:"m",repeat:"n",type:"range"},{example:"B2",require:"m",repeat:"n",type:"rangenumber"},{example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,m:[3,4],p:[{example:"A3:A6",require:"m",repeat:"n",type:"range"},{example:"2",require:"m",repeat:"n",type:"range"},{example:"3",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,m:[3,3],p:[{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,m:[3,3],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"},{example:"30",require:"m",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"},{example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"},{example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,m:[2,2],p:[{example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,m:[2,2],p:[{example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,m:[4,4],p:[{example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,m:[4,4],p:[{example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{example:"7",require:"m",repeat:"n",type:"rangenumber"},{example:"6",require:"m",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,m:[3,3],p:[{example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{example:"7",require:"m",repeat:"n",type:"rangenumber"},{example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,m:[3,3],p:[{example:"96",require:"m",repeat:"n",type:"rangenumber"},{example:"80",require:"m",repeat:"n",type:"rangenumber"},{example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,m:[2,2],p:[{example:"A2:B100",require:"m",repeat:"n",type:"range"},{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,m:[1,255],p:[{example:"1",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,m:[3,4],p:[{example:"10003",require:"m",repeat:"n",type:"rangeall"},{example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,m:[3,4],p:[{example:"10003",require:"m",repeat:"n",type:"rangeall"},{example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,m:[2,3],p:[{example:"10003",require:"m",repeat:"n",type:"rangeall"},{example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,m:[2,5],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"o",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,m:[1,2],p:[{example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,m:[0,1],p:[{example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,m:[1,1],p:[{example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,m:[0,1],p:[{example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,m:[1,1],p:[{example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,m:[3,5],p:[{example:"A2",require:"m",repeat:"n",type:"range"},{example:"3",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,m:[2,3],p:[{example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{example:"A2:A9",require:"m",repeat:"n",type:"range"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,m:[2,3],p:[{example:"A1:C20",require:"m",repeat:"n",type:"range"},{example:"5",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,m:[2,254],p:[{example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{example:'"division"',require:"o",repeat:"y",type:"rangeall"},{example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,m:[2,255],p:[{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:'"A"',require:"m",repeat:"n",type:"rangeall"},{example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,p:[{example:'"http://www.luckysheet.com/"',require:"m",repeat:"n",type:"rangeall"},{example:'"luckysheet"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,m:[3,3],p:[{example:"11",require:"m",repeat:"n",type:"rangenumber"},{example:"40",require:"m",repeat:"n",type:"rangenumber"},{example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,m:[1,1],p:[{example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,m:[2,2],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,m:[2,2],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,m:[1,1],p:[{example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,m:[1,1],p:[{example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,m:[1,1],p:[{example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,m:[2,3],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangeall"},{example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,m:[2,4],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangeall"},{example:"16)",require:"o",repeat:"n",type:"rangeall"},{example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,m:[1,1],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,m:[1,2],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,m:[1,2],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,m:[1,1],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,m:[2,2],p:[{example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,m:[2,3],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangeall"},{example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,m:[3,3],p:[{example:"1969",require:"m",repeat:"n",type:"rangenumber"},{example:"7",require:"m",repeat:"n",type:"rangenumber"},{example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,m:[1,1],p:[{example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,m:[3,3],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangeall"},{example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,m:[2,3],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangenumber"},{example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,m:[2,4],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangenumber"},{example:"16)",require:"o",repeat:"n",type:"rangeall"},{example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,m:[1,1],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,m:[2,3],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"7",require:"m",repeat:"n",type:"rangeall"},{example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,m:[0,0],p:[]},{n:"MONTH",t:6,m:[1,1],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,m:[2,2],p:[{example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,m:[1,2],p:[{example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,m:[2,2],p:[{example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,m:[2,2],p:[{example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,m:[4,5],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"50",require:"m",repeat:"n",type:"rangenumber"},{example:"10",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,m:[4,5],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"50",require:"m",repeat:"n",type:"rangenumber"},{example:"10",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,m:[3,6],p:[{example:"12",require:"m",repeat:"n",type:"rangenumber"},{example:"-100",require:"m",repeat:"n",type:"rangenumber"},{example:"400",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"},{example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,m:[6,6],p:[{example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"5",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,m:[3,4],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"02",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,m:[4,4],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"50",require:"m",repeat:"n",type:"rangenumber"},{example:"10",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,m:[3,3],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"m",repeat:"n",type:"rangeall"},{example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,m:[3,3],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,m:[3,3],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,m:[3,5],p:[{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"D2",require:"o",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,m:[6,8],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{example:"10000",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,m:[4,5],p:[{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{example:"1000",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,m:[3,4],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,m:[3,4],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,m:[3,4],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,m:[3,4],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"01)",require:"m",repeat:"n",type:"rangenumber"},{example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,m:[3,4],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"01)",require:"m",repeat:"n",type:"rangenumber"},{example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,m:[3,5],p:[{example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"400",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,m:[2,2],p:[{example:"10000",require:"m",repeat:"n",type:"rangenumber"},{example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,m:[6,7],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{example:"95",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,m:[4,5],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"95",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,m:[2,2],p:[{example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,m:[2,3],p:[{example:"B2:B25",require:"m",repeat:"n",type:"range"},{example:"C2:C25",require:"m",repeat:"n",type:"range"},{example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,m:[3,3],p:[{example:"A2:A25",require:"m",repeat:"n",type:"range"},{example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,m:[1,2],p:[{example:"A2:A25",require:"m",repeat:"n",type:"range"},{example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,m:[2,255],p:[{example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{example:"200",require:"m",repeat:"n",type:"rangeall"},{example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,m:[3,3],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B25",require:"m",repeat:"n",type:"range"},{example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,m:[6,6],p:[{example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"5",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,m:[3,5],p:[{example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"},{example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{example:"D2",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,m:[4,6],p:[{example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"},{example:"80000",require:"m",repeat:"n",type:"rangenumber"},{example:"E2",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,m:[4,6],p:[{example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{example:"100000",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,m:[4,5],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"100000",require:"m",repeat:"n",type:"rangenumber"},{example:"101200",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,m:[6,7],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,m:[4,5],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,m:[5,6],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,m:[4,5],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,m:[4,5],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,m:[3,5],p:[{example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{example:"500",require:"m",repeat:"n",type:"rangenumber"},{example:"40000",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,m:[3,3],p:[{example:"300000",require:"m",repeat:"n",type:"rangenumber"},{example:"75000",require:"m",repeat:"n",type:"rangenumber"},{example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,m:[5,6],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,m:[5,6],p:[{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,m:[1,1],p:[{example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,m:[1,2],p:[{example:"101",require:"m",repeat:"n",type:"rangeall"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,m:[1,2],p:[{example:"101",require:"m",repeat:"n",type:"rangeall"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,m:[1,2],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,m:[1,2],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,m:[1,2],p:[{example:"100",require:"m",repeat:"n",type:"rangenumber"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,m:[1,2],p:[{example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,m:[1,1],p:[{example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,m:[1,2],p:[{example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,m:[1,2],p:[{example:"37",require:"m",repeat:"n",type:"rangeall"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,m:[1,1],p:[{example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,m:[1,2],p:[{example:"37",require:"m",repeat:"n",type:"rangeall"},{example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,m:[2,3],p:[{example:"3",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,m:[1,1],p:[{example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,m:[1,1],p:[{example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,m:[1,1],p:[{example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,m:[1,1],p:[{example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,m:[1,2],p:[{example:"2",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,m:[1,255],p:[{example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,m:[2,2],p:[{example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,m:[1,255],p:[{example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,m:[2,2],p:[{example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,m:[0,0],p:[]},{n:"FALSE",t:10,m:[0,0],p:[]},{n:"AND",t:10,m:[1,255],p:[{example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,m:[2,2],p:[{example:"A1",require:"m",repeat:"n",type:"rangeall"},{example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,m:[2,3],p:[{example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,m:[1,255],p:[{example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"},{example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"},{example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,m:[2,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"},{example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,m:[2,2],p:[{example:"4",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,m:[2,2],p:[{example:'"de"',require:"m",repeat:"n",type:"rangeall"},{example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,m:[1,255],p:[{example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,m:[1,1],p:[{example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,m:[1,1],p:[{example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,m:[1,1],p:[{example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,m:[1,1],p:[{example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,m:[2,2],p:[{example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,m:[2,2],p:[{example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,m:[3,3],p:[{example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,m:[1,3],p:[{example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{example:"2",require:"o",repeat:"n",type:"rangenumber"},{example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,m:[2,3],p:[{example:'"n"',require:"m",repeat:"n",type:"rangeall"},{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,m:[2,3],p:[{example:'"new"',require:"m",repeat:"n",type:"rangeall"},{example:'"new year"',require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,m:[2,255],p:[{example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{example:"{1",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,m:[1,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,m:[1,2],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,m:[3,3],p:[{example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{example:"5",require:"m",repeat:"n",type:"rangenumber"},{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,m:[1,1],p:[{example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,m:[1,1],p:[{example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,m:[2,2],p:[{example:"A1",require:"m",repeat:"n",type:"rangeall"},{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,m:[4,4],p:[{example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"6",require:"m",repeat:"n",type:"rangenumber"},{example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,m:[2,2],p:[{example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,m:[2,3],p:[{example:'"n"',require:"m",repeat:"n",type:"rangeall"},{example:"A2",require:"m",repeat:"n",type:"rangeall"},{example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,m:[3,4],p:[{example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,m:[1,1],p:[{example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,m:[2,2],p:[{example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,m:[1,1],p:[{example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,m:[1,1],p:[{example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,m:[1,1],p:[{example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,m:[3,3],p:[{example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{example:'"g"',require:"m",repeat:"n",type:"rangeall"},{example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,m:[2,2],p:[{example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,m:[1,1],p:[{example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,m:[1,4],p:[{example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,m:[2,2],p:[{example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,m:[1,4],p:[{example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,m:[1,4],p:[{example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,m:[1,4],p:[{example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,m:[1,1],p:[{example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,m:[1,1],p:[{example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,m:[2,2],p:[{example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,m:[1,255],p:[{example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,m:[2,2],p:[{example:'"type"',require:"m",repeat:"n",type:"rangeall"},{example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,m:[1,1],p:[{example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,m:[1,1],p:[{example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,m:[1,1],p:[{example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,m:[1,1],p:[{example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,m:[1,1],p:[{example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,m:[1,1],p:[{example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,m:[3,3],p:[{example:"A2:F20",require:"m",repeat:"n",type:"range"},{example:"G2",require:"m",repeat:"n",type:"rangeall"},{example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",m:[1,2],p:[{example:"A1",require:"m",repeat:"n",type:"rangeall"},{example:'"2017-10-01"',require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",m:[1,1],p:[{example:'"31033519900101XXXX"',require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",m:[1,2],p:[{example:'"31033519900101XXXX"',require:"m",repeat:"n",type:"rangeall"},{example:"0",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",m:[1,1],p:[{example:'"31033519900101XXXX"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",m:[1,1],p:[{example:'"31033519900101XXXX"',require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",m:[1,1],p:[{example:'"31033519900101XXXX"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",m:[1,1],p:[{example:'"31033519900101XXXX"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",m:[1,1],p:[{example:'"31033519900101XXXX"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",m:[1,2],p:[{example:'"I came to Beijing Tsinghua University"',require:"m",repeat:"n",type:"rangeall"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",m:[1,3],p:[{example:'"I came to Beijing Tsinghua University"',require:"m",repeat:"n",type:"rangeall"},{example:"20",require:"o",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",m:[1,3],p:[{example:'"I came to Beijing Tsinghua University"',require:"m",repeat:"n",type:"rangeall"},{example:"20",require:"o",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",m:[1,3],p:[{example:'"000001"',require:"m",repeat:"n",type:"rangeall"},{example:"2015-01-08",require:"o",repeat:"n",type:"rangedate"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",m:[1,3],p:[{example:'"000001"',require:"m",repeat:"n",type:"rangeall"},{example:"2015-01-08",require:"o",repeat:"n",type:"rangedate"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",m:[1,3],p:[{example:'"000001"',require:"m",repeat:"n",type:"rangeall"},{example:"2015-01-08",require:"o",repeat:"n",type:"rangedate"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",m:[1,3],p:[{example:'"000001"',require:"m",repeat:"n",type:"rangeall"},{example:"2015-01-08",require:"o",repeat:"n",type:"rangedate"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",m:[1,3],p:[{example:'"000001"',require:"m",repeat:"n",type:"rangeall"},{example:"2015-01-08",require:"o",repeat:"n",type:"rangedate"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",m:[1,3],p:[{example:'"000001"',require:"m",repeat:"n",type:"rangeall"},{example:"2015-01-08",require:"o",repeat:"n",type:"rangedate"},{example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",m:[1,1],p:[{example:'"1990-01-01"',require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",m:[1,8],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"avg",require:"o",repeat:"n",type:"rangeall"},{example:"#000",require:"o",repeat:"n",type:"rangeall"},{example:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{example:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{example:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",m:[1,5],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{example:"#CCF3F4",require:"o",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"avg",require:"o",repeat:"n",type:"rangeall"},{example:"#000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",m:[1,6],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"n",type:"rangeall"},{example:"100",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",m:[1,5],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"100",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",m:[1,6],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"n",type:"rangeall"},{example:"100",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",m:[1,5],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"100",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",m:[1,4],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{example:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",m:[1,6],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"1",require:"o",repeat:"n",type:"rangeall"},{example:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"n",type:"rangeall"},{example:"#999",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",m:[1,5],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"0",require:"o",repeat:"n",type:"rangeall"},{example:"0",require:"o",repeat:"n",type:"rangeall"},{example:"#000",require:"o",repeat:"n",type:"rangeall"},{example:"#97b552",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",m:[1,4],p:[{example:"A1:A20",require:"m",repeat:"n",type:"rangeall"},{example:"1.5",require:"o",repeat:"n",type:"rangeall"},{example:"10",require:"o",repeat:"n",type:"rangeall"},{example:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",m:[2,3],p:[{example:"10",require:"m",repeat:"n",type:"rangeall"},{example:"8",require:"m",repeat:"n",type:"rangeall"},{example:"12",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",m:[1,1],p:[{example:"PIESPLINES(A1:A20)",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",m:[1,4],p:[{example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"},{example:"-1",require:"o",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",m:[2,3],p:[{example:"A5:D20",require:"m",repeat:"n",type:"range"},{example:"1",require:"m",repeat:"n",type:"range"},{example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",m:[1,3],p:[{example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",m:[0,2],p:[{example:"1",require:"o",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",m:[1,4],p:[{example:"1",require:"m",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"},{example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",m:[1,1],p:[{example:'"A1+5*2^2"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REMOTE",t:"5",m:[1,1],p:[{example:"SUM(A1:A10000000)",require:"m",repeat:"n",type:"string"}]}]});var um,fm=Me(()=>{cm();um=e=>(Hc.forEach(n=>{let t=e[n.n];n.d=t.d,n.a=t.a,n.p.forEach((l,o)=>{Object.assign(l,t.p[o])})}),Hc)});var O0,hm,dm=Me(()=>{sm();Ke();kt();fm();O0=function(e){let n=Q(),t=[...um(n.functionlist)];for(let o=0;o<t.length;o++){let a=t[o];a.f=am[a.n]}e&&t.push(...e),f.functionlist=t;let l={};for(let o=0;o<t.length;o++){let a=t[o];l[a.n]=a}window.luckysheet_function=l,f.luckysheet_function=l},hm=O0});function B0(e,n){let t=ye.getSheetByIndex();t.config==null&&(t.config={}),t.config.sheetViewZoom==null&&(t.config.sheetViewZoom={});let l=1,o="zoomScaleNormal";H0(t),e=="viewNormal"?o="viewNormalZoomScale":e=="viewLayout"?o="viewLayoutZoomScale":e=="viewPage"&&(o="viewPageZoomScale",l=.6,V0(t));let a=t.config.sheetViewZoom[o];a==null&&(a=l),t.config.curentsheetView=e,f.clearjfundo&&f.jfredo.push({type:"viewChange",curType:e,preType:n,sheetIndex:f.currentSheetIndex}),ne.saveParam("cg",f.currentSheetIndex,e,{k:"curentsheetView"}),f.currentSheetView=e,wn(a)}function H0(e){}function V0(e){}function q0(e){let n=e.parent(),t=n.find("luckysheet-print-viewBtn-active").attr("type");if(e.attr("type")==t)return;let l=e.attr("type");if(l!=null)B0(l,t);else return;e.parent().find(".luckysheet-print-viewBtn").removeClass("luckysheet-print-viewBtn-active"),e.addClass("luckysheet-print-viewBtn-active")}function mm(){let e=de.container,n=this;$("#"+e).find(".luckysheet-print-viewBtn").click(function(){q0($(this))})}var gm=Me(()=>{xl();Gi();dl();Qt();Zl();Ke()});function j0(e){clearTimeout(pm),pm=setTimeout(()=>{$("#luckysheet-icon-undo")[e?"removeClass":"addClass"]("disabled")},10)}function W0(e){clearTimeout(vm),vm=setTimeout(()=>{$("#luckysheet-icon-redo")[e?"removeClass":"addClass"]("disabled")},10)}var pm,vm,ym,km=Me(()=>{ht();Ke();Nl();Et();yi();ym=function(){Oa(f,"jfredo",(e,n,t,l)=>{n!=="length"&&Je.createHookFunction("updated",t),j0(f.jfredo.length)}),Oa(f,"jfundo",(e,n,t,l)=>{W0(f.jfundo.length)}),Oa(f,"asyncLoad",(e,n,t,l)=>{n==="length"&&t===0&&Je.createHookFunction("workbookCreateAfter",Sc())})}});function bm(){Oc(),Rh(),jd(),Kd(),Jd(),em(),rm(),im(),nd(),mm(),ym()}var vl,wm=Me(()=>{Xc();ht();Ke();kt();Qt();xl();dl();qd();yn();Wd();Zd();Qd();tm();nm();om();Et();Zn();Yt();dm();Wt();Kt();$r();Zt();Gi();gm();Nl();yi();km();Ss();hi();vl=Pc(Fc,vl);vl.create=e=>{var h;Je.destroy(),f.toJsonOptions={};for(let d in e)d!=="data"&&(f.toJsonOptions[d]=e[d]);let n=Pc(Yc,e),t=n.loadUrl,l=n.menu,o=n.title,a=n.container;f.container=a,f.luckysheetfile=n.data,f.defaultcolumnNum=n.column,f.defaultrowNum=n.row,f.defaultFontSize=n.defaultFontSize,f.fullscreenmode=n.fullscreenmode,f.lang=n.lang,f.allowEdit=n.allowEdit,f.limitSheetNameLength=n.limitSheetNameLength,f.defaultSheetNameMaxLength=n.defaultSheetNameMaxLength,f.fontList=n.fontList,ne.gridKey=n.gridKey,ne.loadUrl=n.loadUrl,ne.updateUrl=n.updateUrl,ne.updateImageUrl=n.updateImageUrl,ne.title=n.title,ne.loadSheetUrl=n.loadSheetUrl,ne.allowUpdate=n.allowUpdate,de.autoFormatw=n.autoFormatw,de.accuracy=n.accuracy,de.total=n.data[0].total,de.loading=n.loading,de.allowCopy=n.allowCopy,de.showtoolbar=n.showtoolbar,de.showtoolbarConfig=n.showtoolbarConfig,de.showinfobar=n.showinfobar,de.showsheetbar=n.showsheetbar,de.showsheetbarConfig=n.showsheetbarConfig,de.showstatisticBar=n.showstatisticBar,de.showstatisticBarConfig=n.showstatisticBarConfig,de.sheetFormulaBar=n.sheetFormulaBar,de.cellRightClickConfig=n.cellRightClickConfig,de.sheetRightClickConfig=n.sheetRightClickConfig,de.pointEdit=n.pointEdit,de.pointEditUpdate=n.pointEditUpdate,de.pointEditZoom=n.pointEditZoom,de.userInfo=n.userInfo,de.myFolderUrl=n.myFolderUrl,de.functionButton=n.functionButton,de.showConfigWindowResize=n.showConfigWindowResize,de.enableAddRow=n.enableAddRow,de.enableAddBackTop=n.enableAddBackTop,de.addRowCount=n.addRowCount,de.enablePage=n.enablePage,de.pageInfo=n.pageInfo,de.editMode=n.editMode,de.beforeCreateDom=n.beforeCreateDom,de.workbookCreateBefore=n.workbookCreateBefore,de.workbookCreateAfter=n.workbookCreateAfter,de.remoteFunction=n.remoteFunction,de.customFunctions=n.customFunctions,de.fireMousedown=n.fireMousedown,de.forceCalculation=n.forceCalculation,de.plugins=n.plugins,de.rowHeaderWidth=n.rowHeaderWidth,de.columnHeaderHeight=n.columnHeaderHeight,de.defaultColWidth=n.defaultColWidth,de.defaultRowHeight=n.defaultRowHeight,de.title=n.title,de.container=n.container,de.hook=n.hook,de.pager=n.pager,de.initShowsheetbarConfig=!1,de.imageUpdateMethodConfig=n.imageUpdateMethodConfig,f.asyncLoad.push(...de.plugins),hm(n.customFunctions);let s=(h=n.devicePixelRatio)!=null?h:1;f.devicePixelRatio=Math.ceil(s);let u=Ar("#"+a);f.loadingObj=u,t==""?(ye.initialjfFile(l,o),bm()):$.post(t,{gridKey:ne.gridKey},d=>{let m=new Function("return "+d)();f.luckysheetfile=m,ye.initialjfFile(l,o),bm(),ne.allowUpdate&&ne.openWebSocket()})};vl.getluckysheetfile=At;vl.getluckysheet_select_save=pu;vl.setluckysheet_select_save=yu;vl.getconfig=vu;vl.getGridData=ye.getGridData;vl.buildGridData=ye.buildGridData;vl.luckysheetrefreshgrid=Be;vl.jfrefreshgrid=Ze;vl.getcellvalue=Le;vl.setcellvalue=Ht;vl.getdatabyselection=Bt;vl.sheetmanage=ye;vl.flowdata=()=>f.flowdata;vl.selectHightlightShow=lt;vl.destroy=Je.destroy;vl.showLoadingProgress=Ai;vl.hideLoadingProgress=wo;vl.luckysheetextendData=ga;vl.locales=ja});function U0(){HTMLElement.prototype.__defineGetter__("runtimeStyle",G0),window.constructor.prototype.__defineGetter__("event",Y0),Event.prototype.__defineGetter__("srcElement",X0)}function G0(){return this.style}function Y0(){return xm()}function X0(){return this.target}function xm(){if(document.all)return window.event;let e=xm.caller;for(;e!=null;){let n=e.arguments[0];if(n&&n.constructor.toString().indexOf("Event")!=-1)return n;e=e.caller}return null}var _m,Cm=Me(()=>{_m=U0});var K0=wl((JP,$m)=>{Gc();wm();Cm();window.addEventListener&&navigator.userAgent.indexOf("Firefox")>0&&_m();$m.exports=vl});return K0();})();
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */
/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
